// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.26/esri/copyright.txt for details.
//>>built
require({cache:{"esri/identity/IdentityManagerBase":function(){define("exports ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../config ../kernel ../request ../core/Error ../core/Evented ../core/events ../core/lang ../core/object ../core/promiseUtils ../core/reactiveUtils ../core/urlUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ./IdentityForm ./IdentityModal ./OAuthCredential ./OAuthInfo ./ServerInfo ../portal/support/urlUtils".split(" "),
function(F,A,v,t,x,N,H,U,R,P,D,W,ea,I,J,T,ia,na,fa,V,ra,oa,sa){const ja={},pa=X=>{const Y=(new I.Url(X.owningSystemUrl)).host;X=(new I.Url(X.server)).host;const u=/.+\.arcgis\.com$/i;return u.test(Y)&&u.test(X)},ta=(X,Y)=>!!(pa(X)&&Y&&Y.some(u=>u.test(X.server)));let ha=null,ka=null;try{ha=window.localStorage,ka=window.sessionStorage}catch{}T=function(X){function Y(){var a=X.call(this)||this;a._portalConfig=globalThis.esriGeowConfig;a.serverInfos=[];a.oAuthInfos=[];a.credentials=[];a._soReqs=[];a._xoReqs=
[];a._portals=[];a._defaultOAuthInfo=null;a._defaultTokenValidity=60;a.dialog=null;a.formConstructor=na;a.tokenValidity=null;a.normalizeWebTierAuth=!1;a._appOrigin="null"!==window.origin?window.origin:window.location.origin;a._appUrlObj=I.urlToObject(window.location.href);a._busy=null;a._rejectOnPersistedPageShow=!1;a._oAuthLocationParams=null;a._gwTokenUrl="/sharing/rest/generateToken";a._agsRest="/rest/services";a._agsPortal=/\/sharing(\/|$)/i;a._agsAdmin=/(https?:\/\/[^\/]+\/[^\/]+)\/admin\/?(\/.*)?$/i;
a._adminSvcs=/\/rest\/admin\/services(\/|$)/i;a._gwDomains=[{regex:/^https?:\/\/www\.arcgis\.com/i,customBaseUrl:"maps.arcgis.com",tokenServiceUrl:"https://www.arcgis.com/sharing/rest/generateToken"},{regex:/^https?:\/\/(?:dev|[a-z\d-]+\.mapsdev)\.arcgis\.com/i,customBaseUrl:"mapsdev.arcgis.com",tokenServiceUrl:"https://dev.arcgis.com/sharing/rest/generateToken"},{regex:/^https?:\/\/(?:devext|[a-z\d-]+\.mapsdevext)\.arcgis\.com/i,customBaseUrl:"mapsdevext.arcgis.com",tokenServiceUrl:"https://devext.arcgis.com/sharing/rest/generateToken"},
{regex:/^https?:\/\/(?:qaext|[a-z\d-]+\.mapsqa)\.arcgis\.com/i,customBaseUrl:"mapsqa.arcgis.com",tokenServiceUrl:"https://qaext.arcgis.com/sharing/rest/generateToken"},{regex:/^https?:\/\/[a-z\d-]+\.maps\.arcgis\.com/i,customBaseUrl:"maps.arcgis.com",tokenServiceUrl:"https://www.arcgis.com/sharing/rest/generateToken"}];a._legacyFed=[];a._regexSDirUrl=/http.+\/rest\/services\/?/gi;a._regexServerType=/(\/(FeatureServer|GPServer|GeoDataServer|GeocodeServer|GeoenrichmentServer|GeometryServer|GlobeServer|ImageServer|KnowledgeGraphServer|MapServer|MissionServer|MobileServer|NAServer|NetworkDiagramServer|OGCFeatureServer|ParcelFabricServer|RelationalCatalogServer|SceneServer|StreamServer|UtilityNetworkServer|ValidationServer|VectorTileServer|VersionManagementServer|VideoServer)).*/gi;
a._gwUser=/http.+\/users\/([^\/]+)\/?.*/i;a._gwItem=/http.+\/items\/([^\/]+)\/?.*/i;a._gwGroup=/http.+\/groups\/([^\/]+)\/?.*/i;a._rePortalTokenSvc=/\/sharing(\/rest)?\/generatetoken/i;a._createDefaultOAuthInfo=!0;a._hasTestedIfAppIsOnPortal=!1;a._getOAuthLocationParams();window.addEventListener("pageshow",b=>{a._pageShowHandler(b)});return a}A._inheritsLoose(Y,X);var u=Y.prototype;u.registerServers=function(a){const b=this.serverInfos;b?(a=a.filter(c=>!this.findServerInfo(c.server)),this.serverInfos=
b.concat(a)):this.serverInfos=a;a.forEach(c=>{c.owningSystemUrl&&this._portals.push(c.owningSystemUrl);c.hasPortal&&this._portals.push(c.server)})};u.registerOAuthInfos=function(a){const b=this.oAuthInfos;if(b){for(const c of a){const d=this.findOAuthInfo(c.portalUrl);d&&b.splice(b.indexOf(d),1)}this.oAuthInfos=b.concat(a)}else this.oAuthInfos=a};u.registerToken=function(a){a={...a};const b=this._sanitizeUrl(a.server),c=this._isServerRsrc(b);let d=this.findServerInfo(b),e=!0,l;d||(d=new oa,d.server=
this._getServerInstanceRoot(b),c?d.hasServer=!0:(d.tokenServiceUrl=this._getTokenSvcUrl(b),d.hasPortal=!0),this.registerServers([d]));(l=this._findCredential(b))?(delete a.server,Object.assign(l,a),e=!1):(l=new F.Credential({userId:a.userId,server:d.server,token:a.token,expires:a.expires,ssl:a.ssl,scope:c?"server":"portal"}),l.resources=[b],this.credentials.push(l));l.emitTokenChange(!1);e||l.refreshServerTokens()};u.toJSON=function(){return P.fixJson({serverInfos:this.serverInfos.map(a=>a.toJSON()),
oAuthInfos:this.oAuthInfos.map(a=>a.toJSON()),credentials:this.credentials.map(a=>a.toJSON())})};u.initialize=function(a){if(a){"string"===typeof a&&(a=JSON.parse(a));var b=a.serverInfos,c=a.oAuthInfos;a=a.credentials;if(b){const d=[];b.forEach(e=>{e.server&&e.tokenServiceUrl&&d.push(e.declaredClass?e:new oa(e))});d.length&&this.registerServers(d)}if(c){const d=[];c.forEach(e=>{e.appId&&d.push(e.declaredClass?e:new ra(e))});d.length&&this.registerOAuthInfos(d)}a&&a.forEach(d=>{d.server&&d.token&&
d.expires&&d.expires>Date.now()&&(d=d.declaredClass?d:new F.Credential(d),d.emitTokenChange(),this.credentials.push(d))})}};u.findServerInfo=function(a){let b;a=this._sanitizeUrl(a);for(const c of this.serverInfos)if(this._hasSameServerInstance(c.server,a)){b=c;break}return b};u.findOAuthInfo=function(a){let b;a=this._sanitizeUrl(a);for(const c of this.oAuthInfos)if(this._hasSameServerInstance(c.portalUrl,a)){b=c;break}return b};u.findCredential=function(a,b){if(a){a=this._sanitizeUrl(a);var c=this._isServerRsrc(a)?
"server":"portal";if(b)for(const e of this.credentials){if(this._hasSameServerInstance(e.server,a)&&b===e.userId&&e.scope===c){var d=e;break}}else for(const e of this.credentials)if(this._hasSameServerInstance(e.server,a)&&-1!==this._getIdenticalSvcIdx(a,e)&&e.scope===c){d=e;break}return d}};u.getCredential=function(a,b){let c=!0;if(b){var d=!!b.token;var e=b.error;c=!1!==b.prompt}b={...b};a=this._sanitizeUrl(a);const l=new AbortController,w=W.createResolver();if(b.signal)W.onAbort(b.signal,()=>{l.abort()});
W.onAbort(l,()=>{w.reject(new H("identity-manager:user-aborted","ABORTED"))});if(W.isAborted(l))return w.promise;b.signal=l.signal;const B=this._isAdminResource(a);if((d=d?this.findCredential(a):null)&&e&&e.details&&498===e.details.httpStatus)d.destroy();else if(d)return a=new H("identity-manager:not-authorized","You are currently signed in as: '"+d.userId+"'. You do not have access to this resource: "+a,{error:e}),w.reject(a),w.promise;if(e=this._findCredential(a,b))return w.resolve(e),w.promise;
let k=this.findServerInfo(a);if(k)!k.hasServer&&this._isServerRsrc(a)&&(k._restInfoPms=this._getTokenSvcUrl(a),k.hasServer=!0);else{e=this._getTokenSvcUrl(a);if(!e)return a=new H("identity-manager:unknown-resource","Unknown resource - could not find token service endpoint."),w.reject(a),w.promise;k=new oa;k.server=this._getServerInstanceRoot(a);"string"===typeof e?(k.tokenServiceUrl=e,k.hasPortal=!0):(k._restInfoPms=e,k.hasServer=!0);this.registerServers([k])}k.hasPortal&&void 0===k._selfReq&&(c||
I.hasSameOrigin(k.tokenServiceUrl,this._appOrigin)||this._gwDomains.some(q=>q.tokenServiceUrl===k.tokenServiceUrl))&&(k._selfReq={owningTenant:b&&b.owningTenant,selfDfd:this._getPortalSelf(k.tokenServiceUrl.replace(this._rePortalTokenSvc,"/sharing/rest/portals/self"),a)});return this._enqueue(a,k,b,w,B)};u.getResourceName=function(a){return this._isRESTService(a)?a.replace(this._regexSDirUrl,"").replace(this._regexServerType,"")||"":this._gwUser.test(a)&&a.replace(this._gwUser,"$1")||this._gwItem.test(a)&&
a.replace(this._gwItem,"$1")||this._gwGroup.test(a)&&a.replace(this._gwGroup,"$1")||""};u.generateToken=function(a,b,c){const d=this._rePortalTokenSvc.test(a.tokenServiceUrl),e=new I.Url(this._appOrigin);var l=a.shortLivedTokenValidity;let w,B,k,q,G,z,K;b&&(K=this.tokenValidity||l||this._defaultTokenValidity,K>l&&0<l&&(K=l));c&&(w=c.isAdmin,B=c.serverUrl,k=c.token,G=c.signal,z=c.ssl,a.customParameters=c.customParameters);w?l=a.adminTokenServiceUrl:(l=a.tokenServiceUrl,q=new I.Url(l.toLowerCase()),
a.webTierAuth&&c?.serverUrl&&!z&&"http"===e.scheme&&(I.hasSameOrigin(e.uri,l,!0)||"https"===q.scheme&&e.host===q.host&&"7080"===e.port&&"7443"===q.port)&&(l=l.replace(/^https:/i,"http:").replace(/:7443/i,":7080")));c={query:{request:"getToken",username:b?.username,password:b?.password,serverUrl:B,token:k,expiration:K,referer:w||d?this._appOrigin:null,client:w?"referer":null,f:"json",...a.customParameters},method:"post",authMode:"anonymous",useProxy:this._useProxy(a,c),signal:G,...c?.ioArgs};d||(c.withCredentials=
!1);return N(l,c).then(C=>{C=C.data;if(!C||!C.token)return new H("identity-manager:authentication-failed","Unable to generate token");const g=a.server;ja[g]||(ja[g]={});b&&(ja[g][b.username]=b.password);C.validity=K;return C})};u.isBusy=function(){return!!this._busy};u.checkSignInStatus=function(a){return this.checkAppAccess(a,"").then(b=>b.credential)};u.checkAppAccess=function(a,b,c){let d=!1;return this.getCredential(a,{prompt:!1}).then(e=>{let l;const w={f:"json"};if("portal"===e.scope)if(b&&
(this._doPortalSignIn(a)||c&&c.force))l=e.server+"/sharing/rest/oauth2/validateAppAccess",w.client_id=b;else if(e.token)l=e.server+"/sharing/rest";else return{credential:e};else if(e.token)l=e.server+"/rest/services";else return{credential:e};e.token&&(w.token=e.token);return N(l,{query:w,authMode:"anonymous"}).then(B=>{if(!1===B.data.valid)throw new H("identity-manager:not-authorized",`You are currently signed in as: '${e.userId}'.`,B.data);d=!!B.data.viewOnlyUserTypeApp;return{credential:e}}).catch(B=>
{if("identity-manager:not-authorized"===B.name)throw B;B=B.details&&B.details.httpStatus;if(498===B)throw e.destroy(),new H("identity-manager:not-authenticated","User is not signed in.");if(400===B)throw new H("identity-manager:invalid-request");return{credential:e}})}).then(e=>({credential:e.credential,viewOnly:d}))};u.setOAuthResponseHash=function(a){a&&("#"===a.charAt(0)&&(a=a.substring(1)),this._processOAuthPopupParams(I.queryToObject(a)))};u.setOAuthRedirectionHandler=function(a){this._oAuthRedirectFunc=
a};u.setProtocolErrorHandler=function(a){this._protocolFunc=a};u.signIn=function(a,b,c={}){const d=W.createResolver(),e=()=>{B?.remove();k?.remove();q?.remove();w?.destroy();this.dialog?.destroy();this.dialog=w=B=k=q=null},l=()=>{e();this._oAuthDfd=null;d.reject(new H("identity-manager:user-aborted","ABORTED"))};if(c.signal)W.onAbort(c.signal,()=>{l()});let w=new this.formConstructor;w.resource=this.getResourceName(a);w.server=b.server;this.dialog=new fa;this.dialog.content=w;this.dialog.open=!0;
this.emit("dialog-create");let B=w.on("cancel",l),k=ea.watch(()=>this.dialog.open,l),q=w.on("submit",G=>{this.generateToken(b,G,{isAdmin:c.isAdmin,signal:c.signal}).then(z=>{e();z=new F.Credential({userId:G.username,server:b.server,token:z.token,expires:null!=z.expires?Number(z.expires):null,ssl:!!z.ssl,isAdmin:c.isAdmin,validity:z.validity});d.resolve(z)}).catch(z=>{w.error=z;w.signingIn=!1})});return d.promise};u.oAuthSignIn=function(a,b,c,d){const e=this._oAuthDfd=W.createResolver();if(d?.signal)W.onAbort(d.signal,
()=>{const C=this._oAuthDfd&&this._oAuthDfd.oAuthWin_;C&&!C.closed?C.close():this.dialog&&z()});e.resUrl_=a;e.sinfo_=b;e.oinfo_=c;let l;const w=c._oAuthCred;if(w.storage&&("authorization-code"===c.flowType||"auto"===c.flowType&&!c.popup&&8.4<=b.currentVersion)){let C=crypto.getRandomValues(new Uint8Array(32));l=I.base64UrlEncode(C);w.codeVerifier=l;C=crypto.getRandomValues(new Uint8Array(32));w.stateUID=I.base64UrlEncode(C);w.save()||(w.codeVerifier=l=null)}else w.codeVerifier=null;this._getCodeChallenge(l).then(C=>
{const g=!d||!1!==d.oAuthPopupConfirmation;c.popup&&g?(B=new this.formConstructor,B.oAuthPrompt=!0,B.server=b.server,this.dialog=new fa,this.dialog.content=B,this.dialog.open=!0,this.emit("dialog-create"),k=B.on("cancel",z),q=ea.watch(()=>this.dialog.open,z),G=B.on("submit",()=>{K();this._doOAuthSignIn(a,b,c,C)})):this._doOAuthSignIn(a,b,c,C)});let B,k,q,G;const z=()=>{K();this._oAuthDfd=null;e.reject(new H("identity-manager:user-aborted","ABORTED"))},K=()=>{k?.remove();q?.remove();G?.remove();B?.destroy();
this.dialog?.destroy();this.dialog=null};return e.promise};u.destroyCredentials=function(){this.credentials&&this.credentials.slice().forEach(a=>{a.destroy()});this.emit("credentials-destroy")};u.enablePostMessageAuth=function(a="https://www.arcgis.com/sharing/rest"){this._postMessageAuthHandle&&this._postMessageAuthHandle.remove();this._postMessageAuthHandle=R.on(window,"message",b=>{if((b.origin===this._appOrigin||b.origin.endsWith(".arcgis.com"))&&"arcgis:auth:requestCredential"===b.data?.type){const c=
b.source;this.getCredential(a).then(d=>{c.postMessage({type:"arcgis:auth:credential",credential:{expires:d.expires,server:d.server,ssl:d.ssl,token:d.token,userId:d.userId}},b.origin)}).catch(d=>{c.postMessage({type:"arcgis:auth:error",error:{name:d.name,message:d.message}},b.origin)})}})};u.disablePostMessageAuth=function(){this._postMessageAuthHandle&&(this._postMessageAuthHandle.remove(),this._postMessageAuthHandle=null)};u._getOAuthLocationParams=function(){var a=window.location.hash;if(a){"#"===
a.charAt(0)&&(a=a.substring(1));a=I.queryToObject(a);var b=!1;if(a.access_token&&a.expires_in&&a.state&&a.hasOwnProperty("username"))try{a.state=JSON.parse(a.state),a.state.portalUrl&&(this._oAuthLocationParams=a,b=!0)}catch{}else if(a.error&&a.error_description&&(console.log("IdentityManager OAuth Error: ",a.error," - ",a.error_description),"access_denied"===a.error&&(b=!0,a.state)))try{a.state=JSON.parse(a.state)}catch{}b&&(window.location.hash=a.state?.hash||"")}if(a=window.location.search){"?"===
a.charAt(0)&&(a=a.substring(1));a=I.queryToObject(a);b=!1;if(a.code&&a.state)try{a.state=JSON.parse(a.state),a.state.portalUrl&&a.state.uid&&(this._oAuthLocationParams=a,b=!0)}catch{}else if(a.error&&a.error_description&&(console.log("IdentityManager OAuth Error: ",a.error," - ",a.error_description),"access_denied"===a.error&&(b=!0,a.state)))try{a.state=JSON.parse(a.state)}catch{}if(b){const c={...a};"code error error_description message_code persist state".split(" ").forEach(d=>{delete c[d]});b=
I.objectToQuery(c);window.history.replaceState(window.history.state,"",window.location.pathname+(b?`?${b}`:"")+(a.state?.hash||""))}}};u._getOAuthToken=function(a,b,c,d,e){a=a.replace(/^http:/i,"https:");return N(`${a}/sharing/rest/oauth2/token`,{authMode:"anonymous",method:"post",query:d&&e?{grant_type:"authorization_code",code:b,redirect_uri:d,client_id:c,code_verifier:e}:{grant_type:"refresh_token",refresh_token:b,client_id:c}}).then(l=>l.data)};u._getCodeChallenge=function(a){return a&&globalThis.isSecureContext?
(a=(new TextEncoder).encode(a),crypto.subtle.digest("SHA-256",a).then(b=>I.base64UrlEncode(new Uint8Array(b)))):Promise.resolve(null)};u._pageShowHandler=function(a){a.persisted&&this.isBusy()&&this._rejectOnPersistedPageShow&&(a=new H("identity-manager:user-aborted","ABORTED"),this._errbackFunc(a))};u._findCredential=function(a,b){let c=-1,d,e,l;const w=b&&b.token;b=b&&b.resource;const B=this._isServerRsrc(a)?"server":"portal",k=this.credentials.filter(q=>this._hasSameServerInstance(q.server,a)&&
q.scope===B);a=b||a;if(k.length)if(1===k.length)if(b=k[0],l=(d=(e=this.findServerInfo(b.server))&&e.owningSystemUrl)?this.findCredential(d,b.userId):void 0,c=this._getIdenticalSvcIdx(a,b),w)-1!==c&&(b.resources.splice(c,1),this._removeResource(a,l));else return-1===c&&b.resources.push(a),this._addResource(a,l),b;else{let q,G;k.some(z=>{G=this._getIdenticalSvcIdx(a,z);return-1!==G?(q=z,l=(d=(e=this.findServerInfo(q.server))&&e.owningSystemUrl)?this.findCredential(d,q.userId):void 0,c=G,!0):!1});if(w)q&&
(q.resources.splice(c,1),this._removeResource(a,l));else if(q)return this._addResource(a,l),q}};u._findOAuthInfo=function(a){let b=this.findOAuthInfo(a);if(!b)for(const c of this.oAuthInfos)if(this._isIdProvider(c.portalUrl,a)){b=c;break}return b};u._addResource=function(a,b){b&&-1===this._getIdenticalSvcIdx(a,b)&&b.resources.push(a)};u._removeResource=function(a,b){let c=-1;b&&(c=this._getIdenticalSvcIdx(a,b),-1<c&&b.resources.splice(c,1))};u._useProxy=function(a,b){return b&&b.isAdmin&&!I.hasSameOrigin(a.adminTokenServiceUrl,
this._appOrigin)||!this._isPortalDomain(a.tokenServiceUrl)&&"10.1"===String(a.currentVersion)&&!I.hasSameOrigin(a.tokenServiceUrl,this._appOrigin)};u._getOrigin=function(a){a=new I.Url(a);return a.scheme+"://"+a.host+(null!=a.port?":"+a.port:"")};u._getServerInstanceRoot=function(a){const b=a.toLowerCase();let c=b.indexOf(this._agsRest);-1===c&&this._isAdminResource(a)&&(c=this._agsAdmin.test(a)?a.replace(this._agsAdmin,"$1").length:a.search(this._adminSvcs));-1!==c||sa.isSecureProxyService(b)||(c=
b.indexOf("/sharing"));-1===c&&"/"===b.substr(-1)&&(c=b.length-1);return-1<c?a.substring(0,c):a};u._hasSameServerInstance=function(a,b){"/"===a.substr(-1)&&(a=a.slice(0,-1));a=a.toLowerCase();b=this._getServerInstanceRoot(b).toLowerCase();a=this._normalizeAGOLorgDomain(a);b=this._normalizeAGOLorgDomain(b);a=a.substr(a.indexOf(":"));b=b.substr(b.indexOf(":"));return a===b};u._normalizeAGOLorgDomain=function(a){const b=/^https?:\/\/(?:cdn|[a-z\d-]+\.maps)\.arcgis\.com/i,c=/^https?:\/\/(?:cdndev|[a-z\d-]+\.mapsdevext)\.arcgis\.com/i,
d=/^https?:\/\/(?:cdnqa|[a-z\d-]+\.mapsqa)\.arcgis\.com/i;b.test(a)?a=a.replace(b,"https://www.arcgis.com"):c.test(a)?a=a.replace(c,"https://devext.arcgis.com"):d.test(a)&&(a=a.replace(d,"https://qaext.arcgis.com"));return a};u._sanitizeUrl=function(a){const b=(t.request.proxyUrl||"").toLowerCase(),c=b?a.toLowerCase().indexOf(b+"?"):-1;-1!==c&&(a=a.substring(c+b.length+1));a=I.normalize(a);return I.urlToObject(a).path};u._isRESTService=function(a){return a.includes(this._agsRest)};u._isAdminResource=
function(a){return this._agsAdmin.test(a)||this._adminSvcs.test(a)};u._isServerRsrc=function(a){return this._isRESTService(a)||this._isAdminResource(a)};u._isIdenticalService=function(a,b){var c=!1;this._isRESTService(a)&&this._isRESTService(b)?(a=this._getSuffix(a).toLowerCase(),b=this._getSuffix(b).toLowerCase(),c=a===b,c||(c=/(.*)\/(MapServer|FeatureServer|UtilityNetworkServer).*/gi,c=a.replace(c,"$1")===b.replace(c,"$1"))):this._isAdminResource(a)&&this._isAdminResource(b)?c=!0:this._isServerRsrc(a)||
this._isServerRsrc(b)||!this._isPortalDomain(a)||(c=!0);return c};u._isPortalDomain=function(a){const b=new I.Url(a.toLowerCase());a=this._portalConfig;let c=this._gwDomains.some(d=>d.regex.test(b.uri));!c&&a&&(c=this._hasSameServerInstance(this._getServerInstanceRoot(a.restBaseUrl),b.uri));c||t.portalUrl&&(c=I.hasSameOrigin(b,t.portalUrl,!0));c||(c=this._portals.some(d=>this._hasSameServerInstance(d,b.uri)));return c=c||this._agsPortal.test(b.path)};u._isIdProvider=function(a,b){let c=-1,d=-1;this._gwDomains.forEach((l,
w)=>{-1===c&&l.regex.test(a)&&(c=w);-1===d&&l.regex.test(b)&&(d=w)});let e=!1;if(-1<c&&-1<d)if(0===c||4===c){if(0===d||4===d)e=!0}else if(1===c){if(1===d||2===d)e=!0}else 2===c?2===d&&(e=!0):3===c&&3===d&&(e=!0);if(!e){const l=this.findServerInfo(b),w=l&&l.owningSystemUrl;w&&pa(l)&&this._isPortalDomain(w)&&this._isIdProvider(a,w)&&(e=!0)}return e};u._getIdenticalSvcIdx=function(a,b){let c=-1;for(let d=0;d<b.resources.length;d++)if(this._isIdenticalService(a,b.resources[d])){c=d;break}return c};u._getSuffix=
function(a){return a.replace(this._regexSDirUrl,"").replace(this._regexServerType,"$1")};u._getTokenSvcUrl=function(a){if(this._isRESTService(a)||this._isAdminResource(a)){var b=this._getServerInstanceRoot(a);var c=b+"/admin/generateToken";a=b+"/rest/info";b=N(a,{query:{f:"json"}}).then(d=>d.data);return{adminUrl:c,promise:b}}if(this._isPortalDomain(a)){let d="";this._gwDomains.some(e=>{e.regex.test(a)&&(d=e.tokenServiceUrl);return!!d});d||this._portals.some(e=>{this._hasSameServerInstance(e,a)&&
(d=e+this._gwTokenUrl);return!!d});d||(c=a.toLowerCase().indexOf("/sharing"),-1!==c&&(d=a.substring(0,c)+this._gwTokenUrl));d||(d=this._getOrigin(a)+this._gwTokenUrl);d&&(c=(new I.Url(a)).port,/^http:\/\//i.test(a)&&"7080"===c&&(d=d.replace(/:7080/i,":7443")),d=d.replace(/http:/i,"https:"));return d}if(a.toLowerCase().includes("premium.arcgisonline.com"))return"https://premium.arcgisonline.com/server/tokens"};u._processOAuthResponseParams=function(a,b,c){const d=b._oAuthCred;if(a.code){var e=d.codeVerifier;
d.codeVerifier=null;d.stateUID=null;d.save();return this._getOAuthToken(c.server,a.code,b.appId,this._getRedirectURI(b,!0),e).then(l=>{const w=new F.Credential({userId:l.username,server:c.server,token:l.access_token,expires:Date.now()+1E3*l.expires_in,ssl:l.ssl,oAuthState:a.state,_oAuthCred:d});b.userId=w.userId;d.storage=l.persist?ha:ka;d.refreshToken=l.refresh_token;d.token=null;d.expires=l.refresh_token_expires_in?Date.now()+1E3*l.refresh_token_expires_in:null;d.userId=w.userId;d.ssl=w.ssl;d.save();
return w})}e=new F.Credential({userId:a.username,server:c.server,token:a.access_token,expires:Date.now()+1E3*Number(a.expires_in),ssl:"true"===a.ssl,oAuthState:a.state,_oAuthCred:d});b.userId=e.userId;d.storage=a.persist?ha:ka;d.refreshToken=null;d.token=e.token;d.expires=e.expires;d.userId=e.userId;d.ssl=e.ssl;d.save();return Promise.resolve(e)};u._processOAuthPopupParams=function(a){const b=this._oAuthDfd;this._oAuthDfd=null;if(b)if(clearInterval(this._oAuthIntervalId),this._oAuthOnPopupHandle?.remove(),
a.error){const c="access_denied"===a.error;a=new H(c?"identity-manager:user-aborted":"identity-manager:authentication-failed",c?"ABORTED":"OAuth: "+a.error+" - "+a.error_description);b.reject(a)}else this._processOAuthResponseParams(a,b.oinfo_,b.sinfo_).then(c=>{b.resolve(c)}).catch(c=>{b.reject(c)})};u._setOAuthResponseQueryString=function(a){a&&("?"===a.charAt(0)&&(a=a.substring(1)),this._processOAuthPopupParams(I.queryToObject(a)))};u._exchangeToken=function(a,b,c){return N(`${a}/sharing/rest/oauth2/exchangeToken`,
{authMode:"anonymous",method:"post",query:{f:"json",client_id:b,token:c}}).then(d=>d.data.token)};u._getPlatformSelf=function(a,b){a=a.replace(/^http:/i,"https:");return N(`${a}/sharing/rest/oauth2/platformSelf`,{authMode:"anonymous",headers:{"X-Esri-Auth-Client-Id":b,"X-Esri-Auth-Redirect-Uri":window.location.href.replace(/#.*$/,"")},method:"post",query:{f:"json",expiration:30},withCredentials:!0}).then(c=>c.data)};u._getPortalSelf=function(a,b){let c;this._gwDomains.some(d=>{d.regex.test(a)&&(c=
d.customBaseUrl);return!!c});if(c)return Promise.resolve({allSSL:!0,currentVersion:"8.4",customBaseUrl:c,portalMode:"multitenant",supportsOAuth:!0});this._appOrigin.startsWith("https:")?a=a.replace(/^http:/i,"https:").replace(/:7080/i,":7443"):/^http:/i.test(b)&&(a=a.replace(/^https:/i,"http:").replace(/:7443/i,":7080"));return N(a,{query:{f:"json"},authMode:"anonymous",withCredentials:!0}).then(d=>d.data)};u._doPortalSignIn=function(a){const b=this._portalConfig,c=window.location.href,d=this.findServerInfo(a);
return(b||this._isPortalDomain(c))&&(d?d.hasPortal||d.owningSystemUrl&&this._isPortalDomain(d.owningSystemUrl):this._isPortalDomain(a))&&(this._isIdProvider(c,a)||b&&(this._hasSameServerInstance(this._getServerInstanceRoot(b.restBaseUrl),a)||this._isIdProvider(b.restBaseUrl,a))||I.hasSameOrigin(c,a,!0))?!0:!1};u._checkProtocol=function(a,b,c,d){let e=!0;d=d?b.adminTokenServiceUrl:b.tokenServiceUrl;d.trim().toLowerCase().startsWith("https:")&&!this._appOrigin.startsWith("https:")&&I.getProxyRule(d)&&
(e=this._protocolFunc?!!this._protocolFunc({resourceUrl:a,serverInfo:b}):!1,e||(a=new H("identity-manager:aborted","Aborted the Sign-In process to avoid sending password over insecure connection."),c(a)));return e};u._enqueue=function(a,b,c,d,e,l){d||(d=W.createResolver());d.resUrl_=a;d.sinfo_=b;d.options_=c;d.admin_=e;d.refresh_=l;this._busy?this._hasSameServerInstance(this._getServerInstanceRoot(a),this._busy.resUrl_)?(this._oAuthDfd&&this._oAuthDfd.oAuthWin_&&this._oAuthDfd.oAuthWin_.focus(),this._soReqs.push(d)):
this._xoReqs.push(d):this._doSignIn(d);return d.promise};u._doSignIn=function(a){this._busy=a;this._rejectOnPersistedPageShow=!1;const b=k=>{var q=a.options_&&a.options_.resource;const G=a.resUrl_,z=a.refresh_;let K=!1;this.credentials.includes(k)||(z&&this.credentials.includes(z)?(z.userId=k.userId,z.token=k.token,z.expires=k.expires,z.validity=k.validity,z.ssl=k.ssl,z.creationTime=k.creationTime,K=!0,k=z):this.credentials.push(k));k.resources||(k.resources=[]);k.resources.includes(q||G)||k.resources.push(q||
G);k.scope=this._isServerRsrc(G)?"server":"portal";k.emitTokenChange();q=this._soReqs;const C={};this._soReqs=[];q.forEach(g=>{if(!this._isIdenticalService(G,g.resUrl_)){const f=this._getSuffix(g.resUrl_);C[f]||(C[f]=!0,k.resources.push(g.resUrl_))}});a.resolve(k);q.forEach(g=>{this._hasSameServerInstance(this._getServerInstanceRoot(G),g.resUrl_)?g.resolve(k):this._soReqs.push(g)});this._busy=a.resUrl_=a.sinfo_=a.refresh_=null;K||this.emit("credential-create",{credential:k});this._soReqs.length?this._doSignIn(this._soReqs.shift()):
this._xoReqs.length&&this._doSignIn(this._xoReqs.shift())},c=k=>{a.reject(k);this._busy=a.resUrl_=a.sinfo_=a.refresh_=null;this._soReqs.length?this._doSignIn(this._soReqs.shift()):this._xoReqs.length&&this._doSignIn(this._xoReqs.shift())},d=(k,q,G,z)=>{const K=a.sinfo_,C=!a.options_||!1!==a.options_.prompt,g=K.hasPortal&&this._findOAuthInfo(a.resUrl_);let f,h;if(k)b(new F.Credential({userId:k,server:K.server,token:G||null,expires:null!=z?Number(z):null,ssl:!!q}));else if(window!==window.parent&&this._appUrlObj.query?.["arcgis-auth-origin"]&&
this._appUrlObj.query?.["arcgis-auth-portal"]&&this._hasSameServerInstance(this._getServerInstanceRoot(this._appUrlObj.query["arcgis-auth-portal"]),a.resUrl_)){window.parent.postMessage({type:"arcgis:auth:requestCredential"},this._appUrlObj.query["arcgis-auth-origin"]);const m=R.on(window,"message",r=>{r.source===window.parent&&r.data&&("arcgis:auth:credential"===r.data.type?(m.remove(),r.data.credential.expires<Date.now()?c(new H("identity-manager:credential-request-failed","Parent application's token has expired.")):
b(new F.Credential(r.data.credential))):"arcgis:auth:error"===r.data.type&&(m.remove(),"tokenExpiredError"===r.data.error.name?c(new H("identity-manager:credential-request-failed","Parent application's token has expired.")):c(H.fromJSON(r.data.error))))});W.onAbort(a.options_?.signal,()=>{m.remove()})}else if(g){let m=g._oAuthCred;m||(k=new V(g,ha),q=new V(g,ka),k.isValid()&&q.isValid()?k.expires>q.expires?(m=k,q.destroy()):(m=q,k.destroy()):m=k.isValid()?k:q,g._oAuthCred=m);if(m.isValid()){f=new F.Credential({userId:m.userId,
server:K.server,token:m.token,expires:m.expires,ssl:m.ssl,_oAuthCred:m});const r=g.appId!==m.appId&&this._doPortalSignIn(a.resUrl_);r||m.refreshToken?(a._pendingDfd=m.refreshToken?this._getOAuthToken(K.server,m.refreshToken,m.appId).then(p=>{f.expires=Date.now()+1E3*p.expires_in;f.token=p.access_token;return f}):Promise.resolve(f),a._pendingDfd.then(p=>r?this._exchangeToken(p.server,g.appId,p.token).then(E=>{p.token=E;return p}).catch(()=>p):p).then(p=>{b(p)}).catch(()=>{m?.destroy();d()})):b(f)}else if(this._oAuthLocationParams&&
this._hasSameServerInstance(g.portalUrl,this._oAuthLocationParams.state.portalUrl)&&(this._oAuthLocationParams.access_token||this._oAuthLocationParams.code&&this._oAuthLocationParams.state.uid===m.stateUID&&m.codeVerifier))k=this._oAuthLocationParams,this._oAuthLocationParams=null,a._pendingDfd=this._processOAuthResponseParams(k,g,K).then(r=>{b(r)}).catch(c);else{const r=()=>{C?a._pendingDfd=this.oAuthSignIn(a.resUrl_,K,g,a.options_).then(b,c):(h=new H("identity-manager:not-authenticated","User is not signed in."),
c(h))};this._doPortalSignIn(a.resUrl_)?a._pendingDfd=this._getPlatformSelf(K.server,g.appId).then(p=>{I.hasSameOrigin(p.portalUrl,this._appOrigin,!0)?(f=new F.Credential({userId:p.username,server:K.server,expires:Date.now()+1E3*p.expires_in,token:p.token}),b(f)):r()}).catch(r):r()}}else C?this._checkProtocol(a.resUrl_,K,c,a.admin_)&&(k=a.options_,a.admin_&&(k=k||{},k.isAdmin=!0),a._pendingDfd=this.signIn(a.resUrl_,K,k).then(b,c)):(h=new H("identity-manager:not-authenticated","User is not signed in."),
c(h))},e=()=>{const k=a.sinfo_;var q=k.owningSystemUrl;const G=a.options_;let z,K,C,g;G&&(z=G.token,K=G.error,C=G.prompt);g=this._findCredential(q,{token:z,resource:a.resUrl_});if(!g)for(const f of this.credentials)if(this._isIdProvider(q,f.server)){g=f;break}g?(q=this.findCredential(a.resUrl_,g.userId))?b(q):ta(k,this._legacyFed)?(q=g.toJSON(),q.server=k.server,q.resources=null,b(new F.Credential(q))):(a._pendingDfd=this.generateToken(this.findServerInfo(g.server),null,{serverUrl:a.resUrl_,token:g.token,
signal:a.options_.signal,ssl:g.ssl})).then(f=>{b(new F.Credential({userId:g?.userId,server:k.server,token:f.token,expires:null!=f.expires?Number(f.expires):null,ssl:!!f.ssl,isAdmin:a.admin_,validity:f.validity}))},c):(this._busy=null,z&&(a.options_.token=null),(a._pendingDfd=this.getCredential(q.replace(/\/?$/,"/sharing"),{resource:a.resUrl_,owningTenant:k.owningTenant,signal:a.options_.signal,token:z,error:K,prompt:C})).then(()=>{this._enqueue(a.resUrl_,a.sinfo_,a.options_,a,a.admin_)},f=>{a.resUrl_=
a.sinfo_=a.refresh_=null;a.reject(f)}))};this._errbackFunc=c;const l=a.sinfo_.owningSystemUrl,w=this._isServerRsrc(a.resUrl_),B=a.sinfo_._restInfoPms;B?B.promise.then(k=>{const q=a.sinfo_;q._restInfoPms&&(q.adminTokenServiceUrl=q._restInfoPms.adminUrl,q._restInfoPms=null,q.tokenServiceUrl=(D.getDeepValue("authInfo.tokenServicesUrl",k)||D.getDeepValue("authInfo.tokenServiceUrl",k)||D.getDeepValue("tokenServiceUrl",k))??null,q.shortLivedTokenValidity=D.getDeepValue("authInfo.shortLivedTokenValidity",
k)??null,q.currentVersion=k.currentVersion,q.owningTenant=k.owningTenant,(k=q.owningSystemUrl=k.owningSystemUrl)&&this._portals.push(k));w&&q.owningSystemUrl?e():d()},()=>{a.sinfo_._restInfoPms=null;const k=new H("identity-manager:server-identification-failed","Unknown resource - could not find token service endpoint.");c(k)}):w&&l?e():a.sinfo_._selfReq?a.sinfo_._selfReq.selfDfd.then(k=>{const q={};let G,z,K,C;k&&(G=k.user&&k.user.username,q.username=G,q.allSSL=k.allSSL,z=k.supportsOAuth,C=parseFloat(k.currentVersion),
"multitenant"===k.portalMode&&(K=k.customBaseUrl),a.sinfo_.currentVersion=C);a.sinfo_.webTierAuth=!!G;return G&&this.normalizeWebTierAuth?this.generateToken(a.sinfo_,null,{ssl:q.allSSL}).catch(()=>null).then(g=>{q.portalToken=g&&g.token;q.tokenExpiration=g&&g.expires;return q}):!G&&z&&4.4<=C&&!this._findOAuthInfo(a.resUrl_)?this._generateOAuthInfo({portalUrl:a.sinfo_.server,customBaseUrl:K,owningTenant:a.sinfo_._selfReq.owningTenant}).catch(()=>null).then(()=>q):q}).catch(()=>null).then(k=>{a.sinfo_._selfReq=
null;k?d(k.username,k.allSSL,k.portalToken,k.tokenExpiration):d()}):d()};u._generateOAuthInfo=function(a){let b=null,c=a.portalUrl;const d=a.customBaseUrl,e=a.owningTenant;if(a=!this._defaultOAuthInfo&&this._createDefaultOAuthInfo&&!this._hasTestedIfAppIsOnPortal){b=window.location.href;let l=b.indexOf("?");-1<l&&(b=b.slice(0,l));l=b.search(/\/(apps|home)\//);b=-1<l?b.slice(0,l):null}a&&b?(this._hasTestedIfAppIsOnPortal=!0,a=N(b+"/sharing/rest",{query:{f:"json"}}).then(()=>{this._defaultOAuthInfo=
new ra({appId:"arcgisonline",popupCallbackUrl:b+"/home/oauth-callback.html"})})):a=Promise.resolve();return a.then(()=>{if(this._defaultOAuthInfo)return c=c.replace(/^http:/i,"https:"),N(c+"/sharing/rest/oauth2/validateRedirectUri",{query:{accountId:e,client_id:this._defaultOAuthInfo.appId,redirect_uri:I.makeAbsolute(this._defaultOAuthInfo.popupCallbackUrl),f:"json"}}).then(l=>{if(l.data.valid){const w=this._defaultOAuthInfo.clone();w.portalUrl=l.data.urlKey&&d?"https://"+l.data.urlKey.toLowerCase()+
"."+d:c;w.popup=window!==window.top||!(I.hasSameOrigin(c,this._appOrigin)||this._gwDomains.some(B=>B.regex.test(c)&&B.regex.test(this._appOrigin)));this.oAuthInfos.push(w)}})})};u._doOAuthSignIn=function(a,b,c,d){var e=c._oAuthCred,l={portalUrl:c.portalUrl};!c.popup&&c.preserveUrlHash&&window.location.hash&&(l.hash=window.location.hash);e.stateUID&&(l.uid=e.stateUID);l={client_id:c.appId,response_type:e.codeVerifier?"code":"token",state:JSON.stringify(l),expiration:c.expiration,locale:c.locale,redirect_uri:this._getRedirectURI(c,
!!e.codeVerifier)};c.forceLogin&&(l.force_login=!0);c.forceUserId&&c.userId&&(l.prepopulatedusername=c.userId);!c.popup&&this._doPortalSignIn(a)&&(l.redirectToUserOrgUrl=!0);e.codeVerifier&&(l.code_challenge=d||e.codeVerifier,l.code_challenge_method=d?"S256":"plain");d=c.portalUrl.replace(/^http:/i,"https:")+"/sharing/oauth2/authorize";e=d+"?"+I.objectToQuery(l);if(c.popup){const w=window.open(e,"esriJSAPIOAuth",c.popupWindowFeatures);w?(w.focus(),this._oAuthDfd.oAuthWin_=w,this._oAuthIntervalId=
setInterval(()=>{if(w.closed){clearInterval(this._oAuthIntervalId);this._oAuthOnPopupHandle.remove();const B=this._oAuthDfd;if(B){const k=new H("identity-manager:user-aborted","ABORTED");B.reject(k)}}},500),this._oAuthOnPopupHandle=R.on(window,["arcgis:auth:hash","arcgis:auth:location:search"],B=>{"arcgis:auth:hash"===B.type?this.setOAuthResponseHash(B.detail):this._setOAuthResponseQueryString(B.detail)})):(a=new H("identity-manager:popup-blocked","ABORTED"),this._oAuthDfd.reject(a))}else this._rejectOnPersistedPageShow=
!0,this._oAuthRedirectFunc?this._oAuthRedirectFunc({authorizeParams:l,authorizeUrl:d,resourceUrl:a,serverInfo:b,oAuthInfo:c}):window.location.href=e};u._getRedirectURI=function(a,b){const c=window.location.href.replace(/#.*$/,"");if(a.popup)return I.makeAbsolute(a.popupCallbackUrl);if(b){const d=I.urlToObject(c);d.query&&"code error error_description message_code persist state".split(" ").forEach(e=>{delete d.query[e]});return I.addQueryParameters(d.path,d.query)}return c};return Y}(U);T.prototype.declaredClass=
"esri.identity.IdentityManagerBase";F.Credential=function(X){function Y(a){var b=X.call(this,a)||this;b._oAuthCred=null;b.tokenRefreshBuffer=2;a&&a._oAuthCred&&(b._oAuthCred=a._oAuthCred);return b}A._inheritsLoose(Y,X);var u=Y.prototype;u.initialize=function(){this.resources=this.resources||[];null==this.creationTime&&(this.creationTime=Date.now())};u.refreshToken=function(){const a=x.id.findServerInfo(this.server),b=a&&a.owningSystemUrl,c=!!b&&"server"===this.scope,d=c&&ta(a,x.id._legacyFed);var e=
a.webTierAuth;const l=e&&x.id.normalizeWebTierAuth;var w=ja[this.server];w=w&&w[this.userId];let B=this.resources&&this.resources[0],k=c?x.id.findServerInfo(b):null,q={username:this.userId,password:w},G;if(!e||l)if(c&&!k&&x.id.serverInfos.some(z=>{x.id._isIdProvider(b,z.server)&&(k=z);return!!k}),e=k?x.id.findCredential(k.server,this.userId):null,!c||e)if(d)e?.refreshToken();else{if(c)G={serverUrl:B,token:e&&e.token,ssl:e&&e.ssl};else if(l)q=null,G={ssl:this.ssl};else if(w)this.isAdmin&&(G={isAdmin:!0});
else{let z;B&&(B=x.id._sanitizeUrl(B),this._enqueued=1,z=x.id._enqueue(B,a,null,null,this.isAdmin,this),z.then(()=>{this._enqueued=0;this.refreshServerTokens()}).catch(()=>{this._enqueued=0}));return z}return x.id.generateToken(c?k:a,c?null:q,G).then(z=>{this.token=z.token;this.expires=null!=z.expires?Number(z.expires):null;this.creationTime=Date.now();this.validity=z.validity;this.emitTokenChange();this.refreshServerTokens()}).catch(()=>{})}};u.refreshServerTokens=function(){"portal"===this.scope&&
x.id.credentials.forEach(a=>{const b=x.id.findServerInfo(a.server),c=b&&b.owningSystemUrl;a!==this&&a.userId===this.userId&&c&&"server"===a.scope&&(x.id._hasSameServerInstance(this.server,c)||x.id._isIdProvider(c,this.server))&&(ta(b,x.id._legacyFed)?(a.token=this.token,a.expires=this.expires,a.creationTime=this.creationTime,a.validity=this.validity,a.emitTokenChange()):a.refreshToken())})};u.emitTokenChange=function(a){clearTimeout(this._refreshTimer);var b=this.server&&x.id.findServerInfo(this.server);
const c=(b=b&&b.owningSystemUrl)&&x.id.findServerInfo(b);!1===a||b&&"portal"!==this.scope&&(!c||!c.webTierAuth||x.id.normalizeWebTierAuth)||null==this.expires&&null==this.validity||this._startRefreshTimer();this.emit("token-change")};u.destroy=function(){this.userId=this.server=this.token=this.expires=this.validity=this.resources=this.creationTime=null;this._oAuthCred&&(this._oAuthCred.destroy(),this._oAuthCred=null);const a=x.id.credentials.indexOf(this);-1<a&&x.id.credentials.splice(a,1);this.emitTokenChange();
this.emit("destroy")};u.toJSON=function(){const a=P.fixJson({userId:this.userId,server:this.server,token:this.token,expires:this.expires,validity:this.validity,ssl:this.ssl,isAdmin:this.isAdmin,creationTime:this.creationTime,scope:this.scope}),b=this.resources;b&&0<b.length&&(a.resources=b.slice());return a};u._startRefreshTimer=function(){clearTimeout(this._refreshTimer);const a=6E4*this.tokenRefreshBuffer,b=2**31-1;let c=(this.validity?this.creationTime+6E4*this.validity:this.expires)-Date.now();
0>c?c=0:c>b&&(c=b);this._refreshTimer=setTimeout(this.refreshToken.bind(this),c>a?c-a:c)};return Y}(U.EventedAccessor);v.__decorate([J.property()],F.Credential.prototype,"creationTime",void 0);v.__decorate([J.property()],F.Credential.prototype,"expires",void 0);v.__decorate([J.property()],F.Credential.prototype,"isAdmin",void 0);v.__decorate([J.property()],F.Credential.prototype,"oAuthState",void 0);v.__decorate([J.property()],F.Credential.prototype,"resources",void 0);v.__decorate([J.property()],
F.Credential.prototype,"scope",void 0);v.__decorate([J.property()],F.Credential.prototype,"server",void 0);v.__decorate([J.property()],F.Credential.prototype,"ssl",void 0);v.__decorate([J.property()],F.Credential.prototype,"token",void 0);v.__decorate([J.property()],F.Credential.prototype,"tokenRefreshBuffer",void 0);v.__decorate([J.property()],F.Credential.prototype,"userId",void 0);v.__decorate([J.property()],F.Credential.prototype,"validity",void 0);F.Credential=v.__decorate([ia.subclass("esri.identity.Credential")],
F.Credential);F.IdentityManagerBase=T;Object.defineProperty(F,Symbol.toStringTag,{value:"Module"})})},"esri/identity/IdentityForm":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/accessorSupport/decorators/subclass ../intl/substitute ../widgets/Widget ../widgets/support/widgetUtils ../widgets/support/decorators/messageBundle ../widgets/support/jsxFactory".split(" "),
function(F,A,v,t,x,N,H,U,R,P,D){t=function(W){function ea(J,T){J=W.call(this,J,T)||this;J._usernameInputNode=null;J._passwordInputNode=null;J.signingIn=!1;J.server=null;J.resource=null;J.error=null;J.oAuthPrompt=!1;return J}F._inheritsLoose(ea,W);var I=ea.prototype;I.render=function(){const {error:J,server:T,resource:ia,signingIn:na,oAuthPrompt:fa,messages:V}=this,ra=D.tsx("div",{class:"esri-identity-form__group"},H.substitute(fa?V.oAuthInfo:V.info,{server:T&&/\.arcgis\.com/i.test(T)?"ArcGIS Online":
T,resource:`(${ia||V.lblItem})`})),oa=fa?null:D.tsx("div",{class:"esri-identity-form__group",key:"username"},D.tsx("label",{class:"esri-identity-form__label"},V.lblUser,D.tsx("input",{value:"",required:!0,autocomplete:"off",spellcheck:!1,type:"text",bind:this,afterCreate:R.storeNode,"data-node-ref":"_usernameInputNode",class:"esri-input"}))),sa=fa?null:D.tsx("div",{class:"esri-identity-form__group",key:"password"},D.tsx("label",{class:"esri-identity-form__label"},V.lblPwd,D.tsx("input",{value:"",
required:!0,type:"password",bind:this,afterCreate:R.storeNode,"data-node-ref":"_passwordInputNode",class:"esri-input"}))),ja=D.tsx("div",{class:this.classes("esri-identity-form__group","esri-identity-form__footer")},D.tsx("input",{type:"submit",disabled:!!na,value:na?V.lblSigning:V.lblOk,class:"esri-button"}),D.tsx("input",{type:"button",value:V.lblCancel,bind:this,onclick:this._cancel,class:this.classes("esri-button","esri-button--secondary")})),pa=J?D.tsx("div",null,J.details&&J.details.httpStatus?
V.invalidUser:V.noAuthService):null;return D.tsx("form",{class:"esri-identity-form",bind:this,onsubmit:this._submit},ra,pa,oa,sa,ja)};I._cancel=function(){this._set("signingIn",!1);this._usernameInputNode&&(this._usernameInputNode.value="");this._passwordInputNode&&(this._passwordInputNode.value="");this.emit("cancel")};I._submit=function(J){J.preventDefault();this._set("signingIn",!0);this.emit("submit",this.oAuthPrompt?{}:{username:this._usernameInputNode&&this._usernameInputNode.value,password:this._passwordInputNode&&
this._passwordInputNode.value})};return ea}(U);A.__decorate([v.property(),P.messageBundle("esri/identity/t9n/identity")],t.prototype,"messages",void 0);A.__decorate([v.property()],t.prototype,"signingIn",void 0);A.__decorate([v.property()],t.prototype,"server",void 0);A.__decorate([v.property()],t.prototype,"resource",void 0);A.__decorate([v.property()],t.prototype,"error",void 0);A.__decorate([v.property()],t.prototype,"oAuthPrompt",void 0);return t=A.__decorate([N.subclass("esri.identity.IdentityForm")],
t)})},"esri/identity/IdentityModal":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/handleUtils ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/accessorSupport/decorators/subclass ../widgets/Widget ../widgets/support/widget ../widgets/support/jsxFactory ../widgets/support/decorators/messageBundle".split(" "),function(F,A,v,t,x,N,H,U,R,P,D,W){function ea(C,g){var f=Object.keys(C);if(Object.getOwnPropertySymbols){var h=
Object.getOwnPropertySymbols(C);g&&(h=h.filter(function(m){return Object.getOwnPropertyDescriptor(C,m).enumerable}));f.push.apply(f,h)}return f}function I(C){for(var g=1;g<arguments.length;g++){var f=null!=arguments[g]?arguments[g]:{};g%2?ea(Object(f),!0).forEach(function(h){var m=f[h];a:if("object"===typeof h&&null!==h){var r=h[Symbol.toPrimitive];if(void 0!==r){h=r.call(h,"string");if("object"!==typeof h)break a;throw new TypeError("@@toPrimitive must return a primitive value.");}h=String(h)}h=
"symbol"===typeof h?h:String(h);h in C?Object.defineProperty(C,h,{value:m,enumerable:!0,configurable:!0,writable:!0}):C[h]=m}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors(f)):ea(Object(f)).forEach(function(h){Object.defineProperty(C,h,Object.getOwnPropertyDescriptor(f,h))})}return C}N='input select textarea a[href] button [tabindex]:not(slot) audio[controls] video[controls] [contenteditable]:not([contenteditable\x3d"false"]) details\x3esummary:first-of-type details'.split(" ");
var J=N.join(","),T=(H="undefined"===typeof Element)?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,ia=!H&&Element.prototype.getRootNode?function(C){return C.getRootNode()}:function(C){return C.ownerDocument},na=function(C,g,f){var h=Array.prototype.slice.apply(C.querySelectorAll(J));g&&T.call(C,J)&&h.unshift(C);return h=h.filter(f)},fa=function m(g,f,h){for(var r=[],p=Array.from(g);p.length;){var E=p.shift();if("SLOT"===E.tagName){var L=
E.assignedElements();L=m(L.length?L:E.children,!0,h);h.flatten?r.push.apply(r,L):r.push({scopeParent:E,candidates:L})}else{T.call(E,J)&&h.filter(E)&&(f||!g.includes(E))&&r.push(E);L=E.shadowRoot||"function"===typeof h.getShadowRoot&&h.getShadowRoot(E);var S=!h.shadowRootFilter||h.shadowRootFilter(E);L&&S?(L=m(!0===L?E.children:L.children,!0,h),h.flatten?r.push.apply(r,L):r.push({scopeParent:E,candidates:L})):p.unshift.apply(p,E.children)}}return r},V=function(g,f){return 0>g.tabIndex&&(f||/^(AUDIO|VIDEO|DETAILS)$/.test(g.tagName)||
g.isContentEditable)&&isNaN(parseInt(g.getAttribute("tabindex"),10))?0:g.tabIndex},ra=function(g,f){return g.tabIndex===f.tabIndex?g.documentOrder-f.documentOrder:g.tabIndex-f.tabIndex},oa=function(g){return"DETAILS"===g.tagName&&Array.prototype.slice.apply(g.children).some(function(f){return"SUMMARY"===f.tagName})},sa=function(g,f){for(var h=0;h<g.length;h++)if(g[h].checked&&g[h].form===f)return g[h]},ja=function(g){if(!g.name)return!0;var f=g.form||ia(g),h=function(r){return f.querySelectorAll('input[type\x3d"radio"][name\x3d"'+
r+'"]')};if("undefined"!==typeof window&&"undefined"!==typeof window.CSS&&"function"===typeof window.CSS.escape)var m=h(window.CSS.escape(g.name));else try{m=h(g.name)}catch(r){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",r.message),!1}h=sa(m,g.form);return!h||h===g},pa=function(g){g=g.getBoundingClientRect();var f=g.height;return 0===g.width&&0===f},ta=function(g,f){var h=f.displayCheck;
f=f.getShadowRoot;if("hidden"===getComputedStyle(g).visibility)return!0;var m=T.call(g,"details\x3esummary:first-of-type")?g.parentElement:g;if(T.call(m,"details:not([open]) *"))return!0;if(!h||"full"===h||"legacy-full"===h){if("function"===typeof f){for(m=g;g;){var r=g.parentElement,p=ia(g);if(r&&!r.shadowRoot&&!0===f(r))return pa(g);g=g.assignedSlot?g.assignedSlot:r||p===g.ownerDocument?r:p.host}g=m}f=g;var E;m=ia(f).host;for(r=!!(null!==(E=m)&&void 0!==E&&E.ownerDocument.contains(m)||f.ownerDocument.contains(f));!r&&
m;){var L;m=ia(m).host;r=!(null===(L=m)||void 0===L||!L.ownerDocument.contains(m))}if(r)return!g.getClientRects().length;if("legacy-full"!==h)return!0}else if("non-zero-area"===h)return pa(g);return!1},ha=function(g,f){var h;(h=f.disabled)||(h="INPUT"===f.tagName&&"hidden"===f.type);if(!(g=h||ta(f,g)||oa(f)))a:{if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(f.tagName))for(g=f.parentElement;g;){if("FIELDSET"===g.tagName&&g.disabled){for(h=0;h<g.children.length;h++){var m=g.children.item(h);if("LEGEND"===
m.tagName){g=T.call(g,"fieldset[disabled] *")?!0:!m.contains(f);break a}}g=!0;break a}g=g.parentElement}g=!1}return g?!1:!0},ka=function(g,f){return"INPUT"===f.tagName&&"radio"===f.type&&!ja(f)||0>V(f)||!ha(g,f)?!1:!0},X=function(g){g=parseInt(g.getAttribute("tabindex"),10);return isNaN(g)||0<=g?!0:!1},Y=function h(f){var m=[],r=[];f.forEach(function(p,E){var L=!!p.scopeParent,S=L?p.scopeParent:p,Z=V(S,L),la=L?h(p.candidates):S;0===Z?L?m.push.apply(m,la):m.push(S):r.push({documentOrder:E,tabIndex:Z,
item:p,isScope:L,content:la})});return r.sort(ra).reduce(function(p,E){E.isScope?p.push.apply(p,E.content):p.push(E.content);return p},[]).concat(m)},u=function(f,h){h=h||{};f=h.getShadowRoot?fa([f],h.includeContainer,{filter:ka.bind(null,h),flatten:!1,getShadowRoot:h.getShadowRoot,shadowRootFilter:X}):na(f,h.includeContainer,ka.bind(null,h));return Y(f)},a=function(f,h){h=h||{};return h.getShadowRoot?fa([f],h.includeContainer,{filter:ha.bind(null,h),flatten:!0,getShadowRoot:h.getShadowRoot}):na(f,
h.includeContainer,ha.bind(null,h))},b=function(f,h){h=h||{};if(!f)throw Error("No node provided");return!1===T.call(f,J)?!1:ka(h,f)},c=N.concat("iframe").join(","),d=function(f,h){h=h||{};if(!f)throw Error("No node provided");return!1===T.call(f,c)?!1:ha(h,f)},e={activateTrap:function(f,h){if(0<f.length){var m=f[f.length-1];m!==h&&m.pause()}m=f.indexOf(h);-1!==m&&f.splice(m,1);f.push(h)},deactivateTrap:function(f,h){h=f.indexOf(h);-1!==h&&f.splice(h,1);0<f.length&&f[f.length-1].unpause()}},l=function(f){return"Tab"===
f.key||9===f.keyCode},w=function(f){return l(f)&&!f.shiftKey},B=function(f){return l(f)&&f.shiftKey},k=function(f,h){var m=-1;f.every(function(r,p){return h(r)?(m=p,!1):!0});return m},q=function(f){for(var h=arguments.length,m=Array(1<h?h-1:0),r=1;r<h;r++)m[r-1]=arguments[r];return"function"===typeof f?f.apply(void 0,m):f},G=function(f){return f.target.shadowRoot&&"function"===typeof f.composedPath?f.composedPath()[0]:f.target},z=[],K=function(f,h){var m=(null===h||void 0===h?void 0:h.document)||
document,r=(null===h||void 0===h?void 0:h.trapStack)||z,p=I({returnFocusOnDeactivate:!0,escapeDeactivates:!0,delayInitialFocus:!0,isKeyForward:w,isKeyBackward:B},h),E=[],L=[],S=[],Z=null,la=null,aa=!1,da=!1,ua=void 0,qa=function(O,n,y){return O&&void 0!==O[n]?O[n]:p[y||n]},va=function(O){return L.findIndex(function(n){var y=n.tabbableNodes;return n.container.contains(O)||y.find(function(M){return M===O})})},wa=function(O){var n=p[O];if("function"===typeof n){for(var y=arguments.length,M=Array(1<y?
y-1:0),Q=1;Q<y;Q++)M[Q-1]=arguments[Q];n=n.apply(void 0,M)}!0===n&&(n=void 0);if(!n){if(void 0===n||!1===n)return n;throw Error("`".concat(O,"` was specified but was not a node, or did not return a node"));}y=n;if("string"===typeof n&&(y=m.querySelector(n),!y))throw Error("`".concat(O,"` as selector refers to no known node"));return y},za=function(){var O=wa("initialFocus");if(!1===O)return!1;void 0===O&&(O=0<=va(m.activeElement)?m.activeElement:(O=S[0])&&O.firstTabbableNode||wa("fallbackFocus"));
if(!O)throw Error("Your focus-trap needs to have at least one focusable element");return O},xa=function(){L=E.map(function(O){var n=u(O,p.tabbableOptions),y=a(O,p.tabbableOptions);return{container:O,tabbableNodes:n,focusableNodes:y,firstTabbableNode:0<n.length?n[0]:null,lastTabbableNode:0<n.length?n[n.length-1]:null,nextTabbableNode:function(M){var Q=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0,ca=y.findIndex(function(ba){return ba===M});if(!(0>ca))return Q?y.slice(ca+1).find(function(ba){return b(ba,
p.tabbableOptions)}):y.slice(0,ca).reverse().find(function(ba){return b(ba,p.tabbableOptions)})}}});S=L.filter(function(O){return 0<O.tabbableNodes.length});if(0>=S.length&&!wa("fallbackFocus"))throw Error("Your focus-trap must have at least one container with at least one tabbable node in it at all times");},ya=function y(n){!1!==n&&n!==m.activeElement&&(n&&n.focus?(n.focus({preventScroll:!!p.preventScroll}),la=n,n.tagName&&"input"===n.tagName.toLowerCase()&&"function"===typeof n.select&&n.select()):
y(za()))},Ca=function(n){var y=wa("setReturnFocus",n);return y?y:!1===y?!1:n},Aa=function(n){var y=G(n);0<=va(y)||(q(p.clickOutsideDeactivates,n)?ma.deactivate({returnFocus:p.returnFocusOnDeactivate&&!d(y,p.tabbableOptions)}):q(p.allowOutsideClick,n)||n.preventDefault())},Da=function(n){var y=G(n),M=0<=va(y);M||y instanceof Document?M&&(la=y):(n.stopImmediatePropagation(),ya(la||za()))},Ia=function(n){var y=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!1,M=G(n);xa();var Q=null;if(0<S.length){var ca=
va(M),ba=0<=ca?L[ca]:void 0;0>ca?Q=y?S[S.length-1].lastTabbableNode:S[0].firstTabbableNode:y?(y=k(S,function(Ba){return M===Ba.firstTabbableNode}),0>y&&(ba.container===M||d(M,p.tabbableOptions)&&!b(M,p.tabbableOptions)&&!ba.nextTabbableNode(M,!1))&&(y=ca),0<=y?Q=S[0===y?S.length-1:y-1].lastTabbableNode:l(n)||(Q=ba.nextTabbableNode(M,!1))):(y=k(S,function(Ba){return M===Ba.lastTabbableNode}),0>y&&(ba.container===M||d(M,p.tabbableOptions)&&!b(M,p.tabbableOptions)&&!ba.nextTabbableNode(M))&&(y=ca),0<=
y?Q=S[y===S.length-1?0:y+1].firstTabbableNode:l(n)||(Q=ba.nextTabbableNode(M)))}else Q=wa("fallbackFocus");Q&&(l(n)&&n.preventDefault(),ya(Q))},Ea=function(n){"Escape"!==n.key&&"Esc"!==n.key&&27!==n.keyCode||!1===q(p.escapeDeactivates,n)?(p.isKeyForward(n)||p.isKeyBackward(n))&&Ia(n,p.isKeyBackward(n)):(n.preventDefault(),ma.deactivate())},Fa=function(n){var y=G(n);0<=va(y)||q(p.clickOutsideDeactivates,n)||q(p.allowOutsideClick,n)||(n.preventDefault(),n.stopImmediatePropagation())},Ga=function(){if(aa)return e.activateTrap(r,
ma),ua=p.delayInitialFocus?setTimeout(function(){ya(za())},0):ya(za()),m.addEventListener("focusin",Da,!0),m.addEventListener("mousedown",Aa,{capture:!0,passive:!1}),m.addEventListener("touchstart",Aa,{capture:!0,passive:!1}),m.addEventListener("click",Fa,{capture:!0,passive:!1}),m.addEventListener("keydown",Ea,{capture:!0,passive:!1}),ma},Ha=function(){if(aa)return m.removeEventListener("focusin",Da,!0),m.removeEventListener("mousedown",Aa,!0),m.removeEventListener("touchstart",Aa,!0),m.removeEventListener("click",
Fa,!0),m.removeEventListener("keydown",Ea,!0),ma};var ma={get active(){return aa},get paused(){return da},activate:function(n){if(aa)return this;var y=qa(n,"onActivate"),M=qa(n,"onPostActivate"),Q=qa(n,"checkCanFocusTrap");Q||xa();aa=!0;da=!1;Z=m.activeElement;y&&y();n=function(){Q&&xa();Ga();M&&M()};if(Q)return Q(E.concat()).then(n,n),this;n();return this},deactivate:function(n){if(!aa)return this;var y=I({onDeactivate:p.onDeactivate,onPostDeactivate:p.onPostDeactivate,checkCanReturnFocus:p.checkCanReturnFocus},
n);clearTimeout(ua);ua=void 0;Ha();da=aa=!1;e.deactivateTrap(r,ma);var M=qa(y,"onDeactivate"),Q=qa(y,"onPostDeactivate");n=qa(y,"checkCanReturnFocus");var ca=qa(y,"returnFocus","returnFocusOnDeactivate");M&&M();y=function(){setTimeout(function(){ca&&ya(Ca(Z));Q&&Q()},0)};if(ca&&n)return n(Ca(Z)).then(y,y),this;y();return this},pause:function(){if(da||!aa)return this;da=!0;Ha();return this},unpause:function(){if(!da||!aa)return this;da=!1;xa();Ga();return this},updateContainerElements:function(n){E=
[].concat(n).filter(Boolean).map(function(y){return"string"===typeof y?m.querySelector(y):y});aa&&xa();return this}};ma.updateContainerElements(f);return ma};R=function(f){function h(r,p){var E=f.call(this,r,p)||this;E.container=document.createElement("div");E.content=null;E.open=!1;E._focusTrap=null;E._close=()=>{E.open=!1};document.body.appendChild(E.container);E.addHandles(t.watch(()=>E.open,()=>E._toggleFocusTrap()));return E}F._inheritsLoose(h,f);var m=h.prototype;m.destroy=function(){this._destroyFocusTrap()};
m.render=function(){var r=this.id;const {open:p,content:E,title:L,messages:S}=this;var Z=p&&!!E;const la={["esri-identity-modal--open"]:Z,["esri-identity-modal--closed"]:!Z},aa=D.tsx("button",{class:"esri-identity-modal__close-button","aria-label":S.close,title:S.close,bind:this,onclick:this._close,type:"button"},D.tsx("span",{"aria-hidden":"true",class:"esri-icon-close"})),da=`${r}_title`;r=`${r}_content`;const ua=L?D.tsx("h1",{id:da,class:"esri-identity-modal__title"},L):null;Z=Z?D.tsx("div",{bind:this,
class:"esri-identity-modal__dialog",role:"dialog","aria-labelledby":da,"aria-describedby":r,afterCreate:this._createFocusTrap},aa,ua,this._renderContent(r)):null;return D.tsx("div",{tabIndex:-1,class:this.classes("esri-identity-modal",la)},Z)};m._destroyFocusTrap=function(){this._focusTrap?.deactivate({onDeactivate:()=>{}});this._focusTrap=null};m._toggleFocusTrap=function(){const {_focusTrap:r,open:p}=this;r&&(p?r.activate():r.deactivate())};m._createFocusTrap=function(r){this._destroyFocusTrap();
const p=requestAnimationFrame(()=>{this._focusTrap=K(r,{initialFocus:"input",onDeactivate:this._close});this._toggleFocusTrap()});this.addHandles(v.makeHandle(()=>cancelAnimationFrame(p)))};m._renderContent=function(r){const p=this.content;return"string"===typeof p?D.tsx("div",{class:"esri-identity-modal__content",id:r,innerHTML:p}):P.isWidget(p)?D.tsx("div",{class:"esri-identity-modal__content",id:r},p.render()):p instanceof HTMLElement?D.tsx("div",{class:"esri-identity-modal__content",id:r,bind:p,
afterCreate:this._attachToNode}):null};m._attachToNode=function(r){r.appendChild(this)};F._createClass(h,[{key:"title",get:function(){return this.messages?.auth.signIn}}]);return h}(R);A.__decorate([x.property({readOnly:!0})],R.prototype,"container",void 0);A.__decorate([x.property()],R.prototype,"content",void 0);A.__decorate([x.property()],R.prototype,"open",void 0);A.__decorate([x.property(),W.messageBundle("esri/t9n/common")],R.prototype,"messages",void 0);A.__decorate([x.property()],R.prototype,
"title",null);return R=A.__decorate([U.subclass("esri.identity.IdentityModal")],R)})},"esri/identity/OAuthCredential":function(){define(function(){let F=function(){function A(t,x){this.userId=this.token=this.stateUID=this.ssl=this.refreshToken=this.expires=this.codeVerifier=this.appId=this.storage=this.oAuthInfo=null;this.oAuthInfo=t;this.storage=x;this._init()}var v=A.prototype;v.isValid=function(){let t=!1;if(this.oAuthInfo&&this.userId&&(this.refreshToken||this.token))if(null==this.expires&&this.refreshToken)t=
!0;else if(this.expires){const x=Date.now();this.expires>x&&(this.expires-x)/1E3>60*this.oAuthInfo.minTimeUntilExpiration&&(t=!0)}return t};v.save=function(){if(!this.storage)return!1;const t=this._load(),x=this.oAuthInfo;if(x&&x.authNamespace&&x.portalUrl){let N=t[x.authNamespace];N||(N=t[x.authNamespace]={});this.appId||(this.appId=x.appId);N[x.portalUrl]={appId:this.appId,codeVerifier:this.codeVerifier,expires:this.expires,refreshToken:this.refreshToken,ssl:this.ssl,stateUID:this.stateUID,token:this.token,
userId:this.userId};try{this.storage.setItem("esriJSAPIOAuth",JSON.stringify(t))}catch(H){return console.warn(H),!1}return!0}return!1};v.destroy=function(){const t=this._load(),x=this.oAuthInfo;if(x&&x.appId&&x.portalUrl&&(null==this.expires||this.expires>Date.now())&&(this.refreshToken||this.token)){var N=x.portalUrl.replace(/^http:/i,"https:")+"/sharing/rest/oauth2/revokeToken";const H=new FormData;H.append("f","json");H.append("auth_token",this.refreshToken||this.token);H.append("client_id",x.appId);
H.append("token_type_hint",this.refreshToken?"refresh_token":"access_token");if("function"===typeof navigator.sendBeacon)navigator.sendBeacon(N,H);else{const U=new XMLHttpRequest;U.open("POST",N);U.send(H)}}if(x&&x.authNamespace&&x.portalUrl&&this.storage&&(N=t[x.authNamespace])){delete N[x.portalUrl];try{this.storage.setItem("esriJSAPIOAuth",JSON.stringify(t))}catch(H){console.log(H)}}x&&(this.oAuthInfo=x._oAuthCred=null)};v._init=function(){var t=this._load();const x=this.oAuthInfo;x&&x.authNamespace&&
x.portalUrl&&(t=t[x.authNamespace])&&(t=t[x.portalUrl])&&(this.appId=t.appId,this.codeVerifier=t.codeVerifier,this.expires=t.expires,this.refreshToken=t.refreshToken,this.ssl=t.ssl,this.stateUID=t.stateUID,this.token=t.token,this.userId=t.userId)};v._load=function(){let t={};if(this.storage){const x=this.storage.getItem("esriJSAPIOAuth");if(x)try{t=JSON.parse(x)}catch(N){console.warn(N)}}return t};return A}();F.prototype.declaredClass="esri.identity.OAuthCredential";return F})},"esri/identity/OAuthInfo":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/accessorSupport/decorators/subclass".split(" "),
function(F,A,v,t,x,N,H){var U;v=U=function(R){function P(D){D=R.call(this,D)||this;D._oAuthCred=null;D.appId=null;D.authNamespace="/";D.expiration=20160;D.flowType="auto";D.forceLogin=!1;D.forceUserId=!1;D.locale=null;D.minTimeUntilExpiration=30;D.popup=!1;D.popupCallbackUrl="oauth-callback.html";D.popupWindowFeatures="height\x3d490,width\x3d800,resizable,scrollbars,status";D.portalUrl="https://www.arcgis.com";D.preserveUrlHash=!1;D.userId=null;return D}F._inheritsLoose(P,R);P.prototype.clone=function(){return U.fromJSON(this.toJSON())};
return P}(v.JSONSupport);A.__decorate([t.property({json:{write:!0}})],v.prototype,"appId",void 0);A.__decorate([t.property({json:{write:!0}})],v.prototype,"authNamespace",void 0);A.__decorate([t.property({json:{write:!0}})],v.prototype,"expiration",void 0);A.__decorate([t.property({json:{write:!0}})],v.prototype,"flowType",void 0);A.__decorate([t.property({json:{write:!0}})],v.prototype,"forceLogin",void 0);A.__decorate([t.property({json:{write:!0}})],v.prototype,"forceUserId",void 0);A.__decorate([t.property({json:{write:!0}})],
v.prototype,"locale",void 0);A.__decorate([t.property({json:{write:!0}})],v.prototype,"minTimeUntilExpiration",void 0);A.__decorate([t.property({json:{write:!0}})],v.prototype,"popup",void 0);A.__decorate([t.property({json:{write:!0}})],v.prototype,"popupCallbackUrl",void 0);A.__decorate([t.property({json:{write:!0}})],v.prototype,"popupWindowFeatures",void 0);A.__decorate([t.property({json:{write:!0}})],v.prototype,"portalUrl",void 0);A.__decorate([t.property({json:{write:!0}})],v.prototype,"preserveUrlHash",
void 0);A.__decorate([t.property({json:{write:!0}})],v.prototype,"userId",void 0);return v=U=A.__decorate([H.subclass("esri.identity.OAuthInfo")],v)})},"esri/identity/ServerInfo":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/accessorSupport/decorators/subclass".split(" "),function(F,A,v,t,x,N,H){v=function(U){function R(P){P=U.call(this,P)||this;
P.adminTokenServiceUrl=null;P.currentVersion=null;P.hasPortal=null;P.hasServer=null;P.owningSystemUrl=null;P.owningTenant=null;P.server=null;P.shortLivedTokenValidity=null;P.tokenServiceUrl=null;P.webTierAuth=null;return P}F._inheritsLoose(R,U);return R}(v.JSONSupport);A.__decorate([t.property({json:{write:!0}})],v.prototype,"adminTokenServiceUrl",void 0);A.__decorate([t.property({json:{write:!0}})],v.prototype,"currentVersion",void 0);A.__decorate([t.property({json:{write:!0}})],v.prototype,"hasPortal",
void 0);A.__decorate([t.property({json:{write:!0}})],v.prototype,"hasServer",void 0);A.__decorate([t.property({json:{write:!0}})],v.prototype,"owningSystemUrl",void 0);A.__decorate([t.property({json:{write:!0}})],v.prototype,"owningTenant",void 0);A.__decorate([t.property({json:{write:!0}})],v.prototype,"server",void 0);A.__decorate([t.property({json:{write:!0}})],v.prototype,"shortLivedTokenValidity",void 0);A.__decorate([t.property({json:{write:!0}})],v.prototype,"tokenServiceUrl",void 0);A.__decorate([t.property({json:{write:!0}})],
v.prototype,"webTierAuth",void 0);return v=A.__decorate([H.subclass("esri.identity.ServerInfo")],v)})},"*noref":1}});define(["../chunks/_rollupPluginBabelHelpers","../kernel","./IdentityManagerBase"],function(F,A,v){v=function(t){function x(){return t.apply(this,arguments)||this}F._inheritsLoose(x,t);return x}(v.IdentityManagerBase);v.prototype.declaredClass="esri.identity.IdentityManager";v=new v;A.setId(v);return v});