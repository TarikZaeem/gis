// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.26/esri/copyright.txt for details.
//>>built
define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../intl ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ../../Widget ./ClassicCSS ./support/relationshipUtils ./support/univariateUtils ../support/styleUtils ../../support/Heading ../../support/widgetUtils ../../support/decorators/messageBundle ../../support/jsxFactory ../../../intl/number".split(" "),
function(F,x,v,z,P,Q,G,H,b,I,q,n,J,R,K,c,L){const M=`${b.LEGEND}__`,D={display:"flex",alignItems:"flex-start"},A={marginLeft:"3px"},w={display:"table-cell",verticalAlign:"middle"};v=function(E){function B(a,d){a=E.call(this,a,d)||this;a.activeLayerInfos=null;a.headingLevel=3;a.messages=null;a.type="classic";return a}F._inheritsLoose(B,E);var r=B.prototype;r.render=function(){var a=this.activeLayerInfos;a=a&&a.toArray().map(d=>this._renderLegendForLayer(d)).filter(d=>!!d);return c.tsx("div",null,a&&
a.length?a:c.tsx("div",{class:b.CSS.message},this.messages.noLegend))};r._renderLegendForLayer=function(a){if(!a.ready)return null;var d=!!a.children.length;const e=`${M}${a.layer.uid}-version-${a.version}`,g=a.title?J.Heading({level:this.headingLevel,class:this.classes(b.CSS.header,b.CSS.label)},a.title):null;if(d)return d=a.children.map(f=>this._renderLegendForLayer(f)).toArray(),c.tsx("div",{key:e,class:this.classes(b.CSS.service,b.CSS.groupLayer)},g,d);if((d=a.legendElements)&&!d.length)return null;
d=d.map(f=>this._renderLegendForElement(f,a.layer,a.effectList)).filter(f=>!!f);return d.length?c.tsx("div",{key:e,class:this.classes(b.CSS.service,{[b.CSS.groupLayerChild]:!!a.parent}),tabIndex:0},g,c.tsx("div",{class:b.CSS.layer},d)):null};r._renderLegendForElement=function(a,d,e,g){var f="color-ramp"===a.type,h="opacity-ramp"===a.type;const l="size-ramp"===a.type;let m=null;if("symbol-table"===a.type||l){var k=a.infos.map(y=>this._renderLegendForElementInfo(y,d,e,l,a.legendType)).filter(y=>!!y);
k.length&&(m=c.tsx("div",{class:b.CSS.layerBody},k))}else"color-ramp"===a.type||"opacity-ramp"===a.type||"heatmap-ramp"===a.type||"stretch-ramp"===a.type?m=this._renderLegendForRamp(a,d.opacity):"relationship-ramp"===a.type?m=I.renderRelationshipRamp(a,this.id,d.opacity,e):"pie-chart-ramp"===a.type?m=this._renderPieChartRamp(a):"univariate-above-and-below-ramp"===a.type?m=this._renderUnivariateAboveAndBelowRamp(a,d.opacity,e):"univariate-color-size-ramp"===a.type&&(m=this._renderUnivariateColorSizeRamp(a,
d.opacity,e));if(!m)return null;k=a.title;var p=null;"string"===typeof k?p=k:k&&(p=n.getTitle(this.messages,k,f||h),p=n.isRendererTitle(k,f||h)&&k.title?`${k.title} (${p})`:p);f=g?b.CSS.layerChildTable:b.CSS.layerTable;h=p?c.tsx("div",{class:b.CSS.layerCaption},p):null;return c.tsx("div",{class:this.classes(f,{[b.CSS.layerTableSizeRamp]:l||!g})},h,m)};r._renderPieChartRamp=function(a){return c.tsx("div",{bind:a.preview,afterCreate:n.attachToNode})};r._renderUnivariateAboveAndBelowRamp=function(a,
d,e){const {sizeRampElement:g,colorRampElement:f}=q.getUnivariateAboveAndBelowRampElements(a,d);if(!g)return null;var h=q.getUnivariateColorRampSize(g,"above",!0);a=q.getUnivariateColorRampSize(g,"below",!0);const l=q.getUnivariateColorRampPreview(f,{width:12,height:h,rampAlignment:"vertical",opacity:d,type:"above",effectList:e});d=q.getUnivariateColorRampPreview(f,{width:12,height:a,rampAlignment:"vertical",opacity:d,type:"below",effectList:e});var m=q.getUnivariateColorRampMargin(g);const k=g.infos.map(u=>
u.label);e=k.map((u,t)=>{const C=2===t;return 0===t?c.tsx("div",{key:t,class:u?l?b.CSS.univariateAboveAndBelowLabel:b.CSS.rampLabel:null},u):C?c.tsx("div",null):null});const p=k.length-1,y=Math.floor(k.length/2),N=k.map((u,t)=>{const C=t===p;return t===y||C?c.tsx("div",{key:t,class:u?l?b.CSS.univariateAboveAndBelowLabel:b.CSS.rampLabel:null},u):null}),O={display:"table-cell",verticalAlign:"middle"};m={marginTop:`${m}px`};h={height:`${h}px`};a={height:`${a}px`};return c.tsx("div",{key:"univariate-above-and-below-ramp-preview",
styles:D},c.tsx("div",{class:b.CSS.layerBody},g.infos.map((u,t)=>c.tsx("div",{class:this.classes(b.CSS.layerRow,b.CSS.sizeRamp)},c.tsx("div",{class:b.CSS.symbol,styles:O,bind:u.preview,afterCreate:n.attachToNode}),l||0!==t%2?null:c.tsx("div",{class:b.CSS.layerInfo},k[t])))),l?c.tsx("div",{styles:m,key:"color-ramp-preview"},c.tsx("div",{styles:A},c.tsx("div",{styles:w},c.tsx("div",{class:b.CSS.rampContainer,bind:l,afterCreate:n.attachToNode})),c.tsx("div",{styles:w},c.tsx("div",{class:b.CSS.rampLabelsContainer,
styles:h},e))),c.tsx("div",{styles:A},c.tsx("div",{styles:w},c.tsx("div",{class:b.CSS.rampContainer,bind:d,afterCreate:n.attachToNode})),c.tsx("div",{styles:w},c.tsx("div",{class:b.CSS.rampLabelsContainer,styles:a},N)))):null)};r._renderUnivariateColorSizeRamp=function(a,d,e){const {sizeRampElement:g,colorRampElement:f}=q.getUnivariateColorSizeRampElements(a);if(!g)return null;var h=q.getUnivariateColorRampMargin(g);a=q.getUnivariateColorRampSize(g,"full",!1);d=q.getUnivariateColorRampPreview(f,{width:12,
height:a,rampAlignment:"vertical",opacity:d,type:"full",effectList:e});const l=g.infos.length-1;e=g.infos.map((k,p)=>0===p||p===l?c.tsx("div",{key:p,class:k.label?f?b.CSS.univariateAboveAndBelowLabel:b.CSS.rampLabel:null},k.label):null);const m={display:"table-cell",verticalAlign:"middle"};h={marginTop:`${h}px`};a={height:`${a}px`};return c.tsx("div",{key:"univariate-above-and-below-ramp-preview",styles:D},c.tsx("div",{class:b.CSS.layerBody},g.infos.map(k=>c.tsx("div",{class:this.classes(b.CSS.layerRow,
b.CSS.sizeRamp)},c.tsx("div",{class:b.CSS.symbol,styles:m,bind:k.preview,afterCreate:n.attachToNode})))),c.tsx("div",{styles:h,key:"color-ramp-preview"},c.tsx("div",{styles:A},c.tsx("div",{styles:w},c.tsx("div",{class:b.CSS.rampContainer,bind:d,afterCreate:n.attachToNode})),c.tsx("div",{styles:w},c.tsx("div",{class:b.CSS.rampLabelsContainer,styles:a},e)))))};r._renderLegendForRamp=function(a,d){const e=a.infos,g="heatmap-ramp"===a.type,f="stretch-ramp"===a.type,h=a.preview;h.className=`${b.CSS.colorRamp} ${"opacity-ramp"===
a.type?b.CSS.opacityRamp:""}`;null!=d&&(h.style.opacity=d.toString());a=e.map(l=>c.tsx("div",{class:l.label?b.CSS.rampLabel:null},g?this.messages[l.label]||l.label:f?this._getStretchStopLabel(l):l.label));d={height:h.style.height};return c.tsx("div",{class:b.CSS.layerRow},c.tsx("div",{class:b.CSS.symbolContainer,styles:{width:"24px"}},c.tsx("div",{class:b.CSS.rampContainer,bind:h,afterCreate:n.attachToNode})),c.tsx("div",{class:b.CSS.layerInfo},c.tsx("div",{class:b.CSS.rampLabelsContainer,styles:d},
a)))};r._getStretchStopLabel=function(a){return a.label?this.messages[a.label]+": "+("string"===typeof a.value?a.value:L.formatNumber(a.value,{style:"decimal",notation:a.value.toString().includes("e")?"scientific":"standard"})):""};r._renderLegendForElementInfo=function(a,d,e,g,f){if(a.type)return this._renderLegendForElement(a,d,e,!0);e=null;f=n.isImageryStretchedLegend(d,f);a.preview?e=c.tsx("div",{class:b.CSS.symbol,bind:a.preview,afterCreate:n.attachToNode}):a.src&&(e=this._renderImage(a,d,f));
if(!e)return null;d={[b.CSS.imageryLayerInfoStretched]:f};return c.tsx("div",{class:b.CSS.layerRow},c.tsx("div",{class:this.classes(b.CSS.symbolContainer,{[b.CSS.imageryLayerInfoStretched]:f,[b.CSS.sizeRamp]:!f&&g})},e),c.tsx("div",{class:this.classes(b.CSS.layerInfo,d)},n.getTitle(this.messages,a.label,!1)||""))};r._renderImage=function(a,d,e){const {label:g,src:f,opacity:h}=a;e={[b.CSS.imageryLayerStretchedImage]:e,[b.CSS.symbol]:!e};d={opacity:`${null!=h?h:d.opacity}`};return c.tsx("img",{alt:n.getTitle(this.messages,
g,!1),src:f,border:0,width:a.width,height:a.height,class:this.classes(e),styles:d})};return B}(H);x.__decorate([z.property()],v.prototype,"activeLayerInfos",void 0);x.__decorate([z.property()],v.prototype,"headingLevel",void 0);x.__decorate([z.property(),K.messageBundle("esri/widgets/Legend/t9n/Legend")],v.prototype,"messages",void 0);x.__decorate([z.property({readOnly:!0})],v.prototype,"type",void 0);return v=x.__decorate([G.subclass("esri.widgets.Legend.styles.Classic")],v)});