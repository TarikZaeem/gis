// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.26/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Attachments":function(){define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Error ../core/maybe ../core/reactiveUtils ../core/unitFormatUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/arrayUtils ../core/accessorSupport/decorators/subclass ./Widget ./Attachments/AttachmentsViewModel ./Attachments/support/attachmentUtils ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k,r,l,p,B,x,y){const G={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},P=window.CSS;d=function(O){function L(c,a){c=O.call(this,c,a)||this;c.displayType="auto";c.messages=null;c.messagesUnits=null;c.selectedFile=null;c.submitting=!1;c.viewModel=null;c.visibleElements={...G};c._supportsImageOrientation=P&&P.supports&&P.supports("image-orientation","from-image");c._addAttachmentForm=
null;c._updateAttachmentForm=null;return c}n._inheritsLoose(L,O);var g=L.prototype;g.initialize=function(){this.viewModel||(this.viewModel=new l);this.addHandles([K.on(()=>this.viewModel?.attachmentInfos,"change",()=>this.scheduleRender()),K.on(()=>this.viewModel?.fileInfos,"change",()=>this.scheduleRender()),K.watch(()=>this.viewModel?.mode,()=>this._modeChanged(),K.initial)])};g.loadDependencies=function(){return Promise.all([new Promise((c,a)=>b(["../chunks/calcite-icon"],c,a))])};g.castVisibleElements=
function(c){return{...G,...c}};g.addAttachment=function(){const {_addAttachmentForm:c,viewModel:a}=this;this._set("submitting",!0);this._set("error",null);return a.addAttachment(c).then(v=>{this._set("submitting",!1);this._set("error",null);a.mode="view";return v}).catch(v=>{this._set("submitting",!1);this._set("error",new H("attachments:add-attachment",this.messages.addErrorMessage,v));throw v;})};g.deleteAttachment=function(c){const {viewModel:a}=this;this._set("submitting",!0);this._set("error",
null);return a.deleteAttachment(c).then(v=>{this._set("submitting",!1);this._set("error",null);a.mode="view";return v}).catch(v=>{this._set("submitting",!1);this._set("error",new H("attachments:delete-attachment",this.messages.deleteErrorMessage,v));throw v;})};g.updateAttachment=function(){const {viewModel:c}=this,{_updateAttachmentForm:a}=this;this._set("submitting",!0);this._set("error",null);return c.updateAttachment(a).then(v=>{this._set("submitting",!1);this._set("error",null);c.mode="view";
return v}).catch(v=>{this._set("submitting",!1);this._set("error",new H("attachments:update-attachment",this.messages.updateErrorMessage,v));throw v;})};g.addFile=function(){const c=this.viewModel.addFile(this.selectedFile,this._addAttachmentForm);this.viewModel.mode="view";return c};g.updateFile=function(){const {viewModel:c}=this,a=c.updateFile(this.selectedFile,this._updateAttachmentForm,c.activeFileInfo);c.mode="view";return a};g.deleteFile=function(c){c=this.viewModel.deleteFile(c||this.viewModel.activeFileInfo?.file);
this.viewModel.mode="view";return c};g.render=function(){const {submitting:c,viewModel:a}=this,{state:v}=a;return y.tsx("div",{class:this.classes("esri-attachments","esri-widget")},c?this.renderProgressBar():null,"loading"===v?this.renderLoading():this.renderAttachments(),this.renderErrorMessage())};g.renderErrorMessage=function(){const {error:c,visibleElements:a}=this;return c&&a.errorMessage?y.tsx("div",{key:"error-message",class:"esri-attachments__error-message"},c.message):null};g.renderAttachments=
function(){const {activeFileInfo:c,mode:a,activeAttachmentInfo:v}=this.viewModel;return"add"===a?this.renderAddForm():"edit"===a?this.renderDetailsForm(v||c):this.renderAttachmentContainer()};g.renderLoading=function(){return y.tsx("div",{class:"esri-attachments__loader-container",key:"loader"},y.tsx("div",{class:"esri-attachments__loader"}))};g.renderProgressBar=function(){return this.visibleElements.progressBar?y.tsx("div",{class:"esri-attachments__progress-bar",key:"progress-bar"}):null};g.renderAddForm=
function(){const {submitting:c,selectedFile:a}=this;var v=c||!a,Q=this.visibleElements.cancelAddButton?y.tsx("button",{type:"button",bind:this,disabled:c,onclick:this._cancelForm,class:this.classes("esri-button","esri-button--tertiary","esri-button--small","esri-button--half",c&&"esri-button--disabled")},this.messages.cancel):null;v=this.visibleElements.addSubmitButton?y.tsx("button",{type:"submit",disabled:v,class:this.classes("esri-button","esri-button--secondary","esri-button--small","esri-button--half",
{["esri-button--disabled"]:v})},this.messages.add):null;const D=a?y.tsx("span",{key:"file-name",class:"esri-attachments__file-name"},a.name):null;Q=y.tsx("form",{bind:this,afterCreate:B.storeNode,afterRemoved:B.discardNode,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},y.tsx("fieldset",{class:"esri-attachments__file-fieldset"},D,y.tsx("label",{class:this.classes("esri-attachments__file-label","esri-button","esri-button--secondary")},a?this.messages.changeFile:this.messages.selectFile,
y.tsx("input",{class:"esri-attachments__file-input",type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))),v,Q);return y.tsx("div",{key:"add-form-container",class:"esri-attachments__form-node"},Q)};g.renderDetailsForm=function(c){const {visibleElements:a,viewModel:v,selectedFile:Q,submitting:D}=this;var {abilities:f}=v,A=D||!Q;let J;if(Q){var z=Q.type;J=Q.name;var N=Q.size}else if(c&&"file"in c)z=c.file.type,J=c.file.name,N=c.file.size;else if(c&&"contentType"in c){z=c.contentType;
J=c.name;N=c.size;var F=c.url}var R=f.editing&&f.operations?.delete&&a.deleteButton?y.tsx("button",{key:"delete-button",type:"button",disabled:D,bind:this,onclick:C=>this._submitDeleteAttachment(C,c),class:this.classes("esri-button","esri-button--small","esri-button--tertiary","esri-attachments__delete-button",{["esri-button--disabled"]:D})},this.messages.delete):void 0;A=f.editing&&f.operations?.update&&a.updateButton?y.tsx("button",{disabled:A,key:"update-button",type:"submit",class:this.classes("esri-button",
"esri-button--small","esri-button--third",{["esri-button--disabled"]:A})},this.messages.update):void 0;const m=this.visibleElements.cancelUpdateButton?y.tsx("button",{disabled:D,key:"cancel-button",type:"button",bind:this,onclick:this._cancelForm,class:this.classes("esri-button","esri-button--small","esri-button--tertiary","esri-button--third",{["esri-button--disabled"]:D})},this.messages.cancel):void 0;f=f.editing&&f.operations?.update?y.tsx("fieldset",{key:"file",class:"esri-attachments__file-fieldset"},
y.tsx("span",{key:"file-name",class:"esri-attachments__file-name"},J),y.tsx("label",{class:this.classes("esri-attachments__file-label","esri-button","esri-button--secondary")},this.messages.changeFile,y.tsx("input",{class:"esri-attachments__file-input",type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))):void 0;N=y.tsx("fieldset",{key:"size",class:"esri-attachments__metadata-fieldset"},y.tsx("label",null,E.formatFileSize(this.messagesUnits,N??0)));z=y.tsx("fieldset",{key:"content-type",
class:"esri-attachments__metadata-fieldset"},y.tsx("label",null,z));F=u.isSome(F)?y.tsx("a",{class:"esri-attachments__item-link",href:F,rel:"noreferrer",target:"_blank"},this.renderImageMask(c,400),y.tsx("div",{class:"esri-attachments__item-link-overlay"},y.tsx("span",{class:"esri-attachments__item-link-overlay-icon"},y.tsx("calcite-icon",{icon:"launch"})))):this.renderImageMask(c,400);R=y.tsx("form",{bind:this,afterCreate:B.storeNode,afterRemoved:B.discardNode,"data-node-ref":"_updateAttachmentForm",
onsubmit:C=>this._submitUpdateAttachment(C,c)},y.tsx("div",{class:"esri-attachments__metadata"},N,z),f,y.tsx("div",{class:"esri-attachments__actions"},R,m,A));return y.tsx("div",{key:"edit-form-container",class:"esri-attachments__form-node"},F,R)};g.renderImageMask=function(c,a){return c?"file"in c?this.renderGenericImageMask(c.file.name,c.file.type):this.renderImageMaskForAttachment(c,a):null};g.renderGenericImageMask=function(c,a){var {supportsResizeAttachments:v}=this.viewModel;a=p.getIconPath(a);
v={["esri-attachments__image--resizable"]:v};return y.tsx("div",{class:this.classes("esri-attachments__item-mask--icon","esri-attachments__item-mask")},y.tsx("img",{title:c,alt:c,src:a,class:this.classes(v,"esri-attachments__image")}))};g.renderImageMaskForAttachment=function(c,a){var {supportsResizeAttachments:v}=this.viewModel;if(!c)return null;const {contentType:Q,name:D,url:f}=c;if(!v||!p.isSupportedImage(Q))return this.renderGenericImageMask(D,Q);c=(c=this._getCSSTransform(c))?{transform:c,"image-orientation":"none"}:
{};a=`${f}${f?.includes("?")?"\x26":"?"}w=${a}`;v={["esri-attachments__image--resizable"]:v};return y.tsx("div",{class:this.classes("esri-attachments__item-mask")},y.tsx("img",{styles:c,alt:D,title:D,src:a,class:this.classes(v,"esri-attachments__image")}))};g.renderFile=function(c){const {file:a}=c;return y.tsx("li",{class:"esri-attachments__item",key:a},y.tsx("button",{key:"details-button",bind:this,class:"esri-attachments__item-button",title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,
onclick:()=>this._startEditFile(c),type:"button"},this.renderImageMask(c),y.tsx("label",{class:"esri-attachments__label"},y.tsx("span",{class:"esri-attachments__filename"},a.name||this.messages.noTitle),y.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-chevron-icon",B.isRTL(this.container)?"esri-icon-left":"esri-icon-right")}))))};g.renderAttachmentInfo=function({attachmentInfo:c,displayType:a}){const {viewModel:v,effectiveDisplayType:Q}=this,{abilities:D,supportsResizeAttachments:f}=
v,{contentType:A,name:J,url:z}=c;a=this.renderImageMask(c,"list"===a?48:400);var N=D.editing?y.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-chevron-icon",B.isRTL(this.container)?"esri-icon-left":"esri-icon-right")}):null;N="preview"===Q&&f&&p.isSupportedImage(A)?null:y.tsx("label",{class:"esri-attachments__label"},y.tsx("span",{class:"esri-attachments__filename"},J||this.messages.noTitle),N);a=[a,N];a=D.editing?y.tsx("button",{key:"details-button",bind:this,class:"esri-attachments__item-button",
title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,"data-attachment-info-id":c.id,onclick:()=>this._startEditAttachment(c),type:"button"},a):y.tsx("a",{key:"details-link",class:"esri-attachments__item-button",href:z??void 0,target:"_blank"},a);return y.tsx("li",{class:"esri-attachments__item",key:c},a)};g.renderAttachmentContainer=function(){const {effectiveDisplayType:c,viewModel:a,visibleElements:v}=this,{attachmentInfos:Q,abilities:D,fileInfos:f}=a;var A=!!Q?.length;
const J=!!f?.length,z={["esri-attachments__container--list"]:"preview"!==c,["esri-attachments__container--preview"]:"preview"===c},N=D.editing&&D.operations?.add&&v.addButton?y.tsx("button",{bind:this,onclick:()=>this._startAddAttachment(),class:this.classes("esri-button","esri-button--tertiary","esri-attachments__add-attachment-button"),type:"button"},y.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-add-icon","esri-icon-plus")}),this.messages.add):void 0,F=A?y.tsx("ul",
{key:"attachments-list",class:"esri-attachments__items"},Q.toArray().map(m=>this.renderAttachmentInfo({attachmentInfo:m,displayType:c}))):void 0,R=J?y.tsx("ul",{key:"file-list",class:"esri-attachments__items"},f.toArray().map(m=>this.renderFile(m))):void 0;A=J||A?void 0:y.tsx("div",{class:"esri-widget__content--empty"},this.messages.noAttachments);return y.tsx("div",{key:"attachments-container",class:this.classes("esri-attachments__container",z)},F,R,A,N)};g._modeChanged=function(){this._set("error",
null);this._set("selectedFile",null)};g._handleFileInputChange=function(c){c=(c=c.target)&&c.files&&c.files.item(0);this._set("selectedFile",c)};g._submitDeleteAttachment=function(c,a){c.preventDefault();a&&("file"in a?this.deleteFile(a.file):a&&this.deleteAttachment(a))};g._submitAddAttachment=function(c){c.preventDefault();this.viewModel.filesEnabled?this.addFile():this.addAttachment()};g._submitUpdateAttachment=function(c,a){c.preventDefault();a&&"file"in a?this.updateFile():this.updateAttachment()};
g._startEditAttachment=function(c){const {viewModel:a}=this;a.activeFileInfo=null;a.activeAttachmentInfo=c;a.mode="edit"};g._startEditFile=function(c){const {viewModel:a}=this;a.activeAttachmentInfo=null;a.activeFileInfo=c;a.mode="edit"};g._startAddAttachment=function(){this.viewModel.mode="add"};g._cancelForm=function(c){c.preventDefault();this.viewModel.mode="view"};g._getCSSTransform=function(c){({orientationInfo:c}=c);return!this._supportsImageOrientation&&c?[c.rotation?`rotate(${c.rotation}deg)`:
"",c.mirrored?"scaleX(-1)":""].join(" "):""};n._createClass(L,[{key:"abilities",get:function(){return this.viewModel.abilities},set:function(c){this.viewModel.abilities=c}},{key:"effectiveDisplayType",get:function(){const {displayType:c}=this;return c&&"auto"!==c?c:this.viewModel.supportsResizeAttachments?"preview":"list"}},{key:"graphic",get:function(){return this.viewModel.graphic},set:function(c){this.viewModel.graphic=c}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(c){this._overrideIfSome("label",
c)}}]);return L}(r);e.__decorate([h.property()],d.prototype,"abilities",null);e.__decorate([h.property()],d.prototype,"displayType",void 0);e.__decorate([h.property({readOnly:!0})],d.prototype,"effectiveDisplayType",null);e.__decorate([h.property()],d.prototype,"graphic",null);e.__decorate([h.property()],d.prototype,"label",null);e.__decorate([h.property(),x.messageBundle("esri/widgets/Attachments/t9n/Attachments")],d.prototype,"messages",void 0);e.__decorate([h.property(),x.messageBundle("esri/core/t9n/Units")],
d.prototype,"messagesUnits",void 0);e.__decorate([h.property({readOnly:!0})],d.prototype,"selectedFile",void 0);e.__decorate([h.property({readOnly:!0})],d.prototype,"submitting",void 0);e.__decorate([h.property({readOnly:!0})],d.prototype,"error",void 0);e.__decorate([h.property({type:l})],d.prototype,"viewModel",void 0);e.__decorate([h.property()],d.prototype,"visibleElements",void 0);e.__decorate([t.cast("visibleElements")],d.prototype,"castVisibleElements",null);return d=e.__decorate([k.subclass("esri.widgets.Attachments")],
d)})},"esri/core/unitFormatUtils":function(){define("exports ./byteSizeEstimations ./Cyclical ./mathUtils ./maybe ./string ./unitUtils ../intl/number".split(" "),function(b,n,e,H,u,K,E,h){function t(B,x,y){return B.units[x][y]}function d(B,x,y,G=2,P="abbr"){return`${h.formatNumber(x,{minimumFractionDigits:G,maximumFractionDigits:G,signDisplay:0<x?"never":"exceptZero"})} ${t(B,y,P)}`}function k(B,x,y,G=2,P="abbr"){return`${h.formatNumber(x,{minimumFractionDigits:G,maximumFractionDigits:G,signDisplay:"exceptZero"})} ${t(B,
y,P)}`}function r(B,x){const y=JSON.stringify(x);let G=l.get(y);G||(G=new Intl.NumberFormat("en-US",x),l.set(y,G));return/\-?\+?360/.test(G.format(B))?0:B}const l=new Map,p=["B","kB","MB","GB","TB"];b.formatAngleDegrees=function(B,x,y,G,P){P=u.unwrapOr(P,2);var O=e.cyclicalDegrees,L=O.normalize;a:if(B=E.convertUnit(B,x,"degrees"),y===G)y=B;else{switch(G){case "arithmetic":y=-B+90;break a;case "geographic":y=-B-90;break a}y=void 0}O=L.call(O,y,0,!0);P={style:"unit",unitDisplay:"narrow",unit:"degree",
maximumFractionDigits:P,minimumFractionDigits:P,signDisplay:0<O?"never":"exceptZero"};O=r(O,P);return h.formatNumber(O,P)};b.formatDMS=function(B,x,y=2){B=E.convertUnit(B,x,"degrees");x=B-Math.floor(B);B-=x;x*=60;let G=x-Math.floor(x);x-=G;G*=60;return`${B.toFixed()}\u00b0 ${x.toFixed()}' ${G.toFixed(y)}"`};b.formatDecimal=d;b.formatFileSize=function(B,x){let y=0===x?0:Math.floor(Math.log(x)/Math.log(n.ByteSizeUnit.KILOBYTES));y=H.clamp(y,0,p.length-1);x=h.formatNumber(x/n.ByteSizeUnit.KILOBYTES**
y,{maximumFractionDigits:2});return K.replace(B.units.bytes[p[y]],{fileSize:x})};b.formatImperialArea=function(B,x,y,G=2,P="abbr"){const O=E.preferredImperialAreaUnit(x,y);return d(B,E.convertUnit(x,y,O),O,G,P)};b.formatImperialLength=function(B,x,y,G=2,P="abbr"){const O=E.preferredImperialLengthUnit(x,y);return d(B,E.convertUnit(x,y,O),O,G,P)};b.formatImperialRelativeLength=function(B,x,y,G=2,P="abbr"){const O=E.preferredImperialLengthUnit(x,y);return k(B,E.convertUnit(x,y,O),O,G,P)};b.formatImperialRelativeVerticalLength=
function(B,x,y,G=2,P="abbr"){const O=E.preferredImperialVerticalLengthUnit(x,y);return k(B,E.convertUnit(x,y,O),O,G,P)};b.formatImperialVerticalLength=function(B,x,y,G=2,P="abbr"){const O=E.preferredImperialVerticalLengthUnit(x,y);return d(B,E.convertUnit(x,y,O),O,G,P)};b.formatMetricArea=function(B,x,y,G=2,P="abbr"){const O=E.preferredMetricAreaUnit(x,y);return d(B,E.convertUnit(x,y,O),O,G,P)};b.formatMetricLength=function(B,x,y,G=2,P="abbr"){const O=E.preferredMetricLengthUnit(x,y);return d(B,E.convertUnit(x,
y,O),O,G,P)};b.formatMetricRelativeLength=function(B,x,y,G=2,P="abbr"){const O=E.preferredMetricLengthUnit(x,y);return k(B,E.convertUnit(x,y,O),O,G,P)};b.formatMetricRelativeVerticalLength=function(B,x,y,G=2,P="abbr"){const O=E.preferredMetricVerticalLengthUnit(x,y);return k(B,E.convertUnit(x,y,O),O,G,P)};b.formatMetricVerticalLength=function(B,x,y,G=2,P="abbr"){const O=E.preferredMetricVerticalLengthUnit(x,y);return d(B,E.convertUnit(x,y,O),O,G,P)};b.formatRelativeAngleDegrees=function(B,x,y,G,P){y!==
G&&(B=-B);P=u.unwrapOr(P,2);y={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:P,minimumFractionDigits:P,signDisplay:"exceptZero"};B=E.convertUnit(B,x,"degrees")%360;B=r(B,y);return h.formatNumber(B,y)};b.formatRelativeDecimal=k;b.unitName=t;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/byteSizeEstimations":function(){define(["exports"],function(b){function n(u){return 32+u.length}function e(u){if(!u)return 0;if(Array.isArray(u)){var K=u.length;if(0===
K||"number"===typeof u[0])u=32+8*K;else{var E=32;for(let h=0;h<K;h++)E+=H(u[h]);u=E}return u}E=32;for(K in u)u.hasOwnProperty(K)&&(E+=H(u[K]));return E}function H(u){switch(typeof u){case "object":return e(u);case "string":return n(u);case "number":return 16;case "boolean":return 4;default:return 8}}b.ByteSizeUnit=void 0;(function(u){u[u.KILOBYTES=1024]="KILOBYTES";u[u.MEGABYTES=1048576]="MEGABYTES";u[u.GIGABYTES=1073741824]="GIGABYTES"})(b.ByteSizeUnit||(b.ByteSizeUnit={}));b.estimateAttributesObjectSize=
function(u){if(!u)return 0;let K=32;for(const E in u)if(u.hasOwnProperty(E)){const h=u[E];switch(typeof h){case "string":K+=n(h);break;case "number":K+=16;break;case "boolean":K+=4}}return K};b.estimateFixedArraySize=function(u,K){return 32+u.length*K};b.estimateNestedObjectSize=e;b.estimateNumberByteSize=function(u){return 16};b.estimateStringByteSize=n;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Attachments/AttachmentsViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Graphic ../../core/Accessor ../../core/Collection ../../core/Error ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass ../../rest/query/support/AttachmentInfo ../../rest/support/AttachmentQuery ../Feature/support/featureUtils".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k,r,l,p,B){const x={editing:!1,operations:{add:!0,update:!0,delete:!0}},y=u.ofType(l);H=function(G){function P(L){var g=G.call(this,L)||this;g._getAttachmentsPromise=null;g._attachmentLayer=null;g.abilities={...x};g.activeAttachmentInfo=null;g.activeFileInfo=null;g.attachmentInfos=new y;g.fileInfos=new u;g.graphic=null;g.mode="view";g.filesEnabled=!1;g.addHandles(h.watch(()=>g.graphic,()=>g._graphicChanged(),h.initial));return g}b._inheritsLoose(P,G);var O=P.prototype;
O.destroy=function(){this.graphic=this._attachmentLayer=null};O.castAbilities=function(L){return{...x,...L}};O.getAttachments=function(){var L=b._asyncToGenerator(function*(){const {_attachmentLayer:g,attachmentInfos:c}=this;if(!g||"function"!==typeof g.queryAttachments)throw new K("invalid-layer","getAttachments(): A valid layer is required.");const a=this._getObjectId();var v=new p({objectIds:[a],returnMetadata:!0});const Q=[];this._getAttachmentsPromise=v=g.queryAttachments(v).then(D=>D[a]||Q).catch(()=>
Q);this.notifyChange("state");v=yield v;c.removeAll();v.length&&c.addMany(v);this._getAttachmentsPromise=null;this.notifyChange("state");return v});return function(){return L.apply(this,arguments)}}();O.addAttachment=function(){var L=b._asyncToGenerator(function*(g,c=this.graphic){const {_attachmentLayer:a,attachmentInfos:v,abilities:Q}=this;if(!c)throw new K("invalid-graphic","addAttachment(): A valid graphic is required.",{graphic:c});if(!g)throw new K("invalid-attachment","addAttachment(): An attachment is required.",
{attachment:g});if(!Q.operations?.add)throw new K("invalid-abilities","addAttachment(): add abilities are required.");if(!a||"function"!==typeof a.addAttachment)throw new K("invalid-layer","addAttachment(): A valid layer is required.");g=yield a.addAttachment(c,g).then(D=>this._queryAttachment(D.objectId,c));v.add(g);return g});return function(g){return L.apply(this,arguments)}}();O.deleteAttachment=function(){var L=b._asyncToGenerator(function*(g){const {_attachmentLayer:c,attachmentInfos:a,graphic:v,
abilities:Q}=this;if(!g)throw new K("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:g});if(!Q.operations?.delete)throw new K("invalid-abilities","deleteAttachment(): delete abilities are required.");if(!c||"function"!==typeof c.deleteAttachments)throw new K("invalid-layer","deleteAttachment(): A valid layer is required.");if(!v)throw new K("invalid-graphic","deleteAttachment(): A graphic is required.");const D=yield c.deleteAttachments(v,[g.id]).then(()=>
g);a.remove(D);return D});return function(g){return L.apply(this,arguments)}}();O.updateAttachment=function(){var L=b._asyncToGenerator(function*(g,c=this.activeAttachmentInfo){const {_attachmentLayer:a,attachmentInfos:v,graphic:Q,abilities:D}=this;if(!g)throw new K("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:g});if(!c)throw new K("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:c});if(!D.operations?.update)throw new K("invalid-abilities",
"updateAttachment(): Update abilities are required.");const f=v.findIndex(A=>A===c);if(!a||"function"!==typeof a.updateAttachment)throw new K("invalid-layer","updateAttachment(): A valid layer is required.");if(!Q)throw new K("invalid-graphic","updateAttachment(): A graphic is required.");g=yield a.updateAttachment(Q,c.id,g).then(A=>this._queryAttachment(A.objectId));v.splice(f,1,g);return g});return function(g){return L.apply(this,arguments)}}();O.commitFiles=function(){var L=b._asyncToGenerator(function*(){yield Promise.all(this.fileInfos.items.map(g=>
this.addAttachment(g.form)));this.fileInfos.removeAll();return this.getAttachments()});return function(){return L.apply(this,arguments)}}();O.addFile=function(L,g){if(!L||!g)return null;L={file:L,form:g};this.fileInfos.add(L);return L};O.updateFile=function(L,g,c=this.activeFileInfo){if(!L||!g||!c)return null;const a=this.fileInfos.findIndex(v=>c===v);-1<a&&this.fileInfos.splice(a,1,{file:L,form:g});return this.fileInfos.items[a]};O.deleteFile=function(L){const g=this.fileInfos.find(c=>c.file===L);
return g?(this.fileInfos.remove(g),g):null};O._queryAttachment=function(){var L=b._asyncToGenerator(function*(g,c){const {_attachmentLayer:a}=this;if(!g||!a?.queryAttachments)throw new K("invalid-attachment-id","Could not query attachment.");const v=this._getObjectId(c);g=new p({objectIds:[v],attachmentsWhere:`AttachmentId=${g}`,returnMetadata:!0});return a.queryAttachments(g).then(Q=>Q[v][0])});return function(g,c){return L.apply(this,arguments)}}();O._getObjectId=function(L=this.graphic){return L?.getObjectId()??
null};O._graphicChanged=function(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch(()=>{}))};O._setAttachmentLayer=function(){var {graphic:L}=this;this._attachmentLayer=(L=B.getSourceLayer(L))?"scene"===L.type&&E.isSome(L.associatedLayer)?L.associatedLayer:L:null};b._createClass(P,[{key:"state",get:function(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}},{key:"supportsResizeAttachments",get:function(){var {graphic:L}=this;if(!L)return!1;L=L.layer||
L.sourceLayer;return L?.loaded&&"capabilities"in L&&L.capabilities&&"operations"in L.capabilities&&"supportsResizeAttachments"in L.capabilities.operations&&L.capabilities.operations.supportsResizeAttachments||!1}}]);return P}(H);n.__decorate([t.property()],H.prototype,"abilities",void 0);n.__decorate([d.cast("abilities")],H.prototype,"castAbilities",null);n.__decorate([t.property()],H.prototype,"activeAttachmentInfo",void 0);n.__decorate([t.property()],H.prototype,"activeFileInfo",void 0);n.__decorate([t.property({readOnly:!0,
type:y})],H.prototype,"attachmentInfos",void 0);n.__decorate([t.property()],H.prototype,"fileInfos",void 0);n.__decorate([t.property({type:e})],H.prototype,"graphic",void 0);n.__decorate([t.property()],H.prototype,"mode",void 0);n.__decorate([t.property({readOnly:!0})],H.prototype,"state",null);n.__decorate([t.property()],H.prototype,"filesEnabled",void 0);n.__decorate([t.property({readOnly:!0})],H.prototype,"supportsResizeAttachments",null);return H=n.__decorate([r.subclass("esri.widgets.Attachments.AttachmentsViewModel")],
H)})},"esri/rest/query/support/AttachmentInfo":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ../../../layers/support/exifUtils".split(" "),function(b,n,e,H,u,K,E,h){var t;const d={1:{id:1,rotation:0,mirrored:!1},2:{id:2,rotation:0,mirrored:!0},3:{id:3,rotation:180,mirrored:!1},
4:{id:4,rotation:180,mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}};e=t=function(k){function r(l){l=k.call(this,l)||this;l.contentType=null;l.exifInfo=null;l.id=null;l.globalId=null;l.keywords=null;l.name=null;l.parentGlobalId=null;l.parentObjectId=null;l.size=null;l.url=null;return l}b._inheritsLoose(r,k);r.prototype.clone=function(){return new t({contentType:this.contentType,exifInfo:this.exifInfo,
id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})};b._createClass(r,[{key:"orientationInfo",get:function(){var {exifInfo:l}=this;l=h.getExifValue({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:l});return d[l]||null}}]);return r}(e.JSONSupport);n.__decorate([H.property({type:String})],e.prototype,"contentType",void 0);n.__decorate([H.property()],e.prototype,"exifInfo",void 0);
n.__decorate([H.property({readOnly:!0})],e.prototype,"orientationInfo",null);n.__decorate([H.property({type:u.Integer})],e.prototype,"id",void 0);n.__decorate([H.property({type:String})],e.prototype,"globalId",void 0);n.__decorate([H.property({type:String})],e.prototype,"keywords",void 0);n.__decorate([H.property({type:String})],e.prototype,"name",void 0);n.__decorate([H.property({json:{read:!1}})],e.prototype,"parentGlobalId",void 0);n.__decorate([H.property({json:{read:!1}})],e.prototype,"parentObjectId",
void 0);n.__decorate([H.property({type:u.Integer})],e.prototype,"size",void 0);n.__decorate([H.property({json:{read:!1}})],e.prototype,"url",void 0);return e=t=n.__decorate([E.subclass("esri.layers.support.AttachmentInfo")],e)})},"esri/layers/support/exifUtils":function(){define(["exports"],function(b){function n(e){const {tagName:H,tags:u}=e;return u&&H?(e=u.find(K=>K.name===H))&&e.value||null:null}b.getExifValue=function(e){const {exifInfo:H,exifName:u,tagName:K}=e;return H&&u&&K?(e=H.find(E=>E.name===
u))?n({tagName:K,tags:e.tags}):null:null};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/support/featureUtils":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../intl ../../../core/Logger ../../../core/maybe ../../../core/string ../../../intl/date ../../../intl/number ../../../layers/support/fieldUtils ../../../layers/support/layerUtils ../../../popup/support/FieldInfoFormat ../../../support/arcadeOnDemand".split(" "),function(b,n,
e,H,u,K,E,h,t,d,k,r){function l(){l=n._asyncToGenerator(function*(Z,da){return"function"===typeof Z?Z.call(null,da):Z});return l.apply(this,arguments)}function p(Z){return Z?Y.test(Z):!1}function B(Z,da){if(!p(da)||!Z)return null;const fa=da.replace(Y,"").toLowerCase();let X=null;Z.some(aa=>aa.name.toLowerCase()===fa?(X=aa,!0):!1);return X}function x(Z,da){return(da=y(da,Z))?da.name:Z}function y(Z,da){return Z&&"function"===typeof Z.getField&&da?Z.getField(da)??null:null}function G({formattedAttributes:Z,
template:da,fieldInfoMap:fa}){return`${K.replace(K.replace(da,X=>{const aa=fa.get(X.toLowerCase());return`{${aa&&aa.fieldName||X}}`}),Z).replace(U,"")}`.trim()}function P(Z,da,fa=!1){const X=da[Z];"string"===typeof X&&(fa=(fa?encodeURIComponent(X):X).replace(S,"%27"),da[Z]=fa)}function O(Z,da=!1){const fa={...Z};Object.keys(fa).forEach(X=>P(X,fa,da));return fa}function L(Z,da){return Z.replace(T,(fa,X,aa)=>(fa=y(da,aa))?`{${fa.name}}`:X)}function g(Z,da,fa){return(Z=L(Z,fa))?Z.replace(oa,(X,aa,ea)=>
{aa=`${aa||ea}`.trim();return K.replace(X,O(da,aa&&"{"!==aa[0]||!1))}):Z}function c(Z,da){var fa=da.fieldName,X=a(da.fieldInfos,fa)?.clone();const aa=da.preventPlacesFormatting;da=da.layer;var ea=y(da,fa);X&&"date"===ea?.type&&(ea=X.format||new k,ea.dateFormat=ea.dateFormat||"short-date-short-time",ea.dateTimeFormatOptions=!da?.layer&&"feature"===da?.type&&da.datesInUnknownTimezone||da?.layer&&"map-image"===da.layer?.type&&da.layer.datesInUnknownTimezone?{timeZone:"UTC"}:null,X.format=ea);X=X&&X.format;
if("string"===typeof Z&&t.isRasterPixelValueField(fa)&&X)return X.formatRasterPixelValue(Z);"string"!==typeof Z||!X||null!=X.dateFormat||null==X.places&&null==X.digitSeparator||(fa=Number(Z),isNaN(fa)||(Z=fa));return"string"===typeof Z||null==Z||null==X?D(Z):aa?h.formatNumber(Z,{...h.convertNumberFormatToIntlOptions(X),minimumFractionDigits:0,maximumFractionDigits:20}):X.format(Z)}function a(Z,da){if(Z&&Z.length&&da){var fa=da.toLowerCase(),X=void 0;Z.some(aa=>aa.fieldName&&aa.fieldName.toLowerCase()===
fa?(X=aa,!0):!1);return X}}function v({fieldName:Z,graphic:da,layer:fa}){if(R(Z)||!fa||"function"!==typeof fa.getFeatureType)return null;const {typeIdField:X}=fa;return X&&Z===X?(Z=fa.getFeatureType(da))?Z.name:null:null}function Q({fieldName:Z,value:da,graphic:fa,layer:X}){return R(Z)||!X||"function"!==typeof X.getFieldDomain?null:(Z=fa&&X.getFieldDomain(Z,{feature:fa}))&&"coded-value"===Z.type?Z.getName(da):null}function D(Z){return"string"===typeof Z?Z.replace(ha,'\x3cbr class\x3d"esri-text-new-line" /\x3e'):
Z}function f(Z){const {value:da,fieldName:fa,fieldInfos:X,fieldInfoMap:aa,layer:ea,graphic:ba}=Z;return null==da?"":(Z=Q({fieldName:fa,value:da,graphic:ba,layer:ea}))||(Z=v({fieldName:fa,graphic:ba,layer:ea}))?Z:aa.get(fa.toLowerCase())?c(da,{fieldInfos:X||Array.from(aa.values()),fieldName:fa,layer:ea}):(Z=ea&&ea.fieldsIndex)&&Z.isDateField(fa)?E.formatDate(da,ta):D(da)}function A(Z,da){return J.apply(this,arguments)}function J(){J=n._asyncToGenerator(function*(Z,da){const {layer:fa,graphic:X,outFields:aa,
objectIds:ea,returnGeometry:ba,spatialReference:ia}=Z;Z=ea[0];if("number"!==typeof Z&&"string"!==typeof Z)return w.warn("Could not query required fields for the specified feature. The feature's ID is invalid.",{layer:fa,graphic:X,objectId:Z,requiredFields:aa}),null;if(!d.getEffectiveLayerCapabilities(fa)?.operations?.supportsQuery)return w.warn("The specified layer cannot be queried. The following fields will not be available.",{layer:fa,graphic:X,requiredFields:aa,returnGeometry:ba}),null;Z=fa.createQuery();
Z.objectIds=ea;Z.outFields=aa?.length?aa:[fa.objectIdField];Z.returnGeometry=!!ba;Z.returnZ=!!ba;Z.returnM=!!ba;Z.outSpatialReference=ia;return(yield fa.queryFeatures(Z,da)).features[0]});return J.apply(this,arguments)}function z(Z){return N.apply(this,arguments)}function N(){N=n._asyncToGenerator(function*(Z){if(!Z.expressionInfos?.length)return!1;var da=yield r.loadArcade();({arcadeUtils:{hasGeometryFunctions:da}}=da);return da(Z)});return N.apply(this,arguments)}function F(){F=n._asyncToGenerator(function*({graphic:Z,
popupTemplate:da,layer:fa,spatialReference:X},aa){if(fa&&da&&("function"===typeof fa.load&&(yield fa.load(aa)),Z.attributes)){var ea=Z.attributes[fa.objectIdField];if(null!=ea){ea=[ea];var ba=yield da.getRequiredFields(fa.fieldsIndex),ia=t.featureHasFields(ba,Z);ba=ia?[]:ba;da=da.returnGeometry||(yield z(da));if(!ia||da)if(fa=yield A({layer:fa,graphic:Z,outFields:ba,objectIds:ea,returnGeometry:da,spatialReference:X},aa))fa.geometry&&(Z.geometry=fa.geometry),fa.attributes&&(Z.attributes={...Z.attributes,
...fa.attributes})}}});return F.apply(this,arguments)}function R(Z=""){return Z?Z.includes("relationships/"):!1}function m({attributes:Z,graphic:da,relatedInfo:fa,fieldInfos:X,fieldInfoMap:aa,layer:ea}){Z&&da&&fa&&Object.keys(da.attributes).forEach(ba=>{var ia=(ia={layerId:fa.relation.id.toString(),fieldName:ba},`${"relationships/"}${ia.layerId}/${ia.fieldName}`);Z[ia]=f({fieldName:ia,fieldInfos:X,fieldInfoMap:aa,layer:ea,value:da.attributes[ba],graphic:da})})}function C({attributes:Z,relatedInfo:da,
fieldInfoMap:fa,fieldInfos:X,layer:aa}){Z&&da&&(da.relatedFeatures&&da.relatedFeatures&&da.relatedFeatures.forEach(ea=>m({attributes:Z,graphic:ea,relatedInfo:da,fieldInfoMap:fa,fieldInfos:X,layer:aa})),da.relatedStatsFeatures&&da.relatedStatsFeatures&&da.relatedStatsFeatures.forEach(ea=>m({attributes:Z,graphic:ea,relatedInfo:da,fieldInfoMap:fa,fieldInfos:X,layer:aa})))}function M(Z,da,fa){return Z.find(X=>X!==da&&"feature"===X.type&&X.url===da.url&&X.layerId===fa.relatedTableId)}const w=H.getLogger("esri.widgets.Feature.support.featureUtils"),
U=/href=(""|'')/gi,T=/(\{([^\{\r\n]+)\})/g,S=/'/g,Y=/^\s*expression\//i,ha=/(\n)/gi,ja=/[\u00A0-\u9999<>&]/gim,oa=/href\s*=\s*(?:"([^"]+)"|'([^']+)')/gi,ra=/^(?:mailto:|tel:)/,ta=E.convertDateFormatToIntlOptions("short-date-short-time"),ua=Z=>{if(!Z)return!1;Z=Z.toUpperCase();return Z.includes("CURRENT_TIMESTAMP")||Z.includes("CURRENT_DATE")||Z.includes("CURRENT_TIME")},Aa=({layer:Z,method:da,query:fa,definitionExpression:X})=>{Z.capabilities?.query?.supportsCacheHint&&"attachments"!==da&&(Z=u.isSome(fa.where)?
fa.where:null,da=u.isSome(fa.geometry)?fa.geometry:null,ua(X)||ua(Z)||"extent"===da?.type||"tile"===fa.resultType||(fa.cacheHint=!0))};b.applyTextFormattingHTML=D;b.createfieldInfoMap=function(Z,da){const fa=new Map;if(!Z)return fa;Z.forEach(X=>{const aa=x(X.fieldName,da);X.fieldName=aa;fa.set(aa.toLowerCase(),X)});return fa};b.findRelatedLayer=function(Z,da,fa){return Z&&da&&fa?M(Z.allLayers,da,fa)||M(Z.allTables,da,fa):null};b.fixTokens=L;b.formatAttributes=function({fieldInfos:Z,attributes:da,
layer:fa,graphic:X,fieldInfoMap:aa,relatedInfos:ea}){const ba={};ea?.forEach(ia=>C({attributes:ba,relatedInfo:ia,fieldInfoMap:aa,fieldInfos:Z,layer:fa}));da&&Object.keys(da).forEach(ia=>{ba[ia]=f({fieldName:ia,fieldInfos:Z,fieldInfoMap:aa,layer:fa,value:da[ia],graphic:X})});return ba};b.formatEditInfo=function(Z,da){const {creatorField:fa,creationDateField:X,editorField:aa,editDateField:ea}=Z;if(da){Z=da[ea];if("number"===typeof Z)return da=da[aa],{type:"edit",date:E.formatDate(Z,ta),user:da};Z=da[X];
return"number"===typeof Z?(da=da[fa],{type:"create",date:E.formatDate(Z,ta),user:da}):null}};b.formatValueToFieldInfo=c;b.getAllFieldInfos=function(Z){const da=[];if(!Z)return da;const {fieldInfos:fa,content:X}=Z;fa&&da.push(...fa);if(!X||!Array.isArray(X))return da;X.forEach(aa=>{"fields"===aa.type&&(aa=aa&&aa.fieldInfos)&&da.push(...aa)});return da};b.getFieldInfo=a;b.getFieldInfoLabel=function(Z,da){return(da=B(da,Z?.fieldName))?da.title||null:Z?Z.label||Z.fieldName:null};b.getFixedFieldName=x;
b.getFixedFieldNames=function(Z,da){return Z&&Z.map(fa=>x(fa,da))};b.getSourceLayer=function(Z){if(!u.isNone(Z))return Z.get("sourceLayer")||Z.get("layer")};b.graphicCallback=function(Z,da){return l.apply(this,arguments)};b.htmlEntities=function(Z){return Z.replace(ja,da=>`&#${da.charCodeAt(0)};`)};b.isExpressionField=p;b.isRelatedField=R;b.preLayerQueryCallback=({query:Z,layer:da,method:fa})=>{Aa({layer:da,method:fa,query:Z,definitionExpression:`${da.definitionExpression} ${da.serviceDefinitionExpression}`})};
b.preRequestCallback=({queryPayload:Z,layer:da,method:fa})=>{Aa({layer:da,method:fa,query:Z,definitionExpression:`${da.definitionExpression} ${da.serviceDefinitionExpression}`})};b.querySourceLayer=A;b.queryUpdatedFeature=function(Z,da){return F.apply(this,arguments)};b.shouldOpenInNewTab=function(Z=""){if(Z)return!ra.test(Z.trim().toLowerCase())};b.substituteAttributes=G;b.substituteFieldsInLinksAndAttributes=function({attributes:Z,globalAttributes:da,layer:fa,text:X,expressionAttributes:aa,fieldInfoMap:ea}){return X?
G({formattedAttributes:da,template:g(X,{...da,...aa,...Z},fa),fieldInfoMap:ea}):""};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Attachments/support/attachmentUtils":function(){define(["exports","../../../assets"],function(b,n){b.getIconPath=function(e){const H=n.getAssetUrl("esri/themes/base/images/files/");return e?"text/plain"===e?`${H}text-32.svg`:"application/pdf"===e?`${H}pdf-32.svg`:"text/csv"===e?`${H}csv-32.svg`:"application/gpx+xml"===e?`${H}gpx-32.svg`:
"application/x-dwf"===e?`${H}cad-32.svg`:"application/postscript"===e||"application/json"===e||"text/xml"===e||"model/vrml"===e?`${H}code-32.svg`:"application/x-zip-compressed"===e||"application/x-7z-compressed"===e||"application/x-gzip"===e||"application/x-tar"===e||"application/x-gtar"===e||"application/x-bzip2"===e||"application/gzip"===e||"application/x-compress"===e||"application/x-apple-diskimage"===e||"application/x-rar-compressed"===e||"application/zip"===e?`${H}zip-32.svg`:e.includes("image/")?
`${H}image-32.svg`:e.includes("audio/")?`${H}sound-32.svg`:e.includes("video/")?`${H}video-32.svg`:e.includes("msexcel")||e.includes("ms-excel")||e.includes("spreadsheetml")?`${H}excel-32.svg`:e.includes("msword")||e.includes("ms-word")||e.includes("wordprocessingml")?`${H}word-32.svg`:e.includes("powerpoint")||e.includes("presentationml")?`${H}report-32.svg`:`${H}generic-32.svg`:`${H}generic-32.svg`};b.isSupportedImage=function(e){e=e.toLowerCase();return"image/bmp"===e||"image/emf"===e||"image/exif"===
e||"image/gif"===e||"image/x-icon"===e||"image/jpeg"===e||"image/png"===e||"image/tiff"===e||"image/x-wmf"===e};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/FeatureForm":function(){define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../intl ../core/compilerUtils ../core/maybe ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/accessorSupport/decorators/subclass ../layers/support/domainUtils ../layers/support/fieldUtils ./Widget ./FeatureForm/css ./FeatureForm/featureFormUtils ./FeatureForm/FeatureFormViewModel ./support/Heading ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory ../chunks/datetime ../intl/locale".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k,r,l,p,B,x,y,G,P,O,L,g,c,a){H=function(v){function Q(f,A){var J=v.call(this,f,A)||this;J._dateInputFieldMap=new Map;J._activeInputName="";J._activeNumberFieldEdit=null;J._fieldFocusNeeded=!1;J._fieldToInitialIncompatibleDomainValue=new Map;J._switchFieldsWithInitialIncompatibleValue=new Set;J._userUpdatedInputFieldNames=new Set;J.disabled=!1;J.groupDisplay="all";J.headingLevel=2;J.messages=null;J.messagesTemplates=null;J.viewModel=new y;J._handleInputInput=z=>{J._commitInputValue(z.currentTarget)};
J._handleFormKeyDown=J._handleFormKeyDown.bind(n._assertThisInitialized(J));J._handleInputBlur=J._handleInputBlur.bind(n._assertThisInitialized(J));J._handleInputFocus=J._handleInputFocus.bind(n._assertThisInitialized(J));J._handleNumberInputMouseDown=J._handleNumberInputMouseDown.bind(n._assertThisInitialized(J));J._handleInputKeyDown=J._handleInputKeyDown.bind(n._assertThisInitialized(J));J._handleOptionChange=J._handleOptionChange.bind(n._assertThisInitialized(J));J._handleGroupClick=J._handleGroupClick.bind(n._assertThisInitialized(J));
J._handleSubmit=J._handleSubmit.bind(n._assertThisInitialized(J));J._afterInputCreateOrUpdate=J._afterInputCreateOrUpdate.bind(n._assertThisInitialized(J));J._afterDateInputCreateOrUpdate=J._afterDateInputCreateOrUpdate.bind(n._assertThisInitialized(J));return J}n._inheritsLoose(Q,v);var D=Q.prototype;D.initialize=function(){this.addHandles([E.watch(()=>this.feature,()=>{this._activeInputName=this._getFocusableInput("forward")?.name||"";this._userUpdatedInputFieldNames.clear();this._fieldToInitialIncompatibleDomainValue.clear();
this._switchFieldsWithInitialIncompatibleValue.clear();this._dateInputFieldMap.clear();this._fieldFocusNeeded=!0}),this.on("submit",f=>{if(0<f.invalid.length){const [A]=f.invalid;f.invalid.forEach(J=>this._userUpdatedInputFieldNames.add(J));this._activeInputName=A;this._fieldFocusNeeded=!0;this.scheduleRender()}})])};D.loadDependencies=function(){return Promise.all([new Promise((f,A)=>b(["../chunks/calcite-combobox"],f,A)),new Promise((f,A)=>b(["../chunks/calcite-combobox-item"],f,A)),new Promise((f,
A)=>b(["../chunks/calcite-combobox-item-group"],f,A)),new Promise((f,A)=>b(["../chunks/calcite-input-message"],f,A)),new Promise((f,A)=>b(["../chunks/calcite-progress"],f,A)),new Promise((f,A)=>b(["../chunks/calcite-switch"],f,A)),new Promise((f,A)=>b(["../chunks/calcite-input-date-picker"],f,A)),new Promise((f,A)=>b(["../chunks/calcite-input-time-picker"],f,A))])};D.getValues=function(){return this.viewModel.getValues()};D.submit=function(){return this.viewModel.submit()};D.render=function(){const {state:f}=
this.viewModel;return g.tsx("div",{class:this.classes(B.CSS.base,B.CSS.widget,B.CSS.panel)},"ready"===f?this.renderForm():null)};D.renderForm=function(){var f=this.viewModel,A=K.isSome(f.formTitle)&&g.tsx(G.Heading,{key:"title",level:this.headingLevel},f.formTitle);f=K.isSome(f.formDescription)&&g.tsx("p",{class:B.CSS.description,key:"description"},f.formDescription);A=A||f?g.tsx("div",{class:B.CSS.formHeader},A,f):null;return g.tsx("form",{class:B.CSS.form,novalidate:!0,onsubmit:this._handleSubmit,
onkeydown:this._handleFormKeyDown},A,this.renderFields())};D.renderFields=function(){const {viewModel:{inputFields:f}}=this;return f.filter(A=>A.visible).map((A,J)=>x.isGroupField(A)?this.renderGroup(A,J):this.renderLabeledField(A))};D.renderGroup=function(f,A){const {formTemplate:J,disabled:z}=this,{description:N,inputFields:F,label:R,state:m}=f,C=F.filter(oa=>oa.visible);var M=this.viewModel.findField(this._activeInputName);M=!(!M||M.group!==f);const w=`${this.id}_group_${A}`,U=`${this.id}_group-label_${A}`,
T=`${this.id}_group-description_${A}`,S=N?g.tsx("p",{class:this.classes(B.CSS.groupDescription,B.CSS.description),id:T},N):null,Y="sequential"===this.groupDisplay,ha=Y?M:"expanded"===m,ja=ha?B.CSS.collapseIcon:B.CSS.expandIcon;return g.tsx("fieldset",{"aria-expanded":ha.toString(),"aria-labelledby":U,"aria-describedby":N?T:"",class:this.classes(B.CSS.group,Y?B.CSS.groupSequential:null,ha?null:B.CSS.groupCollapsed,M?B.CSS.groupActive:null,z?B.CSS.inputDisabled:null),disabled:z,"data-group":f,id:w,
key:A,onclick:this._handleGroupClick},g.tsx("button",{role:Y?"presentation":void 0,class:B.CSS.groupHeader,type:"button",tabIndex:Y?-1:0},g.tsx("div",{class:B.CSS.groupTitle},g.tsx(G.Heading,{class:B.CSS.groupLabel,id:U,level:K.isSome(J)&&J.title?G.incrementHeadingLevel(this.headingLevel):this.headingLevel},R),S),Y?null:g.tsx("span",{class:this.classes(ja,B.CSS.groupToggleIcon)})),C.map(oa=>this.renderLabeledField(oa)))};D._getFocusableInput=function(f,A){var J=this.viewModel.allInputFields;J="forward"===
f?J:J.slice().reverse();A?x.isGroupField(A)?f=J.indexOf(A.inputFields[0]):(this._isInputFieldInGroup(A)&&"collapsed"===A.group.state?({inputFields:A}=A.group,f="forward"===f?A[A.length-1]:A[0]):f=A,f=J.indexOf(f)+1):f=0;for(;f<J.length;f++)if(A=J[f],A.visible)return A;return null};D.renderLabeledField=function(f){const {feature:A,label:J,layer:z,type:N}=f;return g.tsx("label",{key:`${z.id}-${A.uid}-${f.name}`,class:B.CSS.label},[J,"unsupported"!==N?this.renderInputField(f):this.renderUnsupportedField(f),
this.renderAuxiliaryText(f)])};D.renderInputField=function(f){const {domain:A,name:J,type:z,updating:N,value:F}=f,R=this.getCommonInputProps(f);if("coded-value"===A?.type){if(x.isFieldElementWithInputType(f.fieldElement,"switch")){const {fieldElement:m}=f;if(this._switchFieldsWithInitialIncompatibleValue.has(J)||null==F||m.input.onValue!==F&&m.input.offValue!==F)this._switchFieldsWithInitialIncompatibleValue.add(J);else return this.renderSwitchInputField(f,R)}return"radio-buttons"===f.inputType?this.renderRadioButtonsInputField(f,
A.codedValues.map(({code:m,name:C})=>({value:m,name:C})),R):this.renderSelectInputField(f,this._getFieldValueOptions(J,A),R)}if("datetime-picker"===f.inputType||"date"===z)return this.renderDateInputField(f,R);f="number"===z?g.tsx("input",{type:"number",...R,value:K.isSome(this._activeNumberFieldEdit)&&this._activeNumberFieldEdit.fieldName===f.name?this._activeNumberFieldEdit.value:`${R.value}`}):"text-area"===f.inputType?g.tsx("textarea",{...R}):g.tsx("input",{type:"text",...R});return N?g.tsx("div",
{class:B.CSS.inputFieldWrapper},f,g.tsx("div",{class:B.CSS.inputFieldLoader},g.tsx("calcite-progress",{type:"indeterminate"}))):f};D.renderDateInputField=function(f,A){const {includeTime:J,label:z,name:N,valid:F,value:R}=f,{readOnly:m,required:C}=A,{date:M,time:w}=this._formatValueForDateInputs(R);f=K.isSome(A.max)?this._formatValueForDateInputs(A.max):void 0;var U=K.isSome(A.min)?this._formatValueForDateInputs(A.min):void 0;f=f?.date??void 0;U=U?.date??void 0;const T={afterCreate:this._afterDateInputCreate,
afterUpdate:this._afterDateInputCreateOrUpdate,"aria-invalid":!F,label:z,numberingSystem:"latn",overlayPositioning:"fixed",readOnly:m,required:C,tabIndex:0,["data-field-name"]:N};return g.tsx("div",{key:`${A.key}-date-time-container`,class:B.CSS.dateInputContainer},g.tsx("calcite-input-date-picker",{bind:this,...T,class:this.classes(A.class,B.CSS.inputDate),"data-date-part":"date",key:`${A.key}-date-input`,valueAsDate:M??void 0,maxAsDate:f,minAsDate:U,onCalciteInputDatePickerChange:S=>this._commitDateChanges(S.target),
onblur:S=>this._commitDateChanges(S.target,!0)}),J?g.tsx("calcite-input-time-picker",{bind:this,...T,class:this.classes(A.class,B.CSS.inputTime),"data-date-part":"time",key:`${A.key}-time-input`,value:w??void 0,step:1,onCalciteInputTimePickerChange:S=>this._commitDateChanges(S.target),onfocus:S=>{S.target.calciteTimePickerEl&&(S.target.calciteTimePickerEl.showSecond=!0)},onblur:S=>this._commitDateChanges(S.target,!0)}):null)};D.renderUnsupportedField=function(f){f=this.getCommonInputProps(f);return g.tsx("input",
{afterCreate:f.afterCreate,afterUpdate:f.afterUpdate,class:this.classes(B.CSS.input,B.CSS.inputField,B.CSS.inputDisabled),onfocus:f.onfocus,readOnly:!0,tabIndex:f.tabIndex,type:"text",value:f.value,["data-field-name"]:f["data-field-name"]})};D.renderSelectInputField=function(f,A,J){const {value:z}=f,{messages:N,messagesTemplates:F}=this;var R=A.map(M=>M.map(w=>g.tsx("calcite-combobox-item",{value:`${w.value}`,textLabel:w.name,key:`#${w.value}`,selected:z===w.value})));const [m,C]=R;this._registerIncompatibleValue(z,
A.flat(),f,M=>{C.unshift(g.tsx("calcite-combobox-item",{value:`${M}`,textLabel:`${M}`,key:"incompatible-option",readOnly:!0}))});A=0<C.length?[g.tsx("calcite-combobox-item-group",{key:"recommended",label:N.recommended},m),g.tsx("calcite-combobox-item-group",{key:"other",label:F.other},C)]:m;R=K.isNone(f.fieldElement)||x.isFieldElementWithInputType(f.fieldElement,"combo-box")&&f.fieldElement.input.showNoValueOption;!f.required&&R&&(f=x.isFieldElementWithInputType(f.fieldElement,"combo-box")&&f.fieldElement.input.noValueOptionLabel||
this.messages.empty,A.unshift(g.tsx("calcite-combobox-item",{value:"",textLabel:this.messages.empty,key:"empty-option"},f)));return g.tsx("calcite-combobox",{...J,selectionMode:"single",disabled:J.readOnly,allowCustomValues:!1,onCalciteComboboxChange:M=>this._handleOptionChange(M.target)},A)};D._registerIncompatibleValue=function(f,A,J,z){const N=this._fieldToInitialIncompatibleDomainValue,F=N.has(J.name);if(F||null!=f&&""!==f&&!A.some(R=>R.value===f))F||N.set(J.name,f),z?.(f)};D.renderRadioButtonsInputField=
function(f,A,J){const {value:z}=f,N=A.map(F=>this.renderRadioButton({key:F.name,label:F.name,name:f.name,value:F.value,selected:F.value===z,props:J}));this._registerIncompatibleValue(z,A,f);A=K.isNone(f.fieldElement)||x.isFieldElementWithInputType(f.fieldElement,"radio-buttons")&&f.fieldElement.input.showNoValueOption;!f.required&&A&&(A=x.isFieldElementWithInputType(f.fieldElement,"radio-buttons")&&f.fieldElement.input.noValueOptionLabel||this.messages.empty,N.unshift(this.renderRadioButton({key:"empty-option",
label:A,name:f.name,value:"",selected:""===z||null===z,props:J})));return g.tsx("div",{key:`${J.key}-radio`,class:B.CSS.inputRadioGroup},N)};D.renderSwitchInputField=function(f,A){const {value:J}=f;f=x.isFieldElementWithInputType(f.fieldElement,"switch")?J===f.fieldElement.input.onValue:!1;return g.tsx("calcite-switch",{...A,class:B.CSS.inputSwitch,onCalciteSwitchChange:z=>this._commitInputValue(z.target),checked:f,disabled:A.readOnly})};D.renderRadioButton=function({key:f,name:A,value:J,selected:z,
label:N,props:F}){return g.tsx("label",{key:f,class:B.CSS.inputRadioLabel},g.tsx("input",{...F,class:B.CSS.inputRadio,name:A,type:"radio",value:J,checked:z,disabled:F.readOnly,onchange:R=>this._commitInputValue(R.target)}),N)};D.renderAuxiliaryText=function(f){const A=this._userUpdatedInputFieldNames.has(f.name)&&!f.valid?f.errorMessage:K.isSome(this.viewModel.contingencyConstraintViolations.get(f.name))?this.messages.validationErrors.valuesIncompatible:K.isSome(f.valueExpressionExecutor)&&f.valueExpressionExecutor.stale?
this.messages.valueExpressionError:null;return K.isSome(A)?g.tsx("calcite-input-message",{status:"invalid",icon:!0},A):f.description?g.tsx("div",{key:"description",class:B.CSS.description},f.description):null};D.getCommonInputProps=function(f){const {disabled:A,groupDisplay:J}=this,{editable:z,group:N,hint:F,label:R,maxLength:m,minLength:C,name:M,required:w,type:U,valid:T,value:S}=f,Y=this._userUpdatedInputFieldNames.has(M),ha=!z||A,ja="all"===J&&K.isSome(N)&&"collapsed"===N.state;return{afterCreate:this._afterInputCreateOrUpdate,
afterUpdate:this._afterInputCreateOrUpdate,"aria-invalid":T?"false":"true",class:this.classes(B.CSS.input,B.CSS.inputField,ha?B.CSS.inputDisabled:null,Y&&!T?B.CSS.inputInvalid:null),key:M,label:R,minlength:-1<C?`${C}`:"",maxlength:-1<m?`${m}`:"",...this._getNumberFieldConstraints(f),readOnly:ha,value:null==S?"":`${S}`,["data-field-name"]:M,onfocus:this._handleInputFocus,oninput:this._handleInputInput,onblur:this._handleInputBlur,onkeydown:this._handleInputKeyDown,onmousedown:"number"===U?this._handleNumberInputMouseDown:
null,placeholder:"number"===U||"text"===U?F:"",required:w,tabIndex:ja?-1:0}};D._isInputFieldInGroup=function(f){return!x.isGroupField(f)&&K.isSome(f.group)};D._handleNumberInputMouseDown=function({target:f}){f.focus();this.scheduleRender()};D._getFieldValueOptions=function(f,A){A=A.codedValues.map(({code:J,name:z})=>({value:J,name:z}));f=this.viewModel.fieldsWithContingentValues.has(f)?this._getContingentValueOptions(f):[];if(0<f.length){const J=new Set(f.map(z=>z.value));A=A.filter(z=>!J.has(z.value));
return[f,A]}return[A,[]]};D._getContingentValueOptions=function(f){const A={};for(var J of this.viewModel.allInputFields){const {name:N,value:F}=J;!K.isNone(F)&&N!==f&&this.viewModel.fieldsWithContingentValues.has(N)&&(A[N]=F)}var z=this.viewModel.joinedContingentValues.slice();J=new Map;for(const N of z){z=N.values[f];if(K.isNone(z)||"code"!==z.objectType&&"null"!==z.objectType)continue;const {code:F,name:R}=z.codedValue&&"null"!==z.objectType?z.codedValue:{code:"",name:this.messages.empty};J.has(F)||
Object.entries(A).every(([m,C])=>!N.values.hasOwnProperty(m)||this._valueIsValidContingentValue(C,N.values[m]))&&J.set(F,{name:R,value:F})}return[...J.values()]};D._getInputFieldFromInput=function(f){return this.viewModel.findField(f.getAttribute("data-field-name"))};D._getNumberFieldConstraints=function(f){return(f=r.getDomainRange(f.domain)||l.getFieldRange(f.field))&&f.max!==Number.MAX_VALUE&&f.min!==Number.MIN_VALUE?f:{min:null,max:null}};D._afterDateInputCreate=function(){var f=n._asyncToGenerator(function*(A){!("valueAsDate"in
A)&&K.isSome(A.value)&&"setValue"in A&&A.setValue({value:A.value,origin:"external"});this._afterDateInputCreateOrUpdate(A)});return function(A){return f.apply(this,arguments)}}();D._afterDateInputCreateOrUpdate=function(f){const {name:A}=this._getInputFieldFromInput(f),J=this._dateInputFieldMap.get(A),z="valueAsDate"in f;K.isSome(J)?z?J.date=f:J.time=f:this._dateInputFieldMap.set(A,{[z?"date":"time"]:f});this._afterInputCreateOrUpdate(f)};D._afterInputCreateOrUpdate=function(f){var {viewModel:A}=
this;const J=this._getInputFieldFromInput(f);A=A.findField(this._activeInputName);const z=this._fieldToInitialIncompatibleDomainValue.get(J.name)===J.value;this._fieldFocusNeeded&&A===J&&("radio-buttons"!==J.inputType||z||f.checked)&&(this._fieldFocusNeeded=!1,this._isInputFieldInGroup(J)&&(J.group.state="expanded"),f.focus())};D._handleInputFocus=function(f){f=f.target;const A=this._getInputFieldFromInput(f);this._activeInputName=A.name;this._isNumberInputField(A)&&(this._activeNumberFieldEdit={fieldName:A.name,
input:f,value:f.value})};D._isNumberInputField=function({domain:f,inputType:A="text-box",type:J}){return"number"===J&&"text-box"===A&&(!f||"coded-value"!==f.type)};D._handleInputBlur=function(f){f=f.target;const A=this._getInputFieldFromInput(f);"number"===A.type&&K.isSome(this._activeNumberFieldEdit)&&(this._activeNumberFieldEdit.input.value=`${A.value}`,this._activeNumberFieldEdit=null);this._commitInputValue(f);this.scheduleRender()};D._commitDateChanges=function(f,A=!1){const {name:J}=this._getInputFieldFromInput(f);
if(this._dateInputFieldMap.has(J)){var z=this._dateInputFieldMap.get(J);z&&z.date&&(f=this._getFieldValueFromDateInput(f),z=this._getFieldValueFromDateInputs(z.date,z.time),this.viewModel.getValue(J)!==z&&(null===f||null===z?A&&this._updateFieldValue(J,null):this._updateFieldValue(J,z)))}};D._commitInputValue=function(f){const A=this._getInputFieldFromInput(f);K.isSome(this._activeNumberFieldEdit)&&this._isNumberInputField(A)&&(this._activeNumberFieldEdit.value=f.value);this._updateFieldValue(A.name,
this._parseValue(f))};D._handleInputKeyDown=function(f){const {key:A,altKey:J,ctrlKey:z,metaKey:N}=f;var F=this._getInputFieldFromInput(f.target);if("Enter"!==A){var {type:R}=F.field;F="single"===R||"double"===R;if(!("integer"!==R&&"small-integer"!==R&&!F||J||z||N)&&1===A.length){R=Number(A);const m=["-","+"],C=["e","."];F=F?[...m,...C]:m;isNaN(R)&&!F.includes(A)&&f.preventDefault()}}else this._isInputFieldInGroup(F)&&"collapsed"===F.group.state&&(F.group.state="expanded")};D._updateFieldValue=function(f,
A){this.viewModel.setValue(f,A);this._userUpdatedInputFieldNames.add(f);this.viewModel.fieldsWithContingentValues.has(f)&&(f=Object.fromEntries(Object.entries(this.getValues()).filter(([,J])=>K.isSome(J))),this.viewModel.validateContingencyConstraints(f))};D._parseValue=function(f){const A=this._getInputFieldFromInput(f),J=f.value;if(x.isFieldElementWithInputType(A.fieldElement,"switch")&&"CALCITE-COMBOBOX"!==f.tagName)return f.checked?A.fieldElement.input.onValue:A.fieldElement.input.offValue;if("radio-buttons"===
A.inputType&&"radio"===f.type&&!f.checked)return A.value;({type:f}=A);return"number"===f?J?parseFloat(J):null:J};D._handleOptionChange=function(f){this._commitInputValue(f);this.scheduleRender()};D._handleGroupClick=function(f){const A=f.currentTarget["data-group"],J="expanded"===A.state,z="sequential"===this.groupDisplay,N=`.${B.CSS.groupHeader}`;if(!J||f.target.closest(N)){this._activeInputName=this._getFocusableInput("forward",A)?.name||"";if(z){f=f.target.closest(N);if(J&&!f)return;this.viewModel.inputFields.forEach(F=>
{x.isGroupField(F)&&F!==A&&(F.state="collapsed")})}A.state=J?"collapsed":"expanded";this._fieldFocusNeeded=z;this.scheduleRender()}};D._handleSubmit=function(f){f.preventDefault()};D._handleFormKeyDown=function(f){"Enter"===f.key&&this.viewModel.submit()};D._getDefaultLocaleOptions=function(){return{locale:a.getLocale(),numberingSystem:"latn"}};D._getFieldValueFromDateInputs=function(f,A){var J=this._getDateTimeFromInput(f);A=this._getDateTimeFromInput(A);if(!J&&!A)return null;f=this._getInputFieldFromInput(f);
f=this._getNumberFieldConstraints(f);const z=Date.now();f=K.isSome(f.max)&&f.max<z?f.max:z;f=c.DateTime.fromMillis(f,this._getDefaultLocaleOptions());J=J||f;const {year:N,month:F,day:R}=J,{hour:m,minute:C,second:M}=A||f;J=J.set({year:N,month:F,day:R,hour:m,minute:C,second:M});return J.isValid?J.toMillis():null};D._getDateTimeFromInput=function(f){if(!f)return null;let A=null;if("valueAsDate"in f){f=f.valueAsDate;if(!f||Array.isArray(f))return null;A=c.DateTime.fromJSDate(f)}else{if(!f.value)return null;
A=c.DateTime.fromFormat(f.value,"TT",this._getDefaultLocaleOptions())}return A??null};D._getFieldValueFromDateInput=function(f){return this._dateTimeToFieldValue(this._getDateTimeFromInput(f))};D._dateTimeToFieldValue=function(f){return f?.isValid?f.toMillis():null};D._dateTimeFromFieldValue=function(f){return null===f?null:c.DateTime.fromMillis(f,this._getDefaultLocaleOptions())};D._formatValueForDateInputs=function(f){return null==f||isNaN(f)?{date:null,time:null}:(f=this._dateTimeFromFieldValue(f))?
{date:f.toJSDate(),time:f.toFormat("TT",this._getDefaultLocaleOptions())}:{date:null,time:null}};D._valueIsValidContingentValue=function(f,A){switch(A.objectType){case "any":return!0;case "null":return null==f;case "code":return f===A.codedValue?.code;case "range":return K.isSome(f)&&K.isSome(A.minValue)&&K.isSome(A.maxValue)&&f>=A.minValue&&f<=A.maxValue;default:return u.neverReached(A.objectType),!1}};n._createClass(Q,[{key:"feature",get:function(){return this.viewModel.feature},set:function(f){this.viewModel.feature=
f}},{key:"formTemplate",get:function(){return this.viewModel.formTemplate},set:function(f){this.viewModel.formTemplate=f}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(f){this._overrideIfSome("label",f)}},{key:"layer",get:function(){return this.viewModel.layer},set:function(f){this.viewModel.layer=f}},{key:"spatialReference",get:function(){return this.viewModel.spatialReference},set:function(f){this.viewModel.spatialReference=f}},{key:"strict",get:function(){return this.viewModel.strict},
set:function(f){this.viewModel.strict=f}},{key:"view",get:function(){return this.viewModel.view},set:function(f){this.viewModel.view=f}}]);return Q}(p);e.__decorate([h.property()],H.prototype,"disabled",void 0);e.__decorate([h.property()],H.prototype,"feature",null);e.__decorate([h.property()],H.prototype,"formTemplate",null);e.__decorate([h.property()],H.prototype,"groupDisplay",void 0);e.__decorate([h.property()],H.prototype,"headingLevel",void 0);e.__decorate([h.property()],H.prototype,"label",
null);e.__decorate([h.property()],H.prototype,"layer",null);e.__decorate([h.property(),O.messageBundle("esri/widgets/FeatureForm/t9n/FeatureForm")],H.prototype,"messages",void 0);e.__decorate([h.property(),O.messageBundle("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],H.prototype,"messagesTemplates",void 0);e.__decorate([h.property()],H.prototype,"spatialReference",null);e.__decorate([h.property()],H.prototype,"strict",null);e.__decorate([h.property()],H.prototype,"view",null);e.__decorate([h.property(),
L.vmEvent(["value-change","submit"])],H.prototype,"viewModel",void 0);return H=e.__decorate([k.subclass("esri.widgets.FeatureForm")],H)})},"esri/widgets/FeatureForm/css":function(){define(["exports"],function(b){b.CSS={base:"esri-feature-form",form:"esri-feature-form__form",formHeader:"esri-feature-form__form-header",label:"esri-feature-form__label",inputFieldWrapper:"esri-feature-form__input-wrapper",inputFieldLoader:"esri-feature-form__input-loader",inputField:"esri-feature-form__input",inputDate:"esri-feature-form__input--date",
inputTime:"esri-feature-form__input--time",inputRadioGroup:"esri-feature-form__input--radio-group",inputRadio:"esri-feature-form__input--radio",inputRadioLabel:"esri-feature-form__input--radio-label",inputDisabled:"esri-feature-form__input--disabled",inputSwitch:"esri-feature-form__input--switch",inputInvalid:"esri-feature-form__input--invalid",inputIconInvalid:"esri-feature-form__input-icon--invalid",errorMessage:"esri-feature-form__field-error-message",description:"esri-feature-form__description-text",
dateInputPart:"esri-feature-form__date-input-part",loneDateInputPart:"esri-feature-form__date-input-part--lone",dateInputContainer:"esri-feature-form__date-input-container",dateFormatHint:"esri-feature-form__date-format-hint",group:"esri-feature-form__group",groupLabel:"esri-feature-form__group-label",groupHeader:"esri-feature-form__group-header",groupHeading:"esri-feature-form__group-header",groupTitle:"esri-feature-form__group-title",groupDescription:"esri-feature-form__group-description",groupToggleIcon:"esri-feature-form__group-toggle-icon",
groupCollapsed:"esri-feature-form__group--collapsed",groupSequential:"esri-feature-form__group--sequential",groupActive:"esri-feature-form__group--active",collapseIcon:"esri-icon-up",errorIcon:"esri-icon-notice-triangle",expandIcon:"esri-icon-down",widget:"esri-widget",panel:"esri-widget--panel",input:"esri-input",select:"esri-select"};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/FeatureForm/featureFormUtils":function(){define(["exports","../../core/maybe","../../core/string"],
function(b,n,e){function H(E,h){h=h.map((t,d)=>{let k=E[d];t.domain&&"coded-value"===t.domain.type&&(d=t.domain.codedValues.find(r=>r.code===k),d?.name&&(k=d.name));return[t.name,k]});return Object.fromEntries(h)}function u(E,h){return e.replace(e.replace(E,t=>`{${t.toLowerCase()}}`),Object.fromEntries(Object.entries(h).map(([t,d])=>[t.toLowerCase(),d])))}const K={typeFieldName:null,types:[]};b.getComputedAttributes=H;b.getNormalizedFeatureTypeInfo=E=>E?"subtype-sublayer"===E.type?{typeFieldName:E.parent?.subtypeField,
types:E.parent?.subtypes}:"types"in E&&E.types?{typeFieldName:E.typeIdField,types:E.types.map(({id:h,name:t,domains:d})=>({code:h,name:t,domains:d}))}:K:K;b.isFieldElementWithInputType=(E,h)=>n.isSome(E)&&E.input?.type===h;b.isGroupField=E=>!!E.inputFields;b.parseFormTemplateString=function(E,h,t){var d=Object.keys(h).filter(r=>e.templateHasKey(E,r));const k=d.map(r=>h[r]);d=d.map(r=>t.get(r)).filter(n.isSome);return u(E,H(k,d))};b.substituteFieldTemplatesInString=u;Object.defineProperty(b,Symbol.toStringTag,
{value:"Module"})})},"esri/widgets/FeatureForm/FeatureFormViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Graphic ../../intl ../../core/Evented ../../core/HandleOwner ../../core/Logger ../../core/maybe ../../core/Promise ../../core/reactiveUtils ../../core/string ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass ../../form/FormTemplate ../../layers/support/ContingentValue ../../layers/support/editableLayers ../../layers/support/LayerContingentValuesCache ./featureFormUtils ./FormExpressionArcadeExecutor ./FormExpressionsManager ./InputField ./InputFieldGroup ../../intl/locale ../../intl/messages".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k,r,l,p,B,x,y,G,P,O,L,g,c,a,v,Q){const D=new e({attributes:{}}),f=["editableExpression","requiredExpression","valueExpression","visibilityExpression"],A=["visibilityExpression"];e=function(N){function F(m){m=N.call(this,m)||this;m._expressionExecutorLookup=new Map;m._expressionLookup=new Map;m._expressionsManager=null;m._contingentValuesCache=null;m._featureClone=D.clone();m._initialFeature=D.clone();m.arcadeEditType="NA";m.contingencyConstraintViolations=new Map;m.inputFields=
[];m.messages=null;m.strict=!1;m._isSupportedElement=m._isSupportedElement.bind(b._assertThisInitialized(m));return m}b._inheritsLoose(F,N);var R=F.prototype;R.initialize=function(){var m=this;const C=function(){var T=b._asyncToGenerator(function*(){const S=yield Q.fetchMessageBundle("esri/widgets/FeatureForm/t9n/FeatureForm");m.messages=S;for(const Y of m.allInputFields)Y.messages=S});return function(){return T.apply(this,arguments)}}();C();const M=d.watch(()=>[this.layer,this.layer?.loaded,this.formTemplate],
([T,S])=>{h.isSome(T)&&(S?this._updateInputFields():T.load().catch(()=>E.getLogger(this.declaredClass).error("Failed to load layer",T.loadError)))},{equals:([T,S,Y],[ha,ja,oa])=>T===ha&&S===ja&&Y===oa,initial:!0}),w=d.watch(()=>this._arcadeContextInfo,T=>{h.isSome(this._expressionsManager)&&(this._expressionsManager.arcadeContextInfo=T)}),U=d.watch(()=>this.layer,T=>{(T="subtype-sublayer"===T?.type?T.parent:"feature"===T?.type?T:null)&&this.addResolvingPromise(P.createLoadedLayerContingentValuesCache(T).then(S=>
{this._contingentValuesCache=S;this.notifyChange("fieldsWithContingentValues")}))},{initial:!0});this.handles.add([v.onLocaleChange(C),M,w,U])};R.destroy=function(){this.layer=this.feature=null;this._contingentValuesCache=h.destroyMaybe(this._contingentValuesCache)};R.findField=function(m){return this.allInputFields.find(C=>C.name===m)};R.getValue=function(m){const {_featureClone:C,layer:M}=this,w=!!M?.getField(m);return C.getAttribute(m)??(w?null:void 0)};R.setValue=function(m,C){const {_featureClone:M,
strict:w}=this,U=this.findField(m);C=""===C?null:C;U&&M.getAttribute(m)!==C&&(U.value=C,!w||U.valid)&&(this._afterValueChange(U),h.isSome(this._expressionsManager)&&this.updatingHandles.addPromise(this._expressionsManager.evaluateInvalidated([U.name]).finally(()=>this._afterExpressionsEvaluated())))};R.getValues=function(){return{...this._featureClone.attributes}};R.submit=function(){var m=this.allInputFields;const C=new Set(m.filter(w=>w.valid).map(({name:w})=>w));m=m.filter(w=>!w.valid).map(({name:w})=>
w);const M=this.getValues();if(0<this.validateContingencyConstraints(M,{includeIncompleteViolations:!0}).length)for(const [w,U]of this.contingencyConstraintViolations.entries())"error"===U.type&&(C.delete(w),m.push(w));this.emit("submit",{valid:[...C],invalid:m,values:M})};R.validateContingencyConstraints=function(m,C){const {_contingentValuesCache:M}=this,w=new Map;this.contingencyConstraintViolations=w;if(h.isNone(M))return[];const {invalid:U,incomplete:T}=M.validateContingencyConstraints(m);m=
[...U,...(C?.includeIncompleteViolations?T:[])];for(const S of m)for(const Y of S.fieldGroup.fields)w.set(Y,S);return m};R.notifyFeatureGeometryChanged=function(){const {_expressionsManager:m,feature:C,_featureClone:M}=this;M.geometry=C.geometry;h.isSome(m)&&this.updatingHandles.addPromise(m.evaluateInvalidatedByGeometry().finally(()=>this._afterExpressionsEvaluated()))};R._emitChangeEvent=function({name:m,valid:C,value:M}){this.emit("value-change",{layer:this.layer,feature:this.feature,fieldName:m,
value:M,valid:C})};R._updateInputFields=function(){const {_featureClone:m,_initialFeature:C,arcadeEditType:M,formTemplate:w,inputFields:U,messages:T,layer:S}=this,Y={arcadeEditType:M,feature:m,initialFeature:C,layer:S,messages:T},ha=U.slice();this.inputFields=h.isSome(w)&&0<w.elements.length?this._updateInputFieldsFromElements(ha,w.elements,Y):this._updateInputFieldsFromLayerFields(ha,S?.fields,Y)};R._updateInputFieldsFromElements=function(m,C,M){const w=new Map;for(const T of m)if(O.isGroupField(T)){z(w,
T.groupElement,T);for(const S of T.inputFields)z(w,S.fieldElement,S)}else z(w,T.fieldElement,T);m=new Map;const U=this._updateInputFieldsRecursive({existingInputFieldsByElement:w,updatedElements:C.filter(this._isSupportedElement),sharedInitializationProperties:M,group:null,newExpressionExecutorPromises:m});this.updatingHandles.addPromise(Promise.all(Array.from(m.values())).then(()=>{const T=Array.from(this._expressionExecutorLookup.values()),S=J(U);this._createExpressionsManager(T,S);return h.unwrap(this._expressionsManager).evaluateAll().finally(()=>
this._afterExpressionsEvaluated())}));for(const [T,S]of w.entries())w.delete(T),S.destroy();return U};R._updateInputFieldsRecursive=function(m){const {existingInputFieldsByElement:C,updatedElements:M,sharedInitializationProperties:w,group:U,newExpressionExecutorPromises:T}=m;m=[];for(const Y of M){var S=C.has(Y);const ha=S?C.get(Y):"group"===Y.type?this._makeInputFieldGroupFromGroupElement(Y,w):this._makeInputFieldFromFieldElement(Y,w,U);m.push(ha);S?(C.delete(Y),O.isGroupField(ha)?({feature:S}=w,
ha.set({feature:S})):ha.set(w)):this._assignExpressionExecutors(ha,Y,T);"group"===Y.type&&(S=Y.elements.filter(ja=>this._isSupportedElement(ja)),ha.inputFields=this._updateInputFieldsRecursive({existingInputFieldsByElement:C,updatedElements:S,sharedInitializationProperties:w,group:ha,newExpressionExecutorPromises:T}))}return m};R._updateInputFieldsFromLayerFields=function(m,C,M){if(!Array.isArray(C))return E.getLogger(this.declaredClass).warn(this.declaredClass,"No attribute fields found."),[];const w=
new Map;for(const ja of m)if(O.isGroupField(ja)){for(const oa of ja.inputFields)oa.destroy();ja.inputFields.length=0;ja.destroy()}else h.isSome(ja.fieldElement)?ja.destroy():w.set(ja.field,ja);m=[];const {arcadeEditType:U,feature:T,initialFeature:S,layer:Y,messages:ha}=M;for(const ja of C)C=w.get(ja)??new c({arcadeEditType:U,field:ja,feature:T,initialFeature:S,layer:Y,messages:ha,value:T.getAttribute(ja.name)??null}),m.push(C),w.delete(ja);for(const [ja,oa]of w.entries())w.delete(ja),oa.destroy();
return m};R._resetInputFieldValues=function(m){for(const C of this.allInputFields)C.value=m.getAttribute(C.name)};R._makeInputFieldFromFieldElement=function(m,C,M=null){const {arcadeEditType:w,feature:U,initialFeature:T,layer:S,messages:Y}=C;return new c({arcadeEditType:w,fieldElement:m,field:this._layerFieldsByName.get(m.fieldName),value:U.getAttribute(m.fieldName)??null,feature:U,initialFeature:T,layer:S,group:M,messages:Y})};R._makeInputFieldGroupFromGroupElement=function(m,C){const {feature:M,
initialFeature:w}=C;return new a({groupElement:m,inputFields:[],feature:M,initialFeature:w})};R._assignExpressionExecutors=function(m,C,M){var w="group"===C.type?A:f;for(const U of w){w=C[U];const {_expressionExecutorLookup:T}=this;if(h.isSome(w)&&""!==w){const S=`${U}Executor`,Y=this._expressionLookup.get(w)??this._addToExpressionLookup(w);T.has(Y)?m[S]=T.get(Y):M.has(Y)?(w=M.get(Y).then(ha=>m[S]=ha),M.set(Y,w)):(w=L.createFormExpressionArcadeExecutor(Y,this.layer).then(ha=>{m[S]=ha;T.set(Y,ha);
return ha}),M.set(Y,w))}}return[]};R._createExpressionsManager=function(m,C){const {_arcadeContextInfo:M,_featureClone:w}=this;this._expressionsManager=new g.FormExpressionsManager({executors:m,feature:w,arcadeContextInfo:M,inputFields:C})};R._afterValueChange=function(m){const {name:C,value:M}=m,{_featureClone:w,formTemplate:U,layer:T}=this;if(T){var S=w.getAttribute(C);w.setAttribute(C,M);var {typeFieldName:Y,types:ha}=O.getNormalizedFeatureTypeInfo(T);if(C===Y&&M!==S){"subtype-sublayer"===T.type&&
(S=T.parent?.findSublayerForFeature(w),w.sourceLayer=this.feature.sourceLayer=S);S=new Set;for(var ja of ha)if(ja.domains&&"object"===typeof ja.domains)for(const oa of Object.keys(ja.domains))S.add(oa);for(const oa of S)(ja=this.findField(oa))&&ja.notifyChange("domain")}if(h.isSome(U)){const {description:oa,title:ra}=U;ra&&k.templateHasKey(ra,C)&&this.notifyChange("formTitle");oa&&k.templateHasKey(oa,C)&&this.notifyChange("formDescription")}this._emitChangeEvent(m)}};R._afterExpressionsEvaluated=
function(){const {_featureClone:m}=this;for(const C of this.allInputFields)C.value!==m.getAttribute(C.name)&&this._afterValueChange(C)};R._addToExpressionLookup=function(m){const {_expressionLookup:C,formTemplate:M}=this,w=(h.isSome(M)&&h.isSome(M.expressionInfos)?Object.values(M.expressionInfos).find(U=>U.name===m):null)?.expression??m;C.set(m,w);m!==w&&C.set(w,w);return w};R._isSupportedElement=function(m){if("field"===m.type||"group"===m.type)return!0;E.getLogger(this.declaredClass).warn("form-info::unsupported-element-type",
"Only element types 'field' and 'group' are supported",`Element ${m.label} has unsupported type '${m.type}'`);return!1};R._joinContingentValues=function(){var m=this._contingentValuesCache;if(h.isNone(m))return[];var {typeFieldName:C}=O.getNormalizedFeatureTypeInfo(this.layer);C=C?this.getValue(C):null;const M=[];for(var w of m.fieldGroups){const {contingencies:Y,fields:ha,name:ja}=w;m=[];for(var U of Y)U.isRetired||h.isSome(U.subtype)&&U.subtype.code!==C||m.push({values:U.values});0<m.length&&M.push({name:ja,
fields:ha,contingencies:m})}const [T,S]=this._generateJoinPlan(M);w=T.flatMap(Y=>this._joinFieldGroupContingencies(Y));U=S.flatMap(Y=>Y.contingencies);return[...w,...U]};R._generateJoinPlan=function(m){var C=new Map,M=[],w=new Set;for(var U of m)for(const ha of U.fields)if(C.has(ha)){const ja=C.get(ha),oa=U,ra=[ja.name,oa.name].sort().join("|");w.has(ra)||(M.push([ja,oa]),w.add(ra),C.set(ha,oa))}else C.set(ha,U);C=new Set(M.flat());m=new Set(m);for(var T of C)m.delete(T);T=new Map;C=new Map;for(var S of new Set(M.flat()))w=
Symbol(S.name),T.set(w,new Set([S])),C.set(S,w);for(const [ha,ja]of M)if(M=C.get(ha),S=C.get(ja),M!==S){w=T.get(M);U=T.get(S);for(var Y of U)w.add(Y),C.set(Y,M);T.delete(S)}Y=[...T.values()].map(ha=>[...ha]);M=[...m];return[Y,M]};R._joinFieldGroupContingencies=function(m){const C=m.slice();var M=C.shift(),w=C.shift();m=this._generateJoinKey(M.fields,w.fields);let U=new Set([...M.fields,...w.fields]),T=new Map;for(var S of M.contingencies)[M]=this._hashContingency(S,m.codedValueFields,!0),T.has(M)?
T.get(M).push(S):T.set(M,[S]);for(;0<C.length;){S=new Map;M=C.shift();const ja=this._generateJoinKey(U,M.fields);for(var Y of w.contingencies){const [oa,ra]=this._hashContingency(Y,m.codedValueFields);w=ra?this._findMatchingContingenciesWithAnyHashMask(T,oa):T.get(oa);T.has("#JSAPI_CONTINGENT_VALUE_ANY_HASH")&&w.push(...this._findMatchingContingenciesContainingAny(Y,T.get("#JSAPI_CONTINGENT_VALUE_ANY_HASH"),m.codedValueFields));if(!h.isNone(w))for(var ha of w){w=0<m.rangeFields.length?this._joinContingenciesWithRangeDomains(ha,
Y,m.rangeFields):this._joinContingencies(ha,Y);if(h.isNone(w))break;const [ta]=this._hashContingency(w,ja.codedValueFields,!0);S.has(ta)?S.get(ta).push(w):S.set(ta,[w])}}T=S;w=M;m=ja;U=new Set([...U,...w.fields])}Y=[];for(const ja of w.contingencies){const [oa,ra]=this._hashContingency(ja,m.codedValueFields);ha=ra?this._findMatchingContingenciesWithAnyHashMask(T,oa):T.get(oa);T.has("#JSAPI_CONTINGENT_VALUE_ANY_HASH")&&ha.push(...this._findMatchingContingenciesContainingAny(ja,T.get("#JSAPI_CONTINGENT_VALUE_ANY_HASH"),
m.codedValueFields));if(!h.isNone(ha))for(const ta of ha)ha=0<m.rangeFields.length?this._joinContingenciesWithRangeDomains(ta,ja,m.rangeFields):this._joinContingencies(ta,ja),h.isSome(ha)&&Y.push(ha)}return Y};R._joinContingencies=function(m,C){C={values:{...m.values,...C.values}};for(const [M,w]of Object.entries(C.values))"any"===w.objectType&&h.isSome(m.values[M])&&(C.values[M]=m.values[M]);return C};R._joinContingenciesWithRangeDomains=function(m,C,M){const w=this._joinContingencies(m,C);for(const T of M){var U=
m.values[T];const S=C.values[T],{leftIsNull:Y,rightIsNull:ha,bothAreNull:ja,leftIsAny:oa,rightIsAny:ra,bothAreAny:ta,leftIsRange:ua,rightIsRange:Aa}=this._compareObjectTypes(U.objectType,S.objectType);if(!ja&&!ta)if(Y&&ra||ha&&oa)w.values[T]=new y({objectType:"null"});else{if(Y&&Aa||ha&&ua)return null;oa?(U.minValue=-Infinity,U.maxValue=Infinity):ra&&(S.minValue=-Infinity,S.maxValue=Infinity);M=Math.max(U.minValue,S.minValue);U=Math.min(U.maxValue,S.maxValue);if(M>U)return null;w.values[T]=new y({objectType:"range",
minValue:M,maxValue:U})}}return w};R._findMatchingContingenciesContainingAny=function(m,C,M){return C.filter(w=>M.every(U=>{const T=w.values[U];U=m.values[U];return"any"===T.objectType||"any"===U.objectType||T.codedValue?.code===U.codedValue?.code}))};R._findMatchingContingenciesWithAnyHashMask=function(m,C){C=RegExp(`${C}$`);const M=[];for(const [w,U]of m){if("#JSAPI_CONTINGENT_VALUE_ANY_HASH"===w)break;C.test(w)&&M.push(...U)}return M};R._generateJoinKey=function(m,C){m=Array.isArray(m)?new Set(m):
m;var M=Array.isArray(C)?new Set(C):C;C=m.size<M.size?m:M;m=C===m?M:m;M=new Set;const w=new Set;for(const U of C)if(m.has(U)&&(C=this.layer.getFieldDomain(U,{feature:this.feature}),!h.isNone(C)))switch(C.type){case "coded-value":M.add(U);break;case "range":w.add(U)}return{codedValueFields:[...M],rangeFields:[...w]}};R._hashContingency=function(m,C,M=!1){if(1>C.length)return["#JSAPI_CONTINGENT_VALUE_EMPTY_HASH",!1];const w=[];let U=!1;for(const T of C)if(C=m.values[T],"any"===C.objectType){if(M)return["#JSAPI_CONTINGENT_VALUE_ANY_HASH",
!0];U=!0;w.push(`${T}:.*`)}else"null"===C.objectType?w.push(`${T}:${"#JSAPI_CONTINGENT_VALUE_NULL_HASH"}`):w.push(`${T}:${C.codedValue?.code}`);return[w.sort().join("\x26"),U]};R._compareObjectTypes=function(m,C){return{leftIsNull:"null"===m,rightIsNull:"null"===C,bothAreNull:"null"===m&&"null"===C,leftIsAny:"any"===m,rightIsAny:"any"===C,bothAreAny:"any"===m&&"any"===C,leftIsRange:"range"===m,rightIsRange:"range"===C}};b._createClass(F,[{key:"_arcadeContextInfo",get:function(){const {_initialFeature:m,
arcadeEditType:C,layer:M,spatialReference:w,view:U}=this;return{layer:G.isEditableLayer(M)?M:null,originalFeature:m,editType:C,spatialReference:w,map:U?.map}}},{key:"updating",get:function(){return this.updatingHandles.updating}},{key:"allInputFields",get:function(){return J(this.inputFields)}},{key:"_layerFieldsByName",get:function(){return new Map(this.layer.fields.map(m=>[m.name,m]))}},{key:"feature",get:function(){return this._get("feature")},set:function(m){this._featureClone=m?m.clone():D.clone();
this._initialFeature=this._featureClone.clone();this._resetInputFieldValues(this._featureClone);this.contingencyConstraintViolations.clear();h.isSome(this._expressionsManager)&&(this._expressionsManager.resetExecutors(),this._expressionsManager.feature=this._featureClone,this.updatingHandles.addPromise(this._expressionsManager.evaluateAll().finally(()=>this._afterExpressionsEvaluated())));this._set("feature",m)}},{key:"fieldsWithContingentValues",get:function(){if(h.isNone(this._contingentValuesCache))return new Set;
const m=this._contingentValuesCache.fieldGroups.flatMap(C=>C.fields);return new Set(m)}},{key:"formTemplate",get:function(){return this.layer&&"formTemplate"in this.layer?this.layer.formTemplate:null},set:function(m){void 0===m?this._clearOverride("formTemplate"):this._override("formTemplate",m)}},{key:"formDescription",get:function(){const {formTemplate:m,layer:C}=this;return!h.isNone(m)&&m.description&&C?O.parseFormTemplateString(m.description,this.getValues(),C.fieldsIndex):null}},{key:"formTitle",
get:function(){const {formTemplate:m,layer:C}=this;return!h.isNone(m)&&m.title&&C?O.parseFormTemplateString(m.title,this.getValues(),C.fieldsIndex):null}},{key:"joinedContingentValues",get:function(){return this._joinContingentValues()}},{key:"layer",get:function(){return this.feature?.sourceLayer&&"applyEdits"in this.feature.sourceLayer?this.feature.sourceLayer:null},set:function(m){this._override("layer",m)}},{key:"spatialReference",get:function(){return this.layer?.spatialReference??null},set:function(m){this._override("spatialReference",
m)}},{key:"state",get:function(){return this.messages&&this.get("layer.loaded")?"ready":"disabled"}},{key:"submittable",get:function(){return this.valid?!0:this.allInputFields.filter(m=>!m.valid).every(({submittable:m})=>m)}},{key:"valid",get:function(){const m=this.allInputFields;return 0<m.length&&m.every(({valid:C})=>C)}}]);return F}(K.HandleOwnerMixin(t.EsriPromiseMixin(u.EventedAccessor)));n.__decorate([r.property()],e.prototype,"_featureClone",void 0);n.__decorate([r.property()],e.prototype,
"_arcadeContextInfo",null);n.__decorate([r.property()],e.prototype,"updating",null);n.__decorate([r.property({readOnly:!0})],e.prototype,"allInputFields",null);n.__decorate([r.property()],e.prototype,"_layerFieldsByName",null);n.__decorate([r.property()],e.prototype,"arcadeEditType",void 0);n.__decorate([r.property()],e.prototype,"contingencyConstraintViolations",void 0);n.__decorate([r.property()],e.prototype,"feature",null);n.__decorate([r.property()],e.prototype,"fieldsWithContingentValues",null);
n.__decorate([r.property({type:x})],e.prototype,"formTemplate",null);n.__decorate([r.property()],e.prototype,"formDescription",null);n.__decorate([r.property()],e.prototype,"formTitle",null);n.__decorate([r.property()],e.prototype,"inputFields",void 0);n.__decorate([r.property()],e.prototype,"joinedContingentValues",null);n.__decorate([r.property()],e.prototype,"layer",null);n.__decorate([r.property()],e.prototype,"messages",void 0);n.__decorate([r.property()],e.prototype,"spatialReference",null);
n.__decorate([r.property()],e.prototype,"state",null);n.__decorate([r.property()],e.prototype,"strict",void 0);n.__decorate([r.property()],e.prototype,"submittable",null);n.__decorate([r.property()],e.prototype,"valid",null);n.__decorate([r.property()],e.prototype,"view",void 0);n.__decorate([r.property()],e.prototype,"getValues",null);n.__decorate([r.property()],e.prototype,"submit",null);e=n.__decorate([B.subclass("esri.widgets.FeatureForm.FeatureFormViewModel")],e);const J=N=>N.reduce((F,R)=>O.isGroupField(R)?
[...F,...R.inputFields]:[...F,R],[]),z=(N,F,R)=>{h.isSome(F)&&N.set(F,R)};return e})},"esri/layers/support/ContingentValue":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass".split(" "),function(b,n,e,H,u,K,E){e=function(h){function t(d){d=h.call(this,d)||this;d.maxValue=null;d.minValue=null;d.codedValue=
null;return d}b._inheritsLoose(t,h);return t}(e);n.__decorate([H.property()],e.prototype,"objectType",void 0);n.__decorate([H.property()],e.prototype,"maxValue",void 0);n.__decorate([H.property()],e.prototype,"minValue",void 0);n.__decorate([H.property()],e.prototype,"codedValue",void 0);return e=n.__decorate([E.subclass("esri.layers.support.ContingentValue")],e)})},"esri/layers/support/LayerContingentValuesCache":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../request ../../core/JSONSupport ../../core/Loadable ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass ./arcgisLayerUrl ./Contingency ./ContingencyConstraintViolation ./ContingentValue ./ContingentValuesResult ./FieldGroup ./Subtype".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k,r,l,p,B,x,y){var G;H=G=function(P){function O(g){g=P.call(this,g)||this;g.request=e;g.fieldGroups=null;g.fieldGroupDefinitions=null;return g}b._inheritsLoose(O,P);var L=O.prototype;L.initialize=function(){};O.createLoadedLayerContingentValuesCache=function(){var g=b._asyncToGenerator(function*(c){yield c.load();if(void 0===c.layerId)return null;var a=c.sourceJSON.hasContingentValuesDefinition;if(a)return(new G({layer:c})).load();if(void 0===a){a=k.parse(c.url);if(K.isNone(a))return null;
a=a.url.path;if((yield G._staticFetchEnterpriseFeatureRoot(a)).supportsQueryDataElements&&(a=yield G._staticFetchEnterpriseFieldGroup(a,c.layerId.toString())))return a=a.map(v=>({name:v.name,isEditingRestrictive:v.isEditingRestrictive,fields:v.fieldNames.names})),(new G({layer:c,fieldGroupDefinitions:a})).load()}return null});return function(c){return g.apply(this,arguments)}}();L.load=function(){var g=b._asyncToGenerator(function*(c){const a=this.layer.load(c).then(()=>this._initializeContingentValues(this.fieldGroupDefinitions,
c));this.addResolvingPromise(a);return this});return function(c){return g.apply(this,arguments)}}();L.validateContingencyConstraints=function(g,c){const a=Object.keys(g),v=[],Q=[];for(const f of this.fieldGroups){const A=f.isEditingRestrictive?"error":"warning";if(c&&!f.fields.some(N=>c.includes(N)))continue;if(!f.fields.every(N=>a.includes(N))){Q.push(new l({fieldGroup:f,type:A}));continue}let J=!1;const z=g[this.subtypeFieldName];var D=f.contingencies.filter(N=>!N.isRetired&&N.subtype?N.subtype.code===
z:!0);for(const N of D){D=!0;for(const F in N.values){const R=N.values[F];if("any"!==R.objectType)if("null"===R.objectType){if(null!=g[F]){D=!1;break}}else if("code"===R.objectType){if(g[F]!==R.codedValue.code){D=!1;break}}else if("range"===R.objectType){const m=g[F];if(m<R.minValue||m>R.maxValue){D=!1;break}}}if(D){J=!0;break}}J||v.push(new l({fieldGroup:f,type:A}))}return{invalid:v,incomplete:Q}};L.getContingentValues=function(g,c,a=!1){const v=g[this.subtypeFieldName],Q=void 0!==v&&null!==v,D=
{};let f=[];const A=this.fieldGroups.filter(z=>z.fields.includes(c));f.push(new p({objectType:"any"}));for(const z of A){let N=[];var J=z.contingencies.filter(m=>!m.isRetired&&(m.subtype&&Q?m.subtype.code===v:!0));let F=!1;const R={};for(const m of J){let C;J=!0;for(const M in m.values){const w=m.values[M];if(c===M)C=w,F=F||"range"===w.objectType;else if(void 0!==g[M]&&"any"!==w.objectType)if("null"===w.objectType)null!==g[M]&&(J=!1);else if("code"===w.objectType)g[M]!==w.codedValue.code&&(J=!1);
else if("range"===w.objectType){const U=g[M];if(U<w.minValue||U>w.maxValue)J=!1}}if(C&&J){if("any"===C.objectType){N.length=0;N.push(C);break}J=this._generateKey(C);R[J]||N.push(C);R[J]=!0}}F&&(N=this._joinRange(N));D[z.name]=N;f=a?this._filterIntersection(f,N):[]}1===A.length&&a&&(f=[]);return new B({contingentValuesAllGroups:f,contingentValuesByFieldGroup:D})};L._generateKey=function(g){switch(g.objectType){case "any":return"@any@";case "null":return"@null@";case "code":return g.codedValue.name+
g.codedValue.code.toString();case "range":return g.minValue.toString()+"-"+g.maxValue.toString()}};L._joinRange=function(g){g.sort((Q,D)=>"null"===Q.objectType?-1:"null"===D.objectType?1:Q.minValue-D.minValue);let c,a;const v=[];for(const Q of g)"null"===Q.objectType?v.push(Q):null==c||null==a?(c=Q.minValue,a=Q.maxValue):a<Q.minValue?(v.push(new p({objectType:"range",minValue:c,maxValue:a})),c=Q.minValue,a=Q.maxValue):a<Q.maxValue&&(a=Q.maxValue);v.push(new p({objectType:"range",minValue:c,maxValue:a}));
return v};L._filterIntersection=function(g,c){if(0===g.length||0===c.length)return[];if("any"===g[0].objectType)return c;if("any"===c[0].objectType)return g;const a="range"===c[0].objectType||"range"===c[1]?.objectType;return"range"===g[0].objectType||"range"===g[1]?.objectType||a?this._intersectRanges(g,c):this._intersectValues(g,c)};L._intersectRanges=function(g,c){const a=[];let v=0;for(const Q of g)for(;v<c.length;v++){const D=c[v];if("null"===Q.objectType&&"null"===D.objectType)a.push(new p({objectType:"null"}));
else if("null"===Q.objectType)break;else if("null"===D.objectType)continue;if(Q.maxValue<D.minValue)break;if(Q.maxValue===D.minValue){a.push(new p({objectType:"range",minValue:Q.maxValue,maxValue:D.minValue}));break}if(!(Q.minValue>D.maxValue))if(Q.minValue===D.maxValue)a.push(new p({objectType:"range",minValue:Q.minValue,maxValue:D.maxValue}));else{g=Q.minValue>D.minValue?Q.minValue:D.minValue;if(Q.maxValue<D.maxValue){a.push(new p({objectType:"range",minValue:g,maxValue:Q.maxValue}));break}a.push(new p({objectType:"range",
minValue:g,maxValue:D.maxValue}))}}return a};L._intersectValues=function(g,c){const a=[];for(const v of g)c.some(Q=>{if(v.objectType===Q.objectType)switch(v.objectType){case "any":case "null":return!0;case "code":return v.codedValue.code===Q.codedValue.code&&v.codedValue.name===Q.codedValue.name}return!1})&&a.push(v);return a};O._staticFetchEnterpriseFeatureRoot=function(){var g=b._asyncToGenerator(function*(c,a){return e(c,{responseType:"json",query:{f:"json"},...a}).then(v=>v.data)});return function(c,
a){return g.apply(this,arguments)}}();O._staticFetchEnterpriseFieldGroup=function(){var g=b._asyncToGenerator(function*(c,a,v){return e(`${c}/queryDataElements`,{responseType:"json",query:{layers:JSON.stringify([a]),f:"json"},...v}).then(Q=>Q.data.layerDataElements?.[0].dataElement.fieldGroups)});return function(c,a,v){return g.apply(this,arguments)}}();L._initializeContingentValues=function(){var g=b._asyncToGenerator(function*(c,a){c=c?c:yield this._fetchFieldGroupDefs(a);this.fieldGroups=0===c.length?
[]:yield this._fetchContingentValues(c,a)});return function(c,a){return g.apply(this,arguments)}}();L._fetchFieldGroupDefs=function(){var g=b._asyncToGenerator(function*(c){var a=this;if(void 0===this.layer.layerId)return[];const v=this.layer.sourceJSON,Q=this.layer.layerId.toString(),D=K.unwrap(k.parse(this.layer.url)).url.path;return v.hasContingentValuesDefinition?(yield this._fetchAGOLFieldGroup(D,Q,c)).map(f=>({name:f.name,isEditingRestrictive:f.restrictive,fields:f.fields.map(A=>this.layer.fieldsIndex.normalizeFieldName(A))})):
void 0!==v.hasContingentValuesDefinition?[]:this._fetchEnterpriseFeatureRoot(D,c).then(function(){var f=b._asyncToGenerator(function*(A){return A.supportsQueryDataElements?(yield a._fetchEnterpriseFieldGroup(D,Q,c)).map(J=>({name:J.name,isEditingRestrictive:J.isEditingRestrictive,fields:J.fieldNames.names.map(z=>a.layer.fieldsIndex.normalizeFieldName(z))})):[]});return function(A){return f.apply(this,arguments)}}())});return function(c){return g.apply(this,arguments)}}();L._fetchAGOLFieldGroup=function(){var g=
b._asyncToGenerator(function*(c,a,v){return e(`${c}/${a}/fieldgroups`,{responseType:"json",query:{f:"json"},...v}).then(Q=>Q.data.fieldGroups)});return function(c,a,v){return g.apply(this,arguments)}}();L._fetchEnterpriseFieldGroup=function(){var g=b._asyncToGenerator(function*(c,a,v){return G._staticFetchEnterpriseFieldGroup(c,a,v)});return function(c,a,v){return g.apply(this,arguments)}}();L._fetchEnterpriseFeatureRoot=function(){var g=b._asyncToGenerator(function*(c,a){return G._staticFetchEnterpriseFeatureRoot(c,
a)});return function(c,a){return g.apply(this,arguments)}}();L._fetchContingentValues=function(){var g=b._asyncToGenerator(function*(c,a){if(void 0===this.layer.layerId)return[];const v=this.layer.sourceJSON,Q=this.layer.layerId.toString(),D=K.unwrap(k.parse(this.layer.url)).url.path;if(v.hasContingentValuesDefinition)return a=yield this._fetchAGOLContingentValues(D,Q,a),this._constructFieldGroupsAGOL(c,a);a=yield this._fetchEnterpriseContingentValues(D,Q,a);return this._constructFieldGroupsEnterprise(c,
a)});return function(c,a){return g.apply(this,arguments)}}();L._constructFieldGroupsAGOL=function(g,c){return g.map(a=>{const v=c.contingentValuesDefinition.fieldGroups.find(Q=>Q.name===a.name);if(v){let Q=[];Q=c.contingentValuesDefinition.hasSubType?this._parseAGOLFieldGroupSubtype(a,c,v.subTypes):this._parseAGOLFieldGroup(a,c,v.contingentValues);return new x({name:a.name,isEditingRestrictive:a.isEditingRestrictive,fields:a.fields,contingencies:Q})}return null}).filter(K.isSome)};L._parseAGOLFieldGroupSubtype=
function(g,c,a){let v=[];a?.forEach(Q=>{const D=this._getSubtypeAGOL(Q.name);v=v.concat(this._parseAGOLFieldGroup(g,c,Q.contingentValues,D))});return v};L._parseAGOLFieldGroup=function(g,c,a,v=null){const Q=[];for(const D of a??[])a=this._parseAGOLContingency(D,g,c,v),Q.push(a);return Q};L._parseAGOLContingency=function(g,c,a,v){const Q=g.id,D=g.retired?1===g.retired:!1,f={};for(let J=0,z=0;J<c.fields.length;J++){const N=c.fields[J];var A=a.typeCodes[g.types[J]];if("Code"===A){let F=g.values[z];z++;
const R=this._getDomain(v,N);"string"===this.layer.getField(N)?.type&&(A=a.stringDicts.find(m=>m.domain===R.name))&&(F=A.entries[F]);A=R.codedValues.find(m=>m.code===F);A=new p({codedValue:A,objectType:"code"});f[N]=A}else"Range"===A?(A=g.values[z],z++,A=new p({minValue:A.range[0],maxValue:A.range[1],objectType:"range"}),f[N]=A):"Any"===A?(A=new p({objectType:"any"}),f[N]=A):(A=new p({objectType:"null"}),f[N]=A)}return new r({id:Q,isRetired:D,subtype:v,values:f})};L._constructFieldGroupsEnterprise=
function(g,c){const a=c.fieldGroups;return g.map(v=>{var Q=a.find(D=>D.name===v.name);return Q?(Q=Q.contingencies.map(D=>{const f=D.id,A=D.isRetired||!1,J=this._getSubtypeEnterprise(D.subtypeCode),z={};for(let F=0;F<v.fields.length;F++){const R=v.fields[F];let m=D.values[F];if("number"===typeof m||"string"===typeof m){var N=this._getDomain(J,R);const C=this.layer.getField(R);"string"===C?.type?m=c.stringDictionary[m]:"date"===C?.type&&(m=(new Date(`${m}+00:00`)).getTime());N=N.codedValues.find(M=>
M.code===m);N=new p({codedValue:N,objectType:"code"});z[R]=N}else"object"===typeof m?(N=new p({minValue:m.minValue,maxValue:m.maxValue,objectType:"range"}),z[R]=N):m?(N=new p({objectType:"any"}),z[R]=N):(N=new p({objectType:"null"}),z[R]=N)}return new r({id:f,isRetired:A,subtype:J,values:z})}),new x({name:v.name,isEditingRestrictive:v.isEditingRestrictive,fields:v.fields,contingencies:Q})):null}).filter(K.isSome)};L._fetchEnterpriseContingentValues=function(){var g=b._asyncToGenerator(function*(c,
a,v){return e(`${c}/queryContingentValues`,{responseType:"json",query:{layers:JSON.stringify([a]),f:"json"},...v}).then(Q=>Q.data.contingentValueSets?.[0])});return function(c,a,v){return g.apply(this,arguments)}}();L._fetchAGOLContingentValues=function(){var g=b._asyncToGenerator(function*(c,a,v){return e(`${c}/${a}/contingentValues`,{responseType:"json",query:{f:"json"},...v}).then(Q=>Q.data)});return function(c,a,v){return g.apply(this,arguments)}}();L._getSubtypeEnterprise=function(g){var c=this.layer.sourceJSON;
let a;c.subtypes&&(c=c.subtypes.find(v=>v.code===g),a=y.fromJSON(c));return a?a:null};L._getSubtypeAGOL=function(g){var c=this.layer.sourceJSON;let a;c.subtypes&&(c=c.subtypes.find(v=>v.name===g),a=y.fromJSON(c));return a?a:null};L._getDomain=function(g,c){g=g?g.domains?.[c]:this.layer.getFieldDomain(c);return"inherited"===g?.type?this.layer.getFieldDomain(c):g};b._createClass(O,[{key:"subtypeFieldName",get:function(){const {layer:g}=this;return"subtype-group"===g.type?g.subtypeField:g.typeIdField}}]);
return O}(H.JSONSupportMixin(u));n.__decorate([E.property({constructOnly:!0})],H.prototype,"layer",void 0);n.__decorate([E.property({constructOnly:!0})],H.prototype,"request",void 0);n.__decorate([E.property({type:[x]})],H.prototype,"fieldGroups",void 0);n.__decorate([E.property({constructOnly:!0})],H.prototype,"fieldGroupDefinitions",void 0);n.__decorate([E.property()],H.prototype,"subtypeFieldName",null);return H=G=n.__decorate([d.subclass("esri.layers.support.LayerContingentValuesCache")],H)})},
"esri/layers/support/Contingency":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass".split(" "),function(b,n,e,H,u,K,E){e=function(h){function t(d){d=h.call(this,d)||this;d.isRetired=!1;return d}b._inheritsLoose(t,h);return t}(e);n.__decorate([H.property()],e.prototype,"id",void 0);n.__decorate([H.property()],
e.prototype,"isRetired",void 0);n.__decorate([H.property()],e.prototype,"subtype",void 0);n.__decorate([H.property()],e.prototype,"values",void 0);return e=n.__decorate([E.subclass("esri.layers.support.Contingency")],e)})},"esri/layers/support/ContingencyConstraintViolation":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,n,e,H,u,K,E){e=function(h){function t(d){return h.call(this,d)||this}b._inheritsLoose(t,h);return t}(e);n.__decorate([H.property()],e.prototype,"fieldGroup",void 0);n.__decorate([H.property()],e.prototype,"type",void 0);return e=n.__decorate([E.subclass("esri.layers.support.ContingencyConstraintViolation")],e)})},"esri/layers/support/ContingentValuesResult":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,n,e,H,u,K,E){e=function(h){function t(d){return h.call(this,d)||this}b._inheritsLoose(t,h);return t}(e);n.__decorate([H.property()],e.prototype,"contingentValuesAllGroups",void 0);n.__decorate([H.property()],e.prototype,"contingentValuesByFieldGroup",void 0);return e=n.__decorate([E.subclass("esri.layers.support.ContingentValuesResult")],e)})},"esri/layers/support/FieldGroup":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,n,e,H,u,K,E){e=function(h){function t(d){d=h.call(this,d)||this;d.fields=null;d.isEditingRestrictive=!1;return d}b._inheritsLoose(t,h);return t}(e);n.__decorate([H.property()],e.prototype,"name",void 0);n.__decorate([H.property()],e.prototype,"fields",void 0);n.__decorate([H.property()],e.prototype,"isEditingRestrictive",void 0);n.__decorate([H.property()],e.prototype,"contingencies",void 0);return e=n.__decorate([E.subclass("esri.layers.support.FieldGroup")],e)})},"esri/layers/support/Subtype":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ./domains".split(" "),
function(b,n,e,H,u,K,E,h,t,d){e=function(k){function r(){var p=k.apply(this,arguments)||this;p.code=null;p.defaultValues={};p.domains=null;p.name=null;return p}b._inheritsLoose(r,k);var l=r.prototype;l.readDomains=function(p){if(!p)return null;const B={};for(const x of Object.keys(p))B[x]=d.fromJSON(p[x]);return B};l.writeDomains=function(p,B){if(p){var x={};for(const y of Object.keys(p))p[y]&&(x[y]=p[y]?.toJSON());B.domains=x}};return r}(e.JSONSupport);n.__decorate([H.property({type:Number,json:{write:!0}})],
e.prototype,"code",void 0);n.__decorate([H.property({type:Object,json:{write:!0}})],e.prototype,"defaultValues",void 0);n.__decorate([H.property({json:{write:!0}})],e.prototype,"domains",void 0);n.__decorate([E.reader("domains")],e.prototype,"readDomains",null);n.__decorate([t.writer("domains")],e.prototype,"writeDomains",null);n.__decorate([H.property({type:String,json:{write:!0}})],e.prototype,"name",void 0);return e=n.__decorate([h.subclass("esri.layers.support.Subtype")],e)})},"esri/widgets/FeatureForm/FormExpressionArcadeExecutor":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../arcade ../../core/Accessor ../../core/promiseUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass ../../core/support/WatchUpdatingTracking ../../layers/support/fieldUtils".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k,r){h=Symbol("FormExpressionArcadeExecutor");b.FormExpressionArcadeExecutor=function(p){function B(y){var G=p.call(this,y)||this;G[l]=!0;G._lastEvaluatedValue=null;G._abortController=new AbortController;G._stale=!1;G._updatingTracking=new k.WatchUpdatingTracking;G._executeAsyncDebounced=K.debounce(function(){var P=n._asyncToGenerator(function*(O,L,g){O=yield G.executor.executeAsync(O,{...L,abortSignal:g});if(g.aborted)return G._lastEvaluatedValue;G._lastEvaluatedValue=
O;G._stale=!1;return O});return function(O,L,g){return P.apply(this,arguments)}}());return G}n._inheritsLoose(B,p);var x=B.prototype;x.abort=function(){this._abortController.abort()};x.execute=function(y,G){this._abortController=new AbortController;return this._lastEvaluatedValue=y=this.executor.execute(y,{...G,abortSignal:this._abortController.signal})};x.executeAsync=function(){var y=n._asyncToGenerator(function*(G,P){this._abortController=new AbortController;return this._updatingTracking.addPromise(this._executeAsyncDebounced(G,
P??{},this._abortController.signal))});return function(G,P){return y.apply(this,arguments)}}();x.markStale=function(){this._stale=!0};x.reset=function(){this.abort();this._lastEvaluatedValue=null;this._stale=!1};n._createClass(B,[{key:"isAsync",get:function(){return this.executor.isAsync}},{key:"fieldsUsed",get:function(){return this.executor.fieldsUsed}},{key:"syntaxTree",get:function(){return this.executor.syntaxTree}},{key:"updating",get:function(){return this._updatingTracking.updating}},{key:"stale",
get:function(){return this._stale}},{key:"geometryUsed",get:function(){return this.executor.geometryUsed}},{key:"variablesUsed",get:function(){return this.executor.variablesUsed}},{key:"lastEvaluatedValue",get:function(){return this._lastEvaluatedValue}}]);return B}(u);var l=h;e.__decorate([E.property()],b.FormExpressionArcadeExecutor.prototype,"_lastEvaluatedValue",void 0);e.__decorate([E.property()],b.FormExpressionArcadeExecutor.prototype,"_stale",void 0);e.__decorate([E.property()],b.FormExpressionArcadeExecutor.prototype,
"_updatingTracking",void 0);e.__decorate([E.property({constructOnly:!0})],b.FormExpressionArcadeExecutor.prototype,"executor",void 0);e.__decorate([E.property()],b.FormExpressionArcadeExecutor.prototype,"isAsync",null);e.__decorate([E.property()],b.FormExpressionArcadeExecutor.prototype,"fieldsUsed",null);e.__decorate([E.property()],b.FormExpressionArcadeExecutor.prototype,"syntaxTree",null);e.__decorate([E.property()],b.FormExpressionArcadeExecutor.prototype,"updating",null);e.__decorate([E.property()],
b.FormExpressionArcadeExecutor.prototype,"stale",null);e.__decorate([E.property()],b.FormExpressionArcadeExecutor.prototype,"geometryUsed",null);e.__decorate([E.property()],b.FormExpressionArcadeExecutor.prototype,"variablesUsed",null);e.__decorate([E.property()],b.FormExpressionArcadeExecutor.prototype,"lastEvaluatedValue",null);b.FormExpressionArcadeExecutor=e.__decorate([d.subclass("esri.widgets.FeatureForm.FormExpressionArcadeExecutor")],b.FormExpressionArcadeExecutor);e=function(){var p=n._asyncToGenerator(function*(B,
x){const y=H.createArcadeProfile("form-calculation");B=yield H.createArcadeExecutor(B,y,{});x?.fieldsIndex&&(B.fieldsUsed=r.fixFields(x.fieldsIndex,B.fieldsUsed));return new b.FormExpressionArcadeExecutor({executor:B})});return function(B,x){return p.apply(this,arguments)}}();b.createFormExpressionArcadeExecutor=e;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/arcade":function(){define("exports ./chunks/_rollupPluginBabelHelpers ./Graphic ./arcade/ArcadeDate ./arcade/ImmutableArray ./core/Error ./core/lang ./layers/FeatureLayer ./portal/Portal ./rest/support/FeatureSet ./support/arcadeOnDemand".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k){function r(v,Q,D,f={}){Q=Q.elementType;const A="array"===Q.type?[{name:"value",type:Q.type,elementType:Q.elementType}]:"dictionary"===Q.type?[{name:"value",type:Q.type,properties:Q.properties}]:[{name:"value",type:Q.type}];return new u(v.map(J=>{const z={};x(z,A,{value:J},D,f);return z.value}))}function l(v,Q,D={}){v=v instanceof d?new h({source:v.features,geometryType:v.geometryType,fields:v.fields,spatialReference:v.spatialReference}):v;return Q.constructFeatureSet(v,
D.spatialReference,null,!0,D.lruCache,D.interceptor)}function p(v,Q,D={}){const {spatialReference:f,interceptor:A,lruCache:J}=D;return"string"===typeof v?Q.createFeatureSetCollectionFromService(v,f,J,A):Q.createFeatureSetCollectionFromMap(v,f,J,A)}function B(v,Q,D,f={}){const A={};x(A,Q.properties,v,D,f);return new L.Dictionary(A)}function x(v,Q,D,f,A={}){const J={};for(const z of Object.keys(D))J[z.toLowerCase()]=D[z];for(const z of Q)if(Q=z.name.toLowerCase(),A.variablesPreProcessed)v[Q]=J[Q];else switch(z.type){case "array":v[Q]=
r(J[Q],z,f,A);break;case "feature":D=J[Q];v[Q]=null==D?null:L.Feature.createFromGraphic(D,A?.timeReference);break;case "featureSet":D=J[Q];v[Q]=f?l(D,f,A):null;break;case "featureSetCollection":D=J[Q];v[Q]=f?p(D,f,A):null;break;case "dictionary":v[Q]=B(J[Q],z,f,A);break;case "date":D=J[Q];v[Q]=D?D instanceof H.ArcadeDate?D:A?.timeReference?.timeZone?H.ArcadeDate.dateJSAndZoneToArcadeDate(D,A?.timeReference?.timeZone):H.ArcadeDate.dateJSToArcadeDate(D):null;break;case "geometry":case "boolean":case "text":case "number":v[Q]=
J[Q]}}function y(v,Q){for(const D of v)Q.push(D),"dictionary"===D.type&&y(D.properties,Q);return Q}function G(v,Q,D,f,A){const {spatialReference:J,interceptor:z,lruCache:N,console:F,abortSignal:R,timeReference:m,services:C={portal:t.getDefault()}}=D;A={vars:{},spatialReference:J,interceptor:z,timeReference:m,lrucache:N,useAsync:A,services:C,console:F,abortSignal:R};if(!Q)return A;x(A.vars,v.variables,Q,f,D);return A}function P(v,Q){switch(Q.getArcadeType(v)){case "date":return v.toJSDate();case "feature":var D=
"geometry"in v?v.geometry():null;v="readAttributes"in v?v.readAttributes():v.attributes;return new e({geometry:D,attributes:v});case "dictionary":D=v.attributes;const f={};for(const A of Object.keys(D))f[A]=P(v.field(A),Q);return f;case "array":return("toArray"in v?v.toArray():v).map(A=>P(A,Q))}return v}function O(){O=n._asyncToGenerator(function*(v,Q,D={}){L||(L=yield k.loadArcade());const {arcade:f,arcadeUtils:A}=L,{loadScriptDependencies:J,referencesMember:z,scriptIsAsync:N}=f;var F=y(Q.variables,
[]),R=F.filter(S=>"featureSet"===S.type||"featureSetCollection"===S.type).map(S=>S.name.toLowerCase());const m=f.parseScript(v,R);if(!m)throw new K("arcade:invalid-script","Unable to create SyntaxTree");v=A.extractFieldNames(m);const C=f.scriptTouchesGeometry(m);F=F.map(S=>S.name.toLowerCase()).filter(S=>z(m,S));const M=N(m,R);yield J(m,M,R);R={vars:{},spatialReference:null,useAsync:M};for(const S of F)R.vars[S]="any";const {lruCache:w}=D,U=f.compileScript(m,R),T=f.featureSetUtils();return{execute:(S,
Y={})=>{if(M)throw new K("arcade:invalid-execution-mode","Cannot execute the script in synchronous mode");S=U(G(Q,S,{lruCache:w,...Y},T,M));return Y.rawOutput?S:P(S,A)},executeAsync:function(){var S=n._asyncToGenerator(function*(Y,ha={}){Y=yield U(G(Q,Y,{lruCache:w,...ha},T,M));return ha.rawOutput?Y:P(Y,A)});return function(Y){return S.apply(this,arguments)}}(),isAsync:M,variablesUsed:F,fieldsUsed:v,geometryUsed:C,syntaxTree:m}});return O.apply(this,arguments)}let L=null;const g={variables:[{name:"$feature",
type:"feature"},{name:"$layer",type:"featureSet"},{name:"$datastore",type:"featureSetCollection"},{name:"$map",type:"featureSetCollection"}]},c={variables:[{name:"$feature",type:"feature"},{name:"$aggregatedFeatures",type:"featureSet"}]},a=new Map([["form-constraint",{variables:[{name:"$feature",type:"feature"}]}],["feature-z",{variables:[{name:"$feature",type:"feature"}]}],["field-calculation",{variables:[{name:"$feature",type:"feature"},{name:"$datastore",type:"featureSetCollection"}]}],["form-calculation",
{variables:[{name:"$feature",type:"feature"},{name:"$originalFeature",type:"feature"},{name:"$layer",type:"featureSet"},{name:"$featureSet",type:"featureSet"},{name:"$datastore",type:"featureSetCollection"},{name:"$map",type:"featureSetCollection"},{name:"$editContext",type:"dictionary",properties:[{name:"editType",type:"text"}]}]}],["labeling",{variables:[{name:"$feature",type:"feature"}]}],["popup",g],["popup-element",g],["feature-reduction-popup",c],["feature-reduction-popup-element",c],["visualization",
{variables:[{name:"$feature",type:"feature"},{name:"$view",type:"dictionary",properties:[{name:"scale",type:"number"}]}]}]]);b.createArcadeExecutor=function(v,Q){return O.apply(this,arguments)};b.createArcadeProfile=function(v){var Q=a.get(v);if(!Q)throw Q=Array.from(a.keys()).map(D=>`'${D}'`).join(", "),new K("createArcadeProfile:invalid-profile-name",`Invalid profile name '${v}'. You must specify one of the following values: ${Q}`);return E.clone(Q)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},
"esri/arcade/ArcadeDate":function(){define(["exports","../chunks/_rollupPluginBabelHelpers","./executionError","../chunks/datetime"],function(b,n,e,H){function u(d){if(d instanceof H.Zone)return d;if("system"===d.toLowerCase())return"system";if("utc"===d.toLowerCase())return"utc";if("unknown"===d.toLowerCase())return K.instance;if(/^[\+\-]?[0-9]{1,2}([:][0-9]{2})?$/.test(d)){const k=H.FixedOffsetZone.parseSpecifier("UTC"+(d.startsWith("+")||d.startsWith("-")?"":"+")+d);if(k)return k}d=H.IANAZone.create(d);
if(!d.isValid)throw new h(b.ArcadeDateErrorCodes.TimeZoneNotRecognised);return d}let K=function(){};K.instance=new H.IANAZone("Etc/UTC");b.ArcadeDateErrorCodes=void 0;(b.ArcadeDateErrorCodes||(b.ArcadeDateErrorCodes={})).TimeZoneNotRecognised="TimeZoneNotRecognised";const E={[b.ArcadeDateErrorCodes.TimeZoneNotRecognised]:"Timezone identifier has not been recognised."};let h=function(d){function k(r,l){r=d.call(this,e.doSubstitutions(E[r],l))||this;r.declaredRootClass="esri.arcade.arcadedate.dateerror";
Error.captureStackTrace&&Error.captureStackTrace(n._assertThisInitialized(r),k);return r}n._inheritsLoose(k,d);return k}(n._wrapNativeSuper(Error)),t=function(){function d(r){this._date=r;this.declaredRootClass="esri.arcade.arcadedate"}d.fromParts=function(r=0,l=1,p=1,B=0,x=0,y=0,G=0,P){if(isNaN(r)||isNaN(l)||isNaN(p)||isNaN(B)||isNaN(x)||isNaN(y)||isNaN(G))return null;let O=0;var L=H.DateTime.local(r,l).daysInMonth;1>p&&(O=p-1,p=1);p>L&&(O=p-L,p=L);L=0;12<l?(L=l-12,l=12):1>l&&(L=l-1,l=1);let g=0;
59<x?(g=x-59,x=59):0>x&&(g=x,x=0);let c=0;59<y?(c=y-59,y=59):0>y&&(c=y,y=0);let a=0;999<G?(a=G-999,G=999):0>G&&(a=G,G=0);r=H.DateTime.fromObject({day:p,year:r,month:l,hour:B,minute:x,second:y,millisecond:G},{zone:u(P)});0!==L&&(r=r.plus({months:L}));0!==O&&(r=r.plus({days:O}));0!==g&&(r=r.plus({minutes:g}));0!==c&&(r=r.plus({seconds:c}));0!==a&&(r=r.plus({milliseconds:a}));return new d(r)};d.arcadeDateAndZoneToArcadeDate=function(r,l){const p=u(l);return r.isUnknownTimeZone||p===K.instance?d.fromParts(r.year,
r.monthJS+1,r.day,r.hour,r.minute,r.second,r.millisecond,p):new d(r._date.setZone(l))};d.dateJSToArcadeDate=function(r){return new d(H.DateTime.fromJSDate(r,{zone:"system"}))};d.dateJSAndZoneToArcadeDate=function(r,l="system"){return new d(H.DateTime.fromJSDate(r,{zone:l}))};d.unknownEpochToArcadeDate=function(r){return new d(H.DateTime.fromMillis(r,{zone:K.instance}))};d.unknownDateJSToArcadeDate=function(r){return new d(H.DateTime.fromMillis(r.getTime(),{zone:K.instance}))};d.epochToArcadeDate=
function(r,l="system"){return new d(H.DateTime.fromMillis(r,{zone:l}))};d.dateTimeToArcadeDate=function(r){return new d(r)};var k=d.prototype;k.changeTimeZone=function(r){r=u(r);return d.dateTimeToArcadeDate(this._date.setZone(r))};d.dateTimeAndZoneToArcadeDate=function(r,l){l=u(l);return r.zone===K.instance||l===K.instance?d.fromParts(r.year,r.month,r.day,r.hour,r.minute,r.second,r.millisecond,l):new d(r.setZone(l))};d.nowToArcadeDate=function(r){return new d(H.DateTime.fromJSDate(new Date,{zone:r}))};
d.nowUTCToArcadeDate=function(){return new d(H.DateTime.utc())};k.equals=function(r){return this.isSystem&&r.isSystem?this.toNumber()===r.toNumber():this.isUnknownTimeZone!==r.isUnknownTimeZone?!1:this._date.equals(r._date)};k.stringify=function(){return JSON.stringify(this.toJSDate())};k.plus=function(r){return new d(this._date.plus(r))};k.diff=function(r,l="milliseconds"){return this._date.diff(r._date,l)[l]};k.toISOString=function(r){return r?this._date.toISO({suppressMilliseconds:!0,includeOffset:!this.isUnknownTimeZone}):
this._date.toISO({includeOffset:!this.isUnknownTimeZone})};k.toFormat=function(r,l){return this._date.toFormat(r,l)};k.toJSDate=function(){return this._date.toJSDate()};k.toSQLString=function(){return"timestamp '"+this._date.toFormat("yyyy-LL-dd HH:mm:ss")+"'"};k.toDateTime=function(){return this._date};k.toNumber=function(){return this._date.toMillis()};k.getTime=function(){return this._date.toMillis()};k.toUTC=function(){return new d(this._date.toUTC())};k.toLocal=function(){return new d(this._date.toLocal())};
k.toString=function(){return this.toISOString(!0)};n._createClass(d,[{key:"isSystem",get:function(){return"system"===this.timeZone||this.timeZone===d.systemTimeZoneCanonicalName}},{key:"isUnknownTimeZone",get:function(){return this._date.zone===K.instance}},{key:"isValid",get:function(){return this._date.isValid}},{key:"hour",get:function(){return this._date.hour}},{key:"second",get:function(){return this._date.second}},{key:"day",get:function(){return this._date.day}},{key:"dayOfWeekISO",get:function(){return this._date.weekday}},
{key:"dayOfWeekJS",get:function(){let r=this._date.weekday;6<r&&(r=0);return r}},{key:"millisecond",get:function(){return this._date.millisecond}},{key:"monthISO",get:function(){return this._date.month}},{key:"weekISO",get:function(){return this._date.weekNumber}},{key:"yearISO",get:function(){return this._date.weekYear}},{key:"monthJS",get:function(){return this._date.month-1}},{key:"year",get:function(){return this._date.year}},{key:"minute",get:function(){return this._date.minute}},{key:"zone",
get:function(){return this._date.zone}},{key:"timeZoneOffset",get:function(){return this.isUnknownTimeZone?0:this._date.offset}},{key:"timeZone",get:function(){if(this.isUnknownTimeZone)return"unknown";if("system"===this._date.zone.type)return"system";const r=this.zone;return"fixed"===r.type?0===r.fixed?"utc":r.formatOffset(0,"short"):r.name}}],[{key:"systemTimeZoneCanonicalName",get:function(){return Intl.DateTimeFormat().resolvedOptions().timeZone??"system"}}]);return d}();b.ArcadeDate=t;b.ArcadeDateError=
h;b.ArcadeDateErrorMessages=E;b.UnknownTimeZone=K;b.createDateTimeZone=u;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/executionError":function(){define(["exports","../chunks/_rollupPluginBabelHelpers"],function(b,n){function e(l){return l&&l.loc?`Line : ${l.loc.start?.line}, ${l.loc.start?.column}: `:""}function H(l,p){try{if(!p)return l;for(const B in p){let x=p[B];x||(x="");l=l.replace("{"+B+"}",p[B])}}catch(B){}return l}b.ExecutionErrorCodes=void 0;(function(l){l.AsyncNotEnabled=
"AsyncNotEnabled";l.ModulesNotSupported="ModulesNotSupported";l.CircularModules="CircularModules";l.NeverReach="NeverReach";l.UnsupportedHashType="UnsupportedHashType";l.InvalidParameter="InvalidParameter";l.UnexpectedToken="UnexpectedToken";l.Unrecognised="Unrecognised";l.UnrecognisedType="UnrecognisedType";l.MaximumCallDepth="MaximumCallDepth";l.BooleanConditionRequired="BooleanConditionRequired";l.TypeNotAllowedInFeature="TypeNotAllowedInFeature";l.KeyMustBeString="KeyMustBeString";l.WrongNumberOfParameters=
"WrongNumberOfParameters";l.CallNonFunction="CallNonFunction";l.NoFunctionInTemplateLiteral="NoFunctionInTemplateLiteral";l.NoFunctionInDictionary="NoFunctionInDictionary";l.NoFunctionInArray="NoFunctionInArray";l.AssignModuleFunction="AssignModuleFunction";l.LogicExpressionOrAnd="LogicExpressionOrAnd";l.LogicalExpressionOnlyBoolean="LogicalExpressionOnlyBoolean";l.FuncionNotFound="FunctionNotFound";l.InvalidMemberAccessKey="InvalidMemberAccessKey";l.UnsupportedUnaryOperator="UnsupportUnaryOperator";
l.InvalidIdentifier="InvalidIdentifier";l.MemberOfNull="MemberOfNull";l.UnsupportedOperator="UnsupportedOperator";l.Cancelled="Cancelled";l.ModuleAccessorMustBeString="ModuleAccessorMustBeString";l.ModuleExportNotFound="ModuleExportNotFound";l.Immutable="Immutable";l.OutOfBounds="OutOfBounds";l.IllegalResult="IllegalResult";l.FieldNotFound="FieldNotFound";l.PortalRequired="PortalRequired";l.LogicError="LogicError";l.ArrayAccessorMustBeNumber="ArrayAccessMustBeNumber";l.KeyAccessorMustBeString="KeyAccessorMustBeString";
l.WrongSpatialReference="WrongSpatialReference"})(b.ExecutionErrorCodes||(b.ExecutionErrorCodes={}));const u={[b.ExecutionErrorCodes.TypeNotAllowedInFeature]:"Feature attributes only support dates, numbers, strings, guids.",[b.ExecutionErrorCodes.LogicError]:"Logic error - {reason}",[b.ExecutionErrorCodes.NeverReach]:"Encountered unreachable logic",[b.ExecutionErrorCodes.AsyncNotEnabled]:"Async Arcade must be enabled for this script",[b.ExecutionErrorCodes.ModuleAccessorMustBeString]:"Module accessor must be a string",
[b.ExecutionErrorCodes.ModuleExportNotFound]:"Module has no export with provided identifier",[b.ExecutionErrorCodes.ModulesNotSupported]:"Current profile does not support modules",[b.ExecutionErrorCodes.ArrayAccessorMustBeNumber]:"Array accessor must be a number",[b.ExecutionErrorCodes.FuncionNotFound]:"Function not found",[b.ExecutionErrorCodes.FieldNotFound]:"Key not found - {key}",[b.ExecutionErrorCodes.CircularModules]:"Circular module dependencies are not allowed",[b.ExecutionErrorCodes.Cancelled]:"Execution cancelled",
[b.ExecutionErrorCodes.UnsupportedHashType]:"Type not supported in hash function",[b.ExecutionErrorCodes.IllegalResult]:"Value is not a supported return type",[b.ExecutionErrorCodes.PortalRequired]:"Portal is required",[b.ExecutionErrorCodes.InvalidParameter]:"Invalid parameter",[b.ExecutionErrorCodes.WrongNumberOfParameters]:"Call with wrong number of parameters",[b.ExecutionErrorCodes.Unrecognised]:"Unrecognised code structure",[b.ExecutionErrorCodes.UnrecognisedType]:"Unrecognised type",[b.ExecutionErrorCodes.WrongSpatialReference]:"Cannot work with geometry in this spatial reference. It is different to the execution spatial reference",
[b.ExecutionErrorCodes.BooleanConditionRequired]:"Conditions must use booleans",[b.ExecutionErrorCodes.NoFunctionInDictionary]:"Dictionaries cannot contain functions.",[b.ExecutionErrorCodes.NoFunctionInArray]:"Arrays cannot contain functions.",[b.ExecutionErrorCodes.NoFunctionInTemplateLiteral]:"Template Literals do not expect functions by value.",[b.ExecutionErrorCodes.KeyAccessorMustBeString]:"Accessor must be a string",[b.ExecutionErrorCodes.KeyMustBeString]:"Object keys must be a string",[b.ExecutionErrorCodes.Immutable]:"Object is immutable",
[b.ExecutionErrorCodes.InvalidParameter]:"Invalid parameter",[b.ExecutionErrorCodes.UnexpectedToken]:"Unexpected token",[b.ExecutionErrorCodes.MemberOfNull]:"Cannot access property of null object",[b.ExecutionErrorCodes.MaximumCallDepth]:"Exceeded maximum function depth",[b.ExecutionErrorCodes.OutOfBounds]:"Out of bounds",[b.ExecutionErrorCodes.InvalidIdentifier]:"Identifier not recognised",[b.ExecutionErrorCodes.FuncionNotFound]:"Function not found",[b.ExecutionErrorCodes.CallNonFunction]:"Expression is not a function",
[b.ExecutionErrorCodes.InvalidMemberAccessKey]:"Cannot access value using a key of this type",[b.ExecutionErrorCodes.AssignModuleFunction]:"Cannot assign function to module variable",[b.ExecutionErrorCodes.UnsupportedUnaryOperator]:"Unsupported unary operator",[b.ExecutionErrorCodes.UnsupportedOperator]:"Unsupported operator",[b.ExecutionErrorCodes.LogicalExpressionOnlyBoolean]:"Logical expressions must be boolean",[b.ExecutionErrorCodes.LogicExpressionOrAnd]:"Logical expression can only be combined with || or \x26\x26"};
let K=function(l){function p(...B){return l.call(this,...B)||this}n._inheritsLoose(p,l);return p}(n._wrapNativeSuper(Error)),E=function(l){function p(B,x){B=l.call(this,e(x)+B.message,{cause:B})||this;B.loc=null;Error.captureStackTrace&&Error.captureStackTrace(n._assertThisInitialized(B),p);x&&x.loc&&(B.loc=x.loc);return B}n._inheritsLoose(p,l);return p}(K),h=function(l){function p(B,x,y,G){B=l.call(this,"Execution error - "+e(y)+H(u[x],G))||this;B.loc=null;B.declaredRootClass="esri.arcade.arcadeexecutionerror";
Error.captureStackTrace&&Error.captureStackTrace(n._assertThisInitialized(B),p);y&&y.loc&&(B.loc=y.loc);return B}n._inheritsLoose(p,l);return p}(n._wrapNativeSuper(Error)),t=function(l){function p(B,x,y,G){B=l.call(this,"Compilation error - "+e(y)+H(u[x],G))||this;B.loc=null;B.declaredRootClass="esri.arcade.arcadecompilationerror";Error.captureStackTrace&&Error.captureStackTrace(n._assertThisInitialized(B),p);y&&y.loc&&(B.loc=y.loc);return B}n._inheritsLoose(p,l);return p}(n._wrapNativeSuper(Error)),
d=function(l){function p(){var B=l.call(this,"Uncompilable code structures")||this;B.declaredRootClass="esri.arcade.arcadeuncompilableerror";Error.captureStackTrace&&Error.captureStackTrace(n._assertThisInitialized(B),p);return B}n._inheritsLoose(p,l);return p}(n._wrapNativeSuper(Error));b.ModuleErrorCodes=void 0;(function(l){l.UnrecognisedUri="UnrecognisedUri";l.UnsupportedUriProtocol="UnsupportedUriProtocol"})(b.ModuleErrorCodes||(b.ModuleErrorCodes={}));const k={[b.ModuleErrorCodes.UnrecognisedUri]:"Unrecognised uri - {uri}",
[b.ModuleErrorCodes.UnsupportedUriProtocol]:"Unrecognised uri protocol"};let r=function(l){function p(B,x){B=l.call(this,H(k[B],x))||this;B.declaredRootClass="esri.arcade.arcademoduleerror";Error.captureStackTrace&&Error.captureStackTrace(n._assertThisInitialized(B),p);return B}n._inheritsLoose(p,l);return p}(n._wrapNativeSuper(Error));b.ArcadeCompilationError=t;b.ArcadeExecutionError=h;b.ArcadeUncompilableError=d;b.ErrorWithCause=K;b.ExecutionErrorMessages=u;b.LocatableArcadeExecutionError=E;b.ModuleError=
r;b.ModuleErrorMessages=k;b.doSubstitutions=H;b.ensureArcadeExecutionError=function(l,p,B){return"esri.arcade.arcadeexecutionerror"===B.declaredRootClass||"esri.arcade.arcadecompilationerror"===B.declaredRootClass?null===B.loc&&p&&p.loc?new E(B,{cause:B}):B:p&&p.loc?new E(B,{cause:B}):B};b.parsingValidationMessage=function(l,p,B){return"Parsing error - "+e(l)+H(u[p],B)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/ImmutableArray":function(){define(function(){return function(){function b(e=
[]){this._elements=e}var n=b.prototype;n.length=function(){return this._elements.length};n.get=function(e){return this._elements[e]};n.toArray=function(){const e=[];for(let H=0;H<this.length();H++)e.push(this.get(H));return e};return b}()})},"esri/widgets/FeatureForm/FormExpressionsManager":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/MapUtils ../../core/maybe ../../core/promiseUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k){b.FormExpressionsManager=function(p){function B(y){var G=p.call(this,y)||this;G._fieldReferencesLookup=new Map;G._fieldsAffectedLookup=new Map;G._latestFieldValues={...y.feature.attributes};return G}n._inheritsLoose(B,p);var x=B.prototype;x.initialize=function(){this._dependencyGraph=this._buildDependencyGraph()};x.evaluateAll=function(){return this._evaluate(this.executors)};x.evaluateExpressions=function(y){return this._evaluate(y)};x.evaluateInvalidated=function(y){const {_fieldReferencesLookup:G,
_latestFieldValues:P,feature:O}=this,L=new Set;for(const g of y)if(P[g]=O.getAttribute(g),G.has(g))for(const c of G.get(g))L.add(c);return this._evaluate([...L])};x.evaluateInvalidatedByGeometry=function(){var y=n._asyncToGenerator(function*(){if(this._fieldReferencesLookup.has("#JSAPI_FORM_EXPRESSIONS_MANAGER_GEOMETRY"))return this._evaluate([...this._fieldReferencesLookup.get("#JSAPI_FORM_EXPRESSIONS_MANAGER_GEOMETRY")])});return function(){return y.apply(this,arguments)}}();x.resetExecutors=function(){for(const y of this.executors)y.reset()};
x._buildDependencyGraph=function(){const {_fieldReferencesLookup:y,_fieldsAffectedLookup:G,executors:P}=this,O=new Map(this.inputFields.map(g=>[g.name,g])),L=new Map(P.map(g=>[g,[]]));for(const g of P){for(const c of g.fieldsUsed){u.getOrCreateMapValue(y,c,()=>new Set).add(g);const a=O.get(c),{valueExpressionExecutor:v,editableExpressionExecutor:Q}=a;K.isSome(v)&&v!==g&&(L.get(v).push(g),u.getOrCreateMapValue(G,v,()=>new Set).add(a));K.isSome(Q)&&Q!==g&&(L.get(Q).push(g),u.getOrCreateMapValue(G,Q,
()=>new Set).add(a))}g.geometryUsed&&u.getOrCreateMapValue(y,"#JSAPI_FORM_EXPRESSIONS_MANAGER_GEOMETRY",()=>new Set).add(g)}return L};x._evaluate=function(){var y=n._asyncToGenerator(function*(G){var P=this;const O=new Map,{_dependencyGraph:L,_fieldsAffectedLookup:g,_latestFieldValues:c}=this;for(const a of G)r(a,O,L);for(const [a,{resolver:v,dependencyPromises:Q}]of O)Promise.all(Q).then(n._asyncToGenerator(function*(){const [D,f]=P._makeContext(c);return a.executeAsync(D,f)})).then(()=>{if(g.has(a))for(const D of g.get(a))this._latestFieldValues[D.name]=
D.value;v.resolve()},D=>{!D||E.isAbortError(D)||l(D)||a.markStale();v.reject(D)});G=(yield Promise.allSettled(Array.from(O.values(),({resolver:a})=>a.promise))).filter(a=>"rejected"===a.status&&!(E.isAbortError(a.reason)||l(a.reason)));if(0<G.length)throw new AggregateError(G,"One or more expression executions failed");});return function(G){return y.apply(this,arguments)}}();x._makeContext=function(y){const [G,P]=this._baseContext,O=this.feature.clone();O.attributes=y;return[{...G,$feature:O},P]};
n._createClass(B,[{key:"_baseContext",get:function(){const {editType:y,layer:G,map:P,originalFeature:O,spatialReference:L}=this.arcadeContextInfo,g="feature"===G?.type?G:"scene"===G?.type&&K.isSome(G.associatedLayer)?G.associatedLayer:void 0;return[{$originalfeature:O,$editcontext:{editType:y},$layer:g,$featureset:g,$datastore:G?.url,$map:P},{spatialReference:L}]}},{key:"feature",set:function(y){this._latestFieldValues={...y?.attributes};this._set("feature",y)}}]);return B}(H);e.__decorate([h.property()],
b.FormExpressionsManager.prototype,"_baseContext",null);e.__decorate([h.property()],b.FormExpressionsManager.prototype,"feature",null);e.__decorate([h.property()],b.FormExpressionsManager.prototype,"executors",void 0);e.__decorate([h.property()],b.FormExpressionsManager.prototype,"inputFields",void 0);e.__decorate([h.property()],b.FormExpressionsManager.prototype,"arcadeContextInfo",void 0);b.FormExpressionsManager=e.__decorate([k.subclass("esri.widgets.FeatureForm.FormExpressionsManager")],b.FormExpressionsManager);
const r=(p,B,x)=>{if(!B.has(p)){var y=E.createResolver();B.set(p,{resolver:y,dependencyPromises:[]});p.abort();p=x.get(p);for(const G of p)r(G,B,x),B.get(G).dependencyPromises.push(y.promise)}},l=p=>p&&"object"===typeof p&&"message"in p&&"Cancelled"===p.message;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/FeatureForm/InputField":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../intl ../../core/Accessor ../../core/HandleOwner ../../core/maybe ../../core/uid ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass ../../layers/support/CodedValue ../../core/has ../../layers/support/CodedValueDomain ../../layers/support/Domain ../../layers/support/InheritedDomain ../../layers/support/RangeDomain ../../layers/support/domainUtils ../../layers/support/fieldUtils ../../layers/support/layerUtils ./featureFormUtils ../../intl/substitute".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k,r,l,p,B,x,y,G,P,O,L,g){function c(z){return 1E7<=z||-1E7>=z}var a;(function(z){z.Text="text";z.Number="number";z.Date="date";z.Unsupported="unsupported"})(a||(a={}));var v;(v||(v={})).TOO_SHORT="length-validation-error::too-short";const Q={type:"number"},D={type:"number",intlOptions:{notation:"scientific"}},f={type:"date",intlOptions:{day:"2-digit",month:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}};e=function(z){function N(R){R=z.call(this,
R)||this;R._storedValue=null;R.arcadeEditType="NA";R.editableExpressionExecutor=null;R.id=E.generateUID().toString();R.requiredExpressionExecutor=null;R.valueExpressionExecutor=null;R.visibilityExpressionExecutor=null;R.feature=null;R.field=null;R.fieldElement=null;R.layer=null;R.error=null;R.group=null;R.messages=null;return R}b._inheritsLoose(N,z);var F=N.prototype;F._isDomainCompatible=function(R){const {field:m}=this;if("coded-value"===R?.type){const C=typeof R.codedValues[0].code;if("string"===
C&&P.isStringField(m)||"number"===C&&P.isNumericField(m))return!0}return"range"===R?.type&&P.isNumericField(m)||P.isDateField(m)?!0:!1};F._validate=function(){const {domain:R,field:m,initialFeature:C,minLength:M,required:w,type:U,valid:T,value:S}=this,Y=w&&null===S,ha=void 0!==T;return!Y&&C.getAttribute(m.name)===S&&ha?null:Y?P.TypeValidationError.INVALID_TYPE:"text"===U&&-1<M&&"string"===typeof S&&S.length<M?v.TOO_SHORT:R?null!==S||w?G.validateDomainValue(R,S):null:P.validateFieldValue(m,S)};F._isVisibleByDefault=
function(){const R=this.field?.type;return this.field?.visible&&"oid"!==R&&"global-id"!==R&&!this._isGeometryField()};F._isEditorField=function(){return P.getFeatureEditFields(this.layer).includes(this.name)};F._isGeometryField=function(){return P.getFeatureGeometryFields(this.layer).includes(this.name)};F._shouldUseValueExpression=function(){return this._layerFieldAllowsEdits&&!this._configAllowsEdits&&K.isSome(this.valueExpressionExecutor)};F._toErrorMessage=function(){const {domain:R,field:m,messages:C,
minLength:M,value:w,required:U,type:T}=this;var S=this.error;return U&&null===w?C.validationErrors.cannotBeNull:S===G.DomainValidationError.VALUE_OUT_OF_RANGE||S===P.NumericRangeValidationError.OUT_OF_RANGE?(S=G.getDomainRange(R)||P.getFieldRange(m),g.substitute(C.validationErrors.outsideRange,S,{format:{max:"date"===T?f:c(S.max)?D:Q,min:"date"===T?f:c(S.min)?D:Q}})):S===G.DomainValidationError.INVALID_CODED_VALUE?C.validationErrors.invalidCodedValue:S===P.TypeValidationError.INVALID_TYPE?C.validationErrors.invalidType:
S===v.TOO_SHORT?g.substitute(C.validationErrors.tooShort,{min:M}):null};b._createClass(N,[{key:"_configAllowsEdits",get:function(){const {fieldElement:R,layer:m,name:C}=this;return K.isSome(R)?R.editableExpression?this.evaluatedEditableExpression:!1!==R.editable:m.userHasUpdateItemPrivileges?!0:("popupTemplate"in m?m?.popupTemplate?.fieldInfos?.find(({fieldName:M})=>M===C):null)?.isEditable??!0}},{key:"_layerFieldAllowsEdits",get:function(){const {field:R,layer:m}=this;if(!m||!R)return!1;var C=O.getEffectiveLayerCapabilities(m);
const M=C?.operations.supportsEditing,w=R.editable;C=A(C,this.arcadeEditType);return!!(M&&w&&C)}},{key:"isUsingValueExpression",get:function(){return this._shouldUseValueExpression()}},{key:"evaluatedEditableExpression",get:function(){const {editableExpressionExecutor:R}=this;return K.isSome(R)?!!R.lastEvaluatedValue:null}},{key:"evaluatedRequiredExpression",get:function(){const {requiredExpressionExecutor:R}=this;return K.isSome(R)?!!R.lastEvaluatedValue:null}},{key:"evaluatedVisibilityExpression",
get:function(){const {visibilityExpressionExecutor:R}=this;return K.isSome(R)?!!R.lastEvaluatedValue:null}},{key:"evaluatedValueExpression",get:function(){const {valueExpressionExecutor:R}=this;return K.isSome(R)?R.lastEvaluatedValue:null}},{key:"initialFeature",set:function(R){this._set("initialFeature",R);this.notifyChange("valid")}},{key:"description",get:function(){return K.unwrap(this.fieldElement)?.description}},{key:"domain",get:function(){var {layer:R}=this;const {typeFieldName:m,types:C}=
L.getNormalizedFeatureTypeInfo(R);if(m===this.name&&K.isNone(this.field.domain))return new p({name:"__internal-type-based-coded-value-domain__",codedValues:C.map(({code:w,name:U})=>new r.CodedValue({code:w,name:U}))});var {feature:M}=this;R=R.getFieldDomain(this.name,{feature:M});M=K.get(this.fieldElement,"domain");return K.isSome(M)&&this._isDomainCompatible(M)?M:R}},{key:"editable",get:function(){return this._layerFieldAllowsEdits?this.evaluatedEditableExpression??this._configAllowsEdits:!1}},{key:"inputType",
get:function(){return K.unwrap(this.fieldElement)?.input?.type}},{key:"errorMessage",get:function(){return this._toErrorMessage()}},{key:"hint",get:function(){return K.unwrap(this.fieldElement)?.hint}},{key:"includeTime",get:function(){var {fieldElement:R}=this;R=K.isSome(R)&&"datetime-picker"===R.input?.type?R.input.includeTime:void 0;return void 0===R?!0:R}},{key:"label",get:function(){return K.isSome(this.fieldElement)&&this.fieldElement.label||this.field.alias||this.field.name}},{key:"maxLength",
get:function(){if(this.type===a.Date)return-1;const {field:R,fieldElement:m}=this,C=R?.length,M=J(m)?m.input.maxLength:NaN;return!isNaN(M)&&-1<=M&&(-1===C||M<=C)?M:C}},{key:"minLength",get:function(){if(this.type===a.Date)return-1;const {field:R,fieldElement:m}=this,C=R?.length,M=J(m)?m.input.minLength:NaN;return!isNaN(M)&&-1<=M&&(-1===C||M<=C)?M:-1}},{key:"name",get:function(){return this.field?.name}},{key:"required",get:function(){const {editable:R,evaluatedRequiredExpression:m,field:C,visible:M}=
this;return R?!1===C?.nullable?!0:M&&K.isSome(m)?m:!1:!1},set:function(R){this._overrideIfSome("required",R)}},{key:"submittable",get:function(){const {field:R,required:m,valid:C,value:M}=this;return m&&K.isNone(M)?!1:C?!0:this.initialFeature.getAttribute(R.name)===M}},{key:"type",get:function(){const {field:R}=this;return P.isNumericField(R)?a.Number:P.isStringField(R)?a.Text:P.isDateField(R)?a.Date:a.Unsupported}},{key:"updating",get:function(){const {editableExpressionExecutor:R,valueExpressionExecutor:m}=
this;return K.isSome(m)&&m.updating||K.isSome(R)&&R.updating}},{key:"valid",get:function(){const R=this.editable?this._validate():null;this._set("error",R);return null===R}},{key:"value",get:function(){if(this._shouldUseValueExpression()){const R=this.evaluatedValueExpression;if(this.type===a.Date){if(R instanceof Date)return R.getTime();if("number"!==typeof R)return parseInt(R,10)}return K.isSome(R)&&"object"===typeof R?R.toString():R}return this.get("_storedValue")},set:function(R){this.notifyChange("evaluatedVisibilityExpression");
this.set("_storedValue",R)}},{key:"visible",get:function(){return this._isEditorField()?!1:K.isSome(this.evaluatedVisibilityExpression)?this.evaluatedVisibilityExpression:K.isSome(this.fieldElement)?!0:this._isVisibleByDefault()}}]);return N}(u.HandleOwnerMixin(H));n.__decorate([h.property()],e.prototype,"_storedValue",void 0);n.__decorate([h.property()],e.prototype,"_configAllowsEdits",null);n.__decorate([h.property()],e.prototype,"_layerFieldAllowsEdits",null);n.__decorate([h.property()],e.prototype,
"arcadeEditType",void 0);n.__decorate([h.property()],e.prototype,"editableExpressionExecutor",void 0);n.__decorate([h.property()],e.prototype,"requiredExpressionExecutor",void 0);n.__decorate([h.property()],e.prototype,"valueExpressionExecutor",void 0);n.__decorate([h.property()],e.prototype,"isUsingValueExpression",null);n.__decorate([h.property()],e.prototype,"visibilityExpressionExecutor",void 0);n.__decorate([h.property()],e.prototype,"evaluatedEditableExpression",null);n.__decorate([h.property()],
e.prototype,"evaluatedRequiredExpression",null);n.__decorate([h.property()],e.prototype,"evaluatedVisibilityExpression",null);n.__decorate([h.property()],e.prototype,"evaluatedValueExpression",null);n.__decorate([h.property()],e.prototype,"feature",void 0);n.__decorate([h.property()],e.prototype,"field",void 0);n.__decorate([h.property({constructOnly:!0})],e.prototype,"fieldElement",void 0);n.__decorate([h.property()],e.prototype,"initialFeature",null);n.__decorate([h.property()],e.prototype,"layer",
void 0);n.__decorate([h.property({readOnly:!0})],e.prototype,"description",null);n.__decorate([h.property()],e.prototype,"domain",null);n.__decorate([h.property()],e.prototype,"editable",null);n.__decorate([h.property({readOnly:!0})],e.prototype,"inputType",null);n.__decorate([h.property({readOnly:!0})],e.prototype,"error",void 0);n.__decorate([h.property({dependsOn:["error","messages","value"]})],e.prototype,"errorMessage",null);n.__decorate([h.property()],e.prototype,"group",void 0);n.__decorate([h.property({readOnly:!0})],
e.prototype,"hint",null);n.__decorate([h.property()],e.prototype,"includeTime",null);n.__decorate([h.property()],e.prototype,"label",null);n.__decorate([h.property()],e.prototype,"maxLength",null);n.__decorate([h.property()],e.prototype,"minLength",null);n.__decorate([h.property()],e.prototype,"messages",void 0);n.__decorate([h.property({readOnly:!0})],e.prototype,"name",null);n.__decorate([h.property()],e.prototype,"required",null);n.__decorate([h.property()],e.prototype,"submittable",null);n.__decorate([h.property()],
e.prototype,"type",null);n.__decorate([h.property()],e.prototype,"updating",null);n.__decorate([h.property()],e.prototype,"valid",null);n.__decorate([h.property({value:null})],e.prototype,"value",null);n.__decorate([h.property()],e.prototype,"visible",null);e=n.__decorate([k.subclass("esri.widgets.FeatureForm.InputField")],e);const A=(z,N)=>{if(!z)return!0;({operations:z}=z);switch(N){case "INSERT":return z.supportsAdd;case "UPDATE":case "DELETE":return z.supportsUpdate;default:return!0}},J=z=>K.isSome(z)&&
(L.isFieldElementWithInputType(z,"text-box")||L.isFieldElementWithInputType(z,"text-area"));return e})},"esri/widgets/FeatureForm/InputFieldGroup":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/HandleOwner ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass".split(" "),function(b,n,e,H,u,K,E,
h,t,d){e=function(k){function r(p){p=k.call(this,p)||this;p._expressionTrackingHandles=new Map;p.visibilityExpressionExecutor=null;p.feature=null;p.groupElement=null;return p}b._inheritsLoose(r,k);var l=r.prototype;l.initialize=function(){this.addHandles([K.watch(()=>[this.visible,this.inputFields],([p])=>{const {inputFields:B}=this;p=p?void 0:!1;for(const x of B)x.required=p},{initial:!0,equals:(p,B)=>B[0]===p[0]&&B[1]===p[1]})])};l.destroy=function(){for(const p of this._expressionTrackingHandles.values())p.remove()};
l._dirtyEvaluatedVisibilityExpression=function(){const {groupElement:p}=this;u.isSome(p)&&p.visibilityExpression&&this.notifyChange("evaluatedVisibilityExpression")};b._createClass(r,[{key:"visibilityExpression",get:function(){return u.unwrap(this.groupElement)?.visibilityExpression},set:function(p){u.applySome(this.groupElement,B=>{B.visibilityExpression=p})}},{key:"evaluatedVisibilityExpression",get:function(){const {visibilityExpressionExecutor:p}=this;return u.isSome(p)?!!p.lastEvaluatedValue:
null}},{key:"description",get:function(){return u.unwrap(this.groupElement)?.description},set:function(p){u.applySome(this.groupElement,B=>{B.description=p})}},{key:"inputFields",get:function(){return this._get("inputFields")},set:function(p){this.handles.removeAll();p&&this.handles.add(p.map(B=>K.watch(()=>B.visible,()=>this._dirtyEvaluatedVisibilityExpression())));this._set("inputFields",p)}},{key:"label",get:function(){return u.unwrap(this.groupElement)?.label},set:function(p){u.applySome(this.groupElement,
B=>{B.label=p})}},{key:"state",get:function(){return u.isSome(this.groupElement)&&this.groupElement.initialState||"expanded"},set:function(p){this._overrideIfSome("state",p)}},{key:"visible",get:function(){return!1!==this.evaluatedVisibilityExpression&&this.inputFields&&this.inputFields.some(p=>p.visible)}}]);return r}(H.HandleOwnerMixin(e));n.__decorate([E.property()],e.prototype,"visibilityExpression",null);n.__decorate([E.property()],e.prototype,"visibilityExpressionExecutor",void 0);n.__decorate([E.property()],
e.prototype,"evaluatedVisibilityExpression",null);n.__decorate([E.property()],e.prototype,"description",null);n.__decorate([E.property()],e.prototype,"feature",void 0);n.__decorate([E.property()],e.prototype,"groupElement",void 0);n.__decorate([E.property()],e.prototype,"initialFeature",void 0);n.__decorate([E.property()],e.prototype,"inputFields",null);n.__decorate([E.property()],e.prototype,"label",null);n.__decorate([E.property()],e.prototype,"state",null);n.__decorate([E.property()],e.prototype,
"visible",null);return e=n.__decorate([d.subclass("esri.widgets.FeatureForm.InputFieldGroup")],e)})},"esri/widgets/support/Heading":function(){define(["exports","../../core/mathUtils","./widgetUtils","./jsxFactory"],function(b,n,e,H){const u={heading:"esri-widget__heading"};b.CSS=u;b.Heading=function({level:K,class:E,...h},t){K=n.clamp(Math.ceil(K),1,6);return H.tsx(`h${K}`,{...h,class:e.classes(u.heading,E),role:"heading","aria-level":String(K)},t)};b.incrementHeadingLevel=function(K,E=1){return n.clamp(Math.ceil(K+
E),1,6)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/FeatureTemplates":function(){define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/HandleOwner ../core/maybe ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/arrayUtils ../core/accessorSupport/decorators/subclass ./Widget ./FeatureTemplates/FeatureTemplatesViewModel ./FeatureTemplates/ItemList ./FeatureTemplates/TemplateItem ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k,r,l,p,B,x,y,G){function P(L){return L.id}const O={filter:!0};H=function(L){function g(a,v){a=L.call(this,a,v)||this;a._iconIntersectionObserver=new IntersectionObserver((Q,D)=>{Q.forEach(function(){var f=n._asyncToGenerator(function*(A){if(A.isIntersecting){const N=A.target;if(N["data-has-icon"])D.unobserve(N);else{var {layer:J,template:z}=N["data-item"];N["data-has-icon"]=!0;A=yield p.fetchThumbnail(J,z).catch(()=>{N["data-has-icon"]=!1;return null});u.isNone(A)||N.appendChild(A)}}});
return function(A){return f.apply(this,arguments)}}())});a.enableListScroll=!0;a.filterText="";a.headingLevel=4;a.messages=null;a.viewModel=new r;a.visibleElements={...O};a.renderItemIcon=a.renderItemIcon.bind(n._assertThisInitialized(a));a._afterItemCreateOrUpdate=a._afterItemCreateOrUpdate.bind(n._assertThisInitialized(a));a._afterItemRemoved=a._afterItemRemoved.bind(n._assertThisInitialized(a));return a}n._inheritsLoose(g,L);var c=g.prototype;c.initialize=function(){const a=({label:v})=>!this.filterText||
!!v?.toLowerCase().includes(this.filterText.toLowerCase());this.addHandles(K.watch(()=>this.viewModel,(v,Q)=>{v&&!v.filterFunction&&(this.filterFunction=a);Q&&Q!==v&&Q.filterFunction===a&&(Q.filterFunction=null)},K.initial))};c.destroy=function(){this._iconIntersectionObserver?.disconnect();this._iconIntersectionObserver=null};c.loadDependencies=function(){return Promise.all([new Promise((a,v)=>b(["../chunks/calcite-input"],a,v)),new Promise((a,v)=>b(["../chunks/calcite-list-item"],a,v))])};c.castVisibleElements=
function(a){return{...O,...a}};c.select=function(a,v){return this.viewModel.select(a,v)};c.render=function(){const {enableListScroll:a,filterText:v,headingLevel:Q,messages:D,viewModel:{items:f,numberOfFeatureTemplates:A,selectedItem:J,state:z}}=this,N=this.visibleElements.filter&&1<A;if(0<f.length&&"items"in f[0]){const F=f.find(R=>R.label===r.nullGroupBy.label);F&&(F.label=D.other)}return G.tsx("div",{class:this.classes("esri-feature-templates","esri-widget"),"aria-label":D.widgetLabel},"loading"===
z?this.renderLoader():"ready"===z?G.tsx(l.ItemList,{id:this.id,identify:P,filterText:v,items:f,headingLevel:Q,selectionMode:"single",messages:{filterPlaceholder:D.filterPlaceholder,noItems:D.noItems,noMatches:D.noMatches},filterEnabled:N,onItemSelect:F=>this.viewModel.select(F),onFilterChange:F=>{this.filterText=F;this.viewModel.refresh()},renderIcon:this.renderItemIcon,selectedItem:J??void 0,enableListScroll:a}):null)};c.renderItemIcon=function({item:a}){return G.tsx("span",{key:"icon",afterCreate:this._afterItemCreateOrUpdate,
afterUpdate:this._afterItemCreateOrUpdate,afterRemoved:this._afterItemRemoved,"data-item":a,"data-has-icon":!1})};c.renderLoader=function(){return G.tsx("div",{class:"esri-feature-templates__loader",key:"loader"})};c._afterItemCreateOrUpdate=function(a){this._iconIntersectionObserver?.observe(a)};c._afterItemRemoved=function(a){this._iconIntersectionObserver?.unobserve(a)};n._createClass(g,[{key:"filterFunction",get:function(){return this.viewModel.filterFunction},set:function(a){this.viewModel.filterFunction=
a}},{key:"groupBy",get:function(){return this.viewModel.groupBy},set:function(a){this.viewModel.groupBy=a}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(a){this._overrideIfSome("label",a)}},{key:"layers",get:function(){return this.viewModel.layers},set:function(a){this.viewModel.layers=a}},{key:"selectedItem",get:function(){return this.viewModel.selectedItem}}]);return g}(H.HandleOwnerMixin(k));e.__decorate([E.property()],H.prototype,"enableListScroll",void 0);e.__decorate([E.property()],
H.prototype,"filterFunction",null);e.__decorate([E.property()],H.prototype,"filterText",void 0);e.__decorate([E.property()],H.prototype,"groupBy",null);e.__decorate([E.property()],H.prototype,"headingLevel",void 0);e.__decorate([E.property()],H.prototype,"label",null);e.__decorate([E.property()],H.prototype,"layers",null);e.__decorate([E.property(),x.messageBundle("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],H.prototype,"messages",void 0);e.__decorate([E.property({readOnly:!0})],H.prototype,
"selectedItem",null);e.__decorate([E.property(),y.vmEvent("select")],H.prototype,"viewModel",void 0);e.__decorate([E.property()],H.prototype,"visibleElements",void 0);e.__decorate([h.cast("visibleElements")],H.prototype,"castVisibleElements",null);return H=e.__decorate([d.subclass("esri.widgets.FeatureTemplates")],H)})},"esri/widgets/FeatureTemplates/FeatureTemplatesViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Evented ../../core/HandleOwner ../../core/maybe ../../core/ObjectPool ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass ../../layers/support/layerUtils ./TemplateItem ./TemplateItemGroup".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k,r,l,p){var B;const x=({layer:P})=>({key:P,label:P.title??""}),y=({layer:P})=>({key:P.geometryType,label:P.geometryType??""});e=B=function(P){function O(g){g=P.call(this,g)||this;g._itemPool=new K(l);g._groupPool=new K(p);g.filterFunction=null;g.selectedItem=null;return g}b._inheritsLoose(O,P);var L=O.prototype;L.initialize=function(){this._get("groupBy")||(this.groupBy="layer")};L.refresh=function(){this.notifyChange("items")};L.select=function(g,c=!0){const a=this.selectedItem;
g=g?.clone()||null;this._set("selectedItem",g);c&&this.emit("select",{item:g,oldItem:a,template:g?.template??null})};L._createItem=function(g,c){const a=this._itemPool.acquire();a.set({template:g,layer:c});return a};L._createGroup=function(g,c){const a=this._groupPool.acquire();a.set("label",g);a.items=c;return a};L._releasePreviousItems=function(){this._destroyItems(this._get("items"))};L._destroyItems=function(g){g&&(g[0]instanceof l?g.forEach(c=>this._destroyItem(c)):g.forEach(c=>this._destroyGroup(c)))};
L._destroyGroup=function(g){g.items.forEach(c=>this._destroyItem(c));g.items.length=0;this._groupPool.release(g)};L._destroyItem=function(g){g.layer=null;g.template=null;this._itemPool.release(g)};L._ensureGroupByObject=function(g){return"string"===typeof g?{key:g,label:g}:g};b._createClass(O,[{key:"groupBy",set:function(g){this._set("groupBy",g);if("function"===typeof g)this._groupByFunction=c=>this._ensureGroupByObject(g(c));else switch(g){case "layer":this._groupByFunction=x;break;case "geometry":this._groupByFunction=
y;break;default:this._groupByFunction=null}}},{key:"layers",get:function(){return this._get("layers")},set:function(g){this.handles.remove("layers");if(g){const c=()=>this.notifyChange("state");this.handles.add(g.map(a=>E.when(()=>a.loadStatus,c)),"layers")}this._set("layers",g)}},{key:"state",get:function(){const {layers:g}=this;return g&&0!==g.length?g.some(c=>"loading"===c.loadStatus||"not-loaded"===c.loadStatus)?"loading":"ready":"disabled"}},{key:"_featureTemplatesByLayer",get:function(){if(!this.layers)return new Map;
const g=[];for(const c of this.layers)if("subtype-group"===c.type)for(const a of c.sublayers){const v=G(a);g.push([a,v])}else g.push([c,G(c)]);return new Map(g)}},{key:"numberOfFeatureTemplates",get:function(){return Array.from(this._featureTemplatesByLayer.values()).reduce((g,c)=>g+c.length,0)}},{key:"items",get:function(){if(0===this.numberOfFeatureTemplates)return this._releasePreviousItems(),[];var g=this._featureTemplatesByLayer,c=[],a=u.isSome(this.filterFunction)?this.filterFunction:B._nullFilterFunction;
for(const [D,f]of g)if(D.loaded||"subtype-sublayer"===D.type&&D.parent?.loaded)if(g=r.getEffectiveLayerCapabilities(D)?.operations,g?.supportsEditing&&g?.supportsAdd)for(var v of f)c.push({layer:D,template:v,matchesFilter:a({label:v.name})});if(u.isNone(this._groupByFunction))return a=c.filter(({matchesFilter:D})=>D).map(({template:D,layer:f})=>this._createItem(D,f)),this._releasePreviousItems(),a;v=new Map;for(var Q of c){const {template:D,layer:f}=Q;c=this._groupByFunction({template:D,layer:f});
const {key:A,label:J}=u.isSome(c.key)?c:B.nullGroupBy;v.has(A)||v.set(A,{label:J,templateItemInfos:[]});v.get(A)?.templateItemInfos.push(Q)}Q=[];for(const D of v.values()){const {label:f,templateItemInfos:A}=D;c=A.filter(({matchesFilter:J})=>J);c=a({label:f})?A:0<A.length?c:[];0<c.length&&(c=c.map(({template:J,layer:z})=>this._createItem(J,z)),Q.push(this._createGroup(f,c)))}if(1===Q.length&&Q[0].label===B.nullGroupBy.label)return this._releasePreviousItems(),Q[0].items;this._releasePreviousItems();
return Q}}]);return O}(H.HandleOwnerMixin(e.EventedAccessor));e.nullGroupBy={key:Symbol(),label:"Other\u200b"};e._nullFilterFunction=P=>!0;n.__decorate([h.property()],e.prototype,"_groupByFunction",void 0);n.__decorate([h.property()],e.prototype,"filterFunction",void 0);n.__decorate([h.property()],e.prototype,"groupBy",null);n.__decorate([h.property()],e.prototype,"layers",null);n.__decorate([h.property()],e.prototype,"state",null);n.__decorate([h.property({readOnly:!0})],e.prototype,"_featureTemplatesByLayer",
null);n.__decorate([h.property({readOnly:!0})],e.prototype,"numberOfFeatureTemplates",null);n.__decorate([h.property({readOnly:!0})],e.prototype,"items",null);n.__decorate([h.property({readOnly:!0})],e.prototype,"selectedItem",void 0);n.__decorate([h.property()],e.prototype,"select",null);e=B=n.__decorate([k.subclass("esri.widgets.FeatureTemplates.FeatureTemplatesViewModel")],e);const G=P=>{const O="templates"in P&&Array.isArray(P.templates)?P.templates:[];P="types"in P&&Array.isArray(P.types)?P.types.flatMap(L=>
L.templates):[];return[...O,...P]};return e})},"esri/widgets/FeatureTemplates/TemplateItem":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Graphic ../../core/Accessor ../../core/HandleOwner ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass ../../symbols/support/symbolUtils".split(" "),function(b,n,e,H,u,K,
E,h,t,d,k,r,l){function p(O,L){return B.apply(this,arguments)}function B(){B=n._asyncToGenerator(function*(O,L){var {renderer:g}=O;return g&&(L=new H({attributes:L.prototype.attributes}),g=yield g.getSymbolAsync(L))?g:x(O)});return B.apply(this,arguments)}function x(O){return y.apply(this,arguments)}function y(){y=n._asyncToGenerator(function*(O){({geometryType:O}=O);return(O="point"===O||"multipoint"===O?yield new Promise((L,g)=>b(["../../symbols/SimpleMarkerSymbol"],c=>L(G(c)),g)):"polyline"===
O?yield new Promise((L,g)=>b(["../../symbols/SimpleLineSymbol"],c=>L(G(c)),g)):"polygon"===O||"mesh"===O||"multipatch"===O?yield new Promise((L,g)=>b(["../../symbols/SimpleFillSymbol"],c=>L(G(c)),g)):null)?new O.default:null});return y.apply(this,arguments)}const G=O=>Object.freeze(Object.defineProperty({__proto__:null,default:O},Symbol.toStringTag,{value:"Module"}));var P;u=P=function(O){function L(c){c=O.call(this,c)||this;c._activeFetchInfo={id:null,request:null};c.layer=null;c.template=null;c.thumbnail=
null;return c}n._inheritsLoose(L,O);var g=L.prototype;g.initialize=function(){this.handles.add(h.watch(()=>{const {layer:c}=this;return[c&&"renderer"in c?c.renderer:null,this.template]},()=>{this._activeFetchInfo.id=null;this._activeFetchInfo.request=null;this._set("thumbnail",null)},h.initial))};g.clone=function(){const c=E.isSome(this.thumbnail)?this.thumbnail.cloneNode(!0):null,a=new P({layer:this.layer,template:this.template});a._set("thumbnail",c);return a};L.fetchThumbnail=function(){var c=
n._asyncToGenerator(function*(a,v){const Q=yield p(a,v);if(E.isNone(Q))return null;const D={maxSize:36};"dictionary"===a.renderer?.type&&(D.fieldMap=a.renderer.fieldMap??void 0,D.feature={attributes:v.prototype.attributes??{}});return yield l.renderPreviewHTML(Q,D)});return function(a,v){return c.apply(this,arguments)}}();n._createClass(L,[{key:"description",get:function(){return this.template?.description},set:function(c){this.template&&(this.template.description=c)}},{key:"label",get:function(){return this.template?.name},
set:function(c){this.template&&(this.template.name=c)}},{key:"id",get:function(){return`${this.label??""}\u2013${this.layer?.id}`}}]);return L}(K.HandleOwnerMixin(u));e.__decorate([t.property()],u.prototype,"description",null);e.__decorate([t.property()],u.prototype,"label",null);e.__decorate([t.property()],u.prototype,"layer",void 0);e.__decorate([t.property()],u.prototype,"template",void 0);e.__decorate([t.property({readOnly:!0})],u.prototype,"thumbnail",void 0);e.__decorate([t.property()],u.prototype,
"id",null);return u=P=e.__decorate([r.subclass("esri.widgets.FeatureTemplates.TemplateItem")],u)})},"esri/symbols/support/symbolUtils":function(){define("require exports ../../chunks/_rollupPluginBabelHelpers ../../core/has ../../core/maybe ../../support/arcadeOnDemand ./gfxUtils ./previewUtils ./renderUtils ./utils ../../widgets/Legend/styles/support/relationshipUtils ../../widgets/Legend/support/relationshipRampUtils".split(" "),function(b,n,e,H,u,K,E,h,t,d,k,r){function l(L,g){if(g&&(L.style.filter=
d.getCSSFilterFromEffectList(g),g=g.effects))for(const c of g)if("drop-shadow"===c?.type){0>c.offsetX?L.style.marginLeft=`${Math.abs(c.offsetX)}px`:L.style.marginRight=`${c.offsetX}px`;break}}function p(L,g){return B.apply(this,arguments)}function B(){B=e._asyncToGenerator(function*(L,g){switch(L.type){case "web-style":var {previewWebStyleSymbol:c}=yield new Promise((a,v)=>b(["./previewWebStyleSymbol"],a,v));return c(L,p,g);case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return{previewSymbol3D:c}=
yield new Promise((a,v)=>b(["./previewSymbol3D"],a,v)),c(L,g);case "simple-marker":case "simple-line":case "simple-fill":case "picture-marker":case "picture-fill":case "text":return{previewSymbol2D:c}=yield new Promise((a,v)=>b(["./previewSymbol2D"],a,v)),c(L,g);case "cim":return{previewCIMSymbol:c}=yield new Promise((a,v)=>b(["./previewCIMSymbol"],a,v)),c(L,g)}});return B.apply(this,arguments)}function x(L){return L&&"opacity"in L?L.opacity*x(L.parent):1}function y(){y=e._asyncToGenerator(function*(L,
g){if(L){var c=L.sourceLayer,a=(u.isSome(g)&&(g.useSourceLayer??!1)?c:L.layer)??c;c=x(a);if(u.isSome(L.symbol)&&(!u.isSome(g)||!0!==g.ignoreGraphicSymbol))return L="web-style"===L.symbol.type?yield d.fetchWebStyleSymbol(L.symbol,{...g,cache:u.isSome(g)?g.webStyleCache:null}):L.symbol.clone(),d.applyColorToSymbol(L,null,c),L;var v=(u.isSome(g)?g.renderer:null)??(a&&"renderer"in a?a.renderer:null);if(a=v&&"getSymbolAsync"in v?yield v.getSymbolAsync(L,g):null){a="web-style"===a.type?yield a.fetchSymbol({...g,
cache:u.isSome(g)?g.webStyleCache:null}):a.clone();if(!(v&&"visualVariables"in v&&v.visualVariables&&v.visualVariables.length))return d.applyColorToSymbol(a,null,c),a;"arcadeRequiredForVisualVariables"in v&&v.arcadeRequiredForVisualVariables&&(u.isNone(g)||u.isNone(g.arcade))&&(g={...u.unwrap(g)},g.arcade=yield K.loadArcade());var Q=yield new Promise((N,F)=>b(["../../renderers/visualVariables/support/visualVariableUtils"],N,F)),D=[],f=[],A=[],J=[];for(var z of v.visualVariables)switch(z.type){case "color":D.push(z);
break;case "opacity":f.push(z);break;case "rotation":J.push(z);break;case "size":z.target||A.push(z)}z=(z=!!D.length&&D[D.length-1])?Q.getColor(z,L,g):null;f=(f=!!f.length&&f[f.length-1])?Q.getOpacity(f,L,g):null;null!=c&&(f=null!=f?f*c:c);d.applyColorToSymbol(a,z,f);A.length&&(c=Q.getAllSizes(A,L,g),yield d.applySizesToSymbol(a,c));for(const N of J)d.applyRotationToSymbol(a,Q.getRotationAngle(N,L,g),N.axis);return a}}});return y.apply(this,arguments)}function G(){G=e._asyncToGenerator(function*(L,
g){if(L){var c=x(L.layer||L.sourceLayer);if(u.isSome(L.symbol)&&(!u.isSome(g)||!0!==g.ignoreGraphicSymbol))return L="web-style"===L.symbol.type?yield d.fetchWebStyleSymbol(L.symbol,g):L.symbol.clone(),d.getColorFromSymbol(L,c);var a=u.isSome(g)&&g.renderer||L.get("layer.renderer")||L.get("sourceLayer.renderer"),v=yield a.getSymbolAsync(L,g);if(v){v="web-style"===v.type?yield d.fetchWebStyleSymbol(v,g):v.clone();var Q=d.getColorFromSymbol(v,c);if(!("visualVariables"in a)||"visualVariables"in a&&!a.visualVariables||
"visualVariables"in a&&!a.visualVariables?.length)return Q;a.arcadeRequiredForVisualVariables&&(u.isNone(g)||u.isNone(g.arcade))&&(g={...u.unwrap(g)},g.arcade=yield K.loadArcade());v=yield new Promise((A,J)=>b(["../../renderers/visualVariables/support/visualVariableUtils"],A,J));var D=[],f=[];for(const A of a.visualVariables)switch(A.type){case "color":D.push(A);break;case "opacity":f.push(A)}a=(a=0<D.length?D[D.length-1]:null)?v.getColor(a,L,g):Q;L=(Q=0<f.length?f[f.length-1]:null)?v.getOpacity(Q,
L,g):null;null!=c&&(L=null!=L?L*c:c);return a?d.applyOpacityToColor(a,L):null}}});return G.apply(this,arguments)}let P=null;const O=[255,255,255];n.getDisplayedColor=function(L,g){return G.apply(this,arguments)};n.getDisplayedSymbol=function(L,g){return y.apply(this,arguments)};n.renderColorRampPreviewHTML=function(L,g={}){var c="horizontal"===g.align;const {width:a=c?75:24,height:v=c?24:75,gradient:Q=!0}=g;var D=window.devicePixelRatio,f=a*D,A=v*D;D=document.createElement("canvas");D.width=f;D.height=
A;D.style.width=`${a}px`;D.style.height=`${v}px`;const J=D.getContext("2d");var z=c?f:0,N=c?0:A;if(Q){const F=J.createLinearGradient(0,0,z,N);c=L.length;const R=1===c?0:1/(c-1);L.forEach((m,C)=>F.addColorStop(C*R,m.toString()));J.fillStyle=F;J.fillRect(0,0,f,A)}else{f=c?f/L.length:f;A=c?A:A/L.length;N=z=0;for(const F of L)J.fillStyle=F.toString(),J.fillRect(z,N,f,A),z=c?z+f:0,N=c?0:N+A}L=document.createElement("div");L.style.width=`${a}px`;L.style.height=`${v}px`;l(L,g?.effectList);L.appendChild(D);
return L};n.renderDotDensityPreviewHTML=function(L,g,c){const {backgroundColor:a,outline:v,dotSize:Q}=L;c=c&&c.swatchSize||h.SymbolSizeDefaults.size;const D=Math.round(c*c/Q**2*.8),f=window.devicePixelRatio;L=document.createElement("canvas");const A=c*f;L.width=A;L.height=A;L.style.width=`${L.width/f}px`;L.style.height=`${L.height/f}px`;const J=L.getContext("2d");a&&(J.fillStyle=a.toCss(!0),J.fillRect(0,0,A,A),J.fill());J.fillStyle=g.toCss(!0);if(P&&P.length/2===D)for(g=0;g<2*D;g+=2)J.fillRect(P[g],
P[g+1],Q*f,Q*f),J.fill();else for(P=[],g=0;g<2*D;g+=2){const z=Math.floor(Math.random()*(A-0+1)),N=Math.floor(Math.random()*(A-0+1));P.push(z,N);J.fillRect(z,N,Q*f,Q*f);J.fill()}v&&(v.color&&(J.strokeStyle=v.color.toCss(!0)),J.lineWidth=v.width,J.strokeRect(0,0,A,A));c=new Image(c,c);c.src=L.toDataURL();return c};n.renderPieChartPreviewHTML=function(L,g={}){const c=g.radius||40;var a=2*Math.PI*c,v=L.length;const Q=a/v,D=[],f=E.getStroke(g.outline);null!=f?.width&&(f.width*=2);(f||g.backgroundColor)&&
D.push({shape:{type:"circle",cx:c,cy:c,r:c},fill:g.backgroundColor,stroke:f,offset:[0,0]});const A=g.values,J=A&&A.length===v&&100===A.reduce((N,F)=>N+F,0),z=[0];for(let N=0;N<v;N++){let F=null;J&&(F=A[N]*a/100,z.push(F+z[N]));D.push({shape:{type:"circle",cx:c,cy:c,r:c/2},fill:[0,0,0,0],stroke:{width:c,dashArray:`${(F??Q)/2} ${a}`,dashoffset:`-${J?z[N]/2:Q/2*N}`,color:L[N]},offset:[0,0]})}v=null;L=2*c+(f?.width||0);if(a=g.holePercentage)f&&D.push({shape:{type:"circle",cx:c,cy:c,r:c*a},fill:null,stroke:f,
offset:[0,0]}),v=L/2,v=[[{shape:{type:"circle",cx:v,cy:v,r:v},fill:O,stroke:f?{...f,color:O}:null,offset:[0,0]},{shape:{type:"circle",cx:v,cy:v,r:c*a},fill:[0,0,0],stroke:null,offset:[0,0]}]];return t.renderSymbol([D],[L,L],{effectView:g.effectList,ignoreStrokeWidth:!0,masking:v,rotation:-90})};n.renderPreviewHTML=p;n.renderRelationshipRampPreviewHTML=function(L,g={}){const c=L?.authoringInfo;if("relationship"!==c?.type||!c?.numClasses||!L.uniqueValueInfos)return null;const {focus:a,numClasses:v}=
c,Q=r.getRelationshipRampElement({focus:a,numClasses:v,infos:L.uniqueValueInfos});L=g&&g.node||document.createElement("div");t.renderOnce(L,()=>k.renderRelationshipRamp(Q,g.id||"relationship",g.opacity||1,g.effectList));return L};Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/gfxUtils":function(){define("exports ../../assets ../../Color ../../request ../../core/ItemCache ../../core/screenUtils ./cimSymbolUtils".split(" "),function(b,n,e,H,u,K,E){function h(k){if(!k)return null;
let r=null;switch(k.type){case "simple-fill":case "picture-fill":case "simple-marker":r=h(k.outline);break;case "simple-line":const l=K.pt2px(k.width);null!=k.style&&"none"!==k.style&&0!==l&&(r={color:k.color,style:d(k.style),width:l,cap:k.cap,join:"miter"===k.join?K.pt2px(k.miterLimit):k.join});break;default:r=null}return r}const t=new u(1E3),d=(()=>{const k={};return r=>{if(k[r])return k[r];const l=r.replace(/-/g,"");return k[r]=l}})();e=new e([128,128,128]);b.defaultThematicColor=e;b.dekebabifyLineStyle=
d;b.getFill=function(k){const r=k.style;let l=null;if(k)switch(k.type){case "simple-marker":"cross"!==r&&"x"!==r&&(l=k.color);break;case "simple-fill":"solid"===r?l=k.color:"none"!==r&&(l={type:"pattern",x:0,y:0,src:n.getAssetUrl(`esri/symbols/patterns/${r}.png`),width:5,height:5});break;case "picture-fill":l={type:"pattern",src:k.url,width:K.pt2px(k.width)*k.xscale,height:K.pt2px(k.height)*k.yscale,x:K.pt2px(k.xoffset),y:K.pt2px(k.yoffset)};break;case "text":l=k.color;break;case "cim":l=E.getCIMSymbolColor(k)}return l};
b.getPatternUrlWithColor=function(k,r){const l=k+"-"+r;return void 0!==t.get(l)?Promise.resolve(t.get(l)):H(k,{responseType:"image"}).then(p=>{p=p.data;const B=p.naturalWidth,x=p.naturalHeight,y=document.createElement("canvas");y.width=B;y.height=x;const G=y.getContext("2d");G.fillStyle=r;G.fillRect(0,0,B,x);G.globalCompositeOperation="destination-in";G.drawImage(p,0,0);p=y.toDataURL();t.put(l,p);return p})};b.getStroke=h;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/ItemCache":function(){define(["./MemCache"],
function(b){return function(){function n(H,u){this._storage=new b.MemCacheStorage;this._storage.maxSize=H;u&&this._storage.registerRemoveFunc("",u)}var e=n.prototype;e.put=function(H,u){this._storage.put(H,u,1,1)};e.pop=function(H){return this._storage.pop(H)};e.get=function(H){return this._storage.get(H)};e.clear=function(){this._storage.clearAll()};e.destroy=function(){this._storage.destroy()};return n}()})},"esri/symbols/support/cimSymbolUtils":function(){define(["exports","../../Color","../cim/utils"],
function(b,n,e){function H(r){r=e.toCIMSymbolJSON(r);if("CIMTextSymbol"===r?.type)return r.height??0;let l=0;if(r?.symbolLayers)for(const p of r.symbolLayers)e.isCIMMarker(p)&&null!=p.size&&p.size>l?l=p.size:e.isCIMStroke(p)&&null!=p.width&&p.width>l?l=p.width:e.isCIMFill(p);return l}function u(r,l,p,B){if(r)if("CIMTextSymbol"===r.type)null!=r.height&&(r.height*=l);else{if(p&&r.effects)for(const x of r.effects)h(x,l);if(r.symbolLayers)for(const x of r.symbolLayers)switch(x.type){case "CIMPictureMarker":case "CIMVectorMarker":K(x,
l,B);break;case "CIMPictureStroke":case "CIMSolidStroke":!B?.preserveOutlineWidth&&x.width&&(x.width*=l);break;case "CIMPictureFill":x.height&&(x.height*=l);x.offsetX&&(x.offsetX*=l);x.offsetY&&(x.offsetY*=l);break;case "CIMHatchFill":u(x.lineSymbol,l,!0,{...B,preserveOutlineWidth:!1}),x.offsetX&&(x.offsetX*=l),x.offsetY&&(x.offsetY*=l),x.separation&&(x.separation*=l)}}}function K(r,l,p){if(r&&(r.markerPlacement&&E(r.markerPlacement,l),r.offsetX&&(r.offsetX*=l),r.offsetY&&(r.offsetY*=l),r.anchorPoint&&
"Absolute"===r.anchorPointUnits&&(r.anchorPoint={x:r.anchorPoint.x*l,y:r.anchorPoint.y*l}),r.size=null!=r.size?r.size*l:0,"CIMVectorMarker"===r.type&&r.markerGraphics))for(const B of r.markerGraphics)r.scaleSymbolsProportionally||u(B.symbol,l,!0,p)}function E(r,l){e.isCIMMarkerStrokePlacement(r)&&r.offset&&(r.offset*=l);switch(r.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":r.customEndingOffset&&(r.customEndingOffset*=l);r.offsetAlongLine&&(r.offsetAlongLine*=
l);if(r.placementTemplate&&r.placementTemplate.length){var p=r.placementTemplate.map(B=>B*l);r.placementTemplate=p}break;case "CIMMarkerPlacementAlongLineVariableSize":r.maxRandomOffset&&(r.maxRandomOffset*=l);r.placementTemplate&&r.placementTemplate.length&&(p=r.placementTemplate.map(B=>B*l),r.placementTemplate=p);break;case "CIMMarkerPlacementOnLine":r.startPointOffset&&(r.startPointOffset*=l);break;case "CIMMarkerPlacementAtExtremities":r.offsetAlongLine&&(r.offsetAlongLine*=l);break;case "CIMMarkerPlacementAtRatioPositions":r.beginPosition&&
(r.beginPosition*=l);r.endPosition&&(r.endPosition*=l);break;case "CIMMarkerPlacementPolygonCenter":r.offsetX&&(r.offsetX*=l);r.offsetY&&(r.offsetY*=l);break;case "CIMMarkerPlacementInsidePolygon":r.offsetX&&(r.offsetX*=l),r.offsetY&&(r.offsetY*=l),r.stepX&&(r.stepX*=l),r.stepY&&(r.stepY*=l)}}function h(r,l){switch(r.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":r.width&&(r.width*=l);break;case "CIMGeometricEffectBuffer":r.size&&(r.size*=l);break;case "CIMGeometricEffectCut":r.beginCut&&
(r.beginCut*=l);r.endCut&&(r.endCut*=l);r.middleCut&&(r.middleCut*=l);break;case "CIMGeometricEffectDashes":r.customEndingOffset&&(r.customEndingOffset*=l);r.offsetAlongLine&&(r.offsetAlongLine*=l);if(r.dashTemplate&&r.dashTemplate.length){const p=r.dashTemplate.map(B=>B*l);r.dashTemplate=p}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":r.length&&(r.length*=l);break;case "CIMGeometricEffectMove":r.offsetX&&(r.offsetX*=l);r.offsetY&&(r.offsetY*=
l);break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":r.offset&&(r.offset*=l);break;case "CIMGeometricEffectRegularPolygon":r.radius&&(r.radius*=l);break;case "CIMGeometricEffectTaperedPolygon":r.fromWidth&&(r.fromWidth*=l);r.length&&(r.length*=l);r.toWidth&&(r.toWidth*=l);break;case "CIMGeometricEffectWave":r.amplitude&&(r.amplitude*=l),r.period&&(r.period*=l)}}function t(r,l){if(r){var p="CIMTextSymbol"===r.type?r.symbol:r;r="CIMPolygonSymbol"===r.type;if(p?.symbolLayers)for(const B of p.symbolLayers)if(!(B.colorLocked||
r&&(e.isCIMStroke(B)||e.isCIMMarker(B)&&B.markerPlacement&&e.isCIMMarkerStrokePlacement(B.markerPlacement))))switch(B.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":B.tintColor&&d(l,B.tintColor);break;case "CIMVectorMarker":B.markerGraphics?.forEach(x=>{t(x.symbol,l)});break;case "CIMSolidStroke":case "CIMSolidFill":d(l,B.color);break;case "CIMHatchFill":t(B.lineSymbol,l)}}}function d(r,l){for(const p of r)if(p.join(".")===l.join("."))return;r.push(l)}function k(r,l,p){if(r){var B=
"CIMTextSymbol"===r.type?r.symbol:r;r="CIMPolygonSymbol"===B?.type;if(B?.symbolLayers)for(const x of B.symbolLayers)if(!x.colorLocked){if(r)if(p){if({layersToColor:B}=p,(e.isCIMStroke(x)||e.isCIMMarker(x)&&x.markerPlacement&&e.isCIMMarkerStrokePlacement(x.markerPlacement))&&"fill"===B||e.isCIMFill(x)&&"outline"===B)continue}else if(e.isCIMStroke(x)||e.isCIMMarker(x)&&x.markerPlacement&&e.isCIMMarkerStrokePlacement(x.markerPlacement))continue;B=l.toArray();switch(x.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":x.tintColor=
B;break;case "CIMVectorMarker":x.markerGraphics?.forEach(y=>{k(y.symbol,l,p)});break;case "CIMSolidStroke":case "CIMSolidFill":x.color=B;break;case "CIMHatchFill":k(x.lineSymbol,l,p)}}}}b.applyCIMSymbolColor=function(r,l,p){l instanceof n||(l=new n(l));(r=e.toCIMSymbolJSON(r))&&k(r,l,p)};b.applyCIMSymbolRotation=function(r,l,p=!1){r=e.toCIMSymbolJSON(r);p&&0!==l&&(l=360-l);if("CIMTextSymbol"===r?.type)r.angle=l;else if("CIMPointSymbol"===r?.type&&r.symbolLayers){p=l-(r.angle||0);for(const B of r.symbolLayers)if(e.isCIMMarker(B)){let x=
B.rotation||0;x=B.rotateClockwise?x-p:x+p;B.rotation=x}r.angle=l}};b.getCIMSymbolColor=function(r){r=e.toCIMSymbolJSON(r);const l=[];t(r,l);return l.length?new n(e.fromCIMColor(l[0])):null};b.getCIMSymbolRotation=function(r,l=!1){r=e.toCIMSymbolJSON(r);return"CIMTextSymbol"===r?.type||"CIMPointSymbol"===r?.type?(r=r.angle,null!=r&&0!==r&&l?360-r:r??0):0};b.getCIMSymbolSize=H;b.getCIMSymbolType=function(r){r=e.toCIMSymbolJSON(r);if(!r)return null;switch(r.type){case "CIMPointSymbol":return"CIMPointSymbol";
case "CIMLineSymbol":return"CIMLineSymbol";case "CIMPolygonSymbol":return"CIMPolygonSymbol";case "CIMTextSymbol":return"CIMTextSymbol";case "CIMMeshSymbol":return"CIMMeshSymbol";default:return null}};b.scaleCIMMarker=K;b.scaleCIMSymbol=u;b.scaleCIMSymbolTo=function(r,l,p){if(r){var B=e.toCIMSymbolJSON(r);r=H(r);if(0===r){if(B)if("CIMTextSymbol"===B.type)B.height=l;else if(B.symbolLayers)for(const x of B.symbolLayers)switch(x.type){case "CIMPictureMarker":case "CIMVectorMarker":x.size=l;break;case "CIMPictureStroke":case "CIMSolidStroke":x.width=
l}}else u(B,l/r,!1,p)}};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/utils":function(){define(["require","exports"],function(b,n){function e(k){let r=k.length;for(;r--;)if(!" /-,\n".includes(k.charAt(r)))return!1;return!0}function H(k,r){const l=[];var p=0;let B=-1;do B=k.indexOf("[",p),B>=p&&(B>p&&(p=k.substr(p,B-p),l.push([p,null,e(p)])),p=B+1,B=k.indexOf("]",p),B>=p&&(B>p&&(p=k.substr(p,B-p),(p=r[p])&&l.push([null,p,!1])),p=B+1));while(-1!==B);p<k.length-1&&
(k=k.substr(p),l.push([k,null,e(k)]));return l}function u(k,r,l){let p="",B=null;for(const x of r){const [y,G,P]=x;if(y)P?B=y:(B&&(p+=B,B=null),p+=y);else if(r=k.attributes[G])B&&(p+=B,B=null),p+=r}return K(p,l)}function K(k,r){"string"!==typeof k&&(k=String(k));switch(r){case "LowerCase":return k.toLowerCase();case "Allcaps":return k.toUpperCase();default:return k}}function E(k){return k?{r:k[0],g:k[1],b:k[2],a:k[3]/255}:{r:0,g:0,b:0,a:0}}function h(k){if(!k)return null;switch(k.type){case "CIMPolygonSymbol":if(k.symbolLayers)for(const r of k.symbolLayers)if(k=
h(r),null!=k)return k;break;case "CIMTextSymbol":return h(k.symbol);case "CIMSolidFill":return k.color}}function t(k){if(k)switch(k.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(k=k.symbolLayers)for(const r of k)if(k=t(r),null!=k)return k;break;case "CIMTextSymbol":return t(k.symbol);case "CIMSolidStroke":case "CIMSolidFill":return k.color}}function d(k){if(k)switch(k.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(k.symbolLayers)for(const r of k.symbolLayers)if(k=d(r),void 0!==k)return k;
break;case "CIMTextSymbol":return d(k.symbol);case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return k.width}}n.adjustTextCase=K;n.analyzeTextParts=H;n.assignTextValuesFromFeature=u;n.attributesToFields=function(k){return(k?Object.keys(k):[]).map(r=>({name:r,alias:r,type:"string"===typeof k[r]?"esriFieldTypeString":"esriFieldTypeDouble"}))};n.colorToArray=function(k){return[k.r,k.g,k.b,k.a]};n.createLabelOverrideFunction=function(k,r,l){const p=H(r,k);return B=>u(B,p,l)};n.evaluateValueOrFunction=
function(k,r,l,p){return"function"===typeof k?k(r,l,p):k};n.fromCIMColor=E;n.fromCIMFontDecoration=function(k){return k.underline?"underline":k.strikethrough?"line-through":"none"};n.fromCIMFontStyle=function(k){let r="",l="";k&&(k=k.toLowerCase(),k.includes("italic")?r="italic":k.includes("oblique")&&(r="oblique"),k.includes("bold")?l="bold":k.includes("light")&&(l="lighter"));return{style:r,weight:l}};n.fromCIMHorizontalAlignment=function(k){switch(k){default:return"left";case "Right":return"right";
case "Center":return"center";case "Justify":return"center"}};n.fromCIMVerticalAlignment=function(k){switch(k){default:return"top";case "Center":return"middle";case "Baseline":return"baseline";case "Bottom":return"bottom"}};n.getFillColor=h;n.getFontStyle=function(k){if(!k)return"normal";switch(k.toLowerCase()){case "italic":return"italic";case "oblique":return"oblique";default:return"normal"}};n.getFontWeight=function(k){if(!k)return"normal";switch(k.toLowerCase()){case "bold":return"bold";case "bolder":return"bolder";
case "lighter":return"lighter";default:return"normal"}};n.getStrokeColor=t;n.getStrokeWidth=d;n.getTintColor=k=>k.tintColor?E(k.tintColor):{r:255,g:255,b:255,a:1};n.getValue=(k,r=0)=>null==k||isNaN(k)?r:k;n.importGeometryEngine=function(){return new Promise((k,r)=>b(["../../geometry/geometryEngineJSON"],k,r))};n.isCIMFill=function(k){return null!=k&&("CIMGradientFill"===k.type||"CIMHatchFill"===k.type||"CIMPictureFill"===k.type||"CIMSolidFill"===k.type||"CIMWaterFill"===k.type)};n.isCIMMarker=function(k){return"CIMVectorMarker"===
k.type||"CIMPictureMarker"===k.type||"CIMBarChartMarker"===k.type||"CIMCharacterMarker"===k.type||"CIMPieChartMarker"===k.type||"CIMStackedBarChartMarker"===k.type};n.isCIMMarkerStrokePlacement=function(k){return null!=k&&("CIMMarkerPlacementAlongLineRandomSize"===k.type||"CIMMarkerPlacementAlongLineSameSize"===k.type||"CIMMarkerPlacementAlongLineVariableSize"===k.type||"CIMMarkerPlacementAtExtremities"===k.type||"CIMMarkerPlacementAtMeasuredUnits"===k.type||"CIMMarkerPlacementAtRatioPositions"===
k.type||"CIMMarkerPlacementOnLine"===k.type||"CIMMarkerPlacementOnVertices"===k.type)};n.isCIMStroke=function(k){return"CIMGradientStroke"===k.type||"CIMPictureStroke"===k.type||"CIMSolidStroke"===k.type};n.isGeometryEngineRequired=k=>{if(!k)return!1;for(const r of k)switch(r.type){case "CIMGeometricEffectBuffer":case "CIMGeometricEffectOffset":case "CIMGeometricEffectDonut":return!0}return!1};n.isSVGImage=k=>k.includes("data:image/svg+xml");n.mapCIMSymbolToGeometryType=function(k){if(!k)return null;
switch(k.type){case "CIMPointSymbol":case "CIMTextSymbol":return"esriGeometryPoint";case "CIMLineSymbol":return"esriGeometryPolyline";case "CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}};n.resampleHermite=function(k,r,l,p,B,x,y=!0){const G=r/B;l/=x;const P=Math.ceil(G/2),O=Math.ceil(l/2);for(let c=0;c<x;c++)for(let a=0;a<B;a++){const v=4*(a+(y?x-c-1:c)*B);var L=0;let Q=0,D=0,f=0,A=0,J=0,z=0;const N=(c+.5)*l;for(let F=Math.floor(c*l);F<(c+1)*l;F++){var g=Math.abs(N-(F+.5))/O;const R=
(a+.5)*G;g*=g;for(let m=Math.floor(a*G);m<(a+1)*G;m++){let C=Math.abs(R-(m+.5))/P;L=Math.sqrt(g+C*C);-1<=L&&1>=L&&(L=2*L*L*L-3*L*L+1,0<L&&(C=4*(m+F*r),z+=L*k[C+3],D+=L,255>k[C+3]&&(L=L*k[C+3]/250),f+=L*k[C],A+=L*k[C+1],J+=L*k[C+2],Q+=L))}}p[v]=f/Q;p[v+1]=A/Q;p[v+2]=J/Q;p[v+3]=z/D}};n.toCIMSymbolJSON=function(k){return k.data?.symbol??null};Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/previewUtils":function(){define(["exports","../../Color"],function(b,n){function e(H,
u){return Math.round(Math.min(Math.max(H+191.25*u,0),255))}b.SymbolSizeDefaults=void 0;(function(H){H[H.size=22]="size";H[H.lineWidth=50]="lineWidth";H[H.maxSize=120]="maxSize";H[H.maxOutlineSize=80]="maxOutlineSize";H[H.tallSymbolWidth=20]="tallSymbolWidth"})(b.SymbolSizeDefaults||(b.SymbolSizeDefaults={}));b.adjustColorBrightness=function(H,u){if(null==H)return new n;if("type"in H&&("linear"===H.type||"pattern"===H.type))return H;H=new n(H);return new n([e(H.r,u),e(H.g,u),e(H.b,u),H.a])};b.adjustColorComponentBrightness=
e;b.getConeShapes=function(H,u){let K=u?b.SymbolSizeDefaults.tallSymbolWidth:H;u=u?4:6;K=K<=b.SymbolSizeDefaults.size?K-.5*u:K-u;u=.15*K;const E=K;H-=u;return[{type:"ellipse",cx:.5*K,cy:H,rx:.5*K,ry:u},{type:"path",path:[{command:"M",values:[.5*E,0]},{command:"L",values:[E,H]},{command:"L",values:[0,H]},{command:"Z",values:[]}]}]};b.getCubeShapes=function(H,u){let K=u?b.SymbolSizeDefaults.tallSymbolWidth:H;var E=u?4:6;E=K=K<=b.SymbolSizeDefaults.size?K-.5*E:K-E;u=u?.35*K:.5*K;return[{type:"path",
path:[{command:"M",values:[.5*E,0]},{command:"L",values:[E,.5*u]},{command:"L",values:[.5*E,u]},{command:"L",values:[0,.5*u]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*u]},{command:"L",values:[.5*E,u]},{command:"L",values:[.5*E,H]},{command:"L",values:[0,H-.5*u]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*E,u]},{command:"L",values:[.5*E,H]},{command:"L",values:[E,H-.5*u]},{command:"L",values:[E,.5*u]},{command:"Z",values:[]}]}]};b.getCylinderShapes=
function(H,u){var K=u?b.SymbolSizeDefaults.tallSymbolWidth:H;u=u?4:6;K=K<=b.SymbolSizeDefaults.size?K-.5*u:K-u;u=.5*K;const E=.15*K;H-=E;return[{type:"ellipse",cx:.5*K,cy:H,rx:u,ry:E},{type:"path",path:[{command:"M",values:[0,E]},{command:"L",values:[0,H]},{command:"L",values:[K,H]},{command:"L",values:[K,E]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*K,cy:E,rx:u,ry:E}]};b.getDiamondShapes=function(H){var u=H;u=u<b.SymbolSizeDefaults.size?u-2:u-4;const K=Math.floor(H/10)-1||1;return[{type:"path",
path:[{command:"M",values:[.45*u,0]},{command:"L",values:[u,.5*H-K]},{command:"L",values:[.45*u-K,.5*H+K]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*u,0]},{command:"L",values:[.45*u-K,.5*H+K]},{command:"L",values:[0,.5*H-K]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*H-K]},{command:"L",values:[.45*u-K,.5*H+K]},{command:"L",values:[.45*u,H]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*u,H]},{command:"L",values:[u,.5*
H-K]},{command:"L",values:[.45*u-K,.5*H+K]},{command:"Z",values:[]}]}]};b.getExtrudeSymbolShapes=function(H){const u=b.SymbolSizeDefaults.size;H*=.5;return[{type:"path",path:[{command:"M",values:[0,.35*u]},{command:"L",values:[.3*u,.7*u]},{command:"L",values:[.3*u,.7*u+H]},{command:"L",values:[0,.7*u+H-.35*u]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*u,.7*u]},{command:"L",values:[.3*u,.7*u+H]},{command:"L",values:[u,H]},{command:"L",values:[u,0]},{command:"Z",values:[]}]},
{type:"path",path:[{command:"M",values:[.3*u,0]},{command:"L",values:[u,0]},{command:"L",values:[.3*u,.7*u]},{command:"L",values:[0,.35*u]},{command:"Z",values:[]}]}]};b.getInvertedConeShapes=function(H){let u=H;u=u<b.SymbolSizeDefaults.size?u-3:u-6;const K=.15*u,E=u;return[{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[E,0]},{command:"L",values:[.5*E,H-K]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*u,cy:0,rx:.5*u,ry:K}]};b.getPathSymbolShapes=function(H,u,K){var E=b.SymbolSizeDefaults.size;
let h=E,t=E;1>H?h*=.75:1<H&&(t*=1.25);H=E;u&&K&&(h=t=H=E=0);return[{type:"path",path:[{command:"M",values:[H,0]},{command:"L",values:[K?H:.875*H,0]},{command:"L",values:[K?h-.5*H:0,t-.5*E]},{command:"L",values:[h-.5*H,t-.5*E]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[H,0]},{command:"L",values:[H,u?0:.125*E]},{command:"L",values:[h-.5*H,u?t-.5*E:E]},{command:"L",values:[h-.5*H,t-.5*E]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[h-.5*H,t-.5*E]},{command:"L",
values:[K?h-.5*H:0,t-.5*E]},{command:"L",values:[K?h-.5*H:0,u?t-.5*E:E]},{command:"L",values:[h-.5*H,u?t-.5*E:E]},{command:"Z",values:[]}]}]};b.getTetrahedronShapes=function(H){var u=H;u=u<b.SymbolSizeDefaults.size?u-1:u-2;return[{type:"path",path:[{command:"M",values:[.45*H,0]},{command:"L",values:[H,u]},{command:"L",values:[.45*H,.6*u]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*H,0]},{command:"L",values:[.45*H,.6*u]},{command:"L",values:[0,u]},{command:"Z",values:[]}]},
{type:"path",path:[{command:"M",values:[0,u]},{command:"L",values:[.45*H,.6*u]},{command:"L",values:[H,u]},{command:"Z",values:[]}]}]};b.getWaterSymbolShapes=function(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},{type:"path",
path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},
{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]};
b.shapes={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],squareFill:[{type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],
cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],
tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",
path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/renderUtils":function(){define("exports ../../kernel ../../request ../../core/colorUtils ../../core/Error ../../core/has ../../libs/maquette/projection ../../libs/maquette/projector ./svgUtils ./utils".split(" "),
function(b,n,e,H,u,K,E,h,t,d){function k(p,B){l.append(p,B);l.detach(B)}function r(p,B,x){return p?e(p,{responseType:"image"}).then(y=>{y=y.data;const G=y.width,P=y.height,O=G/P;let L=B;x&&(L=Math.min(L,Math.max(G,P)));return{image:y,width:1>=O?Math.ceil(L*O):L,height:1>=O?L:Math.ceil(L/O)}}):Promise.reject(new u("renderUtils: imageDataSize","href not provided."))}const l=h.createProjector();b.renderOnce=k;b.renderSymbol=function(p,B,x){const y=Math.ceil(B[0]),G=Math.ceil(B[1]);if(!p.some(P=>!!P.length))return null;
B=x&&x.node||document.createElement("div");null!=x.opacity&&(B.style.opacity=x.opacity.toString());null!=x.effectView&&(B.style.filter=d.getCSSFilterFromEffectList(x.effectView));k(B,()=>t.renderSVG(p,y,G,x));return B};b.tintImageWithColor=function(p,B,x,y,G){return r(p,B,G).then(P=>{const O=P.width?P.width:B,L=P.height?P.height:B;var g;if(g=P.image)g=x&&"ignore"!==y?"multiply"===y&&255===x.r&&255===x.g&&255===x.b&&1===x.a?!1:!0:!1;if(g){var c=P.image.width,a=P.image.height;K("edge")&&/\.svg$/i.test(p)&&
(--c,--a);g=Math.ceil(O);var v=Math.ceil(L);var Q=document.createElement("canvas");Q.width=g;Q.height=v;Q.style.width=g+"px";Q.style.height=v+"px";Q=Q.getContext("2d");Q.clearRect(0,0,g,v);g=Q;g.drawImage(P.image,0,0,c,a,0,0,O,L);v=g.getImageData(0,0,O,L);Q=[x.r/255,x.g/255,x.b/255,x.a];const f=H.toHSV(x);for(let A=0;A<v.data.length;A+=4){P=v.data;c=A;a=Q;var D=f;switch(y){case "multiply":P[c+0]*=a[0];P[c+1]*=a[1];P[c+2]*=a[2];P[c+3]*=a[3];break;default:const J=H.toHSV({r:P[c+0],g:P[c+1],b:P[c+2]});
J.h=D.h;J.s=D.s;J.v=J.v/100*D.v;D=H.toRGB(J);P[c+0]=D.r;P[c+1]=D.g;P[c+2]=D.b;P[c+3]*=a[3]}}g.putImageData(v,0,0);p=g.canvas.toDataURL("image/png")}else(g=n.id&&n.id.findCredential(p))&&g.token&&(P=p.includes("?")?"\x26":"?",p=`${p}${P}token=${g.token}`);return{url:p,width:O,height:L}}).catch(()=>({url:p,width:B,height:B}))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/colorUtils":function(){define(["exports"],function(b){function n(d,k){const r=[];let l,p;if(d[0].length!==
k.length)throw Error("dimensions do not match");const B=d.length,x=d[0].length;let y=0;for(l=0;l<B;l++){for(p=y=0;p<x;p++)y+=d[l][p]*k[p];r.push(y)}return r}function e(d){d=[d.r/255,d.g/255,d.b/255].map(k=>.04045>=k?k/12.92:((k+.055)/1.055)**2.4);d=n(h,d);return{x:100*d[0],y:100*d[1],z:100*d[2]}}function H(d){d=n(t,[d.x/100,d.y/100,d.z/100]).map(k=>Math.min(1,Math.max(.0031308>=k?12.92*k:1.055*k**(1/2.4)-.055,0)));return{r:Math.round(255*d[0]),g:Math.round(255*d[1]),b:Math.round(255*d[2])}}function u(d){d=
[d.x/95.047,d.y/100,d.z/108.883].map(k=>k>(6/29)**3?k**(1/3):1/3*(29/6)**2*k+4/29);return{l:116*d[1]-16,a:500*(d[0]-d[1]),b:200*(d[1]-d[2])}}function K(d){const k=d.l;d=[(k+16)/116+d.a/500,(k+16)/116,(k+16)/116-d.b/200].map(r=>r>6/29?r**3:3*(6/29)**2*(r-4/29));return{x:95.047*d[0],y:100*d[1],z:108.883*d[2]}}function E(d){if("r"in d&&"g"in d&&"b"in d)return d;if("l"in d&&"c"in d&&"h"in d){var k=d.c,r=d.h;return H(K({l:d.l,a:k*Math.cos(r),b:k*Math.sin(r)}))}if("l"in d&&"a"in d&&"b"in d)return H(K(d));
if("x"in d&&"y"in d&&"z"in d)return H(d);if("h"in d&&"s"in d&&"v"in d){r=(d.h+360)%360/60;k=d.v/100*255;d=d.s/100*k;const l=d*(1-Math.abs(r%2-1));switch(Math.floor(r)){case 0:r={r:d,g:l,b:0};break;case 1:r={r:l,g:d,b:0};break;case 2:r={r:0,g:d,b:l};break;case 3:r={r:0,g:l,b:d};break;case 4:r={r:l,g:0,b:d};break;case 5:case 6:r={r:d,g:0,b:l};break;default:r={r:0,g:0,b:0}}r.r=Math.round(r.r+k-d);r.g=Math.round(r.g+k-d);r.b=Math.round(r.b+k-d);return r}return d}const h=[[.4124,.3576,.1805],[.2126,.7152,
.0722],[.0193,.1192,.9505]],t=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];b.darken=function(d,k){d=u(e(d));d.l*=1-k;return H(K(d))};b.toHSV=function(d){if("h"in d&&"s"in d&&"v"in d)return d;var k=E(d);d=k.r;const r=k.g,l=k.b;k=Math.max(d,r,l);const p=k-Math.min(d,r,l);d=0===p?0:k===d?(r-l)/p%6:k===r?(l-d)/p+2:(d-r)/p+4;0>d&&(d+=6);return{h:60*d,s:100*(0===p?0:p/k),v:100/255*k}};b.toLAB=function(d){return"l"in d&&"a"in d&&"b"in d?d:u(e(E(d)))};b.toLCH=function(d){if(!("l"in
d&&"c"in d&&"h"in d)){var k=u(e(E(d)));d=k.l;var r=k.a;const l=k.b;k=Math.sqrt(r*r+l*l);r=Math.atan2(l,r);r=0<r?r:r+2*Math.PI;d={l:d,c:k,h:r}}return d};b.toRGB=E;b.toXYZ=function(d){return"x"in d&&"y"in d&&"z"in d?d:e(E(d))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/svgUtils":function(){define("exports ../../Color ../../core/has ../../core/maybe ../../chunks/mat2df32 ../../chunks/mat2d ../../widgets/support/widgetUtils ../../widgets/support/jsxFactory".split(" "),
function(b,n,e,H,u,K,E,h){function t(m,C){m*=F/180;return Math.abs(C*Math.sin(m))+Math.abs(C*Math.cos(m))}function d(m){return m.map(C=>`${C.command} ${C.values.join(" ")}`).join(" ").trim()}function k(m,C,M,w){if(m){if("circle"===m.type)return h.tsx("circle",{fill:C,"fill-rule":"evenodd",stroke:M.color,"stroke-width":M.width,"stroke-linecap":M.cap,"stroke-linejoin":M.join,"stroke-dasharray":M.dashArray,"stroke-dashoffset":M.dashOffset,"stroke-miterlimit":"4",cx:m.cx,cy:m.cy,r:m.r});if("ellipse"===
m.type)return h.tsx("ellipse",{fill:C,"fill-rule":"evenodd",stroke:M.color,"stroke-width":M.width,"stroke-linecap":M.cap,"stroke-linejoin":M.join,"stroke-dasharray":M.dashArray,"stroke-miterlimit":"4",cx:m.cx,cy:m.cy,rx:m.rx,ry:m.ry});if("rect"===m.type)return h.tsx("rect",{fill:C,"fill-rule":"evenodd",stroke:M.color,"stroke-width":M.width,"stroke-linecap":M.cap,"stroke-linejoin":M.join,"stroke-dasharray":M.dashArray,"stroke-miterlimit":"4",x:m.x,y:m.y,width:m.width,height:m.height});if("image"===
m.type)return h.tsx("image",{href:m.src,x:m.x,y:m.y,width:m.width,height:m.height,preserveAspectRatio:"none"});if("path"===m.type)return m="string"!==typeof m.path?d(m.path):m.path,h.tsx("path",{fill:C,"fill-rule":"evenodd",stroke:M.color,"stroke-width":M.width,"stroke-linecap":M.cap,"stroke-linejoin":M.join,"stroke-dasharray":M.dashArray,"stroke-miterlimit":"4",d:m});if("text"===m.type)return H.assertIsSome(w),h.tsx("text",{"dominant-baseline":w.dominantBaseline,fill:C,"fill-rule":"evenodd",stroke:M.color,
"stroke-width":M.width,"stroke-linecap":M.cap,"stroke-linejoin":M.join,"stroke-dasharray":M.dashArray,"stroke-miterlimit":"4","text-anchor":w.align,"text-decoration":w.decoration,kerning:w.kerning,rotate:w.rotate,"text-rendering":D,"font-style":w.font.style,"font-variant":w.font.variant,"font-weight":w.font.weight,"font-size":w.font.size,"font-family":w.font.family,x:m.x,y:m.y},m.text)}return null}function r(m){const C={fill:"none",pattern:null,linearGradient:null};if(m)if("type"in m&&"pattern"===
m.type){var M=`patternId-${++v}`;C.fill=`url(#${M})`;C.pattern={id:M,x:m.x,y:m.y,width:m.width,height:m.height,image:{x:0,y:0,width:m.width,height:m.height,href:m.src}}}else"type"in m&&"linear"===m.type?(M=`linearGradientId-${++Q}`,C.fill=`url(#${M})`,C.linearGradient={id:M,x1:m.x1,y1:m.y1,x2:m.x2,y2:m.y2,stops:m.colors.map(w=>({offset:w.offset,color:w.color&&(new n(w.color)).toString()}))}):m&&(m=new n(m),C.fill=m.toString());return C}function l(m){const C={color:"none",width:1,cap:"butt",join:"4",
dashArray:"none",dashOffset:"0"};if(m&&(null!=m.width&&(C.width=m.width),m.cap&&(C.cap=m.cap),m.join&&(C.join=m.join.toString()),m.color&&(C.color=(new n(m.color)).toString()),m.dashArray&&(C.dashArray=m.dashArray),m.dashArray&&(C.dashOffset=m.dashoffset),m.style)){let M=null;m.style in N&&(M=N[m.style]);if(Array.isArray(M)){M=M.slice(0);const w=m.width??0;for(let U=0;U<M.length;++U)M[U]*=w;if("butt"!==m.cap){for(m=0;m<M.length;m+=2)M[m]-=w,1>M[m]&&(M[m]=1);for(m=1;m<M.length;m+=2)M[m]+=w}M=M.join(",")}C.dashArray=
M}return C}function p(m,C){const M={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};if(m){const w=m.alignBaseline;M.align=m.align;M.dominantBaseline="baseline"===w?"auto":"top"===w?"text-top":"bottom"===w?"hanging":w;M.decoration=m.decoration;M.kerning=m.kerning?"auto":"0";M.rotate=m.rotated?"90":"0";H.assertIsSome(C);M.font.style=C.style||"normal";M.font.variant=C.variant||"normal";M.font.weight=C.weight||"normal";M.font.size=
C.size&&C.size.toString()||"10pt";M.font.family=C.family||"serif"}return M}function B(m){const {pattern:C,linearGradient:M}=m;return C?h.tsx("pattern",{id:C.id,patternUnits:"userSpaceOnUse",x:C.x,y:C.y,width:C.width,height:C.height},h.tsx("image",{x:C.image.x,y:C.image.y,width:C.image.width,height:C.image.height,href:C.image.href})):M?(m=M.stops.map((w,U)=>h.tsx("stop",{key:`${U}-stop`,offset:w.offset,"stop-color":w.color})),h.tsx("linearGradient",{id:M.id,gradientUnits:"userSpaceOnUse",x1:M.x1,y1:M.y1,
x2:M.x2,y2:M.y2},m)):null}function x(m,C){if(!m)return null;const M=[];for(const w of m){const {shape:U,fill:T,stroke:S,font:Y}=w;m=r(T);const ha=l(S),ja="text"===U.type?p(U,Y):null;(m=k(U,m.fill,ha,ja))&&M.push(m)}return h.tsx("mask",{id:C,maskUnits:"userSpaceOnUse"},h.tsx("g",null,M))}function y(m,C,M,w,U){K.scale(m,K.identity(m),[C,M]);m[4]=m[4]*C-w*C+w;m[5]=m[5]*M-U*M+U;return m}function G(m,C){if(J&&"left"in J){null!=J.left&&J.left>m&&(J.left=m);if(null==J.right||J.right<m)J.right=m;if(null==
J.top||J.top>C)J.top=C;if(null==J.bottom||J.bottom<C)J.bottom=C}else J={left:m,bottom:C,right:m,top:C}}function P(m){const C=m.args,M=C.length;switch(m.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(m=0;m<M;m+=2)G(C[m],C[m+1]);z.x=C[M-2];z.y=C[M-1];break;case "H":for(m=0;m<M;++m)G(C[m],z.y);z.x=C[M-1];break;case "V":for(m=0;m<M;++m)G(z.x,C[m]);z.y=C[M-1];break;case "m":m=0;"x"in z||(G(z.x=C[0],z.y=C[1]),m=2);for(;m<M;m+=2)G(z.x+=C[m],z.y+=C[m+1]);break;case "l":case "t":for(m=0;m<
M;m+=2)G(z.x+=C[m],z.y+=C[m+1]);break;case "h":for(m=0;m<M;++m)G(z.x+=C[m],z.y);break;case "v":for(m=0;m<M;++m)G(z.x,z.y+=C[m]);break;case "c":for(m=0;m<M;m+=6)G(z.x+C[m],z.y+C[m+1]),G(z.x+C[m+2],z.y+C[m+3]),G(z.x+=C[m+4],z.y+=C[m+5]);break;case "s":case "q":for(m=0;m<M;m+=4)G(z.x+C[m],z.y+C[m+1]),G(z.x+=C[m+2],z.y+=C[m+3]);break;case "A":for(m=0;m<M;m+=7)G(C[m+5],C[m+6]);z.x=C[M-2];z.y=C[M-1];break;case "a":for(m=0;m<M;m+=7)G(z.x+=C[m+5],z.y+=C[m+6])}}function O(m,C,M){const w=f[m.toLowerCase()];
"number"===typeof w&&(w?C.length>=w&&(m={action:m,args:C.slice(0,C.length-C.length%w)},M.push(m),P(m)):(m={action:m,args:[]},M.push(m),P(m)))}function L(m){const C={x:0,y:0,width:0,height:0};if("circle"===m.type)C.x=m.cx-m.r,C.y=m.cy-m.r,C.width=2*m.r,C.height=2*m.r;else if("ellipse"===m.type)C.x=m.cx-m.rx,C.y=m.cy-m.ry,C.width=2*m.rx,C.height=2*m.ry;else if("image"===m.type||"rect"===m.type)C.x=m.x,C.y=m.y,C.width=m.width,C.height=m.height;else if("path"===m.type){var M=H.unwrapOrThrow;{const T=
("string"!==typeof m.path?d(m.path):m.path).match(A),S=[];J={};z={};if(T){m="";var w=[],U=T.length;for(let Y=0;Y<U;++Y){const ha=T[Y],ja=parseFloat(ha);isNaN(ja)?(m&&O(m,w,S),w=[],m=ha):w.push(ja)}O(m,w,S);m={x:0,y:0,width:0,height:0};J&&"left"in J&&(m.x=J.left,m.y=J.top,m.width=J.right-J.left,m.height=J.bottom-J.top)}else m=null}M=M.call(H,m);C.x=M.x;C.y=M.y;C.width=M.width;C.height=M.height}return C}function g(m){const C={x:0,y:0,width:0,height:0};let M=null,w=Number.NEGATIVE_INFINITY,U=Number.NEGATIVE_INFINITY;
for(const T of m)M?(M.x=Math.min(M.x,T.x),M.y=Math.min(M.y,T.y),w=Math.max(w,T.x+T.width),U=Math.max(U,T.y+T.height)):(M=C,M.x=T.x,M.y=T.y,w=T.x+T.width,U=T.y+T.height);M&&(M.width=w-M.x,M.height=U-M.y);return M}function c(m,C,M,w,U,T,S,Y,ha){var ja=(S&&T?t(T,C):C)/2,oa=(S&&T?t(T,M):M)/2;if(ha){var ra=ha[0];ha=ha[1];ja=(S&&T?t(T,ra):ra)/2;oa=(S&&T?t(T,ha):ha)/2}ra=m.width+w;var ta=m.height+w;ha=u.create();S=u.create();var ua=!1;if(U&&0!==ra&&0!==ta){U=C!==M?C/M:ra/ta;ua=C>M?C:M;let Aa=1,Z=1;isNaN(ua)||
(1<U?(Aa=ua/ra,Z=ua/U/ta):(Z=ua/ta,Aa=ua*U/ra));K.multiply(S,S,y(ha,Aa,Z,ja,oa));ua=!0}U=m.x+(ra-w)/2;m=m.y+(ta-w)/2;w=K.multiply;ja-=U;oa-=m;ja=K.translate(ha,K.identity(ha),[ja,oa]);w.call(K,S,S,ja);!ua&&(ra>C||ta>M)&&(ja=ra/C>ta/M,C=(ja?C:M)/(ja?ra:ta),K.multiply(S,S,y(ha,C,C,U,m)));T&&(C=K.multiply,M=T%360*Math.PI/180,K.rotate(ha,K.identity(ha),M),T=Math.cos(M),M=Math.sin(M),ra=ha[4],ta=ha[5],ha[4]=ra*T-ta*M+m*M-U*T+U,ha[5]=ta*T+ra*M-U*M-m*T+m,C.call(K,S,S,ha));Y&&(T=K.multiply,C=Y[0],Y=Y[1],
Y=K.translate(ha,K.identity(ha),[C,Y]),T.call(K,S,S,Y));return`matrix(${S[0]},${S[1]},${S[2]},${S[3]},${S[4]},${S[5]})`}function a(m,C,M){m=m?.effects.find(Y=>"bloom"===Y.type);if(!m)return null;const {strength:w,radius:U}=m;m=0<w?U:0;const T=(w+m)*C,S=4*w+1;return h.tsx("filter",{id:`bloom${M}`,x:"-100%",y:"-100%",width:"300%",height:"300%",filterUnits:"userSpaceOnUse"},h.tsx("feMorphology",{operator:"dilate",radius:(w+.5*m)*5**(C/100)*(.4+C/100),in:"SourceGraphic",result:"dilate"}),h.tsx("feGaussianBlur",
{in:"dilate",stdDeviation:T/25,result:"blur"}),h.tsx("feGaussianBlur",{in:"blur",stdDeviation:T/50,result:"intensityBlur"}),h.tsx("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},h.tsx("feFuncR",{type:"linear",slope:S}),h.tsx("feFuncG",{type:"linear",slope:S}),h.tsx("feFuncB",{type:"linear",slope:S})),h.tsx("feMerge",null,h.tsx("feMergeNode",{in:"intensityBlur"}),h.tsx("feMergeNode",{in:"intensityBrightness"}),h.tsx("feGaussianBlur",{stdDeviation:w/10})))}let v=0,Q=0;E=e("android");
const D=e("chrome")||E&&4<=E?"auto":"optimizeLegibility",f={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},A=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;let J={},z={};const N={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]},F=Math.PI;let R=1;b.computeBBox=g;b.generateFillAttributes=r;b.generateStrokeAttributes=l;b.generateTextAttributes=p;
b.getBoundingBox=L;b.getTransformMatrix=c;b.renderDef=B;b.renderSVG=function(m,C,M,w={}){const U=[],T=[],S=++R,Y=a(w.effectView,C,S);var ha=null;Y&&(ha=w.effectView?.effects.find(ua=>"bloom"===ua.type),ha=(ha.strength?ha.strength+ha.radius/2:0)/3,ha=[Math.max(C+C*ha,10),Math.max(M+M*ha,10)]);for(let ua=0;ua<m.length;ua++){var ja=m[ua];const Aa=[];var oa=[],ra=0,ta=0;let Z=0;for(const da of ja){const {shape:fa,fill:X,stroke:aa,font:ea,offset:ba}=da;w.ignoreStrokeWidth||(ra+=aa&&aa.width||0);ja=r(X);
const ia=l(aa),ma="text"===fa.type?p(fa,ea):null;U.push(B(ja));Aa.push(k(fa,ja.fill,ia,ma));oa.push(L(fa));ba&&(ta+=ba[0],Z+=ba[1])}oa=H.unwrapOrThrow(g(oa));ra=c(oa,C,M,ra,w.scale??!1,w.rotation,w.useRotationSize??!1,[ta,Z],ha);ta=null;w.masking&&(ta=`mask-${ua}`,U.push(x(w.masking[ua],ta)),ta=`url(#${ta})`);T.push(ta?h.tsx("g",{mask:ta},h.tsx("g",{transform:ra},Aa)):h.tsx("g",{transform:ra},Aa))}w.useRotationSize&&w.rotation&&(C=t(w.rotation,C),M=t(w.rotation,M));Y&&(H.assertIsSome(ha),C=ha[0],
M=ha[1]);return h.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:C,height:M,style:"display: block;"},Y,h.tsx("defs",null,U),Y?h.tsx("g",{filter:`url(#bloom${S})`},T):T)};b.renderShape=k;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/mat2df32":function(){define(["exports"],function(b){function n(){const t=new Float32Array(6);t[0]=1;t[3]=1;return t}function e(t){const d=new Float32Array(6);d[0]=t[0];d[1]=t[1];d[2]=t[2];d[3]=t[3];d[4]=t[4];d[5]=t[5];return d}function H(t,
d,k,r,l,p){const B=new Float32Array(6);B[0]=t;B[1]=d;B[2]=k;B[3]=r;B[4]=l;B[5]=p;return B}function u(t,d){return new Float32Array(t,d,6)}function K(t,d,k,r){const l=d[r];d=d[r+1];t[r]=k[0]*l+k[2]*d+k[4];t[r+1]=k[1]*l+k[3]*d+k[5]}function E(t,d,k,r=0,l=0,p=2){for(l=l||d.length/p;r<l;r++)K(t,d,k,r*p)}const h=Object.freeze(Object.defineProperty({__proto__:null,clone:e,create:n,createView:u,fromValues:H,transform:K,transformMany:E},Symbol.toStringTag,{value:"Module"}));b.clone=e;b.create=n;b.createView=
u;b.fromValues=H;b.mat2df32=h;b.transform=K;b.transformMany=E})},"esri/chunks/mat2d":function(){define(["exports","./common"],function(b,n){function e(a,v){a[0]=v[0];a[1]=v[1];a[2]=v[2];a[3]=v[3];a[4]=v[4];a[5]=v[5];return a}function H(a){a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;return a}function u(a,v,Q,D,f,A,J){a[0]=v;a[1]=Q;a[2]=D;a[3]=f;a[4]=A;a[5]=J;return a}function K(a,v){const Q=v[0],D=v[1],f=v[2],A=v[3],J=v[4];v=v[5];let z=Q*A-D*f;if(!z)return null;z=1/z;a[0]=A*z;a[1]=-D*z;a[2]=-f*z;a[3]=
Q*z;a[4]=(f*v-A*J)*z;a[5]=(D*J-Q*v)*z;return a}function E(a){return a[0]*a[3]-a[1]*a[2]}function h(a,v,Q){const D=v[0],f=v[1],A=v[2],J=v[3],z=v[4];v=v[5];const N=Q[0],F=Q[1],R=Q[2],m=Q[3],C=Q[4];Q=Q[5];a[0]=D*N+A*F;a[1]=f*N+J*F;a[2]=D*R+A*m;a[3]=f*R+J*m;a[4]=D*C+A*Q+z;a[5]=f*C+J*Q+v;return a}function t(a,v,Q){const D=v[0],f=v[1],A=v[2],J=v[3],z=v[4];v=v[5];const N=Math.sin(Q);Q=Math.cos(Q);a[0]=D*Q+A*N;a[1]=f*Q+J*N;a[2]=D*-N+A*Q;a[3]=f*-N+J*Q;a[4]=z;a[5]=v;return a}function d(a,v,Q){const D=v[1],
f=v[2],A=v[3],J=v[4],z=v[5],N=Q[0];Q=Q[1];a[0]=v[0]*N;a[1]=D*N;a[2]=f*Q;a[3]=A*Q;a[4]=J;a[5]=z;return a}function k(a,v,Q){const D=v[0],f=v[1],A=v[2],J=v[3],z=v[4];v=v[5];const N=Q[0];Q=Q[1];a[0]=D;a[1]=f;a[2]=A;a[3]=J;a[4]=D*N+A*Q+z;a[5]=f*N+J*Q+v;return a}function r(a,v){const Q=Math.sin(v);v=Math.cos(v);a[0]=v;a[1]=Q;a[2]=-Q;a[3]=v;a[4]=0;a[5]=0;return a}function l(a,v){a[0]=v[0];a[1]=0;a[2]=0;a[3]=v[1];a[4]=0;a[5]=0;return a}function p(a,v){a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=v[0];a[5]=v[1];return a}
function B(a){return"mat2d("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+")"}function x(a){return Math.sqrt(a[0]**2+a[1]**2+a[2]**2+a[3]**2+a[4]**2+a[5]**2+1)}function y(a,v,Q){a[0]=v[0]+Q[0];a[1]=v[1]+Q[1];a[2]=v[2]+Q[2];a[3]=v[3]+Q[3];a[4]=v[4]+Q[4];a[5]=v[5]+Q[5];return a}function G(a,v,Q){a[0]=v[0]-Q[0];a[1]=v[1]-Q[1];a[2]=v[2]-Q[2];a[3]=v[3]-Q[3];a[4]=v[4]-Q[4];a[5]=v[5]-Q[5];return a}function P(a,v,Q){a[0]=v[0]*Q;a[1]=v[1]*Q;a[2]=v[2]*Q;a[3]=v[3]*Q;a[4]=v[4]*Q;a[5]=v[5]*Q;return a}
function O(a,v,Q,D){a[0]=v[0]+Q[0]*D;a[1]=v[1]+Q[1]*D;a[2]=v[2]+Q[2]*D;a[3]=v[3]+Q[3]*D;a[4]=v[4]+Q[4]*D;a[5]=v[5]+Q[5]*D;return a}function L(a,v){return a[0]===v[0]&&a[1]===v[1]&&a[2]===v[2]&&a[3]===v[3]&&a[4]===v[4]&&a[5]===v[5]}function g(a,v){const Q=a[0],D=a[1],f=a[2],A=a[3],J=a[4];a=a[5];const z=v[0],N=v[1],F=v[2],R=v[3],m=v[4];v=v[5];const C=n.getEpsilon();return Math.abs(Q-z)<=C*Math.max(1,Math.abs(Q),Math.abs(z))&&Math.abs(D-N)<=C*Math.max(1,Math.abs(D),Math.abs(N))&&Math.abs(f-F)<=C*Math.max(1,
Math.abs(f),Math.abs(F))&&Math.abs(A-R)<=C*Math.max(1,Math.abs(A),Math.abs(R))&&Math.abs(J-m)<=C*Math.max(1,Math.abs(J),Math.abs(m))&&Math.abs(a-v)<=C*Math.max(1,Math.abs(a),Math.abs(v))}const c=Object.freeze(Object.defineProperty({__proto__:null,add:y,copy:e,determinant:E,equals:g,exactEquals:L,frob:x,fromRotation:r,fromScaling:l,fromTranslation:p,identity:H,invert:K,mul:h,multiply:h,multiplyScalar:P,multiplyScalarAndAdd:O,rotate:t,scale:d,set:u,str:B,sub:G,subtract:G,translate:k},Symbol.toStringTag,
{value:"Module"}));b.add=y;b.copy=e;b.determinant=E;b.equals=g;b.exactEquals=L;b.frob=x;b.fromRotation=r;b.fromScaling=l;b.fromTranslation=p;b.identity=H;b.invert=K;b.mat2d=c;b.mul=h;b.multiply=h;b.multiplyScalar=P;b.multiplyScalarAndAdd=O;b.rotate=t;b.scale=d;b.set=u;b.str=B;b.sub=G;b.subtract=G;b.translate=k})},"esri/symbols/support/utils":function(){define("require exports ../../chunks/_rollupPluginBabelHelpers ../../Color ../../symbols ../../core/asyncUtils ../../core/has ../../core/maybe ../../core/screenUtils ../../chunks/vec3f64 ../../layers/effects/jsonUtils ./gfxUtils ./Symbol3DMaterial".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k,r,l){function p(z){z=z.symbolLayers;if(!z)return null;let N=null;z.forEach(F=>{if("object"!==F.type||null==F.resource?.href)N="water"===F.type?h.unwrap(F.color):h.isSome(F.material)?h.unwrap(F.material.color):null});return N?new H(N):null}function B(z,N){if(null==N||null==z)return z;z=z.toRgba();z[3]*=N;return new H(z)}function x(z,N,F){if(z=z.symbolLayers){var R=m=>{m=h.isSome(m)?m:null;N=N??m??(null!=F?J:null);return B(N,F)};z.forEach(m=>{if("object"!==m.type||null==
m.resource?.href||N)if("water"===m.type)m.color=R(m.color);else{var C=h.isSome(m.material)?m.material.color:null;C=R(C);h.isNone(m.material)?m.material=new l.Symbol3DMaterial({color:C}):m.material.color=C;null!=F&&"outline"in m&&h.isSome(m.outline)&&h.isSome(m.outline.color)&&(m.outline.color=B(m.outline.color,F))}})}}function y(z,N){return G.apply(this,arguments)}function G(){G=e._asyncToGenerator(function*(z,N){(z=z.symbolLayers)&&(yield K.forEach(z,function(){var F=e._asyncToGenerator(function*(R){return P(R,
N)});return function(R){return F.apply(this,arguments)}}()))});return G.apply(this,arguments)}function P(z,N){return O.apply(this,arguments)}function O(){O=e._asyncToGenerator(function*(z,N){switch(z.type){case "extrude":z.size="number"===typeof N[2]?N[2]:0;break;case "icon":case "line":case "text":N=L(N);h.isSome(N)&&(z.size=N);break;case "path":const F=a(N,d.ONES,[z.width,void 0,z.height]);z.width=D(N[0],z.width,1,F);z.height=D(N[2],z.height,1,F);break;case "object":yield g(z,N)}});return O.apply(this,
arguments)}function L(z){for(const N of z)if("number"===typeof N)return N;return null}function g(z,N){return c.apply(this,arguments)}function c(){c=e._asyncToGenerator(function*(z,N){const {resourceSize:F,symbolSize:R}=yield v(z),m=a(N,F,R);z.width=D(N[0],R[0],F[0],m);z.depth=D(N[1],R[1],F[1],m);z.height=D(N[2],R[2],F[2],m)});return c.apply(this,arguments)}function a(z,N,F){for(let R=0;3>R;R++){const m=z[R];switch(m){case "symbol-value":return z=F[R],null!=z?z/N[R]:1;case "proportional":break;default:if(m&&
N[R])return m/N[R]}}return 1}function v(z){return Q.apply(this,arguments)}function Q(){Q=e._asyncToGenerator(function*(z){const N=yield(yield new Promise((w,U)=>b(["./symbolLayerUtils"],w,U))).computeObjectLayerResourceSize(z,10),{width:F,height:R,depth:m}=z;z=[F,m,R];let C=1;for(var M=0;3>M;M++){const w=z[M];if(null!=w){C=w/N[M];break}}for(M=0;3>M;M++)null==z[M]&&(z[M]=N[M]*C);return{resourceSize:N,symbolSize:z}});return Q.apply(this,arguments)}function D(z,N,F,R){switch(z){case "proportional":return F*
R;case "symbol-value":return null!=N?N:F;default:return z}}function f(){f=e._asyncToGenerator(function*(z,N){if(z&&N){if(u.isSymbol3D(z))return y(z,N);if(u.isSymbol2D(z)&&(N=L(N),!h.isNone(N)))switch(z.type){case "simple-marker":z.size=N;break;case "picture-marker":const F=z.width/z.height;1<F?(z.width=N,z.height=N*F):(z.width=N*F,z.height=N);break;case "simple-line":z.width=N;break;case "text":z.font.size=N}}});return f.apply(this,arguments)}function A(){A=e._asyncToGenerator(function*(z,N){const F=
yield z.fetchSymbol(N);return F?F:z.fetchCIMSymbol(N)});return A.apply(this,arguments)}const J=new H("white");n.applyColorToSymbol=function(z,N,F){if(z&&(N||null!=F))if(N&&(N=new H(N)),u.isSymbol3D(z))x(z,N,F);else if(u.isSymbol2D(z)){if(N=N??z.color)z.color=B(N,F);null!=F&&"outline"in z&&z.outline&&z.outline.color&&(z.outline.color=B(z.outline.color,F))}};n.applyOpacityToColor=B;n.applyRotationToSymbol=function(z,N,F){z&&null!=N&&(u.isSymbol3D(z)?(z=z.symbolLayers)&&z.forEach(R=>{if(R&&"object"===
R.type)switch(F){case "tilt":R.tilt=N;break;case "roll":R.roll=N;break;default:R.heading=N}}):!u.isSymbol2D(z)||"simple-marker"!==z.type&&"picture-marker"!==z.type&&"text"!==z.type||(z.angle=N))};n.applySizesToSymbol=function(z,N){return f.apply(this,arguments)};n.fetchWebStyleSymbol=function(z,N){return A.apply(this,arguments)};n.getCSSFilterFromEffectList=function(z){if(!z)return null;z=z.effects.filter(N=>"bloom"!==N.type).map(N=>N.toJSON());return k.effectFunctionsFromJSON(z)};n.getColorFromSymbol=
function(z,N){if(!z)return null;let F=null;u.isSymbol3D(z)?F=p(z):u.isSymbol2D(z)&&(F=z.color?new H(z.color):null);return F?B(F,N):null};n.getIconHref=function(z){return h.unwrapOrThrow(z.resource).href};n.getSymbolOutlineSize=function(z){if(!z)return 0;if(u.isSymbol3D(z)){{const N=z.symbolLayers&&z.symbolLayers.length;N?(z=z.symbolLayers.getItemAt(N-1),z="outline"in z?h.get(z,"outline","size"):void 0):z=void 0}return h.isSome(z)?z:0}return t.px2pt(r.getStroke(z)?.width)};n.isVolumetricSymbol=function(z){if(h.isNone(z)||
!("symbolLayers"in z)||h.isNone(z.symbolLayers))return!1;switch(z.type){case "point-3d":return z.symbolLayers.some(N=>"object"===N.type);case "line-3d":return z.symbolLayers.some(N=>"path"===N.type);case "polygon-3d":return z.symbolLayers.some(N=>"object"===N.type||"extrude"===N.type);default:return!1}};n.symbolHasExtrudeSymbolLayer=function(z){return h.isSome(z)&&"polygon-3d"===z.type&&z.symbolLayers.some(N=>"extrude"===N.type)};Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/support/relationshipUtils":function(){define(["exports",
"../../../../symbols/support/svgUtils","../../../../symbols/support/utils","../../../support/widgetUtils","../../../support/jsxFactory"],function(b,n,e,H,u){function K(t,d,k){const r=`${k}_arrowStart`;k=`${k}_arrowEnd`;t="left"===t;const l={markerStart:null,markerEnd:null};switch(d){case "HL":t?l.markerStart=`url(#${k})`:l.markerEnd=`url(#${r})`;break;case "LL":l.markerStart=`url(#${k})`;break;case "LH":t?l.markerEnd=`url(#${r})`:l.markerStart=`url(#${k})`;break;default:l.markerEnd=`url(#${r})`}return l}
function E(t,d,k,r,l=60){const {focus:p,numClasses:B,colors:x,rotation:y}=t;t=!!p;const G=Math.sqrt(l**2+l**2)+(t?0:5),P=[],O=[];var L=[],g=(l||75)/B;for(var c=0;c<B;c++){var a=c*g;for(var v=0;v<B;v++){var Q=v*g,D=n.generateFillAttributes(x[c][v]);const f=n.generateStrokeAttributes(null);Q={type:"rect",x:Q,y:a,width:g,height:g};const A=n.renderDef(D);A&&P.push(A);(D=n.renderShape(Q,D.fill,f,null))&&O.push(D);L.push(n.getBoundingBox(Q))}}g=null;t||(g="margin: -15px -15px -18px -15px");c=K("left",p,
d);a=K("right",p,d);v=n.computeBBox(L);L=n.getTransformMatrix(v,G,G,0,!1,y,!1);v=n.getTransformMatrix(v,G,G,0,!1,t?-45:null,!1);k={filter:e.getCSSFilterFromEffectList(r),opacity:null==k?"":`${k}`};return u.tsx("div",{styles:k,class:t?h.diamondMidColRamp:h.squareTableCell},u.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:G,height:G,style:g},u.tsx("defs",null,u.tsx("marker",{id:`${d}_arrowStart`,markerWidth:"10",markerHeight:"10",refX:"5",refY:"5",markerUnits:"strokeWidth",orient:"auto"},u.tsx("polyline",
{points:"0,0 5,5 0,10",fill:"none",stroke:"#555555","stroke-width":"1"})),u.tsx("marker",{id:`${d}_arrowEnd`,markerWidth:"10",markerHeight:"10",refX:"0",refY:"5",markerUnits:"strokeWidth",orient:"auto"},u.tsx("polyline",{points:"5,0 0,5 5,10",fill:"none",stroke:"#555555","stroke-width":"1"})),P),u.tsx("g",{transform:L},O),u.tsx("g",{transform:v},u.tsx("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":c.markerStart,"marker-end":c.markerEnd,x1:-10,y1:l-15,x2:-10,y2:15}),u.tsx("line",
{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":a.markerStart,"marker-end":a.markerEnd,x1:15,y1:l+10,x2:l-15,y2:l+10}))))}const h={diamondContainer:"esri-relationship-ramp--diamond__container",diamondLeftCol:"esri-relationship-ramp--diamond__left-column",diamondRightCol:"esri-relationship-ramp--diamond__right-column",diamondMidCol:"esri-relationship-ramp--diamond__middle-column",diamondMidColLabel:"esri-relationship-ramp--diamond__middle-column--label",diamondMidColRamp:"esri-relationship-ramp--diamond__middle-column--ramp",
squareTable:"esri-relationship-ramp--square__table",squareTableRow:"esri-relationship-ramp--square__table-row",squareTableCell:"esri-relationship-ramp--square__table-cell",squareTableLabel:"esri-relationship-ramp--square__table-label",squareTableLabelLeftBottom:"esri-relationship-ramp--square__table-label--left-bottom",squareTableLabelRightBottom:"esri-relationship-ramp--square__table-label--right-bottom",squareTableLabelLeftTop:"esri-relationship-ramp--square__table-label--left-top",squareTableLabelRightTop:"esri-relationship-ramp--square__table-label--right-top"};
b.renderRelationshipRamp=function(t,d,k,r){const {focus:l,labels:p}=t,B=!!l;t=E(t,d,k,r);d={justifyContent:"center"};k=H.isRTL();return B?u.tsx("div",{class:h.diamondContainer,styles:d},u.tsx("div",{class:h.diamondLeftCol},k?p.right:p.left),u.tsx("div",{class:h.diamondMidCol},u.tsx("div",{class:h.diamondMidColLabel},p.top),t,u.tsx("div",{class:h.diamondMidColLabel},p.bottom)),u.tsx("div",{class:h.diamondRightCol},k?p.left:p.right)):u.tsx("div",{class:h.squareTable},u.tsx("div",{class:h.squareTableRow},
u.tsx("div",{class:H.classes(h.squareTableCell,h.squareTableLabel,h.squareTableLabelRightBottom)},k?p.top:p.left),u.tsx("div",{class:h.squareTableCell}),u.tsx("div",{class:H.classes(h.squareTableCell,h.squareTableLabel,h.squareTableLabelLeftBottom)},k?p.left:p.top)),u.tsx("div",{class:h.squareTableRow},u.tsx("div",{class:h.squareTableCell}),t,u.tsx("div",{class:h.squareTableCell})),u.tsx("div",{class:h.squareTableRow},u.tsx("div",{class:H.classes(h.squareTableCell,h.squareTableLabel,h.squareTableLabelRightTop)},
k?p.right:p.bottom),u.tsx("div",{class:h.squareTableCell}),u.tsx("div",{class:H.classes(h.squareTableCell,h.squareTableLabel,h.squareTableLabelLeftTop)},k?p.bottom:p.right)))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/relationshipRampUtils":function(){define(["exports","../../../core/lang","../../../symbols/support/gfxUtils","../../../symbols/support/previewSymbol3D"],function(b,n,e,H){function u(d){if(d){var {type:k}=d;return k.includes("3d")?H.getSymbolLayerFill(d.symbolLayers.getItemAt(0)):
"simple-line"===k||"simple-marker"===d.type&&("x"===d.style||"cross"===d.style)?(d=e.getStroke(d))&&d.color:e.getFill(d)}}function K(d,k){const r=k.HH.label,l=k.LL.label,p=k.HL.label;k=k.LH.label;switch(d){case "HH":return{top:r,bottom:l,left:p,right:k};case "HL":return{top:p,bottom:k,left:l,right:r};case "LL":return{top:l,bottom:r,left:k,right:p};case "LH":return{top:k,bottom:p,left:r,right:l};default:return{top:r,bottom:l,left:p,right:k}}}function E(d){let k=h[d];d&&null==k&&(k=h.HH);return k||
0}const h={HH:315,HL:45,LL:135,LH:225},t={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};b.getRelationshipRampColors2D=function(d,k){const r=[],l=d.length**.5;d=n.clone(d);var p=(k||"HH").split("");k=p[0];for(p="H"===p[1];d.length;){const B=[];for(;B.length<l;)B.push(d.shift());p&&B.reverse();r.push(B)}"L"===k&&r.reverse();return r};b.getRelationshipRampElement=
function(d){const {focus:k,infos:r,numClasses:l}=d;var p=t[l];const B={};r.forEach(x=>{B[x.value]={label:x.label,fill:u(x.symbol)}});d=[];for(let x=0;x<l;x++){const y=[];for(let G=0;G<l;G++)y.push(B[p[x][G]].fill);d.push(y)}p=K(k,B);return{type:"relationship-ramp",numClasses:l,focus:k,colors:d,labels:p,rotation:E(k)}};b.getRotationAngleForFocus=E;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/previewSymbol3D":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../assets ../../core/colorUtils ../../core/has ../../core/Error ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/screenUtils ./gfxUtils ./IconSymbol3DLayerResource ./ObjectSymbol3DLayerResource ./previewUtils ./renderUtils ./utils ./webStyleSymbolUtils".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k,r,l,p,B,x,y){function G(S){const Y=S.outline;var ha=h.isSome(S.material)?S.material.color:null;ha=h.isSome(ha)?ha.toHex():null;if(h.isNone(Y)||"pattern"in Y&&h.isSome(Y.pattern)&&"style"===Y.pattern.type&&"none"===Y.pattern.style)return"fill"===S.type&&"#ffffff"===ha?{color:"#bdc3c7",width:.75}:null;S=d.pt2px(Y.size)||0;return{color:"rgba("+(h.isSome(Y.color)?Y.color.toRgba():"255,255,255,1")+")",width:Math.min(S,w),style:"pattern"in Y&&h.isSome(Y.pattern)&&"style"===
Y.pattern.type?k.dekebabifyLineStyle(Y.pattern.style):null,join:"butt",cap:"patternCap"in Y?Y.patternCap:"butt"}}function P(S,Y){var ha=Y&&Y.resource;ha=ha&&ha.href;if(S.thumbnail&&S.thumbnail.url)return Promise.resolve(S.thumbnail.url);if(ha&&"object"!==Y.type)return Promise.resolve(x.getIconHref(Y));const ja=e.getAssetUrl("esri/images/Legend/legend3dsymboldefault.png");return S.styleOrigin&&(S.styleOrigin.styleName||S.styleOrigin.styleUrl)?y.resolveWebStyleSymbol(S.styleOrigin,{portal:S.styleOrigin.portal},
"webRef").catch(oa=>oa).then(oa=>oa?.thumbnail?.url||ja):Promise.resolve(ja)}function O(S,Y=1){const ha=S.a;S=H.toHSV(S);const {r:ja,g:oa,b:ra}=H.toRGB({h:S.h,s:S.s/Y,v:100-(100-S.v)/Y});return[ja,oa,ra,ha]}function L(S){return"water"===S.type?h.isNone(S.color)?null:S.color:h.isNone(S.material)||h.isNone(S.material.color)?null:S.material.color}function g(S,Y=0){var ha=L(S);if(!ha){if("fill"===S.type)return null;Y=p.adjustColorComponentBrightness(k.defaultThematicColor.r,Y);return[Y,Y,Y,100]}S=ha.toRgba();
for(ha=0;3>ha;ha++)S[ha]=p.adjustColorComponentBrightness(S[ha],Y);return S}function c(S,Y){return a.apply(this,arguments)}function a(){a=n._asyncToGenerator(function*(S,Y){S=S.style;return"none"===S?null:{type:"pattern",x:0,y:0,src:yield k.getPatternUrlWithColor(e.getAssetUrl(`esri/symbols/patterns/${S}.png`),Y.toCss(!0)),width:5,height:5}});return a.apply(this,arguments)}function v(S){return S.outline?G(S):{color:"rgba(0, 0, 0, 1)",width:1.5}}function Q(S,Y){S=L(S);if(!S)return null;let ha;ha="rgba("+
(p.adjustColorComponentBrightness(S.r,Y)+",");ha+=p.adjustColorComponentBrightness(S.g,Y)+",";ha+=p.adjustColorComponentBrightness(S.b,Y)+",";return ha+S.a+");"}function D(S,Y){Y=Q(S,Y);if(!Y)return{};if("pattern"in S&&h.isSome(S.pattern)&&"style"===S.pattern.type&&"none"===S.pattern.style)return null;const ha=Math.min(S.size?d.pt2px(S.size):.75,w);return{color:Y,width:ha,style:"pattern"in S&&h.isSome(S.pattern)&&"style"===S.pattern.type?k.dekebabifyLineStyle(S.pattern.style):null,cap:"cap"in S?S.cap:
null,join:"join"in S?"miter"===S.join?d.pt2px(2):S.join:null}}function f(S,Y,ha){ha=null!=ha?.75*ha:0;return{type:"linear",x1:ha?.25*ha:0,y1:ha?.5*ha:0,x2:ha||4,y2:ha?.5*ha:4,colors:[{color:S,offset:0},{color:Y,offset:1}]}}function A(S){const Y=S.depth,ha=S.height;S=S.width;return 0!==S&&0!==Y&&0!==ha&&S===Y&&null!=S&&null!=ha&&S<ha}function J(S,Y,ha){const ja=[];if(!S)return ja;switch(S.type){case "icon":switch(S.resource&&S.resource.primitive||r.defaultPrimitive){case "circle":ja.push({shape:{type:"circle",
cx:0,cy:0,r:.5*Y},fill:g(S,0),stroke:G(S)});break;case "square":ja.push({shape:{type:"path",path:[{command:"M",values:[0,Y]},{command:"L",values:[0,0]},{command:"L",values:[Y,0]},{command:"L",values:[Y,Y]},{command:"Z",values:[]}]},fill:g(S,0),stroke:G(S)});break;case "triangle":ja.push({shape:{type:"path",path:[{command:"M",values:[0,Y]},{command:"L",values:[.5*Y,0]},{command:"L",values:[Y,Y]},{command:"Z",values:[]}]},fill:g(S,0),stroke:G(S)});break;case "cross":ja.push({shape:{type:"path",path:[{command:"M",
values:[.5*Y,0]},{command:"L",values:[.5*Y,Y]},{command:"M",values:[0,.5*Y]},{command:"L",values:[Y,.5*Y]}]},stroke:v(S)});break;case "x":ja.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[Y,Y]},{command:"M",values:[Y,0]},{command:"L",values:[0,Y]}]},stroke:v(S)});break;case "kite":ja.push({shape:{type:"path",path:[{command:"M",values:[0,.5*Y]},{command:"L",values:[.5*Y,0]},{command:"L",values:[Y,.5*Y]},{command:"L",values:[.5*Y,Y]},{command:"Z",values:[]}]},fill:g(S,
0),stroke:G(S)})}break;case "object":switch(S.resource&&S.resource.primitive||l.defaultPrimitive){case "cone":var oa=g(S,0);S=g(S,-.6);S=f(oa,S,ha?T:Y);Y=p.getConeShapes(Y,ha);ja.push({shape:Y[0],fill:S});ja.push({shape:Y[1],fill:S});break;case "inverted-cone":ha=g(S,0);S=g(S,-.6);S=f(ha,S,Y);Y=p.getInvertedConeShapes(Y);ja.push({shape:Y[0],fill:S});ja.push({shape:Y[1],fill:ha});break;case "cube":Y=p.getCubeShapes(Y,ha);ja.push({shape:Y[0],fill:g(S,0)});ja.push({shape:Y[1],fill:g(S,-.3)});ja.push({shape:Y[2],
fill:g(S,-.5)});break;case "cylinder":oa=g(S,0);const ra=g(S,-.6);oa=f(oa,ra,ha?T:Y);Y=p.getCylinderShapes(Y,ha);ja.push({shape:Y[0],fill:oa});ja.push({shape:Y[1],fill:oa});ja.push({shape:Y[2],fill:g(S,0)});break;case "diamond":Y=p.getDiamondShapes(Y);ja.push({shape:Y[0],fill:g(S,-.3)});ja.push({shape:Y[1],fill:g(S,0)});ja.push({shape:Y[2],fill:g(S,-.3)});ja.push({shape:Y[3],fill:g(S,-.7)});break;case "sphere":ha=g(S,0);S=g(S,-.6);S=f(ha,S);S.x1=0;S.y1=0;S.x2=.25*Y;S.y2=.25*Y;ja.push({shape:{type:"circle",
cx:0,cy:0,r:.5*Y},fill:S});break;case "tetrahedron":Y=p.getTetrahedronShapes(Y),ja.push({shape:Y[0],fill:g(S,-.3)}),ja.push({shape:Y[1],fill:g(S,0)}),ja.push({shape:Y[2],fill:g(S,-.6)})}}return ja}function z(S){return(S="number"===typeof S?.size?S?.size:null)?d.pt2px(S):null}function N(S,Y){const ha=z(Y),ja=Y?.maxSize?d.pt2px(Y.maxSize):null,oa=Y?.disableUpsampling??!1,ra=S.symbolLayers,ta=[];let ua=0,Aa=0;const Z=ra.getItemAt(ra.length-1);let da;Z&&"icon"===Z.type&&(da=Z.size&&d.pt2px(Z.size));ra.forEach(fa=>
{if("icon"===fa.type||"object"===fa.type){var X="icon"===fa.type?fa.size&&d.pt2px(fa.size):0,aa=ha||X?Math.ceil(Math.min(ha||X,ja||M)):C;if(fa&&fa.resource&&fa.resource.href){var ea=P(S,fa).then(ba=>{const ia=fa.get("material.color");var ma="icon"===fa.type?"multiply":"tint";return B.tintImageWithColor(ba,aa,ia,ma,oa)}).then(ba=>{const ia=ba.width,ma=ba.height;ua=Math.max(ua,ia);Aa=Math.max(Aa,ma);return[{shape:{type:"image",x:0,y:0,width:ia,height:ma,src:ba.url},fill:null,stroke:null}]});ta.push(ea)}else ea=
aa,"icon"===fa.type&&da&&ha&&(ea=X/da*aa),X="tall"===Y?.symbolConfig||Y?.symbolConfig?.isTall||("object"===fa.type?A(fa):!1),ua=Math.max(ua,X?T:ea),Aa=Math.max(Aa,ea),ta.push(Promise.resolve(J(fa,ea,X)))}});return t.eachAlways(ta).then(fa=>{const X=[];fa.forEach(aa=>{aa.value?X.push(aa.value):aa.error&&E.getLogger("esri.symbols.support.previewSymbol3D").warn("error while building swatchInfo!",aa.error)});return B.renderSymbol(X,[ua,Aa],{node:Y&&Y.node,scale:!1,opacity:Y&&Y.opacity})})}function F(S,
Y){const ha=S.symbolLayers,ja=[];S=x.isVolumetricSymbol(S);const oa=z(Y),ra=(Y&&Y.maxSize?d.pt2px(Y.maxSize):null)||w;let ta=0,ua=0,Aa;ha.forEach((Z,da)=>{if(Z&&("line"===Z.type||"path"===Z.type)){var fa=[];switch(Z.type){case "line":var X=D(Z,0);if(h.isNone(X))break;var aa=X&&X.width||0;0===da&&(Aa=aa);Z=Math.min(oa||aa,ra);da=0===da?Z:oa?aa/Aa*Z:Z;aa=da>U/2?2*da:U;ua=Math.max(ua,da);ta=Math.max(ta,aa);X.width=da;fa.push({shape:{type:"path",path:[{command:"M",values:[0,.5*ua]},{command:"L",values:[ta,
.5*ua]}]},stroke:X});break;case "path":X=Math.min(oa||C,ra);da=g(Z,0);aa=g(Z,-.2);var ea=Q(Z,-.4);ea=ea?{color:ea,width:1}:{};if("quad"===Z.profile){const ba=Z.width;Z=Z.height;Z=p.getPathSymbolShapes(ba&&Z?ba/Z:1,0===Z,0===ba);ea={...ea,join:"bevel"};fa.push({shape:Z[0],fill:aa,stroke:ea});fa.push({shape:Z[1],fill:aa,stroke:ea});fa.push({shape:Z[2],fill:da,stroke:ea})}else fa.push({shape:p.shapes.pathSymbol3DLayer[0],fill:aa,stroke:ea}),fa.push({shape:p.shapes.pathSymbol3DLayer[1],fill:da,stroke:ea});
ta=ua=Math.max(ua,X)}ja.push(fa)}});return Promise.resolve(B.renderSymbol(ja,[ta,ua],{node:Y&&Y.node,scale:S,opacity:Y&&Y.opacity}))}function R(S,Y){return m.apply(this,arguments)}function m(){m=n._asyncToGenerator(function*(S,Y){const ha="mesh-3d"===S.type;S=S.symbolLayers;var ja=z(Y);const oa=Y&&Y.maxSize?d.pt2px(Y.maxSize):null;ja=ja||C;const ra=[];let ta=0,ua=0;var Aa=!1;for(let ea=0;ea<S.length;ea++){var Z=S.getItemAt(ea);const ba=[];if(!ha||"fill"===Z.type){var da=p.shapes.fill[0];switch(Z.type){case "fill":var fa=
G(Z);Aa=Math.min(ja,oa||M);ta=Math.max(ta,Aa);ua=Math.max(ua,Aa);Aa=!0;var X=g(Z,0),aa="pattern"in Z?Z.pattern:null;Z=L(Z);!ha&&h.isSome(aa)&&"style"===aa.type&&"solid"!==aa.style&&Z&&(X=yield c(aa,Z));ba.push({shape:da,fill:X,stroke:fa});break;case "line":Z=D(Z,0);if(h.isNone(Z))break;Z={stroke:Z,shape:da};ta=Math.max(ta,C);ua=Math.max(ua,C);ba.push(Z);break;case "extrude":da={join:"round",width:1,...D(Z,-.4)};fa=g(Z,0);Z=g(Z,-.2);X=Math.min(ja,oa||M);aa=p.getExtrudeSymbolShapes(X);da.width=1;ba.push({shape:aa[0],
fill:Z,stroke:da});ba.push({shape:aa[1],fill:Z,stroke:da});ba.push({shape:aa[2],fill:fa,stroke:da});Z=.7*C+.5*X;ta=Math.max(ta,C);ua=Math.max(ua,Z);break;case "water":Aa=h.unwrapOrThrow(L(Z)),Z=O(Aa),da=O(Aa,2),fa=O(Aa,3),X=p.getWaterSymbolShapes(),Aa=!0,ba.push({shape:X[0],fill:Z}),ba.push({shape:X[1],fill:da}),ba.push({shape:X[2],fill:fa}),Z=Math.min(ja,oa||M),ta=Math.max(ta,Z),ua=Math.max(ua,Z)}ra.push(ba)}}return B.renderSymbol(ra,[ta,ua],{node:Y&&Y.node,scale:Aa,opacity:Y&&Y.opacity})});return m.apply(this,
arguments)}const C=p.SymbolSizeDefaults.size,M=p.SymbolSizeDefaults.maxSize,w=p.SymbolSizeDefaults.maxOutlineSize,U=p.SymbolSizeDefaults.lineWidth,T=p.SymbolSizeDefaults.tallSymbolWidth;b.getPatternDescriptor=c;b.getSizeFromOptions=z;b.getSymbolLayerFill=g;b.previewSymbol3D=function(S,Y){if(0===S.symbolLayers.length)return Promise.reject(new K("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));switch(S.type){case "point-3d":return N(S,Y);case "line-3d":return F(S,Y);case "polygon-3d":case "mesh-3d":return R(S,
Y)}return Promise.reject(new K("symbolPreview: swatchInfo3D","symbol not supported."))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/webStyleSymbolUtils":function(){define("exports ../../symbols ../../core/devEnvironmentUtils ../../core/Error ../../core/maybe ../../core/urlUtils ../../portal/Portal ../../chunks/persistableUrlUtils ./jsonUtils ./StyleOrigin ./styleUtils ./Thumbnail".split(" "),function(b,n,e,H,u,K,E,h,t,d,k,r){function l(B,x,y,G,P){var O=B.data;
const L=y&&u.isSome(y.portal)?y.portal:E.getDefault(),g={portal:L,url:K.urlToObject(B.baseUrl),origin:"portal-item"};O=O.items.find(D=>D.name===x);if(!O)return Promise.reject(new H("symbolstyleutils:symbol-name-not-found",`The symbol name '${x}' could not be found`,{symbolName:x}));let c=h.fromJSON(k.symbolUrlFromStyleItem(O,G),g),a=O.thumbnail?.href??null;const v=O.thumbnail&&O.thumbnail.imageData;e.isDevEnvironment()&&(c=e.adjustStaticAGOUrl(c)??"",a=e.adjustStaticAGOUrl(a));const Q={portal:L,url:K.urlToObject(K.removeFile(c)),
origin:"portal-item"};return k.requestJSON(c,P).then(D=>{D="cimRef"===G?k.makeCIMSymbolRef(D.data):D.data;if((D=t.fromJSON(D,Q))&&n.isSymbol3D(D)){if(a){const f=h.fromJSON(a,g);D.thumbnail=new r.Thumbnail({url:f})}else v&&(D.thumbnail=new r.Thumbnail({url:`data:image/png;base64,${v}`}));B.styleUrl?D.styleOrigin=new d({portal:y.portal,styleUrl:B.styleUrl,name:x}):B.styleName&&(D.styleOrigin=new d({portal:y.portal,styleName:B.styleName,name:x}))}return D})}function p(B,x,y){const G=k.Style2DUrlTemplate.replace(/\{SymbolName\}/gi,
B.name),P=u.isSome(x.portal)?x.portal:E.getDefault();return k.requestJSON(G,y).then(O=>{O=k.makeCIMSymbolRef(O.data);return t.fromJSON(O,{portal:P,url:K.urlToObject(K.removeFile(G)),origin:"portal-item"})})}b.fetchSymbolFromStyle=l;b.resolveWebStyleSymbol=function(B,x,y,G){return B.name?B.styleName&&"Esri2DPointSymbolsStyle"===B.styleName?p(B,x,G):k.fetchStyle(B,x,G).then(P=>l(u.unwrapOrThrow(P),B.name,x,y,G)):Promise.reject(new H("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference"))};
Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/devEnvironmentUtils":function(){define(["exports"],function(b){const n=/^devext.arcgis.com$/,e=/^qaext.arcgis.com$/,H=/^[\w-]*\.mapsdevext.arcgis.com$/,u=/^[\w-]*\.mapsqa.arcgis.com$/,K=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,n,e,/^jsapps.esri.com$/,H,u];b.adjustStaticAGOUrl=function(E,h){return E?(h=h||globalThis.location.hostname)?null!=h.match(n)||null!=h.match(H)?E.replace("static.arcgis.com","staticdev.arcgis.com"):
null!=h.match(e)||null!=h.match(u)?E.replace("static.arcgis.com","staticqa.arcgis.com"):E:E:E};b.isDevEnvironment=function(E){E=E||globalThis.location.hostname;return K.some(h=>null!=E?.match(h))};b.isTelemetryDevEnvironment=function(E){E=E||globalThis.location.hostname;return[/^zrh-.+?\.esri\.com$/].concat(K).some(h=>null!=E?.match(h))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/FeatureTemplates/TemplateItemGroup":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Identifiable ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,n,e,H,u,K,E,h){e=function(t){function d(k){k=t.call(this,k)||this;k.items=null;k.label=null;return k}b._inheritsLoose(d,t);d.prototype.findByTemplate=function(k){return this.items.find(r=>r.template===k)};b._createClass(d,[{key:"id",get:function(){return this.label}}]);return d}(H.IdentifiableMixin(e));n.__decorate([u.property()],e.prototype,"items",void 0);n.__decorate([u.property()],e.prototype,"label",void 0);n.__decorate([u.property()],e.prototype,"id",null);return e=n.__decorate([h.subclass("esri.widgets.FeatureTemplates.TemplateItemGroup")],
e)})},"esri/widgets/FeatureTemplates/ItemList":function(){define(["exports","../support/Heading","../support/widgetUtils","../support/jsxFactory"],function(b,n,e,H){function u(k){const {headingLevel:r,identify:l,items:p,renderIcon:B,filterText:x,onItemMouseLeave:y,onItemMouseEnter:G,onItemSelect:P,selectedItem:O}=k,L=k.enableListScroll?d.scroller:void 0;return 0===p.length?H.tsx("div",{class:d.noMatchesMessage,key:"no-matches"},k.messages.noMatches):H.tsx("div",{class:L,key:"item-container"},p.map(g=>
g.items?t({group:g,filterText:x,headingLevel:r,identify:l,onItemMouseLeave:y,onItemMouseEnter:G,onItemSelect:P,renderIcon:B,selectedItem:O}):E({item:g,identify:l,grouped:!0,onItemMouseLeave:y,onItemMouseEnter:G,onItemSelect:P,renderIcon:B,filterText:x,selectedItem:O})))}function K(k){const {messages:r,filterText:l,enableListScroll:p}=k;return H.tsx("div",{key:"filter",class:p?void 0:d.filterContainerSticky},H.tsx("calcite-input",{onCalciteInputInput:B=>{B=B.currentTarget;k.onFilterChange&&k.onFilterChange(B.value)},
placeholder:r.filterPlaceholder,value:l,type:"search"}))}function E({grouped:k,identify:r,item:l,onItemMouseEnter:p,onItemMouseLeave:B,onItemSelect:x,renderIcon:y,selectedItem:G}){const P=l?`${r?.(l)||l.id}__${l.label}`:"";r=G?`${r?.(G)||G.id}__${G.label}`:"";r=P===r;return H.tsx("calcite-list-item",{"aria-level":k?"2":"",class:e.classes(d.item,r?d.itemSelected:""),"data-item":l,key:P,label:l.label??void 0,selected:r,tabIndex:0,onCalciteListItemSelect:O=>x?.(h(O)),onmouseenter:O=>p?.(h(O)),onkeydown:O=>
e.isActivationKey(O.key)&&x?.(h(O)),onmouseleave:O=>B?.(h(O))},H.tsx("div",{class:d.itemIcon,slot:"content-start"},y?.({item:l})))}function h(k){return k.currentTarget["data-item"]}function t(k){const {group:r,headingLevel:l=4,...p}=k;return H.tsx("div",{class:d.group,key:r.label??void 0},H.tsx(n.Heading,{level:l,class:d.groupHeader},r.label),r.items.map(B=>E({...p,item:B,grouped:!0})))}const d={base:"esri-item-list",list:"esri-item-list__list",group:"esri-item-list__group",scroller:"esri-item-list__scroller",
groupHeader:"esri-item-list__group__header",item:"esri-item-list__list-item",itemSelected:"esri-item-list__list-item--selected",itemContainer:"esri-item-list__list-item-container",itemLabel:"esri-item-list__list-item-label",itemIcon:"esri-item-list__list-item-icon",noMatchesMessage:"esri-item-list__no-matches-message",noItemsMessage:"esri-item-list__no-items-message",filterContainer:"esri-item-list__filter-container",filterContainerSticky:"esri-item-list__filter-container--sticky",filterPlaceholder:"esri-item-list__filter-placeholder",
filterInput:"esri-item-list__filter-input",filterPlaceholderText:"esri-item-list__filter-placeholder-text",searchIcon:"esri-icon-search",widget:"esri-widget",input:"esri-input"};b.ItemList=function(k){const {filterEnabled:r=!0,filterText:l="",headingLevel:p=4,id:B,identify:x,items:y,messages:G,onFilterChange:P,onItemMouseEnter:O,onItemMouseLeave:L,onItemSelect:g,renderIcon:c,selectedItem:a,selectionMode:v="none"}=k;k=k.enableListScroll??!0;return H.tsx("div",{key:B},H.tsx("calcite-list",{selectionMode:v,
selectionAppearance:"border"},r?K({filterText:l,messages:G,onFilterChange:P,id:B}):null,u({enableListScroll:k,identify:x,items:y,selectedItem:a,messages:G,filterText:l,headingLevel:p,renderIcon:c,onItemMouseLeave:L,onItemMouseEnter:O,onItemSelect:g})))};b.renderGroup=t;b.renderItem=E;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Spinner":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/maybe ../core/promiseUtils ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/accessorSupport/decorators/subclass ./Widget ./Spinner/SpinnerViewModel ./support/widgetUtils ./support/jsxFactory".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k,r,l){E=function(p){function B(y,G){y=p.call(this,y,G)||this;y._animationDelay=500;y._animationPromise=null;y.viewModel=new k;return y}b._inheritsLoose(B,p);var x=B.prototype;x.initialize=function(){this.addHandles(u.watch(()=>this.visible,y=>this._visibleChange(y)))};x.destroy=function(){this._animationPromise=null};x.show=function(y){const {location:G,promise:P}=y??{};G&&(this.viewModel.location=G);this.visible=!0;y=()=>this.hide();P&&P.catch(()=>{}).then(y)};x.hide=
function(){this.visible=!1};x.render=function(){var {visible:y}=this,{screenLocation:G}=this.viewModel;G=!!G;y={["esri-spinner--start"]:y&&G,["esri-spinner--finish"]:!y&&G};G=this._getPositionStyles();return l.tsx("div",{class:this.classes("esri-spinner",y),styles:G})};x._visibleChange=function(y){if(y)this.viewModel.screenLocationEnabled=!0;else{var G=H.after(this._animationDelay);this._animationPromise=G;G.catch(()=>{}).then(()=>{this._animationPromise===G&&(this.viewModel.screenLocationEnabled=
!1,this._animationPromise=null)})}};x._getPositionStyles=function(){const {screenLocation:y,view:G}=this.viewModel;if(e.isNone(G)||e.isNone(y))return{};const {padding:P}=G;return{left:`${y.x-P.left}px`,top:`${y.y-P.top}px`}};b._createClass(B,[{key:"location",get:function(){return this.viewModel.location},set:function(y){this.viewModel.location=y}},{key:"view",get:function(){return this.viewModel.view},set:function(y){this.viewModel.view=y}},{key:"visible",get:function(){return this.viewModel.visible},
set:function(y){this.viewModel.visible=y}}]);return B}(d);n.__decorate([K.property()],E.prototype,"location",null);n.__decorate([K.property()],E.prototype,"view",null);n.__decorate([K.property({type:k})],E.prototype,"viewModel",void 0);n.__decorate([K.property()],E.prototype,"visible",null);return E=n.__decorate([t.subclass("esri.widgets.Spinner")],E)})},"esri/widgets/Spinner/SpinnerViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass ../support/AnchorElementViewModel".split(" "),
function(b,n,e,H,u,K,E){H=function(h){function t(d){d=h.call(this,d)||this;d.visible=!1;return d}b._inheritsLoose(t,h);return t}(E);n.__decorate([e.property()],H.prototype,"visible",void 0);return H=n.__decorate([K.subclass("esri.widgets.CompassViewModel")],H)})},"esri/widgets/support/AnchorElementViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Evented ../../core/Handles ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,n,e,H,u,K,E,h,t,d){const k=Symbol("anchorHandles");e=function(l){function p(B){var x=l.call(this,B)||this;x[r]=new H;x.location=null;x.screenLocationEnabled=!1;x.view=null;x[k].add([K.when(()=>u.applySome(x.screenLocationEnabled?x.view:null,y=>[y.size,"3d"===y.type?y.camera:y.viewpoint]),()=>x.notifyChange("screenLocation")),K.watch(()=>x.screenLocation,(y,G)=>{u.isSome(y)&&u.isSome(G)&&x.emit("view-change")})]);return x}b._inheritsLoose(p,l);p.prototype.destroy=function(){this.view=null;
this[k]=u.destroyMaybe(this[k])};b._createClass(p,[{key:"screenLocation",get:function(){const {location:B,view:x,screenLocationEnabled:y}=this;return y&&u.isSome(B)&&u.isSome(x)&&x.ready?x.toScreen?.(B):null}}]);return p}(e.EventedAccessor);var r=k;n.__decorate([E.property()],e.prototype,"location",void 0);n.__decorate([E.property()],e.prototype,"screenLocation",null);n.__decorate([E.property()],e.prototype,"screenLocationEnabled",void 0);n.__decorate([E.property()],e.prototype,"view",void 0);return e=
n.__decorate([d.subclass("esri.widgets.support.AnchorElementViewModel")],e)})},"esri/widgets/Editor/deprecationUtils":function(){define(["exports","../../core/deprecate"],function(b,n){b.workflowDeprecation=function(e,H,u){n.deprecated(e,"`"+H+"` is deprecated, because it instantiates the deprecated class 'esri.widgets.Editor.CreateWorkflow'",{replacement:u,version:"4.23",see:"https://developers.arcgis.com/javascript/latest/api-reference/esri-widgets-Editor-CreateFeaturesWorkflow.html"})};Object.defineProperty(b,
Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/EditorViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/asyncUtils ../../core/Collection ../../core/deprecate ../../core/Error ../../core/Evented ../../core/HandleOwner ../../core/Logger ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass ../../layers/GraphicsLayer ../../layers/support/layerUtils ../../portal/support/urlUtils ../Attachments/AttachmentsViewModel ./CreateFeaturesWorkflow ./CreateWorkflow ./deprecationUtils ./UpdateWorkflow ./workflowUtils ../FeatureForm/FeatureFormViewModel ../FeatureTemplates/FeatureTemplatesViewModel ../Sketch/SketchViewModel ../Spinner/SpinnerViewModel".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k,r,l,p,B,x,y,G,P,O,L,g,c,a,v,Q,D,f){function A(F,R,m){z.error(new K(F,R,m))}function J(F,R){return F?F.find(m=>m.layer===R):void 0}const z=t.getLogger("esri.widgets.Editor.EditorViewModel"),N=["create","create-features","update"];E=function(F){function R(C){var M=F.call(this,C)||this;M._sketchGraphicsLayer=new x({listMode:"hide",internal:!0});M._updateEditableItemsTask=null;M.activeWorkflow=null;M._activityQueue=[];M.editableItems=new H;M.failures=[];M.attachmentsViewModel=
new P({abilities:{editing:!0}});M.featureFormViewModel=new v;M.featureTemplatesViewModel=new Q;M.sketchViewModel=new D({layer:M._sketchGraphicsLayer});M.spinnerViewModel=new f;M.pageStack=[];M.showDiscardPrompt=()=>Promise.resolve();M._candidateCommitted=!1;M.back=b._asyncToGenerator(function*(){const w=M.activeWorkflow;if(w&&M.canGoBack){if(M.hasPendingEdits)try{yield M.showDiscardPrompt()}catch(U){return}w.hasPreviousStep?yield w.previous({cancelCurrentStep:!0}):yield M.cancelWorkflow({force:!0})}});
M.save=()=>{const {featureFormViewModel:w}=b._assertThisInitialized(M);w.submit();!w.submittable||0<w.validateContingencyConstraints(w.getValues(),{includeIncompleteViolations:!0}).length||M.activeWorkflow?.commit()};M.selectFeature=(w,U=!1)=>{const T=M.activeWorkflow;M._candidateCommitted||"update"!==T?.type||(T.data.edits.feature=w,U&&(T.next(),M._candidateCommitted=!0))};return M}b._inheritsLoose(R,F);var m=R.prototype;m.initialize=function(){this.handles.add([k.watch(()=>{const C=this.view?.map?.editableLayers.filter(({parent:w,
visible:U})=>w&&"visible"in w?U&&w.visible:U),M=this.view?.allLayerViews?.filter(w=>!!C?.includes(w.layer)&&!w.suspended);return[C,M,this.layerInfos,this.allowedWorkflows]},()=>this._updateEditableItems(),k.initial),k.on(()=>this.activeWorkflow,"cancel",()=>this.emit("workflow-cancel")),k.on(()=>this.activeWorkflow,"commit",()=>this.emit("workflow-commit")),k.when(()=>this.view?.map,C=>{C.add(this._sketchGraphicsLayer)},k.initial),k.watch(()=>this.editableItems.toArray(),()=>{const {activeWorkflow:C}=
this;this.refreshCreationTemplates();if(C){var {stepId:M}=C;"create"===C.type?"awaiting-feature-creation-info"!==M||this.canCreate||this._cancelWorkflow():"update"===C.type&&("awaiting-feature-to-update"===M&&!this.canUpdate||"awaiting-update-feature-candidate"===M&&!C.data.candidates.some(w=>{const U=this.editableItems.find(T=>T.layer===w.layer);return U&&U.supports.includes("update")}))&&this._cancelWorkflow()}}),k.watch(()=>this.page,(C,M)=>{const w=this.pageStack.slice();C=w.indexOf(C);-1===C&&
M?w.push(M):w.splice(C);this.pageStack=w}),k.when(()=>"awaiting-update-feature-candidate"===this.state,()=>this._candidateCommitted=!1)])};m.destroy=function(){this._cancelWorkflow().then(()=>{this.view?.map&&this.view.map.remove(this._sketchGraphicsLayer);this.view=null});this._updateEditableItemsTask=d.abortMaybe(this._updateEditableItemsTask)};m.startCreateWorkflowAtFeatureTypeSelection=function(){var C=b._asyncToGenerator(function*(){g.workflowDeprecation(z,"startCreateWorkflowAtFeatureTypeSelection",
"startCreateFeaturesWorkflowAtFeatureTypeSelection");yield k.whenOnce(()=>!this.updating);if(this.canCreate){yield this._cancelWorkflow();var M=this._createCreateWorkflow();yield M.start();this._set("activeWorkflow",M)}else A("editing:unsupported-workflow","Create workflow is unsupported or disabled.")});return function(){return C.apply(this,arguments)}}();m.startCreateFeaturesWorkflowAtFeatureTypeSelection=function(){var C=b._asyncToGenerator(function*(){return this.startCreateFeaturesWorkflow()});
return function(){return C.apply(this,arguments)}}();m.startCreateWorkflowAtFeatureCreation=function(){var C=b._asyncToGenerator(function*(M){g.workflowDeprecation(z,"startCreateWorkflowAtFeatureCreation","startCreateFeaturesWorkflowAtFeatureCreation");yield k.whenOnce(()=>!this.updating);if(this.canCreate){yield this._cancelWorkflow();var w=this._createCreateWorkflow("awaiting-feature-to-create");w.data.creationInfo=M;yield w.start();this._set("activeWorkflow",w)}else A("editing:unsupported-workflow",
"Create workflow is unsupported or disabled.")});return function(M){return C.apply(this,arguments)}}();m.startCreateFeaturesWorkflowAtFeatureCreation=function(){var C=b._asyncToGenerator(function*(M){return this.startCreateFeaturesWorkflow(M,"creating-features")});return function(M){return C.apply(this,arguments)}}();m.startCreateFeaturesWorkflow=function(){var C=b._asyncToGenerator(function*(M,w="awaiting-feature-creation-info"){yield k.whenOnce(()=>!this.updating);if(!this.canCreate)throw new K("editing:unsupported-workflow",
"Creating features is unsupported or disabled.");yield this._cancelWorkflow();M=this._createCreateFeaturesWorkflow(M,w);yield M.start();this._set("activeWorkflow",M)});return function(M){return C.apply(this,arguments)}}();m.startCreateWorkflowAtFeatureEdit=function(){var C=b._asyncToGenerator(function*(M){g.workflowDeprecation(z,"startCreateWorkflowAtFeatureEdit");yield k.whenOnce(()=>!this.updating);if(this.canCreate){yield this._cancelWorkflow();var w=this._createCreateWorkflow("editing-new-feature");
w.data.edits.feature=M;yield w.start();this._set("activeWorkflow",w)}else A("editing:unsupported-workflow","Create workflow is unsupported or disabled.")});return function(M){return C.apply(this,arguments)}}();m.startUpdateWorkflowAtFeatureSelection=function(){var C=b._asyncToGenerator(function*(){yield k.whenOnce(()=>!this.updating);if(this.canUpdate){yield this._cancelWorkflow();var M=this._createUpdateWorkflow();yield M.start();this._set("activeWorkflow",M)}else A("editing:unsupported-workflow",
"Update workflow is unsupported or disabled.")});return function(){return C.apply(this,arguments)}}();m.startUpdateWorkflowAtMultipleFeatureSelection=function(){var C=b._asyncToGenerator(function*(M){yield k.whenOnce(()=>!this.updating);if(this.canUpdate){yield this._cancelWorkflow();var w=this._createUpdateWorkflow("awaiting-update-feature-candidate");w.data.candidates=M;yield w.start();this._set("activeWorkflow",w)}else A("editing:unsupported-workflow","Update workflow is unsupported or disabled.")});
return function(M){return C.apply(this,arguments)}}();m.startUpdateWorkflowAtFeatureEdit=function(){var C=b._asyncToGenerator(function*(M){yield k.whenOnce(()=>!this.updating);if(this.canUpdate){yield this._cancelWorkflow();var w=this._createUpdateWorkflow("editing-existing-feature");w.data.edits.feature=M;yield w.start();this._set("activeWorkflow",w)}else A("editing:unsupported-workflow","Update workflow is unsupported or disabled.")});return function(M){return C.apply(this,arguments)}}();m.deleteFeatureFromWorkflow=
function(){var C=b._asyncToGenerator(function*(){const {activeWorkflow:M}=this;M&&"update"===M.type?(yield this._delete(M.data.edits.feature),yield M.reset()):A("editing:unsupported-workflow","Deleting requires an active update workflow.")});return function(){return C.apply(this,arguments)}}();m.cancelWorkflow=function(){var C=b._asyncToGenerator(function*(M){return this._cancelWorkflow({warn:!0,...M})});return function(M){return C.apply(this,arguments)}}();m.findEditableItemForLayer=function(C){const M=
"subtype-sublayer"===C.type?C.parent:C;return this.editableItems.find(w=>w.layer===M)};m.refreshCreationTemplates=function(){const C=[];for(const {layer:M,supports:w}of this.editableItems)M.loaded&&w.includes("create")&&C.push(M);this.featureTemplatesViewModel.layers=C};m._updateEditableItems=function(){var C=b._asyncToGenerator(function*(){var M=this;d.abortMaybe(this._updateEditableItemsTask);const w=e.createTask(function(){var U=b._asyncToGenerator(function*(T){var S=M.view?.allLayerViews,Y=M.view?.map?.editableLayers;
if(S&&Y){var ha=new Set(Y);Y=Y?.filter(oa=>{const ra=y.getEffectiveLayerCapabilities(oa)?.operations;return!(!oa.visible||!ra?.supportsAdd||ra?.supportsQuery)});var ja=S.filter(oa=>ha.has(oa.layer));S=[];for(const oa of ja.reverse()){const {layer:ra,suspended:ta}=oa;"subtype-group"===ra.type?(yield ra.loadAll(),S.push(...ra.sublayers.slice().reverse().map(ua=>M._makeEditableItemForLayer(ua,ta)))):S.push(M._makeEditableItemForLayer(ra,ta))}for(const oa of Y.reverse())"subtype-group"===oa.type?(yield oa.loadAll(),
S.push(...oa.sublayers.map(ra=>M._makeEditableItemForLayer(ra,!1)))):S.push(M._makeEditableItemForLayer(oa,!1));T.aborted||(T=M.editableItems,M.editableItems=new H(S),T.destroy())}});return function(T){return U.apply(this,arguments)}}());this.updatingHandles.addPromise(w.promise);this._updateEditableItemsTask=w});return function(){return C.apply(this,arguments)}}();m._cancelWorkflow=function(){var C=b._asyncToGenerator(function*(M){const w=this.activeWorkflow;w?M&&!1===M.force?(yield w.cancel(M),
this._set("activeWorkflow",null)):(this.emit("workflow-cancel"),this._set("activeWorkflow",null),yield w.cancel(M)):M&&M.warn&&A("editing:no-active-workflow","There is no active workflow to cancel.")});return function(M){return C.apply(this,arguments)}}();m._createCreateFeaturesWorkflow=function(C,M){return O.create(this,C,M,(w,U,T)=>this._applyEdits(w,U,T),(w,U)=>this._addAttachments(w,U))};m._createCreateWorkflow=function(C){return L.create(this,C,(M,w,U)=>this._applyEdits(M,w,U))};m._createUpdateWorkflow=
function(C){return c.create(this,C,(M,w)=>this._applyEdits(M,w))};m._delete=function(){var C=b._asyncToGenerator(function*(M){const w=M?.sourceLayer;w&&"applyEdits"in w&&(yield this._applyEdits(w,{deleteFeatures:[M]}))});return function(M){return C.apply(this,arguments)}}();m._addAttachments=function(C,M){const w=[];M?.forEach(U=>w.push(this._addAttachment(C,U.feature,U.attachment)));return Promise.all(w)};m._addAttachment=function(){var C=b._asyncToGenerator(function*(M,w,U){let T=null;if("geojson"===
M.type||"scene"===M.type||"oriented-imagery"===M.type)throw new K("editor:attachments-not-supported","Adding attachments is not supported for this layer type");yield this._queueOperation(b._asyncToGenerator(function*(){return T=(yield M.addAttachment?.(w,U).catch(S=>{throw S?.error||S;}))??null}));return T});return function(M,w,U){return C.apply(this,arguments)}}();m._applyEdits=function(){var C=b._asyncToGenerator(function*(M,w,U){var T=this;let S=null;const Y=M.url?yield y.getOwningPortalUrl(M.url):
null,ha={returnServiceEditsOption:Y&&G.parseKnownArcGISOnlineDomain(Y)||RegExp("/hosted/","i").test(M.url)?void 0:"original-and-current-features",...U};yield this._queueOperation(b._asyncToGenerator(function*(){if(y.getEffectiveLayerCapabilities(M)?.operations.supportsQuery){const ja=yield a.whenEditorLayerView(T.view,M);S=yield M.applyEdits(w,ha);yield k.whenOnce(()=>!ja.updating);return S}return S=yield M.applyEdits(w,ha)}));return S});return function(M,w,U){return C.apply(this,arguments)}}();m._queueOperation=
function(C){this._activityQueue.push(C);this.notifyChange("syncing");const M=(w,U)=>{w=U.indexOf(w);-1<w&&U.splice(w,1)};return C().then(w=>{if("error"in w&&w.error)throw w.error;if("addFeatureResults"in w){const {addFeatureResults:U,deleteFeatureResults:T,updateFeatureResults:S}=w,Y=U.find(ha=>!!ha.error)||S.find(ha=>!!ha.error)||T.find(ha=>!!ha.error);if(Y)throw Y.error;}return w}).catch(w=>{A("editing:operation-error","An error occurred.",{error:w});const U={error:w,retry:()=>{M(U,this.failures);
return this._queueOperation(C)},cancel:()=>{M(U,this.failures)}};this._set("failures",[...this.failures,U])}).then(()=>{M(C,this._activityQueue);this.notifyChange("syncing")})};m._makeEditableItemForLayer=function(C,M=!0){const w=y.getEffectiveLayerCapabilities(C);var U=w?.operations;const T=J(this.layerInfos,C);var S=this.allowedWorkflows;const Y=S.includes("create")||S.includes("create-features");var ha=S.includes("update");const ja=Y&&!!U?.supportsAdd&&(!T||!1!==T.enabled&&!1!==T.addEnabled);S=
ha&&!!U?.supportsUpdate&&(!T||!1!==T.enabled&&!1!==T.updateEnabled);ha=ha&&!!U?.supportsDelete&&(!T||!1!==T.enabled&&!1!==T.deleteEnabled);U=[];M||(ja&&U.push("create"),S&&U.push("update"),ha&&U.push("delete"));M=!!w?.data?.supportsAttachment&&(!T||!1!==T.allowAttachments);return{layer:C,supports:U,attributeUpdatesEnabled:S&&(!T||!1!==T.attributeUpdatesEnabled),geometryUpdatesEnabled:S&&!!w?.editing?.supportsGeometryUpdate&&(!T||!1!==T.geometryUpdatesEnabled),hasAttachments:M,attachmentsOnCreateEnabled:M&&
Y&&(!T||!1!==T.attachmentsOnCreateEnabled),attachmentsOnUpdateEnabled:M&&(!T||!1!==T.attachmentsOnUpdateEnabled)}};b._createClass(R,[{key:"allowedWorkflows",get:function(){return this._get("allowedWorkflows")},set:function(C){C&&0!==C.length||(C=[...N]);this._set("allowedWorkflows",C)}},{key:"canCreate",get:function(){return this.editableItems.some(C=>C.supports.includes("create"))}},{key:"canUpdate",get:function(){return this.editableItems.some(C=>C.supports.includes("update")||C.supports.includes("delete")||
C.attachmentsOnUpdateEnabled)}},{key:"labelOptions",get:function(){return this.sketchViewModel.labelOptions},set:function(C){this.sketchViewModel.labelOptions=C}},{key:"layerInfos",set:function(C){C?.some(M=>{"allowAttachments"in M&&u.deprecated(z,"Property: layerInfo.allowAttachments",{replacement:"layerInfo.attachmentsOnCreateEnabled or layerInfo.attachmentsOnUpdateEnabled",version:"4.26"});return!0});this._set("layerInfos",C)}},{key:"snappingOptions",get:function(){return this.sketchViewModel.snappingOptions},
set:function(C){this.sketchViewModel.snappingOptions=C}},{key:"state",get:function(){if(!this.get("view.ready")||0===this.editableItems.length)return"disabled";var C=this.attachmentsViewModel.mode;if("add"===C)return"adding-attachment";if("edit"===C)return"editing-attachment";({activeWorkflow:C}=this);return C?C.stepId:"ready"}},{key:"syncing",get:function(){return 0<this._activityQueue.length}},{key:"updating",get:function(){return this.updatingHandles.updating}},{key:"tooltipOptions",get:function(){return this.sketchViewModel.tooltipOptions},
set:function(C){this.sketchViewModel.tooltipOptions=C}},{key:"view",set:function(C){this.sketchViewModel.view=C;this.spinnerViewModel.view=C;this._set("view",C)}},{key:"page",get:function(){const {activeWorkflow:C,state:M}=this;return"awaiting-feature-to-update"===M||"awaiting-feature-to-create"===M||"create-features"===C?.type&&0===C.pendingFeatures.length?"ready":M??"disabled"}},{key:"selectedTemplateItem",get:function(){var {activeWorkflow:C}=this;if("create-features"===C?.type&&0===C.pendingFeatures.length){({template:C}=
C.data.creationInfo);for(const M of this.featureTemplatesViewModel.items)if("findByTemplate"in M){const w=M.findByTemplate(C);if(w)return w}else if(M.template===C)return M}}},{key:"featureFormDisabled",get:function(){const {activeWorkflow:C}=this;return"update"===C?.type&&!1===C?.data.editableItem?.attributeUpdatesEnabled}},{key:"canGoBack",get:function(){return d.isSome(this.activeWorkflow)&&!this.syncing}},{key:"shouldShowDeleteButton",get:function(){const {activeWorkflow:C}=this;return!!C&&"update"===
C.type&&C.data.editableItem.supports.includes("delete")}},{key:"hasPendingEdits",get:function(){const {activeWorkflow:C}=this;return C?"create"===C.type||"create-features"===C.type&&0<C.numPendingFeatures||"editing-existing-feature"===C.stepId&&C.data.edits.modified:!1}}]);return R}(h.HandleOwnerMixin(E.EventedAccessor));n.__decorate([r.property({readOnly:!0})],E.prototype,"activeWorkflow",void 0);n.__decorate([r.property({readOnly:!0})],E.prototype,"_activityQueue",void 0);n.__decorate([r.property({value:[...N]})],
E.prototype,"allowedWorkflows",null);n.__decorate([r.property({readOnly:!0})],E.prototype,"canCreate",null);n.__decorate([r.property({readOnly:!0})],E.prototype,"canUpdate",null);n.__decorate([r.property()],E.prototype,"editableItems",void 0);n.__decorate([r.property({readOnly:!0})],E.prototype,"failures",void 0);n.__decorate([r.property()],E.prototype,"attachmentsViewModel",void 0);n.__decorate([r.property()],E.prototype,"featureFormViewModel",void 0);n.__decorate([r.property()],E.prototype,"featureTemplatesViewModel",
void 0);n.__decorate([r.property()],E.prototype,"labelOptions",null);n.__decorate([r.property()],E.prototype,"layerInfos",null);n.__decorate([r.property()],E.prototype,"sketchViewModel",void 0);n.__decorate([r.property()],E.prototype,"snappingOptions",null);n.__decorate([r.property()],E.prototype,"spinnerViewModel",void 0);n.__decorate([r.property()],E.prototype,"state",null);n.__decorate([r.property({readOnly:!0})],E.prototype,"syncing",null);n.__decorate([r.property()],E.prototype,"updating",null);
n.__decorate([r.property()],E.prototype,"tooltipOptions",null);n.__decorate([r.property()],E.prototype,"view",null);n.__decorate([r.property()],E.prototype,"pageStack",void 0);n.__decorate([r.property()],E.prototype,"showDiscardPrompt",void 0);n.__decorate([r.property()],E.prototype,"_candidateCommitted",void 0);n.__decorate([r.property()],E.prototype,"page",null);n.__decorate([r.property()],E.prototype,"selectedTemplateItem",null);n.__decorate([r.property()],E.prototype,"featureFormDisabled",null);
n.__decorate([r.property()],E.prototype,"canGoBack",null);n.__decorate([r.property()],E.prototype,"shouldShowDeleteButton",null);n.__decorate([r.property()],E.prototype,"hasPendingEdits",null);return E=n.__decorate([B.subclass("esri.widgets.Editor.EditorViewModel")],E)})},"esri/layers/GraphicsLayer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/accessorSupport/decorators/subclass ../core/support/OwningCollection ./Layer ./mixins/BlendLayer ./mixins/ScaleRangeLayer ../support/GraphicsCollection ../symbols/support/ElevationInfo".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k,r){H=function(l){function p(x){x=l.call(this,x)||this;x.elevationInfo=null;x.graphics=new k.GraphicsCollection;x.screenSizePerspectiveEnabled=!0;x.type="graphics";x.internal=!1;return x}b._inheritsLoose(p,l);var B=p.prototype;B.destroy=function(){this.removeAll();this.graphics.destroy()};B.add=function(x){this.graphics.add(x);return this};B.addMany=function(x){this.graphics.addMany(x);return this};B.removeAll=function(){this.graphics.removeAll();return this};B.remove=
function(x){this.graphics.remove(x)};B.removeMany=function(x){this.graphics.removeMany(x)};B.on=function(x,y){return l.prototype.on.call(this,x,y)};B.graphicChanged=function(x){this.emit("graphic-update",x)};return p}(t.BlendLayer(d.ScaleRangeLayer(h)));n.__decorate([e.property({type:r})],H.prototype,"elevationInfo",void 0);n.__decorate([e.property(E.owningCollectionProperty(k.GraphicsCollection,"graphics"))],H.prototype,"graphics",void 0);n.__decorate([e.property({type:["show","hide"]})],H.prototype,
"listMode",void 0);n.__decorate([e.property()],H.prototype,"screenSizePerspectiveEnabled",void 0);n.__decorate([e.property({readOnly:!0})],H.prototype,"type",void 0);n.__decorate([e.property({constructOnly:!0})],H.prototype,"internal",void 0);return H=n.__decorate([K.subclass("esri.layers.GraphicsLayer")],H)})},"esri/widgets/Editor/CreateFeaturesWorkflow":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/arrayUtils ../../core/handleUtils ../../core/maybe ../../core/reactiveUtils ../../core/uuid ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../layers/support/layerUtils ../../views/draw/support/helpMessageUtils ../../views/interactive/snapping/FeatureSnappingLayerSource ./CreateFeaturesWorkflowData ./Workflow ./workflowUtils".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k,r,l,p,B,x){var y;const G=Symbol();t=y=function(P){function O(g){g=P.call(this,g)||this;g.type="create-features";g.createFeatureState="create-new";g._featureFormHandle=null;g._visualVariableAttributes={rotation:null,size:null};g._attachmentFileInfos=new Map;g._highlightHandles=new Map;g._preventDefaultActionOnCancel=!1;g._lastActiveGraphics=[];return g}b._inheritsLoose(O,P);var L=O.prototype;L.updatePendingFeature=function(){var g=b._asyncToGenerator(function*(c,a){this._preventDefaultActionOnCancel=
!0;this.data.viewModel.sketchViewModel.cancel();e.remove(this._lastActiveGraphics,c);return this._startUpdating(c,a)});return function(c,a){return g.apply(this,arguments)}}();O.create=function(g,c,a,v,Q){const D=new y({data:new p.CreateFeaturesWorkflowData({creationInfo:u.unwrap(c),viewModel:g}),onCommit:function(){var f=b._asyncToGenerator(function*(A){var J=A.viewModel.sketchViewModel.layer.graphics.toArray();A=A.creationInfo.layer;var z=A.capabilities.editing.supportsGlobalId&&"globalIdField"in
A;const N=D._attachmentFileInfos;0===N.size?yield v(A,{addFeatures:J}):z?(J=D._getAttachmentEditsWithGlobalIds(J,A,N),yield v(A,J,"addAttachments"in J?{globalIdUsed:!0}:void 0)):({addFeatureResults:z}=yield v(A,{addFeatures:J}),J=D._getAddAttachmentsData(J,z,A,N),yield Q(A,J))});return function(A){return f.apply(this,arguments)}}()});D._set("steps",this._createWorkflowSteps(D,a));return D};L._fadeExistingFeatures=function(g){if("effect"in g){const a=g.effect;g.effect="saturate(0.6) opacity(0.8)";
return H.makeHandle(()=>g.effect=a)}const c=g.opacity;g.opacity=.7;return H.makeHandle(()=>g.opacity=c)};L._highlight=function(g){const c=this.data.viewModel.view;"3d"===c?.type&&this._highlightHandles.set(g,c.highlight(g))};L._removeHighlight=function(g){u.removeMaybe(this._highlightHandles.get(g));this._highlightHandles.delete(g)};L._startCreating=function(){var g=b._asyncToGenerator(function*(c){this.createFeatureState="create-new";return x.startCreatingNewFeature(this.data.viewModel.sketchViewModel,
this.data.creationInfo,c)});return function(c){return g.apply(this,arguments)}}();L._startUpdating=function(){var g=b._asyncToGenerator(function*(c,a){const {featureFormViewModel:v,layerInfos:Q,sketchViewModel:D,view:f}=this.data.viewModel;if(f){var A=this.data.creationInfo.layer,J=x.findLayerInfo(Q,A);v.set({arcadeEditType:"INSERT",feature:c,formTemplate:J?.formTemplate,spatialReference:f.spatialReference,view:f});u.removeMaybe(this._featureFormHandle);this._featureFormHandle=H.handlesGroup([v.on("value-change",
b._asyncToGenerator(function*(){c.attributes=v.getValues();yield x.updateGraphicSymbolWhenRequired(c,a)})),D.on(["update","undo","redo"],z=>{("undo"===z.type||"redo"===z.type||"update"===z.type&&u.isSome(z.toolEventInfo)&&x.isTerminalUpdateEventType(z.toolEventInfo.type))&&v.notifyFeatureGeometryChanged()})]);this._removeHighlight(c);this.createFeatureState="update-pending";this._visualVariableAttributes=x.getVisualVariableAttributes(c);return x.startUpdatingFeature(D,c,A,this._visualVariableAttributes,
a)}});return function(c,a){return g.apply(this,arguments)}}();O._createWorkflowSteps=function(g,c="awaiting-feature-creation-info"){const {data:a,handles:v}=g;let Q=null,D=!0;const f=new Map;c=x.createWorkflowSteps(["awaiting-feature-creation-info","creating-features","adding-attachment","editing-attachment"],c,{"awaiting-feature-creation-info":()=>({id:"awaiting-feature-creation-info",setUp(){var A=this;return b._asyncToGenerator(function*(){a.creationInfo=null;v.add(a.viewModel.featureTemplatesViewModel.on("select",
({item:J})=>{J&&(a.creationInfo=J,a.viewModel.activeWorkflow?.next())}),A.id)})()},tearDown(){var A=this;return b._asyncToGenerator(function*(){v.remove(A.id)})()}}),"creating-features":()=>({id:"creating-features",setUp(){var A=this;return b._asyncToGenerator(function*(){if(!v.has(A.id)){var J=a.viewModel.view;if(J){var z=a.viewModel.sketchViewModel;D=z.updateOnGraphicClick;z.updateOnGraphicClick=!1;g._lastActiveGraphics=[];g._featureFormHandle=u.removeMaybe(g._featureFormHandle);g._visualVariableAttributes=
{rotation:null,size:null};x.prepareAttachmentsForCreateWorkflow(a.viewModel.attachmentsViewModel);var N="2d"===J.type?g._fadeExistingFeatures(a.creationInfo.layer):null,F=z.on("create",function(){var T=b._asyncToGenerator(function*(S){if("cancel"===S.state){if(g._preventDefaultActionOnCancel){g._preventDefaultActionOnCancel=!1;return}if(1>g._lastActiveGraphics.length)return g._startCreating(f);S=g._lastActiveGraphics.pop();return g._startUpdating(S,f)}if("complete"===S.state&&S.graphic)return g._startUpdating(S.graphic,
f)});return function(S){return T.apply(this,arguments)}}()),R=z.on("update",function(){var T=b._asyncToGenerator(function*(S){var Y=S.graphics[0];if("complete"===S.state){Y!==Q&&(g._lastActiveGraphics.push(Y),g._highlight(Y));Q=null;"add"!==a.viewModel.attachmentsViewModel.mode&&"edit"!==a.viewModel.attachmentsViewModel.mode||a.viewModel.activeWorkflow?.previous();if(S.aborted&&g._preventDefaultActionOnCancel){g._preventDefaultActionOnCancel=!1;return}const ha=J.cursor;J.cursor="progress";v.add([H.makeHandle(()=>
J.cursor=ha),J.on("click",ja=>ja.preventDefault())],G);return K.whenOnce(()=>!a.viewModel.featureFormViewModel.updating).then(()=>{v.remove(G);g._startCreating(f)})}if("start"===S.state){g._removeHighlight(Y);const ha=a.viewModel.attachmentsViewModel;"add"!==ha.mode&&"edit"!==ha.mode||a.viewModel.activeWorkflow?.previous();ha.fileInfos.removeAll();ha.graphic=Y;ha.mode="view";(g._attachmentFileInfos.get(Y)||[]).forEach(({file:ja,form:oa})=>ha.addFile(ja,oa))}yield x.visualVariableInteractiveUpdate(J,
Y,S,g._visualVariableAttributes,f);S=Y.attributes;u.isSome(g._visualVariableAttributes.rotation)&&({field:Y}=g._visualVariableAttributes.rotation,a.viewModel.featureFormViewModel.setValue(Y,S[Y]));u.isSome(g._visualVariableAttributes.size)&&({field:Y}=g._visualVariableAttributes.size,a.viewModel.featureFormViewModel.setValue(Y,S[Y]))});return function(S){return T.apply(this,arguments)}}()),m=z.on("delete",function(){var T=b._asyncToGenerator(function*(S){S=S.graphics[0];e.remove(g._lastActiveGraphics,
S);Q=S});return function(S){return T.apply(this,arguments)}}()),C=null,M=K.watch(()=>{const T=z.snappingOptions.featureSources.find(S=>S.layer===a.creationInfo.layer);return{hasFeatureLayerSource:!!T,enabled:T?.enabled??!1}},({hasFeatureLayerSource:T,enabled:S})=>{const Y=z.snappingOptions.featureSources;T?(u.isNone(C)&&(C=new l({layer:z.layer,enabled:S}),Y.add(C)),C.enabled=S):(u.isSome(C)&&Y.remove(C),C=u.destroyMaybe(C))},K.syncAndInitial),w=J.on("immediate-click",function(){var T=b._asyncToGenerator(function*(S){({results:S}=
yield J.hitTest(S,{include:z.layer}));if(S=S.find(Y=>"graphic"===Y.type))S=S.graphic,"transform"!==z.activeTool&&"reshape"!==z.activeTool||z.updateGraphics.getItemAt(0)===S||(yield g.updatePendingFeature(S,f))});return function(S){return T.apply(this,arguments)}}()),U=K.watch(()=>a.viewModel.attachmentsViewModel.mode,T=>{"add"===T&&a.viewModel.activeWorkflow.go("adding-attachment");"edit"===T&&a.viewModel.activeWorkflow.go("editing-attachment")});yield g._startCreating(f);v.add({remove:()=>{u.removeMaybe(g._featureFormHandle);
F.remove();R.remove();m.remove();M.remove();u.isSome(C)&&z.snappingOptions.featureSources.remove(C);C=u.destroyMaybe(C);z.cancel();w.remove();U.remove();u.removeMaybe(N)}},A.id)}}})()},tearDown(A){var J=this;return b._asyncToGenerator(function*(){A.cancelled&&(a.viewModel.sketchViewModel.layer.removeAll(),v.remove([J.id,G]),a.viewModel.attachmentsViewModel.fileInfos.removeAll(),g._attachmentFileInfos.clear(),a.viewModel.sketchViewModel.updateOnGraphicClick=D)})()}}),"adding-attachment":()=>({id:"adding-attachment",
parent:"creating-features",setUp(){return b._asyncToGenerator(function*(){})()},tearDown(){return b._asyncToGenerator(function*(){const {graphic:A,fileInfos:J}=a.viewModel.attachmentsViewModel;g._attachmentFileInfos.set(A,J.toArray());a.viewModel.attachmentsViewModel.mode="view"})()}}),"editing-attachment":()=>({id:"editing-attachment",parent:"creating-features",setUp(){return b._asyncToGenerator(function*(){})()},tearDown(){return b._asyncToGenerator(function*(){const {graphic:A,fileInfos:J}=a.viewModel.attachmentsViewModel;
g._attachmentFileInfos.set(A,J.toArray());a.viewModel.attachmentsViewModel.mode="view"})()}})});return x.avoidFeatureTemplateSelectionWithOnlyOneItem(a,c)};L._getAddAttachmentsData=function(g,c,a,v){const Q=[];c.forEach((D,f)=>{if(!D.error){const A=g[f];f=v.get(A)||[];A.attributes[a.objectIdField]=D.objectId;f.forEach(({form:J})=>Q.push({feature:A,attachment:J}))}});return Q};L._getAttachmentEditsWithGlobalIds=function(g,c,a){const v=[],Q=c.globalIdField;g.forEach((D,f)=>{const A=a.get(D)||[];let J=
D.attributes[Q];u.isNone(J)&&(J=E.generateUUID(),g[f].attributes[Q]=J);A.forEach(({file:z})=>v.push({feature:D,attachment:{globalId:E.generateUUID(),data:z}}))});return v.length?{addFeatures:g,addAttachments:v}:{addFeatures:g}};b._createClass(O,[{key:"numPendingFeatures",get:function(){return this.data.viewModel.sketchViewModel.layer.graphics.length}},{key:"pendingFeatures",get:function(){return this.data.viewModel.sketchViewModel.layer.graphics}},{key:"reliesOnOwnerAdminPrivileges",get:function(){const {layer:g}=
this.data.creationInfo,c=g.capabilities?.operations.supportsAdd,a=k.getEffectiveLayerCapabilities(g)?.operations.supportsAdd;return k.getEffectiveEditingEnabled(g)&&!g.editingEnabled||!!a&&!c}},{key:"shouldShowAttachments",get:function(){return this.data&&this.data.creationInfo&&this.data.viewModel?x.shouldShowAttachmentsForCreateWorkflow(this.data):!1}},{key:"shouldAllowAttachmentEditing",get:function(){return this.shouldShowAttachments}},{key:"helpMessage",get:function(){if("creating-features"===
this.stepId){var {creationInfo:g,viewModel:c}=this.data;return r.getDrawHelpMessage(g.layer.geometryType,c.sketchViewModel.createGraphic?.geometry)}}}]);return O}(B);n.__decorate([h.property()],t.prototype,"reliesOnOwnerAdminPrivileges",null);n.__decorate([h.property()],t.prototype,"shouldShowAttachments",null);n.__decorate([h.property()],t.prototype,"shouldAllowAttachmentEditing",null);n.__decorate([h.property()],t.prototype,"helpMessage",null);return t=y=n.__decorate([d.subclass("esri.widgets.Editor.CreateFeaturesWorkflow")],
t)})},"esri/views/draw/support/helpMessageUtils":function(){define(["exports","../../../core/maybe"],function(b,n){b.getDrawHelpMessage=function(e,H){switch(e){case "point":case "multipoint":return"point";case "polyline":return 2>(n.isSome(H)&&"polyline"===H.type&&H.paths.length?H.paths[0].length:0)?"polylineZeroVertices":"polylineOneVertex";case "polygon":return e=n.isSome(H)&&"polygon"===H.type&&H.rings.length?H.rings[0].length:0,3>e?"polylineZeroVertices":4>e?"polygonOneVertex":"polygonTwoVertices"}};
Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/FeatureSnappingLayerSource":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass".split(" "),function(b,n,e,H,u,K,E){e=function(h){function t(d){d=h.call(this,d)||this;d.layer=null;
d.enabled=!0;d.updating=!1;d.availability=1;return d}b._inheritsLoose(t,h);return t}(e);n.__decorate([H.property({constructOnly:!0})],e.prototype,"layer",void 0);n.__decorate([H.property()],e.prototype,"enabled",void 0);n.__decorate([H.property()],e.prototype,"updating",void 0);n.__decorate([H.property()],e.prototype,"availability",void 0);return e=n.__decorate([E.subclass("esri.views.interactive.snapping.FeatureSnappingLayerSource")],e)})},"esri/widgets/Editor/CreateFeaturesWorkflowData":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,n,e,H,u,K,E,h){b.CreateFeaturesWorkflowData=function(t){function d(k){k=t.call(this,k)||this;k.creationInfo=null;k.viewModel=null;return k}n._inheritsLoose(d,t);return d}(H);e.__decorate([u.property()],b.CreateFeaturesWorkflowData.prototype,"creationInfo",void 0);e.__decorate([u.property()],b.CreateFeaturesWorkflowData.prototype,"viewModel",void 0);b.CreateFeaturesWorkflowData=e.__decorate([h.subclass("esri.widgets.Editor.CreateFeaturesWorkflowData")],b.CreateFeaturesWorkflowData);Object.defineProperty(b,
Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/Workflow":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Error ../../core/Evented ../../core/HandleOwner ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass".split(" "),function(b,n,e,H,u,K,E,h,t){H=function(d){function k(l){l=d.call(this,l)||this;l._indexHistory=[];l._lastStepIndex=-1;l._stepIndex=
-1;l._handleKeys={afterCommit:"after-commit",beforeCommit:"before-commit"};l.data=void 0;l.started=!1;l.steps=[];l.type=null;return l}b._inheritsLoose(k,d);var r=k.prototype;r.cancel=function(){var l=b._asyncToGenerator(function*(p={force:!0}){return!1!==p.force?this._cancel():new Promise((B,x)=>{this.emit("cancel-request",{controller:{allow:()=>{this._cancel().then(B)},deny:()=>x(new e("workflow:cancel-denied","Request to cancel workflow was denied."))}})})});return function(){return l.apply(this,
arguments)}}();r.commit=function(){var l=b._asyncToGenerator(function*(){this.handles.remove(this._handleKeys.beforeCommit);yield this.onCommit(this.data);this.handles.remove(this._handleKeys.afterCommit);this.emit("commit");this.started&&(yield this.reset())});return function(){return l.apply(this,arguments)}}();r.go=function(){var l=b._asyncToGenerator(function*(p){var {steps:B}=this;B=B.findIndex(x=>x.id===p);this._indexHistory.push(this._stepIndex);yield this._go(B)});return function(p){return l.apply(this,
arguments)}}();r.next=function(){var l=b._asyncToGenerator(function*(){this._indexHistory.push(this._stepIndex);yield this._go(this._stepIndex+1)});return function(){return l.apply(this,arguments)}}();r.previous=function(){var l=b._asyncToGenerator(function*(p={cancelCurrentStep:!1}){yield this._go(this._indexHistory.pop(),p.cancelCurrentStep)});return function(){return l.apply(this,arguments)}}();r.reset=function(){var l=b._asyncToGenerator(function*(){yield this._cancel(!1);yield this.start()});
return function(){return l.apply(this,arguments)}}();r.start=function(){var l=b._asyncToGenerator(function*(){this._set("started",!0);yield this._go(-1===this._stepIndex?0:this._stepIndex)});return function(){return l.apply(this,arguments)}}();r._cancel=function(){var l=b._asyncToGenerator(function*(p=!0){this.started&&(this._set("started",!1),yield this.steps[this._stepIndex].tearDown({cancelled:!0}),this.data&&this.data.viewModel.sketchViewModel.layer.removeAll());this.handles.remove([this._handleKeys.afterCommit,
this._handleKeys.beforeCommit]);this._resetIndexing(p);p&&this.emit("cancel")});return function(){return l.apply(this,arguments)}}();r._go=function(){var l=b._asyncToGenerator(function*(p=-1,B=!1){-1>=p||p>=this.steps.length||(this.started&&(-1<this._lastStepIndex&&(yield this.steps[this._lastStepIndex].tearDown({cancelled:B})),yield this.steps[p].setUp(),this._lastStepIndex=p),this._stepIndex=p,this._notifyStepProps())});return function(){return l.apply(this,arguments)}}();r._resetIndexing=function(l=
!0){this._lastStepIndex=this._stepIndex=-1;this._indexHistory.length=0;l&&this._notifyStepProps()};r._notifyStepProps=function(){this.notifyChange("stepId");this.notifyChange("hasPreviousStep");this.notifyChange("hasNextStep")};b._createClass(k,[{key:"hasNextStep",get:function(){const {steps:l}=this;return!!(l&&this._stepIndex<l.filter(p=>!p.parent).length-1)}},{key:"hasPreviousStep",get:function(){return 0<this._stepIndex}},{key:"reliesOnOwnerAdminPrivileges",get:function(){return!1}},{key:"shouldShowAttachments",
get:function(){return!1}},{key:"shouldAllowAttachmentEditing",get:function(){return!1}},{key:"stepId",get:function(){var {steps:l}=this;return(l=l&&l[this._stepIndex])&&l.id}},{key:"helpMessage",get:function(){}}]);return k}(u.HandleOwnerMixin(H.EventedAccessor));n.__decorate([K.property()],H.prototype,"data",void 0);n.__decorate([K.property()],H.prototype,"hasNextStep",null);n.__decorate([K.property()],H.prototype,"hasPreviousStep",null);n.__decorate([K.property()],H.prototype,"onCommit",void 0);
n.__decorate([K.property()],H.prototype,"reliesOnOwnerAdminPrivileges",null);n.__decorate([K.property()],H.prototype,"shouldShowAttachments",null);n.__decorate([K.property()],H.prototype,"shouldAllowAttachmentEditing",null);n.__decorate([K.property()],H.prototype,"started",void 0);n.__decorate([K.property({readOnly:!0})],H.prototype,"stepId",null);n.__decorate([K.property()],H.prototype,"steps",void 0);n.__decorate([K.property({readOnly:!0})],H.prototype,"type",void 0);n.__decorate([K.property()],
H.prototype,"helpMessage",null);n.__decorate([K.property()],H.prototype,"commit",null);return H=n.__decorate([t.subclass("esri.widgets.Editor.Workflow")],H)})},"esri/widgets/Editor/workflowUtils":function(){define("require exports ../../chunks/_rollupPluginBabelHelpers ../../Graphic ../../core/has ../../core/handleUtils ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/screenUtils ../../core/accessorSupport/diffUtils ../../renderers/support/clickToleranceUtils ../../renderers/support/lengthUtils ../../renderers/visualVariables/support/sizeVariableUtils ../../renderers/visualVariables/support/visualVariableUtils ../../symbols/support/symbolConversion ../../symbols/support/symbolUtils ../../views/3d/layers/graphics/GraphicState ../../views/support/drapedUtils ../../views/support/hitTestSelectUtils".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k,r,l,p,B,x,y,G,P,O){function L(Z){const da=Z.sourceLayer;var fa;if(!(fa=!da||"feature"!==da.type)){a:switch(da.renderer?.type){case "class-breaks":case "simple":case "unique-value":case "dot-density":case "dictionary":case "pie-chart":fa=!0;break a;default:fa=!1}fa=!fa}if(fa)return{rotation:null,size:null};let X=fa=null;var aa=da.renderer.getVisualVariablesForType("rotation").filter(ea=>(!ea.axis||"heading"===ea.axis)&&ea.field&&!ea.valueExpression&&E.isSome(B.getRotationAngle(ea,
Z)));1===aa.length&&(fa=g(aa[0],da));aa=da.renderer.getVisualVariablesForType("size").filter(ea=>ea.field&&!ea.useSymbolValue&&!ea.valueExpression&&p.getTransformationType(ea)===p.TransformationType.RealWorldSize&&E.isSome(B.getSize(ea,Z)));1===aa.length&&(X=Q(aa[0],da));return{rotation:fa,size:X}}function g(Z,da){const fa="heading"===(Z.axis||"heading")&&"arithmetic"===Z.rotationType?-1:1,X=Z.field,aa=(da=da.fields&&da.fields.filter(ia=>ia.name===X))&&1===da.length?da[0].type:"double";var ea=0,ba=
0;return{field:X,fieldType:aa,getDefault:()=>Promise.resolve(0),getValue:ia=>{ba=ea-fa*ia;return D((ba+360)%360,aa)},initValue:ia=>{ea=null!=ia?ia:ba;ba=0},isUpdatingInteractively:!1,rotationType:Z.rotationType??"geographic"}}function c(Z,da){switch(da){case "width":return Z[0];case "depth":return Z[1];case "height":return Z[2];default:return Z[2]||Z[1]||Z[0]}}function a(Z,da,fa){return v.apply(this,arguments)}function v(){v=e._asyncToGenerator(function*(Z,da,fa){if(E.isNone(da))return 0;({symbol:da}=
x.to3D(da));if(E.isNone(da)||"web-style"===da.type||"cim"===da.type)return 0;da=da.symbolLayers.getItemAt(0);if(!da)return 0;switch(da.type){case "icon":return{computeIconLayerResourceSize:fa}=yield new Promise((aa,ea)=>b(["../../symbols/support/symbolLayerUtils"],aa,ea)),da.size||Math.min(ua.icon,(yield fa(da,ua.icon))[0])||ua.icon;case "text":return da.size||ua.text;case "line":return da.size||ua.line;case "object":const {computeObjectLayerResourceSize:X}=yield new Promise((aa,ea)=>b(["../../symbols/support/symbolLayerUtils"],
aa,ea));Z=yield X(da,Z.scale/ua.viewScaleSizeFactor);return c(Z,fa);case "path":return(null!=da.width?da.width:da.height)||Z.scale/ua.viewScaleSizeFactor;case "extrude":return da.size||Z.scale/ua.viewScaleSizeFactor;case "fill":case "water":return 0;default:return 0}});return v.apply(this,arguments)}function Q(Z,da){const fa=Z.field,X=Z.axis,aa=(da=da.fields&&da.fields.filter(ka=>ka.name===fa))&&1===da.length?da[0].type:"double";var ea=0,ba=0;const ia=l.meterIn[Z.valueUnit]??1;let ma;ma="area"===
Z.valueRepresentation?ka=>(ka*ia/2)**2*Math.PI:"radius"===Z.valueRepresentation||"distance"===Z.valueRepresentation?ka=>ka*ia/2:ka=>ka*ia;return{field:fa,fieldType:aa,getDefault:function(){var ka=e._asyncToGenerator(function*(qa,xa){return D(ma(yield a(xa,qa,X)),aa)});return function(qa,xa){return ka.apply(this,arguments)}}(),getValue:(ka,qa)=>{ea||(ea=qa.pixelSizeAt(qa.center));ba=ea*ka;return D(ba,aa)},initValue:ka=>{ea=null!=ka?ka:ba;ba=0},isUpdatingInteractively:!1,displayUnit:ta(Z.valueUnit),
axis:Z.axis}}function D(Z,da){switch(da){case "small-integer":case "integer":case "long":return Math.round(Z);case "double":case "single":return Z;default:return 0}}function f(Z,da){return A.apply(this,arguments)}function A(){A=e._asyncToGenerator(function*(Z,da){da=yield y.getDisplayedSymbol(Z,{useSourceLayer:!0,ignoreGraphicSymbol:!0,webStyleCache:da});const fa=k.diff(Z.symbol,da);E.isSome(fa)&&(Z.symbol=da)});return A.apply(this,arguments)}function J(){J=e._asyncToGenerator(function*(Z,da,fa,X){yield z(Z,
da,X);const aa=Z.on("create",function(){var ea=e._asyncToGenerator(function*(ba){if("cancel"===ba.state)return z(Z,da,X);"complete"===ba.state&&(ba=ba.graphic,ba.sourceLayer||(ba.sourceLayer=da.layer),ba.attributes||(ba.attributes={...da.template.prototype.attributes}),yield f(ba,X),fa(ba))});return function(ba){return ea.apply(this,arguments)}}());return{remove:()=>{aa.remove();Z.cancel()}}});return J.apply(this,arguments)}function z(Z,da,fa){return N.apply(this,arguments)}function N(){N=e._asyncToGenerator(function*(Z,
da,fa){var X=da.layer;da={...da.template.prototype.attributes};yield F(Z,X,da,fa);fa={graphicProperties:{attributes:da,sourceLayer:X},hasZ:X.capabilities.data.supportsZ};Z.layer.elevationInfo=X.elevationInfo;da=Z.create;X=X.geometryType;if(!X)throw Error("no geometry type");if("mesh"===X||"multipatch"===X)throw Error("Mesh and Multipatch not supported");return da.call(Z,X,fa)});return N.apply(this,arguments)}function F(Z,da,fa,X){return R.apply(this,arguments)}function R(){R=e._asyncToGenerator(function*(Z,
da,fa,X){da=new H({sourceLayer:da,attributes:fa});const {rotation:aa,size:ea}=L(da);let ba=yield y.getDisplayedSymbol(da,{useSourceLayer:!0,webStyleCache:X}),ia=!1;for(const ma of[ea,aa])E.isNone(ma)||null!=fa[ma.field]||(fa[ma.field]=yield ma.getDefault(ba,Z.view),ia=!0);ia&&(ba=yield y.getDisplayedSymbol(da,{useSourceLayer:!0,webStyleCache:X}));switch(ba?.type){case "simple-fill":case "polygon-3d":Z.polygonSymbol=ba;break;case "simple-line":case "line-3d":Z.polylineSymbol=ba;break;case "simple-marker":case "picture-marker":case "point-3d":case "cim":Z.pointSymbol=
ba}m(Z.tooltipOptions,ea,aa)});return R.apply(this,arguments)}function m(Z,da,fa){E.isSome(da)||E.isSome(fa)?Z.visualVariables={size:E.isSome(da)?{unit:da.displayUnit,axis:da.axis,valueType:da.fieldType}:null,rotation:E.isSome(fa)?{valueType:fa.fieldType,rotationType:fa.rotationType??"geographic"}:null}:Z.visualVariables=null}function C(Z,da,fa,X){return M.apply(this,arguments)}function M(){M=e._asyncToGenerator(function*(Z,da,fa,X){if(0===Z.length)return[];const {updatable:aa,graphicsByLayer:ea}=
yield fa.async(e._asyncToGenerator(function*(){var {results:ba}=yield h.whenOrAbort(O.hitTestSelectSimilarDistance(da,fa),X);const ia=new Map;O.filterGraphicHits(ba).forEach(({graphic:ma})=>{var ka=ma.layer;var qa=ia.get(ka);qa?ka=qa:(qa=[],ia.set(ka,qa),ka=qa);return ka.push(ma)});ba=Z.filter(({supports:ma,layer:ka})=>ma.includes("update")&&ia.has(ka));0!==ba.length&&fa.stopPropagation();return{updatable:ba,graphicsByLayer:ia}}));return h.whenOrAbort(h.eachAlways(aa.map(function(){var ba=e._asyncToGenerator(function*({layer:ia}){var {objectIdField:ma}=
ia,ka="displayField"in ia?ia.displayField:null;const qa=[ma];null!=ka&&ia.fieldsIndex.has(ka)&&qa.push(ka);ma=ea.get(ia);return ma.some(xa=>qa.some(ya=>!(ya in xa.attributes)))?(ka=ia.createQuery(),ka.outFields=qa,ka.returnGeometry=!1,ka.objectIds=ma.map(xa=>xa.getObjectId()),ia.queryFeatures(ka,{signal:X}).then(({features:xa})=>xa)):ma});return function(ia){return ba.apply(this,arguments)}}())),X)});return M.apply(this,arguments)}function w(Z,da,fa,X){return U.apply(this,arguments)}function U(){U=
e._asyncToGenerator(function*(Z,da,fa,X){if(0===Z.length)return[];let aa=null;const ea=yield fa.async(e._asyncToGenerator(function*(){var {results:ba}=yield h.whenOrAbort(da.hitTest(fa),X);if(0===ba.length)return[];const ia=new Set;aa=O.filterGraphicHits(ba);aa.forEach(({graphic:ma})=>ma&&ia.add(ma.layer));ba=Z.items.filter(({layer:ma,supports:ka,attachmentsOnUpdateEnabled:qa})=>ia.has(ma)&&(ka.includes("update")||ka.includes("delete")||qa));0<ba.length&&fa.stopPropagation();return ba}));return h.whenOrAbort(h.eachAlways(ea.map(({layer:ba})=>
{var ia="displayField"in ba?ba.displayField:null,ma=[ba.objectIdField];null!=ia&&ba.fieldsIndex.has(ia)&&ma.push(ia);ia=ba.createQuery();ia.outFields=ma;ia.returnGeometry=!1;ma="renderer"in ba?r.calculateTolerance({renderer:ba.renderer,event:fa}):0;ia.geometry=P.createQueryGeometry(fa.mapPoint,ma,da);ia.outSpatialReference=da.spatialReference;return ba.queryFeatures(ia,{signal:X}).then(({features:ka})=>{aa?.forEach(({graphic:qa})=>{qa.layer!==ba||ka.some(xa=>xa.getObjectId()===qa.getObjectId())||
ka.push(qa)});return ka})})),X)});return U.apply(this,arguments)}function T(){T=e._asyncToGenerator(function*(Z,da,fa,X){switch(da.type){case "3d":return C(Z,da,fa,X);case "2d":return w(Z,da,fa,X)}});return T.apply(this,arguments)}function S(){S=e._asyncToGenerator(function*(Z,da,fa){const {sourceLayer:X}=Z,aa=X.createQuery();aa.objectIds=[Z.getAttribute(X.objectIdField)];aa.outFields=["*"];aa.outSpatialReference=da.spatialReference;aa.returnM=X.capabilities.data.supportsM;aa.returnZ=X.capabilities.data.supportsZ;
return(yield X.queryFeatures(aa,{signal:fa})).features[0]});return S.apply(this,arguments)}function Y(Z,da,fa,X,aa){return ha.apply(this,arguments)}function ha(){ha=e._asyncToGenerator(function*(Z,da,fa,X,aa){let ea=!1;const {rotation:ba,size:ia}=X;[ba,ia].forEach(function(){var ma=e._asyncToGenerator(function*(ka){if(!E.isNone(ka)){var qa=da.attributes[ka.field];E.isSome(qa)?ka.initValue(qa):(qa=yield ka.getDefault(da.symbol,Z.view),ka.initValue(qa),da.setAttribute(ka.field,qa),ea=!0)}});return function(ka){return ma.apply(this,
arguments)}}());ea&&(yield f(da,aa));X={multipleSelectionEnabled:!1};"point"===fa.geometryType&&(X.enableRotation=E.isSome(ba),X.enableScaling=E.isSome(ia));m(Z.tooltipOptions,ia,ba);Z.layer.elevationInfo=fa.elevationInfo;return Z.update(da,X)});return ha.apply(this,arguments)}function ja(Z,da,fa,X,aa){return oa.apply(this,arguments)}function oa(){oa=e._asyncToGenerator(function*(Z,da,fa,X,aa){if(E.isSome(da.geometry)&&"point"===da.geometry?.type){var ea=X.rotation;var ba=fa.toolEventInfo;ba=!E.isSome(ba)||
"rotate-start"!==ba.type&&"rotate"!==ba.type&&"rotate-stop"!==ba.type?null:ba;if(E.isSome(ea)&&E.isSome(ba))if("rotate-stop"===ba.type)ea.isUpdatingInteractively=!1,ea.initValue();else{ea.isUpdatingInteractively=!0;const {field:ia,getValue:ma}=ea;da.attributes[ia]=ma(ba.angle,Z)}X=X.size;fa=fa.toolEventInfo;fa=!E.isSome(fa)||"scale-start"!==fa.type&&"scale"!==fa.type&&"scale-stop"!==fa.type?null:fa;if(E.isSome(X)&&E.isSome(fa))if("scale-stop"===fa.type)X.isUpdatingInteractively=!1,X.initValue();else{X.isUpdatingInteractively=
!0;const {field:ia,getValue:ma}=X;da.attributes[ia]=ma(fa.xScale,Z)}yield f(da,aa)}});return oa.apply(this,arguments)}function ra(){ra=e._asyncToGenerator(function*(Z,da,fa,X,aa,ea){const ba=Z.clone();yield f(ba,ea);X.map.add(fa.layer);fa.layer.add(ba);const ia=Z.sourceLayer,ma=Aa(X,ia),ka=()=>{const Pa=Z.attributes[Z.layer.objectIdField];ma.then(Ja=>Ja.setVisibility?.(Pa,!1),()=>{});return{remove(){ma.then(Ja=>Ja.setVisibility?.(Pa,!0),()=>{})}}};let qa=null,xa=null;if("3d"===X.type){const Pa=new G.GraphicState({graphic:ba});
qa=K.handlesGroup([X.trackGraphicState(Pa),t.watch(()=>Pa.displaying,Ja=>{xa=Ja?ka():E.removeMaybe(xa)},t.initial)])}else xa=ka();yield Y(fa,ba,ia,da,ea);let ya=null;ma.then(Pa=>ya=Pa,()=>{});const wa=da.size,sa=da.rotation,za=t.watch(()=>Z.attributes,function(){var Pa=e._asyncToGenerator(function*(Ja){let Ka=!1;for(const La in Ja){const pa=Ja[La];pa!==ba.attributes[La]&&(ba.setAttribute(La,pa),E.isSome(wa)&&!wa.isUpdatingInteractively&&wa.field===La&&wa.initValue(pa),E.isSome(sa)&&!sa.isUpdatingInteractively&&
sa.field===La&&sa.initValue(pa),E.isNone(ya)||ya.requiredFields.includes(La))&&(Ka=!0)}Ka&&(yield f(ba,ea))});return function(Ja){return Pa.apply(this,arguments)}}()),Ba=fa.on("update",function(){var Pa=e._asyncToGenerator(function*(Ja){const Ka=Ja.graphics[0];if("complete"===Ja.state)return Y(fa,Ka,ia,da,ea);yield ja(X,Ka,Ja,da,ea);aa(Ka.clone(),Ja)});return function(Ja){return Pa.apply(this,arguments)}}()),Ea=fa.on(["undo","redo"],function(){var Pa=e._asyncToGenerator(function*(Ja){aa(Ja.graphics[0].clone(),
Ja)});return function(Ja){return Pa.apply(this,arguments)}}()),Ma=()=>{};return{interactive:{remove(){Ea.remove();Ba.remove();fa.cancel();za&&za.remove();this.remove=Ma}},visual:{remove(){E.removeMaybe(xa);Aa(X,ia).then(Pa=>t.whenOnce(()=>!Pa.updating)).then(()=>{E.removeMaybe(qa);fa.layer.remove(ba);this.remove=Ma})}}}});return ra.apply(this,arguments)}function ta(Z){switch(Z){case "unknown":case "decimal-degrees":return null;default:return Z}}const ua={icon:d.px2pt(24),text:d.px2pt(12),line:d.px2pt(1),
viewScaleSizeFactor:100},Aa=(Z,da)=>Z.whenLayerView("subtype-sublayer"===da.type?da.parent:da);n.avoidFeatureTemplateSelectionWithOnlyOneItem=function(Z,da){Z.viewModel.refreshCreationTemplates();if("awaiting-feature-creation-info"===da[0].id){var fa=Z.viewModel.featureTemplatesViewModel.items;1!==fa.length?fa=null:(fa=fa[0],fa="items"in fa?1===fa.items.length?fa.items[0]:null:fa);E.isSome(fa)&&(Z.creationInfo=fa,da.shift())}return da};n.createWorkflowSteps=function(Z,da,fa){let X=!1;return Z.filter(aa=>
X?!0:X=aa===da).map(aa=>fa[aa]())};n.fetchCandidates=function(Z,da,fa,X){return T.apply(this,arguments)};n.fetchFullFeature=function(Z,da,fa){return S.apply(this,arguments)};n.findLayerInfo=function(Z,da){return Z?Z.find(fa=>fa.layer===da):void 0};n.getVisualVariableAttributes=L;n.isTerminalUpdateEventType=Z=>/-stop/.test(Z)||/vertex-/.test(Z);n.prepareAttachmentsForCreateWorkflow=function(Z){Z.set({abilities:{editing:!0,operations:{add:!0,update:!0,delete:!0}},filesEnabled:!0,mode:"view"})};n.setUpFeatureAdd=
function(Z,da,fa,X){return J.apply(this,arguments)};n.setUpGeometryUpdate=function(Z,da,fa,X,aa,ea){return ra.apply(this,arguments)};n.shouldShowAttachmentsForCreateWorkflow=function(Z){const {creationInfo:{layer:da},viewModel:fa}=Z;if(Z=fa.editableItems.find(aa=>aa.layer===da))return Z.attachmentsOnCreateEnabled;Z=da.capabilities?.data;const X=fa.layerInfos?.find(aa=>aa.layer===da);return!(!(Z&&"supportsAttachment"in Z&&Z.supportsAttachment)||X&&(!1===X.allowAttachments||!1===X.attachmentsOnUpdateEnabled))};
n.sizeDefaults=ua;n.sizeVariableUnitToLengthUnit=ta;n.startCreatingNewFeature=z;n.startUpdatingFeature=Y;n.updateGraphicSymbolWhenRequired=f;n.visualVariableInteractiveUpdate=ja;n.whenEditorLayerView=Aa;Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/clickToleranceUtils":function(){define(["exports"],function(b){function n(u,K){return K?"xoffset"in K&&K.xoffset?Math.max(u,Math.abs(K.xoffset)):"yoffset"in K&&K.yoffset?Math.max(u,Math.abs(K.yoffset||0)):u:u}function e(u,
K){if("number"===typeof u)return u;if(u&&u.stops&&u.stops.length){u=u.stops;let E=K=0;for(let h=0;h<u.length;h++){const t=u[h].size;"number"===typeof t&&(K+=t,E++)}return K/E}return K}function H(u,K){if(!K)return u;K=K.filter(t=>"size"===t.type).map(t=>{const {maxSize:d,minSize:k}=t;return(e(d,u)+e(k,u))/2});let E=0;const h=K.length;if(0===h)return u;for(let t=0;t<h;t++)E+=K[t];return Math.max(Math.floor(E/h),u)}b.calculateTolerance=function(u){const K=u&&u.renderer;u="touch"===(u&&u.event&&u.event.pointerType)?
9:6;if(!K)return u;u="visualVariables"in K?H(u,K.visualVariables):u;if("simple"===K.type)return n(u,K.symbol);if("unique-value"===K.type){let E=u;K.uniqueValueInfos?.forEach(h=>{E=n(E,h.symbol)});return E}if("class-breaks"===K.type){let E=u;K.classBreakInfos.forEach(h=>{E=n(E,h.symbol)});return E}return u};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/layers/graphics/GraphicState":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Evented ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/accessorSupport/decorators/subclass".split(" "),
function(b,n,e,H,u,K,E,h){b.GraphicState=function(t){function d(k){k=t.call(this,k)||this;k.tracking=!1;k.displaying=!1;k.isDraped=!1;return k}n._inheritsLoose(d,t);return d}(H.EventedAccessor);e.__decorate([u.property({constructOnly:!0})],b.GraphicState.prototype,"graphic",void 0);e.__decorate([u.property()],b.GraphicState.prototype,"tracking",void 0);e.__decorate([u.property()],b.GraphicState.prototype,"displaying",void 0);e.__decorate([u.property()],b.GraphicState.prototype,"isDraped",void 0);
b.GraphicState=e.__decorate([h.subclass("esri.views.3d.layers.graphics.GraphicState")],b.GraphicState);Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/drapedUtils":function(){define("exports ../../geometry ../../core/maybe ../../core/unitUtils ../../renderers/support/clickToleranceUtils ../../geometry/Extent".split(" "),function(b,n,e,H,u,K){function E(t,d,k,r=new K){let l=0;if("2d"===k.type)l=d*(k.resolution??0);else if("3d"===k.type){var p=k.overlayPixelSizeInMapUnits(t),
B=k.basemapSpatialReference;l=e.isSome(B)&&!B.equals(k.spatialReference)?H.getMetersPerUnitForSR(B)/H.getMetersPerUnitForSR(k.spatialReference):d*p}d=t.x-l;p=t.y-l;B=t.x+l;t=t.y+l;({spatialReference:k}=k);r.xmin=Math.min(d,B);r.ymin=Math.min(p,t);r.xmax=Math.max(d,B);r.ymax=Math.max(p,t);r.spatialReference=k;return r}const h=new K;b.createQueryGeometry=E;b.intersectsDrapedGeometry=function(t,d,k){t=k.toMap(t);if(e.isNone(t))return!1;const r=u.calculateTolerance();return E(t,r,k,h).intersects(d)};
Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/hitTestSelectUtils":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../core/maybe"],function(b,n,e){function H(){H=n._asyncToGenerator(function*(K,E){if("2d"===K.type)return K.hitTest(E);K=yield K.hitTest(E);if(0===K.results.length)return K;const h=1.05*(e.unwrap(K.results[0].distance)??0);E=K.results.findIndex(t=>(t.distance??0)>h);-1!==E&&(K.results=K.results.slice(0,E));return K});return H.apply(this,
arguments)}function u(K){return e.isSome(K)&&"graphic"===K.type}b.filterGraphicHits=function(K){return K.filter(u)};b.findFirstGraphicHit=function(K){return K.find(u)??null};b.hitTestSelectSimilarDistance=function(K,E){return H.apply(this,arguments)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/CreateWorkflow":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass ../../layers/support/layerUtils ../../views/draw/support/helpMessageUtils ./CreateWorkflowData ./Edits ./Workflow ./workflowUtils".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k,r,l,p){var B;K=B=function(x){function y(G){G=x.call(this,G)||this;G.type="create";return G}b._inheritsLoose(y,x);y.create=function(G,P,O){G=new B({data:new k({edits:new r.Edits,viewModel:G}),onCommit:function(){var L=b._asyncToGenerator(function*(g){yield O(g.creationInfo.layer,{addFeatures:[g.edits.feature]})});return function(g){return L.apply(this,arguments)}}()});G._set("steps",this._createWorkflowSteps(G,P));return G};y._createWorkflowSteps=function(G,P="awaiting-feature-creation-info"){const {data:O,
handles:L}=G,g=new Map;G=p.createWorkflowSteps(["awaiting-feature-creation-info","awaiting-feature-to-create","editing-new-feature","adding-attachment","editing-attachment"],P,{"awaiting-feature-creation-info":()=>({id:"awaiting-feature-creation-info",setUp(){var c=this;return b._asyncToGenerator(function*(){O.creationInfo=null;O.edits.feature=null;O.viewModel.featureTemplatesViewModel.select(null);L.add(O.viewModel.featureTemplatesViewModel.on("select",({item:a})=>{a&&(O.creationInfo=a,O.viewModel.activeWorkflow?.next())}),
c.id)})()},tearDown(){var c=this;return b._asyncToGenerator(function*(){L.remove(c.id)})()}}),"awaiting-feature-to-create":()=>({id:"awaiting-feature-to-create",setUp(){var c=this;return b._asyncToGenerator(function*(){L.add(yield p.setUpFeatureAdd(O.viewModel.sketchViewModel,O.creationInfo,a=>{O.edits.feature=a;O.viewModel.activeWorkflow?.next()},g),c.id)})()},tearDown(){var c=this;return b._asyncToGenerator(function*(){L.remove(c.id)})()}}),"editing-new-feature":()=>({id:"editing-new-feature",setUp(){var c=
this;return b._asyncToGenerator(function*(){const a=O.edits.feature,v=a.sourceLayer,Q=O.viewModel,D=Q.sketchViewModel;var f=p.findLayerInfo(Q.layerInfos,v);const {spatialReference:A}=Q.view;Q.featureFormViewModel.set({arcadeEditType:"INSERT",feature:a,formTemplate:f?.formTemplate,spatialReference:A});D.allowDeleteKey=!1;p.prepareAttachmentsForCreateWorkflow(Q.attachmentsViewModel);const J=p.getVisualVariableAttributes(a);yield p.startUpdatingFeature(D,a,v,J,g);f=D.on("update",function(){var z=b._asyncToGenerator(function*(N){var F=
N.graphics[0];if("complete"===N.state)return p.startUpdatingFeature(D,F,v,J,g);yield p.visualVariableInteractiveUpdate(D.view,F,N,J,g);N=F.attributes;e.isSome(J.rotation)&&({field:F}=J.rotation,Q.featureFormViewModel.setValue(F,N[F]));e.isSome(J.size)&&({field:F}=J.size,Q.featureFormViewModel.setValue(F,N[F]))});return function(N){return z.apply(this,arguments)}}());L.add([O.viewModel.featureFormViewModel.on("value-change",b._asyncToGenerator(function*(){O.edits.updateAttributes(O.viewModel.featureFormViewModel.getValues());
a.attributes=O.edits.feature.attributes;"3d"===D.view.type&&(yield p.updateGraphicSymbolWhenRequired(a,g))})),f,H.watch(()=>O.viewModel.attachmentsViewModel.mode,z=>{"add"===z&&O.viewModel.activeWorkflow.go("adding-attachment");"edit"===z&&O.viewModel.activeWorkflow.go("editing-attachment")})],c.id)})()},tearDown(c){var a=this;return b._asyncToGenerator(function*(){c.cancelled&&O.viewModel.sketchViewModel.layer.removeAll();L.remove(a.id)})()}}),"adding-attachment":()=>({id:"adding-attachment",parent:"editing-new-feature",
setUp(){return b._asyncToGenerator(function*(){})()},tearDown(){return b._asyncToGenerator(function*(){O.viewModel.attachmentsViewModel.mode="view"})()}}),"editing-attachment":()=>({id:"editing-attachment",parent:"editing-new-feature",setUp(){return b._asyncToGenerator(function*(){})()},tearDown(){return b._asyncToGenerator(function*(){O.viewModel.attachmentsViewModel.mode="view"})()}})});return p.avoidFeatureTemplateSelectionWithOnlyOneItem(O,G)};b._createClass(y,[{key:"shouldShowAttachments",get:function(){return this.data&&
this.data.creationInfo&&this.data.viewModel?p.shouldShowAttachmentsForCreateWorkflow(this.data):!1}},{key:"shouldAllowAttachmentEditing",get:function(){return this.shouldShowAttachments}},{key:"helpMessage",get:function(){if("editing-new-feature"===this.stepId){var {creationInfo:G,viewModel:P}=this.data;return d.getDrawHelpMessage(G.layer.geometryType,P.sketchViewModel.createGraphic?.geometry)}}},{key:"reliesOnOwnerAdminPrivileges",get:function(){const {layer:G}=this.data.creationInfo,P=G.capabilities?.operations.supportsAdd,
O=t.getEffectiveLayerCapabilities(G)?.operations.supportsAdd;return t.getEffectiveEditingEnabled(G)&&!G.editingEnabled||!!O&&!P}}]);return y}(l);n.__decorate([u.property()],K.prototype,"shouldShowAttachments",null);n.__decorate([u.property()],K.prototype,"shouldAllowAttachmentEditing",null);n.__decorate([u.property()],K.prototype,"helpMessage",null);n.__decorate([u.property()],K.prototype,"reliesOnOwnerAdminPrivileges",null);return K=B=n.__decorate([h.subclass("esri.widgets.Editor.CreateWorkflow")],
K)})},"esri/widgets/Editor/CreateWorkflowData":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass".split(" "),function(b,n,e,H,u,K,E){e=function(h){function t(d){d=h.call(this,d)||this;d.creationInfo=null;d.edits=null;d.viewModel=null;return d}b._inheritsLoose(t,h);return t}(e);n.__decorate([H.property()],
e.prototype,"creationInfo",void 0);n.__decorate([H.property()],e.prototype,"edits",void 0);n.__decorate([H.property()],e.prototype,"viewModel",void 0);return e=n.__decorate([E.subclass("esri.widgets.Editor.CreateWorkflowData")],e)})},"esri/widgets/Editor/Edits":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/HandleOwner ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,n,e,H,u,K,E,h,t,d){function k(r){return K.isNone(r)?null:JSON.stringify(r)}b.Edits=function(r){function l(B){B=r.call(this,B)||this;B._baselineAttributesJSON=null;B._baselineGeometryJSON=null;B.feature=null;return B}n._inheritsLoose(l,r);var p=l.prototype;p.trackChanges=function(){this.feature&&(this._baselineAttributesJSON=k(this.feature.attributes),this._baselineGeometryJSON=k(this.feature.geometry),this.notifyChange("attributesModified"),this.notifyChange("geometryModified"))};p.updateAttributes=
function(B){const {feature:x}=this;x&&(x.attributes=B,this.notifyChange("attributesModified"))};p.updateGeometry=function(B){const {feature:x}=this;x&&(x.geometry=B,this.notifyChange("geometryModified"))};n._createClass(l,[{key:"attributesModified",get:function(){const {_baselineAttributesJSON:B,feature:x}=this;return!(!x||B===k(x.attributes))}},{key:"geometryModified",get:function(){const {_baselineGeometryJSON:B,feature:x}=this;return!(!x||B===k(x.geometry))}},{key:"modified",get:function(){return this.attributesModified||
this.geometryModified}}]);return l}(u.HandleOwnerMixin(H));e.__decorate([E.property()],b.Edits.prototype,"attributesModified",null);e.__decorate([E.property()],b.Edits.prototype,"feature",void 0);e.__decorate([E.property()],b.Edits.prototype,"geometryModified",null);e.__decorate([E.property()],b.Edits.prototype,"modified",null);b.Edits=e.__decorate([d.subclass("esri.widgets.Editor.Edits")],b.Edits);Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/UpdateWorkflow":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/handleUtils ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass ../../layers/support/layerUtils ../../views/support/layerViewUtils ./Edits ./UpdateWorkflowData ./Workflow ./workflowUtils".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k,r,l,p,B,x){var y;h=y=function(G){function P(L){L=G.call(this,L)||this;L.type="update";return L}b._inheritsLoose(P,G);P.create=function(L,g,c){L=new y({data:new p({edits:new l.Edits,viewModel:L}),onCommit:function(){var a=b._asyncToGenerator(function*(v){const Q=v.edits.feature;if(Q){var D=Q.sourceLayer,f=Q.clone();if(!v.edits.attributesModified){const A=D.objectIdField;f.attributes={[A]:Q.getAttribute(A)}}v.edits.geometryModified||(f.geometry=null);yield c(D,{updateFeatures:[f]})}});
return function(v){return a.apply(this,arguments)}}()});L._set("steps",this._createWorkflowSteps(L,g));return L};var O=P.prototype;O.highlight=function(L){var g=this.data.viewModel.view;g&&L&&(g=L&&g.allLayerViews.items.find(({layer:c})=>c===L.layer||"subtype-sublayer"===L.layer.type&&L.layer.parent===c),r.highlightsSupported(g)&&this.handles.add(g.highlight(L),"candidate-highlight"))};O.unhighlight=function(){this.handles.remove("candidate-highlight")};P._createWorkflowSteps=function(L,g="awaiting-feature-to-update"){const {data:c,
handles:a}=L,v=new Map;return x.createWorkflowSteps(["awaiting-feature-to-update","awaiting-update-feature-candidate","editing-existing-feature","adding-attachment","editing-attachment"],g,{"awaiting-feature-to-update":()=>({id:"awaiting-feature-to-update",setUp(){var Q=this;return b._asyncToGenerator(function*(){const {spinnerViewModel:D}=c.viewModel,f=c.viewModel.view;let A=null;a.add({remove(){A&&(A.abort(),A=null)}},Q.id);c.edits.feature=null;const J=f.on("immediate-click",z=>{D.location=z.mapPoint;
D.visible=!0;A?.abort();const {editableItems:N}=c.viewModel;A=new AbortController;(new Promise((F,R)=>{u.onAbort(A?.signal,()=>R(u.createAbortError()));F(x.fetchCandidates(N,f,z,A?.signal))})).then(F=>{u.throwIfAborted(A);c.candidates=F.reduce((R,m)=>m.error?R:[...R,...m.value],[]);c.viewModel.spinnerViewModel.visible=1===c.candidates.length;0!==c.candidates.length&&(F=c.viewModel.activeWorkflow,1===c.candidates.length?(c.edits.feature=c.candidates[0],F.go("editing-existing-feature").catch(()=>{}).then(()=>
c.viewModel.spinnerViewModel.visible=!1)):F.next())})});f.focus();a.add(J,Q.id)})()},tearDown(){var Q=this;return b._asyncToGenerator(function*(){a.remove(Q.id)})()}}),"awaiting-update-feature-candidate":()=>({id:"awaiting-update-feature-candidate",setUp(){var Q=this;return b._asyncToGenerator(function*(){const {edits:D}=c;D.feature=null;a.add(K.watch(()=>D.feature,f=>{L.unhighlight();L.highlight(f)}),Q.id)})()},tearDown(){var Q=this;return b._asyncToGenerator(function*(){L.unhighlight();a.remove(Q.id)})()}}),
"editing-existing-feature":()=>({id:"editing-existing-feature",setUp(){var Q=this;return b._asyncToGenerator(function*(){if(!a.has("editing-existing-feature")){var D=c.edits.feature,f=c.viewModel.view,{attachmentsViewModel:A,editableItems:J,featureFormViewModel:z,layerInfos:N,sketchViewModel:F}=c.viewModel;c.editableItem=J.find(T=>T.layer===D.layer);var R=new AbortController;a.add({remove:()=>R.abort()},Q.id);var m=x.whenEditorLayerView(f,D.layer),C=x.fetchFullFeature(D,f,R.signal);m=yield m;var M=
yield C;if(!u.isAborted(R)){c.edits.updateGeometry(M.geometry);c.edits.updateAttributes(M.attributes);c.edits.trackChanges();var w=c.editableItem.supports;C=w.includes("create");w=w.includes("update");A.set({abilities:{editing:!0,operations:{add:C||w,update:w,delete:w}},graphic:M,filesEnabled:!1,mode:"view"});C=x.findLayerInfo(N,M.sourceLayer);z.set({arcadeEditType:"UPDATE",feature:M,formTemplate:C?.formTemplate,spatialReference:f.spatialReference,view:f});var U="createInteractiveEditSession"in m?
m.createInteractiveEditSession(D):null;m=[z.on("value-change",T=>{c.edits.updateAttributes(z.getValues());M.attributes=c.edits.feature.attributes;U&&U.setAttribute(T.fieldName,T.value)}),K.watch(()=>A.mode,T=>{"add"===T&&c.viewModel.activeWorkflow.go("adding-attachment");"edit"===T&&c.viewModel.activeWorkflow.go("editing-attachment")})];U&&(m.push(e.makeHandle(()=>U.rollback())),a.add(e.makeHandle(()=>U.commit()),L._handleKeys.afterCommit));if(c.editableItem.geometryUpdatesEnabled){F.allowDeleteKey=
!1;const T=x.getVisualVariableAttributes(M),{interactive:S,visual:Y}=yield x.setUpGeometryUpdate(M,T,F,f,({geometry:ha,attributes:ja},oa)=>{if(H.isSome(T.rotation)){var {field:ra}=T.rotation;z.setValue(ra,ja[ra])}H.isSome(T.size)&&({field:ra}=T.size,z.setValue(ra,ja[ra]));c.edits.updateAttributes(ja);c.edits.updateGeometry(ha);z.feature.geometry=ha;("undo"===oa.type||"redo"===oa.type||"update"===oa.type&&H.isSome(oa.toolEventInfo)&&x.isTerminalUpdateEventType(oa.toolEventInfo.type))&&z.notifyFeatureGeometryChanged()},
v);m.push(S,Y);a.add(S,L._handleKeys.beforeCommit);a.add(Y,L._handleKeys.afterCommit)}else L.highlight(M);a.add(m,Q.id)}}})()},tearDown({cancelled:Q}){var D=this;return b._asyncToGenerator(function*(){Q&&(L.unhighlight(),a.remove(D.id))})()}}),"adding-attachment":()=>({id:"adding-attachment",parent:"editing-existing-feature",setUp(){return b._asyncToGenerator(function*(){})()},tearDown(){return b._asyncToGenerator(function*(){c.viewModel.attachmentsViewModel.mode="view"})()}}),"editing-attachment":()=>
({id:"editing-attachment",parent:"editing-existing-feature",setUp(){return b._asyncToGenerator(function*(){})()},tearDown(){return b._asyncToGenerator(function*(){c.viewModel.attachmentsViewModel.mode="view"})()}})})};b._createClass(P,[{key:"shouldShowAttachments",get:function(){return!!this.data?.editableItem.attachmentsOnUpdateEnabled}},{key:"shouldAllowAttachmentEditing",get:function(){return!!this.data?.editableItem.supports.includes("update")}},{key:"helpMessage",get:function(){return"awaiting-feature-to-update"===
this.stepId?"select":void 0}},{key:"reliesOnOwnerAdminPrivileges",get:function(){const {layer:L}=this.data.editableItem,g=L.capabilities?.operations.supportsUpdate,c=k.getEffectiveLayerCapabilities(L)?.operations.supportsUpdate;return k.getEffectiveEditingEnabled(L)&&!L.editingEnabled||!!c&&!g}}]);return P}(B);n.__decorate([E.property()],h.prototype,"shouldShowAttachments",null);n.__decorate([E.property()],h.prototype,"shouldAllowAttachmentEditing",null);n.__decorate([E.property()],h.prototype,"helpMessage",
null);n.__decorate([E.property()],h.prototype,"reliesOnOwnerAdminPrivileges",null);return h=y=n.__decorate([d.subclass("esri.widgets.Editor.UpdateWorkflow")],h)})},"esri/views/support/layerViewUtils":function(){define(["exports","../../core/maybe"],function(b,n){b.extractSafeScaleBounds=function(e){e=e.effectiveScaleRange;return{minScale:e?.minScale??0,maxScale:e?.maxScale??0}};b.highlightsSupported=function(e){return e&&"function"===typeof e.highlight};b.isScaleRangeActive=function(e,H){return n.isSome(e)&&
0<e||n.isSome(H)&&0<H};b.occludeesSupported=function(e){return e&&"function"===typeof e.maskOccludee};b.scaleBoundsPredicate=function(e,H,u){return n.isNone(e)||e>u&&(0===H||e<H)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/UpdateWorkflowData":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,n,e,H,u,K,E){e=function(h){function t(d){d=h.call(this,d)||this;d.candidates=null;d.editableItem=null;d.edits=null;d.viewModel=null;return d}b._inheritsLoose(t,h);return t}(e);n.__decorate([H.property()],e.prototype,"candidates",void 0);n.__decorate([H.property()],e.prototype,"editableItem",void 0);n.__decorate([H.property()],e.prototype,"edits",void 0);n.__decorate([H.property()],e.prototype,"viewModel",void 0);return e=n.__decorate([E.subclass("esri.widgets.Editor.UpdateWorkflowData")],
e)})},"esri/widgets/Sketch/SketchViewModel":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../symbols ../../core/Collection ../../core/Error ../../core/Evented ../../core/Handles ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass ../../geometry/ellipsoidUtils ../../geometry/projection ../../geometry/support/coordsUtils ../../geometry/support/spatialReferenceUtils ../../layers/GraphicsLayer ../../views/3d/interactive/editingTools/isSupportedGraphicUtils ../../views/3d/interactive/editingTools/moveGraphic/isSupportedGraphic ../../views/3d/interactive/editingTools/reshapeGraphic/isSupportedGraphic ../../views/3d/interactive/editingTools/transformGraphic/isSupportedGraphic ../../views/draw/support/layerUtils ../../views/input/InputManager ../../views/interactive/keybindings ../../views/interactive/sketch/SketchLabelOptions ../../views/interactive/sketch/SketchTooltipOptions ../../views/interactive/snapping/SnappingManager ../../views/interactive/snapping/SnappingOptions ../../views/interactive/snapping/snappingUtils ../../views/support/hitTestSelectUtils ../../views/support/screenUtils ./support/OperationHandle ../../symbols/SimpleMarkerSymbol ../../symbols/SimpleFillSymbol ../../symbols/SimpleLineSymbol".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k,r,l,p,B,x,y,G,P,O,L,g,c,a,v,Q,D,f,A,J,z,N,F,R,m,C,M,w,U){function T(Z){return"polygon"===Z||"rectangle"===Z||"circle"===Z}function S(Z,da){ha("undo",Z.history.undo,Z.history.redo,da)}function Y(Z,da){ha("redo",Z.history.redo,Z.history.undo,da)}function ha(Z,da,fa,X){if(da=da.pop()){var aa=da.updates,ea=[];X.forEach((ba,ia)=>{ia=aa[ia];null!=ia&&("geometry"in ia&&d.isSome(ia.geometry)&&(ea.push({geometry:ba.geometry}),ba.geometry=ia.geometry),"symbol"in ia&&d.isSome(ia.symbol)&&
(ea.push({symbol:ba.symbol}),ba.symbol=ia.symbol),"undo"in ia&&(ea.push(ia),ia[Z](ba)))});fa.push({updates:ea})}}function ja(Z){return{updates:Z.map(da=>({geometry:da.geometry}))}}function oa(Z){return"requireError"in Z&&"aborted"===Z.requireError}const ra=Z=>Object.freeze(Object.defineProperty({__proto__:null,default:Z},Symbol.toStringTag,{value:"Module"})),ta={defaultZ:0},ua={reshapeOptions:{edgeOperation:"split",shapeOperation:"move",vertexOperation:"move"},enableMoveAllGraphics:!0,enableRotation:!0,
enableScaling:!0,multipleSelectionEnabled:!0,preserveAspectRatio:!1,toggleToolOnClick:!0,enableZ:!0,tool:"transform"};E=function(Z){function da(X){X=Z.call(this,X)||this;X._numUpdating=0;X._handles=new h;X._internalGraphicsLayer=new L({listMode:"hide",internal:!0,title:"SVM Internal"});X._operationHandle=null;X._viewHandles=new h;X.activeFillSymbol=null;X.activeLineSymbol=null;X.activeVertexSymbol=null;X.allowDeleteKey=!0;X.labelOptions=new A;X.layer=null;X.pointSymbol=new M({style:"circle",size:6,
color:[255,255,255],outline:{color:[50,50,50],width:1}});X.polygonSymbol=new w({color:[150,150,150,.2],outline:{color:[50,50,50],width:2}});X.polylineSymbol=new U({color:[130,130,130,1],width:2});X._snappingManager=null;X.tooltipOptions=new J;X.updateGraphics=new u;X.updateOnGraphicClick=!0;X.updatePointSymbol=new M({size:10,color:[0,200,255,.5],outline:{color:"black",width:1}});X.updatePolygonSymbol=new w({color:[12,207,255,.2],outline:{join:"round",color:[12,207,255],width:2}});X.updatePolylineSymbol=
new U({color:[12,207,255],width:2});X.vertexSymbol=new M({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}});X._moduleLoaderAbortController=null;X._viewReadyAbortController=null;X._originalAutoOpenEnabled=null;X.defaultCreateOptions=ta;X.defaultUpdateOptions=ua;X.snappingOptions=new N;return X}n._inheritsLoose(da,Z);var fa=da.prototype;fa.initialize=function(){this._handles.add([r.on(()=>this.view?.map?.layers,"change",X=>{X.removed.includes(this.layer)&&this.cancel()}),
r.on(()=>this.layer?.graphics,"change",X=>{if(d.isSome(this._operationHandle))for(const aa of X.removed)this.updateGraphics.includes(aa)&&(1<this.updateGraphics.length?this._operationHandle.removeFromSelection(aa):this._operationHandle.cancel())}),r.watch(()=>this.layer?.elevationInfo??null,X=>{X!==this._internalGraphicsLayer.elevationInfo&&(this.cancel(),this._internalGraphicsLayer.elevationInfo=X)},r.syncAndInitial),r.watch(()=>this.view,X=>{d.destroyMaybe(this._snappingManager);X&&(this._snappingManager=
new z.SnappingManager({view:X,options:this.snappingOptions}),"2d"===X.type?new Promise((aa,ea)=>b(["../../views/2d/interactive/editingTools"],aa,ea)):"3d"===X.type&&(new Promise((aa,ea)=>b(["../../views/3d/interactive/editingTools"],aa,ea)),new Promise((aa,ea)=>b(["../../views/3d/layers/GraphicsLayerView3D"],ba=>aa(ra(ba)),ea))))},r.syncAndInitial),r.watch(()=>this.view?.spatialReference,(X,aa)=>{X&&aa&&!X.equals(aa)&&this.cancel()})]);F.setupSnappingToggleHandles(this)};fa.destroy=function(){this.cancel();
this._handles=d.destroyMaybe(this._handles);this._viewHandles=d.destroyMaybe(this._viewHandles);this._removeDefaultLayer();this._snappingManager=d.destroyMaybe(this._snappingManager);this._set("view",null);this.emit("destroy")};fa.cancel=function(){this._moduleLoaderAbortController=d.abortMaybe(this._moduleLoaderAbortController);this._viewReadyAbortController=d.abortMaybe(this._viewReadyAbortController);this._operationHandle&&this._operationHandle.cancel()};fa.complete=function(){this._operationHandle&&
this._operationHandle.complete()};fa.delete=function(){const {state:X,updateGraphics:aa}=this;if("active"===X&&aa.length){const {activeTool:ea,layer:ba}=this,ia=aa.toArray();ba.removeMany(ia);this.cancel();this._emitDeleteEvent({graphics:ia,tool:ea})}};fa.duplicate=function(){if("active"===this.state&&this.updateGraphics.length){const X=this.updateGraphics.map(aa=>aa.clone()).toArray();this.layer.addMany(X);this.emit("duplicate",{graphics:X,type:"duplicate"});return X}return[]};fa.create=function(){var X=
n._asyncToGenerator(function*(aa,ea){this.cancel();yield this._waitViewReady();const {view:ba,layer:ia}=this;if(!ba||"disabled"===this.state)throw ia||this._logMissingLayer(),k.createAbortError();d.isSome(ba.activeTool)&&(ba.activeTool=null);if(aa){Q.addUniqueLayer(ba,this._internalGraphicsLayer);var ma=yield this._setupCreateOperation(aa,ea);d.isNone(ma)||this.destroyed?ba.map.remove(this._internalGraphicsLayer):(ma.on("complete",()=>{if(ma===this._operationHandle){const ka=this.createGraphic,qa=
this._operationHandle.cancelled;this._operationHandle.destroy();this._operationHandle=null;this._set("createGraphic",null);this.view&&this.view.map&&this.view.map.remove(this._internalGraphicsLayer);ma.cancelled||null==ka||ia.add(ka);this.emit("create",{graphic:ka,state:qa?"cancel":"complete",tool:aa,toolEventInfo:null,type:"create"})}}),this._operationHandle=ma,ba.ready&&ba.focus())}else this._logError("sketch:missing-parameter","Missing parameter 'tool'.")});return function(aa,ea){return X.apply(this,
arguments)}}();fa.update=function(){var X=n._asyncToGenerator(function*(aa,ea){this.cancel();yield this._waitViewReady();const {layer:ba,view:ia,state:ma}=this;if(!ia||"disabled"===ma)throw ba||this._logMissingLayer(),k.createAbortError();d.isSome(ia.activeTool)&&(ia.activeTool=null);const ka=Array.isArray(aa)?aa:[aa];null!=aa&&ka&&ka.length?ka.some(qa=>qa.layer!==ba?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),
!0):d.isNone(qa.geometry)?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with an unsupported geometry."),!0):!1)||(aa=yield this._setupUpdateOperation(ka,ea),this.destroyed||d.isNone(aa)||oa(aa)||(Q.addUniqueLayer(ia,this._internalGraphicsLayer),this._setUpdateOperationHandle(aa,ea),this.emit("update",{graphics:ka,state:"start",aborted:!1,tool:aa.tool,toolEventInfo:null,type:"update"}))):this._logError("sketch:missing-parameter","Missing parameter 'graphics'.")});
return function(aa,ea){return X.apply(this,arguments)}}();fa._updateSpatialReference=function(){var X=n._asyncToGenerator(function*(aa){const ea=this.view;if(ea){this._beginAsyncOperation();aa=Array.isArray(aa)?aa:[aa];for(const ba of aa)d.isSome(ba.geometry)&&"mesh"!==ba.geometry.type&&!O.equals(ba.geometry.spatialReference,ea.spatialReference)&&(G.canProjectWithoutEngine(ba.geometry.spatialReference,ea.spatialReference)||G.isLoaded()||(yield G.load()),ba.geometry=G.project(ba.geometry,ea.spatialReference));
this._endAsyncOperation()}else this._logMissingView()});return function(aa){return X.apply(this,arguments)}}();fa.undo=function(){this.canUndo()&&this._operationHandle?.undo()};fa.redo=function(){this.canRedo()&&this._operationHandle?.redo()};fa.canUndo=function(){return!(!this._operationHandle||!this._operationHandle.canUndo())};fa.canRedo=function(){return!(!this._operationHandle||!this._operationHandle.canRedo())};fa.toggleUpdateTool=function(){this._operationHandle&&this._operationHandle.toggleTool&&
this._operationHandle.toggleTool()};fa._getFirstHit=function(){var X=n._asyncToGenerator(function*(aa){var ea=this.view;if(!ea)return this._logMissingView(),null;if("2d"===ea.type){const ia=[];ea.map.allLayers.forEach(ma=>{"vector-tile"!==ma.type&&"imagery"!==ma.type||ia.push(ma)});ea=yield ea.hitTest(aa,{exclude:ia});return R.findFirstGraphicHit(ea.results)}const ba=[ea.map.ground];ea.map.allLayers.forEach(ia=>{"integrated-mesh"===ia.type&&ba.push(ia)});aa=yield ea.hitTest(aa,{exclude:ba});if(0<
aa.results.length){const ia=aa.results[0];if(d.isSome(ia)&&"graphic"===ia.type&&ia.graphic&&(!aa.ground.mapPoint||1>ea.map.ground.opacity||aa.ground.distance-d.unwrapOr(ia.distance,0)>-Math.min(3*aa.ground.distance,"global"===ea.viewingMode?y.getReferenceEllipsoid(ea.renderCoordsHelper.spatialReference).radius/ea.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY)))return ia}return null});return function(aa){return X.apply(this,arguments)}}();fa._generateViewHandles=function(X){var aa=this;
return[X.on("immediate-click",function(){var ea=n._asyncToGenerator(function*(ba){var ia="active"===aa.state&&"create"===aa._operationHandle?.type;if("disabled"!==aa.state&&!ia&&aa.updateOnGraphicClick){aa._beginAsyncOperation();var ma=yield ba.async(()=>aa._getFirstHit(m.createScreenPointFromEvent(ba)));ia=null;d.isSome(ma)?(ma=ma.graphic,aa.updateGraphics.includes(ma)||ma.layer===aa.layer?(ba.stopPropagation(),ia=ma):"2d"!==X.type||aa._isComponentGraphic(ma)||"active"!==aa.state||aa.cancel()):"active"===
aa.state&&aa.cancel();d.isSome(ia)&&!aa.updateGraphics.includes(ia)&&(yield aa.update([ia],{...aa.defaultUpdateOptions,reshapeOptions:{...aa.defaultUpdateOptions.reshapeOptions}}));aa._endAsyncOperation()}});return function(ba){return ea.apply(this,arguments)}}(),D.ViewEventPriorities.WIDGET)]};fa._setupCreateOperation=function(){var X=n._asyncToGenerator(function*(aa,ea){const ba=this.view;if(!ba)return this._logMissingView(),null;aa=yield this._setupDrawGraphicTool(aa,ba,{hasZ:"3d"===ba.type,...this.defaultCreateOptions,
...ea});if(d.isNone(aa))return null;ba.tools.add(aa);ba.activeTool=aa;return this._setupCreateOperationHandle(aa)});return function(aa,ea){return X.apply(this,arguments)}}();fa._setupDrawGraphicTool=function(){var X=n._asyncToGenerator(function*(aa,ea,ba){if("multipoint"===aa&&"3d"===ea.type)return this._logError("sketch:create","Multipoint geometries are not supported in SceneView."),null;if(!ea)return this._logMissingView(),null;const ia="rectangle"!==aa,ma="rectangle"!==aa;aa={view:ea,mode:"rectangle"===
aa||"circle"===aa?"hybrid":"click",...ba,snapToScene:!1,geometryType:aa,graphicSymbol:this._getGraphicSymbolFromTool(aa),snappingManager:this._snappingManager,forceUniformSize:ma,centered:ia};return"2d"===ea.type?this._makeDrawGraphicTool2D(aa):this._makeDrawGraphicTool3D(aa)});return function(aa,ea,ba){return X.apply(this,arguments)}}();fa._makeDrawGraphicTool2D=function(){var X=n._asyncToGenerator(function*(aa){const ea=yield this._requireModule(new Promise((ba,ia)=>b(["../../views/2d/interactive/editingTools"],
ba,ia)));return oa(ea)||this.destroyed?null:new ea.module.DrawGraphicTool2D({...aa,activeVertexSymbol:this.activeVertexSymbol,regularVerticesSymbol:this.vertexSymbol,activeLineSymbol:this.activeLineSymbol,activeFillSymbol:T(aa.geometryType)?this.activeFillSymbol:null,tooltipOptions:this.tooltipOptions})});return function(aa){return X.apply(this,arguments)}}();fa._makeDrawGraphicTool3D=function(){var X=n._asyncToGenerator(function*(aa){const ea=yield this._requireModule(new Promise((ia,ma)=>b(["../../views/3d/interactive/editingTools"],
ia,ma)));if(oa(ea)||this.destroyed)return null;const {elevationInfo:ba}=this.layer;return new ea.module.DrawGraphicTool3D({...aa,elevationInfo:ba,snapToScene:d.isSome(ba)?"absolute-height"===ba.mode:!0,labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions})});return function(aa){return X.apply(this,arguments)}}();fa._setupCreateOperationHandle=function(X){const aa=this.view;if(!aa)return this._logMissingView(),null;let ea=null;const ba=X.forceUniformSize,ia=X.centered,ma=[aa.on("key-down",
qa=>{if(qa.key===f.SKETCH_KEYS.pan)qa.stopPropagation(),qa.repeat||(X.enabled=!1);else if(qa.key===f.SKETCH_KEYS.complete)qa.stopPropagation(),X.completeCreateOperation();else if(qa.key!==f.SKETCH_KEYS.vertexAdd||qa.repeat)qa.key===f.SKETCH_KEYS.undo?(qa.stopPropagation(),ka.undo()):qa.key===f.SKETCH_KEYS.redo?(qa.stopPropagation(),ka.redo()):qa.key!==f.SKETCH_KEYS.constraint||"rectangle"!==X.geometryType&&"circle"!==X.geometryType||qa.repeat?qa.key!==f.SKETCH_KEYS.center||qa.repeat||(X.centered=
!ia,qa.stopPropagation()):(X.forceUniformSize=!ba,qa.stopPropagation());else{const xa=X.drawOperation.geometryType;if("polyline"===xa||"polygon"===xa||"multipoint"===xa)qa.stopPropagation(),X.drawOperation.commitStagedVertex()}},D.ViewEventPriorities.WIDGET),aa.on("key-up",qa=>{qa.key===f.SKETCH_KEYS.pan?X.enabled=!0:qa.key!==f.SKETCH_KEYS.constraint||"rectangle"!==X.geometryType&&"circle"!==X.geometryType?qa.key===f.SKETCH_KEYS.center&&(X.centered=ia,qa.stopPropagation()):(X.forceUniformSize=ba,
qa.stopPropagation())},D.ViewEventPriorities.WIDGET),X.on("vertex-add",qa=>{ea=d.isNone(ea)?"start":"active";switch(qa.operation){case "apply":this.emit("create",{graphic:d.unwrap(X.graphic),state:ea,tool:this.activeTool,toolEventInfo:qa,type:"create"});break;case "undo":this._emitUndoEvent({graphics:[d.unwrap(X.graphic)],tool:X.geometryType});break;case "redo":this._emitRedoEvent({graphics:[d.unwrap(X.graphic)],tool:X.geometryType})}}),X.on("cursor-update",qa=>{0<X.drawOperation.numCommittedVertices&&
this.emit("create",{graphic:d.unwrap(X.graphic),state:"active",tool:this.activeTool,toolEventInfo:{coordinates:qa.vertices[0].coordinates,type:"cursor-update"},type:"create"})}),X.on("vertex-remove",qa=>{switch(qa.operation){case "apply":this.emit("create",{graphic:d.unwrap(X.graphic),state:"active",tool:this.activeTool,toolEventInfo:qa,type:"create"});break;case "undo":this._emitUndoEvent({graphics:[d.unwrap(X.graphic)],tool:X.geometryType});break;case "redo":this._emitRedoEvent({graphics:[d.unwrap(X.graphic)],
tool:X.geometryType})}}),X.on("complete",qa=>{this._set("createGraphic",d.unwrap(qa.graphic));ea="complete";qa.aborted?ka&&ka.cancel():ka&&ka.complete()}),r.watch(()=>this._getGraphicSymbolFromTool(X.geometryType),qa=>{X.graphicSymbol=qa})],ka=new C.CreateOperationHandle({activeComponent:X,tool:X.geometryType,type:"create",onEnd:()=>{ma.forEach(qa=>qa.remove());ma.length=0;aa.tools?.remove(X)},undo:()=>{X.canUndo&&X.undo()},redo:()=>{X.canRedo&&X.redo()},canUndo:()=>X.canUndo,canRedo:()=>X.canRedo});
return ka};fa._getGraphicSymbolFromTool=function(X){switch(X){case "point":case "multipoint":return this.pointSymbol;case "polyline":return this.polylineSymbol;case "circle":case "rectangle":case "polygon":return this.polygonSymbol}};fa._setupUpdateOperation=function(){var X=n._asyncToGenerator(function*(aa,ea){const {layer:ba,view:ia}=this;if(!ia)return this._logMissingView(),null;ea={tool:this._defaultUpdateTool,...this.defaultUpdateOptions,...ea,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions,
...ea?.reshapeOptions}};var ma=ea.tool;for(var ka of aa)ba.remove(ka),ba.add(ka);if("3d"===ia.type){if(0===aa.length)return null;switch(ma){case "move":return this._setupMove3DOperation(aa,ea,ia,ma);case "reshape":if(1<aa.length)return this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null;ma=a.isSupportedGraphic(aa[0]);if(ma===g.SupportedGraphicResult.SUPPORTED)return this._setupReshape3DOperation(aa[0],ea,ia);this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${g.isSupportedGraphicResultMessage(ma)}).`);
return null;case "transform":return this._setupGraphicTransform3DOperation(aa,ea,ia)}}switch(ma){case "move":return this._setupMove2DOperation(aa,ea,ia);case "reshape":if(1<aa.length)return this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null;ka=a.isSupportedGraphic(aa[0]);if(ka===g.SupportedGraphicResult.SUPPORTED)return this._setupTransformOrReshape2DOperation(aa,ma,ea,ia);this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${g.isSupportedGraphicResultMessage(ka)}).`);
return null;case "transform":return 1===aa.length&&(ka=d.get(aa[0].geometry,"type"),"point"===ka||"multipoint"===ka)&&(ma="reshape"),this._setupTransformOrReshape2DOperation(aa,ma,ea,ia)}});return function(aa,ea){return X.apply(this,arguments)}}();fa._setupMove3DOperation=function(){var X=n._asyncToGenerator(function*(aa,ea,ba,ia,ma=!1){var ka=this;for(var qa of aa){const sa=c.isSupportedGraphic(qa);if(sa!==g.SupportedGraphicResult.SUPPORTED)return this._logError("sketch:move",`Move operation not supported for provided graphic(s) (${g.isSupportedGraphicResultMessage(sa)}).`),
null}qa=yield this._requireModule(new Promise((sa,za)=>b(["../../views/3d/interactive/editingTools"],sa,za)));if(oa(qa))return qa;const xa=new qa.module.GraphicMoveTool({view:ba,enableZ:ea.enableZ,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions});ba.tools.add(xa);xa.graphics.addMany(aa);ma||this.updateGraphics.addMany(aa);const ya=[],wa=new C.UpdateOperationHandle({activeComponent:xa,tool:ia,type:"update",onEnd:()=>{ya.forEach(sa=>sa.remove());ya.length=0;ba.tools?.remove(xa);
xa.destroyed||xa.destroy()},undo:()=>{S(wa,this.updateGraphics.toArray());this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:ia})},redo:()=>{Y(wa,this.updateGraphics.toArray());this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:ia})},addToSelection:sa=>{this.updateGraphics.push(sa);xa.graphics.push(sa);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[sa],removed:[],type:"selection-change"},type:"update"})},
removeFromSelection:sa=>{const za=this.updateGraphics.indexOf(sa);wa.history.undo.forEach(Ba=>Ba.updates.splice(za,1));wa.history.redo.forEach(Ba=>Ba.updates.splice(za,1));this.updateGraphics.remove(sa);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[sa],type:"selection-change"},type:"update"});0===this.updateGraphics.length?wa.complete():xa.graphics.remove(sa)},toggleTool:function(){var sa=n._asyncToGenerator(function*(){if(1===
ka.updateGraphics.length&&!1!==ea.toggleToolOnClick&&"transform"===ia){var za=ka.updateGraphics.getItemAt(0);a.isSupportedGraphic(za)===g.SupportedGraphicResult.SUPPORTED&&(za=yield ka._setupReshape3DOperation(za,ea,ba,!0),oa(za)||(wa.onEnd(),wa.destroy(),ka._setUpdateOperationHandle(za,ea)))}});return function(){return sa.apply(this,arguments)}}()});ya.push(...this._getHandlesForComponent(wa,ea),ba.on("immediate-click",sa=>this._getCommonUpdateOperationClickHandlers(wa,sa,ea),D.ViewEventPriorities.WIDGET),
ba.on("key-down",sa=>{this._getCommonUpdateOperationKeyDownHandlers(wa,sa)},D.ViewEventPriorities.WIDGET));return wa});return function(aa,ea,ba,ia){return X.apply(this,arguments)}}();fa._setupGraphicTransform3DOperation=function(X,aa,ea,ba=!1){if(1===X.length&&v.isSupportedGraphic(X[0])===g.SupportedGraphicResult.SUPPORTED){const ia=X[0],ma=ia.geometry;if(d.isSome(ma)&&("point"===ma.type||"mesh"===ma.type))return this._setupPointTransform3DOperation(ia,aa,ea);if(d.isSome(ma)&&("polygon"===ma.type||
"polyline"===ma.type))return this._setupPolyTransform3DOperation(ia,aa,ea,ba)}return this._setupMove3DOperation(X,aa,ea,"transform",ba)};fa._setupPointTransform3DOperation=function(){var X=n._asyncToGenerator(function*(aa,ea,ba){var ia=this;const {enableRotation:ma,enableScaling:ka,enableZ:qa}=ea,xa=yield this._requireModule(new Promise((za,Ba)=>b(["../../views/3d/interactive/editingTools"],za,Ba)));if(oa(xa))return xa;const ya=new xa.module.GraphicTransformTool({graphic:aa,view:ba,enableRotation:ma,
enableScaling:ka,enableZ:qa,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions});ba.tools.add(ya);this.updateGraphics.add(aa);const wa=[],sa=new C.UpdateOperationHandle({activeComponent:ya,tool:"transform",type:"update",onEnd:()=>{wa.forEach(za=>za.remove());wa.length=0;ba.tools?.remove(ya);ya.destroyed||ya.destroy()},undo:()=>{S(sa,this.updateGraphics.toArray());this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},redo:()=>{Y(sa,this.updateGraphics.toArray());
this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},addToSelection:function(){var za=n._asyncToGenerator(function*(Ba){ia.updateGraphics.add(Ba);ia.emit("update",{graphics:ia.updateGraphics.toArray(),state:"active",aborted:!1,tool:ia.activeTool,toolEventInfo:{added:[Ba],removed:[],type:"selection-change"},type:"update"});Ba=yield ia._setupMove3DOperation(ia.updateGraphics.toArray(),ea,ba,"transform",!0);oa(Ba)||(sa.onEnd(),sa.destroy(),ia._setUpdateOperationHandle(Ba,ea))});
return function(Ba){return za.apply(this,arguments)}}(),removeFromSelection:za=>{this.updateGraphics.remove(za);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[za],type:"selection-change"},type:"update"});sa.complete()},toggleTool:()=>{}});wa.push(...this._getHandlesForComponent(sa,ea),ba.on("immediate-click",za=>this._getCommonUpdateOperationClickHandlers(sa,za,ea),D.ViewEventPriorities.WIDGET),ba.on("key-down",
za=>{this._getCommonUpdateOperationKeyDownHandlers(sa,za)},D.ViewEventPriorities.WIDGET));return sa});return function(aa,ea,ba){return X.apply(this,arguments)}}();fa._setupPolyTransform3DOperation=function(){var X=n._asyncToGenerator(function*(aa,ea,ba,ia=!1){var ma=this;const {enableRotation:ka,enableScaling:qa,enableZ:xa,preserveAspectRatio:ya}=ea,wa=yield this._requireModule(new Promise((Ea,Ma)=>b(["../../views/3d/interactive/editingTools"],Ea,Ma)));if(oa(wa))return wa;const sa=new wa.module.ExtentTransformTool({graphic:aa,
view:ba,enableRotation:ka,enableScaling:qa,enableZ:xa,preserveAspectRatio:ya,tooltipOptions:this.tooltipOptions});ba.tools.add(sa);ia||this.updateGraphics.add(aa);const za=[],Ba=new C.UpdateOperationHandle({activeComponent:sa,tool:"transform",type:"update",onEnd:()=>{za.forEach(Ea=>Ea.remove());za.length=0;ba.tools?.remove(sa);sa.destroyed||sa.destroy()},canUndo:()=>sa.canUndo,undo:()=>{sa.undo();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},canRedo:()=>sa.canRedo,
redo:()=>{sa.redo();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},addToSelection:function(){var Ea=n._asyncToGenerator(function*(Ma){ma.updateGraphics.add(Ma);ma.emit("update",{graphics:ma.updateGraphics.toArray(),state:"active",aborted:!1,tool:ma.activeTool,toolEventInfo:{added:[Ma],removed:[],type:"selection-change"},type:"update"});Ma=yield ma._setupMove3DOperation(ma.updateGraphics.toArray(),ea,ba,"transform",!0);oa(Ma)||(Ba.onEnd(),Ba.destroy(),ma._setUpdateOperationHandle(Ma,
ea))});return function(Ma){return Ea.apply(this,arguments)}}(),removeFromSelection:Ea=>{this.updateGraphics.remove(Ea);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[Ea],type:"selection-change"},type:"update"});Ba.complete()},toggleTool:function(){var Ea=n._asyncToGenerator(function*(){if(1===ma.updateGraphics.length&&!1!==ea.toggleToolOnClick){var Ma=ma.updateGraphics.getItemAt(0);a.isSupportedGraphic(Ma)===
g.SupportedGraphicResult.SUPPORTED&&(Ma=yield ma._setupReshape3DOperation(Ma,ea,ba,!0),oa(Ma)||(Ba.onEnd(),Ba.destroy(),ma._setUpdateOperationHandle(Ma,ea)))}});return function(){return Ea.apply(this,arguments)}}()});za.push(...this._getHandlesForComponent(Ba,ea),ba.on("immediate-click",Ea=>this._getCommonUpdateOperationClickHandlers(Ba,Ea,ea),D.ViewEventPriorities.WIDGET),ba.on("key-down",Ea=>this._getCommonUpdateOperationKeyDownHandlers(Ba,Ea),D.ViewEventPriorities.WIDGET),ba.on("key-down",Ea=>
{Ea.key!==f.SKETCH_KEYS.constraint||Ea.repeat||(sa.preserveAspectRatio=!sa.preserveAspectRatio,Ea.stopPropagation())},D.ViewEventPriorities.WIDGET),ba.on("key-up",Ea=>{Ea.key===f.SKETCH_KEYS.constraint&&(sa.preserveAspectRatio=!sa.preserveAspectRatio,Ea.stopPropagation())},D.ViewEventPriorities.WIDGET));return Ba});return function(aa,ea,ba){return X.apply(this,arguments)}}();fa._setupMove2DOperation=function(){var X=n._asyncToGenerator(function*(aa,ea,ba){var ia=this;this.updateGraphics.addMany(aa);
yield this._updateSpatialReference(aa);const ma=yield this._getGraphicMover(aa,ea,ba);if(oa(ma))return ma;const ka=new C.UpdateOperationHandle({activeComponent:ma,tool:"move",type:"update",onEnd:()=>{this._displayDefaultCursor();ya.forEach(wa=>wa.remove());xa.forEach(wa=>wa.remove());ya=[];xa=[];ma.destroy();this._internalGraphicsLayer?.removeMany([...this.updateGraphics.toArray()])},undo:()=>{const wa=this.updateGraphics.toArray();S(ka,wa);ka.refreshComponent();this._emitUndoEvent({graphics:wa,tool:"move"})},
redo:()=>{const wa=this.updateGraphics.toArray();Y(ka,wa);ka.refreshComponent();this._emitRedoEvent({graphics:wa,tool:"move"})},addToSelection:function(){var wa=n._asyncToGenerator(function*(sa){yield ia._updateSpatialReference(sa);ia.updateGraphics.push(sa);ma.graphics=ia.updateGraphics.toArray();ia.emit("update",{graphics:ia.updateGraphics.toArray(),state:"active",aborted:!1,tool:ia.activeTool,toolEventInfo:{added:[sa],removed:[],type:"selection-change"},type:"update"})});return function(sa){return wa.apply(this,
arguments)}}(),removeFromSelection:wa=>{const sa=this.updateGraphics.indexOf(wa);ka.history.undo.forEach(Ba=>Ba.updates.splice(sa,1));ka.history.redo.forEach(Ba=>Ba.updates.splice(sa,1));this.updateGraphics.remove(wa);const za=this.updateGraphics.toArray();this.emit("update",{graphics:za,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[wa],type:"selection-change"},type:"update"});0===this.updateGraphics.length?ka.complete():ma.graphics=za}});let qa=!1,xa=[ba.on("immediate-click",
wa=>this._getCommonUpdateOperationClickHandlers(ka,wa,ea),D.ViewEventPriorities.WIDGET),ba.on("key-down",wa=>{this._getCommonUpdateOperationKeyDownHandlers(ka,wa);wa.key!==f.SKETCH_KEYS.constraint||wa.repeat||(qa=!0,ma.enableMoveAllGraphics=!ma.enableMoveAllGraphics)},D.ViewEventPriorities.WIDGET),ba.on("key-up",wa=>{wa.key===f.SKETCH_KEYS.constraint&&qa&&(qa=!1,ma.enableMoveAllGraphics=!ma.enableMoveAllGraphics)},D.ViewEventPriorities.WIDGET)],ya=this._getHandlesForComponent(ka,ea);return ka});return function(aa,
ea,ba){return X.apply(this,arguments)}}();fa._setupReshape3DOperation=function(){var X=n._asyncToGenerator(function*(aa,ea,ba,ia=!1){var ma=this;const ka=yield this._requireModule(new Promise((sa,za)=>b(["../../views/3d/interactive/editingTools"],sa,za)));if(oa(ka))return ka;const qa=ea.reshapeOptions,xa=new ka.module.GraphicReshapeTool({view:ba,graphic:aa,enableZVertex:ea.enableZ&&"move"===qa?.vertexOperation,enableZShape:ea.enableZ&&"move"===qa?.shapeOperation,enableMoveGraphic:"move"===qa?.shapeOperation||
"move-xy"===qa?.shapeOperation,enableMidpoints:"split"===qa?.edgeOperation,enableEdgeOffset:"offset"===qa?.edgeOperation,snappingManager:this._snappingManager,labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions});ba.tools.add(xa);ia||this.updateGraphics.add(aa);const ya=[],wa=new C.UpdateOperationHandle({activeComponent:xa,tool:"reshape",type:"update",onEnd:()=>{ya.forEach(sa=>sa.remove());ya.length=0;ba.tools?.remove(xa);xa.destroyed||xa.destroy()},canUndo:()=>xa.canUndo,undo:()=>{xa.undo();
this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"reshape"})},canRedo:()=>xa.canRedo,redo:()=>{xa.redo();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"reshape"})},addToSelection:function(){var sa=n._asyncToGenerator(function*(za){ma.updateGraphics.add(za);ma.emit("update",{graphics:ma.updateGraphics.toArray(),state:"active",aborted:!1,tool:ma.activeTool,toolEventInfo:{added:[za],removed:[],type:"selection-change"},type:"update"});za=yield ma._setupMove3DOperation(ma.updateGraphics.toArray(),
ea,ba,"transform",!0);oa(za)||(wa.onEnd(),wa.destroy(),ma._setUpdateOperationHandle(za,ea))});return function(za){return sa.apply(this,arguments)}}(),removeFromSelection:sa=>{this.updateGraphics.remove(sa);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[sa],type:"selection-change"},type:"update"});wa.complete()},toggleTool:function(){var sa=n._asyncToGenerator(function*(){if(!1!==ea.toggleToolOnClick){var za=
yield ma._setupGraphicTransform3DOperation(ma.updateGraphics.toArray(),ea,ba,!0);oa(za)||(wa.onEnd(),wa.destroy(),ma._setUpdateOperationHandle(za,ea))}});return function(){return sa.apply(this,arguments)}}()});ya.push(...this._getHandlesForComponent(wa,ea),ba.on("immediate-click",sa=>this._getCommonUpdateOperationClickHandlers(wa,sa,ea),D.ViewEventPriorities.WIDGET),ba.on("key-down",sa=>{this._getCommonUpdateOperationKeyDownHandlers(wa,sa)},D.ViewEventPriorities.WIDGET));return wa});return function(aa,
ea,ba){return X.apply(this,arguments)}}();fa._setupTransformOrReshape2DOperation=function(){var X=n._asyncToGenerator(function*(aa,ea,ba,ia){var ma=this;this.updateGraphics.addMany(aa);yield this._updateSpatialReference(aa);aa="transform"===ea?yield this._getBox(aa,ba,ia):yield this._getReshape(aa,ba,ia);if(oa(aa))return aa;const ka=new C.UpdateOperationHandle({activeComponent:aa,type:"update",onEnd:()=>{xa.forEach(ya=>ya.remove());qa.forEach(ya=>ya.remove());xa=[];qa=[];ka.activeComponent&&!ka.activeComponent.destroyed&&
ka.activeComponent.destroy();this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray())},undo:()=>{S(ka,this.updateGraphics.toArray());ka.refreshComponent();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:ka.tool})},redo:()=>{Y(ka,this.updateGraphics.toArray());ka.refreshComponent();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:ka.tool})},addToSelection:function(){var ya=n._asyncToGenerator(function*(wa){var sa=ka.activeComponent;if("reshape"===sa?.type){sa=
[...ma.updateGraphics,wa];ma.updateGraphics.removeAll();sa=yield ma._setupMove2DOperation(sa,ba,ia);if(oa(sa))return;ka.onEnd();ka.destroy();ma._setUpdateOperationHandle(sa,ba)}else ma.updateGraphics.add(wa),sa.graphics=ma.updateGraphics.toArray(),sa.refresh(),ka.resetHistory();ma.emit("update",{graphics:ma.updateGraphics.toArray(),state:"active",aborted:!1,tool:ma.activeTool,toolEventInfo:{added:[wa],removed:[],type:"selection-change"},type:"update"})});return function(wa){return ya.apply(this,arguments)}}(),
removeFromSelection:function(){var ya=n._asyncToGenerator(function*(wa){const sa=ma.updateGraphics.indexOf(wa);ka.history.undo.forEach(Ba=>Ba.updates.splice(sa,1));ka.history.redo.forEach(Ba=>Ba.updates.splice(sa,1));ma.updateGraphics.remove(wa);const za=ma.updateGraphics.toArray();if(0===za.length)ka.complete();else{const Ba=za[0].geometry;1!==za.length||!d.isSome(Ba)||"point"!==Ba.type&&"multipoint"!==Ba.type?ka.activeComponent.graphics=za:ka.toggleTool()}ma.emit("update",{graphics:za,state:"active",
aborted:!1,tool:ma.activeTool,toolEventInfo:{added:[],removed:[wa],type:"selection-change"},type:"update"})});return function(wa){return ya.apply(this,arguments)}}(),toggleTool:function(){var ya=n._asyncToGenerator(function*(){if(!(1<ma.updateGraphics.length)){var wa=ma.updateGraphics.getItemAt(0),sa=wa.geometry;d.isSome(sa)&&("reshape"===ka.tool&&("point"===sa.type||"multipoint"===sa.type)||"transform"===ka.tool&&"extent"===sa.type)||(sa=null,"transform"===ka.tool?sa=yield ma._getReshape([wa],ba,
ia):"reshape"===ka.tool&&(sa=yield ma._getBox([wa],ba,ia)),oa(sa)||(ka.activeComponent?.destroy(),ka.activeComponent=sa,ka.activeComponent&&(xa.forEach(za=>za.remove()),xa=ma._getHandlesForComponent(ka,ba))))}});return function(){return ya.apply(this,arguments)}}()});let qa=[ia.on("immediate-click",ya=>this._getCommonUpdateOperationClickHandlers(ka,ya,ba),D.ViewEventPriorities.WIDGET),ia.on("key-down",ya=>{this._getCommonUpdateOperationKeyDownHandlers(ka,ya);ya.key===f.SKETCH_KEYS.constraint&&!ya.repeat&&
ka&&(ya=ka.activeComponent)&&"box"===ya.type&&(ya.preserveAspectRatio=!ya.preserveAspectRatio)},D.ViewEventPriorities.WIDGET),ia.on("key-up",ya=>{ya.key===f.SKETCH_KEYS.constraint&&ka&&(ya=ka.activeComponent)&&"box"===ya.type&&(ya.preserveAspectRatio=!ya.preserveAspectRatio)},D.ViewEventPriorities.WIDGET)],xa=this._getHandlesForComponent(ka,ba);return ka});return function(aa,ea,ba,ia){return X.apply(this,arguments)}}();fa._getGraphicMover=function(){var X=n._asyncToGenerator(function*(aa,ea,ba){({enableMoveAllGraphics:ea}=
ea);const ia=yield this._requireModule(new Promise((ma,ka)=>b(["../../views/draw/support/GraphicMover"],qa=>ma(ra(qa)),ka)));return oa(ia)?ia:new ia.module.default({enableMoveAllGraphics:ea,highlightsEnabled:!0,indicatorsEnabled:!1,graphics:aa,view:ba,callbacks:{onGraphicMoveStart:({dx:ma,dy:ka,graphic:qa})=>{this._displayGrabbingCursor();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ma,dy:ka,mover:qa,type:"move-start"},
type:"update"})},onGraphicMove:({dx:ma,dy:ka,graphic:qa})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ma,dy:ka,mover:qa,type:"move"},type:"update"}),onGraphicMoveStop:({dx:ma,dy:ka,graphic:qa})=>{this._displayPointerCursor();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ma,dy:ka,mover:qa,type:"move-stop"},type:"update"})},onGraphicPointerOver:()=>
this._displayPointerCursor(),onGraphicPointerOut:()=>this._displayDefaultCursor()}})});return function(aa,ea,ba){return X.apply(this,arguments)}}();fa._getBox=function(){var X=n._asyncToGenerator(function*(aa,ea,ba){const {enableRotation:ia,enableScaling:ma,preserveAspectRatio:ka}=ea;ea=yield this._requireModule(new Promise((qa,xa)=>b(["../../views/draw/support/Box"],ya=>qa(ra(ya)),xa)));return oa(ea)?ea:new ea.module.default({graphics:aa,enableRotation:ia,enableScaling:ma,preserveAspectRatio:ka,
layer:this._internalGraphicsLayer,view:ba,tooltipOptions:this.tooltipOptions,callbacks:{onMoveStart:qa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...qa},type:"update"}),onMove:qa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...qa},type:"update"}),onMoveStop:qa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,
tool:this.activeTool,toolEventInfo:{...qa},type:"update"}),onScaleStart:qa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...qa},type:"update"}),onScale:qa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...qa},type:"update"}),onScaleStop:qa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...qa},
type:"update"}),onRotateStart:qa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...qa},type:"update"}),onRotate:qa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...qa},type:"update"}),onRotateStop:qa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...qa},type:"update"})}})});
return function(aa,ea,ba){return X.apply(this,arguments)}}();fa._getReshape=function(){var X=n._asyncToGenerator(function*(aa,ea,ba){const ia="split"===ea.reshapeOptions?.edgeOperation;ea="move"===ea.reshapeOptions?.shapeOperation;const ma=yield this._requireModule(new Promise((ka,qa)=>b(["../../views/draw/support/Reshape"],xa=>ka(ra(xa)),qa)));return oa(ma)?ma:new ma.module.default({enableMidpoints:ia,enableMovement:ea,graphic:aa[0],layer:this._internalGraphicsLayer,snappingManager:this._snappingManager,
tooltipOptions:this.tooltipOptions,view:ba,callbacks:{onReshapeStart:ka=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ka},type:"update"}),onReshape:ka=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ka},type:"update"}),onReshapeStop:({mover:ka,type:qa})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,
toolEventInfo:{mover:ka,type:qa},type:"update"}),onMoveStart:({dx:ka,dy:qa,mover:xa,type:ya})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ka,dy:qa,mover:xa,type:ya},type:"update"}),onMove:({dx:ka,dy:qa,mover:xa,type:ya})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ka,dy:qa,mover:xa,type:ya},type:"update"}),onMoveStop:({dx:ka,dy:qa,mover:xa,
type:ya})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ka,dy:qa,mover:xa,type:ya},type:"update"}),onVertexAdd:({added:ka,type:qa,vertices:xa})=>{ka=ka.map(ya=>P.geometryToCoordinates(ya.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:ka,vertices:xa,type:qa},type:"update"})},onVertexRemove:({removed:ka,type:qa,vertices:xa})=>{ka=ka.map(ya=>
P.geometryToCoordinates(ya.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{removed:ka,vertices:xa,type:qa},type:"update"})}}})});return function(aa,ea,ba){return X.apply(this,arguments)}}();fa._getHandlesForComponent=function(X,aa){const ea=X.activeComponent;if(!ea)return[];switch(ea.type){case "graphic-mover":return[ea.on("graphic-click",({graphic:ba,viewEvent:ia})=>{ia.native?.shiftKey&&(ia.stopPropagation(),X.removeFromSelection(ba))}),
ea.on("graphic-move-start",ba=>X.addToHistory(ja(ba.allGraphics)))];case "box":return[ea.on("graphic-click",ba=>this._onTransformOrReshape2DGraphicClick(X,aa,ba)),ea.on("move-start",ba=>X.addToHistory(ja(ba.graphics))),ea.on("rotate-start",ba=>X.addToHistory(ja(ba.graphics))),ea.on("scale-start",ba=>X.addToHistory(ja(ba.graphics)))];case "reshape":return[ea.on("graphic-click",ba=>this._onTransformOrReshape2DGraphicClick(X,aa,ba)),ea.on("move-start",ba=>X.addToHistory(ja([ba.mover]))),ea.on("reshape-start",
ba=>X.addToHistory(ja([ba.graphic]))),ea.on("vertex-add",ba=>X.addToHistory(ja([ba.oldGraphic]))),ea.on("vertex-remove",ba=>X.addToHistory(ja([ba.oldGraphic])))];case "move-3d":return[ea.on("graphic-move-start",ba=>{X.addToHistory(ja(ba.allGraphics));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:0<ba.allGraphics.length?ba.allGraphics[0]:null,type:"move-start"},type:"update"})}),ea.on("graphic-move",ba=>{this.emit("update",
{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ba.dx,dy:ba.dy,mover:0<ba.allGraphics.length?ba.allGraphics[0]:null,type:"move"},type:"update"})}),ea.on("graphic-move-stop",ba=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:0<ba.allGraphics.length?ba.allGraphics[0]:null,type:"move-stop"},type:"update"})}),ea.on("immediate-click",ba=>{ba.shiftKey?this._toggleSelection([ba.graphic],
X,aa):X.toggleTool()})];case "transform-3d":return[ea.on("record-undo",({record:ba})=>{X.addToHistory({updates:[ba]})}),ea.on("graphic-translate-start",ba=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ba.graphic,dx:ba.dxScreen,dy:ba.dyScreen,type:"move-start"},type:"update"})}),ea.on("graphic-translate-stop",ba=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,
toolEventInfo:{mover:ba.graphic,dx:ba.dxScreen,dy:ba.dyScreen,type:"move-stop"},type:"update"})}),ea.on("graphic-rotate-start",ba=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ba.graphic,angle:ba.angle,type:"rotate-start"},type:"update"})}),ea.on("graphic-rotate-stop",ba=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ba.graphic,angle:ba.angle,
type:"rotate-stop"},type:"update"})}),ea.on("graphic-scale-start",ba=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ba.graphic,xScale:ba.xScale,yScale:ba.yScale,type:"scale-start"},type:"update"})}),ea.on("graphic-scale-stop",ba=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ba.graphic,xScale:ba.xScale,yScale:ba.yScale,type:"scale-stop"},
type:"update"})}),ea.on("graphic-translate",ba=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ba.graphic,dx:ba.dxScreen,dy:ba.dyScreen,type:"move"},type:"update"})}),ea.on("graphic-rotate",ba=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ba.graphic,angle:ba.angle,type:"rotate"},type:"update"})}),ea.on("graphic-scale",ba=>{this.emit("update",
{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ba.graphic,xScale:ba.xScale,yScale:ba.yScale,type:"scale"},type:"update"})}),ea.on("immediate-click",ba=>{ba.shiftKey?this._toggleSelection([ba.graphic],X,aa):X.toggleTool()})];case "reshape-3d":return[ea.on("reshape",ba=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:ba,type:"update"})}),ea.on("move",ba=>{this.emit("update",
{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:ba,type:"update"})}),ea.on("vertex-add",ba=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:ba,type:"update"})}),ea.on("vertex-remove",ba=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:ba,type:"update"})}),ea.on("immediate-click",ba=>{ba.shiftKey?this._toggleSelection([ba.graphic],
X,aa):X.toggleTool()})]}};fa._onTransformOrReshape2DGraphicClick=function(X,aa,ea){const {graphic:ba,viewEvent:ia}=ea;if(ia.native?.shiftKey&&ba.layer===this.layer)return ia.stopPropagation(),X.removeFromSelection(ba);if(aa.toggleToolOnClick)return ia.stopPropagation(),X.toggleTool()};fa._setUpdateOperationHandle=function(X,aa){this._operationHandle=X;const ea=this.view?.map;this._disablePopup(aa);X.on("complete",()=>{if(X===this._operationHandle){const ba=this.updateGraphics.toArray(),ia=this._operationHandle.tool;
this._operationHandle.destroy();this._operationHandle=null;this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray());this.updateGraphics.removeAll();ea&&ea.remove(this._internalGraphicsLayer);this._restorePopup(aa);this.emit("update",{graphics:ba,state:"complete",aborted:X.cancelled,tool:ia,toolEventInfo:null,type:"update"})}})};fa._getCommonUpdateOperationClickHandlers=function(){var X=n._asyncToGenerator(function*(aa,ea,ba){const ia=m.createScreenPointFromEvent(ea),ma=yield ea.async(()=>
this._getFirstHit(ia));d.isNone(ma)?aa.complete():ea.native.shiftKey&&this._toggleSelection([ma.graphic],aa,ba)?ea.stopPropagation():this.updateGraphics.includes(ma.graphic)?ea.stopPropagation():aa.complete()});return function(aa,ea,ba){return X.apply(this,arguments)}}();fa._toggleSelection=function(X,aa,ea){const ba=!!ea.multipleSelectionEnabled;return X.some(ia=>null==ia?!1:ba&&ia.layer===this.layer?(this.updateGraphics.includes(ia)?aa.removeFromSelection(ia):aa.addToSelection(ia),!0):!1)};fa._getCommonUpdateOperationKeyDownHandlers=
function(X,aa){if(X){var ea=aa.key;ea===f.SKETCH_KEYS.undo&&X.canUndo()?(aa.stopPropagation(),X.undo()):ea===f.SKETCH_KEYS.redo&&X.canRedo()?(aa.stopPropagation(),X.redo()):ea===f.SKETCH_KEYS.cancel?(aa.stopPropagation(),X.cancel()):this.allowDeleteKey&&f.SKETCH_KEYS.delete.includes(ea)&&this._onDeleteKey(aa)}};fa._onDeleteKey=function(X){if(this._operationHandle&&"update"===this._operationHandle.type){var aa=this.activeComponent,ea=this.updateGraphics.toArray();d.isNone(aa)||"reshape-3d"===aa.type||
"reshape"===aa.type&&(1!==ea.length||"point"!==d.get(ea[0].geometry,"type"))||(X.stopPropagation(),this.delete())}};fa._removeDefaultLayer=function(){this._internalGraphicsLayer&&(this.view?.map?.remove(this._internalGraphicsLayer),this._internalGraphicsLayer=d.destroyMaybe(this._internalGraphicsLayer))};fa._isComponentGraphic=function(X){const {activeComponent:aa}=this;return!X||d.isNone(aa)?!1:X.attributes&&X.attributes.esriSketchTool||"draw-2d"===aa.type&&aa.graphic===X||("box"===aa.type||"reshape"===
aa.type)&&aa.isUIGraphic(X)};fa._displayPointerCursor=function(){this.view&&this.view.container&&"pointer"!==this.view.cursor&&(this.view.cursor="pointer")};fa._displayGrabbingCursor=function(){this.view&&this.view.container&&"grabbing"!==this.view.cursor&&(this.view.cursor="grabbing")};fa._displayDefaultCursor=function(){this.view&&this.view.container&&null!==this.view.cursor&&(this.view.cursor=null)};fa._logError=function(X,aa,ea){t.getLogger(this.declaredClass).error(new K(X,aa,ea))};fa._requireModule=
function(){var X=n._asyncToGenerator(function*(aa){const ea=new AbortController;this._moduleLoaderAbortController=ea;aa=yield aa;return this._moduleLoaderAbortController!==ea||ea.signal.aborted?{requireError:"aborted"}:{module:aa}});return function(aa){return X.apply(this,arguments)}}();fa._emitUndoEvent=function(X){this.emit("undo",{...X,type:"undo"})};fa._emitRedoEvent=function(X){this.emit("redo",{...X,type:"redo"})};fa._emitDeleteEvent=function(X){this.emit("delete",{...X,type:"delete"})};fa.wait=
function(){return r.whenOnce(()=>!this.updating)};fa._beginAsyncOperation=function(){this._numUpdating+=1;this.notifyChange("updating")};fa._endAsyncOperation=function(){--this._numUpdating;this.notifyChange("updating")};fa._disablePopupEnabled=function(X){return"3d"!==this.view?.type||this.updateOnGraphicClick||(d.unwrap(X)?.toggleToolOnClick??!1)};fa._disablePopup=function(X){this._disablePopupEnabled(X)&&(X=this.view?.popup)&&d.isNone(this._originalAutoOpenEnabled)&&(this._originalAutoOpenEnabled=
X.autoOpenEnabled,X.autoOpenEnabled=!1)};fa._restorePopup=function(X){this._disablePopupEnabled(X)&&(X=this.view?.popup)&&d.isSome(this._originalAutoOpenEnabled)&&(X.autoOpenEnabled=this._originalAutoOpenEnabled,this._originalAutoOpenEnabled=null)};fa._waitViewReady=function(){var X=n._asyncToGenerator(function*(){const aa=this.view;aa?(d.abortMaybe(this._viewReadyAbortController),this._viewReadyAbortController=new AbortController,yield k.whenOrAbort(r.whenOnce(()=>aa?.ready),this._viewReadyAbortController.signal)):
this._logMissingView()});return function(){return X.apply(this,arguments)}}();fa._logMissingView=function(){this._logError("sketch:missing-property",Aa("view"))};fa._logMissingLayer=function(){this._logError("sketch:missing-property",Aa("layer"))};n._createClass(da,[{key:"_defaultUpdateTool",get:function(){return"3d"===this.view?.type?"move":"transform"}},{key:"updating",get:function(){return 0<this._numUpdating||d.isSome(this._snappingManager)&&this._snappingManager.updating}},{key:"activeTool",
get:function(){return this._operationHandle?.tool??null}},{key:"activeComponent",get:function(){return this._operationHandle?.activeComponent??null}},{key:"createGraphic",get:function(){return!d.isSome(this.activeComponent)||"draw-3d"!==this.activeComponent.type&&"draw-2d"!==this.activeComponent.type?this._get("createGraphic"):d.unwrap(this.activeComponent.graphic)}},{key:"defaultCreateOptions",get:function(){return this._get("defaultCreateOptions")},set:function(X){this._set("defaultCreateOptions",
{...ta,...X})}},{key:"defaultUpdateOptions",get:function(){return this._get("defaultUpdateOptions")},set:function(X){this._set("defaultUpdateOptions",{...ua,...X,reshapeOptions:{...ua.reshapeOptions,...X?.reshapeOptions}})}},{key:"snappingOptions",set:function(X){d.isSome(this._snappingManager)&&(this._snappingManager.options=X);this._set("snappingOptions",X)}},{key:"state",get:function(){const X=!(!this.view?.ready||!this.layer),aa=this._operationHandle;return X&&aa?"active":X?"ready":"disabled"}},
{key:"view",get:function(){return this._get("view")},set:function(X){const aa=this._get("view");if(aa){const {container:ea,map:ba}=aa;ea&&(aa.cursor=null);ba&&ba.remove(this._internalGraphicsLayer);this._viewHandles.removeAll();this.cancel()}this._handles.remove("view-ready");X&&this._handles.add(r.when(()=>X.ready,ea=>{this._viewHandles.removeAll();ea&&this._viewHandles.add(this._generateViewHandles(X))},r.syncAndInitial),"view-ready");this._set("view",X)}},{key:"test",get:function(){return{operationHandle:this._operationHandle,
defaultUpdateOptions:ua}}}]);return da}(E.EventedAccessor);e.__decorate([l.property()],E.prototype,"updating",null);e.__decorate([l.property()],E.prototype,"_operationHandle",void 0);e.__decorate([l.property({readOnly:!0})],E.prototype,"activeTool",null);e.__decorate([l.property()],E.prototype,"activeFillSymbol",void 0);e.__decorate([l.property()],E.prototype,"activeLineSymbol",void 0);e.__decorate([l.property()],E.prototype,"activeVertexSymbol",void 0);e.__decorate([l.property()],E.prototype,"allowDeleteKey",
void 0);e.__decorate([l.property({readOnly:!0})],E.prototype,"createGraphic",null);e.__decorate([l.property()],E.prototype,"defaultCreateOptions",null);e.__decorate([l.property()],E.prototype,"defaultUpdateOptions",null);e.__decorate([l.property({type:A,nonNullable:!0})],E.prototype,"labelOptions",void 0);e.__decorate([l.property()],E.prototype,"layer",void 0);e.__decorate([l.property({types:H.symbolTypes})],E.prototype,"pointSymbol",void 0);e.__decorate([l.property({types:H.symbolTypes})],E.prototype,
"polygonSymbol",void 0);e.__decorate([l.property({types:H.symbolTypes})],E.prototype,"polylineSymbol",void 0);e.__decorate([l.property({type:N,nonNullable:!0})],E.prototype,"snappingOptions",null);e.__decorate([l.property()],E.prototype,"_snappingManager",void 0);e.__decorate([l.property({readOnly:!0})],E.prototype,"state",null);e.__decorate([l.property({type:J,nonNullable:!0})],E.prototype,"tooltipOptions",void 0);e.__decorate([l.property({readOnly:!0})],E.prototype,"updateGraphics",void 0);e.__decorate([l.property()],
E.prototype,"updateOnGraphicClick",void 0);e.__decorate([l.property({types:H.symbolTypes})],E.prototype,"updatePointSymbol",void 0);e.__decorate([l.property({types:H.symbolTypes})],E.prototype,"updatePolygonSymbol",void 0);e.__decorate([l.property({types:H.symbolTypes})],E.prototype,"updatePolylineSymbol",void 0);e.__decorate([l.property({types:H.symbolTypes})],E.prototype,"vertexSymbol",void 0);e.__decorate([l.property({value:null})],E.prototype,"view",null);E=e.__decorate([x.subclass("esri.widgets.Sketch.SketchViewModel")],
E);const Aa=Z=>`Property '${Z}' is missing on SketchViewModel.`;return E})},"esri/views/3d/interactive/editingTools/isSupportedGraphicUtils":function(){define(["exports","../../../../core/has"],function(b,n){b.SupportedGraphicResult=void 0;(function(e){e[e.SUPPORTED=0]="SUPPORTED";e[e.GRAPHICS_LAYER_MISSING=1]="GRAPHICS_LAYER_MISSING";e[e.GEOMETRY_MISSING=2]="GEOMETRY_MISSING";e[e.GEOMETRY_TYPE_UNSUPPORTED=3]="GEOMETRY_TYPE_UNSUPPORTED";e[e.ELEVATION_MODE_UNSUPPORTED=4]="ELEVATION_MODE_UNSUPPORTED";
e[e.SYMBOL_TYPE_UNSUPPORTED=5]="SYMBOL_TYPE_UNSUPPORTED"})(b.SupportedGraphicResult||(b.SupportedGraphicResult={}));b.isSupportedGraphicResultMessage=function(e){switch(e){case b.SupportedGraphicResult.GRAPHICS_LAYER_MISSING:return"not owned by a graphics layer";case b.SupportedGraphicResult.GEOMETRY_MISSING:return"no geometry";case b.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED:return"the geometry type is not supported";case b.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED:return"the elevation mode is not supported";
case b.SupportedGraphicResult.SYMBOL_TYPE_UNSUPPORTED:return"the symbol type is not supported"}return""};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/moveGraphic/isSupportedGraphic":function(){define(["exports","../../../../../core/has","../../../../../core/maybe","../../../../../support/elevationInfoUtils","../isSupportedGraphicUtils"],function(b,n,e,H,u){b.isSupportedGraphic=function(K){if("graphics"!==K.layer?.type)return u.SupportedGraphicResult.GRAPHICS_LAYER_MISSING;
if(e.isNone(K.geometry))return u.SupportedGraphicResult.GEOMETRY_MISSING;switch(K.geometry.type){case "polygon":case "point":case "polyline":case "mesh":break;case "multipoint":case "extent":return u.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED;default:return u.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED}return"on-the-ground"!==H.getGraphicEffectiveElevationMode(K)&&H.hasGraphicFeatureExpressionInfo(K)?u.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED:u.SupportedGraphicResult.SUPPORTED};
Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/support/elevationInfoUtils":function(){define(["exports","../core/maybe","../symbols/support/unitConversionUtils"],function(b,n,e){function H(l,p){return n.isNone(p)||!p.mode?(l?k:r).mode:p.mode}function u(l,p){return n.isSome(p)?p:l?k:r}function K(l,p){return H(n.isSome(l)?l.hasZ:!1,p)}function E(l){const p=h(l);return K(l.geometry,p)}function h(l){return l.layer&&"elevationInfo"in l.layer?l.layer.elevationInfo:null}function t(l,
p,B,x,y,G,P=null){if(!n.isNone(G)){var O=n.isSome(P)?P.mode:"absolute-height";if("on-the-ground"===O)return 0;({absoluteZ:G}=d(p,B,x,y,l,G));a:{P=n.isSome(P)&&n.isSome(P.offset)?P.offset:0;switch(O){case "absolute-height":l=G-P;break a;case "relative-to-ground":l=G-(n.unwrapOr(l.elevationProvider.getElevation(p,B,x,y,"ground"),0)+P);break a;case "relative-to-scene":l=G-(n.unwrapOr(l.elevationProvider.getElevation(p,B,x,y,"scene"),0)+P);break a}l=void 0}return l}}function d(l,p,B,x,y,G){const P=n.isSome(G.offset)?
G.offset:0;switch(G.mode){case "absolute-height":return{absoluteZ:B+P,elevation:0};case "on-the-ground":return B=n.unwrapOr(y.elevationProvider.getElevation(l,p,0,x,"ground"),0),{absoluteZ:B,elevation:B};case "relative-to-ground":return l=n.unwrapOr(y.elevationProvider.getElevation(l,p,B,x,"ground"),0),{absoluteZ:B+l+P,elevation:l};case "relative-to-scene":return l=n.unwrapOr(y.elevationProvider.getElevation(l,p,B,x,"scene"),0),{absoluteZ:B+l+P,elevation:l}}}const k={mode:"absolute-height",offset:0},
r={mode:"on-the-ground",offset:null};b.absoluteHeightElevationInfo=k;b.elevationContextAffectsAlignment=function(l,p){if(n.isNone(p))return!1;({mode:p}=p);return n.isSome(p)&&("scene"===l&&"relative-to-scene"===p||"ground"===l&&"absolute-height"!==p)};b.elevationInfoLikeEquals=function(l,p){return l===p||n.isSome(l)&&n.isSome(p)&&l.mode===p.mode&&l.offset===p.offset};b.getConvertedElevation=function(l,p,B,x=null){return t(l,p.x,p.y,p.hasZ?p.z:0,p.spatialReference,B,x)};b.getConvertedElevationFromVector=
function(l,p,B,x,y=null){return t(l,p[0],p[1],2<p.length?p[2]:0,B,x,y)};b.getEffectiveElevationInfo=u;b.getEffectiveElevationMode=H;b.getGeometryEffectiveElevationInfo=function(l,p){return u(n.isSome(l)?!!l.hasZ:!1,p)};b.getGeometryEffectiveElevationMode=K;b.getGraphicEffectiveElevationInfo=function(l){var p=h(l);l=K(l.geometry,p);p=n.isSome(p)&&"on-the-ground"!==l?n.unwrapOr(p.offset,0)*e.getMetersPerUnit(n.unwrapOr(p.unit,"meters")):0;return{mode:l,offset:p}};b.getGraphicEffectiveElevationMode=
E;b.getZForElevationMode=function(l,p,B){if(!n.isNone(B)&&B.mode){var x=l.hasZ?l.z:0,y=n.isSome(B.offset)?B.offset:0;switch(B.mode){case "absolute-height":return x-y;case "on-the-ground":return 0;case "relative-to-ground":return l=n.unwrapOr(p.elevationProvider.getElevation(l.x,l.y,x,l.spatialReference,"ground"),0)+y,x-l;case "relative-to-scene":return l=n.unwrapOr(p.elevationProvider.getElevation(l.x,l.y,x,l.spatialReference,"scene"),0)+y,x-l}}};b.hasGraphicFeatureExpressionInfo=function(l){if("on-the-ground"===
E(l))return!1;l=h(l);l=n.isSome(l)&&l.featureExpressionInfo?l.featureExpressionInfo.expression:null;return!(!l||"0"===l)};b.onTheGroundElevationInfo=r;b.zValueInAbsoluteHeightMode=d;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/reshapeGraphic/isSupportedGraphic":function(){define(["exports","../../../../../core/maybe","../../../../../geometry/Circle","../../../../../support/elevationInfoUtils","../isSupportedGraphicUtils"],function(b,n,e,H,
u){function K(E){return"graphics"!==E.layer?.type?{result:u.SupportedGraphicResult.GRAPHICS_LAYER_MISSING,geometry:null}:n.isNone(E.geometry)?{result:u.SupportedGraphicResult.GEOMETRY_MISSING,geometry:null}:"on-the-ground"!==H.getGraphicEffectiveElevationMode(E)&&H.hasGraphicFeatureExpressionInfo(E)?{result:u.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED,geometry:null}:"point"!==E.geometry.type&&"polyline"!==E.geometry.type&&("polygon"!==E.geometry.type||E.geometry instanceof e)?{result:u.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED,
geometry:null}:{result:u.SupportedGraphicResult.SUPPORTED,geometry:E.geometry}}b.geometryOfSupportedGraphic=function(E){return K(E).geometry};b.isSupportedGraphic=function(E){return K(E).result};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/Circle":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/unitUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/accessorSupport/decorators/subclass ./ellipsoidUtils ./Point ./Polygon ./support/geodesicUtils ./support/webMercatorUtils ./support/WKIDUnitConversion".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k,r,l){var p;u=p=function(B){function x(...G){G=B.call(this,...G)||this;G.center=null;G.geodesic=!1;G.numberOfPoints=60;G.radius=1E3;G.radiusUnit="meters";return G}b._inheritsLoose(x,B);var y=x.prototype;y.normalizeCtorArgs=function(G,P){if(!G||!G.center){if(G&&G.rings)return B.prototype.normalizeCtorArgs.call(this,G,P);G={center:G}}return{...B.prototype.normalizeCtorArgs.call(this),...G,...P}};y.initialize=function(){var G=this.center;const P=this.numberOfPoints;this.hasZ=
G?.hasZ??!1;if(0===this.rings.length&&G){var O=e.convertUnit(this.radius,this.radiusUnit,"meters"),L=G.spatialReference,g="geographic";if(L.isWebMercator)g="webMercator";else if(null!=(L.wkid&&l[L.wkid])||L.wkt&&0===L.wkt.indexOf("PROJCS"))g="projected";if(this.geodesic){let c;switch(g){case "webMercator":c=r.webMercatorToGeographic(G);break;case "projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");break;case "geographic":c=
G}G=this._createGeodesicCircle(c,O,P);"webMercator"===g&&(G=r.geographicToWebMercator(G))}else{let c;"webMercator"===g||"projected"===g?c=O/this._convert2Meters(1,G.spatialReference):"geographic"===g&&(c=e.lengthToDegrees(O,"meters",h.getReferenceEllipsoid(G.spatialReference).radius));G=this._createPlanarCircle(G,c,P)}this.spatialReference=G.spatialReference;this.addRing(G.rings[0])}};y.clone=function(){const {center:G,numberOfPoints:P,radius:O,radiusUnit:L,geodesic:g}=this;return new p({center:G?.clone(),
numberOfPoints:P,radius:O,radiusUnit:L,geodesic:g})};y._createGeodesicCircle=function(G,P,O){let L=0;const g=[];for(;360>L;){const c=[0,0];k.directGeodeticSolver(c,[G.x,G.y],L,P);this.hasZ&&c.push(G.z);g.push(c);L+=360/O}g.push(g[0]);return new d(g)};y._createPlanarCircle=function(G,P,O){const L=[],g=2*Math.PI/O;for(let a=0;a<O;++a){var c=g*a;c=[G.x+Math.cos(-c)*P,G.y+Math.sin(-c)*P];this.hasZ&&c.push(G.z);L.push(c)}L.push(L[0]);return new d({spatialReference:G.spatialReference,rings:[L]})};y._convert2Meters=
function(G,P){if(P.wkid&&null!=l[P.wkid])P=l.values[l[P.wkid]];else{P=P.wkt;const O=P.lastIndexOf(",")+1,L=P.lastIndexOf("]]");P=parseFloat(P.substring(O,L))}return G*P};return x}(d);n.__decorate([H.property({type:t})],u.prototype,"center",void 0);n.__decorate([H.property()],u.prototype,"geodesic",void 0);n.__decorate([H.property()],u.prototype,"numberOfPoints",void 0);n.__decorate([H.property()],u.prototype,"radius",void 0);n.__decorate([H.property()],u.prototype,"radiusUnit",void 0);return u=p=
n.__decorate([E.subclass("esri.geometry.Circle")],u)})},"esri/geometry/support/geodesicUtils":function(){define("exports ../../geometry ../../core/Error ../../core/unitUtils ./geodesicConstants ./spatialReferenceUtils ../Polyline ../Polygon ../Point ../SpatialReference".split(" "),function(b,n,e,H,u,K,E,h,t,d){function k(O){if(!O)return null;if(K.isGeographic(O)&&O.wkid){var L=u.spheroids[O.wkid];if(L)return L}return O.wkt&&((O=u.WKT_SPHEROID_REGEX.exec(O.wkt))&&2===O.length?(L=O[1].split(","),!L||
3>L.length?O=null:(O=parseFloat(L[1]),L=parseFloat(L[2]),O=isNaN(O)||isNaN(L)?null:{a:O,f:0===L?0:1/L})):O=null,O)?O:null}function r(O){O=k(O??d.WGS84);if(null!=O&&"b"in O&&"eSq"in O&&"radius"in O)return O;const L=O.a*(1-O.f);return Object.assign(O,{b:L,eSq:1-(L/O.a)**2,radius:(2*O.a+L)/3,densificationRatio:1E4/((2*O.a+L)/3)})}function l(O){return null!=O&&0>O?O+360:O}function p(O,L,g){const {a:c,eSq:a}=r(g);g=Math.sqrt(a);const v=Math.sin(L[1]*u.toRadians);L=c*L[0]*u.toRadians;g=0<a?c*(1-a)*(v/(1-
a*v*v)-1/(2*g)*Math.log((1-g*v)/(1+g*v)))*.5:c*v;O[0]=L;O[1]=g;return O}function B(O){return null!==k(O)}function x(O,L){if("polyline"!==O.type&&"polygon"!==O.type)throw new e("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");const {spatialReference:g}=O;if(!B(g))throw new e("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");var c="polyline"===O.type?O.paths:O.rings;const a=[],v=[0,0],Q=new P;for(const A of c){c=
[];a.push(c);c.push([A[0][0],A[0][1]]);var D=A[0][0],f=A[0][1];let J,z;for(let N=0;N<A.length-1;N++){J=A[N+1][0];z=A[N+1][1];if(D===J&&f===z)continue;const F=[D,f];G(Q,[D,f],[J,z],g);const {azimuth:R,distance:m}=Q;D=m/L;if(1<D){for(f=1;f<=D-1;f++)y(v,F,R,f*L,g),c.push(v.slice(0));y(v,F,R,(m+Math.floor(D-1)*L)/2,g);c.push(v.slice(0))}y(v,F,R,m,g);c.push(v.slice(0));D=v[0];f=v[1]}}return"polyline"===O.type?new E({paths:a,spatialReference:g}):new h({rings:a,spatialReference:g})}function y(O,L,g,c,a){const v=
L[0]*u.toRadians;L=L[1]*u.toRadians;g=(g??0)*u.toRadians;const {a:Q,b:D,f}=r(a);a=Math.sin(g);g=Math.cos(g);var A=(1-f)*Math.tan(L);L=1/Math.sqrt(1+A*A);const J=A*L,z=Math.atan2(A,g);A=L*a;const N=A*A;var F=1-N,R=F*(Q*Q-D*D)/(D*D);const m=1+R/16384*(4096+R*(-768+R*(320-175*R))),C=R/1024*(256+R*(-128+R*(74-47*R)));R=c/(D*m);let M=2*Math.PI,w,U,T,S;for(;1E-12<Math.abs(R-M);)T=Math.cos(2*z+R),w=Math.sin(R),U=Math.cos(R),S=C*w*(T+C/4*(U*(-1+2*T*T)-C/6*T*(-3+4*w*w)*(-3+4*T*T))),M=R,R=c/(D*m)+S;c=J*w-L*
U*g;F=f/16*F*(4+f*(4-3*F));c=Math.atan2(J*U+L*w*g,(1-f)*Math.sqrt(N+c*c))/u.toRadians;O[0]=(v+(Math.atan2(w*a,L*U-J*w*g)-(1-F)*f*A*(R+F*w*(T+F*U*(-1+2*T*T)))))/u.toRadians;O[1]=c;return O}function G(O,L,g,c){var a=L[0]*u.toRadians;L=L[1]*u.toRadians;var v=g[0]*u.toRadians;g=g[1]*u.toRadians;const {a:Q,b:D,f,radius:A}=r(c),J=v-a;var z=Math.atan((1-f)*Math.tan(L)),N=Math.atan((1-f)*Math.tan(g));c=Math.sin(z);z=Math.cos(z);const F=Math.sin(N);N=Math.cos(N);let R=1E3,m=J,C,M,w;let U,T,S;do{var Y=Math.sin(m);
var ha=Math.cos(m);w=Math.sqrt(N*Y*N*Y+(z*F-c*N*ha)*(z*F-c*N*ha));if(0===w)return O.distance=0,O.azimuth=void 0,O.reverseAzimuth=void 0,O;ha=c*F+z*N*ha;U=Math.atan2(w,ha);T=z*N*Y/w;M=1-T*T;Y=ha-2*c*F/M;isNaN(Y)&&(Y=0);S=f/16*M*(4+f*(4-3*M));C=m;m=J+(1-S)*f*T*(U+S*w*(Y+S*ha*(-1+2*Y*Y)))}while(1E-12<Math.abs(m-C)&&0<--R);if(0===R)return c=Math.acos(Math.sin(L)*Math.sin(g)+Math.cos(L)*Math.cos(g)*Math.cos(v-a))*A,a=v-a,O.azimuth=Math.atan2(Math.sin(a)*Math.cos(g),Math.cos(L)*Math.sin(g)-Math.sin(L)*
Math.cos(g)*Math.cos(a))/u.toRadians,O.distance=c,O.reverseAzimuth=void 0,O;a=M*(Q*Q-D*D)/(D*D);L=a/1024*(256+a*(-128+a*(74-47*a)));v=Math.atan2(z*Math.sin(m),z*F*Math.cos(m)-c*N);O.azimuth=Math.atan2(N*Math.sin(m),z*F-c*N*Math.cos(m))/u.toRadians;O.distance=D*(1+a/16384*(4096+a*(-768+a*(320-175*a))))*(U-L*w*(Y+L/4*(ha*(-1+2*Y*Y)-L/6*Y*(-3+4*w*w)*(-3+4*Y*Y))));O.reverseAzimuth=v/u.toRadians;return O}let P=function(O=0,L,g){this.distance=O;this.azimuth=L;this.reverseAzimuth=g};b.InverseGeodeticSolverResult=
P;b.directGeodeticSolver=y;b.geodesicAreas=function(O,L="square-meters"){if(O.some(v=>!B(v.spatialReference)))throw new e("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");const g=[];for(var c=0;c<O.length;c++){var a=O[c];const {radius:v,densificationRatio:Q}=r(a.spatialReference);g.push(x(a,v*Q))}O=[];c=[0,0];a=[0,0];for(let v=0;v<g.length;v++){const {rings:Q,spatialReference:D}=g[v];let f=0;for(let A=0;A<Q.length;A++){const J=Q[A];p(c,J[0],D);
p(a,J[J.length-1],D);let z=a[0]*c[1]-c[0]*a[1];for(let N=0;N<J.length-1;N++)p(c,J[N+1],D),p(a,J[N],D),z+=a[0]*c[1]-c[0]*a[1];f+=z}f=H.convertUnit(f,"square-meters",L);O.push(f/-2)}return O};b.geodesicDensify=x;b.geodesicDistance=function(O,L,g="meters"){if(!O||!L)throw new e("geodesic-distance:missing-parameters","one or both input parameters are missing");if(!O.spatialReference||!L.spatialReference)throw new e("geodesic-distance:invalid-parameters","one or both input points do not have a spatial reference");
if(!K.equals(O.spatialReference,L.spatialReference))throw new e("geodesic-distance:invalid-parameters","spatial references of input parameters do not match");const {spatialReference:c}=O;if(!B(c))throw new e("geodesic-distance:not-supported","input geometry spatial reference is not supported");if(O.x===L.x&&O.y===L.y)return new P(0,0,0);const a=new P;G(a,[O.x,O.y],[L.x,L.y],c);a.distance=H.convertUnit(a.distance,"meters",g);a.azimuth=l(a.azimuth);a.reverseAzimuth=l(a.reverseAzimuth);return a};b.geodesicLengths=
function(O,L="meters"){if(!O)throw new e("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(O.some(a=>!B(a.spatialReference)))throw new e("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");const g=[];for(let a=0;a<O.length;a++){var c=O[a];const {spatialReference:v}=c;c="polyline"===c.type?c.paths:c.rings;let Q=0;for(let D=0;D<c.length;D++){const f=c[D];let A=0;for(let J=1;J<f.length;J++){const z=f[J-1][0],N=f[J][0],
F=f[J-1][1],R=f[J][1];if(F!==R||z!==N){const m=new P;G(m,[z,F],[N,R],v);A+=m.distance}}Q+=A}Q=H.convertUnit(Q,"meters",L);g.push(Q)}return g};b.inverseGeodeticSolver=G;b.isSupported=B;b.pointFromDistance=function(O,L,g){if(!O||null==L||null==g)throw new e("point-from-distance:missing-parameters","one or more input parameters are missing or undefined");if(0>g||360<g)throw new e("point-from-distance:-of-bounds","azimuth is restricted to angles between, and including, 0\u00b0 to 360\u00b0 degrees");
if(!O.spatialReference)throw new e("point-from-distance:missing-spatial-reference","the input point must have a spatial reference");const {spatialReference:c}=O;if(!B(c))throw new e("geodesic-distance:not-supported","input geometry spatial reference is not supported");const a=[0,0];y(a,[O.x,O.y],g,L,c);return new t({x:a[0],y:a[1],spatialReference:c})};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/transformGraphic/isSupportedGraphic":function(){define(["exports",
"../../../../../core/has","../../../../../core/maybe","../../../../../support/elevationInfoUtils","../isSupportedGraphicUtils"],function(b,n,e,H,u){b.isSupportedGraphic=function(K){if("graphics"!==K.layer?.type)return u.SupportedGraphicResult.GRAPHICS_LAYER_MISSING;if(e.isNone(K.geometry))return u.SupportedGraphicResult.GEOMETRY_MISSING;switch(K.geometry.type){case "point":break;case "polygon":case "polyline":case "multipoint":case "extent":case "mesh":return u.SupportedGraphicResult.SUPPORTED;default:return u.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED}const E=
e.isSome(K.symbol)&&"point-3d"===K.symbol.type&&K.symbol.symbolLayers;return E&&0<E.length&&E.some(h=>"object"===h.type)?"on-the-ground"!==H.getGraphicEffectiveElevationMode(K)&&H.hasGraphicFeatureExpressionInfo(K)?u.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED:u.SupportedGraphicResult.SUPPORTED:u.SupportedGraphicResult.SYMBOL_TYPE_UNSUPPORTED};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/draw/support/layerUtils":function(){define(["exports","../../../core/maybe"],
function(b,n){b.addUniqueLayer=function(e,H,u){if(H&&e&&e.map){({map:e}=e);var K=e.layers.find(E=>E===H);K||e.add(H,u);K&&void 0!==u&&null!==u&&e.layers.reorder(K,u)}};b.findLayerView=function(e,H){return e.allLayerViews.find(u=>{u=u.layer;return u===H||"sublayers"in u&&n.isSome(u.sublayers)&&u.sublayers.includes(H)})};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/keybindings":function(){define(["exports"],function(b){b.SKETCH_KEYS={redo:"r",undo:"z",center:"Alt",
constraint:"Shift",cancel:"Escape",delete:["Backspace","Delete"],complete:"Enter",vertexAdd:"f",pan:" "};b.SNAPPING_KEYS={toggle:"Control"};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/SketchLabelOptions":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass".split(" "),
function(b,n,e,H,u,K,E){e=function(h){function t(d){d=h.call(this,d)||this;d.enabled=!1;return d}b._inheritsLoose(t,h);return t}(e);n.__decorate([H.property({type:Boolean,nonNullable:!0})],e.prototype,"enabled",void 0);return e=n.__decorate([E.subclass("esri.views.interactive.sketch.SketchLabelOptions")],e)})},"esri/views/interactive/sketch/SketchTooltipOptions":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ./SketchTooltipElevationOptions ./SketchTooltipVisibleElements".split(" "),
function(b,n,e,H,u,K,E,h,t){e=function(d){function k(r){r=d.call(this,r)||this;r.enabled=!1;r.elevation=new h.SketchTooltipElevationOptions;r.visibleElements=new t.SketchTooltipVisibleElements;r.visualVariables=null;return r}b._inheritsLoose(k,d);k.prototype.toJSON=function(){return{enabled:this.enabled,elevation:this.elevation,visibleElements:this.visibleElements}};return k}(e);n.__decorate([H.property({type:Boolean,nonNullable:!0})],e.prototype,"enabled",void 0);n.__decorate([H.property({type:h.SketchTooltipElevationOptions,
nonNullable:!0})],e.prototype,"elevation",void 0);n.__decorate([H.property({type:t.SketchTooltipVisibleElements,nonNullable:!0})],e.prototype,"visibleElements",void 0);n.__decorate([H.property()],e.prototype,"visualVariables",void 0);return e=n.__decorate([E.subclass("esri.widgets.Sketch.SketchTooltipOptions")],e)})},"esri/views/interactive/sketch/SketchTooltipElevationOptions":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass".split(" "),
function(b,n,e,H,u,K,E,h){b.SketchTooltipElevationOptions=function(t){function d(k){k=t.call(this,k)||this;k.mode="absolute-height";return k}n._inheritsLoose(d,t);d.prototype.toJSON=function(){return{mode:this.mode}};return d}(H);e.__decorate([u.property({type:String,nonNullable:!0})],b.SketchTooltipElevationOptions.prototype,"mode",void 0);b.SketchTooltipElevationOptions=e.__decorate([h.subclass("esri.widgets.Sketch.SketchTooltipOptions.ElevationOptions")],b.SketchTooltipElevationOptions);Object.defineProperty(b,
Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/SketchTooltipVisibleElements":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass".split(" "),function(b,n,e,H,u,K,E,h){b.SketchTooltipVisibleElements=function(t){function d(){var k=t.apply(this,arguments)||
this;k.distance=!0;k.elevation=!0;k.size=!0;k.scale=!0;k.rotation=!0;k.orientation=!0;k.totalLength=!0;k.area=!0;k.radius=!0;k.helpMessage=!1;return k}n._inheritsLoose(d,t);d.prototype.toJSON=function(){return{distance:this.distance,size:this.size,scale:this.scale,rotation:this.rotation,orientation:this.orientation,totalLength:this.totalLength,area:this.area,radius:this.radius}};return d}(H);e.__decorate([u.property({type:Boolean,nonNullable:!0})],b.SketchTooltipVisibleElements.prototype,"distance",
void 0);e.__decorate([u.property({type:Boolean,nonNullable:!0})],b.SketchTooltipVisibleElements.prototype,"elevation",void 0);e.__decorate([u.property({type:Boolean,nonNullable:!0})],b.SketchTooltipVisibleElements.prototype,"size",void 0);e.__decorate([u.property({type:Boolean,nonNullable:!0})],b.SketchTooltipVisibleElements.prototype,"scale",void 0);e.__decorate([u.property({type:Boolean,nonNullable:!0})],b.SketchTooltipVisibleElements.prototype,"rotation",void 0);e.__decorate([u.property({type:Boolean,
nonNullable:!0})],b.SketchTooltipVisibleElements.prototype,"orientation",void 0);e.__decorate([u.property({type:Boolean,nonNullable:!0})],b.SketchTooltipVisibleElements.prototype,"totalLength",void 0);e.__decorate([u.property({type:Boolean,nonNullable:!0})],b.SketchTooltipVisibleElements.prototype,"area",void 0);e.__decorate([u.property({type:Boolean,nonNullable:!0})],b.SketchTooltipVisibleElements.prototype,"radius",void 0);e.__decorate([u.property({type:Boolean,nonNullable:!0})],b.SketchTooltipVisibleElements.prototype,
"helpMessage",void 0);b.SketchTooltipVisibleElements=e.__decorate([h.subclass("esri.widgets.Sketch.SketchTooltipOptions.VisibleElements")],b.SketchTooltipVisibleElements);Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingManager":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Evented ../../../core/HandleOwner ../../../core/maybe ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ../../../geometry/projection ../../../support/elevationInfoUtils ./Settings ./SnappingDomain ./snappingFactory ./SnappingOptions ./SnappingPoint ./snappingUtils ./candidates/IntersectionSnappingCandidate ../support/viewUtils".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k,r,l,p,B,x,y,G,P,O,L,g){function c({coordinateHelper:v,elevationInfo:Q}){return v.hasZ()?p.absoluteHeightElevationInfo:Q}b.SnappingManager=function(v){function Q(f){f=v.call(this,f)||this;f.options=new G;f.snappingEnginesFactory=y.defaultSnappingEnginesFactory;f._engines=[];f._currentMainCandidate=null;f._currentOtherActiveCandidates=[];f._currentSnappedType=a.MAIN;return f}n._inheritsLoose(Q,v);var D=Q.prototype;D.initialize=function(){this.handles.add([h.watch(()=>
{const {effectiveFeatureEnabled:f,effectiveSelfEnabled:A,touchSensitivityMultiplier:J,distance:z}=this.options;return{effectiveFeatureEnabled:f,effectiveSelfEnabled:A,touchSensitivityMultiplier:J,distance:z}},()=>{this.doneSnapping();this.emit("changed")},h.sync),h.watch(()=>this.options,f=>{for(const A of this._engines)A.options=f},h.sync),h.watch(()=>({viewReady:this.view.ready,viewSpatialReference:this.view.spatialReference,snappingEnginesFactory:this.snappingEnginesFactory}),({viewReady:f,snappingEnginesFactory:A})=>
this._recreateEngines(f,A),h.syncAndInitial)])};D.destroy=function(){this._destroyEngines()};D._recreateEngines=function(f,A){this._destroyEngines();if(f){var {view:J,options:z}=this;this._engines=A(J,z)}};D._destroyEngines=function(){for(const f of this._engines)f.destroy();this._engines=[]};D.snap=function(){var f=n._asyncToGenerator(function*(A){return K.isSome(A.scenePoint)?this._snapMultiPoint(A):this._snapSinglePoint(A)});return function(A){return f.apply(this,arguments)}}();D.update=function(f){const {point:A,
context:J}=f;this._removeVisualization();const z=this._currentMainCandidate;if(K.isNone(z))return A;var N=this._selectUpdateInput(f);if(K.isNone(N))return A;({spatialReference:f}=J);var F=l.project(N,f);if(K.isNone(F))return A;({view:N}=this);const {elevationInfo:R,visualizer:m}=J,C=[];F=P.pointToSnappingPoint(F,N,J);const M=z.constraint.closestTo(F);if(!this._arePointsWithinScreenThreshold(F,M,J))return this._resetSnappingState(),A;z.targetPoint=M;C.push(...z.hints);for(const w of this._currentOtherActiveCandidates)w.targetPoint=
M,C.push(...w.hints);K.isSome(m)&&this.handles.add(m.draw(C,{spatialReference:f,elevationInfo:c(J),view:N,selfSnappingZ:J.selfSnappingZ}),"visualization-handle");return P.snappingPointToSnappingOutput(M,N,{z:A.z,m:A.m,spatialReference:A.spatialReference,elevationInfo:R})};D.doneSnapping=function(){this._removeVisualization();this._resetSnappingState()};D._selectUpdateInput=function({point:f,scenePoint:A}){switch(this._currentSnappedType){case a.MAIN:return f;case a.SCENE:return A}};D._resetSnappingState=
function(){this._currentMainCandidate=null;this._currentOtherActiveCandidates=[];this._currentSnappedType=a.MAIN};D._removeVisualization=function(){this.handles.remove("visualization-handle")};D._snapSinglePoint=function(){var f=n._asyncToGenerator(function*({point:A,context:J,signal:z}){const {view:N}=this,F=P.pointToSnappingPoint(A,N,J),R=yield this._fetchCandidates(F,x.SnappingDomain.ALL,J,z);return this._createSnapResult(F,a.MAIN,R,N,J,{z:A.z,m:A.m,spatialReference:A.spatialReference,elevationInfo:J.elevationInfo},
z)});return function(A){return f.apply(this,arguments)}}();D._snapMultiPoint=function(){var f=n._asyncToGenerator(function*({point:A,scenePoint:J,context:z,signal:N}){const {view:F}=this,{coordinateHelper:R,spatialReference:m}=z;yield l.initializeProjection(J.spatialReference,m);J=l.project(J,m);var C=P.pointToSnappingPoint(J,F,z);const M=yield this._fetchCandidates(C,x.SnappingDomain.FEATURE,z,N);if(0<M.length)return A=yield this._fetchCandidates(C,x.SnappingDomain.SELF,z,N),this._createSnapResult(C,
a.SCENE,[...M,...A],F,z,{z:J.z,m:J.m,spatialReference:J.spatialReference,elevationInfo:z.elevationInfo},N);J=P.pointToSnappingPoint(A,F,z);C=yield this._fetchCandidates(J,x.SnappingDomain.SELF,z,N);return this._createSnapResult(J,a.MAIN,C,F,z,{z:R.hasZ()&&A.hasZ?A.z??0:void 0,m:R.hasM()&&A.hasM?A.m??0:void 0,spatialReference:A.spatialReference,elevationInfo:z.elevationInfo},N)});return function(A){return f.apply(this,arguments)}}();D._fetchCandidates=function(){var f=n._asyncToGenerator(function*(A,
J,z,N){return(yield Promise.all(this._engines.map(F=>F.fetchCandidates(A,J,z,N)))).flat()});return function(A,J,z,N){return f.apply(this,arguments)}}();D._createSnapResult=function(f,A,J,z,N,F,R){return{get valid(){return!E.isAborted(R)},apply:()=>{const {spatialReference:m}=N,{snappedPoint:C,hints:M}=this._processCandidates(f,A,J,N);this._removeVisualization();K.isSome(N.visualizer)&&this.handles.add(N.visualizer.draw(M,{spatialReference:m,elevationInfo:p.absoluteHeightElevationInfo,view:z,selfSnappingZ:N.selfSnappingZ}),
"visualization-handle");return P.snappingPointToSnappingOutput(C,z,F)}}};D._processCandidates=function(f,A,J,z){if(1>J.length)return this.doneSnapping(),{snappedPoint:f,hints:[]};this._currentSnappedType!==A&&this._resetSnappingState();O.sortCandidatesInPlace(f,J);const N=this._currentMainCandidate;if(K.isSome(N)){const F=this._findOldConstraintInNewCandidates(N,J);if(0<=F)if(J[F]instanceof L.IntersectionSnappingCandidate){if(this._arePointsWithinScreenThreshold(f,N.targetPoint,z))return this._updateSnappingCandidate(N,
A,J,z)}else return this._intersectWithOtherCandidates(F,J,f,A,z)}return this._intersectWithOtherCandidates(0,J,f,A,z)};D._findOldConstraintInNewCandidates=function(f,A){return f instanceof L.IntersectionSnappingCandidate?0<=this._findOldCandidateIndex(A,f.first)&&0<=this._findOldCandidateIndex(A,f.second)?0:-1:this._findOldCandidateIndex(A,f)};D._intersectWithOtherCandidates=function(f,A,J,z,N){const {coordinateHelper:F}=N,R=A[f],m=[];for(let C=0;C<A.length;++C){if(C===f)continue;const M=A[C];for(const w of R.constraint.intersect(M.constraint)){const U=
w.closestTo(R.targetPoint);m.push([new L.IntersectionSnappingCandidate(U,R,M,M.isDraped),this._squaredScreenDistance(J,U,F)])}}return 0<m.length&&(m.sort((C,M)=>C[1]-M[1]),m[0][1]<this._squaredPointProximityThreshold(N.pointer))?this._updateSnappingCandidate(m[0][0],z,A,N):this._updateSnappingCandidate(R,z,A,N)};D._updateSnappingCandidate=function(f,A,J,z){this.doneSnapping();this._currentMainCandidate=f;this._currentSnappedType=A;A=this._currentMainCandidate.targetPoint;const N=[];N.push(...f.hints);
for(const F of J){if(f instanceof L.IntersectionSnappingCandidate){if(F.constraint.equals(f.first.constraint)||F.constraint.equals(f.second.constraint))continue}else if(F.constraint.equals(f.constraint))continue;J=F.constraint.closestTo(A);this._squaredScreenDistance(J,A,z.coordinateHelper)<this._squaredSatisfiesConstraintThreshold&&(F.targetPoint=A,this._currentOtherActiveCandidates.push(F),N.push(...F.hints))}return{snappedPoint:A,hints:N}};D._squaredPointProximityThreshold=function(f){return"touch"===
f?this._squaredTouchProximityThreshold:this._squaredMouseProximityTreshold};D._arePointsWithinScreenThreshold=function(f,A,J){return this._squaredScreenDistance(f,A,J.coordinateHelper)<this._squaredPointProximityThreshold(J.pointer)};D._squaredScreenDistance=function(f,A,J){return O.squaredScreenDistance(this._toScreen(f,J),this._toScreen(A,J))};D._toScreen=function(f,A){return g.vectorToScreenPoint(f,A.spatialReference,p.absoluteHeightElevationInfo,this.view)};D._findOldCandidateIndex=function(f,
A){let J=-1;for(let z=0;z<f.length;++z)if(A.constraint.equals(f[z].constraint)){J=z;break}return J};n._createClass(Q,[{key:"updating",get:function(){return this._engines.some(f=>f.updating)}},{key:"_squaredMouseProximityTreshold",get:function(){return this.options.distance*this.options.distance}},{key:"_squaredTouchProximityThreshold",get:function(){const {distance:f,touchSensitivityMultiplier:A}=this.options,J=f*A;return J*J}},{key:"_squaredSatisfiesConstraintThreshold",get:function(){return B.defaults.satisfiesConstraintScreenThreshold*
B.defaults.satisfiesConstraintScreenThreshold}},{key:"test",get:function(){return{visualizationsActive:this.handles.has("visualization-handle"),engines:this._engines}}}]);return Q}(H.EventedMixin(u.HandleOwner));e.__decorate([t.property({constructOnly:!0})],b.SnappingManager.prototype,"view",void 0);e.__decorate([t.property()],b.SnappingManager.prototype,"options",void 0);e.__decorate([t.property({readOnly:!0})],b.SnappingManager.prototype,"updating",null);e.__decorate([t.property()],b.SnappingManager.prototype,
"snappingEnginesFactory",void 0);e.__decorate([t.property()],b.SnappingManager.prototype,"_engines",void 0);e.__decorate([t.property()],b.SnappingManager.prototype,"_squaredMouseProximityTreshold",null);e.__decorate([t.property()],b.SnappingManager.prototype,"_squaredTouchProximityThreshold",null);e.__decorate([t.property()],b.SnappingManager.prototype,"_squaredSatisfiesConstraintThreshold",null);b.SnappingManager=e.__decorate([r.subclass("esri.views.interactive.snapping.SnappingManager")],b.SnappingManager);
var a;(function(v){v[v.MAIN=0]="MAIN";v[v.SCENE=1]="SCENE"})(a||(a={}));Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/Settings":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Color ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/subclass".split(" "),function(b,n,e,H,u,K,E){let h=function(t){function d(){var k=t.apply(this,
arguments)||this;k.enabled=!0;return k}n._inheritsLoose(d,t);return d}(u.JSONSupport);e.__decorate([K.property({type:Boolean})],h.prototype,"enabled",void 0);h=e.__decorate([E.subclass("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],h);u=function(t){function d(k){k=t.call(this,k)||this;k.lineSnapper=new h;k.parallelLineSnapper=new h;k.rightAngleSnapper=new h;k.rightAngleTriangleSnapper=new h;k.shortLineThreshold=15;k.distance=5;k.pointThreshold=1E-6;k.intersectionParallelLineThreshold=
1E-6;k.parallelLineThreshold=1E-6;k.verticalLineThreshold=.1;k.touchSensitivityMultiplier=1.5;k.pointOnLineThreshold=1E-6;k.orange=new H([255,127,0]);k.orangeTransparent=new H([255,127,0,.5]);k.lineHintWidthReference=3;k.lineHintWidthTarget=3;k.lineHintFadedExtensions=.3;k.parallelLineHintWidth=2;k.parallelLineHintLength=24;k.parallelLineHintOffset=1.5;k.rightAngleHintSize=24;k.rightAngleHintOutlineSize=1.5;k.satisfiesConstraintScreenThreshold=1;return k}n._inheritsLoose(d,t);return d}(u.JSONSupport);
e.__decorate([K.property({type:h,constructOnly:!0,nonNullable:!0,json:{write:!0}})],u.prototype,"lineSnapper",void 0);e.__decorate([K.property({type:h,constructOnly:!0,nonNullable:!0,json:{write:!0}})],u.prototype,"parallelLineSnapper",void 0);e.__decorate([K.property({type:h,constructOnly:!0,nonNullable:!0,json:{write:!0}})],u.prototype,"rightAngleSnapper",void 0);e.__decorate([K.property({type:h,constructOnly:!0,nonNullable:!0,json:{write:!0}})],u.prototype,"rightAngleTriangleSnapper",void 0);e.__decorate([K.property({type:Number,
nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],u.prototype,"shortLineThreshold",void 0);e.__decorate([K.property({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],u.prototype,"distance",void 0);e.__decorate([K.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],u.prototype,"pointThreshold",void 0);e.__decorate([K.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],u.prototype,"intersectionParallelLineThreshold",
void 0);e.__decorate([K.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],u.prototype,"parallelLineThreshold",void 0);e.__decorate([K.property({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],u.prototype,"verticalLineThreshold",void 0);e.__decorate([K.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],u.prototype,"touchSensitivityMultiplier",void 0);e.__decorate([K.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},
json:{write:!0}})],u.prototype,"pointOnLineThreshold",void 0);e.__decorate([K.property({type:H,nonNullable:!0})],u.prototype,"orange",void 0);e.__decorate([K.property({type:H,nonNullable:!0})],u.prototype,"orangeTransparent",void 0);e.__decorate([K.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],u.prototype,"lineHintWidthReference",void 0);e.__decorate([K.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],u.prototype,"lineHintWidthTarget",void 0);
e.__decorate([K.property({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],u.prototype,"lineHintFadedExtensions",void 0);e.__decorate([K.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],u.prototype,"parallelLineHintWidth",void 0);e.__decorate([K.property({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],u.prototype,"parallelLineHintLength",void 0);e.__decorate([K.property({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],
u.prototype,"parallelLineHintOffset",void 0);e.__decorate([K.property({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],u.prototype,"rightAngleHintSize",void 0);e.__decorate([K.property({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],u.prototype,"rightAngleHintOutlineSize",void 0);e.__decorate([K.property({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],u.prototype,"satisfiesConstraintScreenThreshold",void 0);u=e.__decorate([E.subclass("esri.views.interactive.snapping.Settings.Defaults")],
u);e=new u;b.defaults=e;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingDomain":function(){define(["exports"],function(b){b.SnappingDomain=void 0;var n=b.SnappingDomain||(b.SnappingDomain={});n[n.FEATURE=1]="FEATURE";n[n.SELF=2]="SELF";n[n.ALL=3]="ALL";Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/snappingFactory":function(){define(["exports","./FeatureSnappingEngine","./SelfSnappingEngine"],
function(b,n,e){b.defaultSnappingEnginesFactory=function(H,u){return[new e.SelfSnappingEngine({view:H,options:u}),new n.FeatureSnappingEngine({view:H,options:u,spatialReference:H.spatialReference})]};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/FeatureSnappingEngine":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/HandleOwner ../../../core/Handles ../../../core/MapUtils ../../../core/maybe ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ../../../chunks/vec2 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../chunks/common ../../../layers/graphics/data/QueryEngineResult ../../../support/elevationInfoUtils ./SnappingConstraint ./SnappingDomain ./SnappingPoint ./snappingUtils ./candidates/DrapedEdgeSnappingCandidate ./candidates/EdgeSnappingCandidate ./candidates/FeatureSnappingCandidate ./candidates/RightAngleSnappingCandidate ../support/viewUtils".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k,r,l,p,B,x,y,G,P,O,L,g,c,a,v,Q,D,f,A){function J({constraint:{start:m,end:C}}){const M=x.squaredDistance(m,C);m=B.squaredDistance(m,C);return M<G.getEpsilon()||1E-4>m/M}function z(m,C,M,w,U,T,{spatialReference:S}){C=x.copy(R,C);C[0]+=M;C[1]+=w;C[2]+=U;return(M=A.vectorToScreenPoint(C,S,O.absoluteHeightElevationInfo,T))?a.screenDistance(M,m):Infinity}n.FeatureSnappingEngine=function(m){function C(w){w=m.call(this,w)||this;w.options=null;w._domain=g.SnappingDomain.FEATURE;
w._sourceModules={featureService:{module:null,loader:null},featureCollection:{module:null,loader:null},graphics:{module:null,loader:null},notes:{module:null,loader:null},scene:{module:null,loader:null}};return w}e._inheritsLoose(C,m);var M=C.prototype;M.initialize=function(){this.updatingHandles.add(()=>this.snappingSources,()=>this.notifyChange("updating"),d.sync);h.isSome(this.view)&&this.handles.add([this.view.on("layerview-create",w=>this._updateLayerView(w.layer,w.layerView)),this.view.on("layerview-destroy",
w=>this._updateLayerView(w.layer,null))])};M._updateLayerView=function(w,U){for(const [,T]of this.snappingSources)T.snappingSource.layerSource.layer===w&&(T.layerView=U)};M.destroy=function(){this._set("options",null);for(const [,w]of this.snappingSources)w.destroy()};M.fetchCandidates=function(){var w=e._asyncToGenerator(function*(U,T,S,Y){if(!(T&this._domain)||h.isNone(this.options)||!this.options.effectiveFeatureEnabled)return[];var ha=[];T=this._computeScreenSizeDistanceParameters(U,S);const ja=
{distance:T,mode:h.unwrap(this.view)?.type??"2d",point:U,coordinateHelper:S.coordinateHelper,types:this._types};for(const [,{snappingSource:oa,layerView:ra}]of this.snappingSources)!oa.layerSource.enabled||h.isSome(ra)&&ra.suspended||ha.push(oa.fetchCandidates(ja,Y).then(ta=>ta.filter(ua=>!this._candidateIsExcluded(oa,ua,S.excludeFeature))));ha=(yield t.eachAlwaysValues(ha)).flat();this._addRightAngleCandidates(ha,U,T,S);t.throwIfAborted(Y);a.sortCandidatesInPlace(U,ha);return ha});return function(U,
T,S,Y){return w.apply(this,arguments)}}();M._addRightAngleCandidates=function(w,U,T,S){var Y=h.isSome(S.vertexHandle)?S.vertexHandle.rightEdge?.rightVertex?.pos:h.isSome(S.editGeometryOperations)&&"polygon"===S.editGeometryOperations.data.type?h.unwrap(S.editGeometryOperations.data.components[0]?.getFirstVertex())?.pos:null,ha=h.isSome(S.vertexHandle)?S.vertexHandle.leftEdge?.leftVertex?.pos:h.isSome(S.editGeometryOperations)?h.unwrap(S.editGeometryOperations.data.components[0]?.getLastVertex())?.pos:
null,{view:ja}=this;Y=c.anyMapPointToSnappingPoint(Y,ja,S);S=c.anyMapPointToSnappingPoint(ha,ja,S);ha=w.length;for(ja=0;ja<ha;ja++)this._addRightAngleCandidate(w[ja],S,U,T,w),this._addRightAngleCandidate(w[ja],Y,U,T,w)};M._addRightAngleCandidate=function(w,U,T,S,Y){var ha;(ha=h.isNone(U))||(ha=!((w instanceof Q.EdgeSnappingCandidate||w instanceof v.DrapedEdgeSnappingCandidate)&&!J(w)));if(!ha){ha=w.constraint.closestTo(U);var ja=(ha[0]-T[0])/S.x;T=(ha[1]-T[1])/S.y;var {start:oa,end:ra}=w.constraint;
1>=ja*ja+T*T&&(w=new f.RightAngleSnappingCandidate({targetPoint:ha,otherVertex:U,otherVertexType:f.OtherVertexType.NEXT,previousVertex:B.squaredDistance(ha,oa)>B.squaredDistance(ha,ra)?oa:ra,constraint:new L.VerticalHalfPlaneConstraint(U,ha),objectId:w.objectId,isDraped:w.isDraped}),Y.push(w))}};M._computeScreenSizeDistanceParameters=function(w,U){let T=h.isSome(this.options)?this.options.distance*("touch"===U.pointer?this.options.touchSensitivityMultiplier:1):0;return h.isNone(this.view)?{x:T,y:T,
z:T,distance:T}:"2d"===this.view.type?(T*=this.view.resolution,{x:T,y:T,z:T,distance:T}):this._computeScreenSizeDistanceParameters3D(w,T,this.view,U)};M._computeScreenSizeDistanceParameters3D=function(w,U,T,S){var {spatialReference:Y}=S;T.renderCoordsHelper.toRenderCoords(w,Y,F);const ha=T.state.camera.computeScreenPixelSizeAt(F),ja=ha*T.renderCoordsHelper.unitInMeters/T.mapCoordsHelper.unitInMeters,oa=U*ja,ra=A.vectorToScreenPoint(w,Y,O.absoluteHeightElevationInfo,T);Y=ra?z(ra,w,ja,0,0,T,S):0;const ta=
ra?z(ra,w,0,ja,0,T,S):0;w=ra?z(ra,w,0,0,ja,T,S):0;return{x:0===Y?0:oa/Y,y:0===ta?0:oa/ta,z:0===w?0:oa/w,distance:ha*U}};M._candidateIsExcluded=function(w,U,T){if(h.isNone(T))return!1;U=this._getCandidateObjectId(U);if(h.isNone(U))return!1;w=w.layerSource.layer;return"graphics"===w.type?T.uid===U:T.sourceLayer===w&&T.attributes&&"objectIdField"in w?T.attributes[w.objectIdField]===U:!1};M._getCandidateObjectId=function(w){return w instanceof D.FeatureSnappingCandidate?w.objectId:null};M._createSourceInfo=
function(w){const U=this._createFeatureSnappingSourceType(w);if(h.isNone(U))return null;if("loading"in U)return this.updatingHandles.addPromise(U.loading.then(()=>{this.destroyed||this.notifyChange("snappingSources")})),null;const T=h.isSome(this.view)?this.view.allLayerViews.find(S=>S.layer===w.layer):null;return new N(U.source,T)};M._createFeatureSnappingSourceType=function(w){switch(w.layer.type){case "feature":case "geojson":case "csv":case "oriented-imagery":case "subtype-group":case "wfs":return this._createFeatureSnappingSourceFeatureLayer(w);
case "graphics":return this._createFeatureSnappingSourceGraphicsLayer(w);case "map-notes":return this._createFeatureSnappingSourceMapNotesLayer(w);case "scene":case "building-scene":return this._createFeatureSnappingSourceSceneLayer(w)}return null};M._createFeatureSnappingSourceSceneLayer=function(w){const {view:U}=this;if(h.isNone(U)||"3d"!==U.type)return null;const T=this._getSourceModule("scene");return h.isSome(T.module)?{source:new T.module.SceneLayerSnappingSource({layerSource:w,view:U})}:{loading:T.loader}};
M._createFeatureSnappingSourceFeatureLayer=function(w){switch(w.layer.source?.type){case "feature-layer":case "oriented-imagery":var U=this._getSourceModule("featureService");return h.isSome(U.module)?{source:new U.module.FeatureServiceSnappingSource({spatialReference:this.spatialReference,view:this.view,layerSource:w})}:{loading:U.loader};case "memory":case "csv":case "geojson":case "wfs":if("mesh"!==w.layer.geometryType)return U=this._getSourceModule("featureCollection"),h.isSome(U.module)?{source:new U.module.FeatureCollectionSnappingSource({layerSource:w,
view:this.view})}:{loading:U.loader}}return null};M._createFeatureSnappingSourceGraphicsLayer=function(w){const U=this._getSourceModule("graphics");return h.isSome(U.module)?{source:new U.module.GraphicsSnappingSource({getGraphicsLayers:()=>[w.layer],spatialReference:this.spatialReference,view:this.view,layerSource:w})}:{loading:U.loader}};M._createFeatureSnappingSourceMapNotesLayer=function(w){const U=this._getSourceModule("notes");return h.isSome(U.module)?{source:new U.module.GraphicsSnappingSource({getGraphicsLayers:()=>
h.isSome(w.layer.sublayers)?w.layer.sublayers.toArray():[],spatialReference:this.spatialReference,view:this.view,layerSource:w})}:{loading:U.loader}};M._getSourceModule=function(w){const U=this._sourceModules[w];return h.isNone(U.loader)?(w=this._loadSourceModule(w).then(T=>{U.module=T}),U.loader=w,{module:U.module,loader:w}):{module:U.module,loader:U.loader}};M._loadSourceModule=function(w){const U=this.updatingHandles;switch(w){case "featureService":return U.addPromise(new Promise((T,S)=>b(["./featureSources/FeatureServiceSnappingSource"],
T,S)));case "featureCollection":return U.addPromise(new Promise((T,S)=>b(["./featureSources/FeatureCollectionSnappingSource"],T,S)));case "graphics":return U.addPromise(new Promise((T,S)=>b(["./featureSources/GraphicsSnappingSource"],T,S)));case "notes":return U.addPromise(new Promise((T,S)=>b(["./featureSources/GraphicsSnappingSource"],T,S)));case "scene":return U.addPromise(new Promise((T,S)=>b(["./featureSources/SceneLayerSnappingSource"],T,S)))}};e._createClass(C,[{key:"updating",get:function(){return E.someMap(this.snappingSources,
({snappingSource:w})=>w.updating)||this.updatingHandles.updating}},{key:"snappingSources",get:function(){const w=this._get("snappingSources")||new Map,U=new Map;if(h.isSome(this.options)&&h.isSome(this.options.featureSources))for(const S of this.options.featureSources.items){const Y=S.layer.uid;var T=w.get(Y);T?(w.delete(Y),U.set(Y,T)):S.layer.loaded?(T=this._createSourceInfo(S),h.isSome(T)&&U.set(Y,T)):this.updatingHandles.addPromise(S.layer.load())}for(const [,S]of w)S.destroy();return U}},{key:"_types",
get:function(){return P.SnappingTypes.EDGE|P.SnappingTypes.VERTEX}}]);return C}(u.HandleOwner);H.__decorate([k.property({constructOnly:!0})],n.FeatureSnappingEngine.prototype,"spatialReference",void 0);H.__decorate([k.property({constructOnly:!0})],n.FeatureSnappingEngine.prototype,"view",void 0);H.__decorate([k.property()],n.FeatureSnappingEngine.prototype,"options",void 0);H.__decorate([k.property({readOnly:!0})],n.FeatureSnappingEngine.prototype,"updating",null);H.__decorate([k.property({readOnly:!0})],
n.FeatureSnappingEngine.prototype,"snappingSources",null);n.FeatureSnappingEngine=H.__decorate([p.subclass("esri.views.interactive.snapping.FeatureSnappingEngine")],n.FeatureSnappingEngine);let N=function(){function m(C,M){this.snappingSource=C;this.layerView=M;this.handles=new K;M=this.snappingSource.layerSource.layer;"refresh"in M&&this.handles.add(M.on("refresh",()=>C.refresh()));this.handles.add([d.watch(()=>C.updating,w=>C.layerSource.updating=w,d.syncAndInitial),d.watch(()=>C.availability,w=>
C.layerSource.availability=w,d.syncAndInitial)])}m.prototype.destroy=function(){this.snappingSource.destroy();this.handles.destroy()};return m}();const F=y.create(),R=y.create();Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/vec2":function(){define(["exports","./common"],function(b,n){function e(w,U){w[0]=U[0];w[1]=U[1];return w}function H(w,U,T){w[0]=U;w[1]=T;return w}function u(w,U,T){w[0]=U[0]+T[0];w[1]=U[1]+T[1];return w}function K(w,U,T){w[0]=U[0]-T[0];w[1]=U[1]-
T[1];return w}function E(w,U,T){w[0]=U[0]*T[0];w[1]=U[1]*T[1];return w}function h(w,U,T){w[0]=U[0]/T[0];w[1]=U[1]/T[1];return w}function t(w,U){w[0]=Math.ceil(U[0]);w[1]=Math.ceil(U[1]);return w}function d(w,U){w[0]=Math.floor(U[0]);w[1]=Math.floor(U[1]);return w}function k(w,U,T){w[0]=Math.min(U[0],T[0]);w[1]=Math.min(U[1],T[1]);return w}function r(w,U,T){w[0]=Math.max(U[0],T[0]);w[1]=Math.max(U[1],T[1]);return w}function l(w,U){w[0]=Math.round(U[0]);w[1]=Math.round(U[1]);return w}function p(w,U,
T){w[0]=U[0]*T;w[1]=U[1]*T;return w}function B(w,U,T,S){w[0]=U[0]+T[0]*S;w[1]=U[1]+T[1]*S;return w}function x(w,U){const T=U[0]-w[0];w=U[1]-w[1];return Math.sqrt(T*T+w*w)}function y(w,U){const T=U[0]-w[0];w=U[1]-w[1];return T*T+w*w}function G(w){const U=w[0];w=w[1];return Math.sqrt(U*U+w*w)}function P(w){const U=w[0];w=w[1];return U*U+w*w}function O(w,U){w[0]=-U[0];w[1]=-U[1];return w}function L(w,U){w[0]=1/U[0];w[1]=1/U[1];return w}function g(w,U){var T=U[0];const S=U[1];T=T*T+S*S;0<T&&(T=1/Math.sqrt(T),
w[0]=U[0]*T,w[1]=U[1]*T);return w}function c(w,U){return w[0]*U[0]+w[1]*U[1]}function a(w,U,T){U=U[0]*T[1]-U[1]*T[0];w[0]=w[1]=0;w[2]=U;return w}function v(w,U,T,S){const Y=U[0];U=U[1];w[0]=Y+S*(T[0]-Y);w[1]=U+S*(T[1]-U);return w}function Q(w,U){U=U||1;const T=2*n.RANDOM()*Math.PI;w[0]=Math.cos(T)*U;w[1]=Math.sin(T)*U;return w}function D(w,U,T){const S=U[0];U=U[1];w[0]=T[0]*S+T[2]*U;w[1]=T[1]*S+T[3]*U;return w}function f(w,U,T){const S=U[0];U=U[1];w[0]=T[0]*S+T[2]*U+T[4];w[1]=T[1]*S+T[3]*U+T[5];return w}
function A(w,U,T){const S=U[0];U=U[1];w[0]=T[0]*S+T[3]*U+T[6];w[1]=T[1]*S+T[4]*U+T[7];return w}function J(w,U,T){const S=U[0];U=U[1];w[0]=T[0]*S+T[4]*U+T[12];w[1]=T[1]*S+T[5]*U+T[13];return w}function z(w,U,T,S){const Y=U[0]-T[0];U=U[1]-T[1];const ha=Math.sin(S);S=Math.cos(S);w[0]=Y*S-U*ha+T[0];w[1]=Y*ha+U*S+T[1];return w}function N(w,U){var T=w[0];w=w[1];const S=U[0];U=U[1];let Y=T*T+w*w;0<Y&&(Y=1/Math.sqrt(Y));let ha=S*S+U*U;0<ha&&(ha=1/Math.sqrt(ha));T=(T*S+w*U)*Y*ha;return 1<T?0:-1>T?Math.PI:
Math.acos(T)}function F(w){return"vec2("+w[0]+", "+w[1]+")"}function R(w,U){return w[0]===U[0]&&w[1]===U[1]}function m(w,U){const T=w[0];w=w[1];const S=U[0];U=U[1];const Y=n.getEpsilon();return Math.abs(T-S)<=Y*Math.max(1,Math.abs(T),Math.abs(S))&&Math.abs(w-U)<=Y*Math.max(1,Math.abs(w),Math.abs(U))}function C(w,U,T,S,Y){let ha=U[0]-T[0];T=U[1]-T[1];Y=(S[0]*ha+S[1]*T)*(Y-1);ha=S[0]*Y;T=S[1]*Y;w[0]=U[0]+ha;w[1]=U[1]+T;return w}const M=Object.freeze(Object.defineProperty({__proto__:null,add:u,angle:N,
ceil:t,copy:e,cross:a,dist:x,distance:x,div:h,divide:h,dot:c,equals:m,exactEquals:R,floor:d,inverse:L,len:G,length:G,lerp:v,max:r,min:k,mul:E,multiply:E,negate:O,normalize:g,projectAndScale:C,random:Q,rotate:z,round:l,scale:p,scaleAndAdd:B,set:H,sqrDist:y,sqrLen:P,squaredDistance:y,squaredLength:P,str:F,sub:K,subtract:K,transformMat2:D,transformMat2d:f,transformMat3:A,transformMat4:J},Symbol.toStringTag,{value:"Module"}));b.add=u;b.angle=N;b.ceil=t;b.copy=e;b.cross=a;b.dist=x;b.distance=x;b.div=h;
b.divide=h;b.dot=c;b.equals=m;b.exactEquals=R;b.floor=d;b.inverse=L;b.len=G;b.length=G;b.lerp=v;b.max=r;b.min=k;b.mul=E;b.multiply=E;b.negate=O;b.normalize=g;b.projectAndScale=C;b.random=Q;b.rotate=z;b.round=l;b.scale=p;b.scaleAndAdd=B;b.set=H;b.sqrDist=y;b.sqrLen=P;b.squaredDistance=y;b.squaredLength=P;b.str=F;b.sub=K;b.subtract=K;b.transformMat2=D;b.transformMat2d=f;b.transformMat3=A;b.transformMat4=J;b.vec2=M})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../geometry/support/centroid ../../../geometry/support/extentUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ./AttributesBuilder ./projectionSupport ./SnappingCandidate ./utils ../../support/fieldUtils ../../../statistics/utils ../../../support/arcadeOnDemand".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k,r,l,p,B){function x(O,L,g,c){const a=c.x-g.x;c=c.y-g.y;L=Math.min(1,Math.max(0,((L.x-g.x)*a+(L.y-g.y)*c)/(a*a+c*c)));O.x=g.x+a*L;O.y=g.y+c*L}function y(O,L){return O?L?4:3:L?3:2}let G=function(){function O(g,c,a){this.items=g;this.query=c;this.geometryType=a.geometryType;this.hasM=a.hasM;this.hasZ=a.hasZ;this.fieldsIndex=a.fieldsIndex;this.objectIdField=a.objectIdField;this.spatialReference=a.spatialReference;this.featureAdapter=a.featureAdapter}var L=O.prototype;L.createQueryResponseForCount=
function(){const g=new t(this.query,this.featureAdapter,this.fieldsIndex);if(!this.query.outStatistics)return g.countDistinctValues(this.items);const {groupByFieldsForStatistics:c,having:a,outStatistics:v}=this.query;if(!c?.length)return 1;const Q=new Map,D=new Map,f=new Set;for(const z of v){var {statisticType:A}=z;A="exceedslimit"!==A?z.onStatisticField:void 0;if(!D.has(A)){var J=[];for(const N of c){const F=this._getAttributeValues(g,N,Q);J.push(F)}D.set(A,this._calculateUniqueValues(J,g.returnDistinctValues))}A=
D.get(A);for(const N in A){const {data:F,items:R}=A[N];J=F.join(",");a&&!g.validateItems(R,a)||f.add(J)}}return f.size};L.createQueryResponse=function(){var g=e._asyncToGenerator(function*(){let c;c=this.query.outStatistics?this.query.outStatistics.some(a=>"exceedslimit"===a.statisticType)?this._createExceedsLimitQueryResponse(this.query):yield this._createStatisticsQueryResponse(this.query):this._createFeatureQueryResponse(this.query);if(this.query.returnQueryGeometry){const a=this.query.geometry;
h.isValid(this.query.outSR)&&!h.equals(a.spatialReference,this.query.outSR)?c.queryGeometry=r.cleanFromGeometryEngine({spatialReference:this.query.outSR,...d.project(a,a.spatialReference,this.query.outSR)}):c.queryGeometry=r.cleanFromGeometryEngine({spatialReference:this.query.outSR,...a})}return c});return function(){return g.apply(this,arguments)}}();L.createSnappingResponse=function(g,c){const a=this.featureAdapter,v=y(this.hasZ,this.hasM),{point:Q,mode:D}=g,f="number"===typeof g.distance?g.distance:
g.distance.x,A="number"===typeof g.distance?g.distance:g.distance.y,J={candidates:[]},z="esriGeometryPolygon"===this.geometryType;c=this._getPointCreator(D,this.spatialReference,c);const N=new P(null,0),F=new P(null,0),R={x:0,y:0,z:0};for(const S of this.items){var m=a.getGeometry(S);if(H.isNone(m))continue;const {coords:Y,lengths:ha}=m;N.coords=Y;F.coords=Y;if(g.types&n.SnappingTypes.EDGE){m=0;for(var C=0;C<ha.length;C++){var M=ha[C];for(var w=0;w<M;w++,m+=v){var U=N;U.coordsIndex=m;if(w!==M-1){const ja=
F;ja.coordsIndex=m+v;const oa=R;x(R,Q,U,ja);var T=(Q.x-oa.x)/f;const ra=(Q.y-oa.y)/A;T=T*T+ra*ra;1>=T&&J.candidates.push(k.makeEdgeCandidate(a.getObjectId(S),c(oa),Math.sqrt(T),c(U),c(ja)))}}}}if(g.types&n.SnappingTypes.VERTEX)for(m=z?Y.length-v:Y.length,C=0;C<m;C+=v)M=N,M.coordsIndex=C,w=(Q.x-M.x)/f,U=(Q.y-M.y)/A,w=w*w+U*U,1>=w&&J.candidates.push(k.makeVertexCandidate(a.getObjectId(S),c(M),Math.sqrt(w)))}J.candidates.sort((S,Y)=>S.distance-Y.distance);return J};L._getPointCreator=function(g,c,a){const v=
H.isSome(a)&&!h.equals(c,a)?D=>d.project(D,c,a):D=>D,{hasZ:Q}=this;return"3d"===g?Q?({x:D,y:f,z:A})=>v({x:D,y:f,z:A}):({x:D,y:f})=>v({x:D,y:f,z:0}):({x:D,y:f})=>v({x:D,y:f})};L.createSummaryStatisticsResponse=function(){var g=e._asyncToGenerator(function*(c){const {field:a,valueExpression:v,normalizationField:Q,normalizationType:D,normalizationTotal:f,minValue:A,maxValue:J,scale:z}=c;c=this.fieldsIndex.isDateField(a);var N=yield this._getDataValues({field:a,valueExpression:v,normalizationField:Q,
normalizationType:D,normalizationTotal:f,scale:z});const F=p.isNullCountSupported({normalizationType:D,normalizationField:Q,minValue:A,maxValue:J}),R=this.fieldsIndex.get(a),m={value:.5,fieldType:R?.type};N=l.isStringField(R)?p.calculateStringStatistics({values:N,supportsNullCount:F,percentileParams:m}):p.calculateStatistics({values:N,minValue:A,maxValue:J,useSampleStdDev:!D,supportsNullCount:F,percentileParams:m});return p.processSummaryStatisticsResult(N,c)});return function(c){return g.apply(this,
arguments)}}();L.createUniqueValuesResponse=function(){var g=e._asyncToGenerator(function*(c){const {field:a,valueExpression:v,domains:Q,returnAllCodedValues:D,scale:f}=c;var A=yield this._getDataValues({field:a,field2:c.field2,field3:c.field3,fieldDelimiter:c.fieldDelimiter,valueExpression:v,scale:f});A=p.calculateUniqueValuesCount(A);return p.createUVResult(A,Q,D,c.fieldDelimiter)});return function(c){return g.apply(this,arguments)}}();L.createClassBreaksResponse=function(){var g=e._asyncToGenerator(function*(c){const {field:a,
valueExpression:v,normalizationField:Q,normalizationType:D,normalizationTotal:f,classificationMethod:A,standardDeviationInterval:J,minValue:z,maxValue:N,numClasses:F,scale:R}=c;c=yield this._getDataValues({field:a,valueExpression:v,normalizationField:Q,normalizationType:D,normalizationTotal:f,scale:R});c=p.calculateClassBreaks(c,{field:a,normalizationField:Q,normalizationType:D,normalizationTotal:f,classificationMethod:A,standardDeviationInterval:J,minValue:z,maxValue:N,numClasses:F});return p.resolveCBResult(c,
A)});return function(c){return g.apply(this,arguments)}}();L.createHistogramResponse=function(){var g=e._asyncToGenerator(function*(c){const {field:a,valueExpression:v,normalizationField:Q,normalizationType:D,normalizationTotal:f,classificationMethod:A,standardDeviationInterval:J,minValue:z,maxValue:N,numBins:F,scale:R}=c;c=yield this._getDataValues({field:a,valueExpression:v,normalizationField:Q,normalizationType:D,normalizationTotal:f,scale:R});return p.calculateHistogram(c,{field:a,normalizationField:Q,
normalizationType:D,normalizationTotal:f,classificationMethod:A,standardDeviationInterval:J,minValue:z,maxValue:N,numBins:F})});return function(c){return g.apply(this,arguments)}}();L._sortFeatures=function(g,c,a){if(1<g.length&&c&&c.length)for(const v of c.reverse()){c=v.split(" ");const Q=c[0],D=this.fieldsIndex.get(Q);c=c[1]?"desc"===c[1].toLowerCase():!1;const f=p.getAttributeComparator(D?.type,c);g.sort((A,J)=>{A=a(A,Q,D);J=a(J,Q,D);return f(A,J)})}};L._createFeatureQueryResponse=function(g){const c=
this.items,{geometryType:a,hasM:v,hasZ:Q,objectIdField:D,spatialReference:f}=this,{outFields:A,outSR:J,quantizationParameters:z,resultRecordCount:N,resultOffset:F,returnZ:R,returnM:m}=g,C=null!=N?c.length>(F||0)+N:!1,M=A&&(A.includes("*")?[...this.fieldsIndex.fields]:A.map(w=>this.fieldsIndex.get(w)));return{exceededTransferLimit:C,features:this._createFeatures(g,c),fields:M,geometryType:a,hasM:v&&m,hasZ:Q&&R,objectIdFieldName:D,spatialReference:r.cleanFromGeometryEngine(J?J:f),transform:z&&E.toQuantizationTransform(z)||
null}};L._createFeatures=function(g,c){const a=new t(g,this.featureAdapter,this.fieldsIndex),{hasM:v,hasZ:Q}=this,{orderByFields:D,quantizationParameters:f,returnGeometry:A,returnCentroid:J,maxAllowableOffset:z,resultOffset:N,resultRecordCount:F,returnZ:R=!1,returnM:m=!1}=g,C=Q&&R,M=v&&m;g=[];var w=0;c=[...c];this._sortFeatures(c,D,(S,Y,ha)=>a.getFieldValue(S,Y,ha));if(A||J){var U=E.toQuantizationTransform(f)??void 0;if(A&&!J)for(var T of c)g[w++]={attributes:a.getAttributes(T),geometry:r.getGeometry(this.geometryType,
this.hasZ,this.hasM,this.featureAdapter.getGeometry(T),z,U,C,M)};else if(!A&&J)for(const S of c)g[w++]={attributes:a.getAttributes(S),centroid:r.transformCentroid(this,this.featureAdapter.getCentroid(S,this),U)};else for(const S of c)g[w++]={attributes:a.getAttributes(S),centroid:r.transformCentroid(this,this.featureAdapter.getCentroid(S,this),U),geometry:r.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(S),z,U,C,M)}}else for(U of c)(T=a.getAttributes(U))&&(g[w++]=
{attributes:T});w=N||0;null!=F&&(g=g.slice(w,Math.min(g.length,w+F)));return g};L._createExceedsLimitQueryResponse=function(g){var c=!1;let a=Number.POSITIVE_INFINITY,v=Number.POSITIVE_INFINITY;c=Number.POSITIVE_INFINITY;for(const Q of g.outStatistics??[])if("exceedslimit"===Q.statisticType){a=null!=Q.maxPointCount?Q.maxPointCount:Number.POSITIVE_INFINITY;v=null!=Q.maxRecordCount?Q.maxRecordCount:Number.POSITIVE_INFINITY;c=null!=Q.maxVertexCount?Q.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===
this.geometryType)c=this.items.length>a;else if(this.items.length>v)c=!0;else{g=y(this.hasZ,this.hasM);const Q=this.featureAdapter;c=this.items.reduce((D,f)=>{f=Q.getGeometry(f);return D+(H.isSome(f)&&f.coords.length||0)},0)/g>c}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(c)}}]}};L._createStatisticsQueryResponse=function(){var g=e._asyncToGenerator(function*(c){var a=
{attributes:{}};const v=[],Q=new Map,D=new Map,f=new Map,A=new Map,J=new t(c,this.featureAdapter,this.fieldsIndex);var z=c.outStatistics;const {groupByFieldsForStatistics:N,having:F,orderByFields:R}=c;c=N&&N.length;const m=!!c,C=m?N[0]:null,M=m&&!this.fieldsIndex.get(C);for(const Y of z??[]){const {outStatisticFieldName:ha,statisticType:ja}=Y;z=Y;var w="exceedslimit"!==ja?Y.onStatisticField:void 0;const oa="percentile_disc"===ja||"percentile_cont"===ja,ra="EnvelopeAggregate"===ja||"CentroidAggregate"===
ja||"ConvexHullAggregate"===ja,ta=m&&1===c&&(w===C||M)&&"count"===ja;if(m){if(!f.has(w)){var U=[];for(const ua of N){var T=this._getAttributeValues(J,ua,Q);U.push(T)}f.set(w,this._calculateUniqueValues(U,ra?!1:J.returnDistinctValues))}U=f.get(w);for(const ua in U){const {count:Aa,data:Z,items:da,itemPositions:fa}=U[ua];T=Z.join(",");if(!F||J.validateItems(da,F)){const X=A.get(T)||{attributes:{}};if(ra){X.aggregateGeometries||(X.aggregateGeometries={});const {aggregateGeometries:ea,outStatisticFieldName:ba}=
yield this._getAggregateGeometry(z,da);X.aggregateGeometries[ba]=ea}else{var S=null;if(ta)S=Aa;else{const ea=this._getAttributeValues(J,w,Q);S=fa.map(ba=>ea[ba]);S=oa&&"statisticParameters"in z?this._getPercentileValue(z,S):this._getStatisticValue(z,S,null,J.returnDistinctValues)}X.attributes[ha]=S}let aa=0;N.forEach((ea,ba)=>X.attributes[this.fieldsIndex.get(ea)?ea:`EXPR_${++aa}`]=Z[ba]);A.set(T,X)}}}else if(ra){a.aggregateGeometries||(a.aggregateGeometries={});const {aggregateGeometries:ua,outStatisticFieldName:Aa}=
yield this._getAggregateGeometry(z,this.items);a.aggregateGeometries[Aa]=ua}else w=this._getAttributeValues(J,w,Q),a.attributes[ha]=oa&&"statisticParameters"in z?this._getPercentileValue(z,w):this._getStatisticValue(z,w,D,J.returnDistinctValues);v.push({name:ha,alias:ha,type:"esriFieldTypeDouble"})}a=m?Array.from(A.values()):[a];this._sortFeatures(a,R,(Y,ha)=>Y.attributes[ha]);return{fields:v,features:a}});return function(c){return g.apply(this,arguments)}}();L._getAggregateGeometry=function(){var g=
e._asyncToGenerator(function*(c,a){var v=yield new Promise((R,m)=>b(["../../../geometry/geometryEngineJSON"],R,m));const {statisticType:Q,outStatisticFieldName:D}=c,{featureAdapter:f,spatialReference:A,geometryType:J,hasZ:z,hasM:N}=this;a=a.map(R=>r.getGeometry(J,z,N,f.getGeometry(R)));const F=v.convexHull(A,a,!0)[0];c={aggregateGeometries:null,outStatisticFieldName:null};"EnvelopeAggregate"===Q?(v=F?K.getPolygonExtent(F):K.getGeometryExtent(v.union(A,a)),c.aggregateGeometries={...v,spatialReference:A},
c.outStatisticFieldName=D||"extent"):"CentroidAggregate"===Q?(v=F?u.polygonCentroid(F):u.extentCentroid(K.getGeometryExtent(v.union(A,a))),c.aggregateGeometries={x:v[0],y:v[1],spatialReference:A},c.outStatisticFieldName=D||"centroid"):"ConvexHullAggregate"===Q&&(c.aggregateGeometries=F,c.outStatisticFieldName=D||"convexHull");return c});return function(c,a){return g.apply(this,arguments)}}();L._getStatisticValue=function(g,c,a,v){const {onStatisticField:Q,statisticType:D}=g;g=null;g=a?.has(Q)?a.get(Q):
l.isStringField(this.fieldsIndex.get(Q))?p.calculateStringStatistics({values:c,returnDistinct:v}):p.calculateStatistics({values:v?[...(new Set(c))]:c,minValue:null,maxValue:null,useSampleStdDev:!0});a&&a.set(Q,g);return g["var"===D?"variance":D]};L._getPercentileValue=function(g,c){const {onStatisticField:a,statisticParameters:v,statisticType:Q}=g,{value:D,orderBy:f}=v;g=this.fieldsIndex.get(a);return p.calculatePercentile(c,{value:D,orderBy:f,fieldType:g?.type,isDiscrete:"percentile_disc"===Q})};
L._getAttributeValues=function(g,c,a){if(a.has(c))return a.get(c);const v=this.fieldsIndex.get(c),Q=this.items.map(D=>g.getFieldValue(D,c,v));a.set(c,Q);return Q};L._getAttributeDataValues=function(g,c){return this.items.map(a=>g.getDataValue(a,{field:c.field,field2:c.field2,field3:c.field3,fieldDelimiter:c.fieldDelimiter,normalizationField:c.normalizationField,normalizationType:c.normalizationType,normalizationTotal:c.normalizationTotal}))};L._getAttributeExpressionValues=function(){var g=e._asyncToGenerator(function*(c,
a,v){const {arcadeUtils:Q}=yield B.loadArcade();a=Q.createFunction(a);v=v&&Q.getViewInfo(v);return c.getExpressionValues(this.items,a,v,Q)});return function(c,a,v){return g.apply(this,arguments)}}();L._calculateUniqueValues=function(g,c){const a={},v=this.items,Q=v.length;for(let D=0;D<Q;D++){const f=v[D],A=[];for(const z of g)A.push(z[D]);const J=A.join(",");null==a[J]?a[J]={count:1,data:A,items:[f],itemPositions:[D]}:(c||a[J].count++,a[J].items.push(f),a[J].itemPositions.push(D))}return a};L._getDataValues=
function(){var g=e._asyncToGenerator(function*(c){const a=new t(this.query,this.featureAdapter,this.fieldsIndex),{valueExpression:v,field:Q,normalizationField:D,normalizationType:f,normalizationTotal:A,scale:J}=c,z=v?{viewingMode:"map",scale:J,spatialReference:this.query.outSR||this.spatialReference}:null;return v?this._getAttributeExpressionValues(a,v,z):this._getAttributeDataValues(a,{field:Q,field2:c.field2,field3:c.field3,fieldDelimiter:c.fieldDelimiter,normalizationField:D,normalizationType:f,
normalizationTotal:A})});return function(c){return g.apply(this,arguments)}}();e._createClass(O,[{key:"size",get:function(){return this.items.length}}]);return O}();n.SnappingTypes=void 0;(function(O){O[O.NONE=0]="NONE";O[O.EDGE=1]="EDGE";O[O.VERTEX=2]="VERTEX"})(n.SnappingTypes||(n.SnappingTypes={}));let P=function(){function O(L,g){this.coords=L;this.coordsIndex=g}e._createClass(O,[{key:"x",get:function(){return this.coords[this.coordsIndex]}},{key:"y",get:function(){return this.coords[this.coordsIndex+
1]}},{key:"z",get:function(){return this.coords[this.coordsIndex+2]}}]);return O}();n.QueryEngineResult=G;Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/quantizationUtils":function(){define(["exports","../../core/maybe","./jsonUtils"],function(b,n,e){function H({scale:D,translate:f},A){return Math.round((A-f[0])/D[0])}function u({scale:D,translate:f},A){return Math.round((f[1]-A)/D[1])}function K(D,f,A){const J=[];let z,N,F,R;for(let m=0;m<A.length;m++){const C=
A[m];if(0<m){if(F=H(D,C[0]),R=u(D,C[1]),F!==z||R!==N)J.push(f(C,F-z,R-N)),z=F,N=R}else z=H(D,C[0]),N=u(D,C[1]),J.push(f(C,z,N))}return 0<J.length?J:null}function E(D,f,A,J){return K(D,A?J?Q:v:J?v:a,f)}function h(D,f,A,J){const z=[];A=A?J?Q:v:J?v:a;for(J=0;J<f.length;J++){const N=K(D,A,f[J]);N&&3<=N.length&&z.push(N)}return z.length?z:null}function t(D,f,A,J){const z=[];A=A?J?Q:v:J?v:a;for(J=0;J<f.length;J++){const N=K(D,A,f[J]);N&&2<=N.length&&z.push(N)}return z.length?z:null}function d({scale:D,
translate:f},A){return A*D[0]+f[0]}function k({scale:D,translate:f},A){return f[1]-A*D[1]}function r(D,f,A){const J=Array(A.length);if(!A.length)return J;const [z,N]=D.scale;let F=d(D,A[0][0]);D=k(D,A[0][1]);J[0]=f(A[0],F,D);for(let R=1;R<A.length;R++){const m=A[R];F+=m[0]*z;D-=m[1]*N;J[R]=f(m,F,D)}return J}function l(D,f,A){const J=Array(A.length);for(let z=0;z<A.length;z++)J[z]=r(D,f,A[z]);return J}function p(D,f,A,J){return r(D,A?J?Q:v:J?v:a,f)}function B(D,f,A,J){return l(D,A?J?Q:v:J?v:a,f)}function x(D,
f,A,J){return l(D,A?J?Q:v:J?v:a,f)}function y(D,f,A){let [J,z]=A[0],N=Math.min(J,f[0]),F=Math.min(z,f[1]),R=Math.max(J,f[2]);f=Math.max(z,f[3]);for(let m=1;m<A.length;m++){const [C,M]=A[m];J+=C;z+=M;0>C&&(N=Math.min(N,J));0<C&&(R=Math.max(R,J));0>M?F=Math.min(F,z):0<M&&(f=Math.max(f,z))}D[0]=N;D[1]=F;D[2]=R;D[3]=f;return D}function G(D,f){if(!f.length)return null;D[0]=D[1]=Number.POSITIVE_INFINITY;D[2]=D[3]=Number.NEGATIVE_INFINITY;for(let A=0;A<f.length;A++)y(D,D,f[A]);return D}function P(D,f,A,
J,z){f.xmin=H(D,A.xmin);f.ymin=u(D,A.ymin);f.xmax=H(D,A.xmax);f.ymax=u(D,A.ymax);f!==A&&(J&&(f.zmin=A.zmin,f.zmax=A.zmax),z&&(f.mmin=A.mmin,f.mmax=A.mmax));return f}function O(D,f,A,J,z){f.points=E(D,A.points,J,z)??[];return f}function L(D,f,A,J,z){f.x=H(D,A.x);f.y=u(D,A.y);f!==A&&(J&&(f.z=A.z),z&&(f.m=A.m));return f}function g(D,f,A,J,z){D=h(D,A.rings,J,z);if(!D)return null;f.rings=D;return f}function c(D,f,A,J,z){D=t(D,A.paths,J,z);if(!D)return null;f.paths=D;return f}const a=(D,f,A)=>[f,A],v=(D,
f,A)=>[f,A,D[2]],Q=(D,f,A)=>[f,A,D[2],D[3]];b.equals=function(D,f){if(D===f||null==D&&null==f)return!0;if(null==D||null==f)return!1;let A,J,z,N;D&&"upperLeft"===D.originPosition?(A=D.translate[0],J=D.translate[1],D=D.scale[0]):(A=n.isSome(D.extent)?D.extent.xmin:0,J=n.isSome(D.extent)?D.extent.ymax:0,D=D.tolerance);f&&"upperLeft"===f.originPosition?(z=f.translate[0],N=f.translate[1],f=f.scale[0]):(z=n.isSome(f.extent)?f.extent.xmin:0,N=n.isSome(f.extent)?f.extent.ymax:0,f=f.tolerance);return A===
z&&J===N&&D===f};b.getQuantizedBoundsCoordsArray=y;b.getQuantizedBoundsCoordsArrayArray=G;b.getQuantizedBoundsPaths=function(D){return G([0,0,0,0],D)};b.getQuantizedBoundsPoints=function(D){const f=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return y(f,f,D)};b.getQuantizedBoundsRings=function(D){return G([0,0,0,0],D)};b.quantizeBounds=function(D,f,A){f[0]=H(D,A[0]);f[3]=u(D,A[1]);f[2]=H(D,A[2]);f[1]=u(D,A[3]);return f};b.quantizeExtent=P;b.quantizeGeometry=
function(D,f){return D&&f?e.isPoint(f)?L(D,{},f,!1,!1):e.isPolyline(f)?c(D,{},f,!1,!1):e.isPolygon(f)?g(D,{},f,!1,!1):e.isMultipoint(f)?O(D,{},f,!1,!1):e.isExtent(f)?P(D,{},f,!1,!1):null:null};b.quantizeMultipoint=O;b.quantizePaths=t;b.quantizePoint=L;b.quantizePoints=E;b.quantizePolygon=g;b.quantizePolyline=c;b.quantizeRings=h;b.quantizeX=H;b.quantizeY=u;b.toQuantizationTransform=function(D){return D?{originPosition:"upper-left"===D.originPosition?"upperLeft":"lower-left"===D.originPosition?"lowerLeft":
D.originPosition,scale:D.tolerance?[D.tolerance,D.tolerance]:[1,1],translate:n.isSome(D.extent)?[D.extent.xmin,D.extent.ymax]:[0,0]}:null};b.unquantizeBounds=function(D,f,A){return A?(f[0]=d(D,A[0]),f[1]=k(D,A[3]),f[2]=d(D,A[2]),f[3]=k(D,A[1]),f):[d(D,f[0]),k(D,f[3]),d(D,f[2]),k(D,f[1])]};b.unquantizeCoordsArray=r;b.unquantizeCoordsArrayArray=l;b.unquantizeExtent=function(D,f,A,J,z){f.xmin=d(D,A.xmin);f.ymin=k(D,A.ymin);f.xmax=d(D,A.xmax);f.ymax=k(D,A.ymax);f!==A&&(J&&(f.zmin=A.zmin,f.zmax=A.zmax),
z&&(f.mmin=A.mmin,f.mmax=A.mmax));return f};b.unquantizeMultipoint=function(D,f,A,J,z){n.isSome(A)&&(f.points=p(D,A.points,J,z));return f};b.unquantizePaths=B;b.unquantizePoint=function(D,f,A,J,z){if(n.isNone(A))return f;f.x=d(D,A.x);f.y=k(D,A.y);f!==A&&(J&&(f.z=A.z),z&&(f.m=A.m));return f};b.unquantizePoints=p;b.unquantizePolygon=function(D,f,A,J,z){n.isSome(A)&&(f.rings=x(D,A.rings,J,z));return f};b.unquantizePolyline=function(D,f,A,J,z){n.isSome(A)&&(f.paths=B(D,A.paths,J,z));return f};b.unquantizeRings=
x;b.unquantizeX=d;b.unquantizeY=k;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/AttributesBuilder":function(){define(["../../../core/maybe","./attributeSupport","../../../statistics/utils"],function(b,n,e){return function(){function H(K,E,h){this._fieldDataCache=new Map;this._returnDistinctMap=new Map;this.returnDistinctValues=K.returnDistinctValues??!1;this.fieldsIndex=h;this.featureAdapter=E;if((E=K.outFields)&&!E.includes("*")){this.outFields=E;K=0;
for(const d of E){var t=n.getExpressionFromFieldName(d);t=(E=this.fieldsIndex.get(t))?null:n.getWhereClause(t,h);E=E?E.name:n.getAliasFromFieldName(d)||`FIELD_EXP_${K++}`;this._fieldDataCache.set(d,{alias:E,clause:t})}}}var u=H.prototype;u.countDistinctValues=function(K){if(!this.returnDistinctValues)return K.length;K.forEach(E=>this.getAttributes(E));return this._returnDistinctMap.size};u.getAttributes=function(K){K=this._processAttributesForOutFields(K);return this._processAttributesForDistinctValues(K)};
u.getFieldValue=function(K,E,h){const t=h?h.name:E;let d=null;this._fieldDataCache.has(t)?d=this._fieldDataCache.get(t)?.clause:h||(d=n.getWhereClause(E,this.fieldsIndex),this._fieldDataCache.set(t,{alias:t,clause:d}));return h?this.featureAdapter.getAttribute(K,t):d?.calculateValue(K,this.featureAdapter)};u.getDataValue=function(K,E){const h=E.normalizationType,t=E.normalizationTotal;let d=E.field&&this.getFieldValue(K,E.field,this.fieldsIndex.get(E.field));E.field2&&(d=`${e.processNullValue(d)}${E.fieldDelimiter}${e.processNullValue(this.getFieldValue(K,
E.field2,this.fieldsIndex.get(E.field2)))}`,E.field3&&(d=`${d}${E.fieldDelimiter}${e.processNullValue(this.getFieldValue(K,E.field3,this.fieldsIndex.get(E.field3)))}`));h&&Number.isFinite(d)&&(K="field"===h&&E.normalizationField?this.getFieldValue(K,E.normalizationField,this.fieldsIndex.get(E.normalizationField)):null,d=e.getNormalizedValue(d,h,K,t));return d};u.getExpressionValue=function(K,E,h,t){K={attributes:this.featureAdapter.getAttributes(K),layer:{fields:this.fieldsIndex.fields}};h=t.createExecContext(K,
h);return t.executeFunction(E,h)};u.getExpressionValues=function(K,E,h,t){const d={fields:this.fieldsIndex.fields};return K.map(k=>{k={attributes:this.featureAdapter.getAttributes(k),layer:d};k=t.createExecContext(k,h);return t.executeFunction(E,k)})};u.validateItem=function(K,E){this._fieldDataCache.has(E)||this._fieldDataCache.set(E,{alias:E,clause:n.getWhereClause(E,this.fieldsIndex)});return this._fieldDataCache.get(E)?.clause?.testFeature(K,this.featureAdapter)??!1};u.validateItems=function(K,
E){this._fieldDataCache.has(E)||this._fieldDataCache.set(E,{alias:E,clause:n.getWhereClause(E,this.fieldsIndex)});return this._fieldDataCache.get(E)?.clause?.testSet(K,this.featureAdapter)??!1};u._processAttributesForOutFields=function(K){const E=this.outFields;if(!E||!E.length)return this.featureAdapter.getAttributes(K);const h={};for(const t of E){const {alias:d,clause:k}=this._fieldDataCache.get(t);h[d]=k?k.calculateValue(K,this.featureAdapter):this.featureAdapter.getAttribute(K,d)}return h};u._processAttributesForDistinctValues=
function(K){if(b.isNone(K)||!this.returnDistinctValues)return K;var E=this.outFields,h=[];if(E)for(const d of E){var {alias:t}=this._fieldDataCache.get(d);h.push(K[t])}else for(t in K)h.push(K[t]);E=`${(E||["*"]).join(",")}=${h.join(",")}`;h=this._returnDistinctMap.get(E)||0;this._returnDistinctMap.set(E,++h);return 1<h?null:K};return H}()})},"esri/layers/graphics/data/attributeSupport":function(){define(["exports","../../../core/Error","../../../core/sql/WhereClauseCache"],function(b,n,e){function H(t,
d){return t?E.get(t,d):null}function u(t,d,k,r=!0){const l=[];for(const p of d)if("*"!==p&&!t.has(p))if(r){d=K(p);try{const B=H(d,t);if(!B)throw new n("feature-store:unsupported-query","invalid SQL expression",{where:d});if(!B.isStandardized)throw new n("feature-store:unsupported-query","expression is not standard",{clause:B});u(t,B.fieldNames,"expression contains missing fields")}catch(B){if((d=B&&B.details)&&(d.clause||d.where))throw B;d&&d.missingFields?l.push(...d.missingFields):l.push(p)}}else l.push(p);
if(l.length)throw new n("feature-store:unsupported-query",k,{missingFields:l});}function K(t){return t.split(" as ")[0]}const E=new e.WhereClauseCache(50,500),h=new Set("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeDate".split(" "));b.getAliasFromFieldName=function(t){return t.split(" as ")[1]};b.getExpressionFromFieldName=K;b.getWhereClause=H;b.hasInvalidFieldType=function(t,d){return(t=d.get(t))?!h.has(t.type):
!1};b.validateFields=u;b.validateHaving=function(t,d,k){if(!d)return!0;const r=E.get(d,t);if(!r)throw new n("feature-store:unsupported-query","invalid SQL expression",{having:d});if(!r.isAggregate)throw new n("feature-store:unsupported-query","having does not contain a valid aggregate function",{having:d});u(t,r.fieldNames,"having contains missing fields");if(!r.getExpressions().every(l=>{const {aggregateType:p,field:B}=l,x=t.get(B)?.name;return k.some(y=>{const {onStatisticField:G,statisticType:P}=
y;return t.get(G)?.name===x&&P.toLowerCase().trim()===p})}))throw new n("feature-store:unsupported-query","expressions in having should also exist in outStatistics",{having:d});return!0};b.validateWhere=function(t,d){if(!d)return!0;const k=E.get(d,t);if(!k)throw new n("feature-store:unsupported-query","invalid SQL expression",{where:d});if(!k.isStandardized)throw new n("feature-store:unsupported-query","where clause is not standard",{where:d});u(t,k.fieldNames,"where clause contains missing fields");
return!0};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereClauseCache":function(){define(["exports","../ItemCache","./WhereClause"],function(b,n,e){let H=function(){function u(K,E){this._cache=new n(K);this._invalidCache=new n(E)}u.prototype.get=function(K,E){const h=`${E.uid}:${K}`,t=this._cache.get(h);if(t)return t;if(void 0!==this._invalidCache.get(h))return null;try{const d=e.WhereClause.create(K,E);this._cache.put(h,d);return d}catch{return this._invalidCache.put(h,
null),null}};return u}();b.WhereClauseCache=H;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereClause":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../has ./AggregateFunctions ./StandardizedFunctions ./WhereGrammar".split(" "),function(b,n,e,H,u,K){function E(z,N){z+="";return z.length>=N?z:Array(N-z.length+1).join("0")+z}function h(z,N,F="0",R="0",m="0",C="0",M="",w="0",U="0"){return"+"===M||"-"===M?(z=`${E(parseInt(z,10),4)}-${E(parseInt(N,
10),2)}-${E(parseInt(F,10),2)}`,N="",10>parseFloat(C)&&(N="0"),R=`${E(parseInt(R,10),2)}:${E(parseInt(m,10),2)}:${N+parseFloat(C).toString()}`,M=`${M}${E(parseInt(w,10),2)}:${E(parseInt(U,10),2)}`,new Date(z+"T"+R+M)):new Date(parseInt(z,10),parseInt(N,10)-1,parseInt(F,10),parseInt(R,10),parseInt(m,10),parseFloat(C))}function t(z){let N=g.exec(z);if(null!==N){const [,F,R,m,C,M,w]=N;return h(F,R,m,C,M,w)}N=c.exec(z);if(null!==N){const [,F,R,m,C,M,w,U,T,S]=N;return h(F,R,m,C,M,w,U,T,S)}N=a.exec(z);
if(null!==N){const [,F,R,m,C,M,w,U,T]=N;return h(F,R,m,C,M,"0",w,U,T)}N=v.exec(z);if(null!==N){const [,F,R,m,C,M]=N;return h(F,R,m,C,M)}N=L.exec(z);if(null!==N){const [,F,R,m]=N;return h(F,R,m)}throw Error("SQL Invalid Timestamp");}function d(z){const N=L.exec(z);if(null===N)try{return t(z)}catch{throw Error("SQL Invalid Date");}const [,F,R,m]=N;return new Date(parseInt(F,10),parseInt(R,10)-1,parseInt(m,10))}function k(z){return Array.isArray(z)?z:[z]}function r(z){return null!==z?!0!==z:null}function l(z,
N){return null!=z&&null!=N?!0===z&&!0===N:!1===z||!1===N?!1:null}function p(z,N){return null!=z&&null!=N?!0===z||!0===N:!0===z||!0===N?!0:null}function B(z,N){if(null==z)return null;let F=!1;for(const R of N)if(null==R)F=null;else if(z===R){F=!0;break}return F}function x(z,N,F){if(null==z)return null;let R="",m=A.Normal;for(let C=0;C<N.length;C++){const M=N.charAt(C);switch(m){case A.Normal:M===F?m=A.Escaped:R="-[]/{}()*+?.\\^$|".includes(M)?R+("\\"+M):"%"===M?R+".*":"_"===M?R+".":R+M;break;case A.Escaped:R=
"-[]/{}()*+?.\\^$|".includes(M)?R+("\\"+M):R+M,m=A.Normal}}return(new RegExp("^"+R+"$","m")).test(z)}function y(z){return z instanceof Date?z.valueOf():z}function G(z,N,F){if(null==N||null==F)return null;N=y(N);F=y(F);switch(z){case "\x3c\x3e":return N!==F;case "\x3d":return N===F;case "\x3e":return N>F;case "\x3c":return N<F;case "\x3e\x3d":return N>=F;case "\x3c\x3d":return N<=F}}function P(z,N,F){if("||"===z)return u.evaluateFunction("concat",[N,F]);if(N instanceof u.SqlInterval)if(F instanceof
Date)switch(z){case "+":return new Date(N.valueInMilliseconds()+F.getTime());case "-":return N.valueInMilliseconds()-F.getTime();case "*":return N.valueInMilliseconds()*F.getTime();case "/":return N.valueInMilliseconds()/F.getTime()}else if(F instanceof u.SqlInterval)switch(z){case "+":return u.SqlInterval.createFromMilliseconds(N.valueInMilliseconds()+F.valueInMilliseconds());case "-":return u.SqlInterval.createFromMilliseconds(N.valueInMilliseconds()-F.valueInMilliseconds());case "*":return N.valueInMilliseconds()*
F.valueInMilliseconds();case "/":return N.valueInMilliseconds()/F.valueInMilliseconds()}else N=N.valueInMilliseconds();else if(F instanceof u.SqlInterval)if(N instanceof Date)switch(z){case "+":return new Date(F.valueInMilliseconds()+N.getTime());case "-":return new Date(N.getTime()-F.valueInMilliseconds());case "*":return N.getTime()*F.valueInMilliseconds();case "/":return N.getTime()/F.valueInMilliseconds()}else F=F.valueInMilliseconds();else if(N instanceof Date&&"number"===typeof F)switch(F*=
864E5,N=N.getTime(),z){case "+":return new Date(N+F);case "-":return new Date(N-F);case "*":return new Date(N*F);case "/":return new Date(N/F)}else if(F instanceof Date&&"number"===typeof N)switch(N*=864E5,F=F.getTime(),z){case "+":return new Date(N+F);case "-":return new Date(N-F);case "*":return new Date(N*F);case "/":return new Date(N/F)}switch(z){case "+":return N+F;case "-":return N-F;case "*":return N*F;case "/":return N/F}}function O(z,N,F,R){z=R.getAttribute(z,N);return null!=z&&1===F[N]?
new Date(z):z}const L=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,g=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,c=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,a=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,v=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/,Q=new Set(["current_timestamp","current_date","current_time"]);let D=function(){function z(){}z.makeBool=function(N){return!0===N};z.featureValue=
function(N,F,R,m){return O(N,F,R,m)};z.equalsNull=function(N){return null===N};z.applyLike=function(N,F,R){return x(N,F,R)};z.ensureArray=function(N){return k(N)};z.applyIn=function(N,F){return B(N,F)};z.currentDate=function(){const N=new Date;N.setHours(0,0,0,0);return N};z.makeSqlInterval=function(N,F,R){return u.SqlInterval.createFromValueAndQualifer(N,F,R)};z.convertInterval=function(N){return N instanceof u.SqlInterval?N.valueInMilliseconds():N};z.currentTimestamp=function(){return new Date};
z.compare=function(N,F,R){return G(N,F,R)};z.calculate=function(N,F,R){return P(N,F,R)};z.makeComparable=function(N){return y(N)};z.evaluateFunction=function(N,F){return u.evaluateFunction(N,F)};z.lookup=function(N,F){N=F[N];return void 0===N?null:N};z.between=function(N,F){return null==N||null==F[0]||null==F[1]?null:N>=F[0]&&N<=F[1]};z.notbetween=function(N,F){return null==N||null==F[0]||null==F[1]?null:N<F[0]||N>F[1]};z.ternaryNot=function(N){return r(N)};z.ternaryAnd=function(N,F){return l(N,F)};
z.ternaryOr=function(N,F){return p(N,F)};return z}(),f=function(){function z(F,R){this.fieldsIndex=R;this._datefields={};this.parameters={};this._hasDateFunctions=void 0;this.parseTree=K.WhereGrammar.parse(F);const {isStandardized:m,isAggregate:C,referencedFieldNames:M}=this._extractExpressionInfo(R);this._referencedFieldNames=M;this.isStandardized=m;this.isAggregate=C}z.create=function(F,R){return new z(F,R)};var N=z.prototype;N.testSet=function(F,R=J){const m={};for(const C of this.fieldNames)m[C]=
F.map(M=>R.getAttribute(M,C));return!!this._evaluateNode(this.parseTree,{attributes:m},J)};N.calculateValue=function(F,R=J){F=this._evaluateNode(this.parseTree,F,R);return F instanceof u.SqlInterval?F.valueInMilliseconds()/864E5:F};N.calculateValueCompiled=function(F,R=J){if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(F,this.parameters,R,this._datefields);if(e("esri-csp-restrictions"))return this.calculateValue(F,R);this._compileMe();return this.parseTree._compiledVersion(F,
this.parameters,R,this._datefields)};N.testFeature=function(F,R=J){return!!this._evaluateNode(this.parseTree,F,R)};N.testFeatureCompiled=function(F,R=J){if(null!=this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(F,this.parameters,R,this._datefields);if(e("esri-csp-restrictions"))return this.testFeature(F,R);this._compileMe();return!!this.parseTree._compiledVersion(F,this.parameters,R,this._datefields)};N.getFunctions=function(){const F=new Set;this._visitAll(this.parseTree,R=>
{"function"===R.type&&F.add(R.name.toLowerCase())});return Array.from(F)};N.getExpressions=function(){const F=new Map;this._visitAll(this.parseTree,R=>{if("function"===R.type){const m=R.name.toLowerCase();R=R.args.value[0];if("column-reference"===R.type){R=R.column;const C=`${m}-${R}`;F.has(C)||F.set(C,{aggregateType:m,field:R})}}});return[...F.values()]};N.getVariables=function(){const F=new Set;this._visitAll(this.parseTree,R=>{"parameter"===R.type&&F.add(R.value.toLowerCase())});return Array.from(F)};
N._compileMe=function(){const F="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter","datefields",F)).bind(D)};N._extractExpressionInfo=function(F){const R=[],m=new Set;let C=!0,M=!0;this._visitAll(this.parseTree,w=>{switch(w.type){case "column-reference":const U=F?.get(w.column);let T,S;U?T=S=U.name??"":(S=w.column,T=S.toLowerCase());U&&U.name&&("date"===U.type||"esriFieldTypeDate"===
U.type)&&(this._datefields[U.name]=1);m.has(T)||(m.add(T),R.push(S));w.column=S;break;case "function":const {name:Y,args:ha}=w;w=ha.value.length;C&&(C=u.isStandardized(Y,w));M&&(M=H.isAggregate(Y,w))}});return{referencedFieldNames:Array.from(R),isStandardized:C,isAggregate:M}};N._visitAll=function(F,R){if(null!=F)switch(R(F),F.type){case "when-clause":this._visitAll(F.operand,R);this._visitAll(F.value,R);break;case "case-expression":for(const m of F.clauses)this._visitAll(m,R);"simple"===F.format&&
this._visitAll(F.operand,R);null!==F.else&&this._visitAll(F.else,R);break;case "expression-list":for(const m of F.value)this._visitAll(m,R);break;case "unary-expression":this._visitAll(F.expr,R);break;case "binary-expression":this._visitAll(F.left,R);this._visitAll(F.right,R);break;case "function":this._visitAll(F.args,R)}};N.evaluateNodeToJavaScript=function(F){switch(F.type){case "interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(F.value)+", "+JSON.stringify(F.qualifier)+","+
JSON.stringify(F.op)+")";case "case-expression":var R="";if("simple"===F.format){var m="this.makeComparable("+this.evaluateNodeToJavaScript(F.operand)+")";R="( ";for(let C=0;C<F.clauses.length;C++)R+=" ("+m+" \x3d\x3d\x3d this.makeComparable("+this.evaluateNodeToJavaScript(F.clauses[C].operand)+")) ? ("+this.evaluateNodeToJavaScript(F.clauses[C].value)+") : "}else for(R="( ",m=0;m<F.clauses.length;m++)R+=" this.makeBool("+this.evaluateNodeToJavaScript(F.clauses[m].operand)+")\x3d\x3d\x3dtrue ? ("+
this.evaluateNodeToJavaScript(F.clauses[m].value)+") : ";R=null!==F.else?R+this.evaluateNodeToJavaScript(F.else):R+"null";return R+" )";case "parameter":return"this.lookup("+JSON.stringify(F.value.toLowerCase())+",lookups)";case "expression-list":R="[";for(m of F.value)"["!==R&&(R+=","),R+=this.evaluateNodeToJavaScript(m);return R+"]";case "unary-expression":return"this.ternaryNot("+this.evaluateNodeToJavaScript(F.expr)+")";case "binary-expression":switch(F.operator){case "AND":return"this.ternaryAnd("+
this.evaluateNodeToJavaScript(F.left)+","+this.evaluateNodeToJavaScript(F.right)+" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(F.left)+","+this.evaluateNodeToJavaScript(F.right)+" )";case "IS":if("null"!==F.right.type)throw Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(F.left)+")";case "ISNOT":if("null"!==F.right.type)throw Error("Unsupported RHS for IS");return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(F.left)+")))";case "IN":return"this.applyIn("+
this.evaluateNodeToJavaScript(F.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(F.right)+"))";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(F.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(F.right)+")))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(F.left)+","+this.evaluateNodeToJavaScript(F.right)+")";case "NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(F.left)+","+this.evaluateNodeToJavaScript(F.right)+
")";case "LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(F.left)+","+this.evaluateNodeToJavaScript(F.right)+","+JSON.stringify(F.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(F.left)+","+this.evaluateNodeToJavaScript(F.right)+","+JSON.stringify(F.escape)+"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+JSON.stringify(F.operator)+","+this.evaluateNodeToJavaScript(F.left)+","+
this.evaluateNodeToJavaScript(F.right)+")";case "*":case "-":case "+":case "/":case "||":return"this.calculate("+JSON.stringify(F.operator)+","+this.evaluateNodeToJavaScript(F.left)+","+this.evaluateNodeToJavaScript(F.right)+")"}throw Error("Not Supported Operator "+F.operator);case "null":case "boolean":case "string":case "number":return JSON.stringify(F.value);case "date":return"(new Date("+d(F.value).getTime().toString()+"))";case "timestamp":return"(new Date("+t(F.value).getTime().toString()+
"))";case "current-time":return"date"===F.mode?"this.currentDate()":"this.currentTimestamp()";case "column-reference":return"this.featureValue(feature,"+JSON.stringify(F.column)+",datefields,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(F.name)+","+this.evaluateNodeToJavaScript(F.args)+")"}throw Error("Unsupported sql syntax "+F.type);};N._evaluateNode=function(F,R,m){switch(F.type){case "interval":return R=this._evaluateNode(F.value,R,m),u.SqlInterval.createFromValueAndQualifer(R,
F.qualifier,F.op);case "case-expression":if("simple"===F.format){var C=y(this._evaluateNode(F.operand,R,m));for(var M=0;M<F.clauses.length;M++)if(C===y(this._evaluateNode(F.clauses[M].operand,R,m)))return this._evaluateNode(F.clauses[M].value,R,m)}else for(C=0;C<F.clauses.length;C++)if(!0===this._evaluateNode(F.clauses[C].operand,R,m))return this._evaluateNode(F.clauses[C].value,R,m);return null!==F.else?this._evaluateNode(F.else,R,m):null;case "parameter":return this.parameters[F.value.toLowerCase()];
case "expression-list":C=[];for(M of F.value)C.push(this._evaluateNode(M,R,m));return C;case "unary-expression":return r(this._evaluateNode(F.expr,R,m));case "binary-expression":switch(F.operator){case "AND":return l(this._evaluateNode(F.left,R,m),this._evaluateNode(F.right,R,m));case "OR":return p(this._evaluateNode(F.left,R,m),this._evaluateNode(F.right,R,m));case "IS":if("null"!==F.right.type)throw Error("Unsupported RHS for IS");return null===this._evaluateNode(F.left,R,m);case "ISNOT":if("null"!==
F.right.type)throw Error("Unsupported RHS for IS");return null!==this._evaluateNode(F.left,R,m);case "IN":return C=k(this._evaluateNode(F.right,R,m)),B(this._evaluateNode(F.left,R,m),C);case "NOT IN":return C=k(this._evaluateNode(F.right,R,m)),r(B(this._evaluateNode(F.left,R,m),C));case "BETWEEN":return C=this._evaluateNode(F.left,R,m),F=this._evaluateNode(F.right,R,m),null==C||null==F[0]||null==F[1]?null:C>=y(F[0])&&C<=y(F[1]);case "NOTBETWEEN":return C=this._evaluateNode(F.left,R,m),F=this._evaluateNode(F.right,
R,m),null==C||null==F[0]||null==F[1]?null:C<y(F[0])||C>y(F[1]);case "LIKE":return x(this._evaluateNode(F.left,R,m),this._evaluateNode(F.right,R,m),F.escape);case "NOT LIKE":return r(x(this._evaluateNode(F.left,R,m),this._evaluateNode(F.right,R,m),F.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return G(F.operator,this._evaluateNode(F.left,R,m),this._evaluateNode(F.right,R,m));case "-":case "+":case "*":case "/":case "||":return P(F.operator,this._evaluateNode(F.left,
R,m),this._evaluateNode(F.right,R,m))}case "null":case "boolean":case "string":case "number":return F.value;case "date":return d(F.value);case "timestamp":return t(F.value);case "current-time":return R=new Date,"date"===F.mode&&R.setHours(0,0,0,0),R;case "column-reference":return O(R,F.column,this._datefields,m);case "data-type":return F.value;case "function":return R=this._evaluateNode(F.args,R,m),this.isAggregate?H.aggregateFunction(F.name,R):u.evaluateFunction(F.name,R)}throw Error("Unsupported sql syntax "+
F.type);};n._createClass(z,[{key:"fieldNames",get:function(){return this._referencedFieldNames}},{key:"hasDateFunctions",get:function(){if(null!=this._hasDateFunctions)return this._hasDateFunctions;this._hasDateFunctions=!1;this._visitAll(this.parseTree,F=>{"current-time"===F.type?this._hasDateFunctions=!0:"function"===F.type&&(this._hasDateFunctions=this._hasDateFunctions||Q.has(F.name.toLowerCase()))});return this._hasDateFunctions}}]);return z}();var A;(function(z){z[z.Normal=0]="Normal";z[z.Escaped=
1]="Escaped"})(A||(A={}));const J={getAttribute(z,N){return(z&&"object"===typeof z.attributes?z.attributes:z)[N]}};b.WhereClause=f;b.defaultAttributeAdapter=J;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/AggregateFunctions":function(){define(["exports"],function(b){function n(u){let K=0;for(let E=0;E<u.length;E++)K+=u[E];return K/u.length}function e(u){const K=n(u),E=u.length;let h=0;for(const t of u)h+=(t-K)**2;return 1<E?h/(E-1):0}const H={min:{minParams:1,maxParams:1,
evaluate:u=>null==u[0]?null:Math.min.apply(Math,u[0])},max:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:Math.max.apply(Math,u[0])},avg:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:n(u[0])},sum:{minParams:1,maxParams:1,evaluate:u=>{if(null==u[0])u=null;else{u=u[0];let K=0;for(let E=0;E<u.length;E++)K+=u[E];u=K}return u}},stddev:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:Math.sqrt(e(u[0]))},count:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:u[0].length},var:{minParams:1,
maxParams:1,evaluate:u=>null==u[0]?null:e(u[0])}};b.aggregateFunction=function(u,K){const E=H[u.toLowerCase()];if(null==E)throw Error("Function Not Recognised");if(K.length<E.minParams||K.length>E.maxParams)throw Error(`Invalid Parameter count for call to ${u.toUpperCase()}`);return E.evaluate(K)};b.isAggregate=function(u,K){u=H[u.toLowerCase()];return null!=u&&K>=u.minParams&&K<=u.maxParams};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/StandardizedFunctions":function(){define(["exports",
"../../arcade/featureset/support/errorsupport","../string","../../chunks/datetime"],function(b,n,e,H){function u(t){t=new Date(t.getTime());t.setHours(0,0,0,0);return t}function K(t,d){if(t instanceof Date)return d?u(t):t;if("string"===typeof t||t instanceof String)if(t=H.DateTime.fromSQL(t),t.isValid)return d?u(t.toJSDate()):t.toJSDate();throw new n.SqlError(n.SqlErrorCodes.CannotCastValue);}let E=function(){function t(){this.op="+";this.millis=this.minute=this.year=this.month=this.hour=this.second=
this.day=0}t._fixDefaults=function(d){if(null!==d.precision||null!==d.secondary)throw Error("Primary and Secondary SqlInterval qualifiers not supported");};t._parseSecondsComponent=function(d,k){k.includes(".")?(k=k.split("."),d.second=parseFloat(k[0]),d.millis=parseInt(k[1],10)):d.second=parseFloat(k)};t.createFromMilliseconds=function(d){const k=new t;k.second=d/1E3;return k};t.createFromValueAndQualifer=function(d,k,r){let l=null;const p=new t;p.op="-"===r?"-":"+";if("interval-period"===k.type){t._fixDefaults(k);
r=RegExp("^[0-9]{1,}$");if("year"===k.period||"month"===k.period)throw Error("Year-Month Intervals not supported");if("second"===k.period)if(/^[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/.test(d))t._parseSecondsComponent(p,d);else throw Error("Illegal Interval");else if(r.test(d))p[k.period]=parseFloat(d);else throw Error("Illegal Interval");}else{t._fixDefaults(k.start);t._fixDefaults(k.end);if("year"===k.start.period||"month"===k.start.period)throw Error("Year-Month Intervals not supported");if("year"===k.end.period||
"month"===k.end.period)throw Error("Year-Month Intervals not supported");switch(k.start.period){case "day":switch(k.end.period){case "hour":l=RegExp("^[0-9]{1,} [0-9]{1,}$");if(l.test(d))p[k.start.period]=parseFloat(d.split(" ")[0]),p[k.end.period]=parseFloat(d.split(" ")[1]);else throw Error("Illegal Interval");break;case "minute":l=RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$");if(l.test(d))p[k.start.period]=parseFloat(d.split(" ")[0]),d=d.split(" ")[1].split(":"),p.hour=parseFloat(d[0]),p.minute=parseFloat(d[1]);
else throw Error("Illegal Interval");break;case "second":l=RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(l.test(d))p[k.start.period]=parseFloat(d.split(" ")[0]),d=d.split(" ")[1].split(":"),p.hour=parseFloat(d[0]),p.minute=parseFloat(d[1]),t._parseSecondsComponent(p,d[2]);else throw Error("Illegal Interval");break;default:throw Error("Invalid Interval.");}break;case "hour":switch(k.end.period){case "minute":l=RegExp("^[0-9]{1,}:[0-9]{1,}$");if(l.test(d))p.hour=parseFloat(d.split(":")[0]),
p.minute=parseFloat(d.split(":")[1]);else throw Error("Illegal Interval");break;case "second":l=RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(l.test(d))d=d.split(":"),p.hour=parseFloat(d[0]),p.minute=parseFloat(d[1]),t._parseSecondsComponent(p,d[2]);else throw Error("Illegal Interval");break;default:throw Error("Invalid Interval.");}break;case "minute":switch(k.end.period){case "second":l=RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(l.test(d))d=d.split(":"),p.minute=
parseFloat(d[0]),t._parseSecondsComponent(p,d[1]);else throw Error("Illegal Interval");break;default:throw Error("Invalid Interval.");}break;default:throw Error("Invalid Interval.");}}return p};t.prototype.valueInMilliseconds=function(){return("-"===this.op?-1:1)*(this.millis+1E3*this.second+6E4*this.minute+36E5*this.hour+864E5*this.day+365/12*this.month*864E5+31536E6*this.year)};return t}();const h={extract:{minParams:2,maxParams:2,evaluate:([t,d])=>{if(null==d)return null;if(d instanceof Date)switch(t.toUpperCase()){case "SECOND":return d.getSeconds();
case "MINUTE":return d.getMinutes();case "HOUR":return d.getHours();case "DAY":return d.getDate();case "MONTH":return d.getMonth()+1;case "YEAR":return d.getFullYear()}throw Error("Invalid Parameter for call to EXTRACT");}},substring:{minParams:2,maxParams:3,evaluate:t=>{if(2===t.length){const [d,k]=t;return null==d||null==k?null:d.toString().substring(k-1)}if(3===t.length){const [d,k,r]=t;return null==d||null==k||null==r?null:0>=r?"":d.toString().substring(k-1,k+r-1)}}},position:{minParams:2,maxParams:2,
evaluate:([t,d])=>null==t||null==d?null:d.indexOf(t)+1},trim:{minParams:2,maxParams:3,evaluate:t=>{var d=3===t.length,k=d?t[1]:" ";d=d?t[2]:t[1];if(null==k||null==d)return null;k=`(${e.escapeRegExpString(k)})`;switch(t[0]){case "BOTH":return d.replace(new RegExp(`^${k}*|${k}*$`,"g"),"");case "LEADING":return d.replace(new RegExp(`^${k}*`,"g"),"");case "TRAILING":return d.replace(new RegExp(`${k}*$`,"g"),"")}throw Error("Invalid Parameter for call to TRIM");}},abs:{minParams:1,maxParams:1,evaluate:t=>
null==t[0]?null:Math.abs(t[0])},ceiling:{minParams:1,maxParams:1,evaluate:t=>null==t[0]?null:Math.ceil(t[0])},floor:{minParams:1,maxParams:1,evaluate:t=>null==t[0]?null:Math.floor(t[0])},log:{minParams:1,maxParams:1,evaluate:t=>null==t[0]?null:Math.log(t[0])},log10:{minParams:1,maxParams:1,evaluate:t=>null==t[0]?null:Math.log(t[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:t=>null==t[0]?null:Math.sin(t[0])},cos:{minParams:1,maxParams:1,evaluate:t=>null==t[0]?null:Math.cos(t[0])},tan:{minParams:1,
maxParams:1,evaluate:t=>null==t[0]?null:Math.tan(t[0])},asin:{minParams:1,maxParams:1,evaluate:t=>null==t[0]?null:Math.asin(t[0])},acos:{minParams:1,maxParams:1,evaluate:t=>null==t[0]?null:Math.acos(t[0])},atan:{minParams:1,maxParams:1,evaluate:t=>null==t[0]?null:Math.atan(t[0])},sign:{minParams:1,maxParams:1,evaluate:t=>null==t[0]?null:0<t[0]?1:0>t[1]?-1:0},power:{minParams:2,maxParams:2,evaluate:t=>null==t[0]||null==t[1]?null:t[0]**t[1]},mod:{minParams:2,maxParams:2,evaluate:t=>null==t[0]||null==
t[1]?null:t[0]%t[1]},round:{minParams:1,maxParams:2,evaluate:t=>{const d=t[0];t=2===t.length?10**t[1]:1;return null==d?null:Math.round(d*t)/t}},truncate:{minParams:1,maxParams:2,evaluate:t=>null==t[0]?null:1===t.length?parseInt(t[0].toFixed(0),10):parseFloat(t[0].toFixed(t[1]))},char_length:{minParams:1,maxParams:1,evaluate:t=>"string"===typeof t[0]||t[0]instanceof String?t[0].length:0},concat:{minParams:1,maxParams:Infinity,evaluate:t=>{let d="";for(let k=0;k<t.length;k++){if(null==t[k])return null;
d+=t[k].toString()}return d}},lower:{minParams:1,maxParams:1,evaluate:t=>null==t[0]?null:t[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:t=>null==t[0]?null:t[0].toString().toUpperCase()},coalesce:{minParams:1,maxParams:Infinity,evaluate:t=>{for(const d of t)if(null!==d)return d;return null}},cosh:{minParams:1,maxParams:1,evaluate:t=>null==t[0]?null:Math.cosh(t[0])},sinh:{minParams:1,maxParams:1,evaluate:t=>null==t[0]?null:Math.sinh(t[0])},tanh:{minParams:1,maxParams:1,evaluate:t=>
null==t[0]?null:Math.tanh(t[0])},nullif:{minParams:2,maxParams:2,evaluate:t=>{const d=t[0];t=t[1];return(d instanceof Date?d.valueOf():d)===(t instanceof Date?t.valueOf():t)?null:d}},cast:{minParams:2,maxParams:2,evaluate:t=>{var d=t[0];t=t[1];if(null===d)return null;switch(t.type){case "integer":d=parseInt(d,10);if(isNaN(d))throw new n.SqlError(n.SqlErrorCodes.CannotCastValue);return d;case "smallint":d=parseInt(d,10);if(isNaN(d))throw new n.SqlError(n.SqlErrorCodes.CannotCastValue);if(32767<d||
-32767>d)throw new n.SqlError(n.SqlErrorCodes.CannotCastValue);return d;case "float":case "real":d=parseFloat(d);if(isNaN(d))throw new n.SqlError(n.SqlErrorCodes.CannotCastValue);return d;case "date":return K(d,!0);case "timestamp":return K(d,!1);case "varchar":d=d.toString();if(d.length>t.size)throw new n.SqlError(n.SqlErrorCodes.CannotCastValue);return d;default:throw new n.SqlError(n.SqlErrorCodes.InvalidDataType);}}}};b.SqlInterval=E;b.evaluateFunction=function(t,d){const k=h[t.toLowerCase()];
if(null==k)throw Error("Function Not Recognised");if(d.length<k.minParams||d.length>k.maxParams)throw Error(`Invalid Parameter count for call to ${t.toUpperCase()}`);return k.evaluate(d)};b.isStandardized=function(t,d){t=h[t.toLowerCase()];return null!=t&&d>=t.minParams&&d<=t.maxParams};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/featureset/support/errorsupport":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../executionError"],function(b,
n,e){b.SqlErrorCodes=void 0;(function(h){h.InvalidFunctionParameters="InvalidFunctionParameters";h.UnsupportedSqlFunction="UnsupportedSqlFunction";h.UnsupportedOperator="UnsupportedOperator";h.UnsupportedSyntax="UnsupportedSyntax";h.UnsupportedIsRhs="UnsupportedIsRhs";h.UnsupportedIsLhs="UnsupportedIsLhs";h.InvalidDataType="InvalidDataType";h.CannotCastValue="CannotCastValue";h.MissingStatisticParameters="MissingStatisticParameters"})(b.SqlErrorCodes||(b.SqlErrorCodes={}));const H={[b.SqlErrorCodes.MissingStatisticParameters]:"Statistic does not have 1 or 0 Parameters",
[b.SqlErrorCodes.InvalidFunctionParameters]:"Invalid parameters for call to {function}",[b.SqlErrorCodes.UnsupportedIsLhs]:"Unsupported left hand expression in is statement",[b.SqlErrorCodes.UnsupportedIsRhs]:"Unsupported right hand expression in is statement",[b.SqlErrorCodes.UnsupportedOperator]:"Unsupported operator - {operator}",[b.SqlErrorCodes.UnsupportedSyntax]:"Unsupported syntax - {node}",[b.SqlErrorCodes.UnsupportedSqlFunction]:"Sql function not found \x3d {function}",[b.SqlErrorCodes.InvalidDataType]:"Invalid sql data type",
[b.SqlErrorCodes.CannotCastValue]:"Cannot cast value to the required data type"};let u=function(h){function t(d,k){d=h.call(this,e.doSubstitutions(H[d],k))||this;d.declaredRootClass="esri.arcade.featureset.support.sqlerror";Error.captureStackTrace&&Error.captureStackTrace(n._assertThisInitialized(d),t);return d}n._inheritsLoose(t,h);return t}(n._wrapNativeSuper(Error));b.FeatureSetErrorCodes=void 0;(function(h){h.NeverReach="NeverReach";h.NotImplemented="NotImplemented";h.Cancelled="Cancelled";h.InvalidStatResponse=
"InvalidStatResponse";h.InvalidRequest="InvalidRequest";h.RequestFailed="RequestFailed";h.MissingFeatures="MissingFeatures";h.AggregationFieldNotFound="AggregationFieldNotFound";h.DataElementsNotFound="DataElementsNotFound"})(b.FeatureSetErrorCodes||(b.FeatureSetErrorCodes={}));const K={[b.FeatureSetErrorCodes.Cancelled]:"Cancelled",[b.FeatureSetErrorCodes.InvalidStatResponse]:"Invalid statistics response from service",[b.FeatureSetErrorCodes.InvalidRequest]:"Invalid request",[b.FeatureSetErrorCodes.RequestFailed]:"Request failed - {reason}",
[b.FeatureSetErrorCodes.MissingFeatures]:"Missing features",[b.FeatureSetErrorCodes.AggregationFieldNotFound]:"Aggregation field not found",[b.FeatureSetErrorCodes.DataElementsNotFound]:"Data elements not found on service",[b.FeatureSetErrorCodes.NeverReach]:"Encountered unreachable logic",[b.FeatureSetErrorCodes.NotImplemented]:"Not implemented"};let E=function(h){function t(d,k){d=h.call(this,e.doSubstitutions(K[d],k))||this;d.declaredRootClass="esri.arcade.featureset.support.featureseterror";Error.captureStackTrace&&
Error.captureStackTrace(n._assertThisInitialized(d),t);return d}n._inheritsLoose(t,h);return t}(n._wrapNativeSuper(Error));b.FeatureSetError=E;b.FeatureSetErrorMessages=K;b.SqlError=u;b.SqlErrorMessages=H;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereGrammar":function(){define(["exports","../../chunks/_commonjsHelpers"],function(b,n){var e={};(function(u){(function(K,E){u.exports&&(u.exports=E())})(n.commonjsGlobal,function(){function K(h,t,d,k){h=Error.call(this,
h);Object.setPrototypeOf&&Object.setPrototypeOf(h,K.prototype);h.expected=t;h.found=d;h.location=k;h.name="SyntaxError";return h}function E(h,t,d){d=d||" ";if(h.length>t)return h;t-=h.length;d+=d.repeat(t);return h+d.slice(0,t)}(function(h,t){function d(){this.constructor=h}d.prototype=t.prototype;h.prototype=new d})(K,Error);K.prototype.format=function(h){var t="Error: "+this.message;if(this.location){var d=null,k;for(k=0;k<h.length;k++)if(h[k].source===this.location.source){d=h[k].text.split(/\r\n|\n|\r/g);
break}h=this.location.start;k=this.location.source+":"+h.line+":"+h.column;if(d){var r=this.location.end,l=E("",h.line.toString().length," ");d=d[h.line-1];r=(h.line===r.line?r.column:d.length+1)-h.column||1;t+="\n --\x3e "+k+"\n"+l+" |\n"+h.line+" | "+d+"\n"+l+" | "+E("",h.column-1," ")+E("",r,"^")}else t+="\n at "+k}return t};K.buildMessage=function(h,t){function d(B){return B.charCodeAt(0).toString(16).toUpperCase()}function k(B){return B.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,
"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(x){return"\\x0"+d(x)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(x){return"\\x"+d(x)})}function r(B){return B.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(x){return"\\x0"+d(x)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(x){return"\\x"+d(x)})}function l(B){return p[B.type](B)}
var p={literal:function(B){return'"'+k(B.text)+'"'},class:function(B){var x=B.parts.map(function(y){return Array.isArray(y)?r(y[0])+"-"+r(y[1]):r(y)});return"["+(B.inverted?"^":"")+x.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(B){return B.description}};return"Expected "+function(B){B=B.map(l);var x,y;B.sort();if(0<B.length){for(y=x=1;x<B.length;x++)B[x-1]!==B[x]&&(B[y]=B[x],y++);B.length=y}switch(B.length){case 1:return B[0];case 2:return B[0]+
" or "+B[1];default:return B.slice(0,-1).join(", ")+", or "+B[B.length-1]}}(h)+" but "+(t?'"'+k(t)+'"':"end of input")+" found."};return{SyntaxError:K,parse:function(h,t){function d(V,W){return{type:"literal",text:V,ignoreCase:W}}function k(V,W,ca){return{type:"class",parts:V,inverted:W,ignoreCase:ca}}function r(V){var W=Gb[V],ca;if(!W){for(ca=V-1;!Gb[ca];)ca--;W=Gb[ca];for(W={line:W.line,column:W.column};ca<V;)10===h.charCodeAt(ca)?(W.line++,W.column=1):W.column++,ca++;Gb[V]=W}return W}function l(V,
W){var ca=r(V),na=r(W);return{source:qd,start:{offset:V,line:ca.line,column:ca.column},end:{offset:W,line:na.line,column:na.column}}}function p(V){I<Xa||(I>Xa&&(Xa=I,ec=[]),ec.push(V))}function B(){var V=I;pa();var W=y();W!==q?(pa(),V=W):(I=V,V=q);return V}function x(){var V=I;var W=y();if(W!==q){V=[];var ca=I;var na=pa();var va=Ja();if(va!==q){var Ca=pa();var Da=y();Da!==q?ca=na=[na,va,Ca,Da]:(I=ca,ca=q)}else I=ca,ca=q;for(;ca!==q;)V.push(ca),ca=I,na=pa(),va=Ja(),va!==q?(Ca=pa(),Da=y(),Da!==q?ca=
na=[na,va,Ca,Da]:(I=ca,ca=q)):(I=ca,ca=q);ca={type:"expression-list"};W=[W];for(na=0;na<V.length;na++)W.push(V[na][3]);ca.value=W;V=ca}else I=V,V=q;return V}function y(){var V=I;var W=G();if(W!==q){V=[];var ca=I;var na=pa();var va=X();if(va!==q){var Ca=pa();var Da=G();Da!==q?ca=na=[na,va,Ca,Da]:(I=ca,ca=q)}else I=ca,ca=q;for(;ca!==q;)V.push(ca),ca=I,na=pa(),va=X(),va!==q?(Ca=pa(),Da=G(),Da!==q?ca=na=[na,va,Ca,Da]:(I=ca,ca=q)):(I=ca,ca=q);V=vb(W,V)}else I=V,V=q;return V}function G(){var V=I;var W=
P();if(W!==q){V=[];var ca=I;var na=pa();var va=fa();if(va!==q){var Ca=pa();var Da=P();Da!==q?ca=na=[na,va,Ca,Da]:(I=ca,ca=q)}else I=ca,ca=q;for(;ca!==q;)V.push(ca),ca=I,na=pa(),va=fa(),va!==q?(Ca=pa(),Da=P(),Da!==q?ca=na=[na,va,Ca,Da]:(I=ca,ca=q)):(I=ca,ca=q);V=vb(W,V)}else I=V,V=q;return V}function P(){var V=I;var W=da();if(W===q){W=I;if(33===h.charCodeAt(I)){var ca=rd;I++}else ca=q,0===la&&p(sd);if(ca!==q){var na=I;la++;if(61===h.charCodeAt(I)){var va=wc;I++}else va=q,0===la&&p(xc);la--;va===q?
na=void 0:(I=na,na=q);na!==q?W=ca=[ca,na]:(I=W,W=q)}else I=W,W=q}W!==q?(ca=pa(),na=P(),na!==q?V={type:"unary-expression",operator:"NOT",expr:na}:(I=V,V=q)):(I=V,V=q);if(V===q){W=I;V=c();if(V!==q){pa();W=[];ca=I;na=pa();va=O();if(va!==q){var Ca=pa();var Da=c();Da!==q?ca=na=[na,va,Ca,Da]:(I=ca,ca=q)}else I=ca,ca=q;if(ca!==q)for(;ca!==q;)W.push(ca),ca=I,na=pa(),va=O(),va!==q?(Ca=pa(),Da=c(),Da!==q?ca=na=[na,va,Ca,Da]:(I=ca,ca=q)):(I=ca,ca=q);else W=q;W!==q&&(W={type:"arithmetic",tail:W});W===q&&(W=I,
ca=g(),ca!==q?(pa(),na=Ka(),na!==q?(pa(),na=x(),na!==q?(pa(),va=La(),va!==q?W={op:ca,right:na}:(I=W,W=q)):(I=W,W=q)):(I=W,W=q)):(I=W,W=q),W===q&&(W=I,ca=g(),ca!==q?(pa(),na=Ka(),na!==q?(pa(),na=La(),na!==q?W={op:ca,right:{type:"expression-list",value:[]}}:(I=W,W=q)):(I=W,W=q)):(I=W,W=q),W===q&&(W=I,ca=g(),ca!==q?(pa(),na=N(),na!==q?W={op:ca,right:na}:(I=W,W=q)):(I=W,W=q))),W===q&&(W=I,va=da(),va!==q?(pa(),ca=aa(),ca!==q?(pa(),na=c(),na!==q?(pa(),Ca=fa(),Ca!==q?(pa(),va=c(),va!==q?W={op:"NOT"+ca,right:{type:"expression-list",
value:[na,va]}}:(I=W,W=q)):(I=W,W=q)):(I=W,W=q)):(I=W,W=q)):(I=W,W=q),W===q&&(W=I,va=aa(),va!==q?(pa(),ca=c(),ca!==q?(pa(),na=fa(),na!==q?(pa(),Ca=c(),Ca!==q?W={op:va,right:{type:"expression-list",value:[ca,Ca]}}:(I=W,W=q)):(I=W,W=q)):(I=W,W=q)):(I=W,W=q)),W===q&&(W=I,ca=Aa(),ca!==q?(pa(),na=da(),na!==q?(pa(),na=c(),na!==q?W={op:ca+"NOT",right:na}:(I=W,W=q)):(I=W,W=q)):(I=W,W=q),W===q&&(W=I,ca=Aa(),ca!==q?(pa(),na=c(),na!==q?W={op:ca,right:na}:(I=W,W=q)):(I=W,W=q)),W===q&&(W=I,ca=L(),ca!==q?(pa(),
na=w(),na!==q?(pa(),va=I,h.substr(I,6).toLowerCase()===td?(Ca=h.substr(I,6),I+=6):(Ca=q,0===la&&p(ud)),Ca!==q?(Ca=I,la++,Da=J(),la--,Da===q?Ca=void 0:(I=Ca,Ca=q),Ca!==q?va="ESCAPE":(I=va,va=q)):(I=va,va=q),va!==q?(pa(),va=U(),va!==q?W={op:ca,right:na,escape:va.value}:(I=W,W=q)):(I=W,W=q)):(I=W,W=q)):(I=W,W=q),W===q&&(W=I,ca=L(),ca!==q?(pa(),na=w(),na!==q?W={op:ca,right:na,escape:""}:(I=W,W=q)):(I=W,W=q))))));W===q&&(W=null);""==W||void 0==W||null==W?W=V:(ca=null,W=ca="arithmetic"==W.type?vb(V,W.tail):
yc(W.op,V,W.right,W.escape))}else I=W,W=q;V=W}return V}function O(){if(h.substr(I,2)===zc){var V=zc;I+=2}else V=q,0===la&&p(vd);V===q&&(62===h.charCodeAt(I)?(V=wd,I++):(V=q,0===la&&p(xd)),V===q&&(h.substr(I,2)===Ac?(V=Ac,I+=2):(V=q,0===la&&p(yd)),V===q&&(h.substr(I,2)===Bc?(V=Bc,I+=2):(V=q,0===la&&p(zd)),V===q&&(60===h.charCodeAt(I)?(V=Ad,I++):(V=q,0===la&&p(Bd)),V===q&&(61===h.charCodeAt(I)?(V=wc,I++):(V=q,0===la&&p(xc)),V===q&&(h.substr(I,2)===Cc?(V=Cc,I+=2):(V=q,0===la&&p(Cd))))))));return V}function L(){var V=
V=I;var W=da();if(W!==q){var ca=pa();var na=Z();na!==q?V=W=[W,ca,na]:(I=V,V=q)}else I=V,V=q;V!==q&&(V=V[0]+" "+V[2]);V===q&&(V=Z());return V}function g(){var V=V=I;var W=da();if(W!==q){var ca=pa();var na=ua();na!==q?V=W=[W,ca,na]:(I=V,V=q)}else I=V,V=q;V!==q&&(V=V[0]+" "+V[2]);V===q&&(V=ua());return V}function c(){var V=I;var W=v();if(W!==q){V=[];var ca=I;var na=pa();var va=a();if(va!==q){var Ca=pa();var Da=v();Da!==q?ca=na=[na,va,Ca,Da]:(I=ca,ca=q)}else I=ca,ca=q;for(;ca!==q;)V.push(ca),ca=I,na=
pa(),va=a(),va!==q?(Ca=pa(),Da=v(),Da!==q?ca=na=[na,va,Ca,Da]:(I=ca,ca=q)):(I=ca,ca=q);V=vb(W,V)}else I=V,V=q;return V}function a(){if(43===h.charCodeAt(I)){var V=fc;I++}else V=q,0===la&&p(gc);V===q&&(45===h.charCodeAt(I)?(V=hc,I++):(V=q,0===la&&p(ic)),V===q&&(h.substr(I,2)===Dc?(V=Dc,I+=2):(V=q,0===la&&p(Dd))));return V}function v(){var V=I;var W=D();if(W!==q){V=[];var ca=I;var na=pa();var va=Q();if(va!==q){var Ca=pa();var Da=D();Da!==q?ca=na=[na,va,Ca,Da]:(I=ca,ca=q)}else I=ca,ca=q;for(;ca!==q;)V.push(ca),
ca=I,na=pa(),va=Q(),va!==q?(Ca=pa(),Da=D(),Da!==q?ca=na=[na,va,Ca,Da]:(I=ca,ca=q)):(I=ca,ca=q);V=vb(W,V)}else I=V,V=q;return V}function Q(){if(42===h.charCodeAt(I)){var V=Ed;I++}else V=q,0===la&&p(Fd);V===q&&(47===h.charCodeAt(I)?(V=Gd,I++):(V=q,0===la&&p(Hd)));return V}function D(){var V=U();if(V===q){var W=I;var ca=I;var na=ha();if(na!==q){var va=ja();if(va!==q){var Ca=oa();Ca!==q?ca=parseFloat(na+va+Ca):(I=ca,ca=q)}else I=ca,ca=q}else I=ca,ca=q;ca===q&&(ca=I,na=ha(),na!==q?(va=ja(),va!==q?ca=parseFloat(na+
va):(I=ca,ca=q)):(I=ca,ca=q),ca===q&&(ca=I,na=ha(),na!==q?(va=oa(),va!==q?ca=parseFloat(na+va):(I=ca,ca=q)):(I=ca,ca=q),ca===q&&(ca=I,na=ha(),na!==q&&(na=parseFloat(na)),ca=na)));var Da=ca;if(Da!==q){var Hb=I;la++;var Id=A();la--;Id===q?Hb=void 0:(I=Hb,Hb=q);Hb!==q?W={type:"number",value:Da}:(I=W,W=q)}else I=W,W=q;V=W;if(V===q){var wb=I;var fb=I;if(h.substr(I,4).toLowerCase()===Jd){var Ib=h.substr(I,4);I+=4}else Ib=q,0===la&&p(Kd);if(Ib!==q){var xb=I;la++;var Ld=J();la--;Ld===q?xb=void 0:(I=xb,xb=
q);xb!==q?fb=Ib=[Ib,xb]:(I=fb,fb=q)}else I=fb,fb=q;var eb=fb;eb!==q&&(eb={type:"boolean",value:!0});wb=eb;if(wb===q){wb=I;var gb=I;if(h.substr(I,5).toLowerCase()===Md){var Jb=h.substr(I,5);I+=5}else Jb=q,0===la&&p(Nd);if(Jb!==q){var yb=I;la++;var Od=J();la--;Od===q?yb=void 0:(I=yb,yb=q);yb!==q?gb=Jb=[Jb,yb]:(I=gb,gb=q)}else I=gb,gb=q;eb=gb;eb!==q&&(eb={type:"boolean",value:!1});wb=eb}V=wb;if(V===q){var hb=I;if(h.substr(I,4).toLowerCase()===Pd){var Kb=h.substr(I,4);I+=4}else Kb=q,0===la&&p(Qd);if(Kb!==
q){var zb=I;la++;var Rd=J();la--;Rd===q?zb=void 0:(I=zb,zb=q);zb!==q?hb=Kb=[Kb,zb]:(I=hb,hb=q)}else I=hb,hb=q;var jc=hb;jc!==q&&(jc={type:"null",value:null});V=jc;if(V===q){var ib=I;if(ma()!==q){pa();var Ec=w();Ec!==q?ib={type:"date",value:Ec.value}:(I=ib,ib=q)}else I=ib,ib=q;V=ib;if(V===q){var jb=I;if(ia()!==q){pa();var Fc=w();Fc!==q?jb={type:"timestamp",value:Fc.value}:(I=jb,jb=q)}else I=jb,jb=q;V=jb;if(V===q){var Na=I;var kc=ka();if(kc!==q){pa();if(45===h.charCodeAt(I)){var $a=hc;I++}else $a=q,
0===la&&p(ic);$a===q&&(43===h.charCodeAt(I)?($a=fc,I++):($a=q,0===la&&p(gc)));if($a!==q){pa();var Ab=w();if(Ab!==q){pa();var Gc=R();Gc!==q?Na={type:"interval",value:Ab,qualifier:Gc,op:$a}:(I=Na,Na=q)}else I=Na,Na=q}else I=Na,Na=q}else I=Na,Na=q;Na===q&&(Na=I,kc=ka(),kc!==q?(pa(),$a=w(),$a!==q?(pa(),Ab=R(),Ab!==q?Na={type:"interval",value:$a,qualifier:Ab,op:""}:(I=Na,Na=q)):(I=Na,Na=q)):(I=Na,Na=q));V=Na}}}}}}var Fa=V;if(Fa===q){var Ra=I;var kb=I;if(h.substr(I,7).toLowerCase()===Sd){var Hc=h.substr(I,
7);I+=7}else Hc=q,0===la&&p(Td);if(Hc!==q){var Lb=I;la++;var Ud=J();la--;Ud===q?Lb=void 0:(I=Lb,Lb=q);Lb!==q?kb="EXTRACT":(I=kb,kb=q)}else I=kb,kb=q;if(kb!==q){pa();var Vd=Ka();if(Vd!==q){pa();var Va=qa();Va===q&&(Va=xa(),Va===q&&(Va=ya(),Va===q&&(Va=wa(),Va===q&&(Va=sa(),Va===q&&(Va=za())))));var Ic=Va;if(Ic!==q){pa();var Wd=ea();if(Wd!==q){pa();var Jc=y();if(Jc!==q){pa();var Xd=La();Xd!==q?Ra={type:"function",name:"extract",args:{type:"expression-list",value:[{type:"string",value:Ic},Jc]}}:(I=Ra,
Ra=q)}else I=Ra,Ra=q}else I=Ra,Ra=q}else I=Ra,Ra=q}else I=Ra,Ra=q}else I=Ra,Ra=q;Fa=Ra;if(Fa===q){var Sa=I;var lb=I;if(h.substr(I,9).toLowerCase()===Yd){var Kc=h.substr(I,9);I+=9}else Kc=q,0===la&&p(Zd);if(Kc!==q){var Mb=I;la++;var $d=J();la--;$d===q?Mb=void 0:(I=Mb,Mb=q);Mb!==q?lb="SUBSTRING":(I=lb,lb=q)}else I=lb,lb=q;if(lb!==q){pa();var ae=Ka();if(ae!==q){pa();var lc=y();if(lc!==q){pa();var be=ea();if(be!==q){pa();var mc=y();if(mc!==q){pa();var ab=I;var mb=I;if(h.substr(I,3).toLowerCase()===ce){var Lc=
h.substr(I,3);I+=3}else Lc=q,0===la&&p(de);if(Lc!==q){var Nb=I;la++;var ee=J();la--;ee===q?Nb=void 0:(I=Nb,Nb=q);Nb!==q?mb="FOR":(I=mb,mb=q)}else I=mb,mb=q;var Bb=mb;if(Bb!==q){var fe=pa();var Mc=y();if(Mc!==q){var ge=pa();ab=Bb=[Bb,fe,Mc,ge]}else I=ab,ab=q}else I=ab,ab=q;ab===q&&(ab=null);Bb=La();Bb!==q?Sa={type:"function",name:"substring",args:{type:"expression-list",value:ab?[lc,mc,ab[2]]:[lc,mc]}}:(I=Sa,Sa=q)}else I=Sa,Sa=q}else I=Sa,Sa=q}else I=Sa,Sa=q}else I=Sa,Sa=q}else I=Sa,Sa=q;Fa=Sa;if(Fa===
q){var Ha=I;var nc=ba();if(nc!==q){pa();var oc=Ka();if(oc!==q){pa();var bb=F();bb===q&&(bb=null);pa();var Cb=y();if(Cb!==q){pa();var pc=ea();if(pc!==q){pa();var Nc=y();if(Nc!==q){pa();var he=La();he!==q?Ha={type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:null==bb?"BOTH":bb},Cb,Nc]}}:(I=Ha,Ha=q)}else I=Ha,Ha=q}else I=Ha,Ha=q}else I=Ha,Ha=q}else I=Ha,Ha=q}else I=Ha,Ha=q;Ha===q&&(Ha=I,nc=ba(),nc!==q?(pa(),oc=Ka(),oc!==q?(pa(),bb=F(),bb===q&&(bb=null),pa(),Cb=y(),
Cb!==q?(pa(),pc=La(),pc!==q?Ha={type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:null==bb?"BOTH":bb},Cb]}}:(I=Ha,Ha=q)):(I=Ha,Ha=q)):(I=Ha,Ha=q)):(I=Ha,Ha=q));Fa=Ha;if(Fa===q){var Ta=I;var nb=I;if(h.substr(I,8).toLowerCase()===ie){var Oc=h.substr(I,8);I+=8}else Oc=q,0===la&&p(je);if(Oc!==q){var Ob=I;la++;var ke=J();la--;ke===q?Ob=void 0:(I=Ob,Ob=q);Ob!==q?nb="POSITION":(I=nb,nb=q)}else I=nb,nb=q;if(nb!==q){pa();var le=Ka();if(le!==q){pa();var Pc=y();if(Pc!==q){pa();
var me=ua();if(me!==q){pa();var Qc=y();if(Qc!==q){pa();var ne=La();ne!==q?Ta={type:"function",name:"position",args:{type:"expression-list",value:[Pc,Qc]}}:(I=Ta,Ta=q)}else I=Ta,Ta=q}else I=Ta,Ta=q}else I=Ta,Ta=q}else I=Ta,Ta=q}else I=Ta,Ta=q;Fa=Ta;if(Fa===q){var Ua=I;var ob=I;if(h.substr(I,4).toLowerCase()===oe){var Rc=h.substr(I,4);I+=4}else Rc=q,0===la&&p(pe);if(Rc!==q){var Pb=I;la++;var qe=J();la--;qe===q?Pb=void 0:(I=Pb,Pb=q);Pb!==q?ob="CAST":(I=ob,ob=q)}else I=ob,ob=q;if(ob!==q){pa();var re=
Ka();if(re!==q){pa();var Sc=y();if(Sc!==q){pa();var pb=I;if(h.substr(I,2).toLowerCase()===se){var Tc=h.substr(I,2);I+=2}else Tc=q,0===la&&p(te);if(Tc!==q){var Qb=I;la++;var ue=J();la--;ue===q?Qb=void 0:(I=Qb,Qb=q);Qb!==q?pb="AS":(I=pb,pb=q)}else I=pb,pb=q;var ve=pb;if(ve!==q){pa();var Ga=I;var qb=I;if(h.substr(I,7).toLowerCase()===we){var Uc=h.substr(I,7);I+=7}else Uc=q,0===la&&p(xe);if(Uc!==q){var Rb=I;la++;var ye=J();la--;ye===q?Rb=void 0:(I=Rb,Rb=q);Rb!==q?qb="INTEGER":(I=qb,qb=q)}else I=qb,qb=
q;var Ia=qb;Ia!==q&&(Ia={type:"data-type",value:{type:"integer"}});Ga=Ia;if(Ga===q){Ga=I;var rb=I;if(h.substr(I,8).toLowerCase()===ze){var Vc=h.substr(I,8);I+=8}else Vc=q,0===la&&p(Ae);if(Vc!==q){var Sb=I;la++;var Be=J();la--;Be===q?Sb=void 0:(I=Sb,Sb=q);Sb!==q?rb="SMALLINT":(I=rb,rb=q)}else I=rb,rb=q;Ia=rb;Ia!==q&&(Ia={type:"data-type",value:{type:"smallint"}});Ga=Ia;if(Ga===q){Ga=I;var sb=I;if(h.substr(I,5).toLowerCase()===Ce){var Wc=h.substr(I,5);I+=5}else Wc=q,0===la&&p(De);if(Wc!==q){var Tb=
I;la++;var Ee=J();la--;Ee===q?Tb=void 0:(I=Tb,Tb=q);Tb!==q?sb="FLOAT":(I=sb,sb=q)}else I=sb,sb=q;Ia=sb;Ia!==q&&(Ia={type:"data-type",value:{type:"float"}});Ga=Ia;if(Ga===q){Ga=I;var tb=I;if(h.substr(I,4).toLowerCase()===Fe){var Xc=h.substr(I,4);I+=4}else Xc=q,0===la&&p(Ge);if(Xc!==q){var Ub=I;la++;var He=J();la--;He===q?Ub=void 0:(I=Ub,Ub=q);Ub!==q?tb="REAL":(I=tb,tb=q)}else I=tb,tb=q;Ia=tb;Ia!==q&&(Ia={type:"data-type",value:{type:"real"}});Ga=Ia;if(Ga===q&&(Ga=I,Ia=ma(),Ia!==q&&(Ia={type:"data-type",
value:{type:"date"}}),Ga=Ia,Ga===q&&(Ga=I,Ia=ia(),Ia!==q&&(Ia={type:"data-type",value:{type:"timestamp"}}),Ga=Ia,Ga===q))){Ga=I;var ub=I;if(h.substr(I,7).toLowerCase()===Ie){var Yc=h.substr(I,7);I+=7}else Yc=q,0===la&&p(Je);if(Yc!==q){var Vb=I;la++;var Ke=J();la--;Ke===q?Vb=void 0:(I=Vb,Vb=q);Vb!==q?ub="VARCHAR":(I=ub,ub=q)}else I=ub,ub=q;Ia=ub;if(Ia!==q){pa();var Le=Ka();if(Le!==q){pa();var Zc=ra();if(Zc!==q){pa();var Me=La();Me!==q?Ga={type:"data-type",value:{type:"varchar",size:parseInt(Zc)}}:
(I=Ga,Ga=q)}else I=Ga,Ga=q}else I=Ga,Ga=q}else I=Ga,Ga=q}}}}var $c=Ga;if($c!==q){pa();var Ne=La();Ne!==q?Ua={type:"function",name:"cast",args:{type:"expression-list",value:[Sc,$c]}}:(I=Ua,Ua=q)}else I=Ua,Ua=q}else I=Ua,Ua=q}else I=Ua,Ua=q}else I=Ua,Ua=q}else I=Ua,Ua=q;Fa=Ua;if(Fa===q){var db=I;var Wb;var Wa=I;Wa=Wb=f();if(Wa===q)if(Wa=I,96===h.charCodeAt(I)?(Wb=ad,I++):(Wb=q,0===la&&p(bd)),Wb!==q){var Xb=[];if(cd.test(h.charAt(I))){var cb=h.charAt(I);I++}else cb=q,0===la&&p(dd);if(cb!==q)for(;cb!==
q;)Xb.push(cb),cd.test(h.charAt(I))?(cb=h.charAt(I),I++):(cb=q,0===la&&p(dd));else Xb=q;Xb!==q?(96===h.charCodeAt(I)?(cb=ad,I++):(cb=q,0===la&&p(bd)),cb!==q?Wa=Xb.join(""):(I=Wa,Wa=q)):(I=Wa,Wa=q)}else I=Wa,Wa=q;var ed=Wa;if(ed!==q){pa();var Oe=Ka();if(Oe!==q){pa();var Yb=x();Yb===q&&(Yb=null);pa();var Pe=La();Pe!==q?db={type:"function",name:ed,args:Yb?Yb:{type:"expression-list",value:[]}}:(I=db,db=q)}else I=db,db=q}else I=db,db=q;Fa=db;if(Fa===q){var Ya;var Oa=I;var qc=Ba();if(qc!==q){pa();var Db=
y();if(Db!==q){pa();var Eb=[];for(Ya=S();Ya!==q;)Eb.push(Ya),Ya=S();Ya=pa();var Zb=Ea();Zb!==q?Oa={type:"case-expression",format:"simple",operand:Db,clauses:Eb,else:null}:(I=Oa,Oa=q)}else I=Oa,Oa=q}else I=Oa,Oa=q;if(Oa===q)if(Oa=I,qc=Ba(),qc!==q)if(pa(),Db=y(),Db!==q){pa();Eb=[];for(Ya=S();Ya!==q;)Eb.push(Ya),Ya=S();Ya=pa();Zb=Y();if(Zb!==q){pa();var Qe=Ea();Qe!==q?Oa={type:"case-expression",format:"simple",operand:Db,clauses:Eb,else:Zb.value}:(I=Oa,Oa=q)}else I=Oa,Oa=q}else I=Oa,Oa=q;else I=Oa,Oa=
q;var rc=Oa;if(rc===q){var Za;var Qa=I;var sc=Ba();if(sc!==q){pa();var Fb=[];for(Za=T();Za!==q;)Fb.push(Za),Za=T();Za=pa();var $b=Ea();$b!==q?Qa={type:"case-expression",format:"searched",clauses:Fb,else:null}:(I=Qa,Qa=q)}else I=Qa,Qa=q;if(Qa===q)if(Qa=I,sc=Ba(),sc!==q){pa();Fb=[];for(Za=T();Za!==q;)Fb.push(Za),Za=T();Za=pa();$b=Y();if($b!==q){pa();var Re=Ea();Re!==q?Qa={type:"case-expression",format:"searched",clauses:Fb,else:$b.value}:(I=Qa,Qa=q)}else I=Qa,Qa=q}else I=Qa,Qa=q;rc=Qa}Fa=rc;if(Fa===
q){var ac;var bc=I;var fd=A();if(fd!==q){var gd=[];for(ac=z();ac!==q;)gd.push(ac),ac=z();bc=fd+gd.join("")}else I=bc,bc=q;var cc=bc;if(cc!==q){var tc=cc;cc=/^CURRENT_DATE$/i.test(tc)?{type:"current-time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(tc)?{type:"current-time",mode:"timestamp"}:{type:"column-reference",table:"",column:tc}}Fa=cc;if(Fa===q&&(Fa=N(),Fa===q)){Fa=I;var Se=Ka();if(Se!==q){pa();var uc=y();if(uc!==q){pa();var Te=La();Te!==q?(uc.paren=!0,Fa=uc):(I=Fa,Fa=q)}else I=Fa,Fa=q}else I=Fa,
Fa=q}}}}}}}}}return Fa}function f(){var V;var W=I;var ca=A();if(ca!==q){W=[];for(V=J();V!==q;)W.push(V),V=J();W=ca+W.join("")}else I=W,W=q;return W}function A(){if(Ue.test(h.charAt(I))){var V=h.charAt(I);I++}else V=q,0===la&&p(Ve);return V}function J(){if(We.test(h.charAt(I))){var V=h.charAt(I);I++}else V=q,0===la&&p(Xe);return V}function z(){if(Ye.test(h.charAt(I))){var V=h.charAt(I);I++}else V=q,0===la&&p(Ze);return V}function N(){var V=I;if(64===h.charCodeAt(I)){var W=$e;I++}else W=q,0===la&&p(af);
if(W!==q){var ca=f();ca!==q?V=W=[W,ca]:(I=V,V=q)}else I=V,V=q;V!==q&&(V={type:"parameter",value:V[1]});return V}function F(){var V=I;if(h.substr(I,7).toLowerCase()===bf){var W=h.substr(I,7);I+=7}else W=q,0===la&&p(cf);if(W!==q){W=I;la++;var ca=J();la--;ca===q?W=void 0:(I=W,W=q);W!==q?V="LEADING":(I=V,V=q)}else I=V,V=q;V===q&&(V=I,h.substr(I,8).toLowerCase()===df?(W=h.substr(I,8),I+=8):(W=q,0===la&&p(ef)),W!==q?(W=I,la++,ca=J(),la--,ca===q?W=void 0:(I=W,W=q),W!==q?V="TRAILING":(I=V,V=q)):(I=V,V=q),
V===q&&(V=I,h.substr(I,4).toLowerCase()===ff?(W=h.substr(I,4),I+=4):(W=q,0===la&&p(gf)),W!==q?(W=I,la++,ca=J(),la--,ca===q?W=void 0:(I=W,W=q),W!==q?V="BOTH":(I=V,V=q)):(I=V,V=q)));return V}function R(){var V=I;var W=I;var ca=m();if(ca!==q){pa();var na=Ka();if(na!==q)if(pa(),na=M(),na!==q){pa();var va=La();va!==q?W={type:"interval-period",period:ca.value,precision:na,secondary:null}:(I=W,W=q)}else I=W,W=q;else I=W,W=q}else I=W,W=q;W===q&&(W=I,ca=m(),ca!==q&&(ca={type:"interval-period",period:ca.value,
precision:null,secondary:null}),W=ca);if(W!==q)if(pa(),ca=I,h.substr(I,2).toLowerCase()===hf?(na=h.substr(I,2),I+=2):(na=q,0===la&&p(jf)),na!==q?(na=I,la++,va=J(),la--,va===q?na=void 0:(I=na,na=q),na!==q?ca="TO":(I=ca,ca=q)):(I=ca,ca=q),ca!==q){pa();ca=I;na=m();na!==q&&(na={type:"interval-period",period:na.value,precision:null,secondary:null});ca=na;if(ca===q){ca=I;na=za();if(na!==q)if(pa(),na=Ka(),na!==q)if(pa(),na=M(),na!==q)if(pa(),va=Ja(),va!==q)if(pa(),va=C(),va!==q){pa();var Ca=La();Ca!==q?
ca={type:"interval-period",period:"second",precision:na,secondary:va}:(I=ca,ca=q)}else I=ca,ca=q;else I=ca,ca=q;else I=ca,ca=q;else I=ca,ca=q;else I=ca,ca=q;ca===q&&(ca=I,na=za(),na!==q?(pa(),na=Ka(),na!==q?(pa(),na=M(),na!==q?(pa(),va=La(),va!==q?ca={type:"interval-period",period:"second",precision:na,secondary:null}:(I=ca,ca=q)):(I=ca,ca=q)):(I=ca,ca=q)):(I=ca,ca=q),ca===q&&(ca=I,na=za(),na!==q&&(na={type:"interval-period",period:"second",precision:null,secondary:null}),ca=na))}ca!==q?V={type:"interval-qualifier",
start:W,end:ca}:(I=V,V=q)}else I=V,V=q;else I=V,V=q;V===q&&(V=I,ca=m(),ca!==q?(pa(),W=Ka(),W!==q?(pa(),W=C(),W!==q?(pa(),na=La(),na!==q?V={type:"interval-period",period:ca.value,precision:W,secondary:null}:(I=V,V=q)):(I=V,V=q)):(I=V,V=q)):(I=V,V=q),V===q&&(V=I,ca=m(),ca!==q&&(ca={type:"interval-period",period:ca.value,precision:null,secondary:null}),V=ca,V===q&&(V=I,ca=za(),ca!==q?(pa(),W=Ka(),W!==q?(pa(),W=M(),W!==q?(pa(),na=Ja(),na!==q?(pa(),ca=C(),ca!==q?(pa(),na=La(),na!==q?V={type:"interval-period",
period:"second",precision:W,secondary:ca}:(I=V,V=q)):(I=V,V=q)):(I=V,V=q)):(I=V,V=q)):(I=V,V=q)):(I=V,V=q),V===q&&(V=I,ca=za(),ca!==q?(pa(),W=Ka(),W!==q?(pa(),W=C(),W!==q?(pa(),na=La(),na!==q?V={type:"interval-period",period:"second",precision:W,secondary:null}:(I=V,V=q)):(I=V,V=q)):(I=V,V=q)):(I=V,V=q),V===q&&(V=I,ca=za(),ca!==q&&(ca={type:"interval-period",period:"second",precision:null,secondary:null}),V=ca)))));return V}function m(){var V=I;V=ya();V!==q&&(V={type:"string",value:"day"});V===q&&
(V=I,V=wa(),V!==q&&(V={type:"string",value:"hour"}),V===q&&(V=I,V=sa(),V!==q&&(V={type:"string",value:"minute"}),V===q&&(V=I,V=xa(),V!==q&&(V={type:"string",value:"month"}),V===q&&(V=I,V=qa(),V!==q&&(V={type:"string",value:"year"})))));return V}function C(){var V=ra();V!==q&&(V=parseFloat(V));return V}function M(){var V=ra();V!==q&&(V=parseFloat(V));return V}function w(){var V=U();V===q&&(V=N());return V}function U(){var V=I;if(39===h.charCodeAt(I)){var W=hd;I++}else W=q,0===la&&p(id);W===q&&(h.substr(I,
2)===jd?(W=jd,I+=2):(W=q,0===la&&p(kf)));if(W!==q){W=[];var ca=I;h.substr(I,2)===dc?(ca=dc,I+=2):(ca=q,0===la&&p(kd));ca!==q&&(ca="'");ca===q&&(ld.test(h.charAt(I))?(ca=h.charAt(I),I++):(ca=q,0===la&&p(md)));for(;ca!==q;)W.push(ca),ca=I,h.substr(I,2)===dc?(ca=dc,I+=2):(ca=q,0===la&&p(kd)),ca!==q&&(ca="'"),ca===q&&(ld.test(h.charAt(I))?(ca=h.charAt(I),I++):(ca=q,0===la&&p(md)));39===h.charCodeAt(I)?(ca=hd,I++):(ca=q,0===la&&p(id));ca!==q?V={type:"string",value:W.join("")}:(I=V,V=q)}else I=V,V=q;return V}
function T(){var V=I;if(Ma()!==q){pa();var W=y();if(W!==q){pa();var ca=Pa();ca!==q?(pa(),ca=y(),ca!==q?V={type:"when-clause",operand:W,value:ca}:(I=V,V=q)):(I=V,V=q)}else I=V,V=q}else I=V,V=q;return V}function S(){var V=I;if(Ma()!==q){pa();var W=y();if(W!==q){pa();var ca=Pa();ca!==q?(pa(),ca=y(),ca!==q?V={type:"when-clause",operand:W,value:ca}:(I=V,V=q)):(I=V,V=q)}else I=V,V=q}else I=V,V=q;return V}function Y(){var V=I;var W=I;if(h.substr(I,4).toLowerCase()===lf){var ca=h.substr(I,4);I+=4}else ca=
q,0===la&&p(mf);if(ca!==q){ca=I;la++;var na=J();la--;na===q?ca=void 0:(I=ca,ca=q);ca!==q?W="ELSE":(I=W,W=q)}else I=W,W=q;W!==q?(pa(),W=y(),W!==q?V={type:"else-clause",value:W}:(I=V,V=q)):(I=V,V=q);return V}function ha(){var V=ra();if(V===q){V=I;if(45===h.charCodeAt(I)){var W=hc;I++}else W=q,0===la&&p(ic);W===q&&(43===h.charCodeAt(I)?(W=fc,I++):(W=q,0===la&&p(gc)));if(W!==q){var ca=ra();ca!==q?V=W[0]+ca:(I=V,V=q)}else I=V,V=q}return V}function ja(){var V=I;if(46===h.charCodeAt(I)){var W=nf;I++}else W=
q,0===la&&p(of);W!==q?(V=ra(),V===q&&(V=null),V="."+(null!=V?V:"")):(I=V,V=q);return V}function oa(){var V;var W=V=I;if(pf.test(h.charAt(I))){var ca=h.charAt(I);I++}else ca=q,0===la&&p(qf);ca!==q?(rf.test(h.charAt(I))?(W=h.charAt(I),I++):(W=q,0===la&&p(sf)),W===q&&(W=null),W="e"+(null===W?"":W)):(I=W,W=q);W!==q?(ca=ra(),ca!==q?V=W+ca:(I=V,V=q)):(I=V,V=q);return V}function ra(){var V=[];var W=ta();if(W!==q)for(;W!==q;)V.push(W),W=ta();else V=q;V!==q&&(V=V.join(""));return V}function ta(){if(tf.test(h.charAt(I))){var V=
h.charAt(I);I++}else V=q,0===la&&p(uf);return V}function ua(){var V=I;if(h.substr(I,2).toLowerCase()===vf){var W=h.substr(I,2);I+=2}else W=q,0===la&&p(wf);if(W!==q){W=I;la++;var ca=J();la--;ca===q?W=void 0:(I=W,W=q);W!==q?V="IN":(I=V,V=q)}else I=V,V=q;return V}function Aa(){var V=I;if(h.substr(I,2).toLowerCase()===xf){var W=h.substr(I,2);I+=2}else W=q,0===la&&p(yf);if(W!==q){W=I;la++;var ca=J();la--;ca===q?W=void 0:(I=W,W=q);W!==q?V="IS":(I=V,V=q)}else I=V,V=q;return V}function Z(){var V=I;if(h.substr(I,
4).toLowerCase()===zf){var W=h.substr(I,4);I+=4}else W=q,0===la&&p(Af);if(W!==q){W=I;la++;var ca=J();la--;ca===q?W=void 0:(I=W,W=q);W!==q?V="LIKE":(I=V,V=q)}else I=V,V=q;return V}function da(){var V=I;if(h.substr(I,3).toLowerCase()===Bf){var W=h.substr(I,3);I+=3}else W=q,0===la&&p(Cf);if(W!==q){W=I;la++;var ca=J();la--;ca===q?W=void 0:(I=W,W=q);W!==q?V="NOT":(I=V,V=q)}else I=V,V=q;return V}function fa(){var V=I;if(h.substr(I,3).toLowerCase()===Df){var W=h.substr(I,3);I+=3}else W=q,0===la&&p(Ef);if(W!==
q){W=I;la++;var ca=J();la--;ca===q?W=void 0:(I=W,W=q);W!==q?V="AND":(I=V,V=q)}else I=V,V=q;return V}function X(){var V=I;if(h.substr(I,2).toLowerCase()===Ff){var W=h.substr(I,2);I+=2}else W=q,0===la&&p(Gf);if(W!==q){W=I;la++;var ca=J();la--;ca===q?W=void 0:(I=W,W=q);W!==q?V="OR":(I=V,V=q)}else I=V,V=q;return V}function aa(){var V=I;if(h.substr(I,7).toLowerCase()===Hf){var W=h.substr(I,7);I+=7}else W=q,0===la&&p(If);if(W!==q){W=I;la++;var ca=J();la--;ca===q?W=void 0:(I=W,W=q);W!==q?V="BETWEEN":(I=
V,V=q)}else I=V,V=q;return V}function ea(){var V=I;if(h.substr(I,4).toLowerCase()===Jf){var W=h.substr(I,4);I+=4}else W=q,0===la&&p(Kf);if(W!==q){W=I;la++;var ca=J();la--;ca===q?W=void 0:(I=W,W=q);W!==q?V="FROM":(I=V,V=q)}else I=V,V=q;return V}function ba(){var V=I;if(h.substr(I,4).toLowerCase()===Lf){var W=h.substr(I,4);I+=4}else W=q,0===la&&p(Mf);if(W!==q){W=I;la++;var ca=J();la--;ca===q?W=void 0:(I=W,W=q);W!==q?V="TRIM":(I=V,V=q)}else I=V,V=q;return V}function ia(){var V=I;if(h.substr(I,9).toLowerCase()===
Nf){var W=h.substr(I,9);I+=9}else W=q,0===la&&p(Of);if(W!==q){W=I;la++;var ca=J();la--;ca===q?W=void 0:(I=W,W=q);W!==q?V="TIMESTAMP":(I=V,V=q)}else I=V,V=q;return V}function ma(){var V=I;if(h.substr(I,4).toLowerCase()===Pf){var W=h.substr(I,4);I+=4}else W=q,0===la&&p(Qf);if(W!==q){W=I;la++;var ca=J();la--;ca===q?W=void 0:(I=W,W=q);W!==q?V="DATE":(I=V,V=q)}else I=V,V=q;return V}function ka(){var V=I;if(h.substr(I,8).toLowerCase()===Rf){var W=h.substr(I,8);I+=8}else W=q,0===la&&p(Sf);if(W!==q){W=I;
la++;var ca=J();la--;ca===q?W=void 0:(I=W,W=q);W!==q?V="INTERVAL":(I=V,V=q)}else I=V,V=q;return V}function qa(){var V=I;if(h.substr(I,4).toLowerCase()===Tf){var W=h.substr(I,4);I+=4}else W=q,0===la&&p(Uf);if(W!==q){W=I;la++;var ca=J();la--;ca===q?W=void 0:(I=W,W=q);W!==q?V="YEAR":(I=V,V=q)}else I=V,V=q;return V}function xa(){var V=I;if(h.substr(I,5).toLowerCase()===Vf){var W=h.substr(I,5);I+=5}else W=q,0===la&&p(Wf);if(W!==q){W=I;la++;var ca=J();la--;ca===q?W=void 0:(I=W,W=q);W!==q?V="MONTH":(I=V,
V=q)}else I=V,V=q;return V}function ya(){var V=I;if(h.substr(I,3).toLowerCase()===Xf){var W=h.substr(I,3);I+=3}else W=q,0===la&&p(Yf);if(W!==q){W=I;la++;var ca=J();la--;ca===q?W=void 0:(I=W,W=q);W!==q?V="DAY":(I=V,V=q)}else I=V,V=q;return V}function wa(){var V=I;if(h.substr(I,4).toLowerCase()===Zf){var W=h.substr(I,4);I+=4}else W=q,0===la&&p($f);if(W!==q){W=I;la++;var ca=J();la--;ca===q?W=void 0:(I=W,W=q);W!==q?V="HOUR":(I=V,V=q)}else I=V,V=q;return V}function sa(){var V=I;if(h.substr(I,6).toLowerCase()===
ag){var W=h.substr(I,6);I+=6}else W=q,0===la&&p(bg);if(W!==q){W=I;la++;var ca=J();la--;ca===q?W=void 0:(I=W,W=q);W!==q?V="MINUTE":(I=V,V=q)}else I=V,V=q;return V}function za(){var V=I;if(h.substr(I,6).toLowerCase()===cg){var W=h.substr(I,6);I+=6}else W=q,0===la&&p(dg);if(W!==q){W=I;la++;var ca=J();la--;ca===q?W=void 0:(I=W,W=q);W!==q?V="SECOND":(I=V,V=q)}else I=V,V=q;return V}function Ba(){var V=I;if(h.substr(I,4).toLowerCase()===eg){var W=h.substr(I,4);I+=4}else W=q,0===la&&p(fg);if(W!==q){W=I;la++;
var ca=J();la--;ca===q?W=void 0:(I=W,W=q);W!==q?V="CASE":(I=V,V=q)}else I=V,V=q;return V}function Ea(){var V=I;if(h.substr(I,3).toLowerCase()===gg){var W=h.substr(I,3);I+=3}else W=q,0===la&&p(hg);if(W!==q){W=I;la++;var ca=J();la--;ca===q?W=void 0:(I=W,W=q);W!==q?V="END":(I=V,V=q)}else I=V,V=q;return V}function Ma(){var V=I;if(h.substr(I,4).toLowerCase()===ig){var W=h.substr(I,4);I+=4}else W=q,0===la&&p(jg);if(W!==q){W=I;la++;var ca=J();la--;ca===q?W=void 0:(I=W,W=q);W!==q?V="WHEN":(I=V,V=q)}else I=
V,V=q;return V}function Pa(){var V=I;if(h.substr(I,4).toLowerCase()===kg){var W=h.substr(I,4);I+=4}else W=q,0===la&&p(lg);if(W!==q){W=I;la++;var ca=J();la--;ca===q?W=void 0:(I=W,W=q);W!==q?V="THEN":(I=V,V=q)}else I=V,V=q;return V}function Ja(){if(44===h.charCodeAt(I)){var V=mg;I++}else V=q,0===la&&p(ng);return V}function Ka(){if(40===h.charCodeAt(I)){var V=og;I++}else V=q,0===la&&p(pg);return V}function La(){if(41===h.charCodeAt(I)){var V=qg;I++}else V=q,0===la&&p(rg);return V}function pa(){var V;
var W=[];for(V=nd();V!==q;)W.push(V),V=nd();return W}function nd(){if(sg.test(h.charAt(I))){var V=h.charAt(I);I++}else V=q,0===la&&p(tg);return V}function yc(V,W,ca,na){V={type:"binary-expression",operator:V,left:W,right:ca};void 0!==na&&(V.escape=na);return V}function vb(V,W){for(var ca=0;ca<W.length;ca++)V=yc(W[ca][1],V,W[ca][3]);return V}t=void 0!==t?t:{};var q={},qd=t.grammarSource,od={start:B},pd=B,rd="!",wc="\x3d",zc="\x3e\x3d",wd="\x3e",Ac="\x3c\x3d",Bc="\x3c\x3e",Ad="\x3c",Cc="!\x3d",fc="+",
hc="-",Dc="||",Ed="*",Gd="/",$e="@",hd="'",jd="N'",dc="''",nf=".",Pd="null",Jd="true",Md="false",vf="in",xf="is",zf="like",td="escape",Bf="not",Df="and",Ff="or",Hf="between",Jf="from",ce="for",Yd="substring",Sd="extract",Lf="trim",ie="position",Nf="timestamp",Pf="date",bf="leading",df="trailing",ff="both",oe="cast",se="as",we="integer",ze="smallint",Ce="float",Fe="real",Ie="varchar",hf="to",Rf="interval",Tf="year",Vf="month",Xf="day",Zf="hour",ag="minute",cg="second",eg="case",gg="end",ig="when",
kg="then",lf="else",mg=",",og="(",qg=")",ad="`",Ue=/^[A-Za-z_\x80-\uFFFF]/,We=/^[A-Za-z0-9_]/,Ye=/^[A-Za-z0-9_.\x80-\uFFFF]/,ld=/^[^']/,tf=/^[0-9]/,pf=/^[eE]/,rf=/^[+\-]/,sg=/^[ \t\n\r]/,cd=/^[^`]/,sd=d("!",!1),xc=d("\x3d",!1),vd=d("\x3e\x3d",!1),xd=d("\x3e",!1),yd=d("\x3c\x3d",!1),zd=d("\x3c\x3e",!1),Bd=d("\x3c",!1),Cd=d("!\x3d",!1),gc=d("+",!1),ic=d("-",!1),Dd=d("||",!1),Fd=d("*",!1),Hd=d("/",!1),Ve=k([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),Xe=k([["A","Z"],["a","z"],["0","9"],"_"],
!1,!1),Ze=k([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],!1,!1),af=d("@",!1),id=d("'",!1),kf=d("N'",!1),kd=d("''",!1),md=k(["'"],!0,!1),of=d(".",!1),uf=k([["0","9"]],!1,!1),qf=k(["e","E"],!1,!1),sf=k(["+","-"],!1,!1),Qd=d("NULL",!0),Kd=d("TRUE",!0),Nd=d("FALSE",!0),wf=d("IN",!0),yf=d("IS",!0),Af=d("LIKE",!0),ud=d("ESCAPE",!0),Cf=d("NOT",!0),Ef=d("AND",!0),Gf=d("OR",!0),If=d("BETWEEN",!0),Kf=d("FROM",!0),de=d("FOR",!0),Zd=d("SUBSTRING",!0),Td=d("EXTRACT",!0),Mf=d("TRIM",!0),je=d("POSITION",
!0),Of=d("TIMESTAMP",!0),Qf=d("DATE",!0),cf=d("LEADING",!0),ef=d("TRAILING",!0),gf=d("BOTH",!0),pe=d("CAST",!0),te=d("AS",!0),xe=d("INTEGER",!0),Ae=d("SMALLINT",!0),De=d("FLOAT",!0),Ge=d("REAL",!0),Je=d("VARCHAR",!0),jf=d("TO",!0),Sf=d("INTERVAL",!0),Uf=d("YEAR",!0),Wf=d("MONTH",!0),Yf=d("DAY",!0),$f=d("HOUR",!0),bg=d("MINUTE",!0),dg=d("SECOND",!0),fg=d("CASE",!0),hg=d("END",!0),jg=d("WHEN",!0),lg=d("THEN",!0),mf=d("ELSE",!0),ng=d(",",!1),pg=d("(",!1),rg=d(")",!1),tg=k([" ","\t","\n","\r"],!1,!1),
bd=d("`",!1),dd=k(["`"],!0,!1),I=0,Gb=[{line:1,column:1}],Xa=0,ec=[],la=0;if("startRule"in t){if(!(t.startRule in od))throw Error("Can't start parsing from rule \""+t.startRule+'".');pd=od[t.startRule]}var vc=pd();if(vc!==q&&I===h.length)return vc;vc!==q&&I<h.length&&p({type:"end"});throw function(V,W,ca){return new K(K.buildMessage(V,W),V,W,ca)}(ec,Xa<h.length?h.charAt(Xa):null,Xa<h.length?l(Xa,Xa+1):l(Xa,Xa));}}})})({get exports(){return e},set exports(u){e=u}});let H=function(){function u(){}u.parse=
function(K){return e.parse(K)};return u}();b.WhereGrammar=H;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/statistics/utils":function(){define(["exports","../rest/support/ClassBreaksDefinition","../rest/support/generateRendererUtils"],function(b,n,e){function H(c){return null==c||"string"===typeof c&&!c?"\x3cNull\x3e":c}function u(c){const a=null!=c.minValue||null!=c.maxValue,v=!!c.sqlExpression&&c.supportsSQLExpression;return!(null!=c.normalizationField||null!=c.normalizationType)&&
!a&&!v}function K(c){const {values:a,useSampleStdDev:v,supportsNullCount:Q}=c;var D=Number.POSITIVE_INFINITY;let f=Number.NEGATIVE_INFINITY,A=null,J=null;var z=null;let N=null,F=0;const R=null==c.minValue?-Infinity:c.minValue,m=null==c.maxValue?Infinity:c.maxValue;for(const C of a)Number.isFinite(C)?C>=R&&C<=m&&(A=null===A?C:A+C,D=Math.min(D,C),f=Math.max(f,C),F++):"string"===typeof C&&F++;if(F&&null!=A){J=A/F;z=0;for(const C of a)Number.isFinite(C)&&C>=R&&C<=m&&(z+=(C-J)**2);N=v?1<F?z/(F-1):0:0<
F?z/F:0;z=Math.sqrt(N)}else f=D=null;D={avg:J,count:F,max:f,min:D,stddev:z,sum:A,variance:N};Q&&(D.nullcount=a.length-F);c.percentileParams&&(D.median=E(a,c.percentileParams));return D}function E(c,a){const {fieldType:v,value:Q,orderBy:D,isDiscrete:f}=a,A=h(v,"desc"===D);c=[...c].filter(F=>null!=F).sort((F,R)=>A(F,R));if(0===c.length)return null;if(0>=Q)return c[0];if(1<=Q)return c[c.length-1];var J=(c.length-1)*Q,z=Math.floor(J);a=z+1;J%=1;z=c[z];const N=c[a];return a>=c.length||f||"string"===typeof z||
"string"===typeof N?z:z*(1-J)+N*J}function h(c,a){const v=a?1:-1,Q=k(a),D=d(a);if(!c||!["esriFieldTypeDate","esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID",...L].includes(c))return(f,A)=>"number"===typeof f&&"number"===typeof A?Q(f,A):"string"===typeof f&&"string"===typeof A?D(f,A):v;if("esriFieldTypeDate"===c)return(f,A)=>{f=(new Date(f)).getTime();A=(new Date(A)).getTime();return isNaN(f)||isNaN(A)?v:Q(f,A)};if(L.has(c))return(f,A)=>Q(f,A);if("esriFieldTypeString"===c)return(f,
A)=>D(f,A);if("esriFieldTypeGUID"===c||"esriFieldTypeGlobalID"===c){const f=d(a);return(A,J)=>f(r(A),r(J))}return a?(f,A)=>1:(f,A)=>-1}function t(c,a,v){if(v){if(null==c)return null==a?0:1;if(null==a)return-1}else{if(null==c)return null==a?0:-1;if(null==a)return 1}return null}function d(c){return c?(a,v)=>{const Q=t(a,v,!0);if(null!=Q)return Q;a=a.toUpperCase();v=v.toUpperCase();return a>v?-1:a<v?1:0}:(a,v)=>{const Q=t(a,v,!1);if(null!=Q)return Q;a=a.toUpperCase();v=v.toUpperCase();return a<v?-1:
a>v?1:0}}function k(c){return c?(a,v)=>{const Q=t(a,v,!0);return null!=Q?Q:v-a}:(a,v)=>{const Q=t(a,v,!1);return null!=Q?Q:a-v}}function r(c){return c.substr(24,12)+c.substr(19,4)+c.substr(16,2)+c.substr(14,2)+c.substr(11,2)+c.substr(9,2)+c.substr(6,2)+c.substr(4,2)+c.substr(2,2)+c.substr(0,2)}function l(c){return"coded-value"!==c?.type?[]:c.codedValues.map(a=>a.code)}function p(c,a){const v=x({field:a.field,normalizationType:a.normalizationType,normalizationField:a.normalizationField,classificationMethod:a.classificationMethod,
standardDeviationInterval:a.standardDeviationInterval,breakCount:a.numClasses||5});c=B(c,a.minValue,a.maxValue);return e.createGenerateRendererClassBreaks({definition:v,values:c,normalizationTotal:a.normalizationTotal})}function B(c,a,v){const Q=null==a?-Infinity:a,D=null==v?Infinity:v;return c.filter(f=>Number.isFinite(f)&&f>=Q&&f<=D)}function x(c){const {breakCount:a,field:v,normalizationField:Q,normalizationType:D}=c,f=c.classificationMethod||"equal-interval";return new n({breakCount:a,classificationField:v,
classificationMethod:f,normalizationField:"field"===D?Q:void 0,normalizationType:D,standardDeviationInterval:"standard-deviation"===f?c.standardDeviationInterval||1:void 0})}function y(c,a){const {field:v,classificationMethod:Q,standardDeviationInterval:D,normalizationType:f,normalizationField:A,normalizationTotal:J,minValue:z,maxValue:N}=a,F=a.numBins||10;let R=a=null,m=null;Q&&"equal-interval"!==Q||f?({classBreaks:c}=p(c,{field:v,normalizationType:f,normalizationField:A,normalizationTotal:J,classificationMethod:Q,
standardDeviationInterval:D,minValue:z,maxValue:N,numClasses:F}),a=c[0].minValue,R=c[c.length-1].maxValue,m=c.map(C=>[C.minValue,C.maxValue])):(null!=z&&null!=N?(a=z,R=N):(c=K({values:c,minValue:z,maxValue:N,useSampleStdDev:!f,supportsNullCount:u({normalizationType:f,normalizationField:A,minValue:z,maxValue:N})}),a=c.min??null,R=c.max??null),m=P(a??0,R??0,F));return{min:a,max:R,intervals:m}}function G(c,a){let v=-1;for(let Q=c.length-1;0<=Q;Q--)if(a>=c[Q][0]){v=Q;break}return v}function P(c,a,v){const Q=
(a-c)/v,D=[];let f;for(let A=1;A<=v;A++)f=c+Q,f=Number(f.toFixed(16)),D.push([c,A===v?a:f]),c=f;return D}const O=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,L=new Set(["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]),g="min max avg stddev count sum variance nullcount median".split(" ");b.calculateClassBreaks=p;b.calculateHistogram=function(c,a){var v=y(c,a);const Q=v.intervals,D=v.min??0;v=v.max??0;const f=Q.map((A,J)=>({minValue:Q[J][0],maxValue:Q[J][1],
count:0}));for(const A of c)null!=A&&A>=D&&A<=v&&(c=G(Q,A),-1<c&&f[c].count++);return{bins:f,minValue:D,maxValue:v,normalizationTotal:a.normalizationTotal}};b.calculatePercentile=E;b.calculateStatistics=K;b.calculateStringStatistics=function(c){const a=c.returnDistinct?[...(new Set(c.values))]:c.values,v=a.filter(D=>null!=D).length,Q={count:v};c.supportsNullCount&&(Q.nullcount=a.length-v);c.percentileParams&&(Q.median=E(a,c.percentileParams));return Q};b.calculateUniqueValuesCount=function(c){const a=
{};for(let v of c){if(null==v||"string"===typeof v&&""===v.trim())v=null;null==a[v]?a[v]={count:1,data:v}:a[v].count++}return{count:a}};b.createClassBreaksDefinition=x;b.createUVResult=function(c,a,v,Q){c=c.count;const D=[];if(v&&a){v=[];var f=l(a[0]);for(const A of f)if(a[1]){f=l(a[1]);for(const J of f)if(a[2]){f=l(a[2]);for(const z of f)v.push(`${H(A)}${Q}${H(J)}${Q}${H(z)}`)}else v.push(`${H(A)}${Q}${H(J)}`)}else v.push(A);for(const A of v)c.hasOwnProperty(A)||(c[A]={data:A,count:0})}for(const A in c)a=
c[A],D.push({value:a.data,count:a.count,label:a.label});return{uniqueValueInfos:D}};b.getAttributeComparator=h;b.getEqualIntervalBins=P;b.getNormalizedValue=function(c,a,v,Q){let D=null;switch(a){case "log":0!==c&&(D=Math.log(c)*Math.LOG10E);break;case "percent-of-total":Number.isFinite(Q)&&0!==Q&&(D=c/Q*100);break;case "field":Number.isFinite(v)&&0!==v&&(D=c/v);break;case "natural-log":0<c&&(D=Math.log(c));break;case "square-root":0<c&&(D=c**.5)}return D};b.isNullCountSupported=u;b.processNullValue=
H;b.processSummaryStatisticsResult=function(c,a){let v;for(v in c)g.includes(v)&&(Number.isFinite(c[v])||(c[v]=null));if(!a)return c;["avg","stddev","variance"].forEach(Q=>{null!=c[Q]&&(c[Q]=Math.ceil(c[Q]))});return c};b.resolveCBResult=function(c,a){let v=c.classBreaks;const Q=v[0].minValue,D=v[v.length-1].maxValue,f="standard-deviation"===a;v=v.map(A=>{const J=A.label;A={minValue:A.minValue,maxValue:A.maxValue,label:J};if(f&&J){const z=J.match(O)?.map(N=>+N.trim())??[];2===z.length?(A.minStdDev=
z[0],A.maxStdDev=z[1],0>z[0]&&0<z[1]&&(A.hasAvg=!0)):1===z.length&&(J.includes("\x3c")?(A.minStdDev=null,A.maxStdDev=z[0]):J.includes("\x3e")&&(A.minStdDev=z[0],A.maxStdDev=null))}return A});return{minValue:Q,maxValue:D,classBreakInfos:v,normalizationTotal:c.normalizationTotal}};b.statisticTypes=g;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/ClassBreaksDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,n,e,H,u,K,E,h,t){K=new e.JSONMap({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"});e=new e.JSONMap({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});H=function(d){function k(r){r=d.call(this,r)||this;r.type="class-breaks-definition";r.breakCount=
null;r.classificationField=null;r.classificationMethod=null;r.normalizationField=null;r.normalizationType=null;return r}b._inheritsLoose(k,d);b._createClass(k,[{key:"standardDeviationInterval",set:function(r){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",r)}},{key:"definedInterval",set:function(r){"defined-interval"===this.classificationMethod&&this._set("definedInterval",r)}}]);return k}(H.JSONSupport);n.__decorate([h.enumeration({classBreaksDef:"class-breaks-definition"})],
H.prototype,"type",void 0);n.__decorate([u.property({json:{write:!0}})],H.prototype,"breakCount",void 0);n.__decorate([u.property({json:{write:!0}})],H.prototype,"classificationField",void 0);n.__decorate([u.property({type:String,json:{read:K.read,write:K.write}})],H.prototype,"classificationMethod",void 0);n.__decorate([u.property({json:{write:!0}})],H.prototype,"normalizationField",void 0);n.__decorate([u.property({json:{read:e.read,write:e.write}})],H.prototype,"normalizationType",void 0);n.__decorate([u.property({value:null,
json:{write:!0}})],H.prototype,"standardDeviationInterval",null);n.__decorate([u.property({value:null,json:{write:!0}})],H.prototype,"definedInterval",null);return H=n.__decorate([t.subclass("esri.rest.support.ClassBreaksDefinition")],H)})},"esri/rest/support/generateRendererUtils":function(){define(["exports","../../core/Logger"],function(b,n){function e(l){var p=l.definition;const {classificationMethod:B,normalizationType:x,definedInterval:y}=p;p=p.breakCount??1;const G=[];var P=l.values;if(0===
P.length)return[];P=P.sort((v,Q)=>v-Q);var O=P[0],L=P[P.length-1];if("equal-interval"===B)if(P.length>=p){P=(L-O)/p;l=O;for(var g=1;g<p;g++){var c=Number((O+g*P).toFixed(6));G.push({minValue:l,maxValue:c,label:H(l,c,x)});l=c}G.push({minValue:l,maxValue:L,label:H(l,L,x)})}else P.forEach(v=>{G.push({minValue:v,maxValue:v,label:H(v,v,x)})});else if("natural-breaks"===B){P=u(P);l=K(P.uniqueValues,l.valueFrequency||P.valueFrequency,p);for(g=1;g<p;g++)P.uniqueValues.length>g&&(c=Number(P.uniqueValues[l[g]].toFixed(6)),
G.push({minValue:O,maxValue:c,label:H(O,c,x)}),O=c);G.push({minValue:O,maxValue:L,label:H(O,L,x)})}else if("quantile"===B)if(P.length>=p&&O!==L){l=Math.ceil(P.length/p);g=0;for(c=1;c<p;c++){var a=l+g-1;a>P.length&&(a=P.length-1);0>a&&(a=0);G.push({minValue:O,maxValue:P[a],label:H(O,P[a],x)});O=P[a];g+=l;l=Math.ceil((P.length-g)/(p-c))}G.push({minValue:O,maxValue:L,label:H(O,L,x)})}else for(p=-1,L=0;L<P.length;L++)O=P[L],O!==p&&(p=O,G.push({minValue:p,maxValue:O,label:H(p,O,x)}),p=O);else if("standard-deviation"===
B)if(l=t(P),g=d(P,l),0===g)G.push({minValue:P[0],maxValue:P[0],label:H(P[0],P[0],x)});else{P=h(O,L,p,l,g)*g;g=0;for(c=p;1<=c;c--)a=Number((l-(c-.5)*P).toFixed(6)),G.push({minValue:O,maxValue:a,label:H(O,a,x)}),O=a,g++;c=Number((l+.5*P).toFixed(6));G.push({minValue:O,maxValue:c,label:H(O,c,x)});O=c;g++;for(a=1;a<=p;a++)c=g===2*p?L:Number((l+(a+.5)*P).toFixed(6)),G.push({minValue:O,maxValue:c,label:H(O,c,x)}),O=c,g++}else if("defined-interval"===B){if(!y)return G;p=P[0];L=P[P.length-1];P=Math.ceil((L-
p)/y);O=p;for(l=1;l<P;l++)g=Number((p+l*y).toFixed(6)),G.push({minValue:O,maxValue:g,label:H(O,g,x)}),O=g;G.push({minValue:O,maxValue:L,label:H(O,L,x)})}return G}function H(l,p,B){let x=null;return x=l===p?B&&"percent-of-total"===B?l+"%":l.toString():B&&"percent-of-total"===B?l+"% - "+p+"%":l+" - "+p}function u(l){const p=[],B=[];let x=Number.MIN_VALUE,y=1,G=-1;for(let P=0;P<l.length;P++){const O=l[P];O===x?(y++,B[G]=y):null!==O&&(p.push(O),x=O,y=1,B.push(y),G++)}return{uniqueValues:p,valueFrequency:B}}
function K(l,p,B){var x=l.length;const y=[];B>x&&(B=x);for(var G=0;G<B;G++)y.push(Math.round(G*x/B-1));y.push(x-1);G=E(y,l,p,B);x=G.mean;G=G.sdcm;var P=B,O=0,L=0;let g=0,c=0,a=!0;for(let Q=0;2>Q&&a;Q++){0===Q&&(a=!1);for(var v=0;v<P-1;v++)for(;y[v+1]+1!==y[v+2];)if(y[v+1]+=1,O=k(v,y,l,p),g=O.sbMean,O=O.sbSdcm,L=k(v+1,y,l,p),c=L.sbMean,L=L.sbSdcm,O+L<G[v]+G[v+1])G[v]=O,G[v+1]=L,x[v]=g,x[v+1]=c,a=!0;else{--y[v+1];break}for(v=P-1;0<v;v--)for(;y[v]!==y[v-1]+1;)if(--y[v],O=k(v-1,y,l,p),g=O.sbMean,O=O.sbSdcm,
L=k(v,y,l,p),c=L.sbMean,L=L.sbSdcm,O+L<G[v-1]+G[v])G[v-1]=O,G[v]=L,x[v-1]=g,x[v]=c,a=!0;else{y[v]+=1;break}}a&&(G=E(y,l,p,B));return y}function E(l,p,B,x){let y=[];var G=[],P=[];let O=0;const L=[],g=[];for(var c=0;c<x;c++){var a=k(c,l,p,B);L.push(a.sbMean);g.push(a.sbSdcm);O+=g[c]}a=O;for(c=!0;c||O<a;){c=!1;y=[];for(G=0;G<x;G++)y.push(l[G]);for(P=0;P<x;P++)for(a=l[P]+1;a<=l[P+1];a++)if(G=p[a],0<P&&a!==l[P+1]&&Math.abs(G-L[P])>Math.abs(G-L[P-1]))l[P]=a;else if(P<x-1&&l[P]!==a-1&&Math.abs(G-L[P])>Math.abs(G-
L[P+1])){l[P+1]=a-1;break}a=O;O=0;G=[];P=[];for(let v=0;v<x;v++){G.push(L[v]);P.push(g[v]);const Q=k(v,l,p,B);L[v]=Q.sbMean;g[v]=Q.sbSdcm;O+=g[v]}}if(O>a){for(p=0;p<x;p++)l[p]=y[p],L[p]=G[p],g[p]=P[p];O=a}return{mean:L,sdcm:g}}function h(l,p,B,x,y){l=Math.max(x-l,p-x)/y/B;return 1<=l?1:.5<=l?.5:.25}function t(l){let p=0;for(let B=0;B<l.length;B++)p+=l[B];return p/=l.length}function d(l,p){let B=0;for(let x=0;x<l.length;x++){const y=l[x];B+=(y-p)*(y-p)}B/=l.length;return Math.sqrt(B)}function k(l,
p,B,x){var y=0,G=0;for(var P=p[l]+1;P<=p[l+1];P++){const O=x[P];y+=B[P]*O;G+=O}0>=G&&r.warn("Exception in Natural Breaks calculation");y/=G;G=0;for(P=p[l]+1;P<=p[l+1];P++)G+=x[P]*(B[P]-y)**2;return{sbMean:y,sbSdcm:G}}const r=n.getLogger("esri.rest.support.generateRendererUtils");b.createGenerateRendererClassBreaks=function(l){const {normalizationTotal:p}=l;return{classBreaks:e(l),normalizationTotal:p}};b.createGenerateRendererUniqueValues=function(l){l=u(l);const p=[],B=l.uniqueValues.length;for(let x=
0;x<B;x++){const y=l.uniqueValues[x];p.push({value:y,count:l.valueFrequency[x],label:y.toString()})}return{uniqueValues:p}};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/projectionSupport":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),function(b,
n,e,H,u,K,E){function h(x,y){if(!y)return null;if("x"in y){var G={x:0,y:0};[G.x,G.y]=x(y.x,y.y,r);null!=y.z&&(G.z=y.z);null!=y.m&&(G.m=y.m);return G}return"xmin"in y?(G={xmin:0,ymin:0,xmax:0,ymax:0},[G.xmin,G.ymin]=x(y.xmin,y.ymin,r),[G.xmax,G.ymax]=x(y.xmax,y.ymax,r),y.hasZ&&(G.zmin=y.zmin,G.zmax=y.zmax,G.hasZ=!0),y.hasM&&(G.mmin=y.mmin,G.mmax=y.mmax,G.hasM=!0),G):"rings"in y?{rings:t(y.rings,x),hasM:y.hasM,hasZ:y.hasZ}:"paths"in y?{paths:t(y.paths,x),hasM:y.hasM,hasZ:y.hasZ}:"points"in y?{points:d(y.points,
x),hasM:y.hasM,hasZ:y.hasZ}:null}function t(x,y){const G=[];for(const P of x)G.push(d(P,y));return G}function d(x,y){const G=[];for(const P of x)x=y(P[0],P[1],[0,0]),G.push(x),2<P.length&&x.push(P[2]),3<P.length&&x.push(P[3]);return G}function k(){k=n._asyncToGenerator(function*(x,y){x&&y&&(x=Array.isArray(x)?x.map(G=>e.isSome(G.geometry)?G.geometry.spatialReference:null).filter(e.isSome):[x],yield H.initializeProjection(x.map(G=>({source:G,dest:y}))))});return k.apply(this,arguments)}const r=[0,
0],l=h.bind(null,E.lngLatToXY),p=h.bind(null,E.xyToLngLat),B=new (function(){function x(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}var y=x.prototype;y.push=function(){var G=n._asyncToGenerator(function*(P,O,L){if(!(P&&P.length&&O&&L)||K.equals(O,L))return P;const g={geometries:P,inSpatialReference:O,outSpatialReference:L,resolve:null};this._jobs.push(g);return new Promise(c=>{g.resolve=c;null===this._timer&&(this._timer=setTimeout(this._process,10))})});return function(P,
O,L){return G.apply(this,arguments)}}();y._process=function(){this._timer=null;const G=this._jobs.shift();if(G){var {geometries:P,inSpatialReference:O,outSpatialReference:L,resolve:g}=G;E.canProject(O,L)?K.isWebMercator(L)?g(P.map(l)):g(P.map(p)):g(H.projectMany(u.jsonAdapter,P,O,L,null,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return x}());b.checkProjectionSupport=function(x,y){return k.apply(this,arguments)};b.project=function(x,y,G,P){if(!x)return x;G||(G=y,y=x.spatialReference);
return K.isValid(y)&&K.isValid(G)&&!K.equals(y,G)?E.canProject(y,G)?(x=K.isWebMercator(G)?l(x):p(x),x.spatialReference=G,x):H.projectMany(u.jsonAdapter,[x],y,G,null,P)[0]:x};b.projectMany=function(x,y,G){return B.push(x,y,G)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/geometryAdapters/json":function(){define(["exports"],function(b){let n=function(E,h,t){this.x=E;this.y=h;this.spatialReference=t;this.m=this.z=void 0},e=function(E,h,t,d){this.rings=E;this.spatialReference=
h;this.hasM=this.hasZ=void 0;t&&(this.hasZ=t);d&&(this.hasM=d)},H=function(E,h,t,d){this.paths=E;this.spatialReference=h;this.hasM=this.hasZ=void 0;t&&(this.hasZ=t);d&&(this.hasM=d)},u=function(E,h,t,d){this.points=E;this.spatialReference=h;this.hasM=this.hasZ=void 0;t&&(this.hasZ=t);d&&(this.hasM=d)},K=function(E,h,t,d,k){this.xmin=E;this.ymin=h;this.xmax=t;this.ymax=d;this.spatialReference=k;this.mmax=this.mmin=this.zmax=this.zmin=void 0};b.jsonAdapter={convertToGEGeometry:function(E,h){return null==
h?null:E.convertJSONToGeometry(h)},exportPoint:function(E,h,t){t=new n(E.getPointX(h),E.getPointY(h),t);const d=E.hasZ(h),k=E.hasM(h);d&&(t.z=E.getPointZ(h));k&&(t.m=E.getPointM(h));return t},exportPolygon:function(E,h,t){return new e(E.exportPaths(h),t,E.hasZ(h),E.hasM(h))},exportPolyline:function(E,h,t){return new H(E.exportPaths(h),t,E.hasZ(h),E.hasM(h))},exportMultipoint:function(E,h,t){return new u(E.exportPoints(h),t,E.hasZ(h),E.hasM(h))},exportExtent:function(E,h,t){var d=E.hasZ(h);const k=
E.hasM(h);t=new K(E.getXMin(h),E.getYMin(h),E.getXMax(h),E.getYMax(h),t);d&&(d=E.getZExtent(h),t.zmin=d.vmin,t.zmax=d.vmax);k&&(E=E.getMExtent(h),t.mmin=E.vmin,t.mmax=E.vmax);return t}};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/SnappingCandidate":function(){define(["exports"],function(b){b.makeEdgeCandidate=function(n,e,H,u,K,E=!1){return{objectId:n,target:e,distance:H,type:"edge",start:u,end:K,draped:E}};b.makeVertexCandidate=function(n,e,H){return{objectId:n,
target:e,distance:H,type:"vertex"}};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/utils":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/jsonMap ../../../core/maybe ../../../core/unitUtils ../../../geometry/projection ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ../OptimizedGeometry ./projectionSupport".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k,r,l,p){function B(){B=e._asyncToGenerator(function*(J,z,N){const {outFields:F,orderByFields:R,groupByFieldsForStatistics:m,outStatistics:C}=J;if(F)for(var M=0;M<F.length;M++)F[M]=F[M].trim();if(R)for(M=0;M<R.length;M++)R[M]=R[M].trim();if(m)for(M=0;M<m.length;M++)m[M]=m[M].trim();if(C)for(M=0;M<C.length;M++)C[M].onStatisticField&&(C[M].onStatisticField=C[M].onStatisticField.trim());J.geometry&&!J.outSR&&(J.outSR=J.geometry.spatialReference);return x(J,z,N)});return B.apply(this,
arguments)}function x(J,z,N){return y.apply(this,arguments)}function y(){y=e._asyncToGenerator(function*(J,z,N){if(!J)return null;var {where:F}=J;J.where=F=F&&F.trim();if(!F||/^1 *= *1$/.test(F)||z&&z===F)J.where=null;if(!J.geometry)return J;z=yield P(J);J.distance=0;J.units=null;"esriSpatialRelEnvelopeIntersects"===J.spatialRel&&({spatialReference:F}=J.geometry,z=h.getGeometryExtent(z),z.spatialReference=F);if(z){yield p.checkProjectionSupport(z.spatialReference,N);F=z.spatialReference;z=G(z,N)&&
t.isExtent(z)?{spatialReference:F,rings:[[[z.xmin,z.ymin],[z.xmin,z.ymax],[z.xmax,z.ymax],[z.xmax,z.ymin],[z.xmin,z.ymin]]]}:z;F=(yield d.normalizeCentralMeridian(t.fromJSON(z)))[0];if(u.isNone(F))throw a;const R="quantizationParameters"in J&&J.quantizationParameters?.tolerance||"maxAllowableOffset"in J&&J.maxAllowableOffset||0;z=R&&G(z,N)?{densificationStep:8*R}:void 0;F=F.toJSON();z=yield p.project(F,F.spatialReference,N,z);if(!z)throw a;z.spatialReference=N;J.geometry=z}return J});return y.apply(this,
arguments)}function G(J,z){if(!J)return!1;const N=J.spatialReference;return(t.isExtent(J)||t.isPolygon(J)||t.isPolyline(J))&&!k.equals(N,z)&&!E.canProjectWithoutEngine(N,z)}function P(J){return O.apply(this,arguments)}function O(){O=e._asyncToGenerator(function*(J){const {distance:z,units:N}=J,F=J.geometry;if(null==z||"vertexAttributes"in F)return F;var R=F.spatialReference;J=N?c.fromJSON(N):K.getUnitString(R);R=R&&(k.isGeographic(R)||k.isWebMercator(R))?F:yield p.checkProjectionSupport(R,k.WGS84).then(()=>
p.project(F,k.WGS84));return(yield L())(R.spatialReference,R,z,J)});return O.apply(this,arguments)}function L(){return g.apply(this,arguments)}function g(){g=e._asyncToGenerator(function*(){return(yield new Promise((J,z)=>b(["../../../geometry/geometryEngineJSON"],J,z))).geodesicBuffer});return g.apply(this,arguments)}const c=new H.JSONMap({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),
a=Object.freeze({}),v=new l,Q=new l,D=new l,f={esriGeometryPoint:r.convertToPoint,esriGeometryPolyline:r.convertToPolyline,esriGeometryPolygon:r.convertToPolygon,esriGeometryMultipoint:r.convertToMultipoint},A=(J,z)=>"_geVersion"!==J?z:void 0;n.QUERY_ENGINE_EMPTY_RESULT=a;n.cleanFromGeometryEngine=function(J){return J&&"_geVersion"in J?JSON.parse(JSON.stringify(J,A)):J};n.getGeometry=function(J,z,N,F,R,m,C=z,M=N){const w=z&&C,U=N&&M;F=u.isSome(F)?"coords"in F?F:F.geometry:null;if(u.isNone(F))return null;
if(R)return z=r.generalizeOptimizedGeometry(Q,F,z,N,J,R,C,M),m&&(z=r.quantizeOptimizedGeometry(D,z,w,U,J,m)),f[J]?.(z,w,U)??null;if(m)return m=r.quantizeOptimizedGeometry(D,F,z,N,J,m,C,M),f[J]?.(m,w,U)??null;r.removeZMValues(v,F,z,N,C,M);return f[J]?.(v,w,U)??null};n.normalizeQuery=function(J,z,N){return B.apply(this,arguments)};n.normalizeQueryLike=x;n.transformCentroid=function(J,z,N,F=J.hasZ,R=J.hasM){if(u.isNone(z))return null;const m=J.hasZ&&F,C=J.hasM&&R;return N?(J=r.quantizeOptimizedGeometry(D,
z,J.hasZ,J.hasM,"esriGeometryPoint",N,F,R),r.convertToPoint(J,m,C)):r.convertToPoint(z,m,C)};Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingConstraint":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../chunks/vec3 ../../../chunks/vec3f64 ./SnappingPoint ../../support/geometry3dUtils ../../support/geometry2dUtils".split(" "),function(b,n,e,H,u,K,E,h,
t,d){function k(N,F){let R=[];if(p(N)){var {point:m}=N;B(F)?R=t.intersectLineAndPoint(F.lineLike,m):x(F)?R=t.intersectVerticalCylinderAndPoint(F.center,F.radius,m):y(F)?R=t.intersectVerticalPlaneAndPoint(F.planeLike,m):G(F)&&(R=r(F,N))}else if(B(N))({lineLike:m}=N),p(F)?R=t.intersectLineAndPoint(m,F.point):B(F)?R=t.intersectLineLike(m,F.lineLike):x(F)?R=t.intersectLineLikeAndVerticalCylinder(m,F.center,F.radius):y(F)?R=t.intersectVerticalPlaneAndLineLike(F.planeLike,m):G(F)&&(R=r(F,N));else if(x(N)){const {center:C,
radius:M}=N;if(B(F))R=t.intersectLineLikeAndVerticalCylinder(F.lineLike,C,M);else if(p(F))R=t.intersectVerticalCylinderAndPoint(C,M,F.point);else{if(y(F))return t.intersectVerticalPlaneAndVerticalCylinder(F.planeLike,C,M).map(w=>new a(w,N,F));G(F)&&(R=r(F,N))}}else if(y(N)){({planeLike:m}=N);if(y(F))return t.intersectVerticalPlane(m,F.planeLike).map(C=>new a(C,N,F));if(p(F))R=t.intersectVerticalPlaneAndPoint(m,F.point);else if(B(F))R=t.intersectVerticalPlaneAndLineLike(m,F.lineLike);else{if(x(F))return t.intersectVerticalPlaneAndVerticalCylinder(m,
F.center,F.radius).map(C=>new a(C,N,F));G(F)&&(R=r(F,N))}}else G(N)&&(R=r(N,F));return l(R,N,F)}function r(N,F){const {planeLike:R,getZ:m}=N,C=[];if(p(F))N.addIfOnTheGround(C,t.intersectVerticalPlaneAndPoint(R,F.point));else if(B(F))N.addIfOnTheGround(C,t.intersectVerticalPlaneAndLineLike(R,F.lineLike));else if(x(F))for(const [M,w]of t.intersectVerticalPlaneAndVerticalCylinder(R,F.center,F.radius))N=m(M,w,0),e.isSome(N)&&C.push(E.fromValues(M,w,N));else if(y(F)||G(F))for(const [M,w]of t.intersectVerticalPlane(R,
F.planeLike))N=e.toNullable(m(M,w,0))??0,C.push(E.fromValues(M,w,N));return C}function l(N,F,R){return N.map(m=>new c(h.asSnappingPoint(m),F,R))}function p(N){return N instanceof O}function B(N){return N instanceof L}function x(N){return N instanceof v}function y(N){return N instanceof Q}function G(N){return N instanceof A}let P=function(){function N(){}N.prototype.intersect=function(F){return k(this,F)};return N}(),O=function(N){function F(m){var C=N.call(this)||this;C.point=m;return C}n._inheritsLoose(F,
N);var R=F.prototype;R.equals=function(m){return p(m)&&K.exactEquals(this.point,m.point)};R.closestTo=function(){return h.cloneSnappingPoint(this.point)};return F}(P),L=function(N){function F(m,C,M){var w=N.call(this)||this;w.start=m;w.end=C;w.type=M;w.lineLike={start:w.start,end:w.end,type:w.type};return w}n._inheritsLoose(F,N);var R=F.prototype;R.equals=function(m){return B(m)&&this.type===m.type&&K.exactEquals(this.start,m.start)&&K.exactEquals(this.end,m.end)};R.closestTo=function(m){m=t.projectPointToLineLike(m,
this.lineLike);return h.asSnappingPoint(m)};return F}(P),g=function(N){function F(R,m){return N.call(this,R,m,d.LineType.LINE)||this}n._inheritsLoose(F,N);return F}(L),c=function(N){function F(m,C,M){var w=N.call(this)||this;w.intersection=m;w.first=C;w.second=M;return w}n._inheritsLoose(F,N);var R=F.prototype;R.equals=function(m){return m instanceof F&&this.first.equals(m.first)&&this.second.equals(m.second)};R.closestTo=function(){return h.cloneSnappingPoint(this.intersection)};return F}(P),a=function(N){function F(m,
C,M){var w=N.call(this)||this;w.basePoint=m;w.first=C;w.second=M;return w}n._inheritsLoose(F,N);var R=F.prototype;R.equals=function(m){return m instanceof F&&this.first.equals(m.first)&&this.second.equals(m.second)};R.closestTo=function(m){const C=this.basePoint;return h.asSnappingPoint(E.fromValues(C[0],C[1],m[2]))};return F}(P),v=function(N){function F(m,C){var M=N.call(this)||this;M.center=m;M.radius=C;return M}n._inheritsLoose(F,N);var R=F.prototype;R.equals=function(m){return x(m)&&this.center[0]===
m.center[0]&&this.center[1]===m.center[1]&&this.radius===m.radius};R.closestTo=function(m){m=t.projectPointToVerticalCylinder(m,this.center,this.radius);return h.asSnappingPoint(m)};return F}(P),Q=function(N){function F(m,C,M){var w=N.call(this)||this;w.start=m;w.end=C;w.type=M;w.planeLike={start:m,end:C,type:M};return w}n._inheritsLoose(F,N);var R=F.prototype;R.equals=function(m){return y(m)&&this.type===m.type&&K.exactEquals(this.start,m.start)&&K.exactEquals(this.end,m.end)};R.closestTo=function(m){return h.asSnappingPoint(t.projectPointToVerticalPlane(m,
this.planeLike))};R.closestEndTo=function(m){const {start:C,end:M}=this;return 0<Math.sign(H.dot(H.subtract(J,M,C),H.subtract(z,m,C)))?M:C};return F}(P),D=function(N){function F(R,m){return N.call(this,R,m,t.VerticalPlaneType.HALF_PLANE)||this}n._inheritsLoose(F,N);return F}(Q),f=function(N){function F(R,m){return N.call(this,R,m,t.VerticalPlaneType.PLANE)||this}n._inheritsLoose(F,N);return F}(Q),A=function(N){function F(m,C,M){var w=N.call(this)||this;w.start=m;w.end=C;w.getZ=M;w.planeLike={start:m,
end:C,type:t.VerticalPlaneType.HALF_PLANE};return w}n._inheritsLoose(F,N);var R=F.prototype;R.equals=function(m){return G(m)&&K.exactEquals(this.start,m.start)&&K.exactEquals(this.end,m.end)&&this.getZ===m.getZ};R.closestTo=function(m){const C=t.projectPointToVerticalPlane(m,this.planeLike);C[2]=e.toNullable(this.getZ(m[0],m[1],m[2]))??0;return h.asSnappingPoint(C)};R.addIfOnTheGround=function(m,C){for(const M of C)C=e.unwrapOr(this.getZ(M[0],M[1],M[2]),0),Math.abs(M[2]-C)<t.epsilon&&(M[2]=C,m.push(M))};
return F}(P);const J=u.create(),z=u.create();b.DrapedLineConstraint=A;b.IntersectionConstraint=c;b.LineConstraint=g;b.LineLikeConstraint=L;b.PointConstraint=O;b.SnappingConstraint=P;b.VerticalCylinderConstraint=v;b.VerticalHalfPlaneConstraint=D;b.VerticalLineIntersectionConstraint=a;b.VerticalPlaneConstraint=f;b.VerticalPlaneLikeConstraint=Q;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/vec2f64":function(){define(["exports"],function(b){function n(){return[0,0]}function e(x){return[x[0],
x[1]]}function H(x,y){return[x,y]}function u(x){const y=[0,0],G=Math.min(2,x.length);for(let P=0;P<G;++P)y[P]=x[P];return y}function K(x,y){return new Float64Array(x,y,2)}function E(){return[0,0]}function h(){return[1,1]}function t(){return[1,0]}function d(){return[0,1]}const k=[0,0],r=[1,1],l=[1,0],p=[0,1],B=Object.freeze(Object.defineProperty({__proto__:null,ONES:r,UNIT_X:l,UNIT_Y:p,ZEROS:k,clone:e,create:n,createView:K,fromArray:u,fromValues:H,ones:h,unitX:t,unitY:d,zeros:E},Symbol.toStringTag,
{value:"Module"}));b.ONES=r;b.UNIT_X=l;b.UNIT_Y=p;b.ZEROS=k;b.clone=e;b.create=n;b.createView=K;b.fromArray=u;b.fromValues=H;b.ones=h;b.unitX=t;b.unitY=d;b.vec2f64=B;b.zeros=E})},"esri/views/interactive/snapping/SnappingPoint":function(){define(["exports","../../../core/maybe","../../../chunks/vec3f64","../../../layers/graphics/dehydratedFeatures","../../../support/elevationInfoUtils"],function(b,n,e,H,u){function K(h,t,d){if(n.isNone(h))return null;if(n.isNone(t))return e.fromValues(h.x,h.y,h.z??
0);if("2d"===t.type)return e.fromValues(h.x,h.y,0);({elevationInfo:d}=d);t=u.getConvertedElevation(t,h,d,u.absoluteHeightElevationInfo)??0;return e.fromValues(h.x,h.y,t)}const E=H.makeDehydratedPoint(0,0,0,null);b.anyMapPointToSnappingPoint=function(h,t,d){return n.isNone(h)?null:K(d.coordinateHelper.vectorToDehydratedPoint(h,E),t,d)};b.asSnappingPoint=function(h){return h};b.cloneSnappingPoint=function(h){return e.clone(h)};b.createSnappingPoint=function(h,t,d){return e.fromValues(h,t,d)};b.pointToSnappingPoint=
K;b.snappingPointToDehydratedPoint=function(h,t){return H.makeDehydratedPoint(h[0],h[1],h[2],t)};b.snappingPointToSnappingOutput=function(h,t,{z:d,m:k,spatialReference:r,elevationInfo:l}){if(null==d&&null==k)return h=H.makeDehydratedPoint(h[0],h[1],void 0,r),null!=k&&(h.m=k,h.hasM=!0),h;if(n.isNone(t)||"2d"===t.type)return h=H.makeDehydratedPoint(h[0],h[1],d,r),null!=k&&(h.m=k,h.hasM=!0),h;t=u.getConvertedElevationFromVector(t,h,r,u.absoluteHeightElevationInfo,l)??0;h=H.makeDehydratedPoint(h[0],h[1],
t,r);null!=k&&(h.m=k,h.hasM=!0);return h};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/dehydratedFeatures":function(){define("exports ../../core/byteSizeEstimations ../../core/has ../../core/maybe ../../core/typedArrayUtil ../../core/uid ../../geometry/SpatialReference ../../geometry/support/aaBoundingBox ../../geometry/support/aaBoundingRect ../../geometry/support/quantizationUtils ../../geometry/support/typeUtils ../support/Field ./dehydratedFeatureComparison".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k,r,l){function p(x,y,G){if(H.isNone(x))return null;switch(y){case "point":return{x:x.x,y:x.y,z:x.z,m:x.m,hasZ:null!=x.z,hasM:null!=x.m,type:"point",spatialReference:G};case "polyline":return{paths:x.paths,hasZ:!!x.hasZ,hasM:!!x.hasM,type:"polyline",spatialReference:G};case "polygon":return{rings:x.rings,hasZ:!!x.hasZ,hasM:!!x.hasM,type:"polygon",spatialReference:G};case "multipoint":return{points:x.points,hasZ:!!x.hasZ,hasM:!!x.hasM,type:"multipoint",spatialReference:G}}}
function B(x){if(H.isNone(x))return 0;let y=32;switch(x.type){case "point":y+=42;break;case "polyline":case "polygon":var G=0;const P=2+(x.hasZ?1:0)+(x.hasM?1:0);x="polyline"===x.type?x.paths:x.rings;for(const O of x)G+=O.length;y+=8*G*P+64;y+=128*G;y=y+34+32*(x.length+1);break;case "multipoint":G=x.points.length;y+=8*G*(2+(x.hasZ?1:0)+(x.hasM?1:0))+64;y+=128*G;y=y+34+32;break;case "extent":y+=98;x.hasM&&(y+=32);x.hasZ&&(y+=32);break;case "mesh":y+=u.estimateSize(x.vertexAttributes.position),y+=u.estimateSize(x.vertexAttributes.normal),
y+=u.estimateSize(x.vertexAttributes.uv),y+=u.estimateSize(x.vertexAttributes.tangent)}return y}b.equals=l.equals;b.DehydratedFeatureClass=function(x,y,G){this.uid=x;this.geometry=y;this.attributes=G;this.visible=!0;this.centroid=this.objectId=null};b.DehydratedFeatureSetClass=function(){this.exceededTransferLimit=!1;this.features=[];this.fields=[];this.hasZ=this.hasM=!1;this.transform=this.spatialReference=this.geohashFieldName=this.geometryProperties=this.globalIdFieldName=this.objectIdFieldName=
this.geometryType=null};b.computeAABB=function(x,y){h.empty(y);"mesh"===x.type&&(x=x.extent);switch(x.type){case "point":y[0]=y[3]=x.x;y[1]=y[4]=x.y;x.hasZ&&(y[2]=y[5]=x.z);break;case "polyline":for(var G=0;G<x.paths.length;G++)h.expandWithNestedArray(y,x.paths[G],!!x.hasZ);break;case "polygon":for(G=0;G<x.rings.length;G++)h.expandWithNestedArray(y,x.rings[G],!!x.hasZ);break;case "multipoint":h.expandWithNestedArray(y,x.points,!!x.hasZ);break;case "extent":y[0]=x.xmin,y[1]=x.ymin,y[3]=x.xmax,y[4]=
x.ymax,null!=x.zmin&&(y[2]=x.zmin),null!=x.zmax&&(y[5]=x.zmax)}};b.computeAABR=function(x,y){t.empty(y);"mesh"===x.type&&(x=x.extent);switch(x.type){case "point":y[0]=y[2]=x.x;y[1]=y[3]=x.y;break;case "polyline":for(var G=0;G<x.paths.length;G++)t.expandWithNestedArray(y,x.paths[G]);break;case "polygon":for(G=0;G<x.rings.length;G++)t.expandWithNestedArray(y,x.rings[G]);break;case "multipoint":t.expandWithNestedArray(y,x.points);break;case "extent":y[0]=x.xmin,y[1]=x.ymin,y[2]=x.xmax,y[3]=x.ymax}};
b.estimateGeometryObjectSize=B;b.estimateSize=function(x){let y;y=32+n.estimateAttributesObjectSize(x.attributes);return y=y+3+(8+B(x.geometry))};b.fromFeatureSetJSON=function(x){const y=k.featureGeometryTypeKebabDictionary.fromJSON(x.geometryType),G=E.fromJSON(x.spatialReference),P=x.transform,O=x.features.map(L=>{var g=x.objectIdFieldName;L={uid:K.generateUID(),objectId:g&&L.attributes?L.attributes[g]:null,attributes:L.attributes,geometry:p(L.geometry,y,G),visible:!0};g=L.geometry;if(H.isSome(g)&&
P)switch(g.type){case "point":L.geometry=d.unquantizePoint(P,g,g,g.hasZ,g.hasM);break;case "multipoint":L.geometry=d.unquantizeMultipoint(P,g,g,!!g.hasZ,!!g.hasM);break;case "polygon":L.geometry=d.unquantizePolygon(P,g,g,!!g.hasZ,!!g.hasM);break;case "polyline":L.geometry=d.unquantizePolyline(P,g,g,!!g.hasZ,!!g.hasM);break;case "extent":L.geometry=g;break;case "mesh":L.geometry=g}return L});return{geometryType:y,features:O,spatialReference:G,fields:x.fields?.map(L=>r.fromJSON(L))??[],objectIdFieldName:x.objectIdFieldName,
globalIdFieldName:x.globalIdFieldName,geohashFieldName:x.geohashFieldName,geometryProperties:x.geometryProperties,hasZ:x.hasZ,hasM:x.hasM,exceededTransferLimit:x.exceededTransferLimit,transform:null}};b.fromJSONGeometry=p;b.getObjectId=function(x,y){return null!=x.objectId?x.objectId:x.attributes&&y?x.attributes[y]:null};b.hasGeometry=function(x){return H.isSome(x.geometry)};b.hasVertices=function(x){if(H.isNone(x))return!1;switch(x.type){case "extent":case "point":return!0;case "polyline":for(const y of x.paths)if(0<
y.length)return!0;return!1;case "polygon":for(const y of x.rings)if(0<y.length)return!0;return!1;case "multipoint":return 0<x.points.length;case "mesh":return!x.loaded||0<x.vertexAttributes.position.length}};b.makeDehydratedPoint=function(x,y,G,P){return{x,y,z:G,hasZ:null!=G,hasM:!1,spatialReference:P,type:"point"}};b.numVertices=function(x){if(H.isNone(x))return 0;switch(x.type){case "point":return 1;case "polyline":var y=0;for(var G of x.paths)y+=G.length;return y;case "polygon":G=0;for(y of x.rings)G+=
y.length;return G;case "multipoint":return x.points.length;case "extent":return 2;case "mesh":return(x=x.vertexAttributes&&x.vertexAttributes.position)?x.length/3:0}};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/dehydratedFeatureComparison":function(){define(["exports","../../core/has","../../core/maybe","../../geometry/support/spatialReferenceUtils"],function(b,n,e,H){function u(d,k){if(d===k)return!0;if(null==d||null==k||d.length!==k.length)return!1;for(let r=
0;r<d.length;r++){const l=d[r],p=k[r];if(l.length!==p.length)return!1;for(let B=0;B<l.length;B++)if(l[B]!==p[B])return!1}return!0}function K(d,k){if(d===k)return!0;if(null==d||null==k||d.length!==k.length)return!1;for(let r=0;r<d.length;r++)if(!u(d[r],k[r]))return!1;return!0}function E(d,k){return d===k||e.isSome(d)&&e.isSome(k)&&H.equals(d.spatialReference,k.spatialReference)&&d.x===k.x&&d.y===k.y&&d.z===k.z&&d.m===k.m}function h(d,k){if(d===k)return!0;if(e.isNone(d)||e.isNone(k)||d.type!==k.type)return!1;
switch(d.type){case "point":return E(d,k);case "extent":return d=d.hasZ!==k.hasZ||d.hasM!==k.hasM?!1:H.equals(d.spatialReference,k.spatialReference)?d.xmin===k.xmin&&d.ymin===k.ymin&&d.zmin===k.zmin&&d.xmax===k.xmax&&d.ymax===k.ymax&&d.zmax===k.zmax:!1,d;case "polyline":return d=d.hasZ!==k.hasZ||d.hasM!==k.hasM?!1:H.equals(d.spatialReference,k.spatialReference)?K(d.paths,k.paths):!1,d;case "polygon":return d=d.hasZ!==k.hasZ||d.hasM!==k.hasM?!1:H.equals(d.spatialReference,k.spatialReference)?K(d.rings,
k.rings):!1,d;case "multipoint":return d=d.hasZ!==k.hasZ||d.hasM!==k.hasM?!1:H.equals(d.spatialReference,k.spatialReference)?u(d.points,k.points):!1,d;case "mesh":return!1}}function t(d,k){if(d===k)return!0;if(!d||!k)return!1;const r=Object.keys(d),l=Object.keys(k);if(r.length!==l.length)return!1;for(const p of r)if(d[p]!==k[p])return!1;return!0}b.equals=function(d,k){return d===k?!0:null!=d&&null!=k&&d.objectId===k.objectId&&h(d.geometry,k.geometry)&&t(d.attributes,k.attributes)?!0:!1};b.pointEquals=
E;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/geometry3dUtils":function(){define("exports ../../core/mathUtils ../../chunks/vec2 ../../chunks/vec2f64 ../../chunks/vec3 ../../chunks/vec3f64 ./geometry2dUtils".split(" "),function(b,n,e,H,u,K,E){function h(c,{start:a,end:v,type:Q}){c=u.sub(p,c,a);v=u.sub(B,v,a);c=u.dot(c,v)/u.dot(v,v);return u.scaleAndAdd(K.create(),a,v,Q===E.LineType.RAY?Math.max(c,0):c)}function t({start:c,end:a,type:v},Q){const D=u.sub(p,Q,
c);a=u.sub(B,a,c);if(v===E.LineType.RAY&&-1E-6>u.dot(a,D))return u.distance(c,Q);c=u.cross(x,a,D);return u.len(c)/u.len(a)}function d(c,a){const v=c.start,Q=a.start;var D=a.end;const f=u.sub(p,c.end,v);D=u.sub(B,D,Q);var A=u.sub(x,Q,v),J=u.cross(y,f,D),z=u.dot(A,J);if(!n.floatEqualAbsolute(z,0,1E-6))return[];z=u.sqrLen(J);if(n.floatEqualAbsolute(z,0,1E-6))return[];A=u.cross(G,A,D);J=u.dot(A,J)/z;J=u.scaleAndAdd(P,v,f,J);return c.type===E.LineType.RAY&&(c=u.sub(O,J,v),-1E-6>u.dot(f,c))||a.type===E.LineType.RAY&&
(a=u.sub(O,J,Q),-1E-6>u.dot(D,a))?[]:[K.clone(J)]}function k({start:c,end:a,type:v},Q){const D=u.sub(p,Q,c);c=u.sub(B,a,c);a=u.cross(x,c,D);if(1E-6>u.sqrLen(a)/u.sqrLen(c))switch(v){case E.LineType.LINE:return[K.clone(Q)];case E.LineType.RAY:return-1E-6>u.dot(c,D)?[]:[K.clone(Q)]}return[]}function r(c,a,{start:v,end:Q,type:D}){u.set(c.start,v[0],v[1],a);u.set(c.end,Q[0],Q[1],a);c.type=l[D];return c}b.VerticalPlaneType=void 0;(function(c){c[c.PLANE=0]="PLANE";c[c.HALF_PLANE=1]="HALF_PLANE"})(b.VerticalPlaneType||
(b.VerticalPlaneType={}));const l={[b.VerticalPlaneType.PLANE]:E.LineType.LINE,[b.VerticalPlaneType.HALF_PLANE]:E.LineType.RAY},p=K.create(),B=K.create(),x=K.create(),y=K.create(),G=K.create(),P=K.create(),O=K.create(),L={start:K.create(),end:K.create(),type:E.LineType.LINE},g={start:K.create(),end:K.create(),type:E.LineType.LINE};Object.defineProperty(b,"LineType",{enumerable:!0,get:()=>E.LineType});b.epsilon=1E-6;b.intersectLineAndPoint=k;b.intersectLineLike=d;b.intersectLineLikeAndVerticalCylinder=
function({start:c,end:a,type:v},Q,D){const f=[];a=u.subtract(p,a,c);var A=e.subtract(B,c,Q);Q=e.squaredLength(a);const J=2*e.dot(a,A);D=e.squaredLength(A)-D*D;D=J*J-4*Q*D;0===D?(Q=-J/(2*Q),(v===E.LineType.LINE||0<=Q)&&f.push(u.scaleAndAdd(K.create(),c,a,Q))):0<D&&(D=Math.sqrt(D),A=(-J+D)/(2*Q),(v===E.LineType.LINE||0<=A)&&f.push(u.scaleAndAdd(K.create(),c,a,A)),Q=(-J-D)/(2*Q),(v===E.LineType.LINE||0<=Q)&&f.push(u.scaleAndAdd(K.create(),c,a,Q)));return f};b.intersectVerticalCylinderAndPoint=function(c,
a,v){return n.floatEqualAbsolute(e.squaredDistance(v,c),a*a,1E-6)?[K.clone(v)]:[]};b.intersectVerticalPlane=function(c,a){c=r(L,0,c);a=r(g,0,a);a=d(c,a);c=[];for(const v of a)c.push(H.clone(v));return c};b.intersectVerticalPlaneAndLineLike=function(c,a){const v=c.start,Q=e.subtract(p,c.end,v);var D=u.set(B,-Q[1],Q[0],0);const f=a.start,A=u.sub(x,a.end,f);var J=u.dot(A,D),z=u.set(y,v[0],v[1],0);z=u.sub(G,z,f);D=u.dot(z,D);if(1E-6>Math.abs(J))return[];J=u.scaleAndAdd(P,f,A,D/J);return a.type===E.LineType.RAY&&
(a=u.sub(O,J,f),-1E-6>u.dot(a,A))||c.type===b.VerticalPlaneType.HALF_PLANE&&(c=e.sub(O,J,v),-1E-6>e.dot(c,Q))?[]:[K.clone(J)]};b.intersectVerticalPlaneAndPoint=function(c,a){return k(r(L,a[2],c),a)};b.intersectVerticalPlaneAndVerticalCylinder=function({start:c,end:a,type:v},Q,D){const f=[];a=e.subtract(p,a,c);var A=e.subtract(B,c,Q);Q=e.squaredLength(a);const J=2*e.dot(a,A);D=e.squaredLength(A)-D*D;D=J*J-4*Q*D;0===D?(Q=-J/(2*Q),(v===b.VerticalPlaneType.PLANE||0<=Q)&&f.push(e.scaleAndAdd(H.create(),
c,a,Q))):0<D&&(D=Math.sqrt(D),A=(-J+D)/(2*Q),(v===b.VerticalPlaneType.PLANE||0<=A)&&f.push(e.scaleAndAdd(H.create(),c,a,A)),Q=(-J-D)/(2*Q),(v===b.VerticalPlaneType.PLANE||0<=Q)&&f.push(e.scaleAndAdd(H.create(),c,a,Q)));return f};b.pointToLineLikeDistance=t;b.pointToVerticalCylinderDistance=function(c,a,v){return e.distance(c,a)-v};b.pointToVerticalPlaneDistance=function(c,a){return t(r(L,c[2],a),c)};b.projectPointToLineLike=h;b.projectPointToVerticalCylinder=function(c,a,v){const Q=e.subtract(p,c,
a);v/=e.length(Q);a=e.scaleAndAdd(K.create(),a,Q,v);a[2]=c[2];return a};b.projectPointToVerticalPlane=function(c,a){return h(c,r(L,c[2],a))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/geometry2dUtils":function(){define(["exports","../../core/mathUtils","../../chunks/vec2","../../chunks/vec2f64"],function(b,n,e,H){function u(l,p){return l[0]*p[1]-l[1]*p[0]}function K(l,p,B){p=e.dot(B,p)/e.squaredLength(B);return e.scale(l,B,p)}function E(l,p,B,x,y=B){e.subtract(t,
x,B);e.subtract(k,p,y);K(r,k,t);return e.add(l,y,r)}function h(l,p,B,x){e.subtract(t,p,B);p=x/e.length(t);return e.scaleAndAdd(l,B,t,p)}b.LineType=void 0;(function(l){l[l.RAY=0]="RAY";l[l.LINE=1]="LINE"})(b.LineType||(b.LineType={}));const t=H.create(),d=H.create(),k=H.create(),r=H.create();b.cross=u;b.intersectCircleAndPoint=function(l,p,B){h(k,B,l,p);return n.floatEqualAbsolute(k[0],B[0])&&n.floatEqualAbsolute(k[1],B[1])?[H.clone(B)]:[]};b.intersectLineAndPoint=function(l,p){E(k,p,l.start,l.end);
return n.floatEqualAbsolute(k[0],p[0])&&n.floatEqualAbsolute(k[1],p[1])?[H.clone(p)]:[]};b.intersectLineAndRay=function(l,p){const B=l.start;var x=p.start,y=p.end;const G=e.subtract(t,l.end,B);var P=e.subtract(d,y,x);y=u(G,P);if(1E-6>=Math.abs(y))return[];x=e.subtract(k,B,x);P=u(P,x)/y;y=u(G,x)/y;if(0<=P){if(0<=y||p.type===b.LineType.LINE)return[e.scaleAndAdd(r,B,G,P)]}else if(l.type===b.LineType.LINE&&(0<=y||p.type===b.LineType.LINE))return[e.scaleAndAdd(r,B,G,P)];return[]};b.intersectLineLikeAndCircle=
function(l,p,B){const x=[],y=e.subtract(t,l.end,l.start);var G=e.subtract(d,l.start,p);p=e.squaredLength(y);const P=2*e.dot(y,G);B=e.squaredLength(G)-B*B;B=P*P-4*p*B;0===B?(p=-P/(2*p),(l.type===b.LineType.LINE||0<=p)&&x.push(e.scaleAndAdd(r,l.start,y,p))):0<B&&(B=Math.sqrt(B),G=(-P+B)/(2*p),(l.type===b.LineType.LINE||0<=G)&&x.push(e.scaleAndAdd(r,l.start,y,G)),p=(-P-B)/(2*p),(l.type===b.LineType.LINE||0<=p)&&x.push(e.scaleAndAdd(k,l.start,y,p)));return x};b.pointToLineDistance=function(l,p,B){return Math.abs((p[0]-
l[0])*(B[1]-l[1])-(p[1]-l[1])*(B[0]-l[0]))/e.distance(p,B)};b.projectPoint=K;b.projectPointToCircle=h;b.projectPointToLine=E;b.projectPointToRay=function(l,p,B,x){e.subtract(t,x,B);e.subtract(k,p,B);p=e.dot(t,k)/e.squaredLength(t);return 0<p?e.scaleAndAdd(l,B,t,p):e.copy(l,B)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/snappingUtils":function(){define("exports ../../../core/maybe ../../../core/reactiveUtils ../../../chunks/vec3 ../../../layers/graphics/dehydratedFeatures ../../input/InputManager ../keybindings ./SnappingPoint".split(" "),
function(b,n,e,H,u,K,E,h){function t(d,k){const r=d.x-k.x;d=d.y-k.y;return r*r+d*d}b.LineSegmentHintType=void 0;(function(d){d[d.TARGET=0]="TARGET";d[d.REFERENCE=1]="REFERENCE";d[d.REFERENCE_EXTENSION=2]="REFERENCE_EXTENSION"})(b.LineSegmentHintType||(b.LineSegmentHintType={}));b.editEdgeToSnappingEdge=function(d,k,r){return{left:h.anyMapPointToSnappingPoint(d.leftVertex.pos,k,r),right:h.anyMapPointToSnappingPoint(d.rightVertex.pos,k,r)}};b.makeFilter=function(d){return d.createQuery()};b.makeSnappingQuery=
function({point:d,distance:k,types:r,coordinateHelper:{spatialReference:l}},p,B){return{point:u.makeDehydratedPoint(d[0],d[1],d[2],l.toJSON()),mode:p,distance:k,types:r,query:n.isSome(B)?B.toJSON():{where:"1\x3d1"}}};b.objectEqual=function(d,k){const r=d.length===k.length&&d[0]===k[0]&&d[1]===k[1];switch(d.length){case 2:return r;case 3:return r&&d[2]===k[2];case 4:return r&&d[2]===k[2]&&d[3]===k[3]}return!1};b.screenDistance=function(d,k){return Math.sqrt(t(d,k))};b.setupSnappingToggleHandles=function(d,
k=()=>{}){const r=e.watch(()=>({view:d.view,snappingOptions:d.snappingOptions}),({view:l,snappingOptions:p})=>{const B=K.ViewEventPriorities.TOOL;d.removeHandles("snapping-toggle");l&&n.isSome(p)&&(l=[l.on("key-down",x=>{x.key!==E.SNAPPING_KEYS.toggle||x.repeat||(p.enabledToggled=!0,k())},B),l.on("key-up",x=>{x.key===E.SNAPPING_KEYS.toggle&&(p.enabledToggled=!1,k())},B),l.on("pointer-move",x=>{x=x.native.ctrlKey;p.enabledToggled!==x&&(p.enabledToggled=x,k())},B)],d.addHandles(l,"snapping-toggle"))},
e.syncAndInitial);d.addHandles(r)};b.sortCandidatesInPlace=function(d,k){k.sort((r,l)=>{r=H.squaredDistance(r.targetPoint,d);l=H.squaredDistance(l.targetPoint,d);return r-l})};b.squaredScreenDistance=t;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/DrapedEdgeSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../SnappingConstraint ../snappingUtils ./FeatureSnappingCandidate ../hints/LineSnappingHint".split(" "),
function(b,n,e,H,u,K){u=function(E){function h(t){return E.call(this,{...t,isDraped:!0,constraint:new e.DrapedLineConstraint(t.edgeStart,t.edgeEnd,t.getGroundElevation)})||this}n._inheritsLoose(h,E);n._createClass(h,[{key:"hints",get:function(){return[new K.LineSnappingHint(H.LineSegmentHintType.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}}]);return h}(u.FeatureSnappingCandidate);b.DrapedEdgeSnappingCandidate=u;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},
"esri/views/interactive/snapping/candidates/FeatureSnappingCandidate":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../SnappingDomain","./SnappingCandidate"],function(b,n,e,H){H=function(u){function K({targetPoint:E,objectId:h,constraint:t,isDraped:d}){E=u.call(this,E,t,d,e.SnappingDomain.FEATURE)||this;E.objectId=h;return E}n._inheritsLoose(K,u);return K}(H.SnappingCandidate);b.FeatureSnappingCandidate=H;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},
"esri/views/interactive/snapping/candidates/SnappingCandidate":function(){define(["exports"],function(b){b.SnappingCandidate=function(n,e,H,u){this.targetPoint=n;this.constraint=e;this.isDraped=H;this.domain=u};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/LineSnappingHint":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/Logger ../../../../chunks/vec3 ../SnappingDomain ./SnappingHint".split(" "),
function(b,n,e,H,u,K,E){e=function(h){function t(d,k,r,l,p=K.SnappingDomain.ALL,B=!0,x=!0){l=h.call(this,l,p)||this;l.type=d;l.lineStart=k;l.lineEnd=r;l.fadeLeft=B;l.fadeRight=x;return l}n._inheritsLoose(t,h);t.prototype.equals=function(d){return d instanceof t?this.type===d.type&&u.exactEquals(this.lineStart,d.lineStart)&&u.exactEquals(this.lineEnd,d.lineEnd)&&this.fadeLeft===d.fadeLeft&&this.fadeRight===d.fadeRight:!1};n._createClass(t,[{key:"length",get:function(){return u.distance(this.lineStart,
this.lineEnd)}}]);return t}(E.SnappingHint);b.LineSnappingHint=e;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/SnappingHint":function(){define(["exports"],function(b){b.SnappingHint=function(n,e){this.isDraped=n;this.domain=e};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/EdgeSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../SnappingConstraint ../snappingUtils ./FeatureSnappingCandidate ../hints/LineSnappingHint".split(" "),
function(b,n,e,H,u,K){u=function(E){function h(t){return E.call(this,{...t,constraint:new e.LineConstraint(t.edgeStart,t.edgeEnd)})||this}n._inheritsLoose(h,E);n._createClass(h,[{key:"hints",get:function(){return[new K.LineSnappingHint(H.LineSegmentHintType.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}}]);return h}(u.FeatureSnappingCandidate);b.EdgeSnappingCandidate=u;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/RightAngleSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../SnappingDomain ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint ../hints/RightAngleSnappingHint".split(" "),
function(b,n,e,H,u,K,E){u=function(h){function t({targetPoint:d,constraint:k,previousVertex:r,otherVertex:l,otherVertexType:p,objectId:B,isDraped:x}){d=h.call(this,d,k,x,e.SnappingDomain.SELF)||this;d.previousVertex=r;d.otherVertex=l;d.otherVertexType=p;d.objectId=B;return d}n._inheritsLoose(t,h);n._createClass(t,[{key:"hints",get:function(){const d=this.previousVertex,k=this.otherVertexType===b.OtherVertexType.CENTER?this.otherVertex:this.targetPoint,r=this.otherVertexType===b.OtherVertexType.CENTER?
this.targetPoint:this.otherVertex;return[new K.LineSnappingHint(H.LineSegmentHintType.TARGET,k,r,this.isDraped,this.domain),new K.LineSnappingHint(H.LineSegmentHintType.REFERENCE,d,k,this.isDraped,this.domain),new E.RightAngleSnappingHint(this.previousVertex,k,r,this.isDraped,this.domain)]}}]);return t}(u.SnappingCandidate);b.OtherVertexType=void 0;(function(h){h[h.NEXT=0]="NEXT";h[h.CENTER=1]="CENTER"})(b.OtherVertexType||(b.OtherVertexType={}));b.RightAngleSnappingCandidate=u;Object.defineProperty(b,
Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/RightAngleSnappingHint":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/Logger ../../../../chunks/vec3 ../SnappingDomain ./SnappingHint".split(" "),function(b,n,e,H,u,K,E){e=function(h){function t(d,k,r,l,p=K.SnappingDomain.ALL){l=h.call(this,l,p)||this;l.previousVertex=d;l.centerVertex=k;l.nextVertex=r;return l}n._inheritsLoose(t,h);t.prototype.equals=function(d){return d instanceof
t?u.exactEquals(this.previousVertex,d.previousVertex)&&u.exactEquals(this.centerVertex,d.centerVertex)&&u.exactEquals(this.nextVertex,d.nextVertex):!1};return t}(E.SnappingHint);b.RightAngleSnappingHint=e;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/support/viewUtils":function(){define("exports ../../../core/screenUtils ../../../chunks/vec2 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../layers/graphics/dehydratedFeatures ../../../support/elevationInfoUtils".split(" "),
function(b,n,e,H,u,K,E){function h(x,y,G,P,O=u.create()){x=y.toXYZ(x);x[2]=E.getConvertedElevationFromVector(P,x,y.spatialReference,G)||0;P.renderCoordsHelper.toRenderCoords(x,y.spatialReference,O);return O}function t(x,y,G,P,O=u.create()){x=H.copy(r,x);x[2]=E.getConvertedElevationFromVector(P,x,y,G)||0;P.renderCoordsHelper.toRenderCoords(x,y,O);return O}function d(x,y,G,P){if("2d"===P.type)return k.x=x[0],k.y=x[1],k.spatialReference=y,P.toScreen(k);t(x,y,G,P,r);P.state.camera.projectToScreen(r,B);
return n.createScreenPoint(B[0],B[1])}const k=K.makeDehydratedPoint(0,0,0,null),r=u.create(),l=n.createRenderScreenPointArray3(),p=n.createRenderScreenPointArray3(),B=n.createScreenPointArray();b.anyMapPointToRender=h;b.anyMapPointToScreenPoint=function(x,y,G,P){return d(y.toXYZ(x),y.spatialReference,G,P)};b.anyMapPointsToRenderWithEqualRelativeZ=function(x,y,G,P,O,L,g){if("absolute-height"===P.mode)h(x,G,P,O,L),h(y,G,P,O,g);else{x=G.toXYZ(x);y=G.toXYZ(y);var c=E.getConvertedElevationFromVector(O,
x,G.spatialReference,P);P=E.getConvertedElevationFromVector(O,y,G.spatialReference,P);P=(null==c?P:null==P?c:Math.min(c,P))||0;x[2]=P;y[2]=P;O.renderCoordsHelper.toRenderCoords(x,G.spatialReference,L);O.renderCoordsHelper.toRenderCoords(y,G.spatialReference,g)}};b.renderScreenSpaceTangent=function(x,y,G,P){G.projectToRenderScreen(x,l);G.projectToRenderScreen(y,p);e.subtract(P,p,l);e.normalize(P,P)};b.vectorToRender=t;b.vectorToScreenPoint=d;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},
"esri/views/interactive/snapping/SelfSnappingEngine":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ./LineSnapper ./ParallelLineSnapper ./RightAngleSnapper ./RightAngleTriangleSnapper ./SnappingDomain ./snappingUtils".split(" "),function(b,
n,e,H,u,K,E,h,t,d,k,r,l,p,B){b.SelfSnappingEngine=function(x){function y(P){P=x.call(this,P)||this;P.updating=!1;P._snappers=new u;P._domain=p.SnappingDomain.SELF;return P}n._inheritsLoose(y,x);var G=y.prototype;G.initialize=function(){this._snappers.push(new k.ParallelLineSnapper(this.view,this.options),new d.LineSnapper(this.view,this.options),new r.RightAngleSnapper(this.view,this.options),new l.RightAngleTriangleSnapper(this.view,this.options))};G.fetchCandidates=function(){var P=n._asyncToGenerator(function*(O,
L,g){if(!(L&this._domain&&this.options.effectiveSelfEnabled))return[];L=[];for(const c of this._snappers.items)for(const a of c.snap(O,g))L.push(a);B.sortCandidatesInPlace(O,L);return L});return function(O,L,g){return P.apply(this,arguments)}}();n._createClass(y,[{key:"options",set:function(P){this._set("options",P);for(const O of this._snappers)O.options=P}}]);return y}(H);e.__decorate([K.property({readOnly:!0})],b.SelfSnappingEngine.prototype,"updating",void 0);e.__decorate([K.property({constructOnly:!0})],
b.SelfSnappingEngine.prototype,"view",void 0);e.__decorate([K.property()],b.SelfSnappingEngine.prototype,"options",null);b.SelfSnappingEngine=e.__decorate([t.subclass("esri.views.interactive.snapping.SelfSnappingEngine")],b.SelfSnappingEngine);Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/LineSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../support/elevationInfoUtils ./SnappingAlgorithm ./SnappingPoint ./snappingUtils ./candidates/LineSnappingCandidate ../support/viewUtils ../../support/geometry3dUtils ../../support/geometry2dUtils".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k){u=function(r){function l(){return r.apply(this,arguments)||this}n._inheritsLoose(l,r);var p=l.prototype;p.snapNewVertex=function(B,x){var y=x.editGeometryOperations.data.components[0],G=y.edges.length;const P=[];if(1>G)return P;var {spatialReference:O}=x;O=t.vectorToScreenPoint(B,O,H.absoluteHeightElevationInfo,this.view);const {view:L}=this;G=y=y.edges[G-1];do{if(this.edgeExceedsShortLineThreshold(G,x)){const g=E.editEdgeToSnappingEdge(G,L,x);this._processCandidateProposal(g.left,
g.right,B,O,x,P)}G=G.leftVertex.leftEdge}while(G&&G!==y);return P};p.snapExistingVertex=function(B,x){const y=[],G=e.unwrap(x.vertexHandle);var P=G.component;if(2>P.edges.length)return y;const {view:O}=this;var {spatialReference:L}=x;L=t.vectorToScreenPoint(B,L,H.absoluteHeightElevationInfo,O);var g=G.leftEdge,c=G.rightEdge;g&&c&&this.edgeExceedsShortLineThreshold(g,x)&&this.edgeExceedsShortLineThreshold(c,x)&&this._processCandidateProposal(K.anyMapPointToSnappingPoint(g.leftVertex.pos,O,x),K.anyMapPointToSnappingPoint(c.rightVertex.pos,
O,x),B,L,x,y);g=P=P.edges[0];do g!==G.leftEdge&&g!==G.rightEdge&&this.edgeExceedsShortLineThreshold(g,x)&&(c=E.editEdgeToSnappingEdge(g,O,x),this._processCandidateProposal(c.left,c.right,B,L,x,y)),g=g.rightVertex.rightEdge;while(g&&g!==P);return y};p._processCandidateProposal=function(B,x,y,G,P,O){const {spatialReference:L,pointer:g}=P;y=K.asSnappingPoint(d.projectPointToLineLike(y,{start:B,end:x,type:k.LineType.LINE}));E.squaredScreenDistance(G,t.vectorToScreenPoint(y,L,H.absoluteHeightElevationInfo,
this.view))<this.squaredProximityThreshold(g)&&O.push(new h.LineSnappingCandidate({lineStart:B,lineEnd:x,targetPoint:y,isDraped:"on-the-ground"===P.elevationInfo?.mode}))};return l}(u.SnappingAlgorithm);b.LineSnapper=u;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingAlgorithm":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec2 ../../../support/elevationInfoUtils ./Settings ./SnappingPoint ./snappingUtils ../support/viewUtils".split(" "),
function(b,n,e,H,u,K,E,h,t){let d=function(){function k(l,p){this.view=l;this.options=p;this.squaredShortLineThreshold=K.defaults.shortLineThreshold*K.defaults.shortLineThreshold}var r=k.prototype;r.snap=function(l,p){return e.isSome(p.vertexHandle)?"vertex"!==p.vertexHandle.type?[]:this.snapExistingVertex(l,p):this.snapNewVertex(l,p)};r.edgeExceedsShortLineThreshold=function(l,p){return this.exceedsShortLineThreshold(E.anyMapPointToSnappingPoint(l.leftVertex.pos,this.view,p),E.anyMapPointToSnappingPoint(l.rightVertex.pos,
this.view,p),p)};r.exceedsShortLineThreshold=function(l,p,{spatialReference:B}){return 0===this.squaredShortLineThreshold||h.squaredScreenDistance(t.vectorToScreenPoint(p,B,u.absoluteHeightElevationInfo,this.view),t.vectorToScreenPoint(l,B,u.absoluteHeightElevationInfo,this.view))>this.squaredShortLineThreshold};r.isVertical=function(l,p){return H.squaredDistance(l,p)<K.defaults.verticalLineThreshold};r.squaredProximityThreshold=function(l){return"touch"===l?this._squaredTouchProximityThreshold:this._squaredMouseProximityThreshold};
n._createClass(k,[{key:"_squaredMouseProximityThreshold",get:function(){return this.options.distance*this.options.distance}},{key:"_squaredTouchProximityThreshold",get:function(){const {distance:l,touchSensitivityMultiplier:p}=this.options,B=l*p;return B*B}}]);return k}();b.SnappingAlgorithm=d;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/LineSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../SnappingConstraint ../SnappingDomain ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint".split(" "),
function(b,n,e,H,u,K,E){K=function(h){function t({lineStart:d,lineEnd:k,targetPoint:r,isDraped:l}){r=h.call(this,r,new e.VerticalPlaneConstraint(d,k),l,H.SnappingDomain.SELF)||this;r._referenceLineHint=new E.LineSnappingHint(u.LineSegmentHintType.REFERENCE_EXTENSION,d,k,l,r.domain);return r}n._inheritsLoose(t,h);t.prototype._lineEndClosestToTarget=function(){return this.constraint.closestEndTo(this.targetPoint)};n._createClass(t,[{key:"hints",get:function(){return[this._referenceLineHint,new E.LineSnappingHint(u.LineSegmentHintType.TARGET,
this._lineEndClosestToTarget(),this.targetPoint,this.isDraped,this.domain)]}}]);return t}(K.SnappingCandidate);b.LineSnappingCandidate=K;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/ParallelLineSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../chunks/vec3f64 ../../../support/elevationInfoUtils ./Settings ./SnappingAlgorithm ./SnappingPoint ./snappingUtils ./candidates/ParallelLineSnappingCandidate ../support/viewUtils ../../support/geometry2dUtils".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k,r,l,p){t=function(x){function y(){return x.apply(this,arguments)||this}n._inheritsLoose(y,x);var G=y.prototype;G.snapNewVertex=function(P,O){var L=O.editGeometryOperations.data.components[0],g=L.edges.length,c=L.vertices.length;const a=[];if(2>g)return a;const {view:v}=this,Q=l.vectorToScreenPoint(P,O.spatialReference,E.absoluteHeightElevationInfo,v);c=d.anyMapPointToSnappingPoint(L.vertices[c-1].pos,v,O);const D=d.anyMapPointToSnappingPoint(L.vertices[0].pos,v,O);g=
L=L.edges[g-1];do{if(this.edgeExceedsShortLineThreshold(g,O)){const f=k.editEdgeToSnappingEdge(g,v,O);this._checkEdgeForParallelLines(f,c,P,Q,O,a);this._checkEdgeForParallelLines(f,D,P,Q,O,a)}g=g.leftVertex.leftEdge}while(g&&g!==L);return a};G.snapExistingVertex=function(P,O){const L=[],g=e.unwrap(O.vertexHandle);var c=g.component;if(3>c.edges.length)return L;const {view:a}=this,v=l.vectorToScreenPoint(P,O.spatialReference,E.absoluteHeightElevationInfo,a),Q=g.leftEdge,D=g.rightEdge,f=c.vertices[0],
A=d.anyMapPointToSnappingPoint(f.pos,a,O),J=c.vertices[c.vertices.length-1],z=d.anyMapPointToSnappingPoint(J.pos,a,O);let N=c=c.edges[0];do{if(N!==Q&&N!==D&&this.edgeExceedsShortLineThreshold(N,O)){const F=k.editEdgeToSnappingEdge(N,a,O);Q&&this._checkEdgeForParallelLines(F,d.anyMapPointToSnappingPoint(Q.leftVertex.pos,a,O),P,v,O,L);D&&this._checkEdgeForParallelLines(F,d.anyMapPointToSnappingPoint(D.rightVertex.pos,a,O),P,v,O,L);g===f?this._checkEdgeForParallelLines(F,z,P,v,O,L):g===J&&this._checkEdgeForParallelLines(F,
A,P,v,O,L)}N=N.rightVertex.rightEdge}while(N&&N!==c);return L};G._checkEdgeForParallelLines=function(P,O,L,g,c,a){const v=P.left,Q=P.right;p.projectPointToLine(B,O,v,Q);if(!(H.squaredDistance(B,O)<h.defaults.parallelLineThreshold)){p.projectPointToLine(B,L,v,Q,O);var {spatialReference:D,pointer:f}=c;L=d.asSnappingPoint(K.fromValues(B[0],B[1],L[2]));k.squaredScreenDistance(g,l.vectorToScreenPoint(L,D,E.absoluteHeightElevationInfo,this.view))<this.squaredProximityThreshold(f)&&!(this.isVertical(L,O)||
this.isVertical(v,Q)||this._parallelToPreviousCandidate(P,a))&&a.push(new r.ParallelLineSnappingCandidate({referenceLine:P,lineStart:O,targetPoint:L,isDraped:"on-the-ground"===c.elevationInfo?.mode}))}};G._parallelToPreviousCandidate=function(P,O){const L=P.left,g=P.right;for(const c of O)if(p.projectPointToLine(B,g,c.constraint.start,c.constraint.end,L),H.squaredDistance(B,g)<h.defaults.parallelLineThreshold)return c.addReferenceLine(P),!0;return!1};return y}(t.SnappingAlgorithm);const B=u.create();
b.ParallelLineSnapper=t;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/ParallelLineSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../SnappingConstraint ../SnappingDomain ../SnappingPoint ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint ../hints/ParallelSnappingHint".split(" "),function(b,n,e,H,u,K,E,h,t,d,k){t=function(r){function l({referenceLine:p,
lineStart:B,targetPoint:x,isDraped:y}){const G=H.clone(B),{left:P,right:O}=p;e.subtract(G,e.add(G,G,O),P);B=r.call(this,x,new u.VerticalPlaneConstraint(B,E.asSnappingPoint(G)),y,K.SnappingDomain.SELF)||this;B._referenceLines=[{edge:p,fadeLeft:!0,fadeRight:!0}];return B}n._inheritsLoose(l,r);l.prototype.addReferenceLine=function(p){const B={edge:p,fadeLeft:!0,fadeRight:!0};this._referenceLines.forEach(x=>{e.exactEquals(p.right,x.edge.left)&&(x.fadeLeft=!1,B.fadeRight=!1);e.exactEquals(p.right,x.edge.right)&&
(x.fadeRight=!1,B.fadeRight=!1);e.exactEquals(p.left,x.edge.right)&&(x.fadeRight=!1,B.fadeLeft=!1);e.exactEquals(p.left,x.edge.left)&&(x.fadeLeft=!1,B.fadeLeft=!1)});this._referenceLines.push(B)};n._createClass(l,[{key:"hints",get:function(){return[new d.LineSnappingHint(h.LineSegmentHintType.TARGET,this.constraint.start,this.targetPoint,this.isDraped,this.domain),new k.ParallelSnappingHint(this.constraint.start,this.targetPoint,this.isDraped,this.domain),...this._referenceLines.map(p=>new d.LineSnappingHint(h.LineSegmentHintType.REFERENCE,
p.edge.left,p.edge.right,this.isDraped,this.domain,p.fadeLeft,p.fadeRight))]}}]);return l}(t.SnappingCandidate);b.ParallelLineSnappingCandidate=t;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/ParallelSnappingHint":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/Logger ../../../../chunks/vec3 ../SnappingDomain ./SnappingHint".split(" "),function(b,n,e,H,u,K,E){e=function(h){function t(d,
k,r,l=K.SnappingDomain.ALL){r=h.call(this,r,l)||this;r.lineStart=d;r.lineEnd=k;return r}n._inheritsLoose(t,h);t.prototype.equals=function(d){return d instanceof t?u.exactEquals(this.lineStart,d.lineStart)&&u.exactEquals(this.lineEnd,d.lineEnd):!1};return t}(E.SnappingHint);b.ParallelSnappingHint=e;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/RightAngleSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../support/elevationInfoUtils ./SnappingAlgorithm ./SnappingConstraint ./SnappingPoint ./snappingUtils ./candidates/RightAngleSnappingCandidate ../support/viewUtils".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k,r,l,p){t=function(y){function G(){return y.apply(this,arguments)||this}n._inheritsLoose(G,y);var P=G.prototype;P.snapNewVertex=function(O,L){var g=L.editGeometryOperations.data.components[0],c=g.vertices.length;const a=[];if(2>c)return a;var {view:v}=this;const Q=p.vectorToScreenPoint(O,L.spatialReference,h.absoluteHeightElevationInfo,v);var D=g.vertices[c-1];this.edgeExceedsShortLineThreshold(D.leftEdge,L)&&(c=k.anyMapPointToSnappingPoint(D.pos,v,L),D=k.anyMapPointToSnappingPoint(D.leftEdge.leftVertex.pos,
v,L),this._checkForSnappingCandidate(a,D,c,O,Q,L));c=g.vertices[0];this.edgeExceedsShortLineThreshold(c.rightEdge,L)&&(g=k.anyMapPointToSnappingPoint(c.pos,v,L),v=k.anyMapPointToSnappingPoint(c.rightEdge.rightVertex.pos,v,L),this._checkForSnappingCandidate(a,v,g,O,Q,L));return a};P.snapExistingVertex=function(O,L){const g=[];var c=e.unwrap(L.vertexHandle);if(3>c.component.vertices.length)return g;var {view:a}=this;const v=p.vectorToScreenPoint(O,L.spatialReference,h.absoluteHeightElevationInfo,a);
var Q=c.leftEdge;c=c.rightEdge;if(Q&&Q.leftVertex.leftEdge){var D=Q.leftVertex.leftEdge;this.edgeExceedsShortLineThreshold(D,L)&&(Q=k.anyMapPointToSnappingPoint(D.rightVertex.pos,a,L),D=k.anyMapPointToSnappingPoint(D.leftVertex.pos,a,L),this._checkForSnappingCandidate(g,D,Q,O,v,L))}c&&c.rightVertex.rightEdge&&(Q=c.rightVertex.rightEdge,this.edgeExceedsShortLineThreshold(Q,L)&&(c=k.anyMapPointToSnappingPoint(Q.leftVertex.pos,a,L),a=k.anyMapPointToSnappingPoint(Q.rightVertex.pos,a,L),this._checkForSnappingCandidate(g,
a,c,O,v,L)));return g};P._checkForSnappingCandidate=function(O,L,g,c,a,v){const {spatialReference:Q,pointer:D}=v;H.subtract(B,g,L);const f=K.set(x,B[1],-B[0],0),A=H.dot(f,H.subtract(B,c,g))/H.squaredLength(f);c=k.asSnappingPoint(H.scaleAndAdd(E.clone(c),g,f,A));r.squaredScreenDistance(a,p.vectorToScreenPoint(c,Q,h.absoluteHeightElevationInfo,this.view))<this.squaredProximityThreshold(D)&&!this.isVertical(c,g)&&!this.isVertical(g,L)&&(a=K.scaleAndAdd(E.create(),g,f,Math.sign(A)),O.push(new l.RightAngleSnappingCandidate({targetPoint:c,
constraint:new d.VerticalHalfPlaneConstraint(g,k.asSnappingPoint(a)),previousVertex:L,otherVertex:g,otherVertexType:l.OtherVertexType.CENTER,isDraped:"on-the-ground"===v.elevationInfo?.mode})))};return G}(t.SnappingAlgorithm);const B=u.create(),x=E.create();b.RightAngleSnapper=t;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/RightAngleTriangleSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../chunks/vec3f64 ../../../support/elevationInfoUtils ./SnappingAlgorithm ./SnappingPoint ./snappingUtils ./candidates/RightAngleTriangleSnappingCandidate ../support/viewUtils ../../support/geometry2dUtils".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k,r,l){h=function(B){function x(){return B.apply(this,arguments)||this}n._inheritsLoose(x,B);var y=x.prototype;y.snapNewVertex=function(G,P){var O=P.editGeometryOperations.data.components[0];const L=[];var g=O.vertices.length;if("polygon"!==P.editGeometryOperations.data.type||2>g)return L;var {view:c}=this;g=O.vertices[g-1];O=t.anyMapPointToSnappingPoint(O.vertices[0].pos,c,P);c=t.anyMapPointToSnappingPoint(g.pos,c,P);this._processCandidateProposal(O,c,G,P,L);return L};
y.snapExistingVertex=function(G,P){const O=[];var L=e.unwrap(P.vertexHandle),g=L.component;if(2>g.edges.length||"polyline"===P.editGeometryOperations.data.type&&(0===L.index||L.index===g.vertices.length-1))return O;const {view:c}=this;g=t.anyMapPointToSnappingPoint(L.leftEdge.leftVertex.pos,c,P);L=t.anyMapPointToSnappingPoint(L.rightEdge.rightVertex.pos,c,P);this._processCandidateProposal(g,L,G,P,O);return O};y._processCandidateProposal=function(G,P,O,L,g){if(this.exceedsShortLineThreshold(G,P,L)){var c=
H.lerp(p,G,P,.5),a=.5*H.distance(G,P),v=K.create();l.projectPointToCircle(v,O,c,a);v[2]=O[2];c=t.asSnappingPoint(v);var {spatialReference:Q,pointer:D}=L;O=r.vectorToScreenPoint(O,Q,E.absoluteHeightElevationInfo,this.view);d.squaredScreenDistance(O,r.vectorToScreenPoint(c,Q,E.absoluteHeightElevationInfo,this.view))<this.squaredProximityThreshold(D)&&!this.isVertical(G,c)&&!this.isVertical(c,P)&&g.push(new k.RightAngleTriangleSnappingCandidate({targetPoint:c,point1:G,point2:P,isDraped:"on-the-ground"===
L.elevationInfo?.mode}))}};return x}(h.SnappingAlgorithm);const p=u.create();b.RightAngleTriangleSnapper=h;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/RightAngleTriangleSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/vec2 ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../SnappingConstraint ../SnappingDomain ../SnappingPoint ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint ../hints/RightAngleSnappingHint".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k,r){d=function(l){function p({targetPoint:B,point1:x,point2:y,isDraped:G}){B=l.call(this,B,new K.VerticalCylinderConstraint(h.asSnappingPoint(H.lerp(u.create(),x,y,.5)),.5*e.distance(x,y)),G,E.SnappingDomain.SELF)||this;B._p1=x;B._p2=y;return B}n._inheritsLoose(p,l);n._createClass(p,[{key:"hints",get:function(){return[new k.LineSnappingHint(t.LineSegmentHintType.REFERENCE,this.targetPoint,this._p1,this.isDraped,this.domain),new k.LineSnappingHint(t.LineSegmentHintType.REFERENCE,
this.targetPoint,this._p2,this.isDraped,this.domain),new r.RightAngleSnappingHint(this._p1,this.targetPoint,this._p2,this.isDraped,this.domain)]}}]);return p}(d.SnappingCandidate);b.RightAngleTriangleSnappingCandidate=d;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingOptions":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ./FeatureSnappingLayerSource ./Settings".split(" "),
function(b,n,e,H,u,K,E,h,t,d){e=function(k){function r(l){l=k.call(this,l)||this;l.enabled=!1;l.enabledToggled=!1;l.selfEnabled=!0;l.featureEnabled=!0;l.featureSources=new H;l.distance=d.defaults.distance;l.touchSensitivityMultiplier=d.defaults.touchSensitivityMultiplier;return l}b._inheritsLoose(r,k);b._createClass(r,[{key:"effectiveEnabled",get:function(){return this.enabledToggled?!this.enabled:this.enabled}},{key:"effectiveSelfEnabled",get:function(){return this.effectiveEnabled&&this.selfEnabled}},
{key:"effectiveFeatureEnabled",get:function(){return this.effectiveEnabled&&this.featureEnabled}}]);return r}(e);n.__decorate([u.property()],e.prototype,"enabled",void 0);n.__decorate([u.property()],e.prototype,"enabledToggled",void 0);n.__decorate([u.property()],e.prototype,"selfEnabled",void 0);n.__decorate([u.property()],e.prototype,"featureEnabled",void 0);n.__decorate([u.property({type:H.ofType(t)})],e.prototype,"featureSources",void 0);n.__decorate([u.property()],e.prototype,"distance",void 0);
n.__decorate([u.property()],e.prototype,"touchSensitivityMultiplier",void 0);n.__decorate([u.property({readOnly:!0})],e.prototype,"effectiveEnabled",null);n.__decorate([u.property({readOnly:!0})],e.prototype,"effectiveSelfEnabled",null);n.__decorate([u.property({readOnly:!0})],e.prototype,"effectiveFeatureEnabled",null);return e=n.__decorate([h.subclass("esri.views.interactive.snapping.SnappingOptions")],e)})},"esri/views/interactive/snapping/candidates/IntersectionSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../SnappingConstraint ../SnappingDomain ./SnappingCandidate ../hints/IntersectionSnappingHint".split(" "),
function(b,n,e,H,u,K){u=function(E){function h(t,d,k,r){t=E.call(this,t,new e.IntersectionConstraint(t,d.constraint,k.constraint),r,H.SnappingDomain.ALL)||this;t.first=d;t.second=k;return t}n._inheritsLoose(h,E);n._createClass(h,[{key:"hints",get:function(){this.first.targetPoint=this.targetPoint;this.second.targetPoint=this.targetPoint;return[...this.first.hints,...this.second.hints,new K.IntersectionSnappingHint(this.targetPoint,this.isDraped,this.domain)]}}]);return h}(u.SnappingCandidate);b.IntersectionSnappingCandidate=
u;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/IntersectionSnappingHint":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/vec3","../SnappingDomain","./SnappingHint"],function(b,n,e,H,u){u=function(K){function E(h,t,d=H.SnappingDomain.ALL){t=K.call(this,t,d)||this;t.intersectionPoint=h;return t}n._inheritsLoose(E,K);E.prototype.equals=function(h){return h instanceof E?e.exactEquals(this.intersectionPoint,
h.intersectionPoint):!1};return E}(u.SnappingHint);b.IntersectionSnappingHint=u;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Sketch/support/OperationHandle":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/compilerUtils ../../../core/Evented ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass".split(" "),
function(b,n,e,H,u,K,E,h,t){b.OperationHandle=function(d){function k(l){l=d.call(this,l)||this;l.cancelled=!1;l.history={undo:[],redo:[]};l.type=null;return l}n._inheritsLoose(k,d);var r=k.prototype;r.addToHistory=function(l){this.history.redo=[];this.history.undo.push(l)};r.resetHistory=function(){this.history.redo=[];this.history.undo=[]};r.canUndo=function(){return 0<this.history.undo.length};r.canRedo=function(){return 0<this.history.redo.length};r.complete=function(){this._reset();this.onEnd();
this.emit("complete")};r.cancel=function(){this.cancelled=!0;this.complete()};r._reset=function(){this.activeComponent?.reset()};r.refreshComponent=function(){const l=this.activeComponent;l&&("box"!==l.type&&"reshape"!==l.type&&"graphic-mover"!==l.type||l.refresh())};n._createClass(k,[{key:"tool",get:function(){if(!this.activeComponent)return null;switch(this.activeComponent.type){case "graphic-mover":case "move-3d":return"move";case "box":case "transform-3d":return"transform";case "reshape":case "reshape-3d":return"reshape";
case "draw-2d":case "draw-3d":return this.activeComponent.geometryType;default:H.neverReached(this.activeComponent)}return null}},{key:"undo",set:function(l){this._set("undo",()=>{this.canUndo()&&l()})}},{key:"redo",set:function(l){this._set("redo",()=>{this.canRedo()&&l()})}}]);return k}(u.EventedAccessor);e.__decorate([K.property()],b.OperationHandle.prototype,"activeComponent",void 0);e.__decorate([K.property()],b.OperationHandle.prototype,"cancelled",void 0);e.__decorate([K.property()],b.OperationHandle.prototype,
"history",void 0);e.__decorate([K.property()],b.OperationHandle.prototype,"tool",null);e.__decorate([K.property()],b.OperationHandle.prototype,"type",void 0);e.__decorate([K.property()],b.OperationHandle.prototype,"canUndo",null);e.__decorate([K.property()],b.OperationHandle.prototype,"canRedo",null);e.__decorate([K.property()],b.OperationHandle.prototype,"onEnd",void 0);e.__decorate([K.property()],b.OperationHandle.prototype,"undo",null);e.__decorate([K.property()],b.OperationHandle.prototype,"redo",
null);e.__decorate([K.property()],b.OperationHandle.prototype,"toggleTool",void 0);e.__decorate([K.property()],b.OperationHandle.prototype,"addToSelection",void 0);e.__decorate([K.property()],b.OperationHandle.prototype,"removeFromSelection",void 0);b.OperationHandle=e.__decorate([t.subclass("esri.widgets.Sketch.support.OperationHandle")],b.OperationHandle);b.CreateOperationHandle=function(d){function k(){return d.apply(this,arguments)||this}n._inheritsLoose(k,d);return k}(b.OperationHandle);e.__decorate([K.property()],
b.CreateOperationHandle.prototype,"activeComponent",void 0);b.CreateOperationHandle=e.__decorate([t.subclass("esri.widgets.Sketch.support.CreateOperationHandle")],b.CreateOperationHandle);b.UpdateOperationHandle=function(d){function k(){return d.apply(this,arguments)||this}n._inheritsLoose(k,d);return k}(b.OperationHandle);e.__decorate([K.property()],b.UpdateOperationHandle.prototype,"activeComponent",void 0);b.UpdateOperationHandle=e.__decorate([t.subclass("esri.widgets.Sketch.support.UpdateOperationHandle")],
b.UpdateOperationHandle);Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/SnappingControls":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/maybe ../../core/uid ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass ../Widget ./widgetUtils ./decorators/messageBundle ./jsxFactory ./SnappingControls/SnappingControlsViewModel".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k,r,l,p){const B={header:!0,enabledToggle:!0,selfEnabledToggle:!0,featureEnabledToggle:!0,layerList:!0};h=function(x){function y(P,O){var L=x.call;const {view:g,viewModel:c,snappingOptions:a,...v}=P;O=L.call(x,this,v,O)||this;O._layerListFilter=null;O.iconClass="esri-icon-vertex-gps";O.layerListOpen=!0;O.messages=null;O.visibleElements={...B};O._defaultViewModel=null;P?.viewModel?O.viewModel=P.viewModel:(O._defaultViewModel=new p({snappingOptions:P.snappingOptions,view:P.view}),
O.viewModel=O._defaultViewModel);return O}n._inheritsLoose(y,x);var G=y.prototype;G.destroy=function(){this._defaultViewModel=H.destroyMaybe(this._defaultViewModel)};G.loadDependencies=function(){return Promise.all([new Promise((P,O)=>b(["../../chunks/calcite-accordion"],P,O)),new Promise((P,O)=>b(["../../chunks/calcite-accordion-item"],P,O)),new Promise((P,O)=>b(["../../chunks/calcite-block"],P,O)),new Promise((P,O)=>b(["../../chunks/calcite-checkbox"],P,O)),new Promise((P,O)=>b(["../../chunks/calcite-input"],
P,O)),new Promise((P,O)=>b(["../../chunks/calcite-label"],P,O)),new Promise((P,O)=>b(["../../chunks/calcite-list"],P,O)),new Promise((P,O)=>b(["../../chunks/calcite-list-item"],P,O)),new Promise((P,O)=>b(["../../chunks/calcite-panel"],P,O)),new Promise((P,O)=>b(["../../chunks/calcite-switch"],P,O))])};G.castVisibleElements=function(P){return{...B,...P}};G.render=function(){const {label:P,visibleElements:{header:O}}=this;return l.tsx("div",{"aria-label":P,class:this.classes("esri-snapping-controls",
"esri-widget")},l.tsx("div",{class:"esri-snapping-controls__container"},O?this.renderHeaderView():this.renderContent()))};G.renderHeaderView=function(){return l.tsx("calcite-panel",{heading:this.label,class:"esri-snapping-controls__panel"},this.renderContent())};G.renderContent=function(){return[this.renderToggles(),this.renderLayerList()]};G.renderToggles=function(){const {visibleElements:{enabledToggle:P,selfEnabledToggle:O,featureEnabledToggle:L}}=this;return P||O||L?l.tsx("calcite-block",{class:"esri-snapping-controls__toggle-block",
key:"toggle-block",heading:"",open:!0},this.renderEnabledToggle(),l.tsx("div",{class:"esri-snapping-controls__nested-container"},this.renderSelfEnabledToggle(),this.renderFeatureEnabledToggle())):null};G.renderEnabledToggle=function(){if(!this.visibleElements.enabledToggle)return null;const {messages:{enableSnapping:P},viewModel:{snappingOptions:{enabled:O,enabledToggled:L}}}=this;return l.tsx("calcite-label",{layout:"inline-space-between"},P,l.tsx("calcite-switch",{checked:O,disabled:L,bind:this,
onCalciteSwitchChange:this._enableSnappingSwitchChange}))};G.renderSelfEnabledToggle=function(){if(!this.visibleElements.selfEnabledToggle)return null;const {messages:{geometryGuides:P},viewModel:{snappingOptions:{enabled:O,selfEnabled:L,enabledToggled:g}}}=this;return l.tsx("calcite-label",{layout:"inline-space-between",key:"self-enabled-toggle"},P,l.tsx("calcite-switch",{checked:L,disabled:g||!O,bind:this,onCalciteSwitchChange:this._selfEnabledSwitchChange}))};G.renderFeatureEnabledToggle=function(){if(!this.visibleElements.featureEnabledToggle)return null;
const {messages:{featureToFeature:P},viewModel:{snappingOptions:{enabled:O,featureEnabled:L,enabledToggled:g}}}=this;return l.tsx("calcite-label",{layout:"inline-space-between",key:"feature-enabled-toggle"},P,l.tsx("calcite-switch",{checked:L,disabled:g||!O,bind:this,onCalciteSwitchChange:this._featureEnabledSwitchChange}))};G.renderLayerList=function(){if(!this.visibleElements.layerList)return null;const {messages:P}=this;var O=({target:{value:L}})=>this._layerListFilter=""===L?null:new RegExp(L,
"i");O=9<this.viewModel.layerListViewModel.operationalItems.length?l.tsx("calcite-input",{class:"esri-snapping-controls__layer-list__filter",clearable:!0,placeholder:P?.searchLayers,onCalciteInputInput:O}):null;return l.tsx("calcite-block",{key:"list-block",heading:P.snappingLayers,class:"esri-snapping-controls__layer-list-block",collapsible:!0,open:this.layerListOpen,onCalciteBlockToggle:L=>this.layerListOpen=L.target.open},O,l.tsx("calcite-list",{class:"esri-snapping-controls__layer-list"},this.renderLayerListItemCollection(this.viewModel.layerListViewModel.operationalItems,
H.unwrap(this._layerListFilter))))};G.renderLayerListItemCollection=function(P,O){return P.map(L=>{if(O?this._itemTitleMatchesFilter(L,O):1)return 0<L.children.length?this.renderLayerListItemGroup(L):this.renderLayerListItem(L);const g=L.children.filter(c=>this._itemTitleMatchesFilter(c,O));return 0<g.length?this.renderLayerListItemGroup(L,g):null}).toArray().filter(H.isSome)};G.renderLayerListItem=function(P){var {messages:{untitledLayer:O}}=this;O=P.title||O;const L=l.tsx("calcite-checkbox",{value:P.layer.id,
checked:P.enabled,bind:this,onCalciteCheckboxChange:g=>this._handleLayerListItemChange(g.target)});return l.tsx("calcite-list-item",{key:`${this.id}-list-item-${P.uid}`,onCalciteListItemSelect:()=>{this._handleLayerListItemChange({checked:!L.properties.checked,value:L.properties.value})}},l.tsx("calcite-label",{class:"esri-snapping-controls__layer-list__item",slot:"content-start",tabIndex:-1,layout:"inline"},l.tsx("div",{class:"esri-snapping-controls__layer-list__item__checkbox"},L),l.tsx("div",{class:"esri-snapping-controls__layer-list__item__label"},
O)))};G.renderLayerListItemGroup=function(P,O){const L=P.title||this.messages.untitledLayer,g=P.title&&""!==P.title?P.title:u.generateUID();return l.tsx("calcite-list-item",{key:g},l.tsx("calcite-accordion",{iconPosition:"start",appearance:"transparent",afterCreate:c=>{c.append(...Array.from(c.children).map(a=>{a.remove();return a}))}},l.tsx("calcite-accordion-item",{expanded:!!O,heading:L,key:P.uid},l.tsx("calcite-list",null,[...this.renderLayerListItemCollection(O??P.children)]))))};G._enableSnappingSwitchChange=
function(P){this.snappingOptions.enabled=P.target.checked};G._featureEnabledSwitchChange=function(P){this.snappingOptions.featureEnabled=P.target.checked};G._itemTitleMatchesFilter=function(P,O){return null!=O&&O.test(P.title)};G._selfEnabledSwitchChange=function(P){this.snappingOptions.selfEnabled=P.target.checked};G._handleLayerListItemChange=function(){var P=n._asyncToGenerator(function*(O){O.checked?this.viewModel.enableSnappingForLayer(O.value):this.viewModel.disableSnappingForLayer(O.value)});
return function(O){return P.apply(this,arguments)}}();n._createClass(y,[{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(P){this._overrideIfSome("label",P)}},{key:"snappingOptions",get:function(){return this.viewModel.snappingOptions},set:function(P){this.viewModel.snappingOptions=P}},{key:"view",get:function(){return this.viewModel.view},set:function(P){this.viewModel.view=P}},{key:"viewModel",set:function(P){if(P!==this._get("viewModel")){if(H.isNone(this._defaultViewModel)||
this._defaultViewModel!==P)this._defaultViewModel=H.destroyMaybe(this._defaultViewModel);this._set("viewModel",P)}}}]);return y}(d);e.__decorate([K.property()],h.prototype,"_layerListFilter",void 0);e.__decorate([K.property()],h.prototype,"iconClass",void 0);e.__decorate([K.property()],h.prototype,"label",null);e.__decorate([K.property()],h.prototype,"layerListOpen",void 0);e.__decorate([K.property(),r.messageBundle("esri/widgets/support/SnappingControls/t9n/SnappingControls")],h.prototype,"messages",
void 0);e.__decorate([K.property()],h.prototype,"snappingOptions",null);e.__decorate([K.property()],h.prototype,"view",null);e.__decorate([K.property()],h.prototype,"viewModel",null);e.__decorate([K.property()],h.prototype,"visibleElements",void 0);e.__decorate([E.cast("visibleElements")],h.prototype,"castVisibleElements",null);return h=e.__decorate([t.subclass("esri.widgets.support.SnappingControls")],h)})},"esri/widgets/support/SnappingControls/SnappingControlsViewModel":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Error ../../../core/HandleOwner ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ../../../views/interactive/snapping/FeatureSnappingLayerSource ../../LayerList/support/layerListUtils ./SnappingLayerListViewModel".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k,r,l){e=function(p){function B(y){y=p.call(this,y)||this;y.layerListViewModel=new l.SnappingLayerListViewModel;y.snappingOptions=null;y.view=null;return y}b._inheritsLoose(B,p);var x=B.prototype;x.initialize=function(){this.handles.add([K.watch(()=>({viewModel:this.layerListViewModel,view:this.view}),({viewModel:y,view:G})=>{y.view=G},K.initial),K.watch(()=>({viewModel:this.layerListViewModel,sources:this.snappingOptions?.featureSources}),({viewModel:y,sources:G})=>{y.featureSnappingSources=
G},K.initial)])};x.enableSnappingForLayer=function(y){(this._findSnappingSourceForLayer(y)??this._makeSnappingSourceForLayer(y)).enabled=!0};x.disableSnappingForLayer=function(y){if(y=this._findSnappingSourceForLayer(y))y.enabled=!1};x.updateEnabledFeatureSources=function(y){for(const G of this.snappingOptions.featureSources)r.canDisplayLayer(G.layer)&&(G.enabled=y.includes(G.layer.id))};x._findSnappingSourceForLayer=function(y){return this.snappingOptions.featureSources.find(G=>G.layer.id===y)};
x._makeSnappingSourceForLayer=function(y){var G=this.layerListViewModel.operationalItemsFlat.find(P=>P.layer.id===y)?.layer;if(!G)throw new H("snapping-controls:layer-not-found",`cannot enable snapping for layer with id ${y} because no such layer was found in the view`);G=new k({layer:G});this.snappingOptions.featureSources.add(G);return G};b._createClass(B,[{key:"state",get:function(){return this.get("snappingOptions")?"ready":"disabled"}}]);return B}(u.HandleOwnerMixin(e));n.__decorate([E.property({constructOnly:!0})],
e.prototype,"layerListViewModel",void 0);n.__decorate([E.property()],e.prototype,"snappingOptions",void 0);n.__decorate([E.property()],e.prototype,"state",null);n.__decorate([E.property()],e.prototype,"view",void 0);return e=n.__decorate([d.subclass("esri.widgets.support.SnappingControls.SnappingControlsViewModel")],e)})},"esri/widgets/LayerList/support/layerListUtils":function(){define(["exports"],function(b){function n(t){if(t)return null!=t.listMode?t.listMode:void 0}function e(t){if(t)return null!=
t.minScale?t.minScale:void 0}function H(t){if(t)return null!=t.maxScale?t.maxScale:void 0}function u(t){if(t&&!("type"in t&&"wmts"===t.type)&&t.listMode!==h.hideChildren)return"sublayers"in t?"sublayers":"layers"in t?"layers":void 0}function K(t,d){t&&t.sort((k,r)=>{k=d.indexOf(k.uid);r=d.indexOf(r.uid);return k>r?-1:k<r?1:0})}function E(t){return!!t?.layer}const h={hide:"hide",hideChildren:"hide-children"};b.canDisplayLayer=function(t){return n(t)!==h.hide};b.canSortSublayers=function(t){t=t&&(t.get("layer.layer")||
t.layer);if(!t)return!1;t=t.get("capabilities.exportMap.supportsDynamicLayers");return"boolean"===typeof t?t:!0};b.findLayerListMode=n;b.findLayerMaxScale=H;b.findLayerMinScale=e;b.findLayerVisibilityMode=function(t){if(!t)return"inherited";var d=t.get("layer.capabilities.exportMap.supportsSublayerVisibility");if("boolean"===typeof d)return d?"independent":"inherited";d=t.get("capabilities.exportMap.supportsSublayerVisibility");return"boolean"===typeof d?d?"independent":"inherited":null!=t.visibilityMode?
t.visibilityMode:"independent"};b.findSelectedItem=function(t,d){const k=t.layer?.uid;return k&&d.find(r=>r.layer?.uid===k)};b.getItemLayers=function(t){return(t=t?.layer)&&"layers"in t?t.layers:null};b.getLegendLayerInfo=function(t){var d=E(t)?t:null;const k=t?.parent;return(d="map-image"===k?.type&&d.source)&&k?{layer:k,title:"",sublayerIds:[d.mapLayerId]}:{layer:t,title:""}};b.getNormalizedChildLayerProperty=u;b.isLayerOutsideScaleRange=function(t,d){if(!t||isNaN(d))return!1;var k=e(t);t=H(t);
k=!isNaN(k)&&0<k&&d>k;d=!isNaN(t)&&0<t&&d<t;return k||d};b.isSublayer=E;b.sortChildLayersToIds=function(t,d){if(t=t?.layer){var k=u(t);k&&(t=t.get(k),K(t,d))}};b.sortLayersToIds=K;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/SnappingControls/SnappingLayerListViewModel":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ../../LayerList/LayerListViewModel ./snappingLayerListUtils ./SnappingListItem".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k){b.SnappingLayerListViewModel=function(r){function l(){var B=r.apply(this,arguments)||this;B.featureSnappingSources=new H;return B}n._inheritsLoose(l,r);var p=l.prototype;p._compileList=function(){var B=this.get("view.map.layers");B&&(B=B.filter(d.isValidSnappingLayer),this._watchLayersListMode(B),(B=this._getViewableLayers(B))&&B.length?(this._createNewItems(B),this._removeItems(B),this._sortItems(B)):this._removeAllItems())};p._createListItem=function(B){return new k.SnappingListItem({layer:B,
view:this.view,getFeatureSnappingSources:()=>this.featureSnappingSources})};n._createClass(l,[{key:"operationalItemsFlat",get:function(){return this.operationalItems.flatten(B=>B.children)}}]);return l}(t);e.__decorate([u.property()],b.SnappingLayerListViewModel.prototype,"featureSnappingSources",void 0);e.__decorate([u.property()],b.SnappingLayerListViewModel.prototype,"operationalItems",void 0);b.SnappingLayerListViewModel=e.__decorate([h.subclass("esri.widgets.support.SnappingControls.SnappingLayerListViewModel")],
b.SnappingLayerListViewModel);Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/LayerList/LayerListViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Collection ../../core/Evented ../../core/Handles ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass ./ListItem ./support/layerListUtils".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k,r){const l=e.ofType(k);e=function(p){function B(y){y=p.call(this,y)||this;y._handles=new u;y.checkPublishStatusEnabled=!1;y.listItemCreatedFunction=null;y.operationalItems=new l;y.view=null;return y}b._inheritsLoose(B,p);var x=B.prototype;x.initialize=function(){this._handles.add([K.watch(()=>[this.view,this.view?.ready],()=>this._viewHandles(),K.initial),K.watch(()=>[this.listItemCreatedFunction,this.checkPublishStatusEnabled],()=>this._recompileList())],"view")};x.destroy=
function(){this._handles.destroy();this.view=this._handles=null;this.operationalItems.removeAll()};x.triggerAction=function(y,G){y&&!y.disabled&&this.emit("trigger-action",{action:y,item:G})};x.moveListItem=function(y,G,P,O){const L=y?.layer;if(L){var g=this.view?.map?.layers,c=G?r.getItemLayers(G):g;g=P?r.getItemLayers(P):g;if(c&&g){var {operationalItems:a}=this;G=G?.children||a;a=P?.children||a;O=g.length-O;y.parent=P||null;G.includes(y)&&G.remove(y);c.includes(L)&&c.remove(L);a.includes(y)||a.add(y,
O);g.includes(L)||g.add(L,O)}}};x._createLayerViewHandles=function(y){const {_handles:G}=this;G.remove("layer-views");this._compileList();y&&G.add(y.on("change",()=>this._compileList()),"layer-views")};x._createMapLayerHandles=function(y){const {_handles:G}=this;G.remove("map-layers");this._compileList();y&&G.add(y.on("change",()=>this._compileList()),"map-layers")};x._createListItem=function(y){const {view:G,listItemCreatedFunction:P,checkPublishStatusEnabled:O}=this;return new k({checkPublishStatusEnabled:O,
layer:y,listItemCreatedFunction:P,view:G})};x._removeAllItems=function(){const {_handles:y,operationalItems:G}=this;G.forEach(P=>{y.remove(`${"children"}-${P.uid}`)});G.removeAll()};x._getViewableLayers=function(y){if(y)return y.filter(G=>"hide"!==r.findLayerListMode(G))};x._watchLayersListMode=function(y){const {_handles:G}=this;G.remove("layer-list-mode");y&&y.forEach(P=>{"listMode"in P&&G.add(K.watch(()=>P.listMode,()=>this._compileList()),"layer-list-mode")})};x._compileList=function(){var y=
this.get("view.map.layers");this._watchLayersListMode(y);(y=this._getViewableLayers(y))&&y.length?(this._createNewItems(y),this._removeItems(y),this._sortItems(y)):this._removeAllItems()};x._createNewItems=function(y){const {operationalItems:G}=this;y.forEach(P=>{G.find(O=>O.layer===P)||G.add(this._createListItem(P))})};x._removeItems=function(y){const {_handles:G,operationalItems:P}=this,O=[];P.forEach(L=>{L&&y&&y.includes(L.layer)||(G.remove(`${"children"}-${L.uid}`),O.push(L))});P.removeMany(O)};
x._sortItems=function(y){const {operationalItems:G}=this;G.sort((P,O)=>{P=y.indexOf(P.layer);O=y.indexOf(O.layer);return P>O?-1:P<O?1:0})};x._recompileList=function(){this._removeAllItems();this._compileList()};x._viewHandles=function(){const {_handles:y,view:G}=this;y.remove(["map-layers","layer-views","view-layers"]);this._compileList();G&&G.ready&&y.add([K.watch(()=>this.view?.map?.allLayers,P=>this._createMapLayerHandles(P),K.initial),K.watch(()=>this.view?.allLayerViews,P=>this._createLayerViewHandles(P),
K.initial)],"view-layers")};b._createClass(B,[{key:"state",get:function(){const y=this.get("view");return this.get("view.ready")?"ready":y?"loading":"disabled"}}]);return B}(H.EventedAccessor);n.__decorate([E.property()],e.prototype,"checkPublishStatusEnabled",void 0);n.__decorate([E.property()],e.prototype,"listItemCreatedFunction",void 0);n.__decorate([E.property({type:l})],e.prototype,"operationalItems",void 0);n.__decorate([E.property({readOnly:!0})],e.prototype,"state",null);n.__decorate([E.property()],
e.prototype,"view",void 0);return e=n.__decorate([d.subclass("esri.widgets.LayerList.LayerListViewModel")],e)})},"esri/widgets/LayerList/ListItem":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Collection ../../core/HandleOwner ../../core/Identifiable ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass ../../support/actions/ActionBase ../../support/actions/ActionButton ../../support/actions/ActionSlider ../../support/actions/ActionToggle ./ListItemPanel ./support/layerListUtils".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k,r,l,p,B,x,y,G){var P;k=H.ofType({key:"type",defaultKeyValue:"button",base:l,typeMap:{button:p,toggle:x,slider:B}});const O=H.ofType(k);e=P=function(L){function g(a){a=L.call(this,a)||this;a.actionsSections=new O;a.actionsOpen=!1;a.checkPublishStatusEnabled=!1;a.children=new (H.ofType(P));a.childrenSortable=!0;a.hidden=!1;a.layer=null;a.layerView=null;a.listItemCreatedFunction=null;a.open=!1;a.panel=null;a.parent=null;a.sortable=!0;a.view=null;return a}b._inheritsLoose(g,
L);var c=g.prototype;c.initialize=function(){this.handles.add([h.watch(()=>this.layer,a=>this._watchLayerProperties(a),h.initial),h.watch(()=>this.checkPublishStatusEnabled,a=>this._updateChildrenPublishing(a),h.initial),h.watch(()=>this.view,a=>this._updateChildrenView(a),h.initial),h.watch(()=>this.panel,a=>this._setListItemOnPanel(a),h.initial),h.watch(()=>[this.layer,this.view],()=>this._getLayerView(),h.initial)]);"function"===typeof this.listItemCreatedFunction&&this.listItemCreatedFunction.call(null,
{item:this})};c.destroy=function(){this.view=null};c.castPanel=function(a){this.get("panel.open")&&!a.hasOwnProperty("open")&&(a.open=!0);return a?new y(a):null};c.clone=function(){return new P({actionsSections:this.actionsSections.clone(),actionsOpen:this.actionsOpen,checkPublishStatusEnabled:this.checkPublishStatusEnabled,children:this.children.clone(),layer:this.layer,listItemCreatedFunction:this.listItemCreatedFunction,open:this.open,panel:this.panel,title:this.title,view:this.view,visible:this.visible})};
c._setListItemOnPanel=function(a){a&&(a.listItem=this)};c._updateChildrenPublishing=function(a){const v=this.children;v&&v.forEach(Q=>Q.checkPublishStatusEnabled=a)};c._updateChildrenView=function(a){const v=this.children;v&&v.forEach(Q=>Q.view=a)};c._addChildren=function(a){this.handles.remove("child-list-mode");this.children.removeAll();if(a){a.forEach(Q=>{this.handles.add(h.watch(()=>Q.listMode,()=>this._addChildren(a)),"child-list-mode")});var v=a.filter(Q=>"hide"!==G.findLayerListMode(Q));this.children.addMany(this._makeChildren(v))}};
c._watchSublayerChanges=function(a){a&&this.handles.add(a.on("change",()=>{this._addChildren(a)}),"layer")};c._initializeChildLayers=function(a){this._addChildren(a);this._watchSublayerChanges(a)};c._makeChildren=function(a){return a.map(v=>G.canDisplayLayer(v)?new P({layer:v,checkPublishStatusEnabled:this.checkPublishStatusEnabled,listItemCreatedFunction:this.listItemCreatedFunction,parent:this,view:this.view}):null).filter(E.isSome).reverse()};c._watchLayerProperties=function(a){if(this.handles&&
(this.handles.remove("layer"),this.handles.remove("child-list-mode"),a))if(this.handles.add(h.watch(()=>a.listMode,()=>this._watchLayerProperties(a)),"layer"),"hide-children"===G.findLayerListMode(a))this.children.removeAll();else{var v=G.getNormalizedChildLayerProperty(a);v&&this.handles.add(h.watch(()=>a[v],()=>{a.hasOwnProperty(v)&&this._initializeChildLayers(a[v])},h.initial),"layer")}};c._getLayerView=function(){var a=b._asyncToGenerator(function*(){const {layer:v,view:Q}=this;if(v&&Q)try{const D=
yield Q.whenLayerView(v);D.layer===this.layer&&this._set("layerView",D)}catch{}});return function(){return a.apply(this,arguments)}}();b._createClass(g,[{key:"connectionStatus",get:function(){const {layerView:a,publishing:v}=this;if(!v&&a&&"connectionStatus"in a)return a.connectionStatus}},{key:"error",get:function(){return this.layer?.loadError}},{key:"incompatible",get:function(){const {layerView:a}=this;return a&&"spatialReferenceSupported"in a?!a.spatialReferenceSupported:!1}},{key:"title",get:function(){const a=
this.get("layer.layer");return(!a||a&&this.get("layer.layer.loaded"))&&this.get("layer.title")||this.get("layer.attributes.title")||""},set:function(a){this._override("title",a)}},{key:"publishing",get:function(){const {layer:a,checkPublishStatusEnabled:v}=this;return v&&a&&"publishingInfo"in a&&"publishing"===a.publishingInfo?.status}},{key:"updating",get:function(){const {layerView:a,connectionStatus:v,layer:Q,publishing:D}=this;return D||v?!1:a?a.updating:"loading"===Q?.loadStatus||!1}},{key:"visible",
get:function(){return this.layer?.visible},set:function(a){const v=this.layer;v&&(v.visible=a)}},{key:"visibleAtCurrentScale",get:function(){return!G.isLayerOutsideScaleRange(this.layer,this.get("view.scale"))}},{key:"visibilityMode",get:function(){return G.findLayerVisibilityMode(this.layer)}}]);return g}(K.IdentifiableMixin(u.HandleOwnerMixin(e)));n.__decorate([t.property({type:O})],e.prototype,"actionsSections",void 0);n.__decorate([t.property()],e.prototype,"actionsOpen",void 0);n.__decorate([t.property()],
e.prototype,"checkPublishStatusEnabled",void 0);n.__decorate([t.property({type:H})],e.prototype,"children",void 0);n.__decorate([t.property()],e.prototype,"childrenSortable",void 0);n.__decorate([t.property({readOnly:!0})],e.prototype,"connectionStatus",null);n.__decorate([t.property({readOnly:!0})],e.prototype,"error",null);n.__decorate([t.property()],e.prototype,"hidden",void 0);n.__decorate([t.property({readOnly:!0})],e.prototype,"incompatible",null);n.__decorate([t.property()],e.prototype,"layer",
void 0);n.__decorate([t.property({readOnly:!0})],e.prototype,"layerView",void 0);n.__decorate([t.property()],e.prototype,"listItemCreatedFunction",void 0);n.__decorate([t.property()],e.prototype,"open",void 0);n.__decorate([t.property({type:y})],e.prototype,"panel",void 0);n.__decorate([d.cast("panel")],e.prototype,"castPanel",null);n.__decorate([t.property()],e.prototype,"parent",void 0);n.__decorate([t.property()],e.prototype,"sortable",void 0);n.__decorate([t.property()],e.prototype,"title",null);
n.__decorate([t.property({readOnly:!0})],e.prototype,"publishing",null);n.__decorate([t.property({readOnly:!0})],e.prototype,"updating",null);n.__decorate([t.property()],e.prototype,"view",void 0);n.__decorate([t.property()],e.prototype,"visible",null);n.__decorate([t.property({readOnly:!0})],e.prototype,"visibleAtCurrentScale",null);n.__decorate([t.property({readOnly:!0})],e.prototype,"visibilityMode",null);return e=P=n.__decorate([r.subclass("esri.widgets.LayerList.ListItem")],e)})},"esri/support/actions/ActionSlider":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass ./ActionBase".split(" "),
function(b,n,e,H,u,K,E){var h;H=h=function(t){function d(k){k=t.call(this,k)||this;k.displayValueEnabled=!1;k.max=1;k.min=0;k.step=.1;k.type="slider";k.value=null;return k}b._inheritsLoose(d,t);d.prototype.clone=function(){return new h({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,displayValueEnabled:this.displayValueEnabled,max:this.max,min:this.min,step:this.step,value:this.value})};return d}(E);n.__decorate([e.property()],
H.prototype,"displayValueEnabled",void 0);n.__decorate([e.property()],H.prototype,"max",void 0);n.__decorate([e.property()],H.prototype,"min",void 0);n.__decorate([e.property()],H.prototype,"step",void 0);n.__decorate([e.property()],H.prototype,"value",void 0);return H=h=n.__decorate([K.subclass("esri.support.Action.ActionSlider")],H)})},"esri/widgets/LayerList/ListItemPanel":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Handles ../../core/Identifiable ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass ../Widget ./support/layerListUtils ../support/widget ../support/jsxFactory".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k,r,l,p){u=function(B){function x(G,P){G=B.call(this,G,P)||this;G._legend=null;G._handles=new H;G.content=null;G.image=null;G.listItem=null;G.open=!1;G.visible=!0;return G}n._inheritsLoose(x,B);var y=x.prototype;y.initialize=function(){this.addHandles(K.watch(()=>this.content,G=>this._createLegend(G),K.initial))};y.destroy=function(){const {_legend:G}=this;G&&G.destroy();this._legend=null};y.render=function(){return p.tsx("div",{class:"esri-layer-list-panel"},this._renderContents())};
y._renderContent=function(G){const {_legend:P,disabled:O}=this;return!G||O?null:"legend"===G&&P?p.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--legend"),key:P},P.render()):"string"===typeof G?p.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--string"),key:G,innerHTML:G}):l.isWidget(G)?p.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--widget"),key:G},G.render()):
G instanceof HTMLElement?p.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--html-element"),key:G,bind:G,afterCreate:this._attachToNode}):null};y._renderContents=function(){const {content:G}=this;return Array.isArray(G)?G.map(P=>this._renderContent(P)):this._renderContent(G)};y._getLegendOptions=function(){const {listItem:G}=this;if(!G)return{};const {layer:P,view:O}=G;return P&&O?{view:O,layerInfos:[r.getLegendLayerInfo(P)]}:{}};y._createLegend=function(G){this._hasLegend(G)&&
!this._legend&&(new Promise((P,O)=>b(["../Legend"],L=>P(Object.freeze(Object.defineProperty({__proto__:null,default:L},Symbol.toStringTag,{value:"Module"}))),O))).then(({default:P})=>{const {_handles:O,listItem:L}=this,g=new P(this._getLegendOptions());this._legend=g;this.notifyChange("className");this.notifyChange("title");P=K.watch(()=>[L?.view,L?.layer,L?.layer?.source,L?.layer?.parent],()=>this._updateLegend(g),K.initial);O.add(P,"legends");this.scheduleRender()})};y._hasLegend=function(G){return"legend"===
G?!0:Array.isArray(G)?G.includes("legend"):!1};y._attachToNode=function(G){G.appendChild(this)};y._updateLegend=function(G){G.set(this._getLegendOptions());this.scheduleRender()};y._getWidget=function(G){return"legend"===G?this._legend:l.isWidget(G)?G:null};y._getFirstWidget=function(){const {content:G}=this;if(Array.isArray(G)){let P=null;G.some(O=>{(O=this._getWidget(O))&&(P=O);return!!O});return P}return this._getWidget(G)};n._createClass(x,[{key:"className",get:function(){const {image:G}=this,
P=this._getFirstWidget();return this._get("className")||!G&&P?P.iconClass:""},set:function(G){this._override("className",G)}},{key:"disabled",get:function(){const {listItem:G,_legend:P,content:O}=this;return G?Array.isArray(O)&&1<O.length?!1:P?!P.activeLayerInfos?.length||!G.visibleAtCurrentScale:!1:!0},set:function(G){this._overrideIfSome("disabled",G)}},{key:"title",get:function(){const G=this._getFirstWidget();return this._get("title")||G?G.label:""},set:function(G){this._override("title",G)}}]);
return x}(u.IdentifiableMixin(k));e.__decorate([E.property()],u.prototype,"_legend",void 0);e.__decorate([E.property()],u.prototype,"className",null);e.__decorate([E.property()],u.prototype,"content",void 0);e.__decorate([E.property()],u.prototype,"disabled",null);e.__decorate([E.property()],u.prototype,"image",void 0);e.__decorate([E.property()],u.prototype,"listItem",void 0);e.__decorate([E.property()],u.prototype,"title",null);e.__decorate([E.property()],u.prototype,"open",void 0);e.__decorate([E.property()],
u.prototype,"visible",void 0);return u=e.__decorate([d.subclass("esri.widgets.LayerList.ListItemPanel")],u)})},"esri/widgets/support/SnappingControls/snappingLayerListUtils":function(){define(["exports","../../../core/maybe","../../LayerList/support/layerListUtils"],function(b,n,e){const H=E=>u(E)||K(E),u=E=>{if(!("type"in E))return!1;switch(E.type){case "feature":case "geojson":case "csv":case "graphics":case "wfs":case "map-notes":case "oriented-imagery":case "scene":case "building-scene":return!0;
default:return!1}},K=E=>{const h=e.getNormalizedChildLayerProperty(E);if(null!=h&&E.hasOwnProperty(h)&&n.isSome(E[h]))for(const t of E[h])if(H(t))return!0;return!1};b.isValidSnappingLayer=H;b.isValidSnappingLayerGroup=K;b.isValidSnappingLayerSource=u;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/SnappingControls/SnappingListItem":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Collection ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ../../LayerList/ListItem ../../LayerList/support/layerListUtils ./snappingLayerListUtils".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k,r){var l;b.SnappingListItem=l=function(p){function B(y){y=p.call(this,y)||this;y.children=new H;y.parent=null;return y}n._inheritsLoose(B,p);var x=B.prototype;x._initializeChildLayers=function(y){y&&(y=y.filter(r.isValidSnappingLayer),p.prototype._initializeChildLayers.call(this,y))};x._makeChildren=function(y){return y.map(G=>k.canDisplayLayer(G)?new l({layer:G,parent:this,view:this.view,getFeatureSnappingSources:this.getFeatureSnappingSources}):null).filter(u.isSome).reverse()};
n._createClass(B,[{key:"enabled",get:function(){return u.isSome(this.featureSource)?this.featureSource.enabled:!1}},{key:"featureSource",get:function(){const {layer:y,getFeatureSnappingSources:G}=this;return G().find(P=>P.layer===y)}}]);return B}(d);e.__decorate([K.property()],b.SnappingListItem.prototype,"children",void 0);e.__decorate([K.property()],b.SnappingListItem.prototype,"enabled",null);e.__decorate([K.property({constructOnly:!0})],b.SnappingListItem.prototype,"getFeatureSnappingSources",
void 0);e.__decorate([K.property()],b.SnappingListItem.prototype,"featureSource",null);e.__decorate([K.property()],b.SnappingListItem.prototype,"parent",void 0);b.SnappingListItem=l=e.__decorate([t.subclass("esri.widgets.support.SnappingControls.SnappingListItem")],b.SnappingListItem);Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/SketchTooltipControls/SketchTooltipControls":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ../../Widget ../widgetUtils ../decorators/messageBundle ../jsxFactory".split(" "),
function(b,n,e,H,u,K,E,h,t,d,k,r){n.SketchTooltipControls=function(l){function p(x){var y=l.call(this,x)||this;y.viewModel=null;y.iconClass="esri-icon-gear";y._onEnabledChange=G=>{y.tooltipOptions.enabled=G.target.checked};return y}e._inheritsLoose(p,l);var B=p.prototype;B.loadDependencies=function(){return Promise.all([new Promise((x,y)=>b(["../../../chunks/calcite-block"],x,y)),new Promise((x,y)=>b(["../../../chunks/calcite-label"],x,y)),new Promise((x,y)=>b(["../../../chunks/calcite-switch"],x,
y))])};B.render=function(){return r.tsx("div",{class:"esri-sketch-tooltip-controls"},r.tsx("calcite-block",{heading:"",open:!0},r.tsx("calcite-label",{layout:"inline-space-between"},this.messages?.enabledToggle,r.tsx("calcite-switch",{checked:this.tooltipOptions.enabled,onCalciteSwitchChange:this._onEnabledChange}))))};e._createClass(p,[{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(x){this._overrideIfSome("label",x)}}]);return p}(t);H.__decorate([u.property()],n.SketchTooltipControls.prototype,
"viewModel",void 0);H.__decorate([u.property()],n.SketchTooltipControls.prototype,"iconClass",void 0);H.__decorate([u.property()],n.SketchTooltipControls.prototype,"label",null);H.__decorate([u.property(),k.messageBundle("esri/widgets/support/SketchTooltipControls/t9n/SketchTooltipControls")],n.SketchTooltipControls.prototype,"messages",void 0);H.__decorate([u.property()],n.SketchTooltipControls.prototype,"tooltipOptions",void 0);n.SketchTooltipControls=H.__decorate([h.subclass("esri.widgets.Editor.components.SketchTooltipControls")],
n.SketchTooltipControls);Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../intl ../core/HandleOwner ../core/Logger ../core/maybe ../core/promiseUtils ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/arrayUtils ../core/accessorSupport/decorators/subclass ../layers/support/fieldUtils ./Attachments ./FeatureForm ./FeatureTemplates ./Spinner ./Widget ./Editor/deprecationUtils ./Editor/EditorViewModel ./FeatureTemplates/ItemList ./support/Heading ./support/SnappingControls ./support/decorators/accessibleHandler ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory ./support/widgetUtils ./support/SketchTooltipControls/SketchTooltipControls ../intl/substitute".split(" "),function(b,
n,e,H,u,K,E,h,t,d,k,r,l,p,B,x,y,G,P,O,L,g,c,a,v,Q,D,f,A,J,z){function N(m){m.focus()}const F={undoRedoButtons:!1,snappingControls:!0,snappingControlsElements:{header:!1,enabledToggle:!0,selfEnabledToggle:!0,featureEnabledToggle:!0,layerList:!0},sketchTooltipControls:!0},R=K.getLogger("esri.widgets.Editor");H=function(m){function C(w,U){var T=m.call(this,w,U)||this;T._featureForm=new x;T._attachments=new B({visibleElements:{addSubmitButton:!1,cancelAddButton:!1,cancelUpdateButton:!1,deleteButton:!1,
errorMessage:!1,progressBar:!1,updateButton:!1}});T._featureTemplates=new y({enableListScroll:!1});T._filterText="";T._prompt=null;T._spinner=new G;T.useDeprecatedCreateWorkflow=!1;T.headingLevel=4;T.iconClass="esri-icon-edit";T.messages=null;T.messagesCommon=null;T.messagesTemplates=null;T.supportingWidgetDefaults=null;T.viewModel=new L;T.visibleElements={...F};T.EditorPanel=({handleBack:S,heading:Y,headingLevel:ha,key:ja},...oa)=>{const {messagesCommon:ra,viewModel:ta,visibleElements:ua}=n._assertThisInitialized(T),
Aa=ta.sketchViewModel;return f.tsx("calcite-flow-item",{closable:!1,heading:Y,headingLevel:ha,key:ja,loading:ta.syncing||T._attachments.submitting,onCalciteFlowItemBack:S??void 0},f.tsx("div",{key:"panel-toolbar",class:"esri-editor__panel-toolbar"},T._renderSettings(),ua.undoRedoButtons&&[f.tsx("calcite-button",{key:"undo-button",label:ra.undo,appearance:"transparent",kind:"neutral",alignment:"center",iconStart:"undo",scale:"l",disabled:!Aa.canUndo(),onclick:Aa.undo.bind(Aa)},ra.undo),f.tsx("calcite-button",
{key:"redo-button",label:ra.redo,appearance:"transparent",kind:"neutral",alignment:"center",iconStart:"redo",scale:"l",disabled:!Aa.canRedo(),onclick:Aa.redo.bind(Aa)},ra.redo)]),...oa)};T._showDiscardWarning=()=>{const {messages:S}=n._assertThisInitialized(T),Y="create"===T.activeWorkflow?.type,ha=h.createDeferred();T._prompt={title:S[Y?"cancelAddTitle":"cancelEditTitle"],message:S[Y?"cancelAddWarningMessage":"cancelEditWarningMessage"],context:"danger",actions:{primary:{label:S[Y?"discardFeature":
"discardEdits"],action:()=>{ha.resolve();T._clearPrompt()}},secondary:{label:S[Y?"continueAdding":"continueEditing"],action:()=>{ha.reject();T._clearPrompt()}}}};return ha.promise};T._onAttachmentDeleteConfirm=n._asyncToGenerator(function*(){const S=T._attachments,{activeWorkflow:Y}=T.viewModel;Y&&("create-features"===Y.type?S.deleteFile():(yield S.deleteAttachment(S.viewModel.activeAttachmentInfo),T._clearPrompt()),yield Y.previous(),T._clearPrompt())});T._onAttachmentsError=S=>{T._prompt={title:T.messages.errorWarningTitle,
message:S.message,context:"warning",actions:{primary:{label:T.messagesCommon.form.ok,action:T._clearPrompt}}}};T._clearPrompt=()=>{T._prompt=null};T._onBack=T._onBack.bind(n._assertThisInitialized(T));T._onSave=T._onSave.bind(n._assertThisInitialized(T));T._onDelete=T._onDelete.bind(n._assertThisInitialized(T));T._onToggleUpdateWorkflow=T._onToggleUpdateWorkflow.bind(n._assertThisInitialized(T));T._onAttachmentAdd=T._onAttachmentAdd.bind(n._assertThisInitialized(T));T._onAttachmentUpdate=T._onAttachmentUpdate.bind(n._assertThisInitialized(T));
T._onAttachmentDelete=T._onAttachmentDelete.bind(n._assertThisInitialized(T));return T}n._inheritsLoose(C,m);var M=C.prototype;M.initialize=function(){var w=this;const U=()=>this.scheduleRender();this.addHandles([t.watch(()=>c.incrementHeadingLevel(this.headingLevel),T=>{this._featureForm.headingLevel=T;this._featureTemplates.headingLevel=T},t.initial),t.on(()=>this.viewModel.featureTemplatesViewModel,"select",function(){var T=n._asyncToGenerator(function*({item:S,oldItem:Y}){w.viewModel.activeWorkflow&&
(yield w.viewModel.cancelWorkflow());S&&S.id!==Y?.id&&(w.useDeprecatedCreateWorkflow?w.startCreateWorkflowAtFeatureCreation(S):w.startCreateFeaturesWorkflowAtFeatureCreation(S))});return function(S){return T.apply(this,arguments)}}()),t.watch(()=>this.viewModel.selectedTemplateItem,T=>this._featureTemplates.select(T,!1)),t.on(()=>this.viewModel.activeWorkflow,"cancel-request",({controller:T})=>{const {messages:S,messagesCommon:Y}=this;this._prompt={title:S.cancelRequestTitle,message:S.cancelRequestWarningMessage,
context:"danger",actions:{primary:{label:Y.form.yes,action:()=>{T.allow();this._clearPrompt()}},secondary:{label:Y.form.no,action:()=>{T.deny();this._clearPrompt()}}}}}),t.watch(()=>this.viewModel,T=>{this._featureForm.viewModel=T?.featureFormViewModel??null;this._attachments.viewModel=T?.attachmentsViewModel??null;this._featureTemplates.viewModel=T?.featureTemplatesViewModel??null;this._spinner.viewModel=T?.spinnerViewModel??null;T.showDiscardPrompt=this._showDiscardWarning},t.initial),t.watch(()=>
this.view,(T,S)=>{const Y=`editor-${this.id}-spinner`;S?.ui.remove(this._spinner,Y);T?.ui.add(this._spinner,{key:Y,position:"manual"})},t.initial),t.on(()=>this.viewModel?.sketchViewModel,"create",U),t.when(()=>this.supportingWidgetDefaults,T=>{this._featureForm.set(T.featureForm);this._attachments.set(T.attachments);this._featureTemplates.set(T.featureTemplates);this.viewModel.sketchViewModel.set(T.sketch)},t.initial),t.when(()=>this._attachments?.error,T=>this._onAttachmentsError(T)),t.when(()=>
this.viewModel?.failures,T=>{const {messages:S}=this,[{error:Y,retry:ha,cancel:ja}]=T;this._prompt={title:S.errorWarningTitle,message:z.substitute(S.errorWarningMessageTemplate,{errorMessage:Y.message}),context:"warning",actions:{primary:{label:S.retry,action:()=>{ha();this._clearPrompt()}},secondary:{label:S.ignore,action:()=>{ja();this._clearPrompt()}}}}}),t.watch(()=>this.viewModel?.state,T=>{switch(T){case "awaiting-feature-to-update":case "ready":case "disabled":this._filterText="",this._featureTemplates.filterText=
""}}),t.watch(()=>[this._attachments?.selectedFile,this._attachments?.submitting],U),t.watch(()=>this.viewModel.featureFormDisabled,T=>this._featureForm.disabled=T),t.on(()=>this.view,"key-down",T=>{"Escape"===T.key&&this.viewModel.back()})])};M.destroy=function(){this._attachments.destroy();this._featureForm.destroy();this._featureTemplates.destroy()};M.loadDependencies=function(){return Promise.all([new Promise((w,U)=>b(["../chunks/calcite-accordion-item"],w,U)),new Promise((w,U)=>b(["../chunks/calcite-accordion"],
w,U)),new Promise((w,U)=>b(["../chunks/calcite-button"],w,U)),new Promise((w,U)=>b(["../chunks/calcite-flow-item"],w,U)),new Promise((w,U)=>b(["../chunks/calcite-flow"],w,U)),new Promise((w,U)=>b(["../chunks/calcite-icon"],w,U)),new Promise((w,U)=>b(["../chunks/calcite-list-item"],w,U)),new Promise((w,U)=>b(["../chunks/calcite-list"],w,U)),new Promise((w,U)=>b(["../chunks/calcite-notice"],w,U)),new Promise((w,U)=>b(["../chunks/calcite-scrim"],w,U))])};M.castVisibleElements=function(w){return{...F,
...w,snappingControlsElements:{...F.snappingControlsElements,...w?.snappingControlsElements}}};M.startCreateWorkflowAtFeatureTypeSelection=function(){O.workflowDeprecation(R,"startCreateWorkflowAtFeatureTypeSelection","startCreateFeaturesWorkflowAtFeatureTypeSelection");return this.viewModel.startCreateWorkflowAtFeatureTypeSelection()};M.startCreateFeaturesWorkflowAtFeatureTypeSelection=function(){return this.viewModel.startCreateFeaturesWorkflowAtFeatureTypeSelection()};M.startCreateWorkflowAtFeatureCreation=
function(w){O.workflowDeprecation(R,"startCreateWorkflowAtFeatureCreation","startCreateFeaturesWorkflowAtFeatureCreation");return this.viewModel.startCreateWorkflowAtFeatureCreation(w)};M.startCreateFeaturesWorkflowAtFeatureCreation=function(w){return this.viewModel.startCreateFeaturesWorkflowAtFeatureCreation(w)};M.startCreateWorkflowAtFeatureEdit=function(w){O.workflowDeprecation(R,"startCreateWorkflowAtFeatureEdit");return this.viewModel.startCreateWorkflowAtFeatureEdit(w)};M.startUpdateWorkflowAtFeatureSelection=
function(){return this.viewModel.startUpdateWorkflowAtFeatureSelection()};M.startUpdateWorkflowAtMultipleFeatureSelection=function(w){return this.viewModel.startUpdateWorkflowAtMultipleFeatureSelection(w)};M.startUpdateWorkflowAtFeatureEdit=function(w){return this.viewModel.startUpdateWorkflowAtFeatureEdit(w)};M.deleteFeatureFromWorkflow=function(){return this.viewModel.deleteFeatureFromWorkflow()};M.cancelWorkflow=function(w){return this.viewModel.cancelWorkflow(w)};M.render=function(){const {viewModel:w}=
this;if(!w)return f.tsx("div",{class:"esri-editor esri-widget esri-widget--panel"});const {state:U}=w;return f.tsx("div",{class:"esri-editor esri-widget esri-widget--panel"},f.tsx("calcite-flow",null,w.pageStack.map(T=>this._renderPage(T,U)),this._renderPage(w.page,U)),this._renderPrompt())};M._renderPage=function(w,U){switch(w){case "ready":return this._renderLanding(U);case "awaiting-feature-creation-info":return this._renderTemplates(U);case "creating-features":return this._renderAttributeEditing(U);
case "editing-new-feature":case "editing-existing-feature":return this._renderAttributeEditing(U);case "awaiting-update-feature-candidate":return this._renderFeatureList(U);case "adding-attachment":return this._renderAttachmentAdding(U);case "editing-attachment":return this._renderAttachmentEditing(U)}return f.tsx("div",null)};M._renderTemplates=function(w){const {EditorPanel:U,headingLevel:T,messages:S,_onBack:Y}=this;return f.tsx(U,{active:this._isPanelActive(w),key:"templates-panel",handleBack:Y,
heading:S.selectTemplate,headingLevel:T},f.tsx("div",{class:"esri-editor__panel-content"},this._featureTemplates.render()))};M._renderAttributeEditing=function(w){const {activeWorkflow:U,EditorPanel:T,messages:S,messagesCommon:Y,headingLevel:ha,_onBack:ja,viewModel:oa}=this;if(!U)return null;var ra=U.type,ta=oa.featureFormViewModel;const ua="update"===ra&&!U.data.edits.modified||oa.syncing||ta.updating,Aa="update"===ra?S.editFeature:S.createFeatures,Z="update"===ra?Y.update:Y.create,da="create-features"===
ra&&"create-new"===U.createFeatureState;ra="create-features"===ra?U.numPendingFeatures:0;ra=1<ra?z.substitute(S.createFeaturesTemplate,{numFeatures:ra}):Z;const fa=U.shouldShowAttachments;ta=ta.inputFields.every(X=>!X.visible)&&!fa?this._renderMessage(z.substitute(S.clickToFinishTemplate,{button:Z})):f.tsx("div",{key:"panel-content-section",class:"esri-editor__panel-content__section"},this._renderOwnerAdminNoticeIfApplicable(U),f.tsx("div",{class:"esri-editor__panel-content__section__group"},this._featureForm.render(),
fa&&f.tsx("div",{key:"attachments"},f.tsx(c.Heading,{level:c.incrementHeadingLevel(ha)},S.attachments),this._attachments.render())));return f.tsx(T,{active:this._isPanelActive(w),key:"attribute-editing-panel",heading:Aa,headingLevel:ha,handleBack:ja},f.tsx("div",{key:"panel-content",class:this.classes("esri-editor__panel-content",{["esri-editor__panel-content__scrim-container"]:da})},ta,da&&f.tsx("calcite-scrim",null)),this._renderFooterActions([{clickHandler:this._onSave,disabled:ua,label:ra,type:"primary"},
oa.shouldShowDeleteButton?{...this._deleteButtonCommonInfo,clickHandler:this._onDelete,disabled:oa.syncing,label:Y.delete}:null]))};M._renderOwnerAdminNoticeIfApplicable=function(w){if(w?.reliesOnOwnerAdminPrivileges)return f.tsx("calcite-notice",{open:!0,kind:"info",scale:"s",class:"esri-editor__owner-admin-notice"},f.tsx("div",{slot:"message"},this.messages.ownerAdminNotice))};M._renderAttachmentAdding=function(w){const {_attachments:U,EditorPanel:T,_onBack:S,headingLevel:Y,messages:ha,messagesCommon:ja}=
this;return f.tsx(T,{active:this._isPanelActive(w),key:"attachment-adding-panel",heading:ha.addAttachment,headingLevel:Y,handleBack:S},f.tsx("div",{class:"esri-editor__panel-content"},U.render()),this._renderFooterActions([{label:U.submitting?ja.cancel:ja.add,disabled:U.submitting||!U.selectedFile,type:"primary",clickHandler:this._onAttachmentAdd}]))};M._renderAttachmentEditing=function(w){const {_attachments:U,EditorPanel:T,_onBack:S,activeWorkflow:Y,headingLevel:ha,messages:ja,messagesCommon:oa}=
this;return Y?f.tsx(T,{active:this._isPanelActive(w),key:"attachment-editing-panel",heading:ja.editAttachment,headingLevel:ha,handleBack:S},f.tsx("div",{class:"esri-editor__panel-content"},U.render()),Y.shouldAllowAttachmentEditing?this._renderFooterActions([{label:oa.update,disabled:U.submitting||!U.selectedFile,type:"primary",clickHandler:this._onAttachmentUpdate},{...this._deleteButtonCommonInfo,clickHandler:this._onAttachmentDelete,disabled:U.submitting,label:oa.delete}]):void 0):null};M._renderMessage=
function(w){return f.tsx("div",{key:"panel-content-message",class:"esri-editor__panel-content__message"},w)};M._renderFooterActions=function(w){return f.tsx("div",{key:"footer-actions",slot:"footer",class:"esri-editor__actions"},w.filter(E.isSome).map(({type:U,disabled:T,class:S,clickHandler:Y,label:ha,...ja},oa)=>f.tsx("calcite-button",{key:`action-${oa}`,slot:"footer-actions",class:S,disabled:T??!1,onclick:Y,width:"full",...ja},ha)))};M._renderPrompt=function(){var w=this._prompt;if(!w)return null;
const {title:U,message:T,context:S,actions:Y}=w;var ha=Y.secondary;let ja;switch(S){case "danger":ja="danger";break;case "info":ja="brand";break;default:ja="neutral"}w=f.tsx("calcite-button",{afterCreate:N,appearance:"solid",key:"prompt-primary-button",kind:ja,onclick:Y.primary.action,scale:"m",width:ha?"half":"full"},Y.primary.label);ha=ha&&f.tsx("calcite-button",{appearance:"outline",key:"prompt-secondary-button",kind:ja,onclick:ha.action,scale:"m",width:"half"},ha.label);return f.tsx("calcite-scrim",
null,f.tsx("div",{class:`${"esri-editor__prompt"}--${S}`},f.tsx("div",{class:"esri-editor__prompt__header"},f.tsx("calcite-icon",{icon:"exclamation-mark-triangle"}),f.tsx(c.Heading,{class:"esri-editor__prompt__header__heading",level:this.headingLevel},U)),f.tsx("div",{class:"esri-editor__prompt__message"},T),f.tsx("div",{class:"esri-editor__prompt__divider"}),f.tsx("div",{class:"esri-editor__prompt__actions"},ha,w)))};M._renderLanding=function(w){const {EditorPanel:U,headingLevel:T,messages:S,viewModel:Y}=
this,{canUpdate:ha}=Y,ja=this._featureTemplates.viewModel.numberOfFeatureTemplates,oa=!ha&&0===ja;return f.tsx(U,{active:this._isPanelActive(w),key:"landing-panel",heading:S.widgetLabel,headingLevel:T},f.tsx("div",{class:"esri-editor__panel-content"},ha&&f.tsx("div",{key:"edit-actions",class:"esri-editor__panel-content__section"},this._renderUpdateActions(w)),0<ja&&f.tsx("div",{key:"create-actions",class:"esri-editor__panel-content__section"},this._renderCreateActions()),oa&&f.tsx("div",{key:"no-content",
class:"esri-editor__panel-content__message"},S.noEditableLayers)),this._renderFooterHelpMessages())};M._renderFooterHelpMessages=function(){const {activeWorkflow:w,messages:U,view:T}=this;var S=w?.helpMessage;return(S=S?U["3d"===T?.type?"helpMessages3d":"helpMessages2d"]?.[S]:null)?f.tsx("div",{key:"footer-actions",slot:"footer",class:"esri-editor__help-message"},S):null};M._renderUpdateActions=function(w){const {messages:U,messagesCommon:T}=this;return f.tsx("div",{key:"update-actions"},f.tsx(c.Heading,
{level:c.incrementHeadingLevel(this.headingLevel)},U.editFeatures),f.tsx("calcite-list",{selectionMode:"single",selectionAppearance:"border"},f.tsx("calcite-list-item",{selected:"awaiting-feature-to-update"===w,label:T.select,onCalciteListItemSelect:this._onToggleUpdateWorkflow},f.tsx("calcite-icon",{icon:"cursor",slot:"content-start"}))))};M._renderCreateActions=function(){const {_featureTemplates:w,headingLevel:U,messages:T}=this;return f.tsx("div",{key:"create-actions"},f.tsx(c.Heading,{level:c.incrementHeadingLevel(U)},
T.createFeatures),f.tsx("div",{key:"templates",class:"esri-editor__feature-templates-container"},w.render()))};M._renderFeatureList=function(w){const {EditorPanel:U,_onBack:T,headingLevel:S,messages:Y,messagesTemplates:ha,viewModel:{activeWorkflow:ja,editableItems:oa}}=this;if("update"!==ja?.type)return null;var ra=ja.data.candidates;const ta=z.substitute(Y.multipleFeaturesTemplate,{total:ra.length}),ua=new Map;let Aa=0;ra.map(da=>({label:this._getLabel(da),id:da.attributes[da.layer.objectIdField],
data:da})).filter(da=>{const {label:fa,data:X}=da;da=this._filterText.toLowerCase();const {title:aa}=X.layer,ea=oa.find(ma=>ma.layer===X.layer);if(!ea)return null;const {attachmentsOnUpdateEnabled:ba,supports:ia}=ea;return(ia.includes("update")||ia.includes("delete")||ba)&&(!da||fa?.toLowerCase().includes(da)||aa?.toLowerCase().includes(da))}).filter(E.isSome).forEach(da=>{Aa++;const fa=da.data.layer;ua.has(fa)?ua.get(fa)?.items.push(da):ua.set(fa,{id:`${fa.id}`,label:fa.title??"",items:[da]})});
ra=oa.toArray().map(({layer:da})=>ua.get(da)).filter(E.isSome);const Z=10<Aa||0<this._filterText.length;return f.tsx(U,{active:this._isPanelActive(w),key:"feature-list",heading:ta,headingLevel:S,handleBack:T},f.tsx("div",{class:"esri-editor__panel-content"},f.tsx("div",{class:"esri-editor__panel-content__section"},g.ItemList({id:this.id,enableListScroll:!1,filterEnabled:Z,filterText:this._filterText,items:ra,messages:{filterPlaceholder:ha.filterPlaceholder,noItems:ha.noItems,noMatches:ha.noMatches},
onItemMouseEnter:da=>this.viewModel.selectFeature(da.data),onItemMouseLeave:()=>this.viewModel.selectFeature(null),onItemSelect:da=>this.viewModel.selectFeature(da.data,!0),onFilterChange:da=>this._filterText=da}))))};M._isPanelActive=function(w){return this.viewModel.state===w};M._renderSettings=function(){const w=this.visibleElements,U=w.snappingControls,T=w.sketchTooltipControls;return U||T?f.tsx("calcite-accordion",{class:"esri-editor__settings",appearance:"transparent"},f.tsx("calcite-accordion-item",
{heading:this.messagesCommon?.settings,iconStart:"gear"},T&&f.tsx(J.SketchTooltipControls,{tooltipOptions:this.tooltipOptions}),U&&f.tsx(a,{snappingOptions:this.snappingOptions,view:this.view,visibleElements:w.snappingControlsElements,afterCreate:S=>S.layerListOpen=!1}))):null};M._getLabel=function(w){var U=w.layer;if(!U)return null;const {objectIdField:T}=U;({attributes:w}=w);return(U=p.getDisplayFieldName(U))&&w[U]&&`${w[U]}`||z.substitute(this.messages.untitledFeatureTemplate,{id:w[T]})};M._onSave=
function(){this.viewModel.save()};M._onDelete=function(){const {messages:w,messagesCommon:U}=this;this._prompt={title:w.deleteWarningTitle,message:w.deleteWarningMessage,context:"danger",actions:{primary:{label:U.delete,action:()=>{this.deleteFeatureFromWorkflow();this._clearPrompt()}},secondary:{label:w.keepFeature,action:this._clearPrompt}}}};M._onToggleUpdateWorkflow=function(){var w=n._asyncToGenerator(function*(){const {viewModel:U}=this;U.canUpdate&&(U.activeWorkflow&&"awaiting-feature-to-update"===
U.state?yield U.cancelWorkflow():yield U.startUpdateWorkflowAtFeatureSelection())});return function(){return w.apply(this,arguments)}}();M._onBack=function(){var w=n._asyncToGenerator(function*(U){U?.stopPropagation();return this.viewModel.back()});return function(U){return w.apply(this,arguments)}}();M._onAttachmentAdd=function(){const {activeWorkflow:w}=this.viewModel;w&&("create-features"===w.type?(this._attachments.addFile(),w.previous()):this._attachments.addAttachment().then(()=>w.previous()))};
M._onAttachmentUpdate=function(){const {activeWorkflow:w}=this.viewModel;w&&("create-features"===w.type?(this._attachments.updateFile(),w.previous()):this._attachments.updateAttachment().then(()=>w.previous()))};M._onAttachmentDelete=function(){const {messages:w,messagesCommon:U}=this;this._prompt={title:w.deleteAttachmentWarningTitle,message:w.deleteAttachmentWarningMessage,context:"danger",actions:{primary:{label:U.delete,action:this._onAttachmentDeleteConfirm},secondary:{label:w.keepAttachment,
action:this._clearPrompt}}}};n._createClass(C,[{key:"_deleteButtonCommonInfo",get:function(){return{appearance:"outline",kind:"danger",type:"primary"}}},{key:"activeWorkflow",get:function(){return this.viewModel.activeWorkflow}},{key:"allowedWorkflows",get:function(){return this.viewModel.allowedWorkflows},set:function(w){this.viewModel.allowedWorkflows=w}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(w){this._overrideIfSome("label",w)}},{key:"labelOptions",get:function(){return this.viewModel.labelOptions},
set:function(w){this.viewModel.labelOptions=w}},{key:"layerInfos",get:function(){return this.viewModel.layerInfos},set:function(w){this.viewModel.layerInfos=w}},{key:"snappingOptions",get:function(){return this.viewModel.snappingOptions},set:function(w){this.viewModel.snappingOptions=w}},{key:"tooltipOptions",get:function(){return this.viewModel.tooltipOptions},set:function(w){this.viewModel.tooltipOptions=w}},{key:"view",get:function(){return this.viewModel.view},set:function(w){this.viewModel.view=
w}}]);return C}(u.HandleOwnerMixin(P));e.__decorate([d.property()],H.prototype,"_featureForm",void 0);e.__decorate([d.property()],H.prototype,"_attachments",void 0);e.__decorate([d.property()],H.prototype,"_featureTemplates",void 0);e.__decorate([d.property()],H.prototype,"_filterText",void 0);e.__decorate([d.property()],H.prototype,"_prompt",void 0);e.__decorate([d.property()],H.prototype,"_spinner",void 0);e.__decorate([d.property()],H.prototype,"_deleteButtonCommonInfo",null);e.__decorate([d.property({readOnly:!0})],
H.prototype,"activeWorkflow",null);e.__decorate([d.property()],H.prototype,"allowedWorkflows",null);e.__decorate([d.property()],H.prototype,"useDeprecatedCreateWorkflow",void 0);e.__decorate([d.property()],H.prototype,"headingLevel",void 0);e.__decorate([d.property()],H.prototype,"iconClass",void 0);e.__decorate([d.property()],H.prototype,"label",null);e.__decorate([d.property()],H.prototype,"labelOptions",null);e.__decorate([d.property()],H.prototype,"layerInfos",null);e.__decorate([d.property(),
Q.messageBundle("esri/widgets/Editor/t9n/Editor")],H.prototype,"messages",void 0);e.__decorate([d.property(),Q.messageBundle("esri/t9n/common")],H.prototype,"messagesCommon",void 0);e.__decorate([d.property(),Q.messageBundle("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],H.prototype,"messagesTemplates",void 0);e.__decorate([d.property()],H.prototype,"snappingOptions",null);e.__decorate([d.property()],H.prototype,"tooltipOptions",null);e.__decorate([d.property()],H.prototype,"supportingWidgetDefaults",
void 0);e.__decorate([d.property()],H.prototype,"view",null);e.__decorate([d.property(),D.vmEvent(["workflow-cancel","workflow-commit"])],H.prototype,"viewModel",void 0);e.__decorate([d.property()],H.prototype,"visibleElements",void 0);e.__decorate([k.cast("visibleElements")],H.prototype,"castVisibleElements",null);e.__decorate([v.accessibleHandler()],H.prototype,"_onSave",null);e.__decorate([v.accessibleHandler()],H.prototype,"_onDelete",null);e.__decorate([v.accessibleHandler()],H.prototype,"_onToggleUpdateWorkflow",
null);e.__decorate([v.accessibleHandler()],H.prototype,"_onBack",null);e.__decorate([v.accessibleHandler()],H.prototype,"_onAttachmentAdd",null);e.__decorate([v.accessibleHandler()],H.prototype,"_onAttachmentUpdate",null);e.__decorate([v.accessibleHandler()],H.prototype,"_onAttachmentDelete",null);return H=e.__decorate([l.subclass("esri.widgets.Editor")],H)});