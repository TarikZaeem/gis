// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.26/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Legend/LegendViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../intl ../../core/Accessor ../../core/Collection ../../core/Handles ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass ./support/ActiveLayerInfo ../../intl/locale".split(" "),function(A,H,J,B,q,L,N,w,O,r,c,a,h){const e=q.ofType(a),t="esri.layers.BuildingSceneLayer esri.layers.CSVLayer esri.layers.FeatureLayer esri.layers.GeoJSONLayer esri.layers.GeoRSSLayer esri.layers.GroupLayer esri.layers.HeatmapLayer esri.layers.ImageryLayer esri.layers.ImageryTileLayer esri.layers.MapImageLayer esri.layers.OGCFeatureLayer esri.layers.PointCloudLayer esri.layers.StreamLayer esri.layers.SceneLayer esri.layers.SubtypeGroupLayer esri.layers.TileLayer esri.layers.VoxelLayer esri.layers.WFSLayer esri.layers.WMSLayer esri.layers.WMTSLayer esri.layers.WCSLayer esri.layers.LinkChartLayer esri.layers.knowledgeGraph.KnowledgeGraphSubLayer".split(" "),
n=["view.basemapView.baseLayerViews","view.groundView.layerViews","view.layerViews","view.basemapView.referenceLayerViews"];J=function(K){function S(u){u=K.call(this,u)||this;u._handles=new L;u._layerViewByLayerId={};u._layerInfosByLayerViewId={};u._activeLayerInfosByLayerViewId={};u._activeLayerInfosWithNoParent=new q;u.activeLayerInfos=new e;u.basemapLegendVisible=!1;u.groundLegendVisible=!1;u.hideLayersNotInCurrentView=!1;u.keepCacheOnDestroy=!1;u.respectLayerVisibility=!0;u.layerInfos=[];u.view=
null;return u}A._inheritsLoose(S,K);var D=S.prototype;D.initialize=function(){this._handles.add(N.watch(()=>this.view,()=>this._viewHandles(),N.initial),"view");this._handles.add(h.onLocaleChange(()=>this._refresh()))};D.destroy=function(){this._destroyViewActiveLayerInfos();this._handles.destroy();this.view=this._handles=null};D._viewHandles=function(){this._handles.remove("state");this.view&&this._handles.add(N.watch(()=>this.state,()=>this._stateHandles(),N.initial),"state")};D._stateHandles=function(){this._resetAll();
"ready"===this.state&&this._watchPropertiesAndAllLayerViews()};D._resetAll=function(){this._handles.remove(["all-layer-views","legend-properties"]);this._destroyViewActiveLayerInfos();this.activeLayerInfos.removeAll()};D._destroyViewActiveLayerInfos=function(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)};D._destroyViewActiveLayerInfo=function(u){this._handles.remove(u);const f=this._activeLayerInfosByLayerViewId[u];delete this._activeLayerInfosByLayerViewId[u];
f&&f.parent&&f.parent.children.remove(f)};D._watchPropertiesAndAllLayerViews=function(){const {allLayerViews:u}=this.view;u.length&&this._refresh();this._handles.add(u.on("change",f=>this._allLayerViewsChangeHandle(f)),"all-layer-views");this._handles.add(N.watch(()=>[this.layerInfos,this.basemapLegendVisible,this.groundLegendVisible],()=>this._propertiesChangeHandle()),"legend-properties")};D._allLayerViewsChangeHandle=function(u){u.removed.forEach(f=>this._destroyViewActiveLayerInfo(f.uid));this._refresh()};
D._propertiesChangeHandle=function(){this._destroyViewActiveLayerInfos();this._refresh()};D._refresh=function(){this._layerInfosByLayerViewId={};this.activeLayerInfos.removeAll();this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,this).forEach(this._generateActiveLayerInfo,this);this._sortActiveLayerInfos(this.activeLayerInfos)};D._sortActiveLayerInfos=function(u){if(!(2>u.length)){var f=[];u.forEach(F=>{if(!F.parent){var k=F.layer.parent;
(k=(k=k&&"uid"in k&&this._layerViewByLayerId[k.uid])&&this._activeLayerInfosByLayerViewId[k.uid])&&u.includes(k)&&(f.push(F),F.parent=k,k.children.add(F),this._sortActiveLayerInfos(k.children))}});u.removeMany(f);var p={};this.view.allLayerViews.forEach((F,k)=>p[F.layer.uid]=k);u.sort((F,k)=>(p[k.layer.uid]||0)-(p[F.layer.uid]||0))}};D._generateLayerViews=function(){const u=[];n.filter(this._filterLayerViews,this).map(this.get,this).filter(f=>null!=f).forEach(this._collectLayerViews("layerViews",
u));return u};D._filterLayerViews=function(u){const f=!this.groundLegendVisible&&"view.groundView.layerViews"===u;return!(!this.basemapLegendVisible&&("view.basemapView.baseLayerViews"===u||"view.basemapView.referenceLayerViews"===u))&&!f};D._collectLayerViews=function(u,f){const p=F=>{F&&F.forEach(k=>{f.push(k);p(k[u])});return f};return p};D._filterLayerViewsByLayerInfos=function(u){const f=this.layerInfos;return f&&f.length?f.some(p=>this._hasLayerInfo(p,u)):!0};D._hasLayerInfo=function(u,f){const p=
this._isLayerUIDMatching(u.layer,f.layer.uid);p&&(this._layerInfosByLayerViewId[f.uid]=u);return p};D._isLayerUIDMatching=function(u,f){return u&&(u.uid===f||this._hasLayerUID(u.layers,f))};D._hasLayerUID=function(u,f){return u&&u.some(p=>this._isLayerUIDMatching(p,f))};D._isLayerViewSupported=function(u){return t.includes(u.layer.declaredClass)?(this._layerViewByLayerId[u.layer.uid]=u,!0):!1};D._generateActiveLayerInfo=function(u){this._isLayerActive(u)?this._buildActiveLayerInfo(u):(this._handles.remove(u.uid),
this._handles.add(N.watch(()=>[u.legendEnabled,u.layer?.legendEnabled],()=>this._layerActiveHandle(u)),u.uid))};D._layerActiveHandle=function(u){this._isLayerActive(u)&&(this._handles.remove(u.uid),this._buildActiveLayerInfo(u))};D._isLayerActive=function(u){return this.respectLayerVisibility?u.legendEnabled&&u.get("layer.legendEnabled"):!0};D._buildActiveLayerInfo=function(u){const f=u.layer,p=u.uid;var F=this._layerInfosByLayerViewId[p];let k=this._activeLayerInfosByLayerViewId[p];k||(k=new a({layer:f,
layerView:u,title:F&&void 0!==F.title&&F.layer.uid===f.uid?F.title:f.title,view:this.view,respectLayerVisibility:this.respectLayerVisibility,hideLayersNotInCurrentView:this.hideLayersNotInCurrentView,keepCacheOnDestroy:this.keepCacheOnDestroy,sublayerIds:F&&F.sublayerIds||[]}),this._activeLayerInfosByLayerViewId[p]=k);k.parent=this._activeLayerInfosByLayerViewId[(f.parent&&"uid"in f.parent&&this._layerViewByLayerId[f.parent?.uid])?.uid];if(!this._handles.has(p)){F=N.watch(()=>f.title,x=>this._titleHandle(x,
k));var g=N.watch(()=>[f.opacity,"renderer"in f&&f.renderer,"pointSymbol"in f&&f.pointSymbol,"lineSymbol"in f&&f.lineSymbol,"polygonSymbol"in f&&f.polygonSymbol],()=>this._constructLegendElements(k)),C=N.when(()=>!0===this.view?.stationary,()=>this._scaleHandle(k),N.initial);const R=N.watch(()=>u._effectiveRenderer,()=>this._constructLegendElements(k)),T=N.watch(()=>"effect"in f&&f.effect,()=>this._constructLegendElements(k));F=[F,g,C,R,T];this.respectLayerVisibility&&(g=N.watch(()=>u.legendEnabled,
x=>this._legendEnabledHandle(x,k)),C=N.watch(()=>f.legendEnabled,x=>this._legendEnabledHandle(x,k)),F.push(g,C));this._handles.add(F,p)}k.isScaleDriven||this._constructLegendElements(k);this._addActiveLayerInfo(k)};D._titleHandle=function(u,f){f.title=u;this._constructLegendElements(f)};D._legendEnabledHandle=function(u,f){u?this._addActiveLayerInfo(f):this._removeActiveLayerInfo(f)};D._scaleHandle=function(u){(u.isScaleDriven||u.hideLayersNotInCurrentView)&&this._constructLegendElements(u)};D._addActiveLayerInfo=
function(u){const {layerView:f,layer:p}=u;if(this._isLayerActive(f)&&!this.activeLayerInfos.includes(u)){var F=u.parent;F?(F.children.includes(u)||F.children.push(u),this._sortActiveLayerInfos(F.children)):(F=this.layerInfos?.some(k=>k.layer.uid===p.uid),p.parent&&"uid"in p.parent&&!F?this._activeLayerInfosWithNoParent.add(u):(this.activeLayerInfos.add(u),this._sortActiveLayerInfos(this.activeLayerInfos)));if(this._activeLayerInfosWithNoParent.length){const k=[];this._activeLayerInfosWithNoParent.forEach(g=>
{var C=g.layer.parent;if(C=this._activeLayerInfosByLayerViewId[(C&&"uid"in C&&this._layerViewByLayerId[C?.uid])?.uid])k.push(g),g.parent=C});k.length&&(this._activeLayerInfosWithNoParent.removeMany(k),k.forEach(g=>this._addActiveLayerInfo(g)))}}};D._removeActiveLayerInfo=function(u){const f=u.parent;f?f.children.remove(u):this.activeLayerInfos.remove(u)};D._constructLegendElements=function(u){const f=u.layer;"featureCollections"in f&&f.featureCollections?u.buildLegendElementsForFeatureCollections(f.featureCollections):
"featureReduction"in f&&f.featureReduction&&"renderer"in f.featureReduction&&("binning"===f.featureReduction.type||"cluster"===f.featureReduction.type)?u.buildLegendElementsForFeatureReduction(f.featureReduction):"renderer"in f&&f.renderer&&!("sublayers"in f)?u.buildLegendElementsForRenderer(f.renderer):"url"in f&&f.url?u.buildLegendElementsForTools():u.children.forEach(p=>this._constructLegendElements(p))};A._createClass(S,[{key:"state",get:function(){return this.get("view.ready")?"ready":"disabled"}}]);
return S}(B);H.__decorate([w.property({type:e})],J.prototype,"activeLayerInfos",void 0);H.__decorate([w.property()],J.prototype,"basemapLegendVisible",void 0);H.__decorate([w.property()],J.prototype,"groundLegendVisible",void 0);H.__decorate([w.property()],J.prototype,"hideLayersNotInCurrentView",void 0);H.__decorate([w.property()],J.prototype,"keepCacheOnDestroy",void 0);H.__decorate([w.property()],J.prototype,"respectLayerVisibility",void 0);H.__decorate([w.property()],J.prototype,"layerInfos",
void 0);H.__decorate([w.property({readOnly:!0})],J.prototype,"state",null);H.__decorate([w.property()],J.prototype,"view",void 0);return J=H.__decorate([c.subclass("esri.widgets.Legend.LegendViewModel")],J)})},"esri/widgets/Legend/support/ActiveLayerInfo":function(){define("require ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Color ../../../kernel ../../../request ../../../symbols ../../../core/Accessor ../../../core/Collection ../../../core/Handles ../../../core/jsonMap ../../../core/Logger ../../../core/maybe ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/screenUtils ../../../core/urlUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/PropertyOrigin ../../../layers/effects/EffectView ../../../layers/effects/jsonUtils ../../../layers/support/ExportImageParameters ../../../layers/support/fieldUtils ../../../layers/support/rasterFormats/pixelRangeUtils ../../../renderers/support/jsonUtils ../../../renderers/support/rendererConversion ../../../renderers/visualVariables/support/SizeVariableLegendOptions ../../../symbols/support/cimSymbolUtils ../../../symbols/support/previewUtils ../../../symbols/support/renderUtils ../../../symbols/support/symbolUtils ../../../symbols/support/utils ./clusterUtils ./colorRampUtils ./heatmapRampUtils ./relationshipRampUtils ./sizeRampUtils ./utils ../../smartMapping/support/utils ../../../symbols/SimpleMarkerSymbol ../../../symbols/SimpleFillSymbol".split(" "),
function(A,H,J,B,q,L,N,w,O,r,c,a,h,e,t,n,K,S,D,u,f,p,F,k,g,C,R,T,x,P,l,z,W,M,d,y,E,V,ba,aa,G,Q,Y,ca){function ia(wa){return"esri.renderers.SimpleRenderer"===wa.declaredClass}function ka(wa){return"esri.renderers.ClassBreaksRenderer"===wa.declaredClass}function ja(wa){return"esri.renderers.UniqueValueRenderer"===wa.declaredClass}function la(wa){return"esri.renderers.HeatmapRenderer"===wa.declaredClass}function ta(wa){return"esri.renderers.PointCloudClassBreaksRenderer"===wa.declaredClass}function ea(wa){return"esri.renderers.PointCloudStretchRenderer"===
wa.declaredClass}function sa(wa){return"esri.renderers.PointCloudUniqueValueRenderer"===wa.declaredClass}function na(wa){return"esri.renderers.DotDensityRenderer"===wa.declaredClass}function pa(wa){return"esri.renderers.PieChartRenderer"===wa.declaredClass}function qa(wa){return"esri.layers.SubtypeGroupLayer"===wa.declaredClass}function za(wa){wa="authoringInfo"in wa&&wa?.authoringInfo;return"univariate-color-size"===wa?.type&&"above-and-below"===wa?.univariateTheme}const xa=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,
Ea=new c.JSONMap({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),Da=new Y({size:6,outline:{color:[128,128,128,.5],width:.5}}),Za=new ca({style:"solid"}),$a=new Y({style:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15",size:15,outline:{width:1,color:[85,85,85,1]}});let Ga={};N=function(wa){function Oa(m){m=wa.call(this,m)||this;m._handles=new r;m._hasColorRamp=!1;m._hasOpacityRamp=!1;m._hasSizeRamp=
!1;m._webStyleSymbolCache=new Map;m._dotDensityUrlCache=new Map;m._scaleDrivenSizeVariable=null;m._hasClusterSizeVariable=!1;m.children=new O;m.layerView=null;m.layer=null;m.legendElements=[];m.parent=null;m.hideLayersNotInCurrentView=!1;m.keepCacheOnDestroy=!1;m.respectLayerVisibility=!0;m.sublayerIds=[];m.title=null;m.view=null;return m}H._inheritsLoose(Oa,wa);var fa=Oa.prototype;fa.initialize=function(){const m=()=>this.notifyChange("ready");this._handles.add([t.on(()=>this.children,"change",b=>
{const {added:v,removed:I}=b,X=this._handles;v.forEach(U=>{const Z=`activeLayerInfo-ready-watcher-${U.layer.uid}`;X.add(t.watch(()=>U.ready,m,t.initial),Z)});I.forEach(U=>X.remove(U.layer.uid));m()})]);this.keepCacheOnDestroy||(Ga={})};fa.destroy=function(){this._handles.destroy();this._scaleDrivenSizeVariable=this._dotDensityUrlCache=this._webStyleSymbolCache=this._handles=null;this.keepCacheOnDestroy||(Ga=null)};fa.buildLegendElementsForFeatureCollections=function(){var m=H._asyncToGenerator(function*(b){if(this.hideLayersNotInCurrentView&&
!(yield this._isLayerInCurrentView()))this.legendElements=[],this.notifyChange("ready");else{b=Array.from(b,v=>{if("esri.layers.FeatureLayer"===v.declaredClass)return this._getRendererLegendElements(v.renderer,{title:v.title});if(v.featureSet&&v.featureSet.features.length){var I=v.layerDefinition,X=I&&I.drawingInfo;X=X&&T.fromJSON(X.renderer);I=Ea.read(I.geometryType);return X?this._getRendererLegendElements(X,{title:v.name,geometryType:I}):(a.getLogger(this.declaredClass).warn("drawingInfo not available!"),
null)}return null});try{const v=[];yield e.eachAlways(b).then(I=>{I.forEach(({value:X})=>X&&v.push(...X))});this.legendElements=v;this.notifyChange("ready")}catch(v){a.getLogger(this.declaredClass).warn("error while building legend for layer!",v)}}});return function(b){return m.apply(this,arguments)}}();fa.buildLegendElementsForRenderer=function(){var m=H._asyncToGenerator(function*(b){try{this.legendElements=(this.hideLayersNotInCurrentView?yield this._isLayerInCurrentView():1)?yield this._getRendererLegendElements(b):
[],this.notifyChange("ready")}catch(v){a.getLogger(this.declaredClass).warn("error while building legend for layer!",v)}});return function(b){return m.apply(this,arguments)}}();fa.buildLegendElementsForFeatureReduction=function(){var m=H._asyncToGenerator(function*(b){try{this.legendElements=(this.hideLayersNotInCurrentView?yield this._isLayerInCurrentView():1)?yield this._getLegendElementsForFeatureReduction(b):[],this.notifyChange("ready")}catch(v){a.getLogger(this.declaredClass).warn("error while building legend for layer!",
v)}});return function(b){return m.apply(this,arguments)}}();fa.buildLegendElementsForTools=function(){var m=H._asyncToGenerator(function*(){var b=this;const v=this.layer;if("esri.layers.VoxelLayer"===v.declaredClass)this._constructLegendElementsForVoxellayer();else if("esri.layers.WMTSLayer"===v.declaredClass)this._constructLegendElementsForWMTSlayer();else if("esri.layers.WMSLayer"===v.declaredClass)yield this._constructLegendElementsForWMSSublayers();else if("esri.layers.BuildingSceneLayer"===v.declaredClass)yield this._constructLegendElementsForBuildingSceneLayer();
else if("esri.layers.MapImageLayer"===v.declaredClass||"esri.layers.TileLayer"===v.declaredClass||qa(v))yield this._constructLegendElementsForSublayers();else{this._handles.remove("imageryLayers-watcher");var I="default";if("esri.layers.ImageryLayer"===v.declaredClass){I=v?.renderingRule?.functionName||"default";const X=v.bandIds?.length?v.bandIds.join(""):"###";I=I+"_"+X}yield this._getLegendLayers(`${v.uid}-${I}`).then(function(){var X=H._asyncToGenerator(function*(U){b.legendElements=[];b.notifyChange("ready");
U=U.map(function(){var Z=H._asyncToGenerator(function*(da){if("esri.layers.ImageryLayer"===v.declaredClass||"esri.layers.ImageryTileLayer"===v.declaredClass){const oa=t.watch(()=>["renderingRule"in v&&v.renderingRule,v.bandIds],()=>e.debounce(H._asyncToGenerator(function*(){Ga["default"]=null;v.renderer?yield b.buildLegendElementsForRenderer(v.renderer):yield b.buildLegendElementsForTools()}))());b._handles.add(oa,"imageryLayers-watcher")}(da=b._generateSymbolTableElementForLegendLayer(da))&&da.infos.length&&
("esri.layers.ImageryLayer"===v.declaredClass&&(da.title=v.title),b.legendElements.push(da));b.notifyChange("ready")});return function(da){return Z.apply(this,arguments)}}());yield e.eachAlways(U)});return function(U){return X.apply(this,arguments)}}()).catch(X=>{a.getLogger(this.declaredClass).warn("Request to server for legend has failed!",X)})}});return function(){return m.apply(this,arguments)}}();fa._isLayerInCurrentView=function(){var m=H._asyncToGenerator(function*(){const b=this.layer,v=this.layerView,
I=v&&"createQuery"in v&&"queryFeatureCount"in v;if(!(I||v&&"createQuery"in b&&"queryFeatureCount"in b))return!0;yield t.whenOnce(()=>!v.updating);const X=I?"createQuery"in v&&v.createQuery():"createQuery"in b&&b.createQuery();X.geometry=this.view.extent;return 0!==(I?"queryFeatureCount"in v&&(yield v.queryFeatureCount(X)):"queryFeatureCount"in b&&(yield b.queryFeatureCount(X)))});return function(){return m.apply(this,arguments)}}();fa._getParentLayerOpacity=function(m){let b=1;const v=m.parent;v&&
"uid"in v&&(b=this._getParentLayerOpacity(v));return m.opacity*b};fa._isGroupActive=function(){const m=this.children;return m.length?m.some(b=>b.ready):!1};fa._isRendererScaleDriven=function(m){return"dot-density"===m.type||xa.test("valueExpression"in m&&m.valueExpression)?!0:(m="visualVariables"in m&&m.visualVariables)?m.some(b=>this._isScaleDrivenSizeVariable(b)):!1};fa._isScaleDrivenSizeVariable=function(m){if(m&&"size"!==m.type)return!1;const b=m.minSize,v=m.maxSize;return"object"===typeof b&&
b?this._isScaleDrivenSizeVariable(b):"object"===typeof v&&v?this._isScaleDrivenSizeVariable(v):!!m.expression||xa.test(m.valueExpression)};fa._isLayerScaleDriven=function(m){if("minScale"in m&&0<m.minScale||"maxScale"in m&&0<m.maxScale)return!0;if("sublayers"in m&&m.sublayers)return m.sublayers.some(v=>this._isLayerScaleDriven(v));const b=m.parent;if(!1===m.loaded&&b&&"esri.layers.MapImageLayer"===b.declaredClass&&"source"in m&&m.source&&"map-layer"===m.source.type)for(const v of b.sourceJSON.layers)if(v.id===
m.source.mapLayerId&&(0<v.minScale||0<v.maxScale))return!0;return!1};fa._constructLegendElementsForVoxellayer=function(){var m=H._asyncToGenerator(function*(){this.legendElements=[];this._handles.remove("voxel-style-watcher");this._handles.remove("voxel-current-variable");const b=this.layer;this._handles.add(t.watch(()=>b.currentVariableId,()=>this._constructLegendElementsForVoxellayer()),"voxel-current-variable");this._handles.add(t.watch(()=>b.getVariableStyles(),()=>this._constructLegendElementsForVoxellayer()),
"voxel-style-watcher");var v=h.unwrap(b.getVariableStyle(null));const I=[];if(v)if(v.uniqueValues?.length){const U=[];v.uniqueValues.forEach(Z=>{Z.enabled&&U.push({label:Z.label||`${Z.value}`,value:Z.value,symbol:new ca({color:Z.color,outline:null})})});U.length&&I.push({type:"symbol-table",title:v.label,infos:U})}else if(v.transferFunction){const {colorStops:U,stretchRange:Z}=v.transferFunction,da=U.toArray().reverse(),oa=Z.map((Ba,ha)=>`${0===ha?G.SPECIAL_CHARS_LESS_THAN:G.SPECIAL_CHARS_GREATER_THAN} ${Q.formatNumberLabel(Ba)}`).reverse(),
va=da.map(Ba=>({color:Ba.color,value:null,label:null}));va[0].label=oa[0];va[va.length-1].label=oa[1];I.push({type:"color-ramp",title:v.label,infos:va,preview:M.renderColorRampPreviewHTML(da.map(Ba=>Ba.color))})}const X=b.opacity;v=I.reduce((U,Z)=>U.concat(this._getAllInfos(Z)),[]).filter(U=>!!U?.symbol).map(U=>this._getSymbolPreview(U,X));yield e.eachAlways(v);this.legendElements=I;this.notifyChange("ready")});return function(){return m.apply(this,arguments)}}();fa._constructLegendElementsForWMTSlayer=
function(){this.legendElements=[];this._handles.remove("wmts-activeLayer-watcher");const m=this.layer.activeLayer;this._handles.add(t.watch(()=>{const {layer:b}=this;return b&&"activeLayer"in b&&b.activeLayer},()=>this._constructLegendElementsForWMTSlayer()),"wmts-activeLayer-watcher");if(m.styleId&&m.styles){let b=null;m.styles.some(v=>m.styleId===v.id?(b=v.legendUrl,!0):!1);b&&(this.legendElements=[{type:"symbol-table",title:m.title,infos:[{src:b,opacity:this.opacity}]}])}this.notifyChange("ready")};
fa._constructLegendElementsForWMSSublayers=function(){var m=H._asyncToGenerator(function*(){this.legendElements=[];this._handles.remove("wms-sublayers-watcher");const b=this.layer;let v=null;if(b.customParameters||b.customLayerParameters)v={...b.customParameters,...b.customLayerParameters};this._handles.add(t.watch(()=>{const {layer:I}=this;return I&&"sublayers"in I&&I.sublayers},()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher");this.legendElements=yield this._generateLegendElementsForWMSSublayers(b.sublayers,
v);this.notifyChange("ready")});return function(){return m.apply(this,arguments)}}();fa._generateLegendElementsForWMSSublayers=function(){var m=H._asyncToGenerator(function*(b,v){const I=[];this._handles.add(b.on("change",()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher");b=b.toArray();for(const X of b)b=t.watch(()=>[X.title,X.visible,X.legendEnabled],()=>this._constructLegendElementsForWMSSublayers()),this._handles.add(b,"wms-sublayers-watcher"),(!this.respectLayerVisibility||
X.visible&&X.legendEnabled)&&(b=yield this._generateSymbolTableElementForWMSSublayer(X,v))&&b.infos.length&&I.unshift(b);return I});return function(b,v){return m.apply(this,arguments)}}();fa._generateSymbolTableElementForWMSSublayer=function(){var m=H._asyncToGenerator(function*(b,v){return!b.legendUrl&&b.sublayers?(v=(yield this._generateLegendElementsForWMSSublayers(b.sublayers,v)).filter(I=>I),{type:"symbol-table",title:b.title,infos:v}):this._generateSymbolTableElementForLegendUrl(b,v)});return function(b,
v){return m.apply(this,arguments)}}();fa._generateSymbolTableElementForLegendUrl=function(){var m=H._asyncToGenerator(function*(b,v){let I=b.legendUrl;if(I){var X={type:"symbol-table",title:b.title||b.name||b.id&&b.id+"",infos:[]};v&&(I=K.addQueryParameters(I,v));v=null;b=b.layer?.opacity;try{if(v=(yield L(I,{responseType:"image"})).data)v.style.opacity=b}catch{}X.infos.push({src:I,preview:v,opacity:b});return X}});return function(b,v){return m.apply(this,arguments)}}();fa._getLegendLayers=function(m,
b){const v=Ga&&Ga[m];return v?Promise.resolve(v):this._legendRequest(b).then(I=>{I=I.layers;return Ga[m]=I})};fa._legendRequest=function(m){var b=this.layer;m={f:"json",dynamicLayers:m};if("esri.layers.ImageryLayer"===b.declaredClass){var v=b.exportImageServiceParameters.renderingRule;v&&(m.renderingRule=JSON.stringify(v.rasterFunctionDefinition||v.toJSON()));b.bandIds&&(m.bandIds=b.bandIds.join());if(b.raster||b.viewId||b.customParameters){const {raster:I,viewId:X,customParameters:U}=b;m={raster:I,
viewId:X,...m,...U}}}v=b.url.replace(/(\/)+$/,"");"version"in b&&10.01<=b.version?(b=v.indexOf("?"),v=-1<b?v.substring(0,b)+"/legend"+v.substring(b):v+"/legend"):(b=v.toLowerCase().indexOf("/rest/"),b=v.substring(0,b)+v.substring(b+5,v.length),v="https://utility.arcgis.com/sharing/tools/legend?soapUrl\x3d"+encodeURI(b)+"\x26returnbytes\x3dtrue");return L(v,{query:m}).then(I=>I.data)};fa._constructLegendElementsForBuildingSceneLayer=function(){var m=H._asyncToGenerator(function*(){this.legendElements=
[];this._handles.remove("sublayers-watcher");const b=this.layer;this._handles.add(t.watch(()=>b.sublayers,()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");try{this.legendElements=yield this._generateLegendElementsForBuildingSublayers(b.sublayers,this.opacity),this.notifyChange("ready")}catch(v){a.getLogger(this.declaredClass).warn("Request to server for legend has failed!",v)}});return function(){return m.apply(this,arguments)}}();fa._generateLegendElementsForBuildingSublayers=
function(){var m=H._asyncToGenerator(function*(b,v){let I=[];this._handles.add(b.on("change",()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");b=b.toArray();for(const U of b)if(b=t.watch(()=>["renderer"in U&&U.renderer,U.opacity,U.title,U.visible],()=>this._constructLegendElementsForBuildingSceneLayer()),this._handles.add(b,"sublayers-watcher"),!this.respectLayerVisibility||U.visible){b=U&&null!=U.opacity?U.opacity:null;var X=null!=b?b*v:v;"building-group"===U.type?(b=
{type:"symbol-table",title:U.title,infos:[]},X=yield this._generateLegendElementsForBuildingSublayers(U.sublayers,X),b.infos.push(...X),I=[b,...I]):U.renderer&&(I=[...(yield this._getRendererLegendElements(U.renderer,{title:U.title,opacity:X,sublayer:U})),...I])}return I.filter(U=>!!U&&("infos"in U?0<U.infos.length:!0))});return function(b,v){return m.apply(this,arguments)}}();fa._constructLegendElementsForSublayers=function(){var m=H._asyncToGenerator(function*(){this.legendElements=[];this._handles.remove("sublayers-watcher");
const b=this.layer;this._handles.add(t.watch(()=>b.sublayers,()=>this._constructLegendElementsForSublayers),"sublayers-watcher");try{this.legendElements=yield this._generateLegendElementsForSublayers(b.sublayers,this.opacity),this.notifyChange("ready")}catch(v){a.getLogger(this.declaredClass).warn("Request to server for legend has failed!",v)}});return function(){return m.apply(this,arguments)}}();fa._generateLegendElementsForSublayers=function(){var m=H._asyncToGenerator(function*(b,v,I){const X=
this.layer;let U=[];this._handles.add(b.on("change",()=>this._constructLegendElementsForSublayers()),"sublayers-watcher");b=b.toArray();!I&&this.sublayerIds&&this.sublayerIds.length&&(b=this.sublayerIds.map(Z=>X.findSublayerById(Z)).filter(Boolean));for(const Z of b)if(b=t.watch(()=>[Z.renderer,Z.opacity,Z.title,Z.visible,Z.legendEnabled],()=>this._constructLegendElementsForSublayers()),this._handles.add(b,"sublayers-watcher"),!this.respectLayerVisibility||Z.visible&&Z.legendEnabled&&this._isSublayerInScale(Z)){b=
Z&&null!=Z.opacity?Z.opacity:null;b=null!=b?b*v:v;const da=qa(X)?!0:Z.originIdOf("renderer")>p.OriginId.SERVICE;Z.renderer&&!Z.sublayers&&da?(yield Z.load(),U=[...(yield this._getRendererLegendElements(Z.renderer,{title:Z.title,opacity:b,sublayer:Z})),...U]):(b=yield this._generateSymbolTableElementForSublayer(Z,b,I))&&U.unshift(b)}return U.filter(Z=>!!Z&&("infos"in Z?0<Z.infos.length:!0))});return function(b,v,I){return m.apply(this,arguments)}}();fa._generateSymbolTableElementForSublayer=function(){var m=
H._asyncToGenerator(function*(b,v,I){if(!I){I=new Map;var X=this.layer,U=b.source;let Z=null;if(U&&("map-layer"!==U.type||U.mapLayerId!==b.id||U.gdbVersion&&U.gdbVersion!==("gdbVersion"in X&&X.gdbVersion))||b.originIdOf("renderer")>p.OriginId.SERVICE||b.originIdOf("labelingInfo")>p.OriginId.SERVICE||b.originIdOf("labelsVisible")>p.OriginId.SERVICE)U=new g.ExportImageParameters({layer:this.layer}),Z=U.hasDynamicLayers?U.dynamicLayers:null,U.destroy();(yield this._getLegendLayers(Z||`${X.uid}-default`,
Z)).forEach(da=>I.set(da.layerId,da))}X=I.get(b.id);return(!X||X?.subLayerIds&&X.defaultVisibility)&&b.sublayers?(v=yield this._generateLegendElementsForSublayers(b.sublayers,v,I),{type:"symbol-table",title:b.title,infos:v}):this._generateSymbolTableElementForLegendLayer(X,b,v)});return function(b,v,I){return m.apply(this,arguments)}}();fa._generateSymbolTableElementForLegendLayer=function(m,b,v){if(!m||!m.legend||this.respectLayerVisibility&&!this._isLegendLayerInScale(m,b))return null;var I=b?.renderer;
let X=b?.title||m.layerName;I&&(!b||b?.originIdOf("renderer")>p.OriginId.SERVICE)&&(I=b?.title||this._getRendererTitle(I,b))&&(X&&"string"!==typeof I&&"title"in I&&(I.title=X),X=I);const U={type:"symbol-table",title:X,legendType:m.legendType?m.legendType:null,infos:[]},Z=b?this._sanitizeLegendForSublayer(m.legend.slice(),b):m.legend;0<m.legendGroups?.length?m.legendGroups.forEach(da=>{const oa={type:"symbol-table",title:da.heading,legendType:m.legendType?m.legendType:null,infos:this._generateSymbolTableElementInfosForLegendLayer(Z.filter(va=>
va.groupId===da.id),m.layerId,v)};0<oa.infos?.length&&U.infos.push(oa)}):U.infos=this._generateSymbolTableElementInfosForLegendLayer(Z,m.layerId,v);return 0<U.infos.length?U:null};fa._generateSymbolTableElementInfosForLegendLayer=function(m,b,v){return m.map(I=>{let X=I.url;if(I.imageData&&0<I.imageData.length)X=`data:image/png;base64,${I.imageData}`;else if(0!==X.indexOf("http"))X=q.addTokenParameter(`${this.layer.url}/${b}/images/${X}`);else return null;return{label:I.label,src:X,opacity:null==
v?this.opacity:v,width:I.width,height:I.height}}).filter(I=>!!I)};fa._isSublayerInScale=function(m){const b=m.minScale||0;m=m.maxScale||0;return 0<b&&b<this.scale||m>this.scale?!1:!0};fa._isLegendLayerInScale=function(m,b){b=b||this.layer;let v=null,I=null,X=!0;!b.minScale&&0!==b.minScale||!b.maxScale&&0!==b.maxScale?(0===m.minScale&&b.tileInfo&&(v=b.tileInfo.lods[0].scale),0===m.maxScale&&b.tileInfo&&(I=b.tileInfo.lods[b.tileInfo.lods.length-1].scale)):(v=Math.min(b.minScale,m.minScale)||b.minScale||
m.minScale,I=Math.max(b.maxScale,m.maxScale));if(0<v&&v<this.scale||I>this.scale)X=!1;return X};fa._sanitizeLegendForSublayer=function(m,b){if("version"in this.layer&&10.1>this.layer.version||0===m.length)return m;b=b.renderer;let v=null,I=null;m.some(X=>X.values)&&m.some((X,U)=>{X.values||(v=U,I=X,I.label||(I.label="others"));return null!=I});b?"unique-value"===b.type?I&&(m.splice(v,1),m.push(I)):"class-breaks"===b.type&&(I&&m.splice(v,1),m.reverse(),I&&m.push(I)):I&&(m.splice(v,1),m.push(I));return m};
fa._getRendererLegendElements=function(){var m=H._asyncToGenerator(function*(b,v={}){var I=this.view;I=ia(b)||ka(b)||ja(b)||la(b)||na(b)||pa(b)?"2d"===I.type||x.isSupportedRenderer3D(b):"raster-stretch"===b.type||"raster-colormap"===b.type||"raster-shaded-relief"===b.type||ta(b)||ea(b)||sa(b)||"vector-field"===b.type||"flow"===b.type;if(!I)return a.getLogger(this.declaredClass).warn(`Renderer of type '${b.type}' not supported!`),[];if(ta(b)||ea(b)||sa(b)||"esri.renderers.PointCloudRGBRenderer"===
b.declaredClass)return this._constructPointCloudRendererLegendElements(b,v);if(na(b))return this._constructDotDensityRendererLegendElements(b);b=yield this._loadRenderer(b);return pa(b)?this._constructPieChartRendererLegendElements(b):this._constructRendererLegendElements(b,v)});return function(b){return m.apply(this,arguments)}}();fa._getLegendElementsForFeatureReduction=function(){var m=H._asyncToGenerator(function*(b){let v=null;"binning"===b.type?v=b.renderer:"cluster"===b.type&&(v=this._getClusterRenderer(b));
return v?this._getRendererLegendElements(v):[]});return function(b){return m.apply(this,arguments)}}();fa._getPointCloudRendererTitle=function(m){return m.legendOptions&&m.legendOptions.title||m.field};fa._constructPointCloudRendererLegendElements=function(m,b={}){b=b.title;const v=[];let I=null;var X=null;if(ta(m))I={type:"symbol-table",title:b||this._getPointCloudRendererTitle(m),infos:[]},m.colorClassBreakInfos.forEach(U=>{I.infos.unshift({label:U.label||U.minValue+" - "+U.maxValue,value:[U.minValue,
U.maxValue],symbol:this._getAppliedCloneSymbol(Da,U.color)})});else if(ea(m)){X=m.stops;let U=null;if(X.length&&(1===X.length&&(U=X[0].color),!U)){const Z=X[0].value,da=X[X.length-1].value;null!=Z&&null!=da&&(U=E.getColorFromPointCloudStops(Z+(da-Z)/2,X))}I={type:"symbol-table",title:null,infos:[{label:null,value:null,symbol:this._getAppliedCloneSymbol(Da,U||Da.color)}]};X=E.getRampStopsForPointCloud(m.stops);X={type:"color-ramp",title:b||this._getPointCloudRendererTitle(m),infos:X,preview:M.renderColorRampPreviewHTML(X.map(Z=>
Z.color))}}else sa(m)&&(I={type:"symbol-table",title:b||this._getPointCloudRendererTitle(m),infos:[]},m.colorUniqueValueInfos.forEach(U=>{I.infos.push({label:U.label||U.values.join(", "),value:U.values.join(", "),symbol:this._getAppliedCloneSymbol(Da,U.color)})}));I&&I.infos.length&&v.push(I);X&&X.infos.length&&v.push(X);b=v.reduce((U,Z)=>U.concat(Z.infos),[]).filter(U=>!!U.symbol).map(U=>this._getSymbolPreview(U,this.opacity,{symbolConfig:{applyColorModulation:!!m.colorModulation}}));return e.eachAlways(b).then(()=>
v)};fa._getElementInfoForDotDensity=function(m,b){const {backgroundColor:v,outline:I,dotSize:X}=m;var U=this.effectList?.effects.map(da=>da.toJSON());U=k.effectFunctionsFromJSON(U);U=X+"-"+b+"-"+v+"-"+(I&&JSON.stringify(I.toJSON()))+"-"+U;const Z=this._dotDensityUrlCache;m=Z.has(U)?Z.get(U):M.renderDotDensityPreviewHTML(m,b);Z.set(U,m);b=W.renderSymbol([[{shape:{type:"image",x:0,y:0,width:m.width,height:m.height,src:m.src},fill:null,stroke:null,offset:[0,0]}]],[m.width,m.height],{effectView:this.effectList});
return{opacity:1,src:m.src,preview:b,width:m.width,height:m.height}};fa._constructDotDensityRendererLegendElements=function(m){const b=m.calculateDotValue(this.view.scale),v={type:"symbol-table",title:{value:b&&Math.round(b),unit:m.legendOptions&&m.legendOptions.unit||""},infos:[]};m.attributes.forEach(I=>{const X=this._getElementInfoForDotDensity(m,I.color);X.label=I.label||I.valueExpressionTitle||I.field;v.infos.push(X)});return Promise.resolve([v])};fa._constructPieChartRendererLegendElements=
function(){var m=H._asyncToGenerator(function*(b){const v=this.layer.opacity,I=[];let X=null;const U=b.outline;b.attributes.forEach(oa=>{const va=new Y({color:oa.color,outline:U});I.push({label:oa.label||oa.valueExpressionTitle||oa.field,symbol:va})});var Z=I.length?[...I]:[];if(b.othersCategory?.color&&0!==b.othersCategory?.threshold){var da=new Y({color:b.othersCategory.color,outline:U});X=b.othersCategory.label||"Other";I.push({label:X,symbol:da})}b.defaultColor?.a&&(da=new Y({color:b.defaultColor,
outline:U}),I.push({label:b.defaultLabel,symbol:da}));da=(yield this._getVisualVariableLegendElements(b,this.layer))||[];I.length&&(da.unshift({type:"symbol-table",title:null,infos:I}),Z=Z.filter(oa=>oa.label!==X).map(oa=>oa.symbol.color).filter(Boolean),Z=M.renderPieChartPreviewHTML(Z,{holePercentage:b.holePercentage,backgroundColor:b.backgroundFillSymbol?.color,effectList:this.effectList,outline:U}),da.unshift({type:"pie-chart-ramp",title:this._getRendererTitle(b,this.layer),infos:I,preview:Z}));
b=da.reduce((oa,va)=>oa.concat(this._getAllInfos(va)),[]).filter(oa=>!!oa?.symbol&&!oa?.preview).map(oa=>this._getSymbolPreview(oa,v,{effectList:this.effectList}));yield e.eachAlways(b);return da});return function(b){return m.apply(this,arguments)}}();fa._constructRendererLegendElements=function(){var m=H._asyncToGenerator(function*(b,v={}){const {title:I,sublayer:X}=v,U=X||this.layer;this._hasSizeRamp=this._hasOpacityRamp=this._hasColorRamp=!1;this._scaleDrivenSizeVariable=null;const Z=(yield this._getVisualVariableLegendElements(b,
U))||[],da={type:"symbol-table",title:I||this._getRendererTitle(b,U),infos:[]};let oa=null,va=!1;const Ba=new Set;if("flow"!==b.type||this._hasSizeRamp)if("univariate-color-size"===("authoringInfo"in b&&b?.authoringInfo)?.type){var ha=I,ra=za(b)?"univariate-above-and-below-ramp":"univariate-color-size-ramp",ya=Z.findIndex(ma=>"color-ramp"===ma.type);ya=-1!==ya?Z.splice(ya,1)[0]:null;var ua=Z.findIndex(ma=>"size-ramp"===ma.type);ua=-1!==ua?Z.splice(ua,1)[0]:null;var Aa=[];ya&&(ha=ya.title,Aa.push(ya));
ua&&(ha=ua.title,Aa.push(ua));0<Aa.length&&Z.push({type:ra,title:ha,infos:Aa})}else if(la(b))ha=V.getHeatmapRampStops(b),Z.push({type:"heatmap-ramp",title:I||this._getRendererTitle(b,U),infos:ha,preview:M.renderColorRampPreviewHTML(ha.map(ma=>ma.color),{effectList:this.effectList})});else if(ja(b)){if((ra=b&&b.authoringInfo)&&"relationship"===ra.type){const {focus:ma,numClasses:Ca,field1:Ha,field2:Pa}=ra;if(Ca&&Ha&&Pa){ya=[Ha,Pa];ra=ba.getRotationAngleForFocus(ma)||0;for(ha of ya){const {field:Qa,
normalizationField:Ka,label:Sa}=ha;ya=Sa||{field:this._getFieldAlias(Qa,U),normField:Ka&&this._getFieldAlias(Ka,U)};ua=$a.clone();ua.angle=ra;da.infos.push({label:ya,symbol:ua});Ba.add(ua);ra+=90}ha=ba.getRelationshipRampElement({focus:ma,numClasses:Ca,infos:b.uniqueValueInfos});Z.unshift(ha)}}else if("esri.layers.ImageryLayer"===this.layer.declaredClass||"esri.layers.ImageryTileLayer"===this.layer.declaredClass)b.uniqueValueInfos.forEach(ma=>{ma.symbol&&da.infos.push({label:ma.label||ma.value,value:ma.value,
symbol:ma.symbol})});else{const {field:ma,field2:Ca,field3:Ha,fieldDelimiter:Pa,valueExpression:Qa,defaultSymbol:Ka}=b,Sa=!(!ma&&!Qa||!Ca&&!Ha),Ia=[];b.uniqueValueGroups.forEach(Ua=>{const Ta={type:"symbol-table",title:Ua.heading,infos:[]};Ua.classes.forEach(Ja=>{const {symbol:Va,values:ab}=Ja;if(Va){var La=[],Ma=[];for(const bb of ab){const {value:Wa,value2:Xa,value3:Ya}=bb,Na=[],Ra=[];if(ma||Qa)Na.push(Wa),Ra.push(this._getDomainName(ma,Wa,U));Ca&&(Na.push(Xa),Ra.push(this._getDomainName(Ca,Xa,
U)));Ha&&(Na.push(Ya),Ra.push(this._getDomainName(Ha,Ya,U)));La.push(Sa?Na.join(Pa||""):Na[0]);Ma.push(Ra.join(" - "))}La=La.join(", ");Ja=Ja.label;Ja||(Ma=Ma.filter(Boolean),Ja=Ma.length?Ma.join(", "):La);Ta.infos.push({label:Ja,value:La,symbol:Va})}});Ta.infos.length&&Ia.push(Ta)});Ia.length&&(ha=Ia[0],1===Ia.length&&"title"in ha&&!ha.title?da.infos.push(...ha.infos):(Ka&&(Ia.push({type:"symbol-table",infos:[{label:b.defaultLabel||"others",symbol:Ka}]}),va=!0),da.infos.push(...Ia)),I||b.legendOptions&&
b.legendOptions.title||b.valueExpressionTitle||(da.title=null))}b.defaultSymbol&&!va&&(da.infos.push({label:b.defaultLabel||"others",symbol:b.defaultSymbol}),va=!0)}else if(ka(b))oa=this._isUnclassedRenderer(b),oa&&this._hasSizeRamp||(b.classBreakInfos.forEach(ma=>{ma.symbol&&da.infos.unshift({label:ma.label||(oa?null:ma.minValue+" - "+ma.maxValue),value:[ma.minValue,ma.maxValue],symbol:ma.symbol})}),oa&&(da.title=null),this._updateInfosforClassedSizeRenderer(b,da.infos)),b.defaultSymbol&&!oa&&(da.infos.push({label:b.defaultLabel||
"others",symbol:b.defaultSymbol}),va=!0);else if("raster-stretch"===b.type)if("esri.layers.ImageryTileLayer"===this.layer.declaredClass||"esri.layers.WCSLayer"===this.layer.declaredClass)ha=this._constructTileImageryStretchRendererElements(b),"stretch-ramp"===ha.type?Z.push(ha):da.infos=ha;else{ha=this.layer;b.statistics&&b.statistics.length&&(ra=null!=b.statistics[0].min?b.statistics[0].min:b.statistics[0][0],ya=null!=b.statistics[0].max?b.statistics[0].max:b.statistics[0][1]);ua=[];ua=h.unwrap(ha.renderingRule?
yield ha.generateRasterInfo(ha.renderingRule):ha.serviceRasterInfo);const ma=ua.keyProperties.BandProperties;Aa=R.getPixelValueRange(ua.pixelType);1===ua.bandCount?(ha=ha.bandIds?.[0]||0,ra=null!=ra?ra:ua.statistics?ua.statistics[ha].min:Aa[0],ya=null!=ya?ya:ua.statistics?ua.statistics[ha].max:Aa[1],ra||ya?Z.push(this._getStretchLegendElements(b,{min:ra,max:ya})):this._getServerSideLegend()):ha.bandIds&&1===ha.bandIds.length?(ra=null!=ra?ra:ua.statistics?ua.statistics[ha.bandIds[0]].min:Aa[0],ya=
null!=ya?ya:ua.statistics?ua.statistics[ha.bandIds[0]].max:Aa[1],ra||ya?Z.push(this._getStretchLegendElements(b,{min:ra,max:ya})):this._getServerSideLegend()):3<=ua.bandCount?ma&&ma.length>=ua.bandCount?ha.bandIds&&3===ha.bandIds.length?(ua=ha.bandIds.map(Ca=>ma[Ca].BandName),da.infos=this._createSymbolTableElementMultiBand(ua)):"lerc"===ha.format?(ua=[0,1,2].map(Ca=>ma[Ca].BandName),da.infos=this._createSymbolTableElementMultiBand(ua)):this._getServerSideLegend():"lerc"===ha.format?(ua=["band1",
"band2","band3"],da.infos=this._createSymbolTableElementMultiBand(ua)):this._getServerSideLegend():this._getServerSideLegend()}else if("raster-colormap"===b.type)b.colormapInfos.forEach(ma=>{da.infos.push({label:ma.label,value:ma.value,symbol:this._getAppliedCloneSymbol(Za,ma.color)})});else if(ia(b)){ha=b.symbol;switch(v.geometryType){case "point":ha="pointSymbol"in U&&U.pointSymbol;break;case "polyline":ha="lineSymbol"in U&&U.lineSymbol;break;case "polygon":ha="polygonSymbol"in U&&U.polygonSymbol}ra=
this._hasClusterSizeVariable&&this._getClusterSymbol()||!this._hasSizeRamp;b.symbol&&ra&&da.infos.push({label:b.label,symbol:ha})}else"vector-field"===b.type?(b.outputUnit&&(this.title="("+b.toJSON().outputUnit+")"),da.title=b.attributeField,ha=b.getClassBreakInfos(),ha?.length?ha.forEach(ma=>{da.infos.push({label:ma.minValue+" - "+ma.maxValue,symbol:ma.symbol})}):da.infos.push({label:b.attributeField,symbol:b.getDefaultSymbol()})):"raster-shaded-relief"===b.type&&Z.push(this._getStretchLegendElements(b,
{min:0,max:255}));else ha=yield G.getSymbolForFlowRenderer(b),da.infos.push({label:null,symbol:ha});const Fa=b.defaultSymbol;!Fa||va||ia(b)||oa&&!this._hasColorRamp&&!this._hasSizeRamp&&!this._hasOpacityRamp||Z.push({type:"symbol-table",infos:[{label:b.defaultLabel||"others",symbol:Fa}]});da.infos.length&&Z.unshift(da);const cb=null==v.opacity?this.opacity:v.opacity,db=this._isTallSymbol("visualVariables"in b&&b.visualVariables),eb="esri.layers.ImageryLayer"===this.layer.declaredClass||"esri.layers.ImageryTileLayer"===
this.layer.declaredClass;v=Z.reduce((ma,Ca)=>ma.concat(this._getAllInfos(Ca)),[]).filter(ma=>!!ma?.symbol).map(ma=>this._getSymbolPreview(ma,cb,{isDefault:ma.symbol===Fa,applyScaleDrivenSize:!Ba.has(ma.symbol),symbolConfig:{isTall:db,isSquareFill:eb},effectList:Ba.has(ma.symbol)?null:this.effectList}));b=null;yield e.eachAlways(v);return Z});return function(b){return m.apply(this,arguments)}}();fa._getServerSideLegend=function(){setTimeout(()=>this.buildLegendElementsForTools(),0)};fa._getAllInfos=
function(m){const b=m?.infos;return b?b.reduce((v,I)=>v.concat(this._getAllInfos(I)),[]):[m]};fa._constructTileImageryStretchRendererElements=function(m){function b(oa){const va=(v?.bandIds?.length?v.bandIds:Array.from(Array(Math.min(I.bandCount,3)).keys())).map(Ba=>oa&&oa[Ba]&&oa[Ba].BandName||"band"+(Ba+1));3>va.length?va.push(va[1]):3<va.length&&va.splice(3);return va}const v=this.layer,{rasterInfo:I}=v.raster,X=I.bandCount||m.statistics.length;var U;var Z=[];const da=I.keyProperties&&I.keyProperties.BandProperties;
(U=m?.statistics?.length?m.statistics:I?.statistics)?(Z=void 0!==U[0].min?U[0].min:U[0][0],U=U[0].max||U[0][1]):(U=R.getPixelValueRange(I.pixelType),Z=U[0],U=U[1]);v.hasStandardTime()&&(Z=v.getStandardTimeValue(Z),U=v.getStandardTimeValue(U));if(1===I.bandCount||1===v.bandIds?.length)return this._getStretchLegendElements(m,{min:Z,max:U});Z=da&&da.length>=X?b(da):b();return this._createSymbolTableElementMultiBand(Z)};fa._getStretchLegendElements=function(m,b){m=E.getStrectchRampStops(m.colorRamp,b);
return{type:"stretch-ramp",title:"",infos:m,preview:M.renderColorRampPreviewHTML(m.map(v=>v.color))}};fa._getClusterSymbol=function(){var m=this.layer;const b=(m="featureReduction"in m&&m.featureReduction)&&"symbol"in m&&m.renderer;return b&&!0!==b?.authoringInfo?.isAutoGenerated?null:m&&"symbol"in m&&m.symbol};fa._getSizeLegendElement=function(){var m=H._asyncToGenerator(function*(b,v,I,X){return{type:"size-ramp",title:this._hasClusterSizeVariable?this._getClusterTitle(v):b,infos:yield aa.getRampStops(I,
v,yield G.getMedianColor(I),this.scale,this.view.type,X,this._hasClusterSizeVariable?this._getClusterSymbol():null)}});return function(b,v,I,X){return m.apply(this,arguments)}}();fa._createSymbolTableElementMultiBand=function(m){const b=[],v=["red","green","blue"];m.forEach((I,X)=>{b.push({label:{colorName:v[X],bandName:I},src:G.RGB_IMG_SOURCE[X],opacity:this.opacity??1})});return b};fa._updateInfosforClassedSizeRenderer=function(m,b){const v=m.authoringInfo&&"class-breaks-size"===m.authoringInfo.type,
I=m.classBreakInfos.some(X=>d.isVolumetricSymbol(X.symbol));if(v&&I){const X=aa.REAL_WORLD_MAX_SIZE;m=m.classBreakInfos.length;const U=(X-aa.REAL_WORLD_MIN_SIZE)/(1<m?m-1:m);b.forEach((Z,da)=>{Z.size=X-U*da})}};fa._isTallSymbol=function(m){let b=!1,v=!1;if(m)for(let I=0;I<m.length&&(!b||!v);I++){const X=m[I];"size"===X.type&&("height"===X.axis&&(b=!0),"width-and-depth"===X.axis&&(v=!0))}return b&&v};fa._getSymbolPreview=function(){var m=H._asyncToGenerator(function*(b,v,I){var X=!I?.isDefault&&null==
b.size&&this._hasSizeRamp?n.px2pt(z.SymbolSizeDefaults.size):b.size;this._scaleDrivenSizeVariable&&I?.applyScaleDrivenSize&&({getSize:X}=yield new Promise((U,Z)=>A(["../../../renderers/visualVariables/support/visualVariableUtils"],U,Z)),X=X(this._scaleDrivenSizeVariable,null,{view:this.view.type,scale:this.scale,shape:"simple-marker"===b.symbol.type?b.symbol.style:null}));return M.renderPreviewHTML(b.symbol,{size:X,opacity:v,scale:!1,symbolConfig:I?.symbolConfig,effectView:I?.effectList}).then(U=>
{b.preview=U;return b}).catch(()=>{b.preview=null;return b})});return function(b,v,I){return m.apply(this,arguments)}}();fa._getClusterRenderer=function(m){this._hasClusterSizeVariable=!1;var b="renderer"in this.layer&&this.layer.renderer;b=m.renderer?.clone()||b?.clone();const v=h.unwrap(y.getClusterSizeVariable(this.layerView._effectiveRenderer,this.view));if(v&&"visualVariables"in b&&!b.visualVariables?.some(I=>"size"===I.type&&"outline"!==I.target&&!xa.test(I.valueExpression))){if("clusterMinSize"in
m&&"clusterMaxSize"in m){const {clusterMinSize:I,clusterMaxSize:X}=m;v.legendOptions=new P({showLegend:I!==X})}b.visualVariables=(b.visualVariables||[]).concat([v]);this._hasClusterSizeVariable=!0}return b};fa._loadRenderer=function(){var m=H._asyncToGenerator(function*(b){const v=[],I=b.clone(),X=yield G.getMedianColor(I);if(ka(I)||ja(I))b=(I.classBreakInfos||I.uniqueValueInfos).map(U=>this._fetchSymbol(U.symbol,X).then(Z=>{U.symbol=Z}).catch(()=>{U.symbol=null})),Array.prototype.push.apply(v,b);
v.push(this._fetchSymbol(I.symbol||I.defaultSymbol,I.defaultSymbol?null:X).then(U=>{this._applySymbolToRenderer(I,U,ia(I))}).catch(()=>{this._applySymbolToRenderer(I,null,ia(I))}));return e.eachAlways(v).then(()=>I)});return function(b){return m.apply(this,arguments)}}();fa._applySymbolToRenderer=function(m,b,v){v?m.symbol=b:m.defaultSymbol=b};fa._fetchSymbol=function(){var m=H._asyncToGenerator(function*(b,v){if(!b)throw Error();if("web-style"===b.type){const I=this._webStyleSymbolCache;try{const X=
yield"2d"===this.view.type?b.fetchCIMSymbol({cache:I}):b.fetchSymbol({cache:I});return this._getAppliedCloneSymbol(X,v)}catch{throw a.getLogger(this.declaredClass).warn("Fetching web-style failed!"),Error();}}return this._getAppliedCloneSymbol(b,v)});return function(b,v){return m.apply(this,arguments)}}();fa._getAppliedCloneSymbol=function(m,b){if(!m||!b)return m;m=m.clone();const v=b&&b.toRgba();m.type.includes("3d")?this._applyColorTo3dSymbol(m,v):"cim"===m.type?l.applyCIMSymbolColor(m,b):m.color&&
(m.color=new B(v||m.color));return m};fa._applyColorTo3dSymbol=function(m,b){b&&m.symbolLayers.forEach(v=>{v&&(v.material||(v.material={}),v.material.color=new B(b))})};fa._getVisualVariableLegendElements=function(){var m=H._asyncToGenerator(function*(b,v){var I=this;if(!("visualVariables"in b&&b.visualVariables)||"vector-field"===b.type)return null;var X=b.visualVariables,U=[];const Z=[],da=[];for(const ha of X)"color"===ha.type?U.push(ha):"size"===ha.type?Z.push(ha):"opacity"===ha.type&&da.push(ha);
X=[...U,...Z,...da];let oa;if(0===U.length&&ka(b)&&b.classBreakInfos&&1===b.classBreakInfos.length)var va=(va=b.classBreakInfos[0])&&va.symbol;0===U.length&&ia(b)&&(va=b.symbol);va&&(va.type.includes("3d")?(U=va.symbolLayers.getItemAt(0),"water"===U.type?h.isSome(U.color)&&(oa=U.color):h.isSome(U.material)&&h.isSome(U.material.color)&&(oa=U.material.color)):va.url||(oa=va.color));const Ba=this.effectList;return(yield Promise.all(X.map(function(){var ha=H._asyncToGenerator(function*(ra){if(!ra.legendOptions||
!1!==ra.legendOptions.showLegend){const ua="flow"===b.type?ra.field:I._getRampTitle(ra,v);let Aa=null;var ya="getField"in v&&v.getField&&v.getField(ra.field);ya=ya&&C.isDateField(ya);"color"===ra.type?(ra=yield E.getRampStops(ra,null,ya),Aa={type:"color-ramp",title:ua,infos:ra,preview:M.renderColorRampPreviewHTML(ra.map(Fa=>Fa.color),{effectList:Ba})},I._hasColorRamp||(I._hasColorRamp=!(null==Aa.infos||!Aa.infos.length))):"size"===ra.type&&"outline"!==ra.target?xa.test(ra.valueExpression)?I._hasClusterSizeVariable||
(I._scaleDrivenSizeVariable=ra):(Aa=yield I._getSizeLegendElement(ua,ra,b,ya),I._hasSizeRamp||(I._hasSizeRamp=!(null==Aa.infos||!Aa.infos.length))):"opacity"===ra.type&&(ra=yield E.getRampStops(ra,oa,ya),Aa={type:"opacity-ramp",title:ua,infos:ra,preview:M.renderColorRampPreviewHTML(ra.map(Fa=>Fa.color),{effectList:Ba})},I._hasOpacityRamp||(I._hasOpacityRamp=!(null==Aa.infos||!Aa.infos.length)));return Aa&&Aa.infos?Aa:null}});return function(ra){return ha.apply(this,arguments)}}()))).filter(ha=>!!ha)});
return function(b,v){return m.apply(this,arguments)}}();fa._getDomainName=function(m,b,v){return m&&"function"!==typeof m?(v=(m="getField"in v&&v.getField&&v.getField(m))&&"getFieldDomain"in v&&v.getFieldDomain?v.getFieldDomain(m.name):null)&&"coded-value"===v.type?v.getName(b):null:null};fa._getClusterTitle=function(m){var b=this.layer;m=m.field;if("featureReduction"in b&&b.featureReduction&&"cluster"===b.featureReduction.type&&(b=b.featureReduction,b=(b="popupTemplate"in b&&b.popupTemplate)&&b.fieldInfos))for(const v of b)if(v.fieldName===
m)return"cluster_count"===m?v.label||{showCount:!0}:v.label;return{showCount:!0}};fa._getRampTitle=function(m,b){let v=m.field,I=m.normalizationField,X=!1,U=!1,Z=!1;var da=null;v="function"===typeof v?null:v;I="function"===typeof I?null:I;da=m.legendOptions&&m.legendOptions.title;if(null==da)if(m.valueExpressionTitle)da=m.valueExpressionTitle;else{if("renderer"in b&&b.renderer&&"authoringInfo"in b.renderer&&b.renderer.authoringInfo&&b.renderer.authoringInfo.visualVariables)for(m=b.renderer.authoringInfo.visualVariables,
da=0;da<m.length;da++){const oa=m[da];if("color"===oa.type){if("ratio"===oa.style){X=!0;break}if("percent"===oa.style){U=!0;break}if("percent-of-total"===oa.style){Z=!0;break}}}da={field:v&&this._getFieldAlias(v,b),normField:I&&this._getFieldAlias(I,b),ratio:X,ratioPercent:U,ratioPercentTotal:Z}}return da};fa._getRendererTitle=function(m,b){if(m.legendOptions&&m.legendOptions.title)return m.legendOptions.title;if(m.valueExpressionTitle)return m.valueExpressionTitle;var v=m.field;let I=null,X=null;
ka(m)&&(I=m.normalizationField,X="percent-of-total"===m.normalizationType);v="function"===typeof v?null:v;I="function"===typeof I?null:I;if(ja(m)){const {field2:U,field3:Z,fieldDelimiter:da}=m;v=v&&this._getFieldAlias(v,b);U&&(v=`<${v}>${da}<${this._getFieldAlias(U,b)}>`,Z&&(v=`${v}${da}<${this._getFieldAlias(Z,b)}>`));return v}m=null;if(v||I)m={field:v&&this._getFieldAlias(v,b),normField:I&&this._getFieldAlias(I,b),normByPct:X};return m};fa._getFieldAlias=function(m,b){var v="popupTemplate"in b&&
b.popupTemplate;v=v&&v.fieldInfos;let I=null;v&&v.some(Z=>m===Z.fieldName?(I=Z,!0):!1);v=null;"getField"in b&&b.getField?v=b.getField(m):"fieldsIndex"in b&&b.fieldsIndex&&(v=b.fieldsIndex.get(m));let X=null;if(b="featureReduction"in b&&b.featureReduction)!I&&"popupTemplate"in b&&b.popupTemplate&&b.popupTemplate.fieldInfos&&b.popupTemplate.fieldInfos.some(Z=>m?.toLowerCase()===Z.fieldName?.toLowerCase()?(I=Z,!0):!1),"fields"in b&&b.fields&&(X=b.fields.find(Z=>Z.name?.toLowerCase()===m?.toLowerCase()));
b=I||v||X;let U=null;b&&(U=I?.label||v?.alias||X?.alias||"name"in b&&b.name||"fieldName"in b&&b.fieldName);return U};fa._isUnclassedRenderer=function(m){const b=m.visualVariables;let v=!1;ka(m)&&m.classBreakInfos&&1===m.classBreakInfos.length&&b&&(v=m.field?b.some(I=>!(!I||m.field!==I.field||(m.normalizationField||I.normalizationField)&&m.normalizationField!==I.normalizationField)):!!b.length);return v};H._createClass(Oa,[{key:"effectList",get:function(){const m=this.layer;let b=null;"effect"in m&&
m.effect&&(b=new F.EffectView,b.effect=m.effect,b.endTransitions(),b.scale=this.scale);return b}},{key:"opacity",get:function(){const m=this.layer.opacity,b=this.parent?.opacity;var v=this.layer.parent;v=v&&"uid"in v?this._getParentLayerOpacity(v):null;return null!=b?b*m:null!=v?v*m:m}},{key:"ready",get:function(){return null===this.layer?!0:0<this.children.length?this._isGroupActive():0<this.legendElements.length}},{key:"scale",get:function(){return this.view&&this.view.scale}},{key:"isScaleDriven",
get:function(){const m=this.layer;if(null===m)return!1;if("effect"in m&&m.effect&&Array.isArray(m.effect))return!0;if("featureReduction"in m&&m.featureReduction){if("cluster"===m.featureReduction.type)return!0;if("binning"===m.featureReduction.type&&"renderer"in m.featureReduction&&m.featureReduction.renderer)return this._isRendererScaleDriven(m.featureReduction.renderer)}return"renderer"in m&&m.renderer?this._isRendererScaleDriven(m.renderer):this._isLayerScaleDriven(this.layer)}},{key:"version",
get:function(){return this._get("version")+1}}]);return Oa}(w);J.__decorate([S.property()],N.prototype,"children",void 0);J.__decorate([S.property({readOnly:!0})],N.prototype,"effectList",null);J.__decorate([S.property()],N.prototype,"layerView",void 0);J.__decorate([S.property()],N.prototype,"layer",void 0);J.__decorate([S.property()],N.prototype,"legendElements",void 0);J.__decorate([S.property({readOnly:!0})],N.prototype,"opacity",null);J.__decorate([S.property()],N.prototype,"parent",void 0);
J.__decorate([S.property({readOnly:!0,dependsOn:[]})],N.prototype,"ready",null);J.__decorate([S.property()],N.prototype,"hideLayersNotInCurrentView",void 0);J.__decorate([S.property()],N.prototype,"keepCacheOnDestroy",void 0);J.__decorate([S.property()],N.prototype,"respectLayerVisibility",void 0);J.__decorate([S.property({readOnly:!0})],N.prototype,"scale",null);J.__decorate([S.property()],N.prototype,"sublayerIds",void 0);J.__decorate([S.property({readOnly:!0})],N.prototype,"isScaleDriven",null);
J.__decorate([S.property()],N.prototype,"title",void 0);J.__decorate([S.property({readOnly:!0,dependsOn:["ready"],value:0})],N.prototype,"version",null);J.__decorate([S.property()],N.prototype,"view",void 0);return N=J.__decorate([f.subclass("esri.widgets.Legend.support.ActiveLayerInfo")],N)})},"esri/layers/effects/EffectView":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/has ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./parser ./utils".split(" "),
function(A,H,J,B,q,L,N,w,O,r,c,a){function h(n){n=c.parse(n)||[];var K=(K=n[0])?"type"in K:!1;return K?[{scale:-1,effects:n}]:n}function e(n,K,S){return n[0]?.effects&&K[0]?.effects?(-1===n[0]?.scale||-1===K[0]?.scale)&&(1<n.length||1<K.length)&&0>=S?!1:a.canInterpolateEffects(n[0].effects,K[0].effects):!0}function t(n,K,S){const D=n.length>K.length?n:K;n=n.length>K.length?K:n;var u=n[n.length-1];K=u?.scale??S;u=u?.effects??[];for(let f=n.length;f<D.length;f++)n.push({scale:K,effects:[...u]});for(K=
0;K<D.length;K++)n[K].scale=-1===n[K].scale?S:n[K].scale,D[K].scale=-1===D[K].scale?S:D[K].scale,a.normalizeEffects(n[K].effects,D[K].effects)}A.EffectView=function(n){function K(D){D=n.call(this,D)||this;D._from=null;D._to=null;D._final=null;D._current=[];D._time=0;D.duration=q("mapview-transitions-duration");D.effects=[];return D}H._inheritsLoose(K,n);var S=K.prototype;S.canTransitionTo=function(D){try{return 0<this.scale&&e(this._current,h(D),this.scale)}catch{return!1}};S.transitionStep=function(D,
u){this._applyTimeTransition(D);this._updateForScale(u)};S.endTransitions=function(){this._applyTimeTransition(this.duration)};S._transitionTo=function(D){0<this.scale&&e(this._current,D,this.scale)?(this._final=D,this._to=L.clone(D),t(this._current,this._to,this.scale),this._from=L.clone(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=D);this._set("effects",this._current[0]?L.clone(this._current[0].effects):[])};S._applyTimeTransition=function(D){if(this._to&&this._from&&
this._current&&this._final){this._time+=D;D=Math.min(1,this._time/this.duration);for(let f=0;f<this._current.length;f++){const p=this._current[f],F=this._from[f],k=this._to[f];var u=F.scale;p.scale=u+(k.scale-u)*D;for(u=0;u<p.effects.length;u++)p.effects[u].interpolate(F.effects[u],k.effects[u],D)}1===D&&(this._current=this._final,this._set("effects",this._current[0]?L.clone(this._current[0].effects):[]),this._from=this._to=this._final=null)}};S._updateForScale=function(D){this._set("scale",D);if(0!==
this._current.length){var u=this._current,f=this._current.length-1,p,F=1;if(1===u.length||D>=u[0].scale)var k=p=u[0].effects;else if(D<=u[f].scale)k=p=u[f].effects;else for(let g=0;g<f;g++){const C=u[g],R=u[g+1];if(C.scale>=D&&R.scale<=D){F=(D-C.scale)/(R.scale-C.scale);p=C.effects;k=R.effects;break}}for(D=0;D<this.effects.length;D++)this.effects[D].interpolate(p[D],k[D],F)}};H._createClass(K,[{key:"effect",set:function(D){const u=this._get("effect");D=D||"";if(u!==D){this._set("effect",D);try{this._transitionTo(h(D))}catch(f){this._transitionTo([]),
N.getLogger(this.declaredClass).warn("Invalid Effect",{effect:D,error:f})}}}},{key:"hasEffects",get:function(){return this.transitioning||!!this.effects.length}},{key:"scale",set:function(D){this._updateForScale(D)}},{key:"transitioning",get:function(){return null!==this._to}}]);return K}(B);J.__decorate([w.property()],A.EffectView.prototype,"_to",void 0);J.__decorate([w.property()],A.EffectView.prototype,"duration",void 0);J.__decorate([w.property({value:""})],A.EffectView.prototype,"effect",null);
J.__decorate([w.property({readOnly:!0})],A.EffectView.prototype,"effects",void 0);J.__decorate([w.property({readOnly:!0})],A.EffectView.prototype,"hasEffects",null);J.__decorate([w.property({value:0})],A.EffectView.prototype,"scale",null);J.__decorate([w.property({readOnly:!0})],A.EffectView.prototype,"transitioning",null);A.EffectView=J.__decorate([r.subclass("esri.layers.effects.EffectView")],A.EffectView);A.canInterpolateEffectStops=e;A.convertEffectToStops=h;A.normalizeEffectStops=t;Object.defineProperty(A,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/ExportImageParameters":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/HandleOwner ../../core/maybe ../../core/sql ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass ./commonProperties ./floorFilterUtils ./sublayerUtils".split(" "),function(A,H,J,B,q,L,N,w,O,r,c,a,
h,e){const t={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};A.ExportImageParameters=function(n){function K(D){D=n.call(this,D)||this;D.floors=null;D.scale=0;return D}H._inheritsLoose(K,n);var S=K.prototype;S.destroy=function(){this.layer=null};S.toJSON=function(){var D=this.layer;D={dpi:D.dpi,
format:D.imageFormat,transparent:D.imageTransparency,gdbVersion:D.gdbVersion||null};this.hasDynamicLayers&&this.dynamicLayers?D.dynamicLayers=this.dynamicLayers:D={...D,layers:this.layers,layerDefs:this.layerDefs};return D};H._createClass(K,[{key:"dynamicLayers",get:function(){if(!this.hasDynamicLayers)return null;const D=this.visibleSublayers.map(u=>{const f=h.getLayerFloorFilterClause(this.floors,u);return u.toExportImageJSON(f)});return D.length?JSON.stringify(D):null}},{key:"hasDynamicLayers",
get:function(){return this.layer&&e.isExportDynamic(this.visibleSublayers,this.layer.serviceSublayers,this.layer.gdbVersion)}},{key:"layer",set:function(D){this._get("layer")!==D&&(this._set("layer",D),this.handles.remove("layer"),D&&this.handles.add([D.allSublayers.on("change",()=>this.notifyChange("visibleSublayers")),D.on("sublayer-update",u=>this.notifyChange(t[u.propertyName]))],"layer"))}},{key:"layers",get:function(){const D=this.visibleSublayers;return D?D.length?"show:"+D.map(u=>u.id).join(","):
"show:-1":null}},{key:"layerDefs",get:function(){const D=!!this.floors?.length,u=this.visibleSublayers.filter(f=>null!=f.definitionExpression||D&&null!=f.floorInfo);return u.length?JSON.stringify(u.reduce((f,p)=>{var F=h.getLayerFloorFilterClause(this.floors,p);F=N.sqlAnd(F,p.definitionExpression);L.isSome(F)&&(f[p.id]=F);return f},{})):null}},{key:"version",get:function(){this.commitProperty("layers");this.commitProperty("layerDefs");this.commitProperty("dynamicLayers");this.commitProperty("timeExtent");
const D=this.layer;D&&(D.commitProperty("dpi"),D.commitProperty("imageFormat"),D.commitProperty("imageTransparency"),D.commitProperty("gdbVersion"));return(this._get("version")||0)+1}},{key:"visibleSublayers",get:function(){const D=[];if(!this.layer)return D;var u=this.layer.sublayers;const f=p=>{const F=this.scale,k=0===p.minScale||F<=p.minScale,g=0===p.maxScale||F>=p.maxScale;p.visible&&(0===F||k&&g)&&(p.sublayers?p.sublayers.forEach(f):D.unshift(p))};u&&u.forEach(f);u=this._get("visibleSublayers");
return!u||u.length!==D.length||u.some((p,F)=>D[F]!==p)?D:u}}]);return K}(q.HandleOwnerMixin(B));J.__decorate([w.property({readOnly:!0})],A.ExportImageParameters.prototype,"dynamicLayers",null);J.__decorate([w.property()],A.ExportImageParameters.prototype,"floors",void 0);J.__decorate([w.property({readOnly:!0})],A.ExportImageParameters.prototype,"hasDynamicLayers",null);J.__decorate([w.property()],A.ExportImageParameters.prototype,"layer",null);J.__decorate([w.property({readOnly:!0})],A.ExportImageParameters.prototype,
"layers",null);J.__decorate([w.property({readOnly:!0})],A.ExportImageParameters.prototype,"layerDefs",null);J.__decorate([w.property({type:Number})],A.ExportImageParameters.prototype,"scale",void 0);J.__decorate([w.property(a.combinedViewLayerTimeExtentProperty)],A.ExportImageParameters.prototype,"timeExtent",void 0);J.__decorate([w.property({readOnly:!0})],A.ExportImageParameters.prototype,"version",null);J.__decorate([w.property({readOnly:!0})],A.ExportImageParameters.prototype,"visibleSublayers",
null);A.ExportImageParameters=J.__decorate([c.subclass("esri.layers.mixins.ExportImageParameters")],A.ExportImageParameters);Object.defineProperty(A,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/floorFilterUtils":function(){define(["exports"],function(A){function H(J,B){if(!J?.length)return null;J=J.filter(q=>""!==q).map(q=>`'${q}'`);J.push("''");return`${B} IN (${J.join(",")}) OR ${B} IS NULL`}A.getFloorFilterClause=function(J){const B=J.layer;return"floorInfo"in B&&B.floorInfo?.floorField&&
"floors"in J.view?H(J.view.floors,B.floorInfo.floorField):null};A.getLayerFloorFilterClause=function(J,B){return"floorInfo"in B&&B.floorInfo?.floorField?H(J,B.floorInfo.floorField):null};Object.defineProperty(A,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/sublayerUtils":function(){define(["exports","../../core/maybe","../../core/accessorSupport/PropertyOrigin"],function(A,H,J){function B(q,L){if(!q||!q.length||H.isNone(L))return!0;L=L.slice().reverse().flatten(({sublayers:O})=>O&&
O.toArray().reverse()).map(O=>O.id).toArray();if(q.length>L.length)return!1;let N=0;const w=L.length;for(const {id:O}of q){for(;N<w&&L[N]!==O;)N++;if(N>=w)return!1}return!0}A.isExportDynamic=function(q,L,N){return q.some(w=>{const O=w.source;return!(!O||"map-layer"===O.type&&O.mapLayerId===w.id&&(H.isNone(O.gdbVersion)||O.gdbVersion===N))||w.originIdOf("renderer")>J.OriginId.SERVICE||w.originIdOf("labelingInfo")>J.OriginId.SERVICE||w.originIdOf("opacity")>J.OriginId.SERVICE||w.originIdOf("labelsVisible")>
J.OriginId.SERVICE})?!0:!B(q,L)};A.isSublayerOverhaul=function(q){return!!q&&q.some(L=>null!=L.minScale||L.layerDefinition&&null!=L.layerDefinition.minScale)};A.shouldWriteSublayerStructure=function(q,L,N){return L.flatten(({sublayers:w})=>w).length!==q.length||q.some(w=>w.originIdOf("minScale")>N||w.originIdOf("maxScale")>N||w.originIdOf("renderer")>N||w.originIdOf("labelingInfo")>N||w.originIdOf("opacity")>N||w.originIdOf("labelsVisible")>N||w.originIdOf("source")>N)?!0:!B(q,L)};Object.defineProperty(A,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/pixelRangeUtils":function(){define(["exports"],function(A){function H(B){return J[B]??[-3.4028234663852886E38,3.4028234663852886E38]}const J={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-3.4028234663852886E38,3.4028234663852886E38],f64:[-Number.MAX_VALUE,Number.MAX_VALUE]};A.convertNoDataToMask=function(B,q,L){if(!(B.depthCount&&
1<B.depthCount)){var {pixels:N,statistics:w,pixelType:O}=B,r=N[0].length,c=B.bandMasks??[],a=B.mask??(new Uint8Array(r)).fill(255),h="f32"===O||"f64"===O,e=H(O),t=!1;for(let S=0;S<N.length;S++){const D="number"===typeof q?q:q[S];if(null==D)continue;var n=w?.[S].maxValue??e[1];if((w?.[S].minValue??e[0])>D+Number.EPSILON||n<D-Number.EPSILON)continue;n=c[S]||(new Uint8Array(r)).fill(255);const u=N[S];var K=L?.customFloatTolerance;if(h&&0!==K){K||(K=9.999999E37<=Math.abs(D)?2E-7*Math.abs(D):"f32"===O?
2**-23:Number.EPSILON);for(let f=0;f<u.length;f++)n[f]&&Math.abs(u[f]-D)<K&&(u[f]=0,n[f]=0,a[f]=0,t=!0)}else for(K=0;K<u.length;K++)n[K]&&u[K]===D&&(u[K]=0,n[K]=0,a[K]=0,t=!0);c[S]=n}t&&(B.bandMasks=c,B.mask=a);t&&"updateStatistics"in B&&B.updateStatistics()}};A.getPixelValueRange=H;Object.defineProperty(A,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/rendererConversion":function(){define(["exports","../../core/has","../../core/Error","../../core/maybe","../../symbols/support/symbolConversion"],
function(A,H,J,B,q){function L(r){return B.isNone(r)||"simple"===r.type||"unique-value"===r.type||"class-breaks"===r.type||"dictionary"===r.type||"heatmap"===r.type}function N(r,c){if(!c)return null;c=Array.isArray(c)?c:[c];if(0<c.length){const a=c.map(e=>e.details.symbol.type||e.details.symbol.declaredClass).filter(e=>!!e);a.sort();const h=[];a.forEach((e,t)=>{0!==t&&e===a[t-1]||h.push(e)});return new J("renderer-conversion-3d:unsupported-symbols",`Renderer contains symbols (${h.join(", ")}) which are not supported in 3D`,
{renderer:r,symbolErrors:c})}return null}function w(r,c){const a={...q.defaultTo3DOptions,...c};c=r.uniqueValueInfos?.map(e=>q.to3D(e.symbol,a).error).filter(B.isSome);const h=q.to3D(r.defaultSymbol,a);h.error&&c?.unshift(h.error);return N(r,c)}function O(r){const c=r.classBreakInfos.map(h=>q.to3D(h.symbol).error).filter(B.isSome),a=q.to3D(r.defaultSymbol);a.error&&c.unshift(a.error);return N(r,c)}A.isSupportedRenderer3D=L;A.validateTo3D=function(r,c){if(B.isNone(r))return null;if(!L(r))return new J("renderer-conversion-3d:unsupported-renderer",
`Unsupported renderer of type '${r.type||r.declaredClass}'`,{renderer:r});switch(r.type){case "simple":return N(r,q.to3D(r.symbol).error);case "unique-value":return w(r,c);case "class-breaks":return O(r)}return null};Object.defineProperty(A,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/cimSymbolUtils":function(){define(["exports","../../Color","../cim/utils"],function(A,H,J){function B(a){a=J.toCIMSymbolJSON(a);if("CIMTextSymbol"===a?.type)return a.height??0;let h=0;if(a?.symbolLayers)for(const e of a.symbolLayers)J.isCIMMarker(e)&&
null!=e.size&&e.size>h?h=e.size:J.isCIMStroke(e)&&null!=e.width&&e.width>h?h=e.width:J.isCIMFill(e);return h}function q(a,h,e,t){if(a)if("CIMTextSymbol"===a.type)null!=a.height&&(a.height*=h);else{if(e&&a.effects)for(const n of a.effects)w(n,h);if(a.symbolLayers)for(const n of a.symbolLayers)switch(n.type){case "CIMPictureMarker":case "CIMVectorMarker":L(n,h,t);break;case "CIMPictureStroke":case "CIMSolidStroke":!t?.preserveOutlineWidth&&n.width&&(n.width*=h);break;case "CIMPictureFill":n.height&&
(n.height*=h);n.offsetX&&(n.offsetX*=h);n.offsetY&&(n.offsetY*=h);break;case "CIMHatchFill":q(n.lineSymbol,h,!0,{...t,preserveOutlineWidth:!1}),n.offsetX&&(n.offsetX*=h),n.offsetY&&(n.offsetY*=h),n.separation&&(n.separation*=h)}}}function L(a,h,e){if(a&&(a.markerPlacement&&N(a.markerPlacement,h),a.offsetX&&(a.offsetX*=h),a.offsetY&&(a.offsetY*=h),a.anchorPoint&&"Absolute"===a.anchorPointUnits&&(a.anchorPoint={x:a.anchorPoint.x*h,y:a.anchorPoint.y*h}),a.size=null!=a.size?a.size*h:0,"CIMVectorMarker"===
a.type&&a.markerGraphics))for(const t of a.markerGraphics)a.scaleSymbolsProportionally||q(t.symbol,h,!0,e)}function N(a,h){J.isCIMMarkerStrokePlacement(a)&&a.offset&&(a.offset*=h);switch(a.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":a.customEndingOffset&&(a.customEndingOffset*=h);a.offsetAlongLine&&(a.offsetAlongLine*=h);if(a.placementTemplate&&a.placementTemplate.length){var e=a.placementTemplate.map(t=>t*h);a.placementTemplate=e}break;case "CIMMarkerPlacementAlongLineVariableSize":a.maxRandomOffset&&
(a.maxRandomOffset*=h);a.placementTemplate&&a.placementTemplate.length&&(e=a.placementTemplate.map(t=>t*h),a.placementTemplate=e);break;case "CIMMarkerPlacementOnLine":a.startPointOffset&&(a.startPointOffset*=h);break;case "CIMMarkerPlacementAtExtremities":a.offsetAlongLine&&(a.offsetAlongLine*=h);break;case "CIMMarkerPlacementAtRatioPositions":a.beginPosition&&(a.beginPosition*=h);a.endPosition&&(a.endPosition*=h);break;case "CIMMarkerPlacementPolygonCenter":a.offsetX&&(a.offsetX*=h);a.offsetY&&
(a.offsetY*=h);break;case "CIMMarkerPlacementInsidePolygon":a.offsetX&&(a.offsetX*=h),a.offsetY&&(a.offsetY*=h),a.stepX&&(a.stepX*=h),a.stepY&&(a.stepY*=h)}}function w(a,h){switch(a.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":a.width&&(a.width*=h);break;case "CIMGeometricEffectBuffer":a.size&&(a.size*=h);break;case "CIMGeometricEffectCut":a.beginCut&&(a.beginCut*=h);a.endCut&&(a.endCut*=h);a.middleCut&&(a.middleCut*=h);break;case "CIMGeometricEffectDashes":a.customEndingOffset&&
(a.customEndingOffset*=h);a.offsetAlongLine&&(a.offsetAlongLine*=h);if(a.dashTemplate&&a.dashTemplate.length){const e=a.dashTemplate.map(t=>t*h);a.dashTemplate=e}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":a.length&&(a.length*=h);break;case "CIMGeometricEffectMove":a.offsetX&&(a.offsetX*=h);a.offsetY&&(a.offsetY*=h);break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":a.offset&&(a.offset*=h);break;case "CIMGeometricEffectRegularPolygon":a.radius&&
(a.radius*=h);break;case "CIMGeometricEffectTaperedPolygon":a.fromWidth&&(a.fromWidth*=h);a.length&&(a.length*=h);a.toWidth&&(a.toWidth*=h);break;case "CIMGeometricEffectWave":a.amplitude&&(a.amplitude*=h),a.period&&(a.period*=h)}}function O(a,h){if(a){var e="CIMTextSymbol"===a.type?a.symbol:a;a="CIMPolygonSymbol"===a.type;if(e?.symbolLayers)for(const t of e.symbolLayers)if(!(t.colorLocked||a&&(J.isCIMStroke(t)||J.isCIMMarker(t)&&t.markerPlacement&&J.isCIMMarkerStrokePlacement(t.markerPlacement))))switch(t.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":t.tintColor&&
r(h,t.tintColor);break;case "CIMVectorMarker":t.markerGraphics?.forEach(n=>{O(n.symbol,h)});break;case "CIMSolidStroke":case "CIMSolidFill":r(h,t.color);break;case "CIMHatchFill":O(t.lineSymbol,h)}}}function r(a,h){for(const e of a)if(e.join(".")===h.join("."))return;a.push(h)}function c(a,h,e){if(a){var t="CIMTextSymbol"===a.type?a.symbol:a;a="CIMPolygonSymbol"===t?.type;if(t?.symbolLayers)for(const n of t.symbolLayers)if(!n.colorLocked){if(a)if(e){if({layersToColor:t}=e,(J.isCIMStroke(n)||J.isCIMMarker(n)&&
n.markerPlacement&&J.isCIMMarkerStrokePlacement(n.markerPlacement))&&"fill"===t||J.isCIMFill(n)&&"outline"===t)continue}else if(J.isCIMStroke(n)||J.isCIMMarker(n)&&n.markerPlacement&&J.isCIMMarkerStrokePlacement(n.markerPlacement))continue;t=h.toArray();switch(n.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":n.tintColor=t;break;case "CIMVectorMarker":n.markerGraphics?.forEach(K=>{c(K.symbol,h,e)});break;case "CIMSolidStroke":case "CIMSolidFill":n.color=t;break;case "CIMHatchFill":c(n.lineSymbol,
h,e)}}}}A.applyCIMSymbolColor=function(a,h,e){h instanceof H||(h=new H(h));(a=J.toCIMSymbolJSON(a))&&c(a,h,e)};A.applyCIMSymbolRotation=function(a,h,e=!1){a=J.toCIMSymbolJSON(a);e&&0!==h&&(h=360-h);if("CIMTextSymbol"===a?.type)a.angle=h;else if("CIMPointSymbol"===a?.type&&a.symbolLayers){e=h-(a.angle||0);for(const t of a.symbolLayers)if(J.isCIMMarker(t)){let n=t.rotation||0;n=t.rotateClockwise?n-e:n+e;t.rotation=n}a.angle=h}};A.getCIMSymbolColor=function(a){a=J.toCIMSymbolJSON(a);const h=[];O(a,h);
return h.length?new H(J.fromCIMColor(h[0])):null};A.getCIMSymbolRotation=function(a,h=!1){a=J.toCIMSymbolJSON(a);return"CIMTextSymbol"===a?.type||"CIMPointSymbol"===a?.type?(a=a.angle,null!=a&&0!==a&&h?360-a:a??0):0};A.getCIMSymbolSize=B;A.getCIMSymbolType=function(a){a=J.toCIMSymbolJSON(a);if(!a)return null;switch(a.type){case "CIMPointSymbol":return"CIMPointSymbol";case "CIMLineSymbol":return"CIMLineSymbol";case "CIMPolygonSymbol":return"CIMPolygonSymbol";case "CIMTextSymbol":return"CIMTextSymbol";
case "CIMMeshSymbol":return"CIMMeshSymbol";default:return null}};A.scaleCIMMarker=L;A.scaleCIMSymbol=q;A.scaleCIMSymbolTo=function(a,h,e){if(a){var t=J.toCIMSymbolJSON(a);a=B(a);if(0===a){if(t)if("CIMTextSymbol"===t.type)t.height=h;else if(t.symbolLayers)for(const n of t.symbolLayers)switch(n.type){case "CIMPictureMarker":case "CIMVectorMarker":n.size=h;break;case "CIMPictureStroke":case "CIMSolidStroke":n.width=h}}else q(t,h/a,!1,e)}};Object.defineProperty(A,Symbol.toStringTag,{value:"Module"})})},
"esri/symbols/cim/utils":function(){define(["require","exports"],function(A,H){function J(c){let a=c.length;for(;a--;)if(!" /-,\n".includes(c.charAt(a)))return!1;return!0}function B(c,a){const h=[];var e=0;let t=-1;do t=c.indexOf("[",e),t>=e&&(t>e&&(e=c.substr(e,t-e),h.push([e,null,J(e)])),e=t+1,t=c.indexOf("]",e),t>=e&&(t>e&&(e=c.substr(e,t-e),(e=a[e])&&h.push([null,e,!1])),e=t+1));while(-1!==t);e<c.length-1&&(c=c.substr(e),h.push([c,null,J(c)]));return h}function q(c,a,h){let e="",t=null;for(const n of a){const [K,
S,D]=n;if(K)D?t=K:(t&&(e+=t,t=null),e+=K);else if(a=c.attributes[S])t&&(e+=t,t=null),e+=a}return L(e,h)}function L(c,a){"string"!==typeof c&&(c=String(c));switch(a){case "LowerCase":return c.toLowerCase();case "Allcaps":return c.toUpperCase();default:return c}}function N(c){return c?{r:c[0],g:c[1],b:c[2],a:c[3]/255}:{r:0,g:0,b:0,a:0}}function w(c){if(!c)return null;switch(c.type){case "CIMPolygonSymbol":if(c.symbolLayers)for(const a of c.symbolLayers)if(c=w(a),null!=c)return c;break;case "CIMTextSymbol":return w(c.symbol);
case "CIMSolidFill":return c.color}}function O(c){if(c)switch(c.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(c=c.symbolLayers)for(const a of c)if(c=O(a),null!=c)return c;break;case "CIMTextSymbol":return O(c.symbol);case "CIMSolidStroke":case "CIMSolidFill":return c.color}}function r(c){if(c)switch(c.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(c.symbolLayers)for(const a of c.symbolLayers)if(c=r(a),void 0!==c)return c;break;case "CIMTextSymbol":return r(c.symbol);case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return c.width}}
H.adjustTextCase=L;H.analyzeTextParts=B;H.assignTextValuesFromFeature=q;H.attributesToFields=function(c){return(c?Object.keys(c):[]).map(a=>({name:a,alias:a,type:"string"===typeof c[a]?"esriFieldTypeString":"esriFieldTypeDouble"}))};H.colorToArray=function(c){return[c.r,c.g,c.b,c.a]};H.createLabelOverrideFunction=function(c,a,h){const e=B(a,c);return t=>q(t,e,h)};H.evaluateValueOrFunction=function(c,a,h,e){return"function"===typeof c?c(a,h,e):c};H.fromCIMColor=N;H.fromCIMFontDecoration=function(c){return c.underline?
"underline":c.strikethrough?"line-through":"none"};H.fromCIMFontStyle=function(c){let a="",h="";c&&(c=c.toLowerCase(),c.includes("italic")?a="italic":c.includes("oblique")&&(a="oblique"),c.includes("bold")?h="bold":c.includes("light")&&(h="lighter"));return{style:a,weight:h}};H.fromCIMHorizontalAlignment=function(c){switch(c){default:return"left";case "Right":return"right";case "Center":return"center";case "Justify":return"center"}};H.fromCIMVerticalAlignment=function(c){switch(c){default:return"top";
case "Center":return"middle";case "Baseline":return"baseline";case "Bottom":return"bottom"}};H.getFillColor=w;H.getFontStyle=function(c){if(!c)return"normal";switch(c.toLowerCase()){case "italic":return"italic";case "oblique":return"oblique";default:return"normal"}};H.getFontWeight=function(c){if(!c)return"normal";switch(c.toLowerCase()){case "bold":return"bold";case "bolder":return"bolder";case "lighter":return"lighter";default:return"normal"}};H.getStrokeColor=O;H.getStrokeWidth=r;H.getTintColor=
c=>c.tintColor?N(c.tintColor):{r:255,g:255,b:255,a:1};H.getValue=(c,a=0)=>null==c||isNaN(c)?a:c;H.importGeometryEngine=function(){return new Promise((c,a)=>A(["../../geometry/geometryEngineJSON"],c,a))};H.isCIMFill=function(c){return null!=c&&("CIMGradientFill"===c.type||"CIMHatchFill"===c.type||"CIMPictureFill"===c.type||"CIMSolidFill"===c.type||"CIMWaterFill"===c.type)};H.isCIMMarker=function(c){return"CIMVectorMarker"===c.type||"CIMPictureMarker"===c.type||"CIMBarChartMarker"===c.type||"CIMCharacterMarker"===
c.type||"CIMPieChartMarker"===c.type||"CIMStackedBarChartMarker"===c.type};H.isCIMMarkerStrokePlacement=function(c){return null!=c&&("CIMMarkerPlacementAlongLineRandomSize"===c.type||"CIMMarkerPlacementAlongLineSameSize"===c.type||"CIMMarkerPlacementAlongLineVariableSize"===c.type||"CIMMarkerPlacementAtExtremities"===c.type||"CIMMarkerPlacementAtMeasuredUnits"===c.type||"CIMMarkerPlacementAtRatioPositions"===c.type||"CIMMarkerPlacementOnLine"===c.type||"CIMMarkerPlacementOnVertices"===c.type)};H.isCIMStroke=
function(c){return"CIMGradientStroke"===c.type||"CIMPictureStroke"===c.type||"CIMSolidStroke"===c.type};H.isGeometryEngineRequired=c=>{if(!c)return!1;for(const a of c)switch(a.type){case "CIMGeometricEffectBuffer":case "CIMGeometricEffectOffset":case "CIMGeometricEffectDonut":return!0}return!1};H.isSVGImage=c=>c.includes("data:image/svg+xml");H.mapCIMSymbolToGeometryType=function(c){if(!c)return null;switch(c.type){case "CIMPointSymbol":case "CIMTextSymbol":return"esriGeometryPoint";case "CIMLineSymbol":return"esriGeometryPolyline";
case "CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}};H.resampleHermite=function(c,a,h,e,t,n,K=!0){const S=a/t;h/=n;const D=Math.ceil(S/2),u=Math.ceil(h/2);for(let F=0;F<n;F++)for(let k=0;k<t;k++){const g=4*(k+(K?n-F-1:F)*t);var f=0;let C=0,R=0,T=0,x=0,P=0,l=0;const z=(F+.5)*h;for(let W=Math.floor(F*h);W<(F+1)*h;W++){var p=Math.abs(z-(W+.5))/u;const M=(k+.5)*S;p*=p;for(let d=Math.floor(k*S);d<(k+1)*S;d++){let y=Math.abs(M-(d+.5))/D;f=Math.sqrt(p+y*y);-1<=f&&1>=f&&(f=2*f*f*f-3*
f*f+1,0<f&&(y=4*(d+W*a),l+=f*c[y+3],R+=f,255>c[y+3]&&(f=f*c[y+3]/250),T+=f*c[y],x+=f*c[y+1],P+=f*c[y+2],C+=f))}}e[g]=T/C;e[g+1]=x/C;e[g+2]=P/C;e[g+3]=l/R}};H.toCIMSymbolJSON=function(c){return c.data?.symbol??null};Object.defineProperty(H,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/previewUtils":function(){define(["exports","../../Color"],function(A,H){function J(B,q){return Math.round(Math.min(Math.max(B+191.25*q,0),255))}A.SymbolSizeDefaults=void 0;(function(B){B[B.size=22]="size";
B[B.lineWidth=50]="lineWidth";B[B.maxSize=120]="maxSize";B[B.maxOutlineSize=80]="maxOutlineSize";B[B.tallSymbolWidth=20]="tallSymbolWidth"})(A.SymbolSizeDefaults||(A.SymbolSizeDefaults={}));A.adjustColorBrightness=function(B,q){if(null==B)return new H;if("type"in B&&("linear"===B.type||"pattern"===B.type))return B;B=new H(B);return new H([J(B.r,q),J(B.g,q),J(B.b,q),B.a])};A.adjustColorComponentBrightness=J;A.getConeShapes=function(B,q){let L=q?A.SymbolSizeDefaults.tallSymbolWidth:B;q=q?4:6;L=L<=A.SymbolSizeDefaults.size?
L-.5*q:L-q;q=.15*L;const N=L;B-=q;return[{type:"ellipse",cx:.5*L,cy:B,rx:.5*L,ry:q},{type:"path",path:[{command:"M",values:[.5*N,0]},{command:"L",values:[N,B]},{command:"L",values:[0,B]},{command:"Z",values:[]}]}]};A.getCubeShapes=function(B,q){let L=q?A.SymbolSizeDefaults.tallSymbolWidth:B;var N=q?4:6;N=L=L<=A.SymbolSizeDefaults.size?L-.5*N:L-N;q=q?.35*L:.5*L;return[{type:"path",path:[{command:"M",values:[.5*N,0]},{command:"L",values:[N,.5*q]},{command:"L",values:[.5*N,q]},{command:"L",values:[0,
.5*q]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*q]},{command:"L",values:[.5*N,q]},{command:"L",values:[.5*N,B]},{command:"L",values:[0,B-.5*q]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*N,q]},{command:"L",values:[.5*N,B]},{command:"L",values:[N,B-.5*q]},{command:"L",values:[N,.5*q]},{command:"Z",values:[]}]}]};A.getCylinderShapes=function(B,q){var L=q?A.SymbolSizeDefaults.tallSymbolWidth:B;q=q?4:6;L=L<=A.SymbolSizeDefaults.size?L-.5*q:L-q;q=
.5*L;const N=.15*L;B-=N;return[{type:"ellipse",cx:.5*L,cy:B,rx:q,ry:N},{type:"path",path:[{command:"M",values:[0,N]},{command:"L",values:[0,B]},{command:"L",values:[L,B]},{command:"L",values:[L,N]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*L,cy:N,rx:q,ry:N}]};A.getDiamondShapes=function(B){var q=B;q=q<A.SymbolSizeDefaults.size?q-2:q-4;const L=Math.floor(B/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*q,0]},{command:"L",values:[q,.5*B-L]},{command:"L",values:[.45*q-L,.5*B+L]},{command:"Z",
values:[]}]},{type:"path",path:[{command:"M",values:[.45*q,0]},{command:"L",values:[.45*q-L,.5*B+L]},{command:"L",values:[0,.5*B-L]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*B-L]},{command:"L",values:[.45*q-L,.5*B+L]},{command:"L",values:[.45*q,B]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*q,B]},{command:"L",values:[q,.5*B-L]},{command:"L",values:[.45*q-L,.5*B+L]},{command:"Z",values:[]}]}]};A.getExtrudeSymbolShapes=function(B){const q=A.SymbolSizeDefaults.size;
B*=.5;return[{type:"path",path:[{command:"M",values:[0,.35*q]},{command:"L",values:[.3*q,.7*q]},{command:"L",values:[.3*q,.7*q+B]},{command:"L",values:[0,.7*q+B-.35*q]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*q,.7*q]},{command:"L",values:[.3*q,.7*q+B]},{command:"L",values:[q,B]},{command:"L",values:[q,0]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*q,0]},{command:"L",values:[q,0]},{command:"L",values:[.3*q,.7*q]},{command:"L",values:[0,.35*q]},
{command:"Z",values:[]}]}]};A.getInvertedConeShapes=function(B){let q=B;q=q<A.SymbolSizeDefaults.size?q-3:q-6;const L=.15*q,N=q;return[{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[N,0]},{command:"L",values:[.5*N,B-L]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*q,cy:0,rx:.5*q,ry:L}]};A.getPathSymbolShapes=function(B,q,L){var N=A.SymbolSizeDefaults.size;let w=N,O=N;1>B?w*=.75:1<B&&(O*=1.25);B=N;q&&L&&(w=O=B=N=0);return[{type:"path",path:[{command:"M",values:[B,0]},{command:"L",
values:[L?B:.875*B,0]},{command:"L",values:[L?w-.5*B:0,O-.5*N]},{command:"L",values:[w-.5*B,O-.5*N]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[B,0]},{command:"L",values:[B,q?0:.125*N]},{command:"L",values:[w-.5*B,q?O-.5*N:N]},{command:"L",values:[w-.5*B,O-.5*N]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[w-.5*B,O-.5*N]},{command:"L",values:[L?w-.5*B:0,O-.5*N]},{command:"L",values:[L?w-.5*B:0,q?O-.5*N:N]},{command:"L",values:[w-.5*B,q?O-.5*N:N]},{command:"Z",
values:[]}]}]};A.getTetrahedronShapes=function(B){var q=B;q=q<A.SymbolSizeDefaults.size?q-1:q-2;return[{type:"path",path:[{command:"M",values:[.45*B,0]},{command:"L",values:[B,q]},{command:"L",values:[.45*B,.6*q]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*B,0]},{command:"L",values:[.45*B,.6*q]},{command:"L",values:[0,q]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,q]},{command:"L",values:[.45*B,.6*q]},{command:"L",values:[B,q]},{command:"Z",values:[]}]}]};
A.getWaterSymbolShapes=function(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},
{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]};
A.shapes={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],squareFill:[{type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],
cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],
tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",
path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};Object.defineProperty(A,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/renderUtils":function(){define("exports ../../kernel ../../request ../../core/colorUtils ../../core/Error ../../core/has ../../libs/maquette/projection ../../libs/maquette/projector ./svgUtils ./utils".split(" "),
function(A,H,J,B,q,L,N,w,O,r){function c(e,t){h.append(e,t);h.detach(t)}function a(e,t,n){return e?J(e,{responseType:"image"}).then(K=>{K=K.data;const S=K.width,D=K.height,u=S/D;let f=t;n&&(f=Math.min(f,Math.max(S,D)));return{image:K,width:1>=u?Math.ceil(f*u):f,height:1>=u?f:Math.ceil(f/u)}}):Promise.reject(new q("renderUtils: imageDataSize","href not provided."))}const h=w.createProjector();A.renderOnce=c;A.renderSymbol=function(e,t,n){const K=Math.ceil(t[0]),S=Math.ceil(t[1]);if(!e.some(D=>!!D.length))return null;
t=n&&n.node||document.createElement("div");null!=n.opacity&&(t.style.opacity=n.opacity.toString());null!=n.effectView&&(t.style.filter=r.getCSSFilterFromEffectList(n.effectView));c(t,()=>O.renderSVG(e,K,S,n));return t};A.tintImageWithColor=function(e,t,n,K,S){return a(e,t,S).then(D=>{const u=D.width?D.width:t,f=D.height?D.height:t;var p;if(p=D.image)p=n&&"ignore"!==K?"multiply"===K&&255===n.r&&255===n.g&&255===n.b&&1===n.a?!1:!0:!1;if(p){var F=D.image.width,k=D.image.height;L("edge")&&/\.svg$/i.test(e)&&
(--F,--k);p=Math.ceil(u);var g=Math.ceil(f);var C=document.createElement("canvas");C.width=p;C.height=g;C.style.width=p+"px";C.style.height=g+"px";C=C.getContext("2d");C.clearRect(0,0,p,g);p=C;p.drawImage(D.image,0,0,F,k,0,0,u,f);g=p.getImageData(0,0,u,f);C=[n.r/255,n.g/255,n.b/255,n.a];const T=B.toHSV(n);for(let x=0;x<g.data.length;x+=4){D=g.data;F=x;k=C;var R=T;switch(K){case "multiply":D[F+0]*=k[0];D[F+1]*=k[1];D[F+2]*=k[2];D[F+3]*=k[3];break;default:const P=B.toHSV({r:D[F+0],g:D[F+1],b:D[F+2]});
P.h=R.h;P.s=R.s;P.v=P.v/100*R.v;R=B.toRGB(P);D[F+0]=R.r;D[F+1]=R.g;D[F+2]=R.b;D[F+3]*=k[3]}}p.putImageData(g,0,0);e=p.canvas.toDataURL("image/png")}else(p=H.id&&H.id.findCredential(e))&&p.token&&(D=e.includes("?")?"\x26":"?",e=`${e}${D}token=${p.token}`);return{url:e,width:u,height:f}}).catch(()=>({url:e,width:t,height:t}))};Object.defineProperty(A,Symbol.toStringTag,{value:"Module"})})},"esri/core/colorUtils":function(){define(["exports"],function(A){function H(r,c){const a=[];let h,e;if(r[0].length!==
c.length)throw Error("dimensions do not match");const t=r.length,n=r[0].length;let K=0;for(h=0;h<t;h++){for(e=K=0;e<n;e++)K+=r[h][e]*c[e];a.push(K)}return a}function J(r){r=[r.r/255,r.g/255,r.b/255].map(c=>.04045>=c?c/12.92:((c+.055)/1.055)**2.4);r=H(w,r);return{x:100*r[0],y:100*r[1],z:100*r[2]}}function B(r){r=H(O,[r.x/100,r.y/100,r.z/100]).map(c=>Math.min(1,Math.max(.0031308>=c?12.92*c:1.055*c**(1/2.4)-.055,0)));return{r:Math.round(255*r[0]),g:Math.round(255*r[1]),b:Math.round(255*r[2])}}function q(r){r=
[r.x/95.047,r.y/100,r.z/108.883].map(c=>c>(6/29)**3?c**(1/3):1/3*(29/6)**2*c+4/29);return{l:116*r[1]-16,a:500*(r[0]-r[1]),b:200*(r[1]-r[2])}}function L(r){const c=r.l;r=[(c+16)/116+r.a/500,(c+16)/116,(c+16)/116-r.b/200].map(a=>a>6/29?a**3:3*(6/29)**2*(a-4/29));return{x:95.047*r[0],y:100*r[1],z:108.883*r[2]}}function N(r){if("r"in r&&"g"in r&&"b"in r)return r;if("l"in r&&"c"in r&&"h"in r){var c=r.c,a=r.h;return B(L({l:r.l,a:c*Math.cos(a),b:c*Math.sin(a)}))}if("l"in r&&"a"in r&&"b"in r)return B(L(r));
if("x"in r&&"y"in r&&"z"in r)return B(r);if("h"in r&&"s"in r&&"v"in r){a=(r.h+360)%360/60;c=r.v/100*255;r=r.s/100*c;const h=r*(1-Math.abs(a%2-1));switch(Math.floor(a)){case 0:a={r,g:h,b:0};break;case 1:a={r:h,g:r,b:0};break;case 2:a={r:0,g:r,b:h};break;case 3:a={r:0,g:h,b:r};break;case 4:a={r:h,g:0,b:r};break;case 5:case 6:a={r,g:0,b:h};break;default:a={r:0,g:0,b:0}}a.r=Math.round(a.r+c-r);a.g=Math.round(a.g+c-r);a.b=Math.round(a.b+c-r);return a}return r}const w=[[.4124,.3576,.1805],[.2126,.7152,
.0722],[.0193,.1192,.9505]],O=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];A.darken=function(r,c){r=q(J(r));r.l*=1-c;return B(L(r))};A.toHSV=function(r){if("h"in r&&"s"in r&&"v"in r)return r;var c=N(r);r=c.r;const a=c.g,h=c.b;c=Math.max(r,a,h);const e=c-Math.min(r,a,h);r=0===e?0:c===r?(a-h)/e%6:c===a?(h-r)/e+2:(r-a)/e+4;0>r&&(r+=6);return{h:60*r,s:100*(0===e?0:e/c),v:100/255*c}};A.toLAB=function(r){return"l"in r&&"a"in r&&"b"in r?r:q(J(N(r)))};A.toLCH=function(r){if(!("l"in
r&&"c"in r&&"h"in r)){var c=q(J(N(r)));r=c.l;var a=c.a;const h=c.b;c=Math.sqrt(a*a+h*h);a=Math.atan2(h,a);a=0<a?a:a+2*Math.PI;r={l:r,c,h:a}}return r};A.toRGB=N;A.toXYZ=function(r){return"x"in r&&"y"in r&&"z"in r?r:J(N(r))};Object.defineProperty(A,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/svgUtils":function(){define("exports ../../Color ../../core/has ../../core/maybe ../../chunks/mat2df32 ../../chunks/mat2d ../../widgets/support/widgetUtils ../../widgets/support/jsxFactory".split(" "),
function(A,H,J,B,q,L,N,w){function O(d,y){d*=W/180;return Math.abs(y*Math.sin(d))+Math.abs(y*Math.cos(d))}function r(d){return d.map(y=>`${y.command} ${y.values.join(" ")}`).join(" ").trim()}function c(d,y,E,V){if(d){if("circle"===d.type)return w.tsx("circle",{fill:y,"fill-rule":"evenodd",stroke:E.color,"stroke-width":E.width,"stroke-linecap":E.cap,"stroke-linejoin":E.join,"stroke-dasharray":E.dashArray,"stroke-dashoffset":E.dashOffset,"stroke-miterlimit":"4",cx:d.cx,cy:d.cy,r:d.r});if("ellipse"===
d.type)return w.tsx("ellipse",{fill:y,"fill-rule":"evenodd",stroke:E.color,"stroke-width":E.width,"stroke-linecap":E.cap,"stroke-linejoin":E.join,"stroke-dasharray":E.dashArray,"stroke-miterlimit":"4",cx:d.cx,cy:d.cy,rx:d.rx,ry:d.ry});if("rect"===d.type)return w.tsx("rect",{fill:y,"fill-rule":"evenodd",stroke:E.color,"stroke-width":E.width,"stroke-linecap":E.cap,"stroke-linejoin":E.join,"stroke-dasharray":E.dashArray,"stroke-miterlimit":"4",x:d.x,y:d.y,width:d.width,height:d.height});if("image"===
d.type)return w.tsx("image",{href:d.src,x:d.x,y:d.y,width:d.width,height:d.height,preserveAspectRatio:"none"});if("path"===d.type)return d="string"!==typeof d.path?r(d.path):d.path,w.tsx("path",{fill:y,"fill-rule":"evenodd",stroke:E.color,"stroke-width":E.width,"stroke-linecap":E.cap,"stroke-linejoin":E.join,"stroke-dasharray":E.dashArray,"stroke-miterlimit":"4",d});if("text"===d.type)return B.assertIsSome(V),w.tsx("text",{"dominant-baseline":V.dominantBaseline,fill:y,"fill-rule":"evenodd",stroke:E.color,
"stroke-width":E.width,"stroke-linecap":E.cap,"stroke-linejoin":E.join,"stroke-dasharray":E.dashArray,"stroke-miterlimit":"4","text-anchor":V.align,"text-decoration":V.decoration,kerning:V.kerning,rotate:V.rotate,"text-rendering":R,"font-style":V.font.style,"font-variant":V.font.variant,"font-weight":V.font.weight,"font-size":V.font.size,"font-family":V.font.family,x:d.x,y:d.y},d.text)}return null}function a(d){const y={fill:"none",pattern:null,linearGradient:null};if(d)if("type"in d&&"pattern"===
d.type){var E=`patternId-${++g}`;y.fill=`url(#${E})`;y.pattern={id:E,x:d.x,y:d.y,width:d.width,height:d.height,image:{x:0,y:0,width:d.width,height:d.height,href:d.src}}}else"type"in d&&"linear"===d.type?(E=`linearGradientId-${++C}`,y.fill=`url(#${E})`,y.linearGradient={id:E,x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2,stops:d.colors.map(V=>({offset:V.offset,color:V.color&&(new H(V.color)).toString()}))}):d&&(d=new H(d),y.fill=d.toString());return y}function h(d){const y={color:"none",width:1,cap:"butt",join:"4",
dashArray:"none",dashOffset:"0"};if(d&&(null!=d.width&&(y.width=d.width),d.cap&&(y.cap=d.cap),d.join&&(y.join=d.join.toString()),d.color&&(y.color=(new H(d.color)).toString()),d.dashArray&&(y.dashArray=d.dashArray),d.dashArray&&(y.dashOffset=d.dashoffset),d.style)){let E=null;d.style in z&&(E=z[d.style]);if(Array.isArray(E)){E=E.slice(0);const V=d.width??0;for(let ba=0;ba<E.length;++ba)E[ba]*=V;if("butt"!==d.cap){for(d=0;d<E.length;d+=2)E[d]-=V,1>E[d]&&(E[d]=1);for(d=1;d<E.length;d+=2)E[d]+=V}E=E.join(",")}y.dashArray=
E}return y}function e(d,y){const E={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};if(d){const V=d.alignBaseline;E.align=d.align;E.dominantBaseline="baseline"===V?"auto":"top"===V?"text-top":"bottom"===V?"hanging":V;E.decoration=d.decoration;E.kerning=d.kerning?"auto":"0";E.rotate=d.rotated?"90":"0";B.assertIsSome(y);E.font.style=y.style||"normal";E.font.variant=y.variant||"normal";E.font.weight=y.weight||"normal";E.font.size=
y.size&&y.size.toString()||"10pt";E.font.family=y.family||"serif"}return E}function t(d){const {pattern:y,linearGradient:E}=d;return y?w.tsx("pattern",{id:y.id,patternUnits:"userSpaceOnUse",x:y.x,y:y.y,width:y.width,height:y.height},w.tsx("image",{x:y.image.x,y:y.image.y,width:y.image.width,height:y.image.height,href:y.image.href})):E?(d=E.stops.map((V,ba)=>w.tsx("stop",{key:`${ba}-stop`,offset:V.offset,"stop-color":V.color})),w.tsx("linearGradient",{id:E.id,gradientUnits:"userSpaceOnUse",x1:E.x1,
y1:E.y1,x2:E.x2,y2:E.y2},d)):null}function n(d,y){if(!d)return null;const E=[];for(const V of d){const {shape:ba,fill:aa,stroke:G,font:Q}=V;d=a(aa);const Y=h(G),ca="text"===ba.type?e(ba,Q):null;(d=c(ba,d.fill,Y,ca))&&E.push(d)}return w.tsx("mask",{id:y,maskUnits:"userSpaceOnUse"},w.tsx("g",null,E))}function K(d,y,E,V,ba){L.scale(d,L.identity(d),[y,E]);d[4]=d[4]*y-V*y+V;d[5]=d[5]*E-ba*E+ba;return d}function S(d,y){if(P&&"left"in P){null!=P.left&&P.left>d&&(P.left=d);if(null==P.right||P.right<d)P.right=
d;if(null==P.top||P.top>y)P.top=y;if(null==P.bottom||P.bottom<y)P.bottom=y}else P={left:d,bottom:y,right:d,top:y}}function D(d){const y=d.args,E=y.length;switch(d.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(d=0;d<E;d+=2)S(y[d],y[d+1]);l.x=y[E-2];l.y=y[E-1];break;case "H":for(d=0;d<E;++d)S(y[d],l.y);l.x=y[E-1];break;case "V":for(d=0;d<E;++d)S(l.x,y[d]);l.y=y[E-1];break;case "m":d=0;"x"in l||(S(l.x=y[0],l.y=y[1]),d=2);for(;d<E;d+=2)S(l.x+=y[d],l.y+=y[d+1]);break;case "l":case "t":for(d=
0;d<E;d+=2)S(l.x+=y[d],l.y+=y[d+1]);break;case "h":for(d=0;d<E;++d)S(l.x+=y[d],l.y);break;case "v":for(d=0;d<E;++d)S(l.x,l.y+=y[d]);break;case "c":for(d=0;d<E;d+=6)S(l.x+y[d],l.y+y[d+1]),S(l.x+y[d+2],l.y+y[d+3]),S(l.x+=y[d+4],l.y+=y[d+5]);break;case "s":case "q":for(d=0;d<E;d+=4)S(l.x+y[d],l.y+y[d+1]),S(l.x+=y[d+2],l.y+=y[d+3]);break;case "A":for(d=0;d<E;d+=7)S(y[d+5],y[d+6]);l.x=y[E-2];l.y=y[E-1];break;case "a":for(d=0;d<E;d+=7)S(l.x+=y[d+5],l.y+=y[d+6])}}function u(d,y,E){const V=T[d.toLowerCase()];
"number"===typeof V&&(V?y.length>=V&&(d={action:d,args:y.slice(0,y.length-y.length%V)},E.push(d),D(d)):(d={action:d,args:[]},E.push(d),D(d)))}function f(d){const y={x:0,y:0,width:0,height:0};if("circle"===d.type)y.x=d.cx-d.r,y.y=d.cy-d.r,y.width=2*d.r,y.height=2*d.r;else if("ellipse"===d.type)y.x=d.cx-d.rx,y.y=d.cy-d.ry,y.width=2*d.rx,y.height=2*d.ry;else if("image"===d.type||"rect"===d.type)y.x=d.x,y.y=d.y,y.width=d.width,y.height=d.height;else if("path"===d.type){var E=B.unwrapOrThrow;{const aa=
("string"!==typeof d.path?r(d.path):d.path).match(x),G=[];P={};l={};if(aa){d="";var V=[],ba=aa.length;for(let Q=0;Q<ba;++Q){const Y=aa[Q],ca=parseFloat(Y);isNaN(ca)?(d&&u(d,V,G),V=[],d=Y):V.push(ca)}u(d,V,G);d={x:0,y:0,width:0,height:0};P&&"left"in P&&(d.x=P.left,d.y=P.top,d.width=P.right-P.left,d.height=P.bottom-P.top)}else d=null}E=E.call(B,d);y.x=E.x;y.y=E.y;y.width=E.width;y.height=E.height}return y}function p(d){const y={x:0,y:0,width:0,height:0};let E=null,V=Number.NEGATIVE_INFINITY,ba=Number.NEGATIVE_INFINITY;
for(const aa of d)E?(E.x=Math.min(E.x,aa.x),E.y=Math.min(E.y,aa.y),V=Math.max(V,aa.x+aa.width),ba=Math.max(ba,aa.y+aa.height)):(E=y,E.x=aa.x,E.y=aa.y,V=aa.x+aa.width,ba=aa.y+aa.height);E&&(E.width=V-E.x,E.height=ba-E.y);return E}function F(d,y,E,V,ba,aa,G,Q,Y){var ca=(G&&aa?O(aa,y):y)/2,ia=(G&&aa?O(aa,E):E)/2;if(Y){var ka=Y[0];Y=Y[1];ca=(G&&aa?O(aa,ka):ka)/2;ia=(G&&aa?O(aa,Y):Y)/2}ka=d.width+V;var ja=d.height+V;Y=q.create();G=q.create();var la=!1;if(ba&&0!==ka&&0!==ja){ba=y!==E?y/E:ka/ja;la=y>E?y:
E;let ta=1,ea=1;isNaN(la)||(1<ba?(ta=la/ka,ea=la/ba/ja):(ea=la/ja,ta=la*ba/ka));L.multiply(G,G,K(Y,ta,ea,ca,ia));la=!0}ba=d.x+(ka-V)/2;d=d.y+(ja-V)/2;V=L.multiply;ca-=ba;ia-=d;ca=L.translate(Y,L.identity(Y),[ca,ia]);V.call(L,G,G,ca);!la&&(ka>y||ja>E)&&(ca=ka/y>ja/E,y=(ca?y:E)/(ca?ka:ja),L.multiply(G,G,K(Y,y,y,ba,d)));aa&&(y=L.multiply,E=aa%360*Math.PI/180,L.rotate(Y,L.identity(Y),E),aa=Math.cos(E),E=Math.sin(E),ka=Y[4],ja=Y[5],Y[4]=ka*aa-ja*E+d*E-ba*aa+ba,Y[5]=ja*aa+ka*E-ba*E-d*aa+d,y.call(L,G,G,
Y));Q&&(aa=L.multiply,y=Q[0],Q=Q[1],Q=L.translate(Y,L.identity(Y),[y,Q]),aa.call(L,G,G,Q));return`matrix(${G[0]},${G[1]},${G[2]},${G[3]},${G[4]},${G[5]})`}function k(d,y,E){d=d?.effects.find(Q=>"bloom"===Q.type);if(!d)return null;const {strength:V,radius:ba}=d;d=0<V?ba:0;const aa=(V+d)*y,G=4*V+1;return w.tsx("filter",{id:`bloom${E}`,x:"-100%",y:"-100%",width:"300%",height:"300%",filterUnits:"userSpaceOnUse"},w.tsx("feMorphology",{operator:"dilate",radius:(V+.5*d)*5**(y/100)*(.4+y/100),in:"SourceGraphic",
result:"dilate"}),w.tsx("feGaussianBlur",{in:"dilate",stdDeviation:aa/25,result:"blur"}),w.tsx("feGaussianBlur",{in:"blur",stdDeviation:aa/50,result:"intensityBlur"}),w.tsx("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},w.tsx("feFuncR",{type:"linear",slope:G}),w.tsx("feFuncG",{type:"linear",slope:G}),w.tsx("feFuncB",{type:"linear",slope:G})),w.tsx("feMerge",null,w.tsx("feMergeNode",{in:"intensityBlur"}),w.tsx("feMergeNode",{in:"intensityBrightness"}),w.tsx("feGaussianBlur",
{stdDeviation:V/10})))}let g=0,C=0;N=J("android");const R=J("chrome")||N&&4<=N?"auto":"optimizeLegibility",T={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},x=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;let P={},l={};const z={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]},W=Math.PI;let M=1;A.computeBBox=p;A.generateFillAttributes=a;A.generateStrokeAttributes=
h;A.generateTextAttributes=e;A.getBoundingBox=f;A.getTransformMatrix=F;A.renderDef=t;A.renderSVG=function(d,y,E,V={}){const ba=[],aa=[],G=++M,Q=k(V.effectView,y,G);var Y=null;Q&&(Y=V.effectView?.effects.find(la=>"bloom"===la.type),Y=(Y.strength?Y.strength+Y.radius/2:0)/3,Y=[Math.max(y+y*Y,10),Math.max(E+E*Y,10)]);for(let la=0;la<d.length;la++){var ca=d[la];const ta=[];var ia=[],ka=0,ja=0;let ea=0;for(const sa of ca){const {shape:na,fill:pa,stroke:qa,font:za,offset:xa}=sa;V.ignoreStrokeWidth||(ka+=
qa&&qa.width||0);ca=a(pa);const Ea=h(qa),Da="text"===na.type?e(na,za):null;ba.push(t(ca));ta.push(c(na,ca.fill,Ea,Da));ia.push(f(na));xa&&(ja+=xa[0],ea+=xa[1])}ia=B.unwrapOrThrow(p(ia));ka=F(ia,y,E,ka,V.scale??!1,V.rotation,V.useRotationSize??!1,[ja,ea],Y);ja=null;V.masking&&(ja=`mask-${la}`,ba.push(n(V.masking[la],ja)),ja=`url(#${ja})`);aa.push(ja?w.tsx("g",{mask:ja},w.tsx("g",{transform:ka},ta)):w.tsx("g",{transform:ka},ta))}V.useRotationSize&&V.rotation&&(y=O(V.rotation,y),E=O(V.rotation,E));Q&&
(B.assertIsSome(Y),y=Y[0],E=Y[1]);return w.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:y,height:E,style:"display: block;"},Q,w.tsx("defs",null,ba),Q?w.tsx("g",{filter:`url(#bloom${G})`},aa):aa)};A.renderShape=c;Object.defineProperty(A,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/mat2df32":function(){define(["exports"],function(A){function H(){const O=new Float32Array(6);O[0]=1;O[3]=1;return O}function J(O){const r=new Float32Array(6);r[0]=O[0];r[1]=O[1];r[2]=O[2];r[3]=O[3];r[4]=O[4];
r[5]=O[5];return r}function B(O,r,c,a,h,e){const t=new Float32Array(6);t[0]=O;t[1]=r;t[2]=c;t[3]=a;t[4]=h;t[5]=e;return t}function q(O,r){return new Float32Array(O,r,6)}function L(O,r,c,a){const h=r[a];r=r[a+1];O[a]=c[0]*h+c[2]*r+c[4];O[a+1]=c[1]*h+c[3]*r+c[5]}function N(O,r,c,a=0,h=0,e=2){for(h=h||r.length/e;a<h;a++)L(O,r,c,a*e)}const w=Object.freeze(Object.defineProperty({__proto__:null,clone:J,create:H,createView:q,fromValues:B,transform:L,transformMany:N},Symbol.toStringTag,{value:"Module"}));
A.clone=J;A.create=H;A.createView=q;A.fromValues=B;A.mat2df32=w;A.transform=L;A.transformMany=N})},"esri/chunks/mat2d":function(){define(["exports","./common"],function(A,H){function J(k,g){k[0]=g[0];k[1]=g[1];k[2]=g[2];k[3]=g[3];k[4]=g[4];k[5]=g[5];return k}function B(k){k[0]=1;k[1]=0;k[2]=0;k[3]=1;k[4]=0;k[5]=0;return k}function q(k,g,C,R,T,x,P){k[0]=g;k[1]=C;k[2]=R;k[3]=T;k[4]=x;k[5]=P;return k}function L(k,g){const C=g[0],R=g[1],T=g[2],x=g[3],P=g[4];g=g[5];let l=C*x-R*T;if(!l)return null;l=1/
l;k[0]=x*l;k[1]=-R*l;k[2]=-T*l;k[3]=C*l;k[4]=(T*g-x*P)*l;k[5]=(R*P-C*g)*l;return k}function N(k){return k[0]*k[3]-k[1]*k[2]}function w(k,g,C){const R=g[0],T=g[1],x=g[2],P=g[3],l=g[4];g=g[5];const z=C[0],W=C[1],M=C[2],d=C[3],y=C[4];C=C[5];k[0]=R*z+x*W;k[1]=T*z+P*W;k[2]=R*M+x*d;k[3]=T*M+P*d;k[4]=R*y+x*C+l;k[5]=T*y+P*C+g;return k}function O(k,g,C){const R=g[0],T=g[1],x=g[2],P=g[3],l=g[4];g=g[5];const z=Math.sin(C);C=Math.cos(C);k[0]=R*C+x*z;k[1]=T*C+P*z;k[2]=R*-z+x*C;k[3]=T*-z+P*C;k[4]=l;k[5]=g;return k}
function r(k,g,C){const R=g[1],T=g[2],x=g[3],P=g[4],l=g[5],z=C[0];C=C[1];k[0]=g[0]*z;k[1]=R*z;k[2]=T*C;k[3]=x*C;k[4]=P;k[5]=l;return k}function c(k,g,C){const R=g[0],T=g[1],x=g[2],P=g[3],l=g[4];g=g[5];const z=C[0];C=C[1];k[0]=R;k[1]=T;k[2]=x;k[3]=P;k[4]=R*z+x*C+l;k[5]=T*z+P*C+g;return k}function a(k,g){const C=Math.sin(g);g=Math.cos(g);k[0]=g;k[1]=C;k[2]=-C;k[3]=g;k[4]=0;k[5]=0;return k}function h(k,g){k[0]=g[0];k[1]=0;k[2]=0;k[3]=g[1];k[4]=0;k[5]=0;return k}function e(k,g){k[0]=1;k[1]=0;k[2]=0;k[3]=
1;k[4]=g[0];k[5]=g[1];return k}function t(k){return"mat2d("+k[0]+", "+k[1]+", "+k[2]+", "+k[3]+", "+k[4]+", "+k[5]+")"}function n(k){return Math.sqrt(k[0]**2+k[1]**2+k[2]**2+k[3]**2+k[4]**2+k[5]**2+1)}function K(k,g,C){k[0]=g[0]+C[0];k[1]=g[1]+C[1];k[2]=g[2]+C[2];k[3]=g[3]+C[3];k[4]=g[4]+C[4];k[5]=g[5]+C[5];return k}function S(k,g,C){k[0]=g[0]-C[0];k[1]=g[1]-C[1];k[2]=g[2]-C[2];k[3]=g[3]-C[3];k[4]=g[4]-C[4];k[5]=g[5]-C[5];return k}function D(k,g,C){k[0]=g[0]*C;k[1]=g[1]*C;k[2]=g[2]*C;k[3]=g[3]*C;
k[4]=g[4]*C;k[5]=g[5]*C;return k}function u(k,g,C,R){k[0]=g[0]+C[0]*R;k[1]=g[1]+C[1]*R;k[2]=g[2]+C[2]*R;k[3]=g[3]+C[3]*R;k[4]=g[4]+C[4]*R;k[5]=g[5]+C[5]*R;return k}function f(k,g){return k[0]===g[0]&&k[1]===g[1]&&k[2]===g[2]&&k[3]===g[3]&&k[4]===g[4]&&k[5]===g[5]}function p(k,g){const C=k[0],R=k[1],T=k[2],x=k[3],P=k[4];k=k[5];const l=g[0],z=g[1],W=g[2],M=g[3],d=g[4];g=g[5];const y=H.getEpsilon();return Math.abs(C-l)<=y*Math.max(1,Math.abs(C),Math.abs(l))&&Math.abs(R-z)<=y*Math.max(1,Math.abs(R),Math.abs(z))&&
Math.abs(T-W)<=y*Math.max(1,Math.abs(T),Math.abs(W))&&Math.abs(x-M)<=y*Math.max(1,Math.abs(x),Math.abs(M))&&Math.abs(P-d)<=y*Math.max(1,Math.abs(P),Math.abs(d))&&Math.abs(k-g)<=y*Math.max(1,Math.abs(k),Math.abs(g))}const F=Object.freeze(Object.defineProperty({__proto__:null,add:K,copy:J,determinant:N,equals:p,exactEquals:f,frob:n,fromRotation:a,fromScaling:h,fromTranslation:e,identity:B,invert:L,mul:w,multiply:w,multiplyScalar:D,multiplyScalarAndAdd:u,rotate:O,scale:r,set:q,str:t,sub:S,subtract:S,
translate:c},Symbol.toStringTag,{value:"Module"}));A.add=K;A.copy=J;A.determinant=N;A.equals=p;A.exactEquals=f;A.frob=n;A.fromRotation=a;A.fromScaling=h;A.fromTranslation=e;A.identity=B;A.invert=L;A.mat2d=F;A.mul=w;A.multiply=w;A.multiplyScalar=D;A.multiplyScalarAndAdd=u;A.rotate=O;A.scale=r;A.set=q;A.str=t;A.sub=S;A.subtract=S;A.translate=c})},"esri/symbols/support/utils":function(){define("require exports ../../chunks/_rollupPluginBabelHelpers ../../Color ../../symbols ../../core/asyncUtils ../../core/has ../../core/maybe ../../core/screenUtils ../../chunks/vec3f64 ../../layers/effects/jsonUtils ./gfxUtils ./Symbol3DMaterial".split(" "),
function(A,H,J,B,q,L,N,w,O,r,c,a,h){function e(l){l=l.symbolLayers;if(!l)return null;let z=null;l.forEach(W=>{if("object"!==W.type||null==W.resource?.href)z="water"===W.type?w.unwrap(W.color):w.isSome(W.material)?w.unwrap(W.material.color):null});return z?new B(z):null}function t(l,z){if(null==z||null==l)return l;l=l.toRgba();l[3]*=z;return new B(l)}function n(l,z,W){if(l=l.symbolLayers){var M=d=>{d=w.isSome(d)?d:null;z=z??d??(null!=W?P:null);return t(z,W)};l.forEach(d=>{if("object"!==d.type||null==
d.resource?.href||z)if("water"===d.type)d.color=M(d.color);else{var y=w.isSome(d.material)?d.material.color:null;y=M(y);w.isNone(d.material)?d.material=new h.Symbol3DMaterial({color:y}):d.material.color=y;null!=W&&"outline"in d&&w.isSome(d.outline)&&w.isSome(d.outline.color)&&(d.outline.color=t(d.outline.color,W))}})}}function K(l,z){return S.apply(this,arguments)}function S(){S=J._asyncToGenerator(function*(l,z){(l=l.symbolLayers)&&(yield L.forEach(l,function(){var W=J._asyncToGenerator(function*(M){return D(M,
z)});return function(M){return W.apply(this,arguments)}}()))});return S.apply(this,arguments)}function D(l,z){return u.apply(this,arguments)}function u(){u=J._asyncToGenerator(function*(l,z){switch(l.type){case "extrude":l.size="number"===typeof z[2]?z[2]:0;break;case "icon":case "line":case "text":z=f(z);w.isSome(z)&&(l.size=z);break;case "path":const W=k(z,r.ONES,[l.width,void 0,l.height]);l.width=R(z[0],l.width,1,W);l.height=R(z[2],l.height,1,W);break;case "object":yield p(l,z)}});return u.apply(this,
arguments)}function f(l){for(const z of l)if("number"===typeof z)return z;return null}function p(l,z){return F.apply(this,arguments)}function F(){F=J._asyncToGenerator(function*(l,z){const {resourceSize:W,symbolSize:M}=yield g(l),d=k(z,W,M);l.width=R(z[0],M[0],W[0],d);l.depth=R(z[1],M[1],W[1],d);l.height=R(z[2],M[2],W[2],d)});return F.apply(this,arguments)}function k(l,z,W){for(let M=0;3>M;M++){const d=l[M];switch(d){case "symbol-value":return l=W[M],null!=l?l/z[M]:1;case "proportional":break;default:if(d&&
z[M])return d/z[M]}}return 1}function g(l){return C.apply(this,arguments)}function C(){C=J._asyncToGenerator(function*(l){const z=yield(yield new Promise((V,ba)=>A(["./symbolLayerUtils"],V,ba))).computeObjectLayerResourceSize(l,10),{width:W,height:M,depth:d}=l;l=[W,d,M];let y=1;for(var E=0;3>E;E++){const V=l[E];if(null!=V){y=V/z[E];break}}for(E=0;3>E;E++)null==l[E]&&(l[E]=z[E]*y);return{resourceSize:z,symbolSize:l}});return C.apply(this,arguments)}function R(l,z,W,M){switch(l){case "proportional":return W*
M;case "symbol-value":return null!=z?z:W;default:return l}}function T(){T=J._asyncToGenerator(function*(l,z){if(l&&z){if(q.isSymbol3D(l))return K(l,z);if(q.isSymbol2D(l)&&(z=f(z),!w.isNone(z)))switch(l.type){case "simple-marker":l.size=z;break;case "picture-marker":const W=l.width/l.height;1<W?(l.width=z,l.height=z*W):(l.width=z*W,l.height=z);break;case "simple-line":l.width=z;break;case "text":l.font.size=z}}});return T.apply(this,arguments)}function x(){x=J._asyncToGenerator(function*(l,z){const W=
yield l.fetchSymbol(z);return W?W:l.fetchCIMSymbol(z)});return x.apply(this,arguments)}const P=new B("white");H.applyColorToSymbol=function(l,z,W){if(l&&(z||null!=W))if(z&&(z=new B(z)),q.isSymbol3D(l))n(l,z,W);else if(q.isSymbol2D(l)){if(z=z??l.color)l.color=t(z,W);null!=W&&"outline"in l&&l.outline&&l.outline.color&&(l.outline.color=t(l.outline.color,W))}};H.applyOpacityToColor=t;H.applyRotationToSymbol=function(l,z,W){l&&null!=z&&(q.isSymbol3D(l)?(l=l.symbolLayers)&&l.forEach(M=>{if(M&&"object"===
M.type)switch(W){case "tilt":M.tilt=z;break;case "roll":M.roll=z;break;default:M.heading=z}}):!q.isSymbol2D(l)||"simple-marker"!==l.type&&"picture-marker"!==l.type&&"text"!==l.type||(l.angle=z))};H.applySizesToSymbol=function(l,z){return T.apply(this,arguments)};H.fetchWebStyleSymbol=function(l,z){return x.apply(this,arguments)};H.getCSSFilterFromEffectList=function(l){if(!l)return null;l=l.effects.filter(z=>"bloom"!==z.type).map(z=>z.toJSON());return c.effectFunctionsFromJSON(l)};H.getColorFromSymbol=
function(l,z){if(!l)return null;let W=null;q.isSymbol3D(l)?W=e(l):q.isSymbol2D(l)&&(W=l.color?new B(l.color):null);return W?t(W,z):null};H.getIconHref=function(l){return w.unwrapOrThrow(l.resource).href};H.getSymbolOutlineSize=function(l){if(!l)return 0;if(q.isSymbol3D(l)){{const z=l.symbolLayers&&l.symbolLayers.length;z?(l=l.symbolLayers.getItemAt(z-1),l="outline"in l?w.get(l,"outline","size"):void 0):l=void 0}return w.isSome(l)?l:0}return O.px2pt(a.getStroke(l)?.width)};H.isVolumetricSymbol=function(l){if(w.isNone(l)||
!("symbolLayers"in l)||w.isNone(l.symbolLayers))return!1;switch(l.type){case "point-3d":return l.symbolLayers.some(z=>"object"===z.type);case "line-3d":return l.symbolLayers.some(z=>"path"===z.type);case "polygon-3d":return l.symbolLayers.some(z=>"object"===z.type||"extrude"===z.type);default:return!1}};H.symbolHasExtrudeSymbolLayer=function(l){return w.isSome(l)&&"polygon-3d"===l.type&&l.symbolLayers.some(z=>"extrude"===z.type)};Object.defineProperty(H,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/gfxUtils":function(){define("exports ../../assets ../../Color ../../request ../../core/ItemCache ../../core/screenUtils ./cimSymbolUtils".split(" "),
function(A,H,J,B,q,L,N){function w(c){if(!c)return null;let a=null;switch(c.type){case "simple-fill":case "picture-fill":case "simple-marker":a=w(c.outline);break;case "simple-line":const h=L.pt2px(c.width);null!=c.style&&"none"!==c.style&&0!==h&&(a={color:c.color,style:r(c.style),width:h,cap:c.cap,join:"miter"===c.join?L.pt2px(c.miterLimit):c.join});break;default:a=null}return a}const O=new q(1E3),r=(()=>{const c={};return a=>{if(c[a])return c[a];const h=a.replace(/-/g,"");return c[a]=h}})();J=new J([128,
128,128]);A.defaultThematicColor=J;A.dekebabifyLineStyle=r;A.getFill=function(c){const a=c.style;let h=null;if(c)switch(c.type){case "simple-marker":"cross"!==a&&"x"!==a&&(h=c.color);break;case "simple-fill":"solid"===a?h=c.color:"none"!==a&&(h={type:"pattern",x:0,y:0,src:H.getAssetUrl(`esri/symbols/patterns/${a}.png`),width:5,height:5});break;case "picture-fill":h={type:"pattern",src:c.url,width:L.pt2px(c.width)*c.xscale,height:L.pt2px(c.height)*c.yscale,x:L.pt2px(c.xoffset),y:L.pt2px(c.yoffset)};
break;case "text":h=c.color;break;case "cim":h=N.getCIMSymbolColor(c)}return h};A.getPatternUrlWithColor=function(c,a){const h=c+"-"+a;return void 0!==O.get(h)?Promise.resolve(O.get(h)):B(c,{responseType:"image"}).then(e=>{e=e.data;const t=e.naturalWidth,n=e.naturalHeight,K=document.createElement("canvas");K.width=t;K.height=n;const S=K.getContext("2d");S.fillStyle=a;S.fillRect(0,0,t,n);S.globalCompositeOperation="destination-in";S.drawImage(e,0,0);e=K.toDataURL();O.put(h,e);return e})};A.getStroke=
w;Object.defineProperty(A,Symbol.toStringTag,{value:"Module"})})},"esri/core/ItemCache":function(){define(["./MemCache"],function(A){return function(){function H(B,q){this._storage=new A.MemCacheStorage;this._storage.maxSize=B;q&&this._storage.registerRemoveFunc("",q)}var J=H.prototype;J.put=function(B,q){this._storage.put(B,q,1,1)};J.pop=function(B){return this._storage.pop(B)};J.get=function(B){return this._storage.get(B)};J.clear=function(){this._storage.clearAll()};J.destroy=function(){this._storage.destroy()};
return H}()})},"esri/symbols/support/symbolUtils":function(){define("require exports ../../chunks/_rollupPluginBabelHelpers ../../core/has ../../core/maybe ../../support/arcadeOnDemand ./gfxUtils ./previewUtils ./renderUtils ./utils ../../widgets/Legend/styles/support/relationshipUtils ../../widgets/Legend/support/relationshipRampUtils".split(" "),function(A,H,J,B,q,L,N,w,O,r,c,a){function h(f,p){if(p&&(f.style.filter=r.getCSSFilterFromEffectList(p),p=p.effects))for(const F of p)if("drop-shadow"===
F?.type){0>F.offsetX?f.style.marginLeft=`${Math.abs(F.offsetX)}px`:f.style.marginRight=`${F.offsetX}px`;break}}function e(f,p){return t.apply(this,arguments)}function t(){t=J._asyncToGenerator(function*(f,p){switch(f.type){case "web-style":var {previewWebStyleSymbol:F}=yield new Promise((k,g)=>A(["./previewWebStyleSymbol"],k,g));return F(f,e,p);case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return{previewSymbol3D:F}=yield new Promise((k,g)=>A(["./previewSymbol3D"],
k,g)),F(f,p);case "simple-marker":case "simple-line":case "simple-fill":case "picture-marker":case "picture-fill":case "text":return{previewSymbol2D:F}=yield new Promise((k,g)=>A(["./previewSymbol2D"],k,g)),F(f,p);case "cim":return{previewCIMSymbol:F}=yield new Promise((k,g)=>A(["./previewCIMSymbol"],k,g)),F(f,p)}});return t.apply(this,arguments)}function n(f){return f&&"opacity"in f?f.opacity*n(f.parent):1}function K(){K=J._asyncToGenerator(function*(f,p){if(f){var F=f.sourceLayer,k=(q.isSome(p)&&
(p.useSourceLayer??!1)?F:f.layer)??F;F=n(k);if(q.isSome(f.symbol)&&(!q.isSome(p)||!0!==p.ignoreGraphicSymbol))return f="web-style"===f.symbol.type?yield r.fetchWebStyleSymbol(f.symbol,{...p,cache:q.isSome(p)?p.webStyleCache:null}):f.symbol.clone(),r.applyColorToSymbol(f,null,F),f;var g=(q.isSome(p)?p.renderer:null)??(k&&"renderer"in k?k.renderer:null);if(k=g&&"getSymbolAsync"in g?yield g.getSymbolAsync(f,p):null){k="web-style"===k.type?yield k.fetchSymbol({...p,cache:q.isSome(p)?p.webStyleCache:null}):
k.clone();if(!(g&&"visualVariables"in g&&g.visualVariables&&g.visualVariables.length))return r.applyColorToSymbol(k,null,F),k;"arcadeRequiredForVisualVariables"in g&&g.arcadeRequiredForVisualVariables&&(q.isNone(p)||q.isNone(p.arcade))&&(p={...q.unwrap(p)},p.arcade=yield L.loadArcade());var C=yield new Promise((z,W)=>A(["../../renderers/visualVariables/support/visualVariableUtils"],z,W)),R=[],T=[],x=[],P=[];for(var l of g.visualVariables)switch(l.type){case "color":R.push(l);break;case "opacity":T.push(l);
break;case "rotation":P.push(l);break;case "size":l.target||x.push(l)}l=(l=!!R.length&&R[R.length-1])?C.getColor(l,f,p):null;T=(T=!!T.length&&T[T.length-1])?C.getOpacity(T,f,p):null;null!=F&&(T=null!=T?T*F:F);r.applyColorToSymbol(k,l,T);x.length&&(F=C.getAllSizes(x,f,p),yield r.applySizesToSymbol(k,F));for(const z of P)r.applyRotationToSymbol(k,C.getRotationAngle(z,f,p),z.axis);return k}}});return K.apply(this,arguments)}function S(){S=J._asyncToGenerator(function*(f,p){if(f){var F=n(f.layer||f.sourceLayer);
if(q.isSome(f.symbol)&&(!q.isSome(p)||!0!==p.ignoreGraphicSymbol))return f="web-style"===f.symbol.type?yield r.fetchWebStyleSymbol(f.symbol,p):f.symbol.clone(),r.getColorFromSymbol(f,F);var k=q.isSome(p)&&p.renderer||f.get("layer.renderer")||f.get("sourceLayer.renderer"),g=yield k.getSymbolAsync(f,p);if(g){g="web-style"===g.type?yield r.fetchWebStyleSymbol(g,p):g.clone();var C=r.getColorFromSymbol(g,F);if(!("visualVariables"in k)||"visualVariables"in k&&!k.visualVariables||"visualVariables"in k&&
!k.visualVariables?.length)return C;k.arcadeRequiredForVisualVariables&&(q.isNone(p)||q.isNone(p.arcade))&&(p={...q.unwrap(p)},p.arcade=yield L.loadArcade());g=yield new Promise((x,P)=>A(["../../renderers/visualVariables/support/visualVariableUtils"],x,P));var R=[],T=[];for(const x of k.visualVariables)switch(x.type){case "color":R.push(x);break;case "opacity":T.push(x)}k=(k=0<R.length?R[R.length-1]:null)?g.getColor(k,f,p):C;f=(C=0<T.length?T[T.length-1]:null)?g.getOpacity(C,f,p):null;null!=F&&(f=
null!=f?f*F:F);return k?r.applyOpacityToColor(k,f):null}}});return S.apply(this,arguments)}let D=null;const u=[255,255,255];H.getDisplayedColor=function(f,p){return S.apply(this,arguments)};H.getDisplayedSymbol=function(f,p){return K.apply(this,arguments)};H.renderColorRampPreviewHTML=function(f,p={}){var F="horizontal"===p.align;const {width:k=F?75:24,height:g=F?24:75,gradient:C=!0}=p;var R=window.devicePixelRatio,T=k*R,x=g*R;R=document.createElement("canvas");R.width=T;R.height=x;R.style.width=
`${k}px`;R.style.height=`${g}px`;const P=R.getContext("2d");var l=F?T:0,z=F?0:x;if(C){const W=P.createLinearGradient(0,0,l,z);F=f.length;const M=1===F?0:1/(F-1);f.forEach((d,y)=>W.addColorStop(y*M,d.toString()));P.fillStyle=W;P.fillRect(0,0,T,x)}else{T=F?T/f.length:T;x=F?x:x/f.length;z=l=0;for(const W of f)P.fillStyle=W.toString(),P.fillRect(l,z,T,x),l=F?l+T:0,z=F?0:z+x}f=document.createElement("div");f.style.width=`${k}px`;f.style.height=`${g}px`;h(f,p?.effectList);f.appendChild(R);return f};H.renderDotDensityPreviewHTML=
function(f,p,F){const {backgroundColor:k,outline:g,dotSize:C}=f;F=F&&F.swatchSize||w.SymbolSizeDefaults.size;const R=Math.round(F*F/C**2*.8),T=window.devicePixelRatio;f=document.createElement("canvas");const x=F*T;f.width=x;f.height=x;f.style.width=`${f.width/T}px`;f.style.height=`${f.height/T}px`;const P=f.getContext("2d");k&&(P.fillStyle=k.toCss(!0),P.fillRect(0,0,x,x),P.fill());P.fillStyle=p.toCss(!0);if(D&&D.length/2===R)for(p=0;p<2*R;p+=2)P.fillRect(D[p],D[p+1],C*T,C*T),P.fill();else for(D=[],
p=0;p<2*R;p+=2){const l=Math.floor(Math.random()*(x-0+1)),z=Math.floor(Math.random()*(x-0+1));D.push(l,z);P.fillRect(l,z,C*T,C*T);P.fill()}g&&(g.color&&(P.strokeStyle=g.color.toCss(!0)),P.lineWidth=g.width,P.strokeRect(0,0,x,x));F=new Image(F,F);F.src=f.toDataURL();return F};H.renderPieChartPreviewHTML=function(f,p={}){const F=p.radius||40;var k=2*Math.PI*F,g=f.length;const C=k/g,R=[],T=N.getStroke(p.outline);null!=T?.width&&(T.width*=2);(T||p.backgroundColor)&&R.push({shape:{type:"circle",cx:F,cy:F,
r:F},fill:p.backgroundColor,stroke:T,offset:[0,0]});const x=p.values,P=x&&x.length===g&&100===x.reduce((z,W)=>z+W,0),l=[0];for(let z=0;z<g;z++){let W=null;P&&(W=x[z]*k/100,l.push(W+l[z]));R.push({shape:{type:"circle",cx:F,cy:F,r:F/2},fill:[0,0,0,0],stroke:{width:F,dashArray:`${(W??C)/2} ${k}`,dashoffset:`-${P?l[z]/2:C/2*z}`,color:f[z]},offset:[0,0]})}g=null;f=2*F+(T?.width||0);if(k=p.holePercentage)T&&R.push({shape:{type:"circle",cx:F,cy:F,r:F*k},fill:null,stroke:T,offset:[0,0]}),g=f/2,g=[[{shape:{type:"circle",
cx:g,cy:g,r:g},fill:u,stroke:T?{...T,color:u}:null,offset:[0,0]},{shape:{type:"circle",cx:g,cy:g,r:F*k},fill:[0,0,0],stroke:null,offset:[0,0]}]];return O.renderSymbol([R],[f,f],{effectView:p.effectList,ignoreStrokeWidth:!0,masking:g,rotation:-90})};H.renderPreviewHTML=e;H.renderRelationshipRampPreviewHTML=function(f,p={}){const F=f?.authoringInfo;if("relationship"!==F?.type||!F?.numClasses||!f.uniqueValueInfos)return null;const {focus:k,numClasses:g}=F,C=a.getRelationshipRampElement({focus:k,numClasses:g,
infos:f.uniqueValueInfos});f=p&&p.node||document.createElement("div");O.renderOnce(f,()=>c.renderRelationshipRamp(C,p.id||"relationship",p.opacity||1,p.effectList));return f};Object.defineProperty(H,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/support/relationshipUtils":function(){define(["exports","../../../../symbols/support/svgUtils","../../../../symbols/support/utils","../../../support/widgetUtils","../../../support/jsxFactory"],function(A,H,J,B,q){function L(O,r,c){const a=
`${c}_arrowStart`;c=`${c}_arrowEnd`;O="left"===O;const h={markerStart:null,markerEnd:null};switch(r){case "HL":O?h.markerStart=`url(#${c})`:h.markerEnd=`url(#${a})`;break;case "LL":h.markerStart=`url(#${c})`;break;case "LH":O?h.markerEnd=`url(#${a})`:h.markerStart=`url(#${c})`;break;default:h.markerEnd=`url(#${a})`}return h}function N(O,r,c,a,h=60){const {focus:e,numClasses:t,colors:n,rotation:K}=O;O=!!e;const S=Math.sqrt(h**2+h**2)+(O?0:5),D=[],u=[];var f=[],p=(h||75)/t;for(var F=0;F<t;F++){var k=
F*p;for(var g=0;g<t;g++){var C=g*p,R=H.generateFillAttributes(n[F][g]);const T=H.generateStrokeAttributes(null);C={type:"rect",x:C,y:k,width:p,height:p};const x=H.renderDef(R);x&&D.push(x);(R=H.renderShape(C,R.fill,T,null))&&u.push(R);f.push(H.getBoundingBox(C))}}p=null;O||(p="margin: -15px -15px -18px -15px");F=L("left",e,r);k=L("right",e,r);g=H.computeBBox(f);f=H.getTransformMatrix(g,S,S,0,!1,K,!1);g=H.getTransformMatrix(g,S,S,0,!1,O?-45:null,!1);c={filter:J.getCSSFilterFromEffectList(a),opacity:null==
c?"":`${c}`};return q.tsx("div",{styles:c,class:O?w.diamondMidColRamp:w.squareTableCell},q.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:S,height:S,style:p},q.tsx("defs",null,q.tsx("marker",{id:`${r}_arrowStart`,markerWidth:"10",markerHeight:"10",refX:"5",refY:"5",markerUnits:"strokeWidth",orient:"auto"},q.tsx("polyline",{points:"0,0 5,5 0,10",fill:"none",stroke:"#555555","stroke-width":"1"})),q.tsx("marker",{id:`${r}_arrowEnd`,markerWidth:"10",markerHeight:"10",refX:"0",refY:"5",markerUnits:"strokeWidth",
orient:"auto"},q.tsx("polyline",{points:"5,0 0,5 5,10",fill:"none",stroke:"#555555","stroke-width":"1"})),D),q.tsx("g",{transform:f},u),q.tsx("g",{transform:g},q.tsx("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":F.markerStart,"marker-end":F.markerEnd,x1:-10,y1:h-15,x2:-10,y2:15}),q.tsx("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":k.markerStart,"marker-end":k.markerEnd,x1:15,y1:h+10,x2:h-15,y2:h+10}))))}const w={diamondContainer:"esri-relationship-ramp--diamond__container",
diamondLeftCol:"esri-relationship-ramp--diamond__left-column",diamondRightCol:"esri-relationship-ramp--diamond__right-column",diamondMidCol:"esri-relationship-ramp--diamond__middle-column",diamondMidColLabel:"esri-relationship-ramp--diamond__middle-column--label",diamondMidColRamp:"esri-relationship-ramp--diamond__middle-column--ramp",squareTable:"esri-relationship-ramp--square__table",squareTableRow:"esri-relationship-ramp--square__table-row",squareTableCell:"esri-relationship-ramp--square__table-cell",
squareTableLabel:"esri-relationship-ramp--square__table-label",squareTableLabelLeftBottom:"esri-relationship-ramp--square__table-label--left-bottom",squareTableLabelRightBottom:"esri-relationship-ramp--square__table-label--right-bottom",squareTableLabelLeftTop:"esri-relationship-ramp--square__table-label--left-top",squareTableLabelRightTop:"esri-relationship-ramp--square__table-label--right-top"};A.renderRelationshipRamp=function(O,r,c,a){const {focus:h,labels:e}=O,t=!!h;O=N(O,r,c,a);r={justifyContent:"center"};
c=B.isRTL();return t?q.tsx("div",{class:w.diamondContainer,styles:r},q.tsx("div",{class:w.diamondLeftCol},c?e.right:e.left),q.tsx("div",{class:w.diamondMidCol},q.tsx("div",{class:w.diamondMidColLabel},e.top),O,q.tsx("div",{class:w.diamondMidColLabel},e.bottom)),q.tsx("div",{class:w.diamondRightCol},c?e.left:e.right)):q.tsx("div",{class:w.squareTable},q.tsx("div",{class:w.squareTableRow},q.tsx("div",{class:B.classes(w.squareTableCell,w.squareTableLabel,w.squareTableLabelRightBottom)},c?e.top:e.left),
q.tsx("div",{class:w.squareTableCell}),q.tsx("div",{class:B.classes(w.squareTableCell,w.squareTableLabel,w.squareTableLabelLeftBottom)},c?e.left:e.top)),q.tsx("div",{class:w.squareTableRow},q.tsx("div",{class:w.squareTableCell}),O,q.tsx("div",{class:w.squareTableCell})),q.tsx("div",{class:w.squareTableRow},q.tsx("div",{class:B.classes(w.squareTableCell,w.squareTableLabel,w.squareTableLabelRightTop)},c?e.right:e.bottom),q.tsx("div",{class:w.squareTableCell}),q.tsx("div",{class:B.classes(w.squareTableCell,
w.squareTableLabel,w.squareTableLabelLeftTop)},c?e.bottom:e.right)))};Object.defineProperty(A,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/relationshipRampUtils":function(){define(["exports","../../../core/lang","../../../symbols/support/gfxUtils","../../../symbols/support/previewSymbol3D"],function(A,H,J,B){function q(r){if(r){var {type:c}=r;return c.includes("3d")?B.getSymbolLayerFill(r.symbolLayers.getItemAt(0)):"simple-line"===c||"simple-marker"===r.type&&("x"===r.style||
"cross"===r.style)?(r=J.getStroke(r))&&r.color:J.getFill(r)}}function L(r,c){const a=c.HH.label,h=c.LL.label,e=c.HL.label;c=c.LH.label;switch(r){case "HH":return{top:a,bottom:h,left:e,right:c};case "HL":return{top:e,bottom:c,left:h,right:a};case "LL":return{top:h,bottom:a,left:c,right:e};case "LH":return{top:c,bottom:e,left:a,right:h};default:return{top:a,bottom:h,left:e,right:c}}}function N(r){let c=w[r];r&&null==c&&(c=w.HH);return c||0}const w={HH:315,HL:45,LL:135,LH:225},O={2:[["HL","HH"],["LL",
"LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};A.getRelationshipRampColors2D=function(r,c){const a=[],h=r.length**.5;r=H.clone(r);var e=(c||"HH").split("");c=e[0];for(e="H"===e[1];r.length;){const t=[];for(;t.length<h;)t.push(r.shift());e&&t.reverse();a.push(t)}"L"===c&&a.reverse();return a};A.getRelationshipRampElement=function(r){const {focus:c,infos:a,numClasses:h}=r;var e=
O[h];const t={};a.forEach(n=>{t[n.value]={label:n.label,fill:q(n.symbol)}});r=[];for(let n=0;n<h;n++){const K=[];for(let S=0;S<h;S++)K.push(t[e[n][S]].fill);r.push(K)}e=L(c,t);return{type:"relationship-ramp",numClasses:h,focus:c,colors:r,labels:e,rotation:N(c)}};A.getRotationAngleForFocus=N;Object.defineProperty(A,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/previewSymbol3D":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../assets ../../core/colorUtils ../../core/has ../../core/Error ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/screenUtils ./gfxUtils ./IconSymbol3DLayerResource ./ObjectSymbol3DLayerResource ./previewUtils ./renderUtils ./utils ./webStyleSymbolUtils".split(" "),
function(A,H,J,B,q,L,N,w,O,r,c,a,h,e,t,n,K){function S(G){const Q=G.outline;var Y=w.isSome(G.material)?G.material.color:null;Y=w.isSome(Y)?Y.toHex():null;if(w.isNone(Q)||"pattern"in Q&&w.isSome(Q.pattern)&&"style"===Q.pattern.type&&"none"===Q.pattern.style)return"fill"===G.type&&"#ffffff"===Y?{color:"#bdc3c7",width:.75}:null;G=r.pt2px(Q.size)||0;return{color:"rgba("+(w.isSome(Q.color)?Q.color.toRgba():"255,255,255,1")+")",width:Math.min(G,V),style:"pattern"in Q&&w.isSome(Q.pattern)&&"style"===Q.pattern.type?
c.dekebabifyLineStyle(Q.pattern.style):null,join:"butt",cap:"patternCap"in Q?Q.patternCap:"butt"}}function D(G,Q){var Y=Q&&Q.resource;Y=Y&&Y.href;if(G.thumbnail&&G.thumbnail.url)return Promise.resolve(G.thumbnail.url);if(Y&&"object"!==Q.type)return Promise.resolve(n.getIconHref(Q));const ca=J.getAssetUrl("esri/images/Legend/legend3dsymboldefault.png");return G.styleOrigin&&(G.styleOrigin.styleName||G.styleOrigin.styleUrl)?K.resolveWebStyleSymbol(G.styleOrigin,{portal:G.styleOrigin.portal},"webRef").catch(ia=>
ia).then(ia=>ia?.thumbnail?.url||ca):Promise.resolve(ca)}function u(G,Q=1){const Y=G.a;G=B.toHSV(G);const {r:ca,g:ia,b:ka}=B.toRGB({h:G.h,s:G.s/Q,v:100-(100-G.v)/Q});return[ca,ia,ka,Y]}function f(G){return"water"===G.type?w.isNone(G.color)?null:G.color:w.isNone(G.material)||w.isNone(G.material.color)?null:G.material.color}function p(G,Q=0){var Y=f(G);if(!Y){if("fill"===G.type)return null;Q=e.adjustColorComponentBrightness(c.defaultThematicColor.r,Q);return[Q,Q,Q,100]}G=Y.toRgba();for(Y=0;3>Y;Y++)G[Y]=
e.adjustColorComponentBrightness(G[Y],Q);return G}function F(G,Q){return k.apply(this,arguments)}function k(){k=H._asyncToGenerator(function*(G,Q){G=G.style;return"none"===G?null:{type:"pattern",x:0,y:0,src:yield c.getPatternUrlWithColor(J.getAssetUrl(`esri/symbols/patterns/${G}.png`),Q.toCss(!0)),width:5,height:5}});return k.apply(this,arguments)}function g(G){return G.outline?S(G):{color:"rgba(0, 0, 0, 1)",width:1.5}}function C(G,Q){G=f(G);if(!G)return null;let Y;Y="rgba("+(e.adjustColorComponentBrightness(G.r,
Q)+",");Y+=e.adjustColorComponentBrightness(G.g,Q)+",";Y+=e.adjustColorComponentBrightness(G.b,Q)+",";return Y+G.a+");"}function R(G,Q){Q=C(G,Q);if(!Q)return{};if("pattern"in G&&w.isSome(G.pattern)&&"style"===G.pattern.type&&"none"===G.pattern.style)return null;const Y=Math.min(G.size?r.pt2px(G.size):.75,V);return{color:Q,width:Y,style:"pattern"in G&&w.isSome(G.pattern)&&"style"===G.pattern.type?c.dekebabifyLineStyle(G.pattern.style):null,cap:"cap"in G?G.cap:null,join:"join"in G?"miter"===G.join?
r.pt2px(2):G.join:null}}function T(G,Q,Y){Y=null!=Y?.75*Y:0;return{type:"linear",x1:Y?.25*Y:0,y1:Y?.5*Y:0,x2:Y||4,y2:Y?.5*Y:4,colors:[{color:G,offset:0},{color:Q,offset:1}]}}function x(G){const Q=G.depth,Y=G.height;G=G.width;return 0!==G&&0!==Q&&0!==Y&&G===Q&&null!=G&&null!=Y&&G<Y}function P(G,Q,Y){const ca=[];if(!G)return ca;switch(G.type){case "icon":switch(G.resource&&G.resource.primitive||a.defaultPrimitive){case "circle":ca.push({shape:{type:"circle",cx:0,cy:0,r:.5*Q},fill:p(G,0),stroke:S(G)});
break;case "square":ca.push({shape:{type:"path",path:[{command:"M",values:[0,Q]},{command:"L",values:[0,0]},{command:"L",values:[Q,0]},{command:"L",values:[Q,Q]},{command:"Z",values:[]}]},fill:p(G,0),stroke:S(G)});break;case "triangle":ca.push({shape:{type:"path",path:[{command:"M",values:[0,Q]},{command:"L",values:[.5*Q,0]},{command:"L",values:[Q,Q]},{command:"Z",values:[]}]},fill:p(G,0),stroke:S(G)});break;case "cross":ca.push({shape:{type:"path",path:[{command:"M",values:[.5*Q,0]},{command:"L",
values:[.5*Q,Q]},{command:"M",values:[0,.5*Q]},{command:"L",values:[Q,.5*Q]}]},stroke:g(G)});break;case "x":ca.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[Q,Q]},{command:"M",values:[Q,0]},{command:"L",values:[0,Q]}]},stroke:g(G)});break;case "kite":ca.push({shape:{type:"path",path:[{command:"M",values:[0,.5*Q]},{command:"L",values:[.5*Q,0]},{command:"L",values:[Q,.5*Q]},{command:"L",values:[.5*Q,Q]},{command:"Z",values:[]}]},fill:p(G,0),stroke:S(G)})}break;case "object":switch(G.resource&&
G.resource.primitive||h.defaultPrimitive){case "cone":var ia=p(G,0);G=p(G,-.6);G=T(ia,G,Y?aa:Q);Q=e.getConeShapes(Q,Y);ca.push({shape:Q[0],fill:G});ca.push({shape:Q[1],fill:G});break;case "inverted-cone":Y=p(G,0);G=p(G,-.6);G=T(Y,G,Q);Q=e.getInvertedConeShapes(Q);ca.push({shape:Q[0],fill:G});ca.push({shape:Q[1],fill:Y});break;case "cube":Q=e.getCubeShapes(Q,Y);ca.push({shape:Q[0],fill:p(G,0)});ca.push({shape:Q[1],fill:p(G,-.3)});ca.push({shape:Q[2],fill:p(G,-.5)});break;case "cylinder":ia=p(G,0);
const ka=p(G,-.6);ia=T(ia,ka,Y?aa:Q);Q=e.getCylinderShapes(Q,Y);ca.push({shape:Q[0],fill:ia});ca.push({shape:Q[1],fill:ia});ca.push({shape:Q[2],fill:p(G,0)});break;case "diamond":Q=e.getDiamondShapes(Q);ca.push({shape:Q[0],fill:p(G,-.3)});ca.push({shape:Q[1],fill:p(G,0)});ca.push({shape:Q[2],fill:p(G,-.3)});ca.push({shape:Q[3],fill:p(G,-.7)});break;case "sphere":Y=p(G,0);G=p(G,-.6);G=T(Y,G);G.x1=0;G.y1=0;G.x2=.25*Q;G.y2=.25*Q;ca.push({shape:{type:"circle",cx:0,cy:0,r:.5*Q},fill:G});break;case "tetrahedron":Q=
e.getTetrahedronShapes(Q),ca.push({shape:Q[0],fill:p(G,-.3)}),ca.push({shape:Q[1],fill:p(G,0)}),ca.push({shape:Q[2],fill:p(G,-.6)})}}return ca}function l(G){return(G="number"===typeof G?.size?G?.size:null)?r.pt2px(G):null}function z(G,Q){const Y=l(Q),ca=Q?.maxSize?r.pt2px(Q.maxSize):null,ia=Q?.disableUpsampling??!1,ka=G.symbolLayers,ja=[];let la=0,ta=0;const ea=ka.getItemAt(ka.length-1);let sa;ea&&"icon"===ea.type&&(sa=ea.size&&r.pt2px(ea.size));ka.forEach(na=>{if("icon"===na.type||"object"===na.type){var pa=
"icon"===na.type?na.size&&r.pt2px(na.size):0,qa=Y||pa?Math.ceil(Math.min(Y||pa,ca||E)):y;if(na&&na.resource&&na.resource.href){var za=D(G,na).then(xa=>{const Ea=na.get("material.color");var Da="icon"===na.type?"multiply":"tint";return t.tintImageWithColor(xa,qa,Ea,Da,ia)}).then(xa=>{const Ea=xa.width,Da=xa.height;la=Math.max(la,Ea);ta=Math.max(ta,Da);return[{shape:{type:"image",x:0,y:0,width:Ea,height:Da,src:xa.url},fill:null,stroke:null}]});ja.push(za)}else za=qa,"icon"===na.type&&sa&&Y&&(za=pa/
sa*qa),pa="tall"===Q?.symbolConfig||Q?.symbolConfig?.isTall||("object"===na.type?x(na):!1),la=Math.max(la,pa?aa:za),ta=Math.max(ta,za),ja.push(Promise.resolve(P(na,za,pa)))}});return O.eachAlways(ja).then(na=>{const pa=[];na.forEach(qa=>{qa.value?pa.push(qa.value):qa.error&&N.getLogger("esri.symbols.support.previewSymbol3D").warn("error while building swatchInfo!",qa.error)});return t.renderSymbol(pa,[la,ta],{node:Q&&Q.node,scale:!1,opacity:Q&&Q.opacity})})}function W(G,Q){const Y=G.symbolLayers,
ca=[];G=n.isVolumetricSymbol(G);const ia=l(Q),ka=(Q&&Q.maxSize?r.pt2px(Q.maxSize):null)||V;let ja=0,la=0,ta;Y.forEach((ea,sa)=>{if(ea&&("line"===ea.type||"path"===ea.type)){var na=[];switch(ea.type){case "line":var pa=R(ea,0);if(w.isNone(pa))break;var qa=pa&&pa.width||0;0===sa&&(ta=qa);ea=Math.min(ia||qa,ka);sa=0===sa?ea:ia?qa/ta*ea:ea;qa=sa>ba/2?2*sa:ba;la=Math.max(la,sa);ja=Math.max(ja,qa);pa.width=sa;na.push({shape:{type:"path",path:[{command:"M",values:[0,.5*la]},{command:"L",values:[ja,.5*la]}]},
stroke:pa});break;case "path":pa=Math.min(ia||y,ka);sa=p(ea,0);qa=p(ea,-.2);var za=C(ea,-.4);za=za?{color:za,width:1}:{};if("quad"===ea.profile){const xa=ea.width;ea=ea.height;ea=e.getPathSymbolShapes(xa&&ea?xa/ea:1,0===ea,0===xa);za={...za,join:"bevel"};na.push({shape:ea[0],fill:qa,stroke:za});na.push({shape:ea[1],fill:qa,stroke:za});na.push({shape:ea[2],fill:sa,stroke:za})}else na.push({shape:e.shapes.pathSymbol3DLayer[0],fill:qa,stroke:za}),na.push({shape:e.shapes.pathSymbol3DLayer[1],fill:sa,
stroke:za});ja=la=Math.max(la,pa)}ca.push(na)}});return Promise.resolve(t.renderSymbol(ca,[ja,la],{node:Q&&Q.node,scale:G,opacity:Q&&Q.opacity}))}function M(G,Q){return d.apply(this,arguments)}function d(){d=H._asyncToGenerator(function*(G,Q){const Y="mesh-3d"===G.type;G=G.symbolLayers;var ca=l(Q);const ia=Q&&Q.maxSize?r.pt2px(Q.maxSize):null;ca=ca||y;const ka=[];let ja=0,la=0;var ta=!1;for(let za=0;za<G.length;za++){var ea=G.getItemAt(za);const xa=[];if(!Y||"fill"===ea.type){var sa=e.shapes.fill[0];
switch(ea.type){case "fill":var na=S(ea);ta=Math.min(ca,ia||E);ja=Math.max(ja,ta);la=Math.max(la,ta);ta=!0;var pa=p(ea,0),qa="pattern"in ea?ea.pattern:null;ea=f(ea);!Y&&w.isSome(qa)&&"style"===qa.type&&"solid"!==qa.style&&ea&&(pa=yield F(qa,ea));xa.push({shape:sa,fill:pa,stroke:na});break;case "line":ea=R(ea,0);if(w.isNone(ea))break;ea={stroke:ea,shape:sa};ja=Math.max(ja,y);la=Math.max(la,y);xa.push(ea);break;case "extrude":sa={join:"round",width:1,...R(ea,-.4)};na=p(ea,0);ea=p(ea,-.2);pa=Math.min(ca,
ia||E);qa=e.getExtrudeSymbolShapes(pa);sa.width=1;xa.push({shape:qa[0],fill:ea,stroke:sa});xa.push({shape:qa[1],fill:ea,stroke:sa});xa.push({shape:qa[2],fill:na,stroke:sa});ea=.7*y+.5*pa;ja=Math.max(ja,y);la=Math.max(la,ea);break;case "water":ta=w.unwrapOrThrow(f(ea)),ea=u(ta),sa=u(ta,2),na=u(ta,3),pa=e.getWaterSymbolShapes(),ta=!0,xa.push({shape:pa[0],fill:ea}),xa.push({shape:pa[1],fill:sa}),xa.push({shape:pa[2],fill:na}),ea=Math.min(ca,ia||E),ja=Math.max(ja,ea),la=Math.max(la,ea)}ka.push(xa)}}return t.renderSymbol(ka,
[ja,la],{node:Q&&Q.node,scale:ta,opacity:Q&&Q.opacity})});return d.apply(this,arguments)}const y=e.SymbolSizeDefaults.size,E=e.SymbolSizeDefaults.maxSize,V=e.SymbolSizeDefaults.maxOutlineSize,ba=e.SymbolSizeDefaults.lineWidth,aa=e.SymbolSizeDefaults.tallSymbolWidth;A.getPatternDescriptor=F;A.getSizeFromOptions=l;A.getSymbolLayerFill=p;A.previewSymbol3D=function(G,Q){if(0===G.symbolLayers.length)return Promise.reject(new L("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));switch(G.type){case "point-3d":return z(G,
Q);case "line-3d":return W(G,Q);case "polygon-3d":case "mesh-3d":return M(G,Q)}return Promise.reject(new L("symbolPreview: swatchInfo3D","symbol not supported."))};Object.defineProperty(A,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/webStyleSymbolUtils":function(){define("exports ../../symbols ../../core/devEnvironmentUtils ../../core/Error ../../core/maybe ../../core/urlUtils ../../portal/Portal ../../chunks/persistableUrlUtils ./jsonUtils ./StyleOrigin ./styleUtils ./Thumbnail".split(" "),
function(A,H,J,B,q,L,N,w,O,r,c,a){function h(t,n,K,S,D){var u=t.data;const f=K&&q.isSome(K.portal)?K.portal:N.getDefault(),p={portal:f,url:L.urlToObject(t.baseUrl),origin:"portal-item"};u=u.items.find(R=>R.name===n);if(!u)return Promise.reject(new B("symbolstyleutils:symbol-name-not-found",`The symbol name '${n}' could not be found`,{symbolName:n}));let F=w.fromJSON(c.symbolUrlFromStyleItem(u,S),p),k=u.thumbnail?.href??null;const g=u.thumbnail&&u.thumbnail.imageData;J.isDevEnvironment()&&(F=J.adjustStaticAGOUrl(F)??
"",k=J.adjustStaticAGOUrl(k));const C={portal:f,url:L.urlToObject(L.removeFile(F)),origin:"portal-item"};return c.requestJSON(F,D).then(R=>{R="cimRef"===S?c.makeCIMSymbolRef(R.data):R.data;if((R=O.fromJSON(R,C))&&H.isSymbol3D(R)){if(k){const T=w.fromJSON(k,p);R.thumbnail=new a.Thumbnail({url:T})}else g&&(R.thumbnail=new a.Thumbnail({url:`data:image/png;base64,${g}`}));t.styleUrl?R.styleOrigin=new r({portal:K.portal,styleUrl:t.styleUrl,name:n}):t.styleName&&(R.styleOrigin=new r({portal:K.portal,styleName:t.styleName,
name:n}))}return R})}function e(t,n,K){const S=c.Style2DUrlTemplate.replace(/\{SymbolName\}/gi,t.name),D=q.isSome(n.portal)?n.portal:N.getDefault();return c.requestJSON(S,K).then(u=>{u=c.makeCIMSymbolRef(u.data);return O.fromJSON(u,{portal:D,url:L.urlToObject(L.removeFile(S)),origin:"portal-item"})})}A.fetchSymbolFromStyle=h;A.resolveWebStyleSymbol=function(t,n,K,S){return t.name?t.styleName&&"Esri2DPointSymbolsStyle"===t.styleName?e(t,n,S):c.fetchStyle(t,n,S).then(D=>h(q.unwrapOrThrow(D),t.name,
n,K,S)):Promise.reject(new B("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference"))};Object.defineProperty(A,Symbol.toStringTag,{value:"Module"})})},"esri/core/devEnvironmentUtils":function(){define(["exports"],function(A){const H=/^devext.arcgis.com$/,J=/^qaext.arcgis.com$/,B=/^[\w-]*\.mapsdevext.arcgis.com$/,q=/^[\w-]*\.mapsqa.arcgis.com$/,L=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,H,J,/^jsapps.esri.com$/,B,q];A.adjustStaticAGOUrl=function(N,w){return N?
(w=w||globalThis.location.hostname)?null!=w.match(H)||null!=w.match(B)?N.replace("static.arcgis.com","staticdev.arcgis.com"):null!=w.match(J)||null!=w.match(q)?N.replace("static.arcgis.com","staticqa.arcgis.com"):N:N:N};A.isDevEnvironment=function(N){N=N||globalThis.location.hostname;return L.some(w=>null!=N?.match(w))};A.isTelemetryDevEnvironment=function(N){N=N||globalThis.location.hostname;return[/^zrh-.+?\.esri\.com$/].concat(L).some(w=>null!=N?.match(w))};Object.defineProperty(A,Symbol.toStringTag,
{value:"Module"})})},"esri/widgets/Legend/support/clusterUtils":function(){define(["exports","../../../renderers/visualVariables/SizeVariable"],function(A,H){const J=(B,q)=>{B=B.featuresTilingScheme.getClosestInfoForScale(B.scale).level;return q?.levels?q.levels[B]:null};A.getClusterSizeVariable=function(B,q){if(!(B&&"visualVariables"in B&&B.visualVariables))return null;B=B.visualVariables.find(L=>"size"===L.type);return(q=J(q,B))?new H({field:B.field,minSize:q[2].size,minDataValue:q[2].value,maxSize:q[3].size,
maxDataValue:q[3].value}):null};Object.defineProperty(A,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/colorRampUtils":function(){define(["require","exports","../../../chunks/_rollupPluginBabelHelpers","../../../Color","./utils"],function(A,H,J,B,q){function L(h,e){const t=[],n=h.length-1;5===h.length?t.push(0,2,4):t.push(0,n);return h.map((K,S)=>t.includes(S)?q.createStopLabel(K,S,n,e):null)}function N(){N=J._asyncToGenerator(function*(h,e,t){let n=!1,K=[],S=[];if(h.stops){var D=
h.stops;K=D.map(f=>f.value);(n=D.some(f=>!!f.label))&&(S=D.map(f=>f.label))}D=K[K.length-1];if(null==K[0]&&null==D)return null;const u=n?null:L(K,t??!1);return(yield Promise.all(K.map(function(){var f=J._asyncToGenerator(function*(p,F){const k="opacity"===h.type?yield w(p,h,e):(yield new Promise((g,C)=>A(["../../../renderers/visualVariables/support/visualVariableUtils"],g,C))).getColor(h,p);return{value:p,color:k,label:n?S[F]:u?.[F]??""}});return function(p,F){return f.apply(this,arguments)}}()))).reverse()});
return N.apply(this,arguments)}function w(h,e){return O.apply(this,arguments)}function O(){O=J._asyncToGenerator(function*(h,e,t=a){t=new B(t);h=(yield new Promise((n,K)=>A(["../../../renderers/visualVariables/support/visualVariableUtils"],n,K))).getOpacity(e,h);null!=h&&(t.a=h);return t});return O.apply(this,arguments)}function r(h,e){const {startIndex:t,endIndex:n,weight:K}=c(h,e);if(t===n)return e[t].color;h=B.blendColors(e[t].color,e[n].color,K);return new B(h)}function c(h,e){let t=0,n=e.length-
1;e.some((K,S)=>{if(h<K.value)return n=S,!0;t=S;return!1});return{startIndex:t,endIndex:n,weight:(h-e[t].value)/(e[n].value-e[t].value)}}const a=new B([64,64,64]);H.getColorFromPointCloudStops=r;H.getRampStops=function(h,e,t){return N.apply(this,arguments)};H.getRampStopsForPointCloud=function(h){let e=!1,t=[],n=[];t=h.map(D=>D.value);(e=h.some(D=>!!D.label))&&(n=h.map(D=>D.label??""));const K=t[t.length-1];if(null==t[0]&&null==K)return null;const S=e?null:L(t,!1);return t.map((D,u)=>{const f=r(D,
h);return{value:D,color:f,label:e?n[u]:S?.[u]??""}}).reverse()};H.getStrectchRampStops=function(h,e){let t=[];if(h&&"multipart"===h.type)h.colorRamps.reverse().forEach((n,K)=>{0===K?t.push({value:e.max,color:new B(n.toColor),label:"high"}):t.push({value:null,color:new B(n.toColor),label:""});K===h.colorRamps.length-1?t.push({value:e.min,color:new B(n.fromColor),label:"low"}):t.push({value:null,color:new B(n.fromColor),label:""})});else{let n,K;h&&"algorithmic"===h.type?(n=h.fromColor,K=h.toColor):
(n=[0,0,0,1],K=[255,255,255,1]);t=[{value:e.max,color:new B(K),label:"high"},{value:e.min,color:new B(n),label:"low"}]}return t};Object.defineProperty(H,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/utils":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../symbols ../../../intl/date ../../../renderers/support/numberUtils ../../../symbols/SimpleLineSymbol".split(" "),function(A,H,J,B,q,L,N){function w(a){return O.apply(this,arguments)}function O(){O=
J._asyncToGenerator(function*(a){if(!("visualVariables"in a&&a.visualVariables))return null;a=a.visualVariables.find(t=>"color"===t.type);if(!a)return null;var h=null,e=null;if(a.stops){if(1===a.stops.length)return a.stops[0].color;h=a.stops[0].value;e=a.stops[a.stops.length-1].value}h=null!=h&&null!=e?h+(e-h)/2:0;({getColor:e}=yield new Promise((t,n)=>A(["../../../renderers/visualVariables/support/visualVariableUtils"],t,n)));return e(a,h)??null});return O.apply(this,arguments)}function r(){r=J._asyncToGenerator(function*(a,
h){const e=a.trailCap,t=a.trailWidth||1;a=h||(yield w(a))||a.color;return new N({cap:e,color:a,width:t})});return r.apply(this,arguments)}const c=q.convertDateFormatToIntlOptions("short-date");H.RGB_IMG_SOURCE=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII\x3d",
"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII\x3d"];H.SPECIAL_CHARS_GREATER_THAN="\x3e";H.SPECIAL_CHARS_LESS_THAN="\x3c";H.createStopLabel=function(a,h,e,t){let n="";0===h?n="\x3c ":h===e&&(n="\x3e ");h=null;h=t?q.formatDate(a,c):L.format(a);return n+h};H.getMedianColor=w;H.getSymbolForFlowRenderer=function(a,h){return r.apply(this,arguments)};Object.defineProperty(H,
Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/numberUtils":function(){define(["exports","../../intl","../../intl/number"],function(A,H,J){function B(c,a){return c-a}function q(c,a){let h;h=Number(c.toFixed(a));h<c?c=h+1/10**a:(c=h,h-=1/10**a);h=Number(h.toFixed(a));c=Number(c.toFixed(a));return[h,c]}function L(c,a,h,e,t){c=w(c,a,h,e);a=null==c.next||c.next<=t;return(null==c.previous||c.previous<=t)&&a||c.previous+c.next<=2*t}function N(c){c=String(c);var a=c.match(O);if(a&&a[1])return{integer:a[1].split("").length,
fractional:a[3]?a[3].split("").length:0};if(c.toLowerCase().includes("e")&&(a=c.split("e"),c=a[0],a=a[1],c&&a)){c=Number(c);a=Number(a);const h=0<a;h||(a=Math.abs(a));c=N(c);h?(c.integer+=a,c.fractional=a>c.fractional?0:c.fractional-a):(c.fractional+=a,c.integer=a>c.integer?1:c.integer-a);return c}return{integer:0,fractional:0}}function w(c,a,h,e){const t={previous:null,next:null};if(null!=h){const n=c-h;t.previous=Math.floor(Math.abs(100*(a-h-n)/n))}null!=e&&(c=e-c,t.next=Math.floor(Math.abs(100*
(e-a-c)/c)));return t}const O=/^-?(\d+)(\.(\d+))?$/i,r={maximumFractionDigits:20};A.format=function(c){return J.formatNumber(c,r)};A.numDigits=N;A.percentChange=w;A.round=function(c,a={}){c=c.slice(0);const {tolerance:h=2,strictBounds:e=!1,indexes:t=c.map((K,S)=>S)}=a;t.sort(B);for(a=0;a<t.length;a++){const K=t[a],S=c[K],D=0===K?null:c[K-1],u=K===c.length-1?null:c[K+1],f=N(S).fractional;if(f){let p=0,F=!1;for(var n=void 0;p<=f&&!F;)n=q(S,p),n=e&&0===a?n[1]:n[0],F=L(S,n,D,u,h),p++;F&&(c[K]=n)}}return c};
Object.defineProperty(A,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/heatmapRampUtils":function(){define(["exports","../../../renderers/support/HeatmapColorStop"],function(A,H){A.getHeatmapRampStops=function(J){if(!J.colorStops)return[];const B=[...J.colorStops].filter(L=>0<L.color?.a);let q=B.length-1;if(B&&B[0]){const L=B[q];L&&1!==L.ratio&&(B.push(new H({ratio:1,color:L.color})),q++)}return B.map((L,N)=>{let w="";0===N?w=J.legendOptions?.minLabel||"low":N===q&&(w=J.legendOptions?.maxLabel||
"high");return{color:L.color,label:w,ratio:L.ratio}}).reverse()};Object.defineProperty(A,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/sizeRampUtils":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../Color ../../../symbols ../../../renderers/support/numberUtils ../../../symbols/support/cimSymbolUtils ../../../symbols/support/utils ./utils ../../support/widgetUtils ../../../support/themeUtils ../../../symbols/SimpleMarkerSymbol ../../../symbols/SimpleLineSymbol".split(" "),
function(A,H,J,B,q,L,N,w,O,r,c,a,h){function e(M,d){const y=M.length-1;return M.map((E,V)=>O.createStopLabel(E,V,y,d))}function t(){t=J._asyncToGenerator(function*(M,d,y,E,V,ba,aa){var G=d.legendOptions;G=G&&G.customValues;const Q=aa||(yield S(M,y));aa=null!=d.minSize&&null!=d.maxSize;y=d.stops&&1<d.stops.length;var Y=!!d.target;if(Q&&(G||aa||y&&!Y)){var ca=w.isVolumetricSymbol(Q),ia=null,ka=aa=null;aa=ca&&!y?L.round([d.minDataValue,d.maxDataValue]):G||(yield F(d,Q,E,V));G=M?.authoringInfo;var ja=
(Y="univariate-color-size"===G?.type)&&"above-and-below"===G?.univariateTheme;!aa&&y&&(aa=d.stops.map(sa=>sa.value),ia=d.stops.some(sa=>!!sa.label),"flow"===M.type&&(aa=L.round(aa)),ia&&(ka=d.stops.map(sa=>sa.label)));ca&&2<aa?.length&&!ja&&(aa=[aa[0],aa[aa.length-1]]);if(!aa)return null;Y&&5!==aa?.length&&(aa=g({minSize:aa[0],maxSize:aa[aa.length-1]}));var la=ca?n(M,aa):null,ta=w.getSymbolOutlineSize(Q),ea=ia?null:e(aa,ba);return(yield Promise.all(aa.map(function(){var sa=J._asyncToGenerator(function*(na,
pa){const qa=ca?la[pa]:yield T(d,Q,na,E,V),za=P(ja&&"class-breaks"===M.type?K(M,pa):Q,qa);return{value:na,symbol:za,label:ia?ka[pa]:ea[pa],size:qa,outlineSize:ta}});return function(na,pa){return sa.apply(this,arguments)}}()))).reverse()}});return t.apply(this,arguments)}function n(M,d){M=M?.authoringInfo;const y="univariate-color-size"===M?.type;let E=[12,30];if(y){const V=d[0],ba=d[d.length-1];E=d.map(aa=>12+(aa-V)/(ba-V)*18)}y&&"below"===M?.univariateTheme&&E.reverse();return E}function K(M,d){const y=
M.classBreakInfos,E=y.length;d=2>E||!(2<=d)?y[0].symbol.clone():y[E-1].symbol.clone();M.visualVariables.some(V=>"color"===V.type)&&(d.type.includes("3d")?f(d):p(d));return d}function S(M,d){return D.apply(this,arguments)}function D(){D=J._asyncToGenerator(function*(M,d){if("flow"===M.type)return O.getSymbolForFlowRenderer(M,d);if("pie-chart"===M.type)return new a({color:null,outline:M.outline?.width?M.outline:new h});let y=null,E=null;"simple"===M.type?y=M.symbol:"class-breaks"===M.type?(y=(M=M.classBreakInfos)&&
M[0]&&M[0].symbol,E=1<M.length):"unique-value"===M.type&&(y=(M=M.uniqueValueInfos)&&M[0]&&M[0].symbol,E=1<M.length);if(!y||u(y))return null;y=y.clone();if(d||E)y.type.includes("3d")?f(y):p(y);return y});return D.apply(this,arguments)}function u(M){return M?q.isSymbol3D(M)?M.symbolLayers?M.symbolLayers.some(d=>d&&"fill"===d.type):!1:M.type.includes("fill"):!1}function f(M){"line-3d"===M.type?M.symbolLayers.forEach(d=>{d.material={color:W}}):M.symbolLayers.forEach(d=>{"icon"!==d.type||d.resource&&d.resource.href?
d.material={color:z}:(d.material={color:l},d.outline={color:W,size:1.5})})}function p(M){const d=c.isDarkTheme();if("cim"===M.type)N.applyCIMSymbolColor(M,new B(z));else if(M.type.includes("line"))M.color=W;else if(M.color=d?W:l,"simple-marker"===M.type)M.outline?"#ffffff"===M.outline?.color?.toHex()&&(M.outline.color=W):M.outline={color:W,width:1.5}}function F(M,d,y,E){return k.apply(this,arguments)}function k(){k=J._asyncToGenerator(function*(M,d,y,E){const V=(yield new Promise((G,Q)=>A(["../../../renderers/visualVariables/support/visualVariableUtils"],
G,Q))).getSizeRangeAtScale(M,y,E),ba=V&&g(V);if(V||ba){var aa=ba.map(G=>{const Q=V.minSize,Y=V.maxSize,ca=M.minDataValue,ia=M.maxDataValue;return G<=Q?ca:G>=Y?ia:(G-Q)/(Y-Q)*(ia-ca)+ca});aa=L.round(aa);for(let G=1;G<aa.length-1;G++){const Q=yield C(M,d,aa[G],aa[G-1],y,E);Q&&(aa[G]=Q[0],ba[G]=Q[1])}return aa}});return k.apply(this,arguments)}function g(M){const d=M.minSize;M=(M.maxSize-d)/4;const y=[];for(let E=0;5>E;E++)y.push(d+M*E);return y}function C(M,d,y,E,V,ba){return R.apply(this,arguments)}
function R(){R=J._asyncToGenerator(function*(M,d,y,E,V,ba){const aa=yield T(M,d,y,V,ba);E=yield T(M,d,E,V,ba);var G=L.numDigits(y),Q=G.fractional,Y=G.integer;let ca=G=null;0<y&&1>y&&(G=10**Q,y*=G,Y=L.numDigits(y).integer);for(Q=Y-1;0<=Q;Q--){var ia=10**Q;Y=Math.floor(y/ia)*ia;ia*=Math.ceil(y/ia);null!=G&&(Y/=G,ia/=G);let ka=(Y+ia)/2;[,ka]=L.round([Y,ka,ia],{indexes:[1]});const ja=yield T(M,d,Y,V,ba),la=yield T(M,d,ia,V,ba),ta=yield T(M,d,ka,V,ba),ea=L.percentChange(aa,ja,E,null),sa=L.percentChange(aa,
la,E,null),na=L.percentChange(aa,ta,E,null);let pa=20>=ea.previous,qa=20>=sa.previous;pa&&qa&&(ea.previous<=sa.previous?(pa=!0,qa=!1):(qa=!0,pa=!1));pa?ca=[Y,ja]:qa?ca=[ia,la]:20>=na.previous&&(ca=[ka,ta]);if(ca)break}return ca});return R.apply(this,arguments)}function T(M,d,y,E,V){return x.apply(this,arguments)}function x(){x=J._asyncToGenerator(function*(M,d,y,E,V){const {getSize:ba}=yield new Promise((aa,G)=>A(["../../../renderers/visualVariables/support/visualVariableUtils"],aa,G));return ba(M,
y,{scale:E,view:V,shape:"simple-marker"===d.type?d.style:null})});return x.apply(this,arguments)}function P(M,d){M=M.clone();if(q.isSymbol3D(M))w.isVolumetricSymbol(M)||M.symbolLayers.forEach(y=>{"fill"!==y.type&&(y.size=d)});else if("esri.symbols.SimpleMarkerSymbol"===M.declaredClass)M.size=d;else if("esri.symbols.PictureMarkerSymbol"===M.declaredClass){const y=M.width,E=M.height;M.height=d;M.width=y/E*d}else"esri.symbols.SimpleLineSymbol"===M.declaredClass?M.width=d:"esri.symbols.TextSymbol"===
M.declaredClass&&M.font&&(M.font.size=d);return M}const l=[255,255,255],z=[200,200,200],W=[128,128,128];H.REAL_WORLD_MAX_SIZE=30;H.REAL_WORLD_MIN_SIZE=12;H.getRampStops=function(M,d,y,E,V,ba,aa){return t.apply(this,arguments)};Object.defineProperty(H,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/smartMapping/support/utils":function(){define("exports ../../../Color ../../../core/maybe ../../../intl/date ../../../intl/number ../../../renderers/support/utils ../../../renderers/visualVariables/SizeVariable".split(" "),
function(A,H,J,B,q,L,N){A.formatDateLabel=function(w){return B.formatDate(new Date(w),L.timelineDateFormatOptions)};A.formatNumberLabel=function(w){const O=Math.floor(Math.log10(Math.abs(w)))+1;return q.formatNumber(w,{notation:1E6<=Math.abs(w)?"compact":"standard",minimumSignificantDigits:2,maximumSignificantDigits:4>O||6<O?4:O})};A.getDeviationValues=function(w,O,r){if(J.isNone(O)||J.isNone(w))return[];const c=[];for(let a=-1*r;a<=r;a++)0!==a&&c.push(O+a*w);return c};A.getDynamicPathForSizeStops=
function(w){const {max:O,min:r,padding:c,pathHeight:a,pathWidth:h,stops:e}=w,t=O-r;let n=`M0 0 L${h} 0 `,K;w=3===e.length?[e[0],e[1],e[2]]:[e[0],e[2],e[4]];const S=Math.min.apply(Math,w.map(u=>u.size)),D=Math.max(Math.abs(w[0].size-w[1].size),Math.abs(w[2].size-w[1].size));w.reverse();w.forEach(({size:u,value:f},p)=>{f=Math.round(a-(f-r)/t*a);K=Math.round((u-S)/D*100)/100*h;0===K&&(K=c*h);0===p&&(n+=`L${K} 0 `);n+=`L${K} ${f} `});return n+=`L${K} ${a} L0 ${a} L0 0 Z`};A.getFillFromColor=function(w){return w instanceof
H?w.toCss(!0):H.fromString(w).toCss(!0)};A.getPathForSizeStops=function(w){const {bottomValue:O,bottomWidth:r,max:c,min:a,pathHeight:h,pathWidth:e,topValue:t,topWidth:n}=w;w=n*e;const K=r*e,S=c-a;return`M${w} 0 L${w} ${Math.round(h-(t-a)/S*h)} L${K} ${Math.round(h-(O-a)/S*h)} L${K} ${h} L0 ${h} L0 0 Z`};A.getSizesFromVariable=function(w){let O=w.maxSize;w=w.minSize;O instanceof N&&(O=O.stops[0].size);w instanceof N&&(w=w.stops[0].size);return[O,w]};A.getStopChanges=function(w,O,r){const c=r.length-
1,a=r[0],h=r[c]-a,e=O-w,t=[];for(let n=1;n<c;n++)t.push({index:n,value:(r[n]-a)/h*e+w});t.unshift({index:0,value:w});t.push({index:c,value:O});return t};Object.defineProperty(A,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/utils":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/arrayUtils ../../core/Logger ../../core/MapUtils ../../core/maybe ../../intl/date ./numberUtils ../visualVariables/support/ColorStop ../../symbols/support/utils ../../widgets/Legend/support/colorRampUtils ../../widgets/Legend/support/heatmapRampUtils".split(" "),
function(A,H,J,B,q,L,N,w,O,r,c,a){function h(p,F,k){return e.apply(this,arguments)}function e(){e=H._asyncToGenerator(function*(p,F,k){q.getOrCreateMapValue(p,F,()=>[]).push(...k)});return e.apply(this,arguments)}function t(){t=H._asyncToGenerator(function*(p){const F=new Map;if(!p)return F;if("visualVariables"in p&&p.visualVariables){var k=p.visualVariables.filter(C=>"color"===C.type);for(var g of k)k=((yield c.getRampStops(g))??[]).map(C=>C.color),yield h(F,g.field||g.valueExpression,k)}if("heatmap"===
p.type)g=a.getHeatmapRampStops(p).map(C=>C.color),yield h(F,p.field||p.valueExpression,g);else if("pie-chart"===p.type){for(const C of p.attributes)yield h(F,C.field||C.valueExpression,[C.color]);yield h(F,"default",[p?.othersCategory?.color,r.getColorFromSymbol(p.backgroundFillSymbol,null)])}else if("dot-density"===p.type){for(const C of p.attributes)yield h(F,C.field||C.valueExpression,[C.color]);yield h(F,"default",[p.backgroundColor])}else if("unique-value"===p.type)if("predominance"===p.authoringInfo?.type)for(const C of p.uniqueValueInfos??
[])yield h(F,C.value.toString(),[r.getColorFromSymbol(C.symbol,null)]);else{g=(p.uniqueValueInfos??[]).map(P=>r.getColorFromSymbol(P.symbol,null));const {field:C,field2:R,field3:T,valueExpression:x}=p;if(C||x)yield h(F,C||x,g);R&&(yield h(F,R,g));T&&(yield h(F,T,g))}else if("class-breaks"===p.type){g=p.classBreakInfos.map(T=>r.getColorFromSymbol(T.symbol,null));const {field:C,valueExpression:R}=p;yield h(F,C??R,g)}else"simple"===p.type&&(yield h(F,"default",[r.getColorFromSymbol(p.symbol,null)]));
"defaultSymbol"in p&&p.defaultSymbol&&(yield h(F,"default",[r.getColorFromSymbol(p.defaultSymbol,null)]));F.forEach((C,R)=>{C=J.unique(C.filter(Boolean),(T,x)=>JSON.stringify(T)===JSON.stringify(x));F.set(R,C)});return F});return t.apply(this,arguments)}function n(p){let F=p.minValue,k=p.maxValue;const g=p.isFirstBreak?"":D.gt+" ";p="percent-of-total"===p.normalizationType?D.pct:"";F=null==F?"":w.format(F);k=null==k?"":w.format(k);return g+F+p+" "+D.ld+" "+k+p}function K(p,F){return"normalizationField"in
p&&p.normalizationField?{type:"normalized-field",field:p.field,normalizationField:p.normalizationField}:"field"in p&&p.field?{type:"field",field:p.field}:"valueExpression"in p&&p.valueExpression?{type:"expression",expression:p.valueExpression,title:p.valueExpressionTitle,returnType:F}:null}const S=B.getLogger("esri.renderers.support.utils"),D={lte:"\x3c\x3d",gte:"\x3e\x3d",lt:"\x3c",gt:"\x3e",pct:"%",ld:"\u2013"},u={millisecond:0,second:1,minute:2,hour:3,day:4,month:5,year:6},f={millisecond:"long-month-day-year-long-time",
second:"long-month-day-year-long-time",minute:"long-month-day-year-short-time",hour:"long-month-day-year-short-time",day:"long-month-day-year",month:"long-month-day-year",year:"year"};B=N.convertDateFormatToIntlOptions("short-date");A.calculateDateFormatInterval=function(p){p=p.map(R=>new Date(R));const F=p.length;let k=Infinity,g=null;for(let R=0;R<F-1;R++){const T=p[R];let x=Infinity,P=null;for(let l=R+1;l<F;l++){var C=p[l];C=T.getFullYear()!==C.getFullYear()&&"year"||T.getMonth()!==C.getMonth()&&
"month"||T.getDate()!==C.getDate()&&"day"||T.getHours()!==C.getHours()&&"hour"||T.getMinutes()!==C.getMinutes()&&"minute"||T.getSeconds()!==C.getSeconds()&&"second"||"millisecond";const z=u[C];z<x&&(x=z,P=C)}x<k&&(k=x,g=P)}return g};A.createClassBreakLabel=n;A.createColorStops=function(p){const {values:F,colors:k,labelIndexes:g,isDate:C,dateFormatOptions:R}=p;return F.map((T,x)=>{var P=null;if(!g||g.includes(x)){let l;if(l=C?N.formatDate(T,R):w.format(T))P="",0===x?P=D.lt+" ":x===F.length-1&&(P=D.gt+
" "),P+=l}return new O({value:T,color:k[x],label:P})})};A.createUniqueValueLabel=function(p){const {value:F,domain:k,fieldInfo:g,dateFormatInterval:C}=p;p=String(F);const R=k&&"codedValues"in k&&k.codedValues?k.getName(F):null;R?p=R:"number"===typeof F&&(p=g&&"date"===g.type?N.formatDate(F,C&&N.convertDateFormatToIntlOptions(f[C])):w.format(F));return p};A.getAttribute=K;A.getAttributes=function(p,F){const k=[];if("class-breaks"===p.type||"heatmap"===p.type)k.push(K(p,"number"));else if("unique-value"===
p.type){var g=p.authoringInfo;if(g&&"relationship"===g.type){if(g.field1&&g.field2){var C=g.field2.field;const R=g.field2.normalizationField;k.push(K({field:g.field1.field,normalizationField:g.field1.normalizationField}));k.push(K({field:C,normalizationField:R}))}}else C=p.uniqueValueInfos?.[0],g=null,C&&C.value&&(C=typeof p.uniqueValueInfos[0].value,"string"===C||"number"===C)&&(g=C),k.push(K(p,g)),[p.field2,p.field3].forEach(R=>R&&k.push({type:"field",field:R}))}else"attributes"in p&&p.attributes?.forEach(R=>
k.push(K(R,"number")));(p=F?F(p):"visualVariables"in p?p.visualVariables:null)&&p.forEach(R=>k.push(K(R,"number")));return J.unique(k.filter(L.isSome),(R,T)=>"field"===R.type&&"field"===T.type?R.field===T.field:"normalized-field"===R.type&&"normalized-field"===T.type?R.field===T.field&&R.normalizationField===T.normalizationField:"expression"===R.type&&"expression"===T.type?R.expression===T.expression:!1)};A.getColorsFromRenderer=function(p){return t.apply(this,arguments)};A.setLabelsForClassBreaks=
function(p){const F=p.classBreakInfos,k=p.normalizationType;let g=[];if(F&&F.length)if("standard-deviation"===p.classificationMethod)S.warn("setLabelsForClassBreaks","cannot set labels for class breaks generated using 'standard-deviation' method.");else if(p.round){g.push(F[0].minValue);for(const C of F)g.push(C.maxValue);g=w.round(g);F.forEach((C,R)=>{C.label=n({minValue:0===R?g[0]:g[R],maxValue:g[R+1],isFirstBreak:0===R,normalizationType:k})})}else F.forEach((C,R)=>{C.label=n({minValue:C.minValue,
maxValue:C.maxValue,isFirstBreak:0===R,normalizationType:k})})};A.timelineDateFormatOptions=B;Object.defineProperty(A,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/Card":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../intl ../../../core/Handles ../../../core/reactiveUtils ../../../core/screenUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ../../../symbols/support/svgUtils ../../../symbols/support/utils ../../Widget ./CardCSS ./support/relationshipUtils ./support/univariateUtils ../support/styleUtils ../../support/Heading ../../support/decorators/accessibleHandler ../../support/decorators/messageBundle ../../support/jsxFactory ../../support/widgetUtils ../../../intl/substitute".split(" "),
function(A,H,J,B,q,L,N,w,O,r,c,a,h,e,t,n,K,S,D,u,f,p,F){var k;(function(C){C.Auto="auto";C.Stack="stack";C.SideBySide="side-by-side"})(k||(k={}));const g=window.devicePixelRatio;J=function(C){function R(x,P){x=C.call(this,x,P)||this;x._handles=new B;x._hasIndicators=!1;x._selectedSectionName=null;x._sectionNames=[];x._sectionMap=new Map;x.activeLayerInfos=null;x.headingLevel=3;x.layout=k.Stack;x.messages=null;x.messagesCommon=null;x.type="card";x.view=null;return x}A._inheritsLoose(R,C);var T=R.prototype;
T.initialize=function(){this.addHandles(q.watch(()=>this.activeLayerInfos,x=>{this._handles.removeAll();this._watchForSectionChanges(x)}))};T.destroy=function(){this._handles.destroy();this._handles=null};T.render=function(){this._hasIndicators=this.layout===k.Auto&&768>=this.view.container.clientWidth||this.layout===k.Stack;var x=this.activeLayerInfos;x=x&&x.toArray().map(z=>this._renderLegendForLayer(z)).filter(z=>!!z);this._hasIndicators?this._selectedSectionName&&this._sectionNames.includes(this._selectedSectionName)||
(this._selectedSectionName=this._sectionNames&&this._sectionNames[0]):this._selectedSectionName=null;const P=this._sectionNames.length;var l=this._sectionNames.map((z,W)=>{W=F.substitute(this.messagesCommon.pagination.pageText,{index:W+1,total:P});return f.tsx("div",{key:z,role:"tab",id:z,"aria-label":W,"aria-controls":`${z}-panel`,"aria-selected":(this._selectedSectionName===z).toString(),tabIndex:this._selectedSectionName===z?0:-1,title:W,onclick:this._selectSection,onkeydown:this._focusSection,
bind:this,class:this.classes(e.CSS.indicator,{[e.CSS.activated]:this._selectedSectionName===z}),"data-section-name":z})});l=this._hasIndicators&&1<P?f.tsx("div",{class:e.CSS.indicatorContainer,key:"carousel-navigation",role:"tablist"},l):null;x=this._hasIndicators?this._sectionMap.get(this._selectedSectionName):x&&x.length?x:null;return f.tsx("div",{class:this.classes(e.CSS.base,{[e.CSS.stacked]:this._hasIndicators})},x?x:f.tsx("div",{class:e.CSS.message},this.messages.noLegend),l)};T._selectSection=
function(x){if(x=x.target.getAttribute("data-section-name"))this._selectedSectionName=x};T._focusSection=function(x){switch(x.key){case "ArrowLeft":case "ArrowRight":this._switchSectionOnArrowPress(x);break;case "Enter":case " ":this._selectSection(x)}};T._switchSectionOnArrowPress=function(x){const P=x.key,l="ArrowLeft"===P?-1:1;x=x.target.getAttribute("data-section-name");x=this._sectionNames.indexOf(x);const z=this._sectionNames;let W=null;-1!==x&&(z[x+l]?W=document.getElementById(z[x+l]):"ArrowLeft"===
P?W=document.getElementById(z[z.length-1]):"ArrowRight"===P&&(W=document.getElementById(z[0])),W&&W.focus())};T._watchForSectionChanges=function(x){this._generateSectionNames();x&&(x.forEach(P=>{const l=`activeLayerInfo-${P.layer.uid}-version-change`;this._handles.remove(l);this._watchForSectionChanges(P.children);this._handles.add(q.watch(()=>P.version,()=>this._generateSectionNames()),l)}),this._handles.remove("activeLayerInfos-collection-change"),this._handles.add(x.on("change",()=>this._watchForSectionChanges(x)),
"activeLayerInfos-collection-change"))};T._generateSectionNames=function(){this._sectionNames.length=0;this._selectedSectionName=null;this.activeLayerInfos&&this.activeLayerInfos.forEach(this._generateSectionNamesForActiveLayerInfo,this)};T._getSectionName=function(x,P,l){return`${this.id}${x.uid}-type-${P.type}-${l}`};T._generateSectionNamesForActiveLayerInfo=function(x){x.children.forEach(this._generateSectionNamesForActiveLayerInfo,this);x.legendElements&&x.legendElements.forEach((P,l)=>{this._sectionNames.push(this._getSectionName(x.layer,
P,l))})};T._renderLegendForLayer=function(x){if(!x.ready)return null;if(x.children.length){var P=x.children.map(z=>this._renderLegendForLayer(z)).toArray();return f.tsx("div",{key:x.layer.uid,class:this.classes(e.CSS.service,e.CSS.groupLayer)},f.tsx("div",{class:e.CSS.serviceCaptionContainer},x.title),P)}if((P=x.legendElements)&&!P.length)return null;const l=P.some(z=>"relationship-ramp"===z.type);P=P.map((z,W)=>this._renderLegendForElement(z,x,W,l)).filter(z=>!!z);return P.length?f.tsx("div",{key:x.layer.uid,
class:this.classes(e.CSS.service,{[e.CSS.groupLayerChild]:!!x.parent})},f.tsx("div",{class:e.CSS.serviceCaptionContainer},f.tsx("div",{class:e.CSS.serviceCaptionText},x.title)),f.tsx("div",{class:e.CSS.serviceContent},P)):null};T._renderLegendForElement=function(x,P,l,z=!1,W=!1){var M="color-ramp"===x.type,d="opacity-ramp"===x.type,y="size-ramp"===x.type;const E=P.layer;var V=null;"string"===typeof x.title?V=x.title:x.title&&(V=x.title,M=K.getTitle(this.messages,V,M||d),V=V.title?`${V.title} (${M})`:
M);l=this._getSectionName(E,x,l);M=this._hasIndicators&&!W?f.tsx("div",null,f.tsx(S.Heading,{level:this.headingLevel,class:e.CSS.carouselTitle},P.title),f.tsx(S.Heading,{level:S.incrementHeadingLevel(this.headingLevel),class:e.CSS.layerCaption},V)):V?f.tsx(S.Heading,{level:this.headingLevel,class:e.CSS.layerCaption},V):null;V=P.effectList;d=null;"symbol-table"===x.type?(y=x.infos.map((ba,aa)=>this._renderLegendForElementInfo(ba,P,x.legendType,aa)).filter(ba=>!!ba),y.length&&(d=f.tsx("div",{class:this.classes({[e.CSS.labelContainer]:!(y[0].properties.classes&&
y[0].properties.classes[e.CSS.symbolRow])&&!z,[e.CSS.relationshipLabelContainer]:z})},y))):"color-ramp"===x.type||"opacity-ramp"===x.type||"heatmap-ramp"===x.type?d=this._renderLegendForRamp(x,E.opacity,V):y?d=this._renderSizeRamp(x,E.opacity):"pie-chart-ramp"===x.type?d=this._renderPieChartRamp(x):"relationship-ramp"===x.type?d=t.renderRelationshipRamp(x,this.id,E.opacity,V):"univariate-above-and-below-ramp"===x.type?d=this._renderUnivariateAboveAndBelowRamp(x,E.opacity,V):"univariate-color-size-ramp"===
x.type&&(d=this._renderUnivariateColorSizeRamp(x,E.opacity,V));if(!d)return null;z=f.tsx("div",{key:l,class:e.CSS.section,id:`${l}-panel`,role:"tabpanel","aria-labelledby":l,tabIndex:0},[M,d]);W||this._sectionMap.set(l,z);return z};T._renderPieChartRamp=function(x){return f.tsx("div",{class:e.CSS.pieChartRampPreview,bind:x.preview,afterCreate:K.attachToNode})};T._renderUnivariateAboveAndBelowRamp=function(x,P,l){const {sizeRampElement:z,colorRampElement:W}=n.getUnivariateAboveAndBelowRampElements(x,
P,"horizontal");if(!z)return null;x=n.getUnivariateSizeRampSize(z,"full",!0,"horizontal");var M=n.getUnivariateColorRampSize(z,"above",!0,"horizontal"),d=n.getUnivariateColorRampSize(z,"below",!0,"horizontal");M=n.getUnivariateColorRampPreview(W,{width:M,height:12,rampAlignment:"horizontal",opacity:P,type:"above",effectList:l});P=n.getUnivariateColorRampPreview(W,{width:d,height:12,rampAlignment:"horizontal",opacity:P,type:"below",effectList:l});l=n.getUnivariateColorRampMargin(z,"card");d=z.infos.map(V=>
V.label);const y=d.length-1;d=d.map((V,ba)=>0===ba||ba===y?f.tsx("div",{key:ba},V):null);const E={marginTop:"3px",display:"flex"};p.isRTL(this.container)?E.marginRight=`${l}px`:E.marginLeft=`${l}px`;x={width:`${x}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return f.tsx("div",{class:e.CSS.layerRow,key:"size-ramp-preview",styles:{display:"flex",flexDirection:"column"}},f.tsx("div",{class:this.classes(e.CSS.symbolContainer,e.CSS.sizeRampHorizontal),styles:{display:"flex",flexDirection:"row"}},
z.infos.map((V,ba)=>f.tsx("div",{key:ba,class:e.CSS.symbol,bind:V.preview,afterCreate:K.attachToNode}))),M?f.tsx("div",{class:e.CSS.univariateAboveAndBelowColorRamp,styles:E,key:"color-ramp-preview"},f.tsx("div",{bind:M,afterCreate:K.attachToNode}),f.tsx("div",{bind:P,afterCreate:K.attachToNode})):null,f.tsx("div",{class:e.CSS.layerInfo},f.tsx("div",{class:e.CSS.rampLabelsContainer,styles:x},d)))};T._renderUnivariateColorSizeRamp=function(x,P,l){const {sizeRampElement:z,colorRampElement:W}=n.getUnivariateColorSizeRampElements(x,
"horizontal");if(!z)return null;x=n.getUnivariateSizeRampSize(z,"full",!1,"horizontal");var M=n.getUnivariateColorRampSize(z,"full",!1,"horizontal");P=n.getUnivariateColorRampPreview(W,{width:M,height:12,rampAlignment:"horizontal",opacity:P,type:"full",effectList:l});const d=n.getUnivariateColorRampMargin(z,"card"),y=z.infos.length-1;l=z.infos.map((E,V)=>0===V||V===y?f.tsx("div",{key:V},E.label):null);M={marginTop:"3px",display:"flex"};p.isRTL(this.container)?M.marginRight=`${d}px`:M.marginLeft=`${d}px`;
x={width:`${x}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return f.tsx("div",{class:e.CSS.layerRow,key:"size-ramp-preview",styles:{display:"flex",flexDirection:"column"}},f.tsx("div",{class:this.classes(e.CSS.symbolContainer,e.CSS.sizeRampHorizontal),styles:{display:"flex",flexDirection:"row"}},z.infos.map((E,V)=>f.tsx("div",{key:V,class:e.CSS.symbol,bind:E.preview,afterCreate:K.attachToNode}))),f.tsx("div",{class:e.CSS.univariateAboveAndBelowColorRamp,styles:M,key:"color-ramp-preview"},
f.tsx("div",{bind:P,afterCreate:K.attachToNode})),f.tsx("div",{class:e.CSS.layerInfo},f.tsx("div",{class:e.CSS.rampLabelsContainer,styles:x},l)))};T._renderLegendForElementInfo=function(x,P,l,z){var W=P.layer;if(x.type)return this._renderLegendForElement(x,P,z,!1,!0);l=K.isImageryStretchedLegend(W,l);if(x.preview){if(!x.symbol||!x.symbol.type.includes("simple-fill")){if(!x.label)return f.tsx("div",{key:z,bind:x.preview,afterCreate:K.attachToNode});P={[e.CSS.symbolCell]:this._hasIndicators};return f.tsx("div",
{key:z,class:this.classes(e.CSS.layerRow,{[e.CSS.symbolRow]:this._hasIndicators})},f.tsx("div",{class:this.classes(P),bind:x.preview,afterCreate:K.attachToNode}),f.tsx("div",{class:this.classes(e.CSS.imageLabel,{[e.CSS.labelCell]:this._hasIndicators})},K.getTitle(this.messages,x.label,!1)||""))}let M=l=255,d=255,y=0,E=255,V=255,ba=255,aa=0;const G=x.symbol.color&&x.symbol.color.a,Q=x.symbol.outline&&x.symbol.outline.color&&x.symbol.outline.color.a;G&&(l=x.symbol.color.r,M=x.symbol.color.g,d=x.symbol.color.b,
y=x.symbol.color.a*W.opacity);Q&&(E=x.symbol.outline.color.r,V=x.symbol.outline.color.g,ba=x.symbol.outline.color.b,aa=x.symbol.outline.color.a*W.opacity);const Y=(W=x.symbol.color?.isBright??!0)?"rgba(255, 255, 255, .6)":"rgba(0, 0, 0, .6)";P={background:G?`rgba(${l}, ${M}, ${d}, ${y})`:"none",color:W?"black":"white",textShadow:`-1px -1px 0 ${Y},\n                                              1px -1px 0 ${Y},\n                                              -1px 1px 0 ${Y},\n                                              1px 1px 0 ${Y}`,
border:Q?`1px solid rgba(${E}, ${V}, ${ba}, ${aa})`:"none",filter:a.getCSSFilterFromEffectList(P.effectList)};return f.tsx("div",{key:z,class:e.CSS.layerRow},f.tsx("div",{class:e.CSS.labelElement,styles:P}," ",x.label," "))}if(x.src)return P=this._renderImage(x,W,l),f.tsx("div",{key:z,class:e.CSS.layerRow},P,f.tsx("div",{class:e.CSS.imageLabel},x.label||""))};T._renderImage=function(x,P,l){const {label:z,src:W,opacity:M}=x;l={[e.CSS.imageryLayerStretchedImage]:l,[e.CSS.symbol]:!l};P={opacity:`${null!=
M?M:P.opacity}`};return f.tsx("img",{alt:K.getTitle(this.messages,z,!1),src:W,border:0,width:x.width,height:x.height,class:this.classes(l),styles:P})};T._renderSizeRampLines=function(x){x=x.infos;var P=x[0],l=x[x.length-1],z=P.symbol;x=this._hasIndicators;P=L.pt2px(P.size+P.outlineSize)*g;l=L.pt2px(l.size+l.outlineSize)*g;const W=x?P:P+50*g,M=x?P/2+50*g:P;var d;z?z.type.includes("3d")?(d=z.symbolLayers&&z.symbolLayers.length)?(d=z.symbolLayers.getItemAt(d-1).get("resource.primitive"),d="triangle"===
d||"cone"===d||"tetrahedron"===d):d=void 0:d="triangle"===z.style:d=void 0;if(z)if(z.type.includes("3d")){var y=z.symbolLayers&&z.symbolLayers.length;y?(z=z.symbolLayers.getItemAt(y-1),z=z.resource&&z.resource.primitive,z="circle"===z||"cross"===z||"kite"===z||"sphere"===z||"cube"===z||"diamond"===z):z=void 0}else z=z.style,z="circle"===z||"diamond"===z||"cross"===z;else z=void 0;y=document.createElement("canvas");y.width=W;y.height=M;y.style.width=`${y.width/g}px`;y.style.height=`${y.height/g}px`;
const E=y.getContext("2d");if(x){E.beginPath();var V=W/2-l/2;E.moveTo(0,0);E.lineTo(V,M);V=W/2+l/2;E.moveTo(W,0);E.lineTo(V,M)}else E.beginPath(),E.moveTo(0,M/2-l/2),E.lineTo(W,0),E.moveTo(0,M/2+l/2),E.lineTo(W,M);E.strokeStyle="#ddd";E.stroke();return f.tsx("div",{bind:y,afterCreate:K.attachToNode,styles:x?{display:"flex",marginTop:`-${d?0:z?P/2:0}px`,marginBottom:`-${d?l:z?l/2:0}px`}:{display:"flex",marginRight:`-${d?0:z?P/2:0}px`,marginLeft:`-${d?0:z?l/2:0}px`}})};T._renderSizeRamp=function(x,
P){var l=x.infos;const z=l[0].label,W=l[l.length-1].label;let M=l[0].preview;l=l[l.length-1].preview;const d=this._hasIndicators,y={"flex-direction":d?"column":"row-reverse"};M&&(M=M.cloneNode(!0),M.style.display="flex");l&&(l=l.cloneNode(!0),l.style.display="flex");P={opacity:null!=P?`${P}`:""};return f.tsx("div",{class:this.classes(e.CSS.layerRow,{[e.CSS.sizeRampRow]:d})},f.tsx("div",{class:e.CSS.rampLabel},d?z:W),f.tsx("div",{class:e.CSS.sizeRampContainer,styles:y},f.tsx("div",{bind:M,afterCreate:K.attachToNode,
class:e.CSS.sizeRampPreview,styles:P}),this._renderSizeRampLines(x),f.tsx("div",{bind:l,afterCreate:K.attachToNode,class:e.CSS.sizeRampContainer,styles:P})),f.tsx("div",{class:e.CSS.rampLabel},d?W:z))};T._renderLegendForRamp=function(x,P,l){var z=x.infos;const W="heatmap-ramp"===x.type,M=z.length-1;var d=2<M&&!W?25*M:100,y=d+20;const E=z.slice(0).reverse();E.forEach((aa,G)=>{aa.offset=W?aa.ratio:G/M});const V=E.length-1;x=(x=0!==E.length%2&&E[E.length/2|0])&&f.tsx("div",{class:e.CSS.intervalSeparatorsContainer},
f.tsx("div",{class:e.CSS.intervalSeparator},"|"),f.tsx("div",{class:e.CSS.rampLabel},x.label));const ba=z[z.length-1].label;z=z[0].label;d=c.renderSVG([[{shape:{type:"path",path:"M0 12.5 L10 0 L10 25 Z"},fill:E[0].color,stroke:{width:0}},{shape:{type:"rect",x:10,y:0,width:d,height:25},fill:{type:"linear",x1:10,y1:0,x2:d+10,y2:0,colors:E},stroke:{width:0}},{shape:{type:"path",path:`M${d+10} 0 L${y} ${12.5} L${d+10} ${25} Z`},fill:E[V].color,stroke:{width:0}}]],y,25);({messages:y}=this);P={filter:a.getCSSFilterFromEffectList(l),
opacity:null==P?null:`${P}`};return f.tsx("div",{class:e.CSS.layerRow,styles:{justifyContent:"center"}},f.tsx("div",{class:e.CSS.rampLabel},W?y[ba]:ba),f.tsx("div",{class:e.CSS.symbolContainer},f.tsx("div",{styles:P},d),x),f.tsx("div",{class:e.CSS.rampLabel},W?y[z]:z))};return R}(h);H.__decorate([N.property()],J.prototype,"activeLayerInfos",void 0);H.__decorate([N.property()],J.prototype,"headingLevel",void 0);H.__decorate([N.property()],J.prototype,"layout",void 0);H.__decorate([N.property(),u.messageBundle("esri/widgets/Legend/t9n/Legend")],
J.prototype,"messages",void 0);H.__decorate([N.property(),u.messageBundle("esri/t9n/common")],J.prototype,"messagesCommon",void 0);H.__decorate([N.property({readOnly:!0})],J.prototype,"type",void 0);H.__decorate([N.property()],J.prototype,"view",void 0);H.__decorate([D.accessibleHandler()],J.prototype,"_selectSection",null);return J=H.__decorate([r.subclass("esri.widgets.Legend.styles.Card")],J)})},"esri/widgets/Legend/styles/CardCSS":function(){define(["exports"],function(A){A.CSS={activated:"esri-legend--card__carousel-indicator--activated",
base:"esri-legend--card",stacked:"esri-legend--stacked",carouselTitle:"esri-legend--card__carousel-title",indicator:"esri-legend--card__carousel-indicator",intervalSeparator:"esri-legend--card__interval-separator",imageryLayerStretchedImage:"esri-legend--card__imagery-layer-image--stretched",imageLabel:"esri-legend--card__image-label",layerCaption:"esri-legend--card__layer-caption",labelElement:"esri-legend--card__label-element",layerRow:"esri-legend--card__layer-row",labelCell:"esri-legend--card__label-cell",
message:"esri-legend--card__message",rampLabel:"esri-legend--card__ramp-label",section:"esri-legend--card__section",relationshipSection:"esri-legend--card__relationship-section",serviceCaptionText:"esri-legend--card__service-caption-text",serviceContent:"esri-legend--card__service-content",service:"esri-legend--card__service",groupLayer:"esri-legend--card__group-layer",groupLayerChild:"esri-legend--card__group-layer-child",symbol:"esri-legend--card__symbol",sizeRampRow:"esri-legend--card__size-ramp-row",
symbolRow:"esri-legend--card__symbol-row",symbolCell:"esri-legend--card__symbol-cell",indicatorContainer:"esri-legend--card__carousel-indicator-container",intervalSeparatorsContainer:"esri-legend--card__interval-separators-container",relationshipLabelContainer:"esri-legend--card__relationship-label-container",labelContainer:"esri-legend--card__label-container",serviceCaptionContainer:"esri-legend--card__service-caption-container",symbolContainer:"esri-legend--card__symbol-container",sizeRampContainer:"esri-legend--card__size-ramp-container",
sizeRampPreview:"esri-legend--card__size-ramp-preview",pieChartRampPreview:"esri-legend--card__pie-chart-ramp-preview",rampContainer:"esri-legend__ramps",sizeRampHorizontal:"esri-legend__size-ramp--horizontal",rampLabelsContainer:"esri-legend__ramp-labels",layerInfo:"esri-legend__layer-cell esri-legend__layer-cell--info",univariateAboveAndBelowColorRamp:"esri-univariate-above-and-below-ramp__color--card",hidden:"esri-hidden"};Object.defineProperty(A,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/support/univariateUtils":function(){define("exports ../../../../core/screenUtils ../../../../libs/maquette/projection ../../../../libs/maquette/projector ../../../../symbols/support/symbolUtils ../../../support/widgetUtils ../../../support/jsxFactory".split(" "),
function(A,H,J,B,q,L,N){function w(e="vertical"){return"vertical"===e?N.tsx("svg",{height:"4",width:"10"},N.tsx("line",{x1:"0",y1:"2",x2:"10",y2:"2",style:"stroke:rgb(200, 200, 200);stroke-width:1"})):N.tsx("svg",{height:"10",width:"10"},N.tsx("line",{x1:"5",y1:"0",x2:"5",y2:"10",style:"stroke:rgb(200, 200, 200);stroke-width:1"}))}function O(e,t="vertical"){const n=document.createElement("div");n.style.height="20px";n.className=h.univariateAboveAndBelowSymbol;null!=e&&(n.style.opacity=e.toString());
a.append(n,w.bind(null,t));return n}function r(e,t,n="vertical",K){e.infos.forEach((S,D)=>{if(K&&2===D)S.preview=O(t,n);else{D=H.pt2px(S.size)+("horizontal"===n?20:10);const u="div"===S.preview.tagName.toLowerCase(),f=u?S.preview:document.createElement("div");f.className=h.univariateAboveAndBelowSymbol;"horizontal"===n?f.style.width=`${D}px`:f.style.height=`${D}px`;u||f.appendChild(S.preview);S.preview=f}})}function c(e,t,n,K="vertical"){let S=0;e=e.infos;const D=Math.floor(e.length/2);var u="full"===
t||"above"===t?0:D;for(t="full"===t||"below"===t?e.length-1:D;u<=t;u++)if(n&&u===D)S+="horizontal"===K?10:20;else{const f=H.pt2px(e[u].size)+("horizontal"===K?20:10);S+=f}return Math.round(S)}const a=B.createProjector(),h={univariateAboveAndBelowSymbol:"esri-univariate-above-and-below-ramp__symbol",colorRamp:"esri-legend__color-ramp"};A.getUnivariateAboveAndBelowRampElements=function(e,t,n="vertical"){var K=e.infos;e=K.find(({type:S})=>"size-ramp"===S);K=K.find(({type:S})=>"color-ramp"===S);e&&(e=
{...e},e.infos=[...e.infos],r(e,t,n,!0));K&&(K={...K},K.infos=[...K.infos]);"horizontal"===n&&(e?.infos.reverse(),K?.infos.reverse());return{sizeRampElement:e,colorRampElement:K}};A.getUnivariateColorRampMargin=function(e,t="classic"){e=e.infos;return"classic"===t?(H.pt2px(e[0].size)+10)/2:(H.pt2px(e[0].size)-H.pt2px(e[e.length-1].size))/2};A.getUnivariateColorRampPreview=function(e,t){if(!e)return null;e=e.infos.map(n=>n.color);e=q.renderColorRampPreviewHTML("full"===t.type?e:"above"===t.type?e.slice(0,
3):e.slice(2,5),{width:t.width,height:t.height,align:t.rampAlignment,effectList:t.effectList});e.className=h.colorRamp;null!=t.opacity&&(e.style.opacity=t.opacity.toString());return e};A.getUnivariateColorRampSize=function(e,t,n,K="vertical"){const S=c(e,t,n,K);e=e.infos;var D=Math.floor(e.length/2);const u="full"===t||"above"===t?0:D;D="full"===t||"below"===t?e.length-1:D;n=n?"vertical"===K?20:10:0;K="vertical"===K?10*("full"===t?2:1):20*("full"===t?2:1);return Math.round(S-(H.pt2px("full"===t?e[u].size+
e[D].size:"above"===t?e[u].size:e[D].size)/2+n/2+K/2))};A.getUnivariateColorSizeRampElements=function(e,t="vertical"){var n=e.infos;e=n.find(({type:K})=>"size-ramp"===K);n=n.find(({type:K})=>"color-ramp"===K);e&&(e={...e},e.infos=[...e.infos],r(e,null,t,!1));n&&(n={...n},n.infos=[...n.infos]);"horizontal"===t&&(e?.infos.reverse(),n?.infos.reverse());return{sizeRampElement:e,colorRampElement:n}};A.getUnivariateSizeRampSize=c;Object.defineProperty(A,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/styleUtils":function(){define(["exports",
"../../../intl","../../../intl/substitute"],function(A,H,J){A.attachToNode=function(B){B.appendChild(this)};A.getTitle=function(B,q,L){if(q){if("string"===typeof q||"number"===typeof q)return q;if("value"in q||"unit"in q)return J.substitute(B.dotValue,q);if("colorName"in q&&"bandName"in q)return B[q.colorName]+": "+(B[q.bandName]||q.bandName);if("showCount"in q)return q.showCount?B.clusterCountTitle:null;var N=null;L?N=q.ratioPercentTotal?"showRatioPercentTotal":q.ratioPercent?"showRatioPercent":
q.ratio?"showRatio":q.normField?"showNormField":q.field?"showField":null:L||(N=q.normField?"showNormField":q.normByPct?"showNormPct":q.field?"showField":null);return N?J.substitute("showField"===N?"{field}":B[N],{field:q.field,normField:q.normField}):null}};A.isImageryStretchedLegend=function(B,q){return!!(q&&"Stretched"===q&&10.3<=B.version&&"esri.layers.ImageryLayer"===B.declaredClass)};A.isRendererTitle=function(B,q){return!q};Object.defineProperty(A,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/Heading":function(){define(["exports",
"../../core/mathUtils","./widgetUtils","./jsxFactory"],function(A,H,J,B){const q={heading:"esri-widget__heading"};A.CSS=q;A.Heading=function({level:L,class:N,...w},O){L=H.clamp(Math.ceil(L),1,6);return B.tsx(`h${L}`,{...w,class:J.classes(q.heading,N),role:"heading","aria-level":String(L)},O)};A.incrementHeadingLevel=function(L,N=1){return H.clamp(Math.ceil(L+N),1,6)};Object.defineProperty(A,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/Classic":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../intl ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ../../Widget ./ClassicCSS ./support/relationshipUtils ./support/univariateUtils ../support/styleUtils ../../support/Heading ../../support/widgetUtils ../../support/decorators/messageBundle ../../support/jsxFactory ../../../intl/number".split(" "),
function(A,H,J,B,q,L,N,w,O,r,c,a,h,e,t,n,K){const S=`${O.LEGEND}__`,D={display:"flex",alignItems:"flex-start"},u={marginLeft:"3px"},f={display:"table-cell",verticalAlign:"middle"};J=function(p){function F(g,C){g=p.call(this,g,C)||this;g.activeLayerInfos=null;g.headingLevel=3;g.messages=null;g.type="classic";return g}A._inheritsLoose(F,p);var k=F.prototype;k.render=function(){var g=this.activeLayerInfos;g=g&&g.toArray().map(C=>this._renderLegendForLayer(C)).filter(C=>!!C);return n.tsx("div",null,g&&
g.length?g:n.tsx("div",{class:O.CSS.message},this.messages.noLegend))};k._renderLegendForLayer=function(g){if(!g.ready)return null;var C=!!g.children.length;const R=`${S}${g.layer.uid}-version-${g.version}`,T=g.title?h.Heading({level:this.headingLevel,class:this.classes(O.CSS.header,O.CSS.label)},g.title):null;if(C)return C=g.children.map(x=>this._renderLegendForLayer(x)).toArray(),n.tsx("div",{key:R,class:this.classes(O.CSS.service,O.CSS.groupLayer)},T,C);if((C=g.legendElements)&&!C.length)return null;
C=C.map(x=>this._renderLegendForElement(x,g.layer,g.effectList)).filter(x=>!!x);return C.length?n.tsx("div",{key:R,class:this.classes(O.CSS.service,{[O.CSS.groupLayerChild]:!!g.parent}),tabIndex:0},T,n.tsx("div",{class:O.CSS.layer},C)):null};k._renderLegendForElement=function(g,C,R,T){var x="color-ramp"===g.type,P="opacity-ramp"===g.type;const l="size-ramp"===g.type;let z=null;if("symbol-table"===g.type||l){var W=g.infos.map(d=>this._renderLegendForElementInfo(d,C,R,l,g.legendType)).filter(d=>!!d);
W.length&&(z=n.tsx("div",{class:O.CSS.layerBody},W))}else"color-ramp"===g.type||"opacity-ramp"===g.type||"heatmap-ramp"===g.type||"stretch-ramp"===g.type?z=this._renderLegendForRamp(g,C.opacity):"relationship-ramp"===g.type?z=r.renderRelationshipRamp(g,this.id,C.opacity,R):"pie-chart-ramp"===g.type?z=this._renderPieChartRamp(g):"univariate-above-and-below-ramp"===g.type?z=this._renderUnivariateAboveAndBelowRamp(g,C.opacity,R):"univariate-color-size-ramp"===g.type&&(z=this._renderUnivariateColorSizeRamp(g,
C.opacity,R));if(!z)return null;W=g.title;var M=null;"string"===typeof W?M=W:W&&(M=a.getTitle(this.messages,W,x||P),M=a.isRendererTitle(W,x||P)&&W.title?`${W.title} (${M})`:M);x=T?O.CSS.layerChildTable:O.CSS.layerTable;P=M?n.tsx("div",{class:O.CSS.layerCaption},M):null;return n.tsx("div",{class:this.classes(x,{[O.CSS.layerTableSizeRamp]:l||!T})},P,z)};k._renderPieChartRamp=function(g){return n.tsx("div",{bind:g.preview,afterCreate:a.attachToNode})};k._renderUnivariateAboveAndBelowRamp=function(g,
C,R){const {sizeRampElement:T,colorRampElement:x}=c.getUnivariateAboveAndBelowRampElements(g,C);if(!T)return null;var P=c.getUnivariateColorRampSize(T,"above",!0);g=c.getUnivariateColorRampSize(T,"below",!0);const l=c.getUnivariateColorRampPreview(x,{width:12,height:P,rampAlignment:"vertical",opacity:C,type:"above",effectList:R});C=c.getUnivariateColorRampPreview(x,{width:12,height:g,rampAlignment:"vertical",opacity:C,type:"below",effectList:R});var z=c.getUnivariateColorRampMargin(T);const W=T.infos.map(V=>
V.label);R=W.map((V,ba)=>{const aa=2===ba;return 0===ba?n.tsx("div",{key:ba,class:V?l?O.CSS.univariateAboveAndBelowLabel:O.CSS.rampLabel:null},V):aa?n.tsx("div",null):null});const M=W.length-1,d=Math.floor(W.length/2),y=W.map((V,ba)=>{const aa=ba===M;return ba===d||aa?n.tsx("div",{key:ba,class:V?l?O.CSS.univariateAboveAndBelowLabel:O.CSS.rampLabel:null},V):null}),E={display:"table-cell",verticalAlign:"middle"};z={marginTop:`${z}px`};P={height:`${P}px`};g={height:`${g}px`};return n.tsx("div",{key:"univariate-above-and-below-ramp-preview",
styles:D},n.tsx("div",{class:O.CSS.layerBody},T.infos.map((V,ba)=>n.tsx("div",{class:this.classes(O.CSS.layerRow,O.CSS.sizeRamp)},n.tsx("div",{class:O.CSS.symbol,styles:E,bind:V.preview,afterCreate:a.attachToNode}),l||0!==ba%2?null:n.tsx("div",{class:O.CSS.layerInfo},W[ba])))),l?n.tsx("div",{styles:z,key:"color-ramp-preview"},n.tsx("div",{styles:u},n.tsx("div",{styles:f},n.tsx("div",{class:O.CSS.rampContainer,bind:l,afterCreate:a.attachToNode})),n.tsx("div",{styles:f},n.tsx("div",{class:O.CSS.rampLabelsContainer,
styles:P},R))),n.tsx("div",{styles:u},n.tsx("div",{styles:f},n.tsx("div",{class:O.CSS.rampContainer,bind:C,afterCreate:a.attachToNode})),n.tsx("div",{styles:f},n.tsx("div",{class:O.CSS.rampLabelsContainer,styles:g},y)))):null)};k._renderUnivariateColorSizeRamp=function(g,C,R){const {sizeRampElement:T,colorRampElement:x}=c.getUnivariateColorSizeRampElements(g);if(!T)return null;var P=c.getUnivariateColorRampMargin(T);g=c.getUnivariateColorRampSize(T,"full",!1);C=c.getUnivariateColorRampPreview(x,{width:12,
height:g,rampAlignment:"vertical",opacity:C,type:"full",effectList:R});const l=T.infos.length-1;R=T.infos.map((W,M)=>0===M||M===l?n.tsx("div",{key:M,class:W.label?x?O.CSS.univariateAboveAndBelowLabel:O.CSS.rampLabel:null},W.label):null);const z={display:"table-cell",verticalAlign:"middle"};P={marginTop:`${P}px`};g={height:`${g}px`};return n.tsx("div",{key:"univariate-above-and-below-ramp-preview",styles:D},n.tsx("div",{class:O.CSS.layerBody},T.infos.map(W=>n.tsx("div",{class:this.classes(O.CSS.layerRow,
O.CSS.sizeRamp)},n.tsx("div",{class:O.CSS.symbol,styles:z,bind:W.preview,afterCreate:a.attachToNode})))),n.tsx("div",{styles:P,key:"color-ramp-preview"},n.tsx("div",{styles:u},n.tsx("div",{styles:f},n.tsx("div",{class:O.CSS.rampContainer,bind:C,afterCreate:a.attachToNode})),n.tsx("div",{styles:f},n.tsx("div",{class:O.CSS.rampLabelsContainer,styles:g},R)))))};k._renderLegendForRamp=function(g,C){const R=g.infos,T="heatmap-ramp"===g.type,x="stretch-ramp"===g.type,P=g.preview;P.className=`${O.CSS.colorRamp} ${"opacity-ramp"===
g.type?O.CSS.opacityRamp:""}`;null!=C&&(P.style.opacity=C.toString());g=R.map(l=>n.tsx("div",{class:l.label?O.CSS.rampLabel:null},T?this.messages[l.label]||l.label:x?this._getStretchStopLabel(l):l.label));C={height:P.style.height};return n.tsx("div",{class:O.CSS.layerRow},n.tsx("div",{class:O.CSS.symbolContainer,styles:{width:"24px"}},n.tsx("div",{class:O.CSS.rampContainer,bind:P,afterCreate:a.attachToNode})),n.tsx("div",{class:O.CSS.layerInfo},n.tsx("div",{class:O.CSS.rampLabelsContainer,styles:C},
g)))};k._getStretchStopLabel=function(g){return g.label?this.messages[g.label]+": "+("string"===typeof g.value?g.value:K.formatNumber(g.value,{style:"decimal",notation:g.value.toString().includes("e")?"scientific":"standard"})):""};k._renderLegendForElementInfo=function(g,C,R,T,x){if(g.type)return this._renderLegendForElement(g,C,R,!0);R=null;x=a.isImageryStretchedLegend(C,x);g.preview?R=n.tsx("div",{class:O.CSS.symbol,bind:g.preview,afterCreate:a.attachToNode}):g.src&&(R=this._renderImage(g,C,x));
if(!R)return null;C={[O.CSS.imageryLayerInfoStretched]:x};return n.tsx("div",{class:O.CSS.layerRow},n.tsx("div",{class:this.classes(O.CSS.symbolContainer,{[O.CSS.imageryLayerInfoStretched]:x,[O.CSS.sizeRamp]:!x&&T})},R),n.tsx("div",{class:this.classes(O.CSS.layerInfo,C)},a.getTitle(this.messages,g.label,!1)||""))};k._renderImage=function(g,C,R){const {label:T,src:x,opacity:P}=g;R={[O.CSS.imageryLayerStretchedImage]:R,[O.CSS.symbol]:!R};C={opacity:`${null!=P?P:C.opacity}`};return n.tsx("img",{alt:a.getTitle(this.messages,
T,!1),src:x,border:0,width:g.width,height:g.height,class:this.classes(R),styles:C})};return F}(w);H.__decorate([B.property()],J.prototype,"activeLayerInfos",void 0);H.__decorate([B.property()],J.prototype,"headingLevel",void 0);H.__decorate([B.property(),t.messageBundle("esri/widgets/Legend/t9n/Legend")],J.prototype,"messages",void 0);H.__decorate([B.property({readOnly:!0})],J.prototype,"type",void 0);return J=H.__decorate([N.subclass("esri.widgets.Legend.styles.Classic")],J)})},"esri/widgets/Legend/styles/ClassicCSS":function(){define(["exports"],
function(A){A.CSS={service:"esri-legend__service",label:"esri-legend__service-label",layer:"esri-legend__layer",groupLayer:"esri-legend__group-layer",groupLayerChild:"esri-legend__group-layer-child",layerTable:"esri-legend__layer-table",layerTableSizeRamp:"esri-legend__layer-table--size-ramp",layerChildTable:"esri-legend__layer-child-table",layerCaption:"esri-legend__layer-caption",layerBody:"esri-legend__layer-body",layerRow:"esri-legend__layer-row",layerCell:"esri-legend__layer-cell",layerInfo:"esri-legend__layer-cell esri-legend__layer-cell--info",
imageryLayerStretchedImage:"esri-legend__imagery-layer-image--stretched",imageryLayerCellStretched:"esri-legend__imagery-layer-cell--stretched",imageryLayerInfoStretched:"esri-legend__imagery-layer-info--stretched",symbolContainer:"esri-legend__layer-cell esri-legend__layer-cell--symbols",symbol:"esri-legend__symbol",rampContainer:"esri-legend__ramps",sizeRamp:"esri-legend__size-ramp",colorRamp:"esri-legend__color-ramp",opacityRamp:"esri-legend__opacity-ramp",borderlessRamp:"esri-legend__borderless-ramp",
rampTick:"esri-legend__ramp-tick",rampFirstTick:"esri-legend__ramp-tick-first",rampLastTick:"esri-legend__ramp-tick-last",rampLabelsContainer:"esri-legend__ramp-labels",rampLabel:"esri-legend__ramp-label",univariateAboveAndBelowSymbol:"esri-univariate-above-and-below-ramp__symbol",univariateAboveAndBelowLabel:"esri-univariate-above-and-below-ramp__label",message:"esri-legend__message",header:"esri-widget__heading",hidden:"esri-hidden"};A.LEGEND="esri-legend";Object.defineProperty(A,Symbol.toStringTag,
{value:"Module"})})},"*noref":1}});
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Handles ../core/maybe ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/arrayUtils ../core/accessorSupport/decorators/subclass ./Widget ./Legend/LegendViewModel ./Legend/styles/Card ./Legend/styles/Classic ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory".split(" "),function(A,H,J,B,q,L,N,w,O,r,c,a,h,e,t,n){w=function(K){function S(u,
f){u=K.call(this,u,f)||this;u._handles=new J;u.headingLevel=3;u.iconClass="esri-icon-layer-list";u.messages=null;u.style=new h;u.viewModel=new c;return u}A._inheritsLoose(S,K);var D=S.prototype;D.initialize=function(){this.addHandles([q.on(()=>this.view,"resize",()=>this.scheduleRender()),q.on(()=>this.activeLayerInfos,"change",()=>this._refreshActiveLayerInfos(this.activeLayerInfos)),q.watch(()=>this.headingLevel,u=>{const {style:f}=this;f&&(f.headingLevel=u)}),q.watch(()=>this.style,(u,f)=>{f&&
u!==f&&f.destroy();u&&(u.activeLayerInfos=this.activeLayerInfos,"card"===u.type&&(u.view=this.view),u.headingLevel=this.headingLevel)},q.initial)])};D.destroy=function(){this._handles=B.destroyMaybe(this._handles)};D.castStyle=function(u){if(u instanceof a||u instanceof h)return u;if("string"===typeof u)return"card"===u?new a:new h;if(u&&"string"===typeof u.type){const f={...u};delete f.type;return new ("card"===u.type?a:h)(f)}return new h};D.render=function(){return n.tsx("div",{class:this.classes("esri-legend",
"esri-widget",this.style instanceof h?"esri-widget--panel":null)},this.style.render())};D._refreshActiveLayerInfos=function(u){this._handles.removeAll();u.forEach(f=>this._renderOnActiveLayerInfoChange(f));this.scheduleRender()};D._renderOnActiveLayerInfoChange=function(u){var f=q.watch(()=>u.version,()=>this.scheduleRender());this._handles.add(f,`version_${u.layer.uid}`);f=q.on(()=>u.children,"change",()=>u.children.forEach(p=>this._renderOnActiveLayerInfoChange(p)),q.initial);this._handles.add(f,
`children_${u.layer.uid}`);u.children.forEach(p=>this._renderOnActiveLayerInfoChange(p))};A._createClass(S,[{key:"activeLayerInfos",get:function(){return this.viewModel.activeLayerInfos},set:function(u){this.viewModel.activeLayerInfos=u}},{key:"basemapLegendVisible",get:function(){return this.viewModel.basemapLegendVisible},set:function(u){this.viewModel.basemapLegendVisible=u}},{key:"groundLegendVisible",get:function(){return this.viewModel.groundLegendVisible},set:function(u){this.viewModel.groundLegendVisible=
u}},{key:"hideLayersNotInCurrentView",get:function(){return this.viewModel.hideLayersNotInCurrentView},set:function(u){this.viewModel.hideLayersNotInCurrentView=u}},{key:"keepCacheOnDestroy",get:function(){return this.viewModel.keepCacheOnDestroy},set:function(u){this.viewModel.keepCacheOnDestroy=u}},{key:"respectLayerVisibility",get:function(){return this.viewModel.respectLayerVisibility},set:function(u){this.viewModel.respectLayerVisibility=u}},{key:"label",get:function(){return this.messages?.widgetLabel??
""},set:function(u){this._overrideIfSome("label",u)}},{key:"layerInfos",get:function(){return this.viewModel.layerInfos},set:function(u){this.viewModel.layerInfos=u}},{key:"view",get:function(){return this.viewModel.view},set:function(u){this.viewModel.view=u}}]);return S}(r);H.__decorate([L.property()],w.prototype,"activeLayerInfos",null);H.__decorate([L.property()],w.prototype,"basemapLegendVisible",null);H.__decorate([L.property()],w.prototype,"groundLegendVisible",null);H.__decorate([L.property()],
w.prototype,"headingLevel",void 0);H.__decorate([L.property()],w.prototype,"hideLayersNotInCurrentView",null);H.__decorate([L.property()],w.prototype,"keepCacheOnDestroy",null);H.__decorate([L.property()],w.prototype,"respectLayerVisibility",null);H.__decorate([L.property()],w.prototype,"iconClass",void 0);H.__decorate([L.property()],w.prototype,"label",null);H.__decorate([L.property()],w.prototype,"layerInfos",null);H.__decorate([L.property(),t.messageBundle("esri/widgets/Legend/t9n/Legend")],w.prototype,
"messages",void 0);H.__decorate([L.property()],w.prototype,"style",void 0);H.__decorate([N.cast("style")],w.prototype,"castStyle",null);H.__decorate([L.property()],w.prototype,"view",null);H.__decorate([L.property()],w.prototype,"viewModel",void 0);return w=H.__decorate([O.subclass("esri.widgets.Legend")],w)});