// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.26/esri/copyright.txt for details.
//>>built
define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/HandleOwner ../core/maybe ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/arrayUtils ../core/accessorSupport/decorators/subclass ./Widget ./FeatureTemplates/FeatureTemplatesViewModel ./FeatureTemplates/ItemList ./FeatureTemplates/TemplateItem ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory".split(" "),
function(w,m,d,b,A,x,e,B,K,C,D,y,E,F,L,G,H,q){function I(r){return r.id}const z={filter:!0};b=function(r){function t(a,c){a=r.call(this,a,c)||this;a._iconIntersectionObserver=new IntersectionObserver((g,l)=>{g.forEach(function(){var n=m._asyncToGenerator(function*(h){if(h.isIntersecting){const k=h.target;if(k["data-has-icon"])l.unobserve(k);else{var {layer:v,template:u}=k["data-item"];k["data-has-icon"]=!0;h=yield F.fetchThumbnail(v,u).catch(()=>{k["data-has-icon"]=!1;return null});A.isNone(h)||k.appendChild(h)}}});
return function(h){return n.apply(this,arguments)}}())});a.enableListScroll=!0;a.filterText="";a.headingLevel=4;a.messages=null;a.viewModel=new y;a.visibleElements={...z};a.renderItemIcon=a.renderItemIcon.bind(m._assertThisInitialized(a));a._afterItemCreateOrUpdate=a._afterItemCreateOrUpdate.bind(m._assertThisInitialized(a));a._afterItemRemoved=a._afterItemRemoved.bind(m._assertThisInitialized(a));return a}m._inheritsLoose(t,r);var f=t.prototype;f.initialize=function(){const a=({label:c})=>!this.filterText||
!!c?.toLowerCase().includes(this.filterText.toLowerCase());this.addHandles(x.watch(()=>this.viewModel,(c,g)=>{c&&!c.filterFunction&&(this.filterFunction=a);g&&g!==c&&g.filterFunction===a&&(g.filterFunction=null)},x.initial))};f.destroy=function(){this._iconIntersectionObserver?.disconnect();this._iconIntersectionObserver=null};f.loadDependencies=function(){return Promise.all([new Promise((a,c)=>w(["../chunks/calcite-input"],a,c)),new Promise((a,c)=>w(["../chunks/calcite-list-item"],a,c))])};f.castVisibleElements=
function(a){return{...z,...a}};f.select=function(a,c){return this.viewModel.select(a,c)};f.render=function(){const {enableListScroll:a,filterText:c,headingLevel:g,messages:l,viewModel:{items:n,numberOfFeatureTemplates:h,selectedItem:v,state:u}}=this,k=this.visibleElements.filter&&1<h;if(0<n.length&&"items"in n[0]){const p=n.find(J=>J.label===y.nullGroupBy.label);p&&(p.label=l.other)}return q.tsx("div",{class:this.classes("esri-feature-templates","esri-widget"),"aria-label":l.widgetLabel},"loading"===
u?this.renderLoader():"ready"===u?q.tsx(E.ItemList,{id:this.id,identify:I,filterText:c,items:n,headingLevel:g,selectionMode:"single",messages:{filterPlaceholder:l.filterPlaceholder,noItems:l.noItems,noMatches:l.noMatches},filterEnabled:k,onItemSelect:p=>this.viewModel.select(p),onFilterChange:p=>{this.filterText=p;this.viewModel.refresh()},renderIcon:this.renderItemIcon,selectedItem:v??void 0,enableListScroll:a}):null)};f.renderItemIcon=function({item:a}){return q.tsx("span",{key:"icon",afterCreate:this._afterItemCreateOrUpdate,
afterUpdate:this._afterItemCreateOrUpdate,afterRemoved:this._afterItemRemoved,"data-item":a,"data-has-icon":!1})};f.renderLoader=function(){return q.tsx("div",{class:"esri-feature-templates__loader",key:"loader"})};f._afterItemCreateOrUpdate=function(a){this._iconIntersectionObserver?.observe(a)};f._afterItemRemoved=function(a){this._iconIntersectionObserver?.unobserve(a)};m._createClass(t,[{key:"filterFunction",get:function(){return this.viewModel.filterFunction},set:function(a){this.viewModel.filterFunction=
a}},{key:"groupBy",get:function(){return this.viewModel.groupBy},set:function(a){this.viewModel.groupBy=a}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(a){this._overrideIfSome("label",a)}},{key:"layers",get:function(){return this.viewModel.layers},set:function(a){this.viewModel.layers=a}},{key:"selectedItem",get:function(){return this.viewModel.selectedItem}}]);return t}(b.HandleOwnerMixin(D));d.__decorate([e.property()],b.prototype,"enableListScroll",void 0);d.__decorate([e.property()],
b.prototype,"filterFunction",null);d.__decorate([e.property()],b.prototype,"filterText",void 0);d.__decorate([e.property()],b.prototype,"groupBy",null);d.__decorate([e.property()],b.prototype,"headingLevel",void 0);d.__decorate([e.property()],b.prototype,"label",null);d.__decorate([e.property()],b.prototype,"layers",null);d.__decorate([e.property(),G.messageBundle("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],b.prototype,"messages",void 0);d.__decorate([e.property({readOnly:!0})],b.prototype,
"selectedItem",null);d.__decorate([e.property(),H.vmEvent("select")],b.prototype,"viewModel",void 0);d.__decorate([e.property()],b.prototype,"visibleElements",void 0);d.__decorate([B.cast("visibleElements")],b.prototype,"castVisibleElements",null);return b=d.__decorate([C.subclass("esri.widgets.FeatureTemplates")],b)});