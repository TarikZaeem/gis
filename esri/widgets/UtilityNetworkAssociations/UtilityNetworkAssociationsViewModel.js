// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.26/esri/copyright.txt for details.
//>>built
define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Graphic ../../core/Accessor ../../core/Handles ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass ../../geometry/Extent ../../geometry/Point ../../geometry/Polyline ../../geometry/projection ../../layers/GraphicsLayer ../../rest/networks/synthesizeAssociationGeometries ../../rest/networks/support/SynthesizeAssociationGeometriesParameters ../../symbols/CIMSymbol ../../symbols/SimpleLineSymbol ../../views/draw/support/layerUtils".split(" "),
function(r,d,l,c,y,z,f,G,H,A,B,u,m,n,C,D,E,F,v,p){c=function(w){function q(a){a=w.call(this,a)||this;a._handles=new y;a._internalArrowsLayerConnectivity=a._createInternalGraphicsLayer("Connectivity Associations - Arrows (Internal)");a._internalArrowsLayerStructuralAttachment=a._createInternalGraphicsLayer("Structural Attachment Associations - Arrows (Internal)");a._internalGraphicsLayerConnectivity=a._createInternalGraphicsLayer("Connectivity Associations (Internal)");a._internalGraphicsLayerStructuralAttachment=
a._createInternalGraphicsLayer("Structural Attachment Associations (Internal)");a.connectivityAssociationsLineSymbol=new v({style:"short-dash",width:2,color:[190,159,159,1]});a.gdbVersion="sde.DEFAULT";a.maxAllowableAssociations=250;a.maxAllowableAssociationsExceeded=!1;a.moment=null;a.noAssociationsFound=!1;a.showArrowsConnectivity=!1;a.showArrowsStructuralAttachment=!1;a.structuralAttachmentAssociationsLineSymbol=new v({style:"short-dash",width:2,color:[159,190,159,1]});return a}r._inheritsLoose(q,
w);var g=q.prototype;g.initialize=function(){this._handles.add([z.watch(()=>this.view,a=>{a&&(p.addUniqueLayer(a,this._internalGraphicsLayerConnectivity),p.addUniqueLayer(a,this._internalArrowsLayerConnectivity),p.addUniqueLayer(a,this._internalGraphicsLayerStructuralAttachment),p.addUniqueLayer(a,this._internalArrowsLayerStructuralAttachment));this._internalGraphicsLayerConnectivity.visible=this.includeConnectivityAssociations;this._internalGraphicsLayerStructuralAttachment.visible=this.includeStructuralAttachmentAssociations})])};
g.destroy=function(){this.utilityNetwork=this.view=null;this._removeInternalGraphicsLayers()};g.removeAssociations=function(){this._internalGraphicsLayerConnectivity.removeAll();this._internalGraphicsLayerStructuralAttachment.removeAll();this._internalArrowsLayerConnectivity.removeAll();this._internalArrowsLayerStructuralAttachment.removeAll()};g.showAssociations=function(){var a=r._asyncToGenerator(function*(){if(this.includeConnectivityAssociations||this.includeStructuralAttachmentAssociations){this._internalGraphicsLayerConnectivity.visible=
this.includeConnectivityAssociations;this._internalGraphicsLayerStructuralAttachment.visible=this.includeStructuralAttachmentAssociations;this._internalArrowsLayerConnectivity.visible=this.showArrowsConnectivity&&this.includeConnectivityAssociations;this._internalArrowsLayerStructuralAttachment.visible=this.showArrowsStructuralAttachment&&this.includeStructuralAttachmentAssociations;this.maxAllowableAssociationsExceeded=!1;this.removeAssociations();n.isLoaded()||(yield n.load());var e=this.utilityNetwork.spatialReference,
h=n.project(new u({x:this.view?.extent.xmin,y:this.view?.extent.ymin,spatialReference:this.view?.spatialReference}),e),k=n.project(new u({x:this.view?.extent.xmax,y:this.view?.extent.ymax,spatialReference:this.view?.spatialReference}),e);e=new B({xmin:h.x,ymin:h.y,xmax:k.x,ymax:k.y,spatialReference:e});e=new E({returnConnectivityAssociations:this.includeConnectivityAssociations,returnAttachmentAssociations:this.includeStructuralAttachmentAssociations,extent:e,outSpatialReference:this.utilityNetwork.spatialReference,
maxGeometryCount:this.maxAllowableAssociations,gdbVersion:this.gdbVersion,moment:this.moment});e=yield D.synthesizeAssociationGeometries(this.utilityNetwork.networkServiceUrl,e);h=[];k=[];var t=[],x=[];if(e){if(!0===e.maxGeometryCountExceeded){this.maxAllowableAssociationsExceeded=!0;return}if(0===e.associations.length){this.noAssociationsFound=!0;return}this.noAssociationsFound=this.maxAllowableAssociationsExceeded=!1;h=e.associations.filter(b=>"connectivity"===b.associationType).map(b=>{b=new m({paths:b.geometry.paths,
spatialReference:b.geometry.spatialReference});return new l({geometry:b,symbol:this.connectivityAssociationsLineSymbol})});k=e.associations.filter(b=>"connectivity"===b.associationType).map(b=>{b=new m({paths:b.geometry.paths,spatialReference:b.geometry.spatialReference});return new l({geometry:b,symbol:this._getCIMSymbolArrows(this.connectivityAssociationsLineSymbol.color)})});t=e.associations.filter(b=>"attachment"===b.associationType).map(b=>{b=new m({paths:b.geometry.paths,spatialReference:b.geometry.spatialReference});
return new l({geometry:b,symbol:this.structuralAttachmentAssociationsLineSymbol})});x=e.associations.filter(b=>"attachment"===b.associationType).map(b=>{b=new m({paths:b.geometry.paths,spatialReference:b.geometry.spatialReference});return new l({geometry:b,symbol:this._getCIMSymbolArrows(this.structuralAttachmentAssociationsLineSymbol.color)})})}0<h.length&&(this._internalGraphicsLayerConnectivity.addMany(h),this._internalArrowsLayerConnectivity.addMany(k));0<t.length&&(this._internalGraphicsLayerStructuralAttachment.addMany(t),
this._internalArrowsLayerStructuralAttachment.addMany(x))}else this.removeAssociations()});return function(){return a.apply(this,arguments)}}();g._createInternalGraphicsLayer=function(a){return new C({listMode:"hide",internal:!0,title:a})};g._getCIMSymbolArrows=function(a){return new F({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,size:6,markerPlacement:{type:"CIMMarkerPlacementAtExtremities",extremityPlacement:"JustEnd",angleToLine:!0},
frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[-18,-5.47],[-18,5.6],[1.96,-.03],[-18,-5.47]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:a}]}}]}]}}})};g._removeInternalGraphicsLayers=function(){this._internalGraphicsLayerConnectivity&&this._internalGraphicsLayerStructuralAttachment&&this.view&&this.view.map&&(this.view.map.remove(this._internalGraphicsLayerConnectivity),this.view.map.remove(this._internalGraphicsLayerStructuralAttachment),
this.view.map.remove(this._internalArrowsLayerConnectivity),this.view.map.remove(this._internalArrowsLayerStructuralAttachment))};r._createClass(q,[{key:"includeConnectivityAssociations",set:function(a){this._set("includeConnectivityAssociations",a);this._internalGraphicsLayerConnectivity.visible=a;this._internalArrowsLayerConnectivity.visible=a}},{key:"includeStructuralAttachmentAssociations",set:function(a){this._set("includeStructuralAttachmentAssociations",a);this._internalGraphicsLayerStructuralAttachment.visible=
a;this._internalArrowsLayerStructuralAttachment.visible=a}},{key:"state",get:function(){return this.view?.ready?"ready":"loading"}},{key:"view",get:function(){return this._get("view")},set:function(a){this._set("view",a)}}]);return q}(c);d.__decorate([f.property()],c.prototype,"connectivityAssociationsLineSymbol",void 0);d.__decorate([f.property()],c.prototype,"gdbVersion",void 0);d.__decorate([f.property({type:Boolean,value:!0})],c.prototype,"includeConnectivityAssociations",null);d.__decorate([f.property({type:Boolean,
value:!0})],c.prototype,"includeStructuralAttachmentAssociations",null);d.__decorate([f.property()],c.prototype,"maxAllowableAssociations",void 0);d.__decorate([f.property()],c.prototype,"maxAllowableAssociationsExceeded",void 0);d.__decorate([f.property()],c.prototype,"moment",void 0);d.__decorate([f.property()],c.prototype,"noAssociationsFound",void 0);d.__decorate([f.property()],c.prototype,"showArrowsConnectivity",void 0);d.__decorate([f.property()],c.prototype,"showArrowsStructuralAttachment",
void 0);d.__decorate([f.property({readOnly:!0})],c.prototype,"state",null);d.__decorate([f.property()],c.prototype,"structuralAttachmentAssociationsLineSymbol",void 0);d.__decorate([f.property()],c.prototype,"utilityNetwork",void 0);d.__decorate([f.property({value:null})],c.prototype,"view",null);return c=d.__decorate([A.subclass("esri.widgets.UtilityNetworkAssociations.UtilityNetworkAssociationsViewModel")],c)});