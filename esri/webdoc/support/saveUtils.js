// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.26/esri/copyright.txt for details.
//>>built
define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/asyncUtils ../../core/Error ../../core/maybe ../../core/promiseUtils ../../core/uuid ../../portal/support/resourceUtils".split(" "),function(n,g,p,v,w,q,x,y){function h(){h=g._asyncToGenerator(function*(b,a,d){if(a&&a.resources){var k=a.portalItem===b.portalItem?new Set(b.paths):new Set;b.paths.length=0;b.portalItem=a.portalItem;var f=new Set(a.resources.toKeep.map(c=>c.resource.path)),r=new Set,e=[];f.forEach(c=>{k.delete(c);b.paths.push(c)});
for(const c of a.resources.toUpdate)if(k.delete(c.resource.path),f.has(c.resource.path)||r.has(c.resource.path)){const {resource:z,content:A,finish:B,error:C}=c,t=y.getSiblingOfSameTypeI(z,x.generateUUID());b.paths.push(t.path);e.push(u({resource:t,content:A,compress:c.compress,finish:B,error:C},d))}else b.paths.push(c.resource.path),e.push(D(c,d)),r.add(c.resource.path);for(const c of a.resources.toAdd)e.push(u(c,d)),b.paths.push(c.resource.path);k.forEach(c=>{a.portalItem&&(c=a.portalItem.resourceFromPath(c),
e.push(c.portalItem.removeResource(c).catch(()=>{})))});if(0!==e.length&&(f=yield q.eachAlways(e),q.throwIfAborted(d),d=f.filter(c=>"error"in c).map(c=>c.error),0<d.length))throw new v("save:resources","Failed to save one or more resources",{errors:d});}});return h.apply(this,arguments)}function u(b,a){return l.apply(this,arguments)}function l(){l=g._asyncToGenerator(function*(b,a){a={...(w.isSome(a)?a:{}),compress:b.compress};a=yield p.result(b.resource.portalItem.addResource(b.resource,b.content,
a));if(!0===a.ok)b.finish?.(b.resource);else throw b.error?.(a.error),a.error;});return l.apply(this,arguments)}function D(b,a){return m.apply(this,arguments)}function m(){m=g._asyncToGenerator(function*(b,a){a=yield p.result(b.resource.update(b.content,a));if(!0===a.ok)b.finish?.(b.resource);else throw b.error?.(a.error),a.error;});return m.apply(this,arguments)}n.saveResources=function(b,a,d){return h.apply(this,arguments)};Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})});