// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.26/esri/copyright.txt for details.
//>>built
require({cache:{"esri/rasterRenderers":function(){define("exports ./core/Warning ./renderers/ClassBreaksRenderer ./renderers/FlowRenderer ./renderers/RasterColormapRenderer ./renderers/RasterShadedReliefRenderer ./renderers/RasterStretchRenderer ./renderers/UniqueValueRenderer ./renderers/VectorFieldRenderer".split(" "),function(P,D,F,I,p,R,U,H,N){function B(f,c){if(!f)return null;if("classBreaks"===f.type&&f.classificationMethod){var m=f.authoringInfo||{classificationMethod:""};m.classificationMethod=
f.classificationMethod;f.authoringInfo=m}"vectorField"===f.type&&f.visualVariables&&!Array.isArray(f.visualVariables)&&(f.visualVariables=[f.visualVariables]);m=f?k[f.type]||null:null;if(m)return m=new m,m.read(f,c),m;c&&c.messages&&f&&c.messages.push(new D("renderer:unsupported","Renderers of type '"+(f.type||"unknown")+"' are not supported",{definition:f,context:c}));return null}const l={key:"type",base:null,typeMap:{"unique-value":H,"class-breaks":F,"raster-colormap":p,"raster-stretch":U,"vector-field":N,
"raster-shaded-relief":R,flow:I}},b={...l,typeMap:{...l.typeMap}};delete b.typeMap["vector-field"];delete b.typeMap.flow;const k={uniqueValue:H,classBreaks:F,rasterStretch:U,rasterColormap:p,vectorField:N,rasterShadedRelief:R,flowRenderer:I};P.ClassBreaksRenderer=F;P.FlowRenderer=I;P.RasterColormapRenderer=p;P.RasterShadedReliefRenderer=R;P.RasterStretchRenderer=U;P.UniqueValueRenderer=H;P.VectorFieldRenderer=N;P.fromJSON=function(f,c){return B(f,c)};P.rasterRendererTypes=l;P.read=B;P.websceneRasterRendererTypes=
b;Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/FlowRenderer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../Color ../core/jsonMap ../core/JSONSupport ../core/screenUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/subclass ./mixins/VisualVariablesMixin ./support/AuthoringInfo ./support/LegendOptions".split(" "),
function(P,D,F,I,p,R,U,H,N,B,l,b,k,f){var c;I=new I.JSONMap({flow_from:"flow-from",flow_to:"flow-to"});p=c=function(m){function h(E){E=m.call(this,E)||this;E.density=.8;E.color=new F([255,255,255,1]);E.maxPathLength=200;E.trailWidth=1.5;E.flowSpeed=10;E.trailLength=100;E.smoothing=0;E.flowRepresentation="flow-from";E.type="flow";E.authoringInfo=null;E.legendOptions=null;E.trailCap="butt";E.background="none";return E}P._inheritsLoose(h,m);var r=h.prototype;r.clone=function(){const {density:E,maxPathLength:J,
trailWidth:d,flowSpeed:n,trailLength:x,smoothing:q,flowRepresentation:g,trailCap:a,background:e}=this,t=this.color.clone(),v=(this.visualVariables||[]).map(G=>G.clone()),w=this.authoringInfo?.clone(),y=this.legendOptions?.clone();return new c({density:E,color:t,maxPathLength:J,trailWidth:d,flowSpeed:n,trailLength:x,trailCap:a,background:e,smoothing:q,flowRepresentation:g,visualVariables:v,authoringInfo:w,legendOptions:y})};r.getSymbol=function(E,J){};r.getSymbolAsync=function(){var E=P._asyncToGenerator(function*(J,
d){});return function(J,d){return E.apply(this,arguments)}}();r.getSymbols=function(){return[]};return h}(b.VisualVariablesMixin(p.JSONSupport));D.__decorate([U.property({type:Number,json:{write:!0}})],p.prototype,"density",void 0);D.__decorate([U.property({type:F,json:{write:{allowNull:!0}}})],p.prototype,"color",void 0);D.__decorate([U.property({type:Number,cast:R.toPt,json:{write:!0}})],p.prototype,"maxPathLength",void 0);D.__decorate([U.property({type:Number,cast:R.toPt,json:{write:!0}})],p.prototype,
"trailWidth",void 0);D.__decorate([U.property({type:Number,json:{write:!0}})],p.prototype,"flowSpeed",void 0);D.__decorate([U.property({type:Number,json:{write:!0}})],p.prototype,"trailLength",void 0);D.__decorate([U.property({type:Number,cast:R.toPt,json:{write:!1}})],p.prototype,"smoothing",void 0);D.__decorate([U.property({type:I.apiValues,json:{type:I.jsonValues,read:{reader:I.read},write:{writer:I.write}}})],p.prototype,"flowRepresentation",void 0);D.__decorate([B.enumeration({flowRenderer:"flow"})],
p.prototype,"type",void 0);D.__decorate([U.property({type:k,json:{write:!0}})],p.prototype,"authoringInfo",void 0);D.__decorate([U.property({type:f.LegendOptions,json:{write:!0}})],p.prototype,"legendOptions",void 0);D.__decorate([U.property({type:String,json:{write:!0}})],p.prototype,"trailCap",void 0);D.__decorate([U.property({type:String,json:{write:!0}})],p.prototype,"background",void 0);return p=c=D.__decorate([l.subclass("esri.renderers.FlowRenderer")],p)})},"esri/renderers/RasterColormapRenderer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/subclass ./support/ColormapInfo ./support/colorRampUtils".split(" "),
function(P,D,F,I,p,R,U,H,N,B){var l;F=l=function(b){function k(c){c=b.call(this,c)||this;c.colormapInfos=null;c.type="raster-colormap";return c}P._inheritsLoose(k,b);k.createFromColormap=function(c,m){if(!c)return null;const h=5===c[0].length;c=[...c].sort(r=>r[0][0]-r[1][0]).map(r=>N.fromJSON({value:r[0],color:h?r.slice(1,5):r.slice(1,4).concat([255]),label:m?m[r[0]]??"":r[0]}));return new l({colormapInfos:c})};k.createFromColorramp=function(c){c=B.convertColorRampToColormap(c);return l.createFromColormap(c)};
var f=k.prototype;f.clone=function(){return new l({colormapInfos:this.colormapInfos.map(c=>c.toJSON())})};f.extractColormap=function(){return this.colormapInfos.map(({value:c,color:m})=>[c,m.r,m.g,m.b,1<m.a?m.a:255*m.a&255]).sort((c,m)=>c[0]-m[0])};return k}(F.JSONSupport);D.__decorate([I.property({type:[N],json:{write:!0}})],F.prototype,"colormapInfos",void 0);D.__decorate([U.enumeration({rasterColormap:"raster-colormap"})],F.prototype,"type",void 0);return F=l=D.__decorate([H.subclass("esri.renderers.RasterColormapRenderer")],
F)})},"esri/renderers/support/ColormapInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Color ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass".split(" "),function(P,D,F,I,p,R,U,H){I=function(N){function B(){var l=N.apply(this,arguments)||this;l.value=null;l.label=null;l.color=null;return l}P._inheritsLoose(B,N);return B}(I.JSONSupport);
D.__decorate([p.property({type:Number,json:{write:!0}})],I.prototype,"value",void 0);D.__decorate([p.property({type:String,json:{write:!0}})],I.prototype,"label",void 0);D.__decorate([p.property({type:F,json:{type:[R.Integer],write:!0}})],I.prototype,"color",void 0);return I=D.__decorate([H.subclass("esri.renderers.support.ColormapInfo")],I)})},"esri/renderers/support/colorRampUtils":function(){define(["exports","../../Color","../../core/colorUtils","../../core/jsonMap"],function(P,D,F,I){function p(h,
r){if(!h||!r||h.length!==r.length)return!1;for(let E=0;E<h.length;E++)if(h[E]>r[E]+2||h[E]<r[E]-2)return!1;return!0}function R(h,r){if(h){r=r?r:f;var E=null;"algorithmic"===h.type?r.some(J=>{if(p(h.fromColor.toRgb(),J.fromColor)&&p(h.toColor.toRgb(),J.toColor))return E=J.id,!0}):"multipart"===h.type&&r.some(J=>{const d=h.colorRamps,n=J.colorRamps;if(d&&n&&d.length===n.length&&!n.some((x,q)=>{if(!p(d[q].fromColor.toRgb(),(new D(x.fromColor)).toRgb())||!p(d[q].toColor.toRgb(),(new D(x.toColor)).toRgb()))return!0})){if(E)return!0;
E=J.id}});return E}}function U(h){return(h=R(h))?c[h]:null}function H(h){h=h||{};const r=h.numColors||256;return{...h,numColors:r,distanceOffset:h.distanceOffset||0,interpolateAlpha:!!h.interpolateAlpha,distanceInterval:h.distanceInterval||1/(r-1),isCustomInterval:null!=h.isCustomInterval?h.isCustomInterval:null!==h.distanceInterval&&h.distanceInterval!==1/(r-1),weights:h.weights}}function N(h,r){let {fromColor:E,toColor:J}=h;3===E.length&&(E=E.concat([255]));3===J.length&&(J=J.concat([255]));h=h.algorithm||
"esriCIELabAlgorithm";var d=H(r);const {numColors:n,distanceOffset:x,isCustomInterval:q,interpolateAlpha:g}=d;if(1===n&&0===x)return[E];if(2===n&&0===x&&!q)return[E,J];var a={r:E[0],g:E[1],b:E[2]};r={r:J[0],g:J[1],b:J[2]};if("esriCIELabAlgorithm"===h){h=F.toLAB(a);r=F.toLAB(r);const {numColors:w,distanceOffset:y,distanceInterval:G,isCustomInterval:C}=d;let {l:u,a:z,b:L}=h;h=(r.l-u)*G;a=(r.a-z)*G;d=(r.b-L)*G;var e=[];if(y){var t=y/G;u+=t*h;z+=t*a;L+=t*d}for(t=0;t<w-1;t++)e.push({l:u,a:z,b:L}),u+=h,
z+=a,L+=d;e.push(C?{l:u,a:z,b:L}:r);r=e}else if("esriHSVAlgorithm"===h){h=F.toHSV(a);r=F.toHSV(r);const {numColors:w,distanceOffset:y,distanceInterval:G,isCustomInterval:C}=d;e=0===h.s;t=0===r.s;a=h.h;d=r.h;e&&!t?a=d:t&&!e&&(r={...r,h:a},d=a);e=Math.abs(d-a);180>e?d=(d-a)*G:(e=360-e,d=a>d?e*G:-e*G);e=(r.s-h.s)*G;t=(r.v-h.v)*G;let {s:u,v:z}=h;h=a;y&&(a=y/G,h=(h+a*d+360)%360,u+=a*e,z+=a*t);a=[];for(var v=0;v<w-1;v++)a.push({h,s:u,v:z}),h=(h+d+360)%360,u+=e,z+=t;a.push(C?{h,s:u,v:z}:r);r=a}else{a=F.toLCH(a);
r=F.toLCH(r);const {numColors:w,distanceOffset:y,distanceInterval:G,isCustomInterval:C}=d;d=a.h;e=r.h;h=2*Math.PI;d<=e?(t=e-d,d=e-d-h,d=Math.abs(d)<Math.abs(t)?d:t):(t=e+h-d,d=e-d,d=Math.abs(d)<Math.abs(t)?d:t);d*=G;e=(r.l-a.l)*G;t=(r.c-a.c)*G;let {l:u,c:z,h:L}=a;y&&(a=y/G,u+=a*e,z+=a*t,L=(L+a*d+h)%h);a=[];for(v=0;v<w-1;v++)a.push({l:u,c:z,h:L}),u+=e,z+=t,L=(L+d+h)%h;a.push(C?{l:u,c:z,h:L}:r);r=a}h=[];a=E[3]??255;d=((J[3]??255)-a)/(n-1);for(e=0;e<n;e++){const {r:w,g:y,b:G}=F.toRGB(r[e]);h.push([w,
y,G,g?Math.round(a+d*e):255])}return h}function B(h,r){const {numColors:E,interpolateAlpha:J}=H(r);r=r?.weights;({colorRamps:h}=h);if(r){const e=r.reduce((t,v)=>t+v);r=r.map(t=>t/e)}else{r=[];for(var d=0;d<h.length;d++)r[d]=1/h.length}d=[];let n=0,x=0;const q=1/(E-1);let g=!1;for(let e=0;e<h.length;e++){var a=g?0:n*q-x;let t=e===h.length-1?E-1-n:(r[e]-a)/q;g=Math.ceil(t)===t;t=Math.ceil(t);0!==t&&(a/=r[e],a=N(h[e],{numColors:t,interpolateAlpha:J,distanceOffset:a,distanceInterval:q/r[e]}),n+=a.length,
d.push(...a),x+=r[e])}r=[...h[h.length-1].toColor];3===r.length&&r.push(255);d.push(r);return d}function l(h,r){h="toJSON"in h?h.toJSON():h;return"multipart"===h.type?B(h,r):N(h,r)}function b(h){if(h)return{Algorithm:h.toJSON()?.Algorithm||"esriHSVAlgorithm",type:"AlgorithmicColorRamp",FromColor:k(h.fromColor),ToColor:k(h.toColor)}}function k(h){h=F.toHSV(h);return{type:"HsvColor",Hue:h.h,Saturation:h.s,Value:h.v,AlphaValue:255}}const f=[{id:"aspect_predefined",type:"multipart",colorRamps:[{fromColor:[190,
190,190],toColor:[255,45,8]},{fromColor:[255,45,8],toColor:[255,181,61]},{fromColor:[255,181,61],toColor:[255,254,52]},{fromColor:[255,254,52],toColor:[0,251,50]},{fromColor:[0,251,50],toColor:[255,254,52]},{fromColor:[0,253,255],toColor:[0,181,255]},{fromColor:[0,181,255],toColor:[26,35,253]},{fromColor:[26,35,253],toColor:[255,57,251]},{fromColor:[255,57,251],toColor:[255,45,8]}]},{id:"blackToWhite_predefined",fromColor:[0,0,0],toColor:[255,255,255]},{id:"blueBright_predefined",fromColor:[204,204,
255],toColor:[0,0,224]},{id:"blueLightToDark_predefined",fromColor:[211,229,232],toColor:[46,100,140]},{id:"blueGreenBright_predefined",fromColor:[203,245,234],toColor:[48,207,146]},{id:"blueGreenLightToDark_predefined",fromColor:[216,242,237],toColor:[21,79,74]},{id:"brownLightToDark_predefined",fromColor:[240,236,170],toColor:[102,72,48]},{id:"brownToBlueGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[156,85,31],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[33,
130,145]}]},{id:"brownToBlueGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[110,70,45],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[48,100,102]}]},{id:"coefficientBias_predefined",fromColor:[214,214,255],toColor:[0,57,148]},{id:"coldToHotDiverging_predefined",type:"multipart",colorRamps:[{fromColor:[69,117,181],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[214,47,39]}]},{id:"conditionNumber_predefined",type:"multipart",colorRamps:[{fromColor:[0,97,0],
toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,34,0]}]},{id:"cyanToPurple_predefined",type:"multipart",colorRamps:[{fromColor:[0,245,245],toColor:[0,0,245]},{fromColor:[0,0,245],toColor:[245,0,245]}]},{id:"cyanLightToBlueDark_predefined",type:"multipart",colorRamps:[{fromColor:[182,237,240],toColor:[31,131,224]},{fromColor:[31,131,224],toColor:[9,9,145]}]},{id:"distance_predefined",fromColor:[255,200,0],toColor:[0,0,255]},{id:"elevation1_predefined",type:"multipart",colorRamps:[{fromColor:[175,
240,233],toColor:[255,255,179]},{fromColor:[255,255,179],toColor:[0,128,64]},{fromColor:[0,128,64],toColor:[252,186,3]},{fromColor:[252,186,3],toColor:[128,0,0]},{fromColor:[120,0,0],toColor:[105,48,13]},{fromColor:[105,48,13],toColor:[171,171,171]},{fromColor:[171,171,171],toColor:[255,252,255]}]},{id:"elevation2_predefined",type:"multipart",colorRamps:[{fromColor:[118,219,211],toColor:[255,255,199]},{fromColor:[255,255,199],toColor:[255,255,128]},{fromColor:[255,255,128],toColor:[217,194,121]},
{fromColor:[217,194,121],toColor:[135,96,38]},{fromColor:[135,96,38],toColor:[150,150,181]},{fromColor:[150,150,181],toColor:[181,150,181]},{fromColor:[181,150,181],toColor:[255,252,255]}]},{id:"errors_predefined",fromColor:[255,235,214],toColor:[196,10,10]},{id:"grayLightToDark_predefined",fromColor:[219,219,219],toColor:[69,69,69]},{id:"greenBright_predefined",fromColor:[204,255,204],toColor:[14,204,14]},{id:"greenLightToDark_predefined",fromColor:[220,245,233],toColor:[34,102,51]},{id:"greenToBlue_predefined",
type:"multipart",colorRamps:[{fromColor:[32,204,16],toColor:[0,242,242]},{fromColor:[0,242,242],toColor:[2,33,227]}]},{id:"orangeBright_predefined",fromColor:[255,235,204],toColor:[240,118,5]},{id:"orangeLightToDark_predefined",fromColor:[250,233,212],toColor:[171,65,36]},{id:"partialSpectrum_predefined",type:"multipart",colorRamps:[{fromColor:[242,241,162],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]},{fromColor:[252,3,69],toColor:[176,7,237]},{fromColor:[176,7,237],toColor:[2,29,
173]}]},{id:"partialSpectrum1Diverging_predefined",type:"multipart",colorRamps:[{fromColor:[135,38,38],toColor:[240,149,12]},{fromColor:[240,149,12],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[74,80,181]},{fromColor:[74,80,181],toColor:[39,32,122]}]},{id:"partialSpectrum2Diverging_predefined",type:"multipart",colorRamps:[{fromColor:[115,77,42],toColor:[201,137,52]},{fromColor:[201,137,52],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[91,63,176]},{fromColor:[91,63,176],toColor:[81,
13,97]}]},{id:"pinkToYellowGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[158,30,113],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[99,110,45]}]},{id:"pinkToYellowGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[97,47,73],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[22,59,15]}]},{id:"precipitation_predefined",type:"multipart",colorRamps:[{fromColor:[194,82,60],toColor:[237,161,19]},{fromColor:[237,161,19],toColor:[255,255,0]},
{fromColor:[255,255,0],toColor:[0,219,0]},{fromColor:[0,219,0],toColor:[32,153,143]},{fromColor:[32,153,143],toColor:[11,44,122]}]},{id:"prediction_predefined",type:"multipart",colorRamps:[{fromColor:[40,146,199],toColor:[250,250,100]},{fromColor:[250,250,100],toColor:[232,16,20]}]},{id:"purpleBright_predefined",fromColor:[255,204,255],toColor:[199,0,199]},{id:"purpleToGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[77,32,150],toColor:[255,255,191]},{fromColor:[255,255,191],
toColor:[20,122,11]}]},{id:"purpleToGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[67,14,89],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[24,79,15]}]},{id:"purpleBlueBright_predefined",fromColor:[223,184,230],toColor:[112,12,242]},{id:"purpleBlueLightToDark_predefined",fromColor:[229,213,242],toColor:[93,44,112]},{id:"purpleRedBright_predefined",fromColor:[255,204,225],toColor:[199,0,99]},{id:"purpleRedLightToDark_predefined",fromColor:[250,215,246],toColor:[143,
17,57]},{id:"redBright_predefined",fromColor:[255,204,204],toColor:[219,0,0]},{id:"redLightToDark_predefined",fromColor:[255,224,224],toColor:[143,10,10]},{id:"redToBlueDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[196,69,57],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[48,95,207]}]},{id:"redToBlueDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[107,13,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[13,53,97]}]},{id:"redToGreen_predefined",
type:"multipart",colorRamps:[{fromColor:[245,0,0],toColor:[245,245,0]},{fromColor:[245,245,0],toColor:[0,245,0]}]},{id:"redToGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[186,20,20],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[54,145,33]}]},{id:"redToGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[97,21,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[16,69,16]}]},{id:"slope_predefined",type:"multipart",colorRamps:[{fromColor:[56,
168,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]},{id:"spectrumFullBright_predefined",type:"multipart",colorRamps:[{fromColor:[255,0,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,0,255]}]},{id:"spectrumFullDark_predefined",type:"multipart",colorRamps:[{fromColor:[153,0,0],toColor:[153,153,0]},{fromColor:[153,153,0],toColor:[0,153,153]},{fromColor:[0,153,153],toColor:[0,0,153]}]},{id:"spectrumFullLight_predefined",type:"multipart",
colorRamps:[{fromColor:[255,153,153],toColor:[255,255,153]},{fromColor:[255,255,153],toColor:[153,255,255]},{fromColor:[153,255,255],toColor:[153,153,255]}]},{id:"surface_predefined",type:"multipart",colorRamps:[{fromColor:[112,153,89],toColor:[242,238,162]},{fromColor:[242,238,162],toColor:[242,206,133]},{fromColor:[242,206,133],toColor:[194,140,124]},{fromColor:[194,140,124],toColor:[255,242,255]}]},{id:"temperature_predefined",type:"multipart",colorRamps:[{fromColor:[255,252,255],toColor:[255,
0,255]},{fromColor:[255,0,255],toColor:[0,0,255]},{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,255,0]},{fromColor:[0,255,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,128,0]},{fromColor:[255,128,0],toColor:[128,0,0]}]},{id:"whiteToBlack_predefined",fromColor:[255,255,255],toColor:[0,0,0]},{id:"yellowToDarkRed_predefined",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[242,167,46]},{fromColor:[242,167,46],toColor:[107,0,0]}]},{id:"yellowToGreenToDarkBlue_predefined",
type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[56,224,9]},{fromColor:[56,224,9],toColor:[26,147,171]},{fromColor:[26,147,171],toColor:[12,16,120]}]},{id:"yellowToRed_predefined",fromColor:[245,245,0],toColor:[255,0,0]},{id:"yellowGreenBright_predefined",fromColor:[236,252,204],toColor:[157,204,16]},{id:"yellowGreenLightToDark_predefined",fromColor:[215,240,175],toColor:[96,107,45]}],c={aspect_predefined:"Aspect",blackToWhite_predefined:"Black to White",blueBright_predefined:"Blue Bright",
blueLightToDark_predefined:"Blue Light to Dark",blueGreenBright_predefined:"Blue-Green Bright",blueGreenLightToDark_predefined:"Blue-Green Light to Dark",brownLightToDark_predefined:"Brown Light to Dark",brownToBlueGreenDivergingBright_predefined:"Brown to Blue Green Diverging, Bright",brownToBlueGreenDivergingDark_predefined:"Brown to Blue Green Diverging, Dark",coefficientBias_predefined:"Coefficient Bias",coldToHotDiverging_predefined:"Cold to Hot Diverging",conditionNumber_predefined:"Condition Number",
cyanToPurple_predefined:"Cyan to Purple",cyanLightToBlueDark_predefined:"Cyan-Light to Blue-Dark",distance_predefined:"Distance",elevation1_predefined:"Elevation #1",elevation2_predefined:"Elevation #2",errors_predefined:"Errors",grayLightToDark_predefined:"Gray Light to Dark",greenBright_predefined:"Green Bright",greenLightToDark_predefined:"Green Light to Dark",greenToBlue_predefined:"Green to Blue",orangeBright_predefined:"Orange Bright",orangeLightToDark_predefined:"Orange Light to Dark",partialSpectrum_predefined:"Partial Spectrum",
partialSpectrum1Diverging_predefined:"Partial Spectrum 1 Diverging",partialSpectrum2Diverging_predefined:"Partial Spectrum 2 Diverging",pinkToYellowGreenDivergingBright_predefined:"Pink to YellowGreen Diverging, Bright",pinkToYellowGreenDivergingDark_predefined:"Pink to YellowGreen Diverging, Dark",precipitation_predefined:"Precipitation",prediction_predefined:"Prediction",purpleBright_predefined:"Purple Bright",purpleToGreenDivergingBright_predefined:"Purple to Green Diverging, Bright",purpleToGreenDivergingDark_predefined:"Purple to Green Diverging, Dark",
purpleBlueBright_predefined:"Purple-Blue Bright",purpleBlueLightToDark_predefined:"Purple-Blue Light to Dark",purpleRedBright_predefined:"Purple-Red Bright",purpleRedLightToDark_predefined:"Purple-Red Light to Dark",redBright_predefined:"Red Bright",redLightToDark_predefined:"Red Light to Dark",redToBlueDivergingBright_predefined:"Red to Blue Diverging, Bright",redToBlueDivergingDark_predefined:"Red to Blue Diverging, Dark",redToGreen_predefined:"Red to Green",redToGreenDivergingBright_predefined:"Red to Green Diverging, Bright",
redToGreenDivergingDark_predefined:"Red to Green Diverging, Dark",slope_predefined:"Slope",spectrumFullBright_predefined:"Spectrum-Full Bright",spectrumFullDark_predefined:"Spectrum-Full Dark",spectrumFullLight_predefined:"Spectrum-Full Light",surface_predefined:"Surface",temperature_predefined:"Temperature",whiteToBlack_predefined:"White to Black",yellowToDarkRed_predefined:"Yellow to Dark Red",yellowToGreenToDarkBlue_predefined:"Yellow to Green to Dark Blue",yellowToRed_predefined:"Yellow to Red",
yellowGreenBright_predefined:"Yellow-Green Bright",yellowGreenLightToDark_predefined:"Yellow-Green Light to Dark"},m=new I.JSONMap({Aspect:"aspect","Black to White":"black-to-white","Blue Bright":"blue-bright","Blue Light to Dark":"blue-light-to-dark","Blue-Green Bright":"blue-green-bright","Blue-Green Light to Dark":"blue-green-light-to-dark","Brown Light to Dark":"brown-light-to-dark","Brown to Blue Green Diverging, Bright":"brown-to-blue-green-diverging-right","Brown to Blue Green Diverging, Dark":"brown-to-blue-green-diverging-dark",
"Coefficient Bias":"coefficient-bias","Cold to Hot Diverging":"cold-to-hot-diverging","Condition Number":"condition-number","Cyan to Purple":"cyan-to-purple","Cyan-Light to Blue-Dark":"cyan-light-to-blue-dark",Distance:"distance","Elevation #1":"elevation1","Elevation #2":"elevation2",Errors:"errors","Gray Light to Dark":"gray-light-to-dark","Green Bright":"green-bright","Green Light to Dark":"green-light-to-dark","Green to Blue":"green-to-blue","Orange Bright":"orange-bright","Orange Light to Dark":"orange-light-to-dark",
"Partial Spectrum":"partial-spectrum","Partial Spectrum 1 Diverging":"partial-spectrum-1-diverging","Partial Spectrum 2 Diverging":"partial-spectrum-2-diverging","Pink to YellowGreen Diverging, Bright":"pink-to-yellow-green-diverging-bright","Pink to YellowGreen Diverging, Dark":"pink-to-yellow-green-diverging-dark",Precipitation:"precipitation",Prediction:"prediction","urple Bright":"purple-bright","Purple to Green Diverging, Bright":"purple-to-green-diverging-bright","Purple to Green Diverging, Dark":"purple-to-green-diverging-dark",
"Purple-Blue Bright":"purple-blue-bright","Purple-Blue Light to Dark":"purple-blue-light-to-dark","Purple-Red Bright":"purple-red-bright","Purple-Red Light to Dark":"purple-red-light-to-dark","Red Bright":"red-bright","Red Light to Dark":"red-light-to-dark","Red to Blue Diverging, Bright":"red-to-blue-diverging-bright","Red to Blue Diverging, Dark":"red-to-blue-diverging-dark","Red to Green":"red-to-green","Red to Green Diverging, Bright":"red-to-green-diverging-bright","Red to Green Diverging, Dark":"red-to-green-diverging-dark",
Slope:"slope","Spectrum-Full Bright":"spectrum-full-bright","Spectrum-Full Dark":"spectrum-full-dark","Spectrum-Full Light":"spectrum-full-light",Surface:"surface",Temperature:"temperature","White to Black":"white-to-black","Yellow to Dark Red":"yellow-to-dark-red","Yellow to Green to Dark Blue":"yellow-to-green-to-dark-blue","Yellow to Red":"yellow-to-red","Yellow-Green Bright":"yellow-green-bright","Yellow-Green Light to Dark":"yellow-green-light-to-dark"});P.PREDEFINED_COLOR_RAMP_NAME_MAP=c;P.PREDEFINED_JSON_COLOR_RAMPS=
f;P.colorRampDict=m;P.convertColorRampToColormap=function(h,r){h=l(h,r);const E=r?.interpolateAlpha;h.forEach((J,d)=>{J.unshift(d);E||J.pop()});return h};P.convertColorRampToColors=l;P.getColorRampId=R;P.getColorRampJSON=function(h){const r=m.toJSON(h),E=Object.entries(c).find(J=>J[1]===r)?.[0];return(h=f.find(J=>J.id===E))?h.colorRamps?{type:"multipart",colorRamps:h.colorRamps.map(J=>({type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:J.fromColor,toColor:J.toColor}))}:{type:"algorithmic",
algorithm:"esriCIELabAlgorithm",fromColor:h.fromColor,toColor:h.toColor}:null};P.getColorRampName=U;P.getRFxArgColorRampValue=function(h){const r=U(h);if(h){if("algorithmic"===h.type)return{...b(h),Name:r};if(h.colorRamps)return h=h.colorRamps.map(b),{type:"MultiPartColorRamp",NumColorRamps:h.length,ArrayOfColorRamp:h,Name:r}}};P.rasterColormapNames="random ndvi ndvi2 ndvi3 elevation gray hillshade".split(" ");P.rgbaConvertTo32Bit=function(h){h=h.reverse().map(r=>{r=r.toString(16);return 2>r.length?
"0"+r:r});return 4294967295&Number.parseInt(h.join(""),16)};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/core/colorUtils":function(){define(["exports"],function(P){function D(B,l){const b=[];let k,f;if(B[0].length!==l.length)throw Error("dimensions do not match");const c=B.length,m=B[0].length;let h=0;for(k=0;k<c;k++){for(f=h=0;f<m;f++)h+=B[k][f]*l[f];b.push(h)}return b}function F(B){B=[B.r/255,B.g/255,B.b/255].map(l=>.04045>=l?l/12.92:((l+.055)/1.055)**2.4);B=D(H,B);return{x:100*
B[0],y:100*B[1],z:100*B[2]}}function I(B){B=D(N,[B.x/100,B.y/100,B.z/100]).map(l=>Math.min(1,Math.max(.0031308>=l?12.92*l:1.055*l**(1/2.4)-.055,0)));return{r:Math.round(255*B[0]),g:Math.round(255*B[1]),b:Math.round(255*B[2])}}function p(B){B=[B.x/95.047,B.y/100,B.z/108.883].map(l=>l>(6/29)**3?l**(1/3):1/3*(29/6)**2*l+4/29);return{l:116*B[1]-16,a:500*(B[0]-B[1]),b:200*(B[1]-B[2])}}function R(B){const l=B.l;B=[(l+16)/116+B.a/500,(l+16)/116,(l+16)/116-B.b/200].map(b=>b>6/29?b**3:3*(6/29)**2*(b-4/29));
return{x:95.047*B[0],y:100*B[1],z:108.883*B[2]}}function U(B){if("r"in B&&"g"in B&&"b"in B)return B;if("l"in B&&"c"in B&&"h"in B){var l=B.c,b=B.h;return I(R({l:B.l,a:l*Math.cos(b),b:l*Math.sin(b)}))}if("l"in B&&"a"in B&&"b"in B)return I(R(B));if("x"in B&&"y"in B&&"z"in B)return I(B);if("h"in B&&"s"in B&&"v"in B){b=(B.h+360)%360/60;l=B.v/100*255;B=B.s/100*l;const k=B*(1-Math.abs(b%2-1));switch(Math.floor(b)){case 0:b={r:B,g:k,b:0};break;case 1:b={r:k,g:B,b:0};break;case 2:b={r:0,g:B,b:k};break;case 3:b=
{r:0,g:k,b:B};break;case 4:b={r:k,g:0,b:B};break;case 5:case 6:b={r:B,g:0,b:k};break;default:b={r:0,g:0,b:0}}b.r=Math.round(b.r+l-B);b.g=Math.round(b.g+l-B);b.b=Math.round(b.b+l-B);return b}return B}const H=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],N=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];P.darken=function(B,l){B=p(F(B));B.l*=1-l;return I(R(B))};P.toHSV=function(B){if("h"in B&&"s"in B&&"v"in B)return B;var l=U(B);B=l.r;const b=l.g,k=l.b;l=Math.max(B,
b,k);const f=l-Math.min(B,b,k);B=0===f?0:l===B?(b-k)/f%6:l===b?(k-B)/f+2:(B-b)/f+4;0>B&&(B+=6);return{h:60*B,s:100*(0===f?0:f/l),v:100/255*l}};P.toLAB=function(B){return"l"in B&&"a"in B&&"b"in B?B:p(F(U(B)))};P.toLCH=function(B){if(!("l"in B&&"c"in B&&"h"in B)){var l=p(F(U(B)));B=l.l;var b=l.a;const k=l.b;l=Math.sqrt(b*b+k*k);b=Math.atan2(k,b);b=0<b?b:b+2*Math.PI;B={l:B,c:l,h:b}}return B};P.toRGB=U;P.toXYZ=function(B){return"x"in B&&"y"in B&&"z"in B?B:F(U(B))};Object.defineProperty(P,Symbol.toStringTag,
{value:"Module"})})},"esri/renderers/RasterShadedReliefRenderer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../rest/support/colorRamps".split(" "),function(P,D,F,I,p,R,U,H,N,B){var l;F=l=function(b){function k(c){c=b.call(this,
c)||this;c.altitude=45;c.azimuth=315;c.colorRamp=null;c.hillshadeType="traditional";c.pixelSizePower=.664;c.pixelSizeFactor=.024;c.scalingType="none";c.type="raster-shaded-relief";c.zFactor=1;return c}P._inheritsLoose(k,b);var f=k.prototype;f.readColorRamp=function(c){return B.fromJSON(c)};f.clone=function(){return new l({hillshadeType:this.hillshadeType,altitude:this.altitude,azimuth:this.azimuth,zFactor:this.zFactor,scalingType:this.scalingType,pixelSizeFactor:this.pixelSizeFactor,pixelSizePower:this.pixelSizePower,
colorRamp:I.clone(this.colorRamp)})};return k}(F.JSONSupport);D.__decorate([p.property({type:Number,json:{write:!0}})],F.prototype,"altitude",void 0);D.__decorate([p.property({type:Number,json:{write:!0}})],F.prototype,"azimuth",void 0);D.__decorate([p.property({types:B.types,json:{write:!0}})],F.prototype,"colorRamp",void 0);D.__decorate([H.reader("colorRamp")],F.prototype,"readColorRamp",null);D.__decorate([p.property({type:["traditional","multi-directional"],json:{write:!0}})],F.prototype,"hillshadeType",
void 0);D.__decorate([p.property({type:Number,json:{write:!0}})],F.prototype,"pixelSizePower",void 0);D.__decorate([p.property({type:Number,json:{write:!0}})],F.prototype,"pixelSizeFactor",void 0);D.__decorate([p.property({type:["none","adjusted"],json:{write:!0}})],F.prototype,"scalingType",void 0);D.__decorate([U.enumeration({rasterShadedRelief:"raster-shaded-relief"})],F.prototype,"type",void 0);D.__decorate([p.property({type:Number,json:{write:!0}})],F.prototype,"zFactor",void 0);return F=l=D.__decorate([N.subclass("esri.renderers.RasterShadedReliefRenderer")],
F)})},"esri/renderers/RasterStretchRenderer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../core/accessorSupport/decorators/writer ./support/stretchRendererUtils ../rest/support/colorRamps".split(" "),function(P,D,F,I,p,R,U,H,
N,B,l,b){var k;F=k=function(f){function c(h){h=f.call(this,h)||this;h.colorRamp=null;h.computeGamma=!1;h.dynamicRangeAdjustment=!1;h.gamma=[];h.maxPercent=null;h.minPercent=null;h.numberOfStandardDeviations=null;h.outputMax=null;h.outputMin=null;h.sigmoidStrengthLevel=null;h.statistics=[];h.histograms=null;h.useGamma=!1;h.stretchType="none";h.type="raster-stretch";return h}P._inheritsLoose(c,f);var m=c.prototype;m.readColorRamp=function(h){if(h)return b.fromJSON(h)};m.writeStatistics=function(h,r,
E){h?.length&&(Array.isArray(h[0])||(h=h.map(J=>[J.min,J.max,J.avg,J.stddev])),r[E]=h)};m.readStretchType=function(h,r){h=r.stretchType;"number"===typeof h&&(h=l.stretchTypeFunctionEnum[h]);return l.stretchTypeJSONDict.read(h)};m.clone=function(){return new k({stretchType:this.stretchType,outputMin:this.outputMin,outputMax:this.outputMax,useGamma:this.useGamma,computeGamma:this.computeGamma,statistics:I.clone(this.statistics),gamma:I.clone(this.gamma),sigmoidStrengthLevel:this.sigmoidStrengthLevel,
numberOfStandardDeviations:this.numberOfStandardDeviations,minPercent:this.minPercent,maxPercent:this.maxPercent,colorRamp:I.clone(this.colorRamp),histograms:I.clone(this.histograms),dynamicRangeAdjustment:this.dynamicRangeAdjustment})};return c}(F.JSONSupport);D.__decorate([p.property({types:b.types,json:{write:!0}})],F.prototype,"colorRamp",void 0);D.__decorate([H.reader("colorRamp")],F.prototype,"readColorRamp",null);D.__decorate([p.property({type:Boolean,json:{write:!0}})],F.prototype,"computeGamma",
void 0);D.__decorate([p.property({type:Boolean,json:{write:{target:"dra"},read:{source:"dra"}}})],F.prototype,"dynamicRangeAdjustment",void 0);D.__decorate([p.property({type:[Number],json:{write:!0}})],F.prototype,"gamma",void 0);D.__decorate([p.property({type:Number,json:{write:!0}})],F.prototype,"maxPercent",void 0);D.__decorate([p.property({type:Number,json:{write:!0}})],F.prototype,"minPercent",void 0);D.__decorate([p.property({type:Number,json:{write:!0}})],F.prototype,"numberOfStandardDeviations",
void 0);D.__decorate([p.property({type:Number,json:{read:{source:"max"},write:{target:"max"}}})],F.prototype,"outputMax",void 0);D.__decorate([p.property({type:Number,json:{read:{source:"min"},write:{target:"min"}}})],F.prototype,"outputMin",void 0);D.__decorate([p.property({type:Number,json:{write:!0}})],F.prototype,"sigmoidStrengthLevel",void 0);D.__decorate([p.property({json:{type:[[Number]],write:!0}})],F.prototype,"statistics",void 0);D.__decorate([p.property()],F.prototype,"histograms",void 0);
D.__decorate([B.writer("statistics")],F.prototype,"writeStatistics",null);D.__decorate([p.property({type:Boolean,json:{write:!0}})],F.prototype,"useGamma",void 0);D.__decorate([p.property({type:l.stretchTypeJSONDict.apiValues,json:{type:l.stretchTypeJSONDict.jsonValues,write:l.stretchTypeJSONDict.write}})],F.prototype,"stretchType",void 0);D.__decorate([H.reader("stretchType",["stretchType"])],F.prototype,"readStretchType",null);D.__decorate([U.enumeration({rasterStretch:"raster-stretch"})],F.prototype,
"type",void 0);return F=k=D.__decorate([N.subclass("esri.renderers.RasterStretchRenderer")],F)})},"esri/renderers/support/stretchRendererUtils":function(){define(["exports","../../core/jsonMap"],function(P,D){D=new D.JSONMap({none:"none",standardDeviation:"standard-deviation",histogramEqualization:"histogram-equalization",minMax:"min-max",percentClip:"percent-clip",sigmoid:"sigmoid"});P.stretchTypeFunctionEnum={0:"none",3:"standardDeviation",4:"histogramEqualization",5:"minMax",6:"percentClip",9:"sigmoid"};
P.stretchTypeJSONDict=D;Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/VectorFieldRenderer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../Color ../geometry ../Graphic ../symbols ../core/jsonMap ../core/JSONSupport ../core/lang ../core/maybe ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../geometry/support/normalizeUtils ../layers/support/rasterFunctions/vectorFieldUtils ./ClassBreaksRenderer ./mixins/VisualVariablesMixin ./support/ClassBreakInfo ./visualVariables/RotationVariable ./visualVariables/SizeVariable ./visualVariables/support/visualVariableUtils ../symbols/SimpleLineSymbol ../symbols/SimpleMarkerSymbol ../symbols/support/utils ../symbols/PictureMarkerSymbol ../geometry/Point".split(" "),
function(P,D,F,I,p,R,U,H,N,B,l,b,k,f,c,m,h,r,E,J,d,n,x,q,g,a,e,t){var v;const w=new Set(["esriMetersPerSecond","esriKilometersPerHour","esriKnots","esriFeetPerSecond","esriMilesPerHour"]);I=new U.JSONMap({beaufort_ft:"beaufort-ft",beaufort_km:"beaufort-km",beaufort_kn:"beaufort-kn",beaufort_m:"beaufort-m",beaufort_mi:"beaufort-mi",classified_arrow:"classified-arrow",ocean_current_kn:"ocean-current-kn",ocean_current_m:"ocean-current-m",simple_scalar:"simple-scalar",single_arrow:"single-arrow",wind_speed:"wind-barb"});
U=new U.JSONMap({flow_from:"flow-from",flow_to:"flow-to"});H=v=function(y){function G(u){u=y.call(this,u)||this;u.attributeField="Magnitude";u.flowRepresentation="flow-from";u.rotationType="arithmetic";u.style="single-arrow";u.symbolTileSize=50;u.type="vector-field";return u}P._inheritsLoose(G,y);var C=G.prototype;C.readInputUnit=function(u,z){return w.has(u)?h.unitKebabDict.fromJSON(u):null};C.readOutputUnit=function(u,z){return w.has(u)?h.unitKebabDict.fromJSON(u):null};C.clone=function(){return new v({attributeField:this.attributeField,
flowRepresentation:this.flowRepresentation,rotationType:this.rotationType,symbolTileSize:this.symbolTileSize,style:this.style,visualVariables:N.clone(this.visualVariables),inputUnit:this.inputUnit,outputUnit:this.outputUnit})};C.getGraphicsFromPixelData=function(){var u=P._asyncToGenerator(function*(z,L=!1,S=[]){const Z=[];var X=h.getUnitConversionFactor(this.inputUnit,this.outputUnit),M=this.rotationVariables[0]?.rotationType||this.rotationType;L=L?h.convertVectorFieldData(z.pixelBlock,"vector-uv",
M,X):h.convertVectorFieldUnit(z.pixelBlock,"vector-magdir",X);if(B.isNone(L))return Z;z=z.extent;X=B.isSome(L.mask)&&0<L.mask.length;M=0;const O=(z.xmax-z.xmin)/L.width,A=(z.ymax-z.ymin)/L.height;for(let Y=0;Y<L.height;Y++)for(let W=0;W<L.width;W++,M++){let T=new t({x:z.xmin+W*O+O/2,y:z.ymax-Y*A-A/2,spatialReference:z.spatialReference});T=(yield m.normalizeCentralMeridian(T))[0];var Q=S.some(K=>K.intersects(T));X&&!L.mask[M]||Q||(Q=new p({geometry:{type:"point",x:T.x,y:T.y,spatialReference:z.spatialReference},
attributes:{Magnitude:L.pixels[0][M],Direction:L.pixels[1][M]}}),Q.symbol=this._getVisualVariablesAppliedSymbol(Q),Z.push(Q))}return Z});return function(z){return u.apply(this,arguments)}}();C.getSymbol=function(u,z){};C.getSymbolAsync=function(){var u=P._asyncToGenerator(function*(z,L){});return function(z,L){return u.apply(this,arguments)}}();C.getSymbols=function(){return[]};C.getClassBreakInfos=function(){return this.styleRenderer?.classBreakInfos};C.getDefaultSymbol=function(){return this.styleRenderer?.defaultSymbol};
C._getDefaultSymbol=function(u){return new g({path:"M14,32 14,18 9,23 16,3 22,23 17,18 17,32 z",outline:new q({width:0}),size:20,color:u||new F([0,92,230])})};C._getVisualVariablesAppliedSymbol=function(u){if(u){var z=this.styleRenderer?.getSymbol(u)?.clone(),L=this.sizeVariables,S=this.rotationVariables;L&&L.length&&this.sizeVariables.forEach(Z=>a.applySizesToSymbol(z,x.getAllSizes([Z],u)));S&&S.length&&(u.attributes.Direction+="flow-to"===this.flowRepresentation===("ocean-current-kn"===this.style||
"ocean-current-m"===this.style)?0:180,this.rotationVariables.forEach(Z=>a.applyRotationToSymbol(z,x.getRotationAngle(Z,u),Z.axis)));return z}};C._createStyleRenderer=function(u){let z={defaultSymbol:this._getDefaultSymbol(),classBreakInfos:[]};switch(u){case "single-arrow":z=this._createSingleArrowRenderer();break;case "beaufort-kn":z=this._createBeaufortKnotsRenderer();break;case "beaufort-m":z=this._createBeaufortMeterRenderer();break;case "beaufort-ft":z=this._createBeaufortFeetRenderer();break;
case "beaufort-mi":z=this._createBeaufortMilesRenderer();break;case "beaufort-km":z=this._createBeaufortKilometersRenderer();break;case "ocean-current-m":z=this._createCurrentMeterRenderer();break;case "ocean-current-kn":z=this._createCurrentKnotsRenderer();break;case "simple-scalar":z=this._createSimpleScalarRenderer();break;case "wind-barb":z=this._createWindBarbsRenderer();break;case "classified-arrow":z=this._createClassifiedArrowRenderer()}return new r(z)};C._createSingleArrowRenderer=function(){return{defaultSymbol:this._getDefaultSymbol()}};
C._createBeaufortKnotsRenderer=function(){const u=this._getDefaultSymbol(new F([214,47,39])),z=this._getClassBreaks([0,1,3,6,10,16,21,27,33,40,47,55,63],[[40,146,199],[89,162,186],[129,179,171],[160,194,155],[191,212,138],[218,230,119],[250,250,100],[252,213,83],[252,179,102],[250,141,52],[247,110,42],[240,71,29]]);return{defaultSymbol:u,classBreakInfos:z}};C._createBeaufortMeterRenderer=function(){const u=this._getDefaultSymbol(new F([214,47,39])),z=this._getClassBreaks([0,.2,1.8,3.3,5.4,8.5,11,
14.1,17.2,20.8,24.4,28.6,32.7],[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]]);return{defaultSymbol:u,classBreakInfos:z}};C._createBeaufortFeetRenderer=function(){const u=this._getDefaultSymbol(new F([214,47,39]));var z=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];z=z.map(L=>3.28084*L);z=this._getClassBreaks(z,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,
204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]]);return{defaultSymbol:u,classBreakInfos:z}};C._createBeaufortMilesRenderer=function(){const u=this._getDefaultSymbol(new F([214,47,39]));var z=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];z=z.map(L=>2.23694*L);z=this._getClassBreaks(z,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],
[232,21,21]]);return{defaultSymbol:u,classBreakInfos:z}};C._createBeaufortKilometersRenderer=function(){const u=this._getDefaultSymbol(new F([214,47,39]));var z=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];z=z.map(L=>3.6*L);z=this._getClassBreaks(z,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]]);return{defaultSymbol:u,classBreakInfos:z}};C._createCurrentMeterRenderer=function(){const u=
this._getDefaultSymbol(new F([177,177,177])),z=this._getClassBreaks([0,.5,1,1.5,2],[[78,26,153],[179,27,26],[202,128,26],[177,177,177]]);return{defaultSymbol:u,classBreakInfos:z}};C._createCurrentKnotsRenderer=function(){const u=this._getDefaultSymbol(new F([177,177,177])),z=this._getClassBreaks([0,.25,.5,1,1.5,2,2.5,3,3.5,4],[[0,0,0],[0,37,100],[78,26,153],[151,0,100],[179,27,26],[177,78,26],[202,128,26],[177,179,52],[177,177,177]]);return{defaultSymbol:u,classBreakInfos:z}};C._createClassifiedArrowRenderer=
function(){const u=this._getDefaultSymbol(new F([56,168,0]));var z=[0,1E-6,3.5,7,10.5,14];if(this.sizeVariables?.length){const L=this.sizeVariables[0].minDataValue,S=this.sizeVariables[0].maxDataValue;if(L&&S){const Z=(S-L)/5;z=Array.from(Array(6).keys()).map(X=>L+Z*X)}}z=this._getClassBreaks(z,[[56,168,0],[139,309,0],[255,255,0],[255,128,0],[255,0,0]]);return{defaultSymbol:u,classBreakInfos:z}};C._createSimpleScalarRenderer=function(){return{defaultSymbol:e.fromJSON({imageData:"iVBORw0KGgoAAAANSUhEUgAAACsAAAArCAQAAABLVLlLAAAABGdBTUEAAYagMeiWXwAAAAJiS0dEAACqjSMyAAAACXBIWXMAAABIAAAASABGyWs+AAAC3ElEQVRIx9XXvW4cVRQH8N982btpsIREJECyiCXsxX4DKh6AliqGKCBBE2SlwlHgAbBD/AKmyEYUeQ1KahPZSZQvBCkQLTHZ7KGY8Xodz4w3a1NwbzVzz/znfJ//zbStVC5q3icKak9GAs2QIdDx3PtW/S011NW3p+M5Eomh11ipTIKe6+4LQzHaQ+G+63pIZNJJQXMpljwTwj1brpgx5w1zZlyx5Z4QnllEIm2xeeSUHBf0hV0bejo1Uh09G3aFvgXk7cCJFBc9EdaRVuHJJaOdKyTV2TVhYLMduNR0Q9gxL5GaaTDw8GzejrDRBpxWoGsySRW0dttKuattwNkIlFw2YXgzOdYq4Ox49PlM+JrKd5OusjTWhBuVxUfMX/KXXZ3WEmkuqa67wspR4BTbwtKr/5u4fFgStse/T7EifFPnnYl9zPq4vmUOPrRndgoHjDti1gOPqlyXoifcRNGQzUd31lDyfHmob1Gp35vSr+P6vilcQ5Egtyd8YF/ySg9NhPM+9M/IOaHwp5+PSZayXTvCogEUwlatC3J8LLwYtcWB8EuDXQVuCkV5/B4eNHb7wGBs87LBDS+xjdVSn09wq1G8dFM+9tSUhIGneLvUdniKxKpTYljCpu3j7rVWlHj/P23v4NPGUEyeCQnexe9lJjzEQqMjJs+EzNAX6B98dBZVRmroJx95x/A/6gln18EyfCUsl+qdXb/tjvfbw+mwforpUOBz4XLVoBwAn3aWnfeH246NyBXhrq7TTN5lNSP9RkU+puUJm3W2Tsdq0nZWM07srk7MwQrZSRysjjGWBLRJNsNbfj2JMR4AbxpU1XLAb9Mxfpsq5EjMuuiR8L0JiHOOBX3hiUvOmavN0nMueSzcceFk0BK4pMqLo7vDD1Z0qrtDx7Itt4Xwm9UqbMmk8S0Dtuzb2pvOU99Z1nLTOfleNmvfZfP2pYZmPfajwosKdDBNpacNpVGGsWX9CyDI8Xq/Sj6QAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE0LTExLTEwVDAzOjE3OjU4LTA1OjAwF+tHyQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMFQwMzoxNzo1OC0wNTowMGa2/3UAAAAASUVORK5CYII\x3d",
height:20,width:20,type:"esriPMS",angle:0})}};C._createWindBarbsRenderer=function(){const u=Array.from(Array(31).keys()).map(Z=>5*Z),z=[{range:"0-5",path:"M20 20 M5 20 A15 15 0 1 0 35 20 A15 15 0 1 0 5 20 M20 20 M10 20 A10 10 0 1 0 30 20 A10 10 0 1 0 10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTIwIDIwIE01IDIwIEExNSAxNSAwIDEgMCAzNSAyMCBBMTUgMTUgMCAxIDAgNSAyMCBNMjAgMjAgTTEwIDIwIEExMCAxMCAwIDEgMCAzMCAyMCBBMTAgMTAgMCAxIDAgMTAgMjAiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},
{range:"5-10",path:"M25 0 L25 40 M25 35 L17.5 37.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNyA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTTI1IDM1IEwxNy41IDM3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"10-15",path:"M25 0 L25 40 L10 45 L25 40",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNyA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"15-20",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L17.5 37.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjEyIDAgMTUgNDUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxNy41IDM3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"20-25",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNiA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCBNMjUgMzUgTDEwIDQwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},
{range:"25-30",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L17.5 32.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNiA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCBNMjUgMzUgTDEwIDQwIEwyNSAzNSBNMjUgMzAgTDE3LjUgMzIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"30-35",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"35-40",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxNy41IDI3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"40-45",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"45-50",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxNy41IDIyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},
{range:"50-55",path:"M25 0 L25 40 L10 40 L25 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"55-60",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L17.5 32.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxNy41IDMyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},
{range:"60-65",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"65-70",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxNy41IDI3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},
{range:"70-75",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"75-80",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxNy41IDIyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"80-85",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"85-90",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L17.5 17.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxNy41IDE3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"90-95",
path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxMCAyMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"95-100",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20 L25 15 M25 10 L17.5 12.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxMCAyMCBMMjUgMTUgTTI1IDEwIEwxNy41IDEyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"100-105",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"105-110",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDE3LjUgMjcuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"110-115",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},
{range:"115-120",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L17.5 22.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDE3LjUgMjIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"120-125",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"125-130",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L17.5 17.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDE3LjUgMTcuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"130-135",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"135-140",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDE3LjUgMTIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"140-145",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDEwIDE1IiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"145-150",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDEwIDE1IE0yNSAxMCBNMjUgNSBMMTcuNSA3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"}],L=e.fromJSON({imageData:"iVBORw0KGgoAAAANSUhEUgAAACgAAAApCAQAAADtq6NDAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJiS0dEAP+Hj8y/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEY0lEQVRIx5XXWWxWRRQH8N+d+31tUdGAVjGglYJABFEBY91jfDAg7piYaFTccA++uMQEFRcSXlATtxiXqMQt4G4iisYl0ai4sIQYtVFZ1KIFKdTS0l4f7vRCS5fPebozc+bM/2z/Mzcx0AgSiUxXnKfIdMn875FIhX53U2n/B/s+kKM4UINTjTBZImixxnrv+9a2iL6zEoUBXcoudrWj/OtHm3wt02lfU9Qao9OnHvIhgmww84MEl1qnxfNmGrqHxAizLdPpC6chGcAxKGGcL+30gOERf1BSpUqVslQSV8d5ReZFe8VQ9avufJn31cWwlJV7iafKStGOE/1qvfH9qUxxu8ydUdmuSKbGO8YUdT2inKLG69pM70tliktl5qIkCAJGmusDG7Vqsc0WjZa4UBlBiA5YZIcjYzB7qDtH5kaUJFLs7RGZTZ42W4PRRmtwvbdt1+wGiaS4drEtDttdZYIDNVuAclR3vA3+dI3qHqmVSy7U6Tv1MScCPvPR7nIpFlsdCy3FdTLPGhK92e2CUITjMJ9ocwKxnsZqc3O3JwMma3d6UVLnyVxB4aXemZqvPqLdpJhW3KVVbY4yYImPo6M5Urv50fj+0z/FG9YaEiENs8UtMfXUaTeTePNHlhXfA1UU+2lyD1Il3Gtt9+adfpNG7dNlpg2U/T3KYLZ2dUWFdTgp3/rQ4sK973qnInV5TIf40x3dhvrJPBiqyWUo4wAtLqhQYS71qK+QKOFRywmGK/kpikzV6WMKhh58vGWs4TIJNjiEYLIuP8Tt4/zmLyqk+AyrJSbF+Qq1DgqRUPMxyl+9q3IQhX/rMCJ6tEunriDs1oSyQZKlr9AkhT2ZIARbJfaJS1vtVbHB+Rgi0RK/y1q1BWsEEyLoz40xtGKcARPVWB1BTPO7f4LNtpkUl1aoMbViLyZo0GRjPD3BxnxjqXeLYlvhqYrzMMG3HoyJXa3JjfnGlbYYFlP7Jh3qKsKY4hQ7TY0nG+xwRL61n63mxHtqNHosigyMLmClNwvuecFnOZB88nNBDzNkzhxEZaKMBVoKapggMzvHHXBEpNSSFAvtcFRsVn0bW8LlMmcXs+c0Kne3gRR32+zg4uXwjC6zit6Wt4a8LXVfcp/MtQXHn2ynGbuCmb8GvvFeJLEE82ReU9/n6+dkq2x3buG9Wn94smcgAw631RPR7BTH+kbmHReZoEpOdEe7zWqZl40s0JWs9Hmv7hjBHqPDwsjGKVJnWWqjbdZp1KhJi0aPmxYZsIRhlttgeF+Jlke41QcOQKoqilSb6HJzSvNG3G/UoWnxwsmt+sVaYwd63dRbqdnMyCPVeyRPvpYgdavM22oGKoMUVRbJfOWMwidJ8Zzb1UvmWK/VVUXzHaTjjrVYh1897HT7xxYEVUaa5SWb/WO+YUWa9SrwvigzM8YlzlYv2GSdVCYxxlBtVnnFq5olwp5/BEk/OLsf5LUmG2+inRJdVvjZ97ZH9/zP34ug1O91pf4p+D+JYBpvrKxfbwAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNC0xMS0xMFQwMzoxMjowOS0wNTowMB9ViV0AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTBUMDM6MTI6MDktMDU6MDBuCDHhAAAAAElFTkSuQmCC",
height:20,width:20,type:"esriPMS",angle:0}),S=u.map((Z,X)=>{if(X!==u.length-1)if(0===X)var M={minValue:Z,maxValue:u[X+1],symbol:L};else M=e.fromJSON({type:"esriPMS",imageData:z[X].imageData,contentType:"image/svg+xml",height:32,width:32,angle:0}),M={minValue:Z,maxValue:u[X+1],symbol:M};return new J(M)});return{defaultSymbol:L,classBreakInfos:S}};C._getClassBreaks=function(u,z){return z.map((L,S)=>new J({minValue:u[S],maxValue:u[S+1],symbol:this._getDefaultSymbol(new F(L))}))};P._createClass(G,[{key:"styleRenderer",
get:function(){const u=this.attributeField,z=this._createStyleRenderer(this.style);z.field=u;return z}},{key:"sizeVariables",get:function(){const u=[];if(this.visualVariables)for(var z of this.visualVariables)"size"===z.type&&u.push(z);0===u.length&&(z=new n({field:"Magnitude",minSize:.2*this.symbolTileSize,maxSize:.8*this.symbolTileSize}),this.visualVariables?this.visualVariables.push(z):this._set("visualVariables",[z]),u.push(z));return u}},{key:"rotationVariables",get:function(){const u=[];if(this.visualVariables)for(var z of this.visualVariables)"rotation"===
z.type&&u.push(z);0===u.length&&(z=new d({field:"Direction",rotationType:this.rotationType}),this.visualVariables?this.visualVariables.push(z):this._set("visualVariables",[z]),u.push(z));return u}}]);return G}(E.VisualVariablesMixin(H.JSONSupport));D.__decorate([l.property({type:String,json:{write:!0}})],H.prototype,"attributeField",void 0);D.__decorate([l.property({type:U.apiValues,json:{type:U.jsonValues,read:{reader:U.read},write:{writer:U.write}}})],H.prototype,"flowRepresentation",void 0);D.__decorate([l.property({type:["geographic",
"arithmetic"],json:{write:!0}})],H.prototype,"rotationType",void 0);D.__decorate([l.property({type:I.apiValues,json:{type:I.jsonValues,read:{reader:I.read},write:{writer:I.write}}})],H.prototype,"style",void 0);D.__decorate([l.property({json:{write:!0}})],H.prototype,"symbolTileSize",void 0);D.__decorate([l.property({type:h.unitKebabDict.apiValues,json:{type:h.unitKebabDict.jsonValues,write:{writer:h.unitKebabDict.write}}})],H.prototype,"inputUnit",void 0);D.__decorate([f.reader("inputUnit")],H.prototype,
"readInputUnit",null);D.__decorate([l.property({type:h.unitKebabDict.apiValues,json:{type:h.unitKebabDict.jsonValues,read:{reader:h.unitKebabDict.read},write:{writer:h.unitKebabDict.write}}})],H.prototype,"outputUnit",void 0);D.__decorate([f.reader("outputUnit")],H.prototype,"readOutputUnit",null);D.__decorate([k.enumeration({vectorField:"vector-field"})],H.prototype,"type",void 0);D.__decorate([l.property({type:r})],H.prototype,"styleRenderer",null);D.__decorate([l.property({type:n})],H.prototype,
"sizeVariables",null);D.__decorate([l.property({type:d})],H.prototype,"rotationVariables",null);return H=v=D.__decorate([c.subclass("esri.renderers.VectorFieldRenderer")],H)})},"esri/layers/support/rasterFunctions/vectorFieldUtils":function(){define(["exports","../../../core/jsonMap","../../../core/maybe","../PixelBlock","./pixelUtils"],function(P,D,F,I,p){function R(g,a){return h.get(g)/h.get(a)||1}function U(g,a="geographic"){const [e,t]=g;g=Math.sqrt(e*e+t*t);let v=Math.atan2(t,e)*r;v=(360+v)%
360;"geographic"===a&&(v=(450-v)%360);return[g,v]}function H(g,a="geographic"){let e=g[1];"geographic"===a&&(e=(450-e)%360);e%=360;g=g[0];return[g*Math.cos(e/r),g*Math.sin(e/r)]}function N(g,a,e="geographic",t=1){if(!p.isValidPixelBlock(g))return g;const {pixels:v,width:w,height:y}=g;var G=w*y;const C=v[0],u=v[1],z=g.pixelType.startsWith("f")?g.pixelType:"f32",L=I.createEmptyBand(z,G);G=I.createEmptyBand(z,G);let S=0;for(let Z=0;Z<y;Z++)for(let X=0;X<w;X++)"vector-uv"===a?([L[S],G[S]]=U([C[S],u[S]],
e),L[S]*=t):([L[S],G[S]]=H([C[S],u[S]],e),L[S]*=t,G[S]*=t),S++;g=new I({pixelType:z,width:g.width,height:g.height,mask:g.mask,validPixelCount:g.validPixelCount,maskIsAlpha:g.maskIsAlpha,pixels:[L,G]});g.updateStatistics();return g}function B(g=0,a=0,e=Math.PI,t=!0){t&&(e=(2*Math.PI-e)%(2*Math.PI));t=t?-1:1;const v=-7*t,w=-2*t,y=-16*t,[G,C]=b(0,a+13*t,e,21.75),[u,z]=b(g-5.5,a+v,e,21.75),[L,S]=b(g+5.5,a+v,e,21.75),[Z,X]=b(g-1.5,a+w,e,21.75),[M,O]=b(g+1.5,a+w,e,21.75),[A,Q]=b(g-1.5,a+y,e,21.75),[Y,W]=
b(g+1.5,a+y,e,21.75);return[G,C,u,z,Z,X,M,O,L,S,A,Q,Y,W]}function l(g=0,a=Math.PI,e=!0){e&&(a=(2*Math.PI-a)%(2*Math.PI));var t=e?-1:1,v=5*t;const w=20*t,y=25*t;t*=2;const G=e?1:-1;e=5*G;let [C,u]=[0+e,0-w],[z,L]=[C+2*G,u],[S,Z]=[z-0*G,L+t],[X,M]=[0-e,0-y],[O,A]=[X+0*G,M-t],Q=Math.ceil(g/5),Y=Math.floor(Q/10);Q-=8*Y;g=[];const W=[];for(let ma=0;ma<Q/2;ma++,Y--){0>=Y&&1===Q%2&&ma===(Q-1)/2&&(X=0,O=X+0*G,M=(M+u)/2,A=M-t);const [na,qa]=b(X,M,a,45);if(0<Y){const [ra,pa]=b(z,M,a,45),[oa,sa]=b(C,u,a,45);
g.push(ra);g.push(pa);g.push(na);g.push(qa);g.push(oa);g.push(sa)}else{const [ra,pa]=b(z,L,a,45),[oa,sa]=b(S,Z,a,45),[va,ta]=b(O,A,a,45);W.push(na);W.push(qa);W.push(va);W.push(ta);W.push(oa);W.push(sa);W.push(ra);W.push(pa)}M+=v;u+=v;L+=v;Z+=v;A+=v}const [T,K]=b(0+e,0+w,a,45);v=7*G;const [V,ba]=b(0+v,0+w,a,45),[aa,ea]=b(0+e,0-y,a,45),[ja,ha]=b(0+v,0-y,a,45);return{pennants:g,barbs:W,shaft:[T,K,V,ba,aa,ea,ja,ha]}}function b(g,a,e,t=1){return[Math.sqrt(g*g+a*a)/t,(2*Math.PI+(2*Math.PI+Math.atan2(a,
g))%(2*Math.PI)-e)%(2*Math.PI)]}function k(g,a,e,t){e=R(t||"knots",e);for(t=1;t<a.length;t++)if(t===a.length-1){if(g<a[t]*e)break}else if(g<=a[t]*e)break;return Math.min(t-1,a.length-2)}function f(g,a,e,t,v){let w=0;switch(a){case "beaufort_kn":w=k(g,d,"knots",e);break;case "beaufort_km":w=k(g,d,"kilometer-per-hour",e);break;case "beaufort_ft":w=k(g,d,"feet-per-second",e);break;case "beaufort_m":w=k(g,d,"meter-per-second",e);break;case "classified_arrow":w=k(g,v??[],t,e);break;case "ocean_current_m":w=
k(g,n,"meter-per-second",e);break;case "ocean_current_kn":w=k(g,x,"knots",e)}return w}function c(g,a){const {style:e,inputUnit:t,outputUnit:v,breakValues:w}=a,y=E.fromJSON(t),G=E.fromJSON(v);let C=0,u=0;const {width:z,height:L,mask:S}=g,Z=g.pixels[0];g=g.pixels[1];var X=F.isSome(S)?S.filter(A=>0<A).length:z*L;const M=new Float32Array(42*X);X=new Uint32Array(15*X);a=a.invertDirection?B(0,0,0,!1):J;for(let A=0;A<L;A++)for(let Q=0;Q<z;Q++){var O=A*z+Q;if(!S||S[A*z+Q]){const Y=(g[O]+360)%360/180*Math.PI,
W=f(Z[O],e,y,G,w);for(let T=0;T<a.length;T+=2)M[C++]=(Q+.5)/z,M[C++]=(A+.5)/L,M[C++]=a[T],M[C++]=a[T+1]+Y,M[C++]=W,M[C++]=Z[O];O=7*(C/42-1);X[u++]=O;X[u++]=O+1;X[u++]=O+2;X[u++]=O+0;X[u++]=O+4;X[u++]=O+3;X[u++]=O+0;X[u++]=O+2;X[u++]=O+3;X[u++]=O+2;X[u++]=O+5;X[u++]=O+3;X[u++]=O+5;X[u++]=O+6;X[u++]=O+3}}return{vertexData:M,indexData:X}}function m(g,a){let e=0,t=0;const {width:v,height:w,mask:y}=g;g=g.pixels[0];const G=[],C=[];var u=E.fromJSON(a.inputUnit);u=R(u,"knots");a="wind_speed"===a.style?5:
Number.MAX_VALUE;for(let L=0;L<w;L++)for(let S=0;S<v;S++){var z=g[L*v+S]*u;if((!y||y[L*v+S])&&z<a){for(let Z=0;4>Z;Z++)G[e++]=(S+.5)/v,G[e++]=(L+.5)/w,G[e++]=2>Z?-.5:.5,G[e++]=0===Z%2?-.5:.5,G[e++]=0,G[e++]=z;z=4*(e/24-1);C[t++]=z;C[t++]=z+1;C[t++]=z+2;C[t++]=z+1;C[t++]=z+2;C[t++]=z+3}}return{vertexData:new Float32Array(G),indexData:new Uint32Array(C)}}const h=new Map;h.set("meter-per-second",1);h.set("kilometer-per-hour",.277778);h.set("knots",.514444);h.set("feet-per-second",.3048);h.set("mile-per-hour",
.44704);const r=180/Math.PI,E=new D.JSONMap({esriMetersPerSecond:"meter-per-second",esriKilometersPerHour:"kilometer-per-hour",esriKnots:"knots",esriFeetPerSecond:"feet-per-second",esriMilesPerHour:"mile-per-hour"}),J=B(0,0,0),d=[0,1,3,6,10,16,21,27,33,40,47,55,63],n=[0,.5,1,1.5,2],x=[0,.25,.5,1,1.5,2,2.5,3,3.5,4],q=[];P.convertToLocalDirections=function(g,a,e,t="geographic"){if(!p.isValidPixelBlock(g)||F.isNone(e))return g;g="vector-magdir"===a?g.clone():F.unwrap(N(g,a));const v=g.pixels[1];for(let w=
0;w<v.length;w++)v[w]="geographic"===t?(v[w]+e[w]+270)%360:(v[w]+360-e[w])%360;return"vector-magdir"===a?g:N(g,"vector-magdir")};P.convertVectorFieldData=N;P.convertVectorFieldUnit=function(g,a,e=1){if(1===e||!p.isValidPixelBlock(g))return g;g=g.clone();const {pixels:t,width:v,height:w}=g,y=t[0],G=t[1];let C=0;for(let u=0;u<w;u++)for(let z=0;z<v;z++)"vector-uv"===a?(y[C]*=e,G[C]*=e):y[C]*=e,C++;g.updateStatistics();return g};P.createVFMesh=function(g,a){if("simple_scalar"===a.style)a=m(g,a);else if("wind_speed"===
a.style){if(0===q.length)for(var e=0;30>e;e++)q.push(l(5*e,0,!a.invertDirection));a=E.fromJSON(a.inputUnit);a=R(a,"knots");const {width:y,height:G,mask:C}=g;e=g.pixels[0];g=g.pixels[1];const u=[],z=[];let L=0,S=0;for(let Z=0;Z<G;Z++)for(let X=0;X<y;X++){var t=Z*y+X,v=e[t]*a;if((!C||C[Z*y+X])&&5<=v){const M=(g[t]+360)%360/180*Math.PI,{pennants:O,barbs:A,shaft:Q}=q[Math.min(Math.floor(v/5),29)];if(0===O.length+A.length)continue;t=u.length/6;const Y=(X+.5)/y,W=(Z+.5)/G;for(var w=0;w<O.length;w+=2)u[L++]=
Y,u[L++]=W,u[L++]=O[w],u[L++]=O[w+1]+M,u[L++]=0,u[L++]=v;for(w=0;w<A.length;w+=2)u[L++]=Y,u[L++]=W,u[L++]=A[w],u[L++]=A[w+1]+M,u[L++]=0,u[L++]=v;for(w=0;w<Q.length;w+=2)u[L++]=Y,u[L++]=W,u[L++]=Q[w],u[L++]=Q[w+1]+M,u[L++]=0,u[L++]=v;for(v=0;v<O.length/6;v++)z[S++]=t,z[S++]=t+1,z[S++]=t+2,t+=3;for(v=0;v<A.length/8;v++)z[S++]=t,z[S++]=t+1,z[S++]=t+2,z[S++]=t+1,z[S++]=t+2,z[S++]=t+3,t+=4;z[S++]=t+0;z[S++]=t+1;z[S++]=t+2;z[S++]=t+1;z[S++]=t+3;z[S++]=t+2;t+=4}}a={vertexData:new Float32Array(u),indexData:new Uint32Array(z)}}else a=
c(g,a);return a};P.createVFMeshScalar=m;P.getUnitConversionFactor=R;P.sampleVectorField=function(g,a,e,t=[0,0],v=.5){const {width:w,height:y,mask:G}=g,[C,u]=g.pixels,[z,L]=t;g=Math.round((w-z)/e);t=Math.round((y-L)/e);var S=g*t;const Z=new Float32Array(S),X=new Float32Array(S);S=new Uint8Array(S);a="vector-uv"===a;for(let O=0;O<t;O++)for(let A=0;A<g;A++){let Q=0;const Y=O*g+A,W=Math.max(0,O*e+L),T=Math.max(0,A*e+z),K=Math.min(y,W+e),V=Math.min(w,T+e);for(let ba=W;ba<K;ba++)for(let aa=T;aa<V;aa++){var M=
ba*w+aa;if(!G||G[M]){Q++;M=a?[C[M],u[M]]:[C[M],(360+u[M])%360];const [ea,ja]=a?M:H(M);Z[Y]+=ea;X[Y]+=ja}}if(Q>=(K-W)*(V-T)*(1-v)){S[Y]=1;const [ba,aa]=U([Z[Y]/Q,X[Y]/Q]);Z[Y]=ba;X[Y]=aa}else S[Y]=0,Z[Y]=0,X[Y]=0}e=new I({width:g,height:t,pixels:[Z,X],mask:S});e.updateStatistics();return e};P.snapImageToSymbolTile=function(g,a,e,t,v){if(F.isNone(v)||!v.spatialReference.equals(g.spatialReference))return{extent:g,width:Math.round(a/t),height:Math.round(e/t),resolution:g.width/a};const w=v.xmin;v=v.ymax;
a=(g.xmax-g.xmin)/a*t;e=(g.ymax-g.ymin)/e*t;g.xmin=w+Math.floor((g.xmin-w)/a)*a;g.xmax=w+Math.ceil((g.xmax-w)/a)*a;g.ymin=v+Math.floor((g.ymin-v)/e)*e;g.ymax=v+Math.ceil((g.ymax-v)/e)*e;return{extent:g,width:Math.round(g.width/a),height:Math.round(g.height/e),resolution:(a+e)/2}};P.unitKebabDict=E;P.uvComponentToVector=U;Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/PixelBlock":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Error ../../core/JSONSupport ../../core/lang ../../core/Logger ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/subclass ./SimpleBandStatistics ./rasterFormats/pixelRangeUtils".split(" "),
function(P,D,F,I,p,R,U,H,N,B,l,b){var k;I=k=function(f){function c(h){h=f.call(this,h)||this;h.width=null;h.height=null;h.pixelType="f32";h.validPixelCount=null;h.mask=null;h.maskIsAlpha=!1;h.premultiplyAlpha=!1;h.statistics=null;h.depthCount=1;return h}P._inheritsLoose(c,f);c.createEmptyBand=function(h,r){return new (k.getPixelArrayConstructor(h))(r)};c.getPixelArrayConstructor=function(h){let r;switch(h){case "u1":case "u2":case "u4":case "u8":r=Uint8Array;break;case "u16":r=Uint16Array;break;case "u32":r=
Uint32Array;break;case "s8":r=Int8Array;break;case "s16":r=Int16Array;break;case "s32":r=Int32Array;break;case "f32":r=Float32Array;break;case "f64":r=Float64Array;break;case "c64":case "c128":case "unknown":r=Float32Array}return r};var m=c.prototype;m.castPixelType=function(h){if(!h)return"f32";h=h.toLowerCase();["u1","u2","u4"].includes(h)?h="u8":"unknown u8 s8 u16 s16 u32 s32 f32 f64".split(" ").includes(h)||(h="f32");return h};m.getPlaneCount=function(){return this.pixels?.length};m.addData=function(h){if(!h.pixels||
h.pixels.length!==this.width*this.height)throw new F("pixelblock:invalid-or-missing-pixels","add data requires valid pixels array that has same length defined by pixel block width * height");this.pixels||(this.pixels=[]);this.statistics||(this.statistics=[]);this.pixels.push(h.pixels);this.statistics.push(h.statistics??new l.SimpleBandStatistics)};m.getAsRGBA=function(){const h=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case "s8":case "s16":case "u16":case "s32":case "u32":case "f32":case "f64":this._fillFromNon8Bit(h);
break;default:this._fillFrom8Bit(h)}return new Uint8ClampedArray(h)};m.getAsRGBAFloat=function(){const h=new Float32Array(this.width*this.height*4);this._fillFrom32Bit(h);return h};m.updateStatistics=function(){if(this.pixels){this.statistics=this.pixels.map(E=>this._calculateBandStatistics(E,this.mask));var h=this.mask,r=0;if(U.isSome(h))for(let E=0;E<h.length;E++)h[E]&&r++;else r=this.width*this.height;this.validPixelCount=r}};m.clamp=function(h){if(h&&"f64"!==h&&"f32"!==h&&this.pixels){var [r,
E]=b.getPixelValueRange(h),J=this.pixels,d=this.width*this.height,n=J.length,x=[];for(let e=0;e<n;e++){var q=k.createEmptyBand(h,d);var g=J[e];for(let t=0;t<d;t++){var a=g[t];q[t]=a>E?E:a<r?r:a}x.push(q)}this.pixels=x;this.pixelType=h}};m.extractBands=function(h){const {pixels:r,statistics:E}=this;if(U.isNone(h)||0===h.length||!r||0===r.length)return this;var J=r.length;const d=h.some(n=>n>=r.length);J=J===h.length&&!h.some((n,x)=>n!==x);return d||J?this:new k({pixelType:this.pixelType,width:this.width,
height:this.height,mask:this.mask,validPixelCount:this.validPixelCount,maskIsAlpha:this.maskIsAlpha,pixels:h.map(n=>r[n]),statistics:E&&h.map(n=>E[n])})};m.clone=function(){const h=new k({width:this.width,height:this.height,pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount});U.isSome(this.mask)&&(h.mask=this.mask instanceof Uint8Array?new Uint8Array(this.mask):this.mask.slice(0));let r;const E=k.getPixelArrayConstructor(this.pixelType);if(this.pixels&&0<this.pixels.length){h.pixels=
[];const J=!!this.pixels[0].slice;for(r=0;r<this.pixels.length;r++)h.pixels[r]=J?this.pixels[r].slice(0,this.pixels[r].length):new E(this.pixels[r])}if(this.statistics)for(h.statistics=[],r=0;r<this.statistics.length;r++)h.statistics[r]=p.clone(this.statistics[r]);h.premultiplyAlpha=this.premultiplyAlpha;return h};m._fillFrom8Bit=function(h){const {mask:r,maskIsAlpha:E,premultiplyAlpha:J,pixels:d}=this;if(h&&d&&d.length){var n,x;var q=n=x=d[0];3<=d.length?(n=d[1],x=d[2]):2===d.length&&(n=d[1]);var g=
new Uint32Array(h),a=this.width*this.height;if(q.length!==a)R.getLogger(this.declaredClass).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");else if(U.isSome(r)&&r.length===a)if(E)for(h=0;h<a;h++){const e=r[h];if(e){const t=e/255;g[h]=J?e<<24|x[h]*t<<16|n[h]*t<<8|q[h]*t:e<<24|x[h]<<16|n[h]<<8|q[h]}}else for(h=0;h<a;h++)r[h]&&(g[h]=-16777216|x[h]<<16|n[h]<<8|q[h]);else for(h=0;h<a;h++)g[h]=-16777216|x[h]<<16|n[h]<<8|q[h]}else R.getLogger(this.declaredClass).error("getAsRGBA()",
"Unable to convert to RGBA. The input pixel block is empty.")};m._fillFromNon8Bit=function(h){const {pixels:r,mask:E,statistics:J}=this;if(h&&r&&r.length){var d=this.pixelType,n=1,x=0;n=1;if(J&&0<J.length){for(var q of J)null!=q.minValue&&(x=Math.min(x,q.minValue)),null!=q.maxValue&&null!=q.minValue&&(n=Math.max(n,q.maxValue-q.minValue));n=255/n}else n=255,"s8"===d?(x=-128,n=127):"u16"===d?n=65535:"s16"===d?(x=-32768,n=32767):"u32"===d?n=4294967295:"s32"===d?(x=-2147483648,n=2147483647):"f32"===d?
(x=-3.4*1E39,n=3.4*1E39):"f64"===d&&(x=-Number.MAX_VALUE,n=Number.MAX_VALUE),n=255/(n-x);h=new Uint32Array(h);d=this.width*this.height;var g,a,e;q=g=a=r[0];if(q.length!==d)return R.getLogger(this.declaredClass).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(2<=r.length)if(g=r[1],3<=r.length&&(a=r[2]),U.isSome(E)&&E.length===d)for(e=0;e<d;e++)E[e]&&(h[e]=-16777216|(a[e]-x)*n<<16|(g[e]-x)*n<<8|(q[e]-x)*n);else for(e=0;e<d;e++)h[e]=-16777216|(a[e]-x)*n<<16|(g[e]-x)*n<<
8|(q[e]-x)*n;else if(U.isSome(E)&&E.length===d)for(e=0;e<d;e++)g=(q[e]-x)*n,E[e]&&(h[e]=-16777216|g<<16|g<<8|g);else for(e=0;e<d;e++)g=(q[e]-x)*n,h[e]=-16777216|g<<16|g<<8|g}else R.getLogger(this.declaredClass).error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")};m._fillFrom32Bit=function(h){const {pixels:r,mask:E}=this;if(!h||!r||!r.length)return R.getLogger(this.declaredClass).error("getAsRGBAFloat()","Unable to convert to RGBA. The input pixel block is empty.");let J,
d,n,x;J=d=n=r[0];3<=r.length?(d=r[1],n=r[2]):2===r.length&&(d=r[1]);const q=this.width*this.height;if(J.length!==q)return R.getLogger(this.declaredClass).error("getAsRGBAFloat()","Unable to convert to RGBA. The pixelblock is invalid.");let g=0;if(U.isSome(E)&&E.length===q)for(x=0;x<q;x++)h[g++]=J[x],h[g++]=d[x],h[g++]=n[x],h[g++]=E[x]&1;else for(x=0;x<q;x++)h[g++]=J[x],h[g++]=d[x],h[g++]=n[x],h[g++]=1};m._calculateBandStatistics=function(h,r){let E=Infinity,J=-Infinity;const d=h.length;let n,x=0;
if(U.isSome(r))for(n=0;n<d;n++)r[n]&&(x=h[n],E=x<E?x:E,J=x>J?x:J);else for(n=0;n<d;n++)x=h[n],E=x<E?x:E,J=x>J?x:J;return new l.SimpleBandStatistics(E,J)};return c}(I.JSONSupport);D.__decorate([H.property({json:{write:!0}})],I.prototype,"width",void 0);D.__decorate([H.property({json:{write:!0}})],I.prototype,"height",void 0);D.__decorate([H.property({json:{write:!0}})],I.prototype,"pixelType",void 0);D.__decorate([N.cast("pixelType")],I.prototype,"castPixelType",null);D.__decorate([H.property({json:{write:!0}})],
I.prototype,"validPixelCount",void 0);D.__decorate([H.property({json:{write:!0}})],I.prototype,"mask",void 0);D.__decorate([H.property({json:{write:!0}})],I.prototype,"maskIsAlpha",void 0);D.__decorate([H.property({json:{write:!0}})],I.prototype,"pixels",void 0);D.__decorate([H.property()],I.prototype,"premultiplyAlpha",void 0);D.__decorate([H.property({json:{write:!0}})],I.prototype,"statistics",void 0);D.__decorate([H.property({json:{write:!0}})],I.prototype,"depthCount",void 0);D.__decorate([H.property({json:{write:!0}})],
I.prototype,"noDataValues",void 0);D.__decorate([H.property({json:{write:!0}})],I.prototype,"bandMasks",void 0);return I=k=D.__decorate([B.subclass("esri.layers.support.PixelBlock")],I)})},"esri/layers/support/SimpleBandStatistics":function(){define(["exports"],function(P){P.SimpleBandStatistics=function(D=null,F=null,I=null){this.minValue=D;this.maxValue=F;this.noDataValue=I};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/pixelRangeUtils":function(){define(["exports"],
function(P){function D(I){return F[I]??[-3.4028234663852886E38,3.4028234663852886E38]}const F={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-3.4028234663852886E38,3.4028234663852886E38],f64:[-Number.MAX_VALUE,Number.MAX_VALUE]};P.convertNoDataToMask=function(I,p,R){if(!(I.depthCount&&1<I.depthCount)){var {pixels:U,statistics:H,pixelType:N}=I,B=U[0].length,l=I.bandMasks??[],b=I.mask??(new Uint8Array(B)).fill(255),
k="f32"===N||"f64"===N,f=D(N),c=!1;for(let r=0;r<U.length;r++){const E="number"===typeof p?p:p[r];if(null==E)continue;var m=H?.[r].maxValue??f[1];if((H?.[r].minValue??f[0])>E+Number.EPSILON||m<E-Number.EPSILON)continue;m=l[r]||(new Uint8Array(B)).fill(255);const J=U[r];var h=R?.customFloatTolerance;if(k&&0!==h){h||(h=9.999999E37<=Math.abs(E)?2E-7*Math.abs(E):"f32"===N?2**-23:Number.EPSILON);for(let d=0;d<J.length;d++)m[d]&&Math.abs(J[d]-E)<h&&(J[d]=0,m[d]=0,b[d]=0,c=!0)}else for(h=0;h<J.length;h++)m[h]&&
J[h]===E&&(J[h]=0,m[h]=0,b[h]=0,c=!0);l[r]=m}c&&(I.bandMasks=l,I.mask=b);c&&"updateStatistics"in I&&I.updateStatistics()}};P.getPixelValueRange=D;Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/pixelUtils":function(){define(["exports","../../../core/maybe","../PixelBlock","../rasterFormats/pixelRangeUtils"],function(P,D,F,I){function p(d){return D.isSome(d)&&"esri.layers.support.PixelBlock"===d.declaredClass&&d.pixels&&0<d.pixels.length}function R(d,
n,x,q,g){const a=d.length;g=F.createEmptyBand(g,a);if(n)for(let e=0;e<a;e++)n[e]&&(g[e]=x[d[e]-q]);else for(n=0;n<a;n++)g[n]=x[d[n]-q];return g}function U(d,n,x,q){const g=null!=x&&2<=x.length?new Set(x):null;x=1===x?.length?x[0]:null;const a=!!n?.length;for(let e=0;e<d.length;e++)if(q[e]){const t=d[e];if(a){let v=!1;for(let w=0;w<n.length;w+=2)if(t>=n[w]&&t<=n[w+1]){v=!0;break}v||(q[e]=0)}q[e]&&(t===x||g?.has(t))&&(q[e]=0)}}function H(d,n){const x=d[0].length;for(let q=0;q<x;q++)if(n[q]){let g=!1;
for(let a=0;a<d.length;a++)if(d[a][q]){g=!0;break}g||(n[q]=0)}}function N(d,n){const x=d[0].length;for(let q=0;q<x;q++)if(n[q]){let g=!1;for(let a=0;a<d.length;a++)if(0===d[a][q]){g=!0;break}g&&(n[q]=0)}}function B(d,n,x,q,g,a,e,t){return{xmin:g<=x*d?0:g<x*d+d?g-x*d:d,ymin:a<=q*n?0:a<q*n+n?a-q*n:n,xmax:g+e<=x*d?0:g+e<x*d+d?g+e-x*d:d,ymax:a+t<=q*n?0:a+t<q*n+n?a+t-q*n:n}}function l(d,n,x,q,g,a){const {width:e,height:t}=x.block,{x:v,y:w}=x.offset,{width:y,height:G}=x.mosaic;x=B(e,t,q,g,v,w,y,G);let C=
0;var u=0;if(a){var z=a.hasGCSSShiftTransform?360:a.halfWorldWidth??0,L=e*a.resolutionX;const S=a.startX+q*L;S<z&&S+L>z?u=a.rightPadding:S>=z&&(C=a.leftMargin-a.rightPadding,u=0)}x.xmax-=u;if("number"===typeof n)for(a=x.ymin;a<x.ymax;a++)for(u=(g*t+a-w)*y+(q*e-v)+C,z=x.xmin;z<x.xmax;z++)d[u+z]=n;else for(a=x.ymin;a<x.ymax;a++)for(u=(g*t+a-w)*y+(q*e-v)+C,z=a*e,L=x.xmin;L<x.xmax;L++)d[u+L]=n[z+L]}function b(d,n,x={}){const {clipOffset:q,clipSize:g,alignmentInfo:a,blockWidths:e}=x;if(e)return k(d,n,
{blockWidths:e});var t=d.find(X=>p(X));if(D.isNone(t))return null;x=g?g.width:n.width;const v=g?g.height:n.height;var w=t.width,y=t.height;const G=n.width/w,C=n.height/y;n={offset:q||{x:0,y:0},mosaic:g||n,block:{width:w,height:y}};w=t.pixelType;y=F.getPixelArrayConstructor(w);var u=t.pixels.length;t=[];for(var z=0;z<u;z++){var L=new y(x*v);for(let X=0;X<C;X++)for(let M=0;M<G;M++){var S=d[X*G+M];p(S)&&(S=S.pixels[z],l(L,S,n,M,X,a))}t.push(L)}let Z;if(d.some(X=>D.isNone(X)||D.isSome(X.mask)&&0<X.mask.length))for(Z=
new Uint8Array(x*v),y=0;y<C;y++)for(u=0;u<G;u++)L=d[y*G+u],z=D.isSome(L)?L.mask:null,D.isSome(z)?l(Z,z,n,u,y,a):L?l(Z,1,n,u,y,a):l(Z,0,n,u,y,a);d=new F({width:x,height:v,pixels:t,pixelType:w,mask:Z});d.updateStatistics();return d}function k(d,n,x){const q=d.find(u=>D.isSome(u));if(D.isNone(q))return null;var g=d.some(u=>D.isSome(u)?!!u.mask:!0);const {width:a,height:e}=n;n=g?new Uint8Array(a*e):null;({blockWidths:x}=x);const t=[],v=q.getPlaneCount(),w=F.getPixelArrayConstructor(q.pixelType);if(g)for(let u=
0,z=0;u<d.length;z+=x[u],u++)if(g=d[u],p(g)){var y=D.unwrap(g.mask);for(var G=0;G<e;G++)for(var C=0;C<x[u];C++)n[G*a+C+z]=null==y?255:y[G*g.width+C]}for(g=0;g<v;g++){y=new w(a*e);for(let u=0,z=0;u<d.length;z+=x[u],u++)if(G=d[u],p(G)&&(C=G.pixels[g],null!=C))for(let L=0;L<e;L++)for(let S=0;S<x[u];S++)y[L*a+S+z]=C[L*G.width+S];t.push(y)}d=new F({width:a,height:e,mask:n,pixels:t,pixelType:q.pixelType});d.updateStatistics();return d}function f(d){if(!p(d))return null;const n=d.clone(),{width:x,height:q,
pixels:g}=d;var a=g[0];const e=n.pixels[0];d=D.unwrap(d.mask);for(let w=2;w<q-1;w++){const y=new Map;for(var t=w-2;t<w+2;t++)for(var v=0;4>v;v++){const G=t*x+v;h(y,a[G],d?d[G]:1)}e[w*x]=c(y);e[w*x+1]=e[w*x+2]=e[w*x];for(t=3;t<x-1;t++)v=(w-2)*x+t+1,h(y,a[v],d?d[v]:1),v=(w-1)*x+t+1,h(y,a[v],d?d[v]:1),v=w*x+t+1,h(y,a[v],d?d[v]:1),v=(w+1)*x+t+1,h(y,a[v],d?d[v]:1),v=(w-2)*x+t-3,m(y,a[v],d?d[v]:1),v=(w-1)*x+t-3,m(y,a[v],d?d[v]:1),v=w*x+t-3,m(y,a[v],d?d[v]:1),v=(w+1)*x+t-3,m(y,a[v],d?d[v]:1),e[w*x+t]=c(y);
e[w*x+t+1]=e[w*x+t]}for(a=0;a<x;a++)e[a]=e[x+a]=e[2*x+a],e[(q-1)*x+a]=e[(q-2)*x+a];n.updateStatistics();return n}function c(d){if(0===d.size)return 0;let n=0,x=-1,q=0;const g=d.keys();let a=g.next();for(;!a.done;)q=d.get(a.value),q>n&&(x=a.value,n=q),a=g.next();return x}function m(d,n,x){0!==x&&(x=d.get(n),1===x?d.delete(n):d.set(n,x-1))}function h(d,n,x){0!==x&&d.set(n,d.has(n)?d.get(n)+1:1)}function r(d,n,x){let {x:q,y:g}=n;const {width:a,height:e}=x;if(0===q&&0===g&&e===d.height&&a===d.width)return d;
const {width:t,height:v}=d;n=Math.max(0,g);const w=Math.max(0,q),y=Math.min(q+a,t),G=Math.min(g+e,v);if(0>y||0>G||!p(d))return null;q=Math.max(0,-q);g=Math.max(0,-g);var {pixels:C}=d,u=a*e,z=C.length;const L=[];for(var S=0;S<z;S++){var Z=C[S],X=F.createEmptyBand(d.pixelType,u);for(let M=n;M<G;M++){const O=M*t;let A=(M+g-n)*a+q;for(let Q=w;Q<y;Q++)X[A++]=Z[O+Q]}L.push(X)}C=new Uint8Array(u);u=D.unwrap(d.mask);for(z=n;z<G;z++)for(S=z*t,Z=(z+g-n)*a+q,X=w;X<y;X++)C[Z++]=u?u[S+X]:1;d=new F({width:x.width,
height:x.height,pixelType:d.pixelType,pixels:L,mask:C});d.updateStatistics();return d}function E(d,n=!0){if(!p(d))return null;const {pixels:x,width:q,height:g,mask:a,pixelType:e}=d;d=[];const t=Math.round(q/2),v=Math.round(g/2),w=g-1,y=q-1;for(var G=0;G<x.length;G++){var C=x[G],u=F.createEmptyBand(e,t*v),z=0;for(var L=0;L<g;L+=2)for(var S=0;S<q;S+=2){var Z=C[L*q+S];if(n){var X=S===y?Z:C[L*q+S+1];const M=L===w?Z:C[L*q+S+q],O=S===y?M:L===w?X:C[L*q+S+q+1];u[z++]=(Z+X+M+O)/4}else u[z++]=Z}d.push(u)}G=
null;if(D.isSome(a))for(G=new Uint8Array(t*v),C=0,u=0;u<g;u+=2)for(z=0;z<q;z+=2)L=a[u*q+z],n?(S=z===y?L:a[u*q+z+1],Z=u===w?L:a[u*q+z+q],X=z===y?Z:u===w?S:a[u*q+z+q+1],G[C++]=L*S*Z*X?1:0):G[C++]=L;return new F({width:t,height:v,pixelType:e,pixels:d,mask:G})}function J(d,n,x,q,g=0){const {width:a,height:e}=d,{width:t,height:v}=n;d=q.cols;q=q.rows;n=Math.ceil(t/d-.1/d);const w=Math.ceil(v/q-.1/q);let y,G,C,u,z;const L=n*d;var S=L*w*q;const Z=new Float32Array(S),X=new Float32Array(S),M=new Uint32Array(S),
O=new Uint32Array(S);let A=0,Q,Y;for(let K=0;K<w;K++)for(let V=0;V<n;V++){var W=12*(K*n+V);S=x[W];y=x[W+1];G=x[W+2];C=x[W+3];u=x[W+4];z=x[W+5];for(var T=0;T<q;T++){A=(K*q+T)*L+V*d;Y=(T+.5)/q;for(let ba=0;ba<T;ba++)Q=(ba+.5)/d,Z[A+ba]=(S*Q+y*Y+G)*a+g,X[A+ba]=(C*Q+u*Y+z)*e+g,M[A+ba]=Math.floor(Z[A+ba]),O[A+ba]=Math.floor(X[A+ba])}W+=6;S=x[W];y=x[W+1];G=x[W+2];C=x[W+3];u=x[W+4];z=x[W+5];for(W=0;W<q;W++)for(A=(K*q+W)*L+V*d,Y=(W+.5)/q,T=W;T<d;T++)Q=(T+.5)/d,Z[A+T]=(S*Q+y*Y+G)*a+g,X[A+T]=(C*Q+u*Y+z)*e+
g,M[A+T]=Math.floor(Z[A+T]),O[A+T]=Math.floor(X[A+T])}return{offsets_x:Z,offsets_y:X,offsets_xi:M,offsets_yi:O,gridWidth:L}}P.NoDataInterpretation=void 0;(function(d){d[d.matchAny=0]="matchAny";d[d.matchAll=1]="matchAll"})(P.NoDataInterpretation||(P.NoDataInterpretation={}));P.MissingBandAction=void 0;(function(d){d[d.bestMatch=0]="bestMatch";d[d.fail=1]="fail"})(P.MissingBandAction||(P.MissingBandAction={}));P.MAX_MAP_SIZE_GPU=6;P.approximateTransform=function(d,n,x,q,g="nearest"){if(!p(d))return null;
"majority"===g&&(d=f(d));const {pixels:a,mask:e,pixelType:t}=d,v=d.width;var w=d.height;const y=F.getPixelArrayConstructor(t),G=a.length,{width:C,height:u}=n;d=!1;for(let O=0;O<x.length;O+=3)-1===x[O]&&-1===x[O+1]&&-1===x[O+2]&&(d=!0);const {offsets_x:z,offsets_y:L,offsets_xi:S,offsets_yi:Z,gridWidth:X}=J({width:v,height:w},n,x,q,"majority"===g?.5:0);let M;n=(O,A,Q)=>{const Y=O instanceof Float32Array||O instanceof Float64Array?0:.5;for(let W=0;W<u;W++){M=W*X;for(let T=0;T<C;T++){if(0>z[M]||0>L[M])O[W*
C+T]=0;else if(Q)O[W*C+T]=A[S[M]+Z[M]*v];else{const K=Math.floor(z[M]),V=Math.floor(L[M]),ba=Math.ceil(z[M]),aa=Math.ceil(L[M]),ea=z[M]-K,ja=L[M]-V;O[W*C+T]=!e||e[K+V*v]&&e[K+V*v]&&e[K+aa*v]&&e[ba+aa*v]?(1-ja)*((1-ea)*A[K+V*v]+ea*A[ba+V*v])+ja*((1-ea)*A[K+aa*v]+ea*A[ba+aa*v])+Y:A[S[M]+Z[M]*v]}M++}}};x=[];for(w=0;w<G;w++)q=new y(C*u),n(q,a[w],"nearest"===g||"majority"===g),x.push(q);g=new F({width:C,height:u,pixelType:t,pixels:x});if(D.isSome(e))g.mask=new Uint8Array(C*u),n(g.mask,e,!0);else if(d)for(g.mask=
new Uint8Array(C*u),d=0;d<C*u;d++)g.mask[d]=0>z[d]||0>L[d]?0:1;g.updateStatistics();return g};P.clip=r;P.colorize=function(d,n){if(!p(d)||!n||!n.indexedColormap&&!n.indexed2DColormap)return d;const x=d.clone();var q=x.pixels;let g=x.mask;const a=x.width*x.height;if(1!==q.length)return d;const {indexedColormap:e,indexed2DColormap:t,offset:v,alphaSpecified:w}=n;d=0;q=q[0];n=new Uint8Array(q.length);const y=new Uint8Array(q.length),G=new Uint8Array(q.length);var C=0;if(e){const u=e.length-1;if(D.isSome(g))for(d=
0;d<a;d++)g[d]&&(C=4*(q[d]-v),C<v||C>u?g[d]=0:(n[d]=e[C],y[d]=e[C+1],G[d]=e[C+2],g[d]=e[C+3]));else{g=new Uint8Array(a);for(d=0;d<a;d++)C=4*(q[d]-v),C<v||C>u?g[d]=0:(n[d]=e[C],y[d]=e[C+1],G[d]=e[C+2],g[d]=e[C+3]);x.mask=g}}else if(t)if(D.isSome(g))for(d=0;d<a;d++)g[d]&&(C=t[q[d]],n[d]=C[0],y[d]=C[1],G[d]=C[2],g[d]=C[3]);else{g=new Uint8Array(a);for(d=0;d<a;d++)C=t[q[d]],n[d]=C[0],y[d]=C[1],G[d]=C[2],g[d]=C[3];x.mask=g}x.pixels=[n,y,G];x.statistics=null;x.pixelType="u8";x.maskIsAlpha=w;return x};P.compositeBands=
function(d){if(!d?.length||d.some(v=>!p(v)))return null;if(1===d.length)return D.isSome(d[0])?d[0].clone():null;const {width:n,height:x,pixelType:q}=d[0];if(d.some(v=>v.width!==n||v.height!==x))return null;const g=d.map(({mask:v})=>v).filter(v=>null!=v);let a=null;g.length&&(a=new Uint8Array(n*x),a.set(g[0]),1<g.length&&N(g.slice(1),a));const e=[];d.forEach(({pixels:v})=>e.push(...v));const t=[];d.map(({statistics:v})=>v).filter(v=>v?.length).forEach(v=>t.push(...v));return new F({pixelType:q,width:n,
height:x,mask:a,pixels:e,statistics:t.length?t:null})};P.createColormapLUT=function(d){if(d){var n=d.colormap;if(n&&0!==n.length){n=n.sort((w,y)=>w[0]-y[0]);var x=0;0>n[0][0]&&(x=n[0][0]);var q=Math.max(256,n[n.length-1][0]-x+1),g=new Uint8Array(4*q),a=[],e=0,t=0,v=5===n[0].length;if(65536<q)return n.forEach(w=>{a[w[0]-x]=v?w.slice(1):w.slice(1).concat([255])}),{indexed2DColormap:a,offset:x,alphaSpecified:v};if(d.fillUnspecified)for(d=n[t],e=d[0]-x;e<q;e++)g[4*e]=d[1],g[4*e+1]=d[2],g[4*e+2]=d[3],
g[4*e+3]=v?d[4]:255,e===d[0]-x&&(d=t===n.length-1?d:n[++t]);else for(e=0;e<n.length;e++)d=n[e],t=4*(d[0]-x),g[t]=d[1],g[t+1]=d[2],g[t+2]=d[3],g[t+3]=v?d[4]:255;return{indexedColormap:g,offset:x,alphaSpecified:v}}}};P.createMaskLUT=function(d,n,x){if("u8"!==d&&"s8"!==d&&"u16"!==d&&"s16"!==d)return null;var q=d.includes("16")?65536:256;d=d.includes("s")?-q/2:0;q=new Uint8Array(q);if(n)for(let a=0;a<n.length;a++){var g=Math.ceil(n[2*a]-d);const e=Math.floor(n[2*a+1]-d);for(;g<=e;g++)q[g]=255}else q.fill(255);
if(x)for(n=0;n<x.length;n++)q[x[n]-d]=0;return{lut:q,offset:d}};P.createRemapLUT=function(d){const {srcPixelType:n,inputRanges:x,outputValues:q,allowUnmatched:g,noDataRanges:a,isLastInputRangeInclusive:e,outputPixelType:t}=d;if("u8"!==n&&"s8"!==n&&"u16"!==n&&"s16"!==n)return null;var v=n.includes("16")?65536:256;d=n.includes("s")?-v/2:0;const w=F.createEmptyBand(t,v);v=new Uint8Array(v);g&&v.fill(255);const [y,G]=I.getPixelValueRange(t);if(x?.length&&q?.length){var C=x.map(S=>S-1E-6);C[0]=x[0];e&&
(C[C.length-1]=x[x.length-1]);for(var u=0;u<C.length;u++){var z=q[u]>G?G:q[u]<y?y:q[u],L=Math.ceil(C[2*u]-d);const S=Math.floor(C[2*u+1]-d);for(;L<=S;L++)w[L]=z,v[L]=255}}if(a?.length)for(C=0;C<a.length;C++)for(z=Math.ceil(a[2*C]-d),u=Math.floor(a[2*C+1]-d);z<=u;z++)v[z]=0;return{lut:w,offset:d,mask:v}};P.extractBands=function(d,n){if(!n?.length||!p(d))return d;const x=d.pixels.length;return n&&n.some(q=>q>=x)||1===x&&1===n.length&&0===n[0]||x===n.length&&!n.some((q,g)=>q!==g)?d:new F({pixelType:d.pixelType,
width:d.width,height:d.height,mask:d.mask,validPixelCount:d.validPixelCount,maskIsAlpha:d.maskIsAlpha,pixels:n.map(q=>d.pixels[q]),statistics:d.statistics&&n.map(q=>d.statistics[q])})};P.getClipBounds=B;P.getLocalArithmeticNorthRotations=function(d,n){const {coefficients:x,spacing:q}=n,{offsets_x:g,offsets_y:a,gridWidth:e}=J(d,d,x,{rows:q[0],cols:q[1]}),{width:t,height:v}=d;d=new Float32Array(t*v);n=180/Math.PI;for(let G=0;G<v;G++)for(let C=0;C<t;C++){var w=G*e+C,y=0===G?w:w-e;const u=G===v-1?w:w+
e;w=g[y]-g[u];y=a[u]-a[y];isNaN(w)||isNaN(y)?d[G*t+C]=90:(y=Math.atan2(y,w)*n,y=(360+y)%360,d[G*t+C]=y)}return d};P.interpolateOffsets=J;P.isValidPixelBlock=p;P.lookupBandValues=R;P.lookupPixels=function(d,n){if(!p(d))return null;const {pixels:x,mask:q}=d,g=x.length;let a=n.lut;const {offset:e}=n;a&&1===a[0].length&&(a=x.map(()=>a));const t=[];n=n.outputPixelType||"u8";for(let v=0;v<g;v++){const w=R(x[v],q,a[v],e||0,n);t.push(w)}d=new F({width:d.width,height:d.height,pixels:t,mask:q,pixelType:n});
d.updateStatistics();return d};P.mask=function(d,n){if(!p(d))return null;const {width:x,height:q,pixels:g}=d;var a=x*q;const e=new Uint8Array(a);d.mask?e.set(d.mask):e.fill(255);d=g.length;const {includedRanges:t,noDataValues:v,outputPixelType:w,matchAll:y,lookups:G}=n;if(G){a=[];for(n=0;n<d;n++){var C=G[n];C=R(g[n],e,C.lut,C.offset||0,"u8");a.push(C)}1===a.length?e.set(a[0]):y?H(a,e):N(a,e)}else if(y){n=[];for(C=0;C<d;C++){const u=new Uint8Array(a);u.set(e);U(g[C],t?.slice(2*C,2*C+2),v?.[C],u);n.push(u)}1===
n.length?e.set(n[0]):H(n,e)}else for(a=0;a<d;a++)U(g[a],t?.slice(2*a,2*a+2),v?.[a],e);return new F({width:x,height:q,pixelType:w,pixels:g,mask:e})};P.mosaic=b;P.mosaicPixelData=function(d,n){if(!d||0===d.length)return null;var x=d.find(G=>G.pixelBlock);if(!x||D.isNone(x.pixelBlock))return null;var q=(x.extent.xmax-x.extent.xmin)/x.pixelBlock.width;const g=(x.extent.ymax-x.extent.ymin)/x.pixelBlock.height,a=.01*Math.min(q,g),e=d.sort((G,C)=>Math.abs(G.extent.ymax-C.extent.ymax)>a?C.extent.ymax-G.extent.ymax:
Math.abs(G.extent.xmin-C.extent.xmin)>a?G.extent.xmin-C.extent.xmin:0);var t=Math.min.apply(null,e.map(G=>G.extent.xmin));const v=Math.min.apply(null,e.map(G=>G.extent.ymin)),w=Math.max.apply(null,e.map(G=>G.extent.xmax)),y=Math.max.apply(null,e.map(G=>G.extent.ymax));d={x:Math.round((n.xmin-t)/q),y:Math.round((y-n.ymax)/g)};t={width:Math.round((w-t)/q),height:Math.round((y-v)/g)};q={width:Math.round((n.xmax-n.xmin)/q),height:Math.round((n.ymax-n.ymin)/g)};if(Math.round(t.width/x.pixelBlock.width)*
Math.round(t.height/x.pixelBlock.height)!==e.length||0>d.x||0>d.y||t.width<q.width||t.height<q.height)return null;x=e.map(G=>G.pixelBlock);x=b(x,t,{clipOffset:d,clipSize:q});return{extent:n,pixelBlock:x}};P.remap=function(d,n){if(!p(d))return null;const {width:x,height:q}=d,{inputRanges:g,outputValues:a,outputPixelType:e,noDataRanges:t,allowUnmatched:v,isLastInputRangeInclusive:w}=n;n=d.pixels[0];const y=F.createEmptyBand(e,n.length),G=d.mask,C=new Uint8Array(x*q);G?C.set(G):C.fill(255);const u=d.pixelType.startsWith("f")?
1E-6:0;var z=g.map(A=>A-u);z[0]=g[0];z[z.length-1]=g[g.length-1]+(w?1E-6:0);d=g.length/2;const [L,S]=I.getPixelValueRange(e);for(var Z=0;Z<q;Z++)for(var X=0;X<x;X++){var M=Z*x+X;if(C[M]){var O=n[M];let A=!1;for(let Q=d-1;0<=Q;Q--)if(O===z[2*Q]||O>z[2*Q]&&O<z[2*Q+1]){y[M]=a[Q];A=!0;break}A||(v?y[M]=O>S?S:O<L?L:O:C[M]=0)}}if(t?.length)for(z=0;z<q;z++)for(Z=0;Z<x;Z++)if(X=z*x+Z,!G||G[X])for(M=n[X],O=0;O<d;O+=2)if(M>=t[O]&&M<=t[O+1]){y[X]=0;C[X]=0;break}return new F({width:x,height:q,pixelType:e,pixels:[y],
mask:C})};P.remapColor=function(d,n){if(!p(d))return null;d=d.clone();var {pixels:x}=d;const q=d.width*d.height,g=n.length,a=Math.floor(g/2),e=n[Math.floor(a)];x=x[0];let t,v,w,y,G,C,u=!1;const z=new Uint8Array(q),L=new Uint8Array(q),S=new Uint8Array(q);let Z=d.mask;const X=4===n[0].mappedColor.length;Z||(Z=new Uint8Array(q),Z.fill(X?255:1),d.mask=Z);for(G=0;G<q;G++)if(Z[G]){t=x[G];u=!1;C=a;v=e;w=0;for(y=g-1;1<y-w;){if(t===v.value){u=!0;break}t>v.value?w=C:y=C;C=Math.floor((w+y)/2);v=n[Math.floor(C)]}u||
(t===n[w].value?(v=n[w],u=!0):t===n[y].value?(v=n[y],u=!0):t<n[w].value?(u=!1,v=null):t>n[w].value&&(t<n[y].value?(v=n[w],u=!0):y===g-1?(u=!1,v=null):(v=n[y],u=!0)));u?(z[G]=v.mappedColor[0],L[G]=v.mappedColor[1],S[G]=v.mappedColor[2],Z[G]=v.mappedColor[3]):z[G]=L[G]=S[G]=Z[G]=0}d.pixels=[z,L,S];d.mask=Z;d.pixelType="u8";d.maskIsAlpha=X;return d};P.resampleByMajority=f;P.setValidBoundary=function(d,n,x){if(!p(d))return null;const {width:q,height:g}=d,a=n.x;n=n.y;const e=x.width+a;x=x.height+n;if(0>
a||0>n||e>q||x>g||0===a&&0===n&&e===q&&x===g)return d;d.mask||(d.mask=new Uint8Array(q*g));const t=d.mask;for(let v=0;v<g;v++){const w=v*q;for(let y=0;y<q;y++)t[w+y]=v<n||v>=x||y<a||y>=e?0:1}d.updateStatistics();return d};P.split=function(d,n,x){if(!p(d))return null;const {width:q,height:g}=n;let {width:a,height:e}=d;const t=new Map,v={x:0,y:0};x=null==x?1:1+x;for(let w=0;w<x;w++){const y=Math.ceil(a/q),G=Math.ceil(e/g);for(let C=0;C<G;C++){v.y=C*g;for(let u=0;u<y;u++){v.x=u*q;const z=r(d,v,n);t.set(`${w}/${C}/${u}`,
z)}}w<x-1&&(d=E(d));a=Math.round(a/2);e=Math.round(e/2)}return t};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/utils":function(){define("require exports ../../chunks/_rollupPluginBabelHelpers ../../Color ../../symbols ../../core/asyncUtils ../../core/has ../../core/maybe ../../core/screenUtils ../../chunks/vec3f64 ../../layers/effects/jsonUtils ./gfxUtils ./Symbol3DMaterial".split(" "),function(P,D,F,I,p,R,U,H,N,B,l,b,k){function f(y){y=y.symbolLayers;if(!y)return null;
let G=null;y.forEach(C=>{if("object"!==C.type||null==C.resource?.href)G="water"===C.type?H.unwrap(C.color):H.isSome(C.material)?H.unwrap(C.material.color):null});return G?new I(G):null}function c(y,G){if(null==G||null==y)return y;y=y.toRgba();y[3]*=G;return new I(y)}function m(y,G,C){if(y=y.symbolLayers){var u=z=>{z=H.isSome(z)?z:null;G=G??z??(null!=C?w:null);return c(G,C)};y.forEach(z=>{if("object"!==z.type||null==z.resource?.href||G)if("water"===z.type)z.color=u(z.color);else{var L=H.isSome(z.material)?
z.material.color:null;L=u(L);H.isNone(z.material)?z.material=new k.Symbol3DMaterial({color:L}):z.material.color=L;null!=C&&"outline"in z&&H.isSome(z.outline)&&H.isSome(z.outline.color)&&(z.outline.color=c(z.outline.color,C))}})}}function h(y,G){return r.apply(this,arguments)}function r(){r=F._asyncToGenerator(function*(y,G){(y=y.symbolLayers)&&(yield R.forEach(y,function(){var C=F._asyncToGenerator(function*(u){return E(u,G)});return function(u){return C.apply(this,arguments)}}()))});return r.apply(this,
arguments)}function E(y,G){return J.apply(this,arguments)}function J(){J=F._asyncToGenerator(function*(y,G){switch(y.type){case "extrude":y.size="number"===typeof G[2]?G[2]:0;break;case "icon":case "line":case "text":G=d(G);H.isSome(G)&&(y.size=G);break;case "path":const C=q(G,B.ONES,[y.width,void 0,y.height]);y.width=e(G[0],y.width,1,C);y.height=e(G[2],y.height,1,C);break;case "object":yield n(y,G)}});return J.apply(this,arguments)}function d(y){for(const G of y)if("number"===typeof G)return G;return null}
function n(y,G){return x.apply(this,arguments)}function x(){x=F._asyncToGenerator(function*(y,G){const {resourceSize:C,symbolSize:u}=yield g(y),z=q(G,C,u);y.width=e(G[0],u[0],C[0],z);y.depth=e(G[1],u[1],C[1],z);y.height=e(G[2],u[2],C[2],z)});return x.apply(this,arguments)}function q(y,G,C){for(let u=0;3>u;u++){const z=y[u];switch(z){case "symbol-value":return y=C[u],null!=y?y/G[u]:1;case "proportional":break;default:if(z&&G[u])return z/G[u]}}return 1}function g(y){return a.apply(this,arguments)}function a(){a=
F._asyncToGenerator(function*(y){const G=yield(yield new Promise((Z,X)=>P(["./symbolLayerUtils"],Z,X))).computeObjectLayerResourceSize(y,10),{width:C,height:u,depth:z}=y;y=[C,z,u];let L=1;for(var S=0;3>S;S++){const Z=y[S];if(null!=Z){L=Z/G[S];break}}for(S=0;3>S;S++)null==y[S]&&(y[S]=G[S]*L);return{resourceSize:G,symbolSize:y}});return a.apply(this,arguments)}function e(y,G,C,u){switch(y){case "proportional":return C*u;case "symbol-value":return null!=G?G:C;default:return y}}function t(){t=F._asyncToGenerator(function*(y,
G){if(y&&G){if(p.isSymbol3D(y))return h(y,G);if(p.isSymbol2D(y)&&(G=d(G),!H.isNone(G)))switch(y.type){case "simple-marker":y.size=G;break;case "picture-marker":const C=y.width/y.height;1<C?(y.width=G,y.height=G*C):(y.width=G*C,y.height=G);break;case "simple-line":y.width=G;break;case "text":y.font.size=G}}});return t.apply(this,arguments)}function v(){v=F._asyncToGenerator(function*(y,G){const C=yield y.fetchSymbol(G);return C?C:y.fetchCIMSymbol(G)});return v.apply(this,arguments)}const w=new I("white");
D.applyColorToSymbol=function(y,G,C){if(y&&(G||null!=C))if(G&&(G=new I(G)),p.isSymbol3D(y))m(y,G,C);else if(p.isSymbol2D(y)){if(G=G??y.color)y.color=c(G,C);null!=C&&"outline"in y&&y.outline&&y.outline.color&&(y.outline.color=c(y.outline.color,C))}};D.applyOpacityToColor=c;D.applyRotationToSymbol=function(y,G,C){y&&null!=G&&(p.isSymbol3D(y)?(y=y.symbolLayers)&&y.forEach(u=>{if(u&&"object"===u.type)switch(C){case "tilt":u.tilt=G;break;case "roll":u.roll=G;break;default:u.heading=G}}):!p.isSymbol2D(y)||
"simple-marker"!==y.type&&"picture-marker"!==y.type&&"text"!==y.type||(y.angle=G))};D.applySizesToSymbol=function(y,G){return t.apply(this,arguments)};D.fetchWebStyleSymbol=function(y,G){return v.apply(this,arguments)};D.getCSSFilterFromEffectList=function(y){if(!y)return null;y=y.effects.filter(G=>"bloom"!==G.type).map(G=>G.toJSON());return l.effectFunctionsFromJSON(y)};D.getColorFromSymbol=function(y,G){if(!y)return null;let C=null;p.isSymbol3D(y)?C=f(y):p.isSymbol2D(y)&&(C=y.color?new I(y.color):
null);return C?c(C,G):null};D.getIconHref=function(y){return H.unwrapOrThrow(y.resource).href};D.getSymbolOutlineSize=function(y){if(!y)return 0;if(p.isSymbol3D(y)){{const G=y.symbolLayers&&y.symbolLayers.length;G?(y=y.symbolLayers.getItemAt(G-1),y="outline"in y?H.get(y,"outline","size"):void 0):y=void 0}return H.isSome(y)?y:0}return N.px2pt(b.getStroke(y)?.width)};D.isVolumetricSymbol=function(y){if(H.isNone(y)||!("symbolLayers"in y)||H.isNone(y.symbolLayers))return!1;switch(y.type){case "point-3d":return y.symbolLayers.some(G=>
"object"===G.type);case "line-3d":return y.symbolLayers.some(G=>"path"===G.type);case "polygon-3d":return y.symbolLayers.some(G=>"object"===G.type||"extrude"===G.type);default:return!1}};D.symbolHasExtrudeSymbolLayer=function(y){return H.isSome(y)&&"polygon-3d"===y.type&&y.symbolLayers.some(G=>"extrude"===G.type)};Object.defineProperty(D,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/gfxUtils":function(){define("exports ../../assets ../../Color ../../request ../../core/ItemCache ../../core/screenUtils ./cimSymbolUtils".split(" "),
function(P,D,F,I,p,R,U){function H(l){if(!l)return null;let b=null;switch(l.type){case "simple-fill":case "picture-fill":case "simple-marker":b=H(l.outline);break;case "simple-line":const k=R.pt2px(l.width);null!=l.style&&"none"!==l.style&&0!==k&&(b={color:l.color,style:B(l.style),width:k,cap:l.cap,join:"miter"===l.join?R.pt2px(l.miterLimit):l.join});break;default:b=null}return b}const N=new p(1E3),B=(()=>{const l={};return b=>{if(l[b])return l[b];const k=b.replace(/-/g,"");return l[b]=k}})();F=new F([128,
128,128]);P.defaultThematicColor=F;P.dekebabifyLineStyle=B;P.getFill=function(l){const b=l.style;let k=null;if(l)switch(l.type){case "simple-marker":"cross"!==b&&"x"!==b&&(k=l.color);break;case "simple-fill":"solid"===b?k=l.color:"none"!==b&&(k={type:"pattern",x:0,y:0,src:D.getAssetUrl(`esri/symbols/patterns/${b}.png`),width:5,height:5});break;case "picture-fill":k={type:"pattern",src:l.url,width:R.pt2px(l.width)*l.xscale,height:R.pt2px(l.height)*l.yscale,x:R.pt2px(l.xoffset),y:R.pt2px(l.yoffset)};
break;case "text":k=l.color;break;case "cim":k=U.getCIMSymbolColor(l)}return k};P.getPatternUrlWithColor=function(l,b){const k=l+"-"+b;return void 0!==N.get(k)?Promise.resolve(N.get(k)):I(l,{responseType:"image"}).then(f=>{f=f.data;const c=f.naturalWidth,m=f.naturalHeight,h=document.createElement("canvas");h.width=c;h.height=m;const r=h.getContext("2d");r.fillStyle=b;r.fillRect(0,0,c,m);r.globalCompositeOperation="destination-in";r.drawImage(f,0,0);f=h.toDataURL();N.put(k,f);return f})};P.getStroke=
H;Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/core/ItemCache":function(){define(["./MemCache"],function(P){return function(){function D(I,p){this._storage=new P.MemCacheStorage;this._storage.maxSize=I;p&&this._storage.registerRemoveFunc("",p)}var F=D.prototype;F.put=function(I,p){this._storage.put(I,p,1,1)};F.pop=function(I){return this._storage.pop(I)};F.get=function(I){return this._storage.get(I)};F.clear=function(){this._storage.clearAll()};F.destroy=function(){this._storage.destroy()};
return D}()})},"esri/symbols/support/cimSymbolUtils":function(){define(["exports","../../Color","../cim/utils"],function(P,D,F){function I(b){b=F.toCIMSymbolJSON(b);if("CIMTextSymbol"===b?.type)return b.height??0;let k=0;if(b?.symbolLayers)for(const f of b.symbolLayers)F.isCIMMarker(f)&&null!=f.size&&f.size>k?k=f.size:F.isCIMStroke(f)&&null!=f.width&&f.width>k?k=f.width:F.isCIMFill(f);return k}function p(b,k,f,c){if(b)if("CIMTextSymbol"===b.type)null!=b.height&&(b.height*=k);else{if(f&&b.effects)for(const m of b.effects)H(m,
k);if(b.symbolLayers)for(const m of b.symbolLayers)switch(m.type){case "CIMPictureMarker":case "CIMVectorMarker":R(m,k,c);break;case "CIMPictureStroke":case "CIMSolidStroke":!c?.preserveOutlineWidth&&m.width&&(m.width*=k);break;case "CIMPictureFill":m.height&&(m.height*=k);m.offsetX&&(m.offsetX*=k);m.offsetY&&(m.offsetY*=k);break;case "CIMHatchFill":p(m.lineSymbol,k,!0,{...c,preserveOutlineWidth:!1}),m.offsetX&&(m.offsetX*=k),m.offsetY&&(m.offsetY*=k),m.separation&&(m.separation*=k)}}}function R(b,
k,f){if(b&&(b.markerPlacement&&U(b.markerPlacement,k),b.offsetX&&(b.offsetX*=k),b.offsetY&&(b.offsetY*=k),b.anchorPoint&&"Absolute"===b.anchorPointUnits&&(b.anchorPoint={x:b.anchorPoint.x*k,y:b.anchorPoint.y*k}),b.size=null!=b.size?b.size*k:0,"CIMVectorMarker"===b.type&&b.markerGraphics))for(const c of b.markerGraphics)b.scaleSymbolsProportionally||p(c.symbol,k,!0,f)}function U(b,k){F.isCIMMarkerStrokePlacement(b)&&b.offset&&(b.offset*=k);switch(b.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":b.customEndingOffset&&
(b.customEndingOffset*=k);b.offsetAlongLine&&(b.offsetAlongLine*=k);if(b.placementTemplate&&b.placementTemplate.length){var f=b.placementTemplate.map(c=>c*k);b.placementTemplate=f}break;case "CIMMarkerPlacementAlongLineVariableSize":b.maxRandomOffset&&(b.maxRandomOffset*=k);b.placementTemplate&&b.placementTemplate.length&&(f=b.placementTemplate.map(c=>c*k),b.placementTemplate=f);break;case "CIMMarkerPlacementOnLine":b.startPointOffset&&(b.startPointOffset*=k);break;case "CIMMarkerPlacementAtExtremities":b.offsetAlongLine&&
(b.offsetAlongLine*=k);break;case "CIMMarkerPlacementAtRatioPositions":b.beginPosition&&(b.beginPosition*=k);b.endPosition&&(b.endPosition*=k);break;case "CIMMarkerPlacementPolygonCenter":b.offsetX&&(b.offsetX*=k);b.offsetY&&(b.offsetY*=k);break;case "CIMMarkerPlacementInsidePolygon":b.offsetX&&(b.offsetX*=k),b.offsetY&&(b.offsetY*=k),b.stepX&&(b.stepX*=k),b.stepY&&(b.stepY*=k)}}function H(b,k){switch(b.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":b.width&&(b.width*=k);break;
case "CIMGeometricEffectBuffer":b.size&&(b.size*=k);break;case "CIMGeometricEffectCut":b.beginCut&&(b.beginCut*=k);b.endCut&&(b.endCut*=k);b.middleCut&&(b.middleCut*=k);break;case "CIMGeometricEffectDashes":b.customEndingOffset&&(b.customEndingOffset*=k);b.offsetAlongLine&&(b.offsetAlongLine*=k);if(b.dashTemplate&&b.dashTemplate.length){const f=b.dashTemplate.map(c=>c*k);b.dashTemplate=f}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":b.length&&
(b.length*=k);break;case "CIMGeometricEffectMove":b.offsetX&&(b.offsetX*=k);b.offsetY&&(b.offsetY*=k);break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":b.offset&&(b.offset*=k);break;case "CIMGeometricEffectRegularPolygon":b.radius&&(b.radius*=k);break;case "CIMGeometricEffectTaperedPolygon":b.fromWidth&&(b.fromWidth*=k);b.length&&(b.length*=k);b.toWidth&&(b.toWidth*=k);break;case "CIMGeometricEffectWave":b.amplitude&&(b.amplitude*=k),b.period&&(b.period*=k)}}function N(b,
k){if(b){var f="CIMTextSymbol"===b.type?b.symbol:b;b="CIMPolygonSymbol"===b.type;if(f?.symbolLayers)for(const c of f.symbolLayers)if(!(c.colorLocked||b&&(F.isCIMStroke(c)||F.isCIMMarker(c)&&c.markerPlacement&&F.isCIMMarkerStrokePlacement(c.markerPlacement))))switch(c.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":c.tintColor&&B(k,c.tintColor);break;case "CIMVectorMarker":c.markerGraphics?.forEach(m=>{N(m.symbol,k)});break;case "CIMSolidStroke":case "CIMSolidFill":B(k,
c.color);break;case "CIMHatchFill":N(c.lineSymbol,k)}}}function B(b,k){for(const f of b)if(f.join(".")===k.join("."))return;b.push(k)}function l(b,k,f){if(b){var c="CIMTextSymbol"===b.type?b.symbol:b;b="CIMPolygonSymbol"===c?.type;if(c?.symbolLayers)for(const m of c.symbolLayers)if(!m.colorLocked){if(b)if(f){if({layersToColor:c}=f,(F.isCIMStroke(m)||F.isCIMMarker(m)&&m.markerPlacement&&F.isCIMMarkerStrokePlacement(m.markerPlacement))&&"fill"===c||F.isCIMFill(m)&&"outline"===c)continue}else if(F.isCIMStroke(m)||
F.isCIMMarker(m)&&m.markerPlacement&&F.isCIMMarkerStrokePlacement(m.markerPlacement))continue;c=k.toArray();switch(m.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":m.tintColor=c;break;case "CIMVectorMarker":m.markerGraphics?.forEach(h=>{l(h.symbol,k,f)});break;case "CIMSolidStroke":case "CIMSolidFill":m.color=c;break;case "CIMHatchFill":l(m.lineSymbol,k,f)}}}}P.applyCIMSymbolColor=function(b,k,f){k instanceof D||(k=new D(k));(b=F.toCIMSymbolJSON(b))&&l(b,k,f)};P.applyCIMSymbolRotation=
function(b,k,f=!1){b=F.toCIMSymbolJSON(b);f&&0!==k&&(k=360-k);if("CIMTextSymbol"===b?.type)b.angle=k;else if("CIMPointSymbol"===b?.type&&b.symbolLayers){f=k-(b.angle||0);for(const c of b.symbolLayers)if(F.isCIMMarker(c)){let m=c.rotation||0;m=c.rotateClockwise?m-f:m+f;c.rotation=m}b.angle=k}};P.getCIMSymbolColor=function(b){b=F.toCIMSymbolJSON(b);const k=[];N(b,k);return k.length?new D(F.fromCIMColor(k[0])):null};P.getCIMSymbolRotation=function(b,k=!1){b=F.toCIMSymbolJSON(b);return"CIMTextSymbol"===
b?.type||"CIMPointSymbol"===b?.type?(b=b.angle,null!=b&&0!==b&&k?360-b:b??0):0};P.getCIMSymbolSize=I;P.getCIMSymbolType=function(b){b=F.toCIMSymbolJSON(b);if(!b)return null;switch(b.type){case "CIMPointSymbol":return"CIMPointSymbol";case "CIMLineSymbol":return"CIMLineSymbol";case "CIMPolygonSymbol":return"CIMPolygonSymbol";case "CIMTextSymbol":return"CIMTextSymbol";case "CIMMeshSymbol":return"CIMMeshSymbol";default:return null}};P.scaleCIMMarker=R;P.scaleCIMSymbol=p;P.scaleCIMSymbolTo=function(b,
k,f){if(b){var c=F.toCIMSymbolJSON(b);b=I(b);if(0===b){if(c)if("CIMTextSymbol"===c.type)c.height=k;else if(c.symbolLayers)for(const m of c.symbolLayers)switch(m.type){case "CIMPictureMarker":case "CIMVectorMarker":m.size=k;break;case "CIMPictureStroke":case "CIMSolidStroke":m.width=k}}else p(c,k/b,!1,f)}};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/utils":function(){define(["require","exports"],function(P,D){function F(l){let b=l.length;for(;b--;)if(!" /-,\n".includes(l.charAt(b)))return!1;
return!0}function I(l,b){const k=[];var f=0;let c=-1;do c=l.indexOf("[",f),c>=f&&(c>f&&(f=l.substr(f,c-f),k.push([f,null,F(f)])),f=c+1,c=l.indexOf("]",f),c>=f&&(c>f&&(f=l.substr(f,c-f),(f=b[f])&&k.push([null,f,!1])),f=c+1));while(-1!==c);f<l.length-1&&(l=l.substr(f),k.push([l,null,F(l)]));return k}function p(l,b,k){let f="",c=null;for(const m of b){const [h,r,E]=m;if(h)E?c=h:(c&&(f+=c,c=null),f+=h);else if(b=l.attributes[r])c&&(f+=c,c=null),f+=b}return R(f,k)}function R(l,b){"string"!==typeof l&&
(l=String(l));switch(b){case "LowerCase":return l.toLowerCase();case "Allcaps":return l.toUpperCase();default:return l}}function U(l){return l?{r:l[0],g:l[1],b:l[2],a:l[3]/255}:{r:0,g:0,b:0,a:0}}function H(l){if(!l)return null;switch(l.type){case "CIMPolygonSymbol":if(l.symbolLayers)for(const b of l.symbolLayers)if(l=H(b),null!=l)return l;break;case "CIMTextSymbol":return H(l.symbol);case "CIMSolidFill":return l.color}}function N(l){if(l)switch(l.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(l=
l.symbolLayers)for(const b of l)if(l=N(b),null!=l)return l;break;case "CIMTextSymbol":return N(l.symbol);case "CIMSolidStroke":case "CIMSolidFill":return l.color}}function B(l){if(l)switch(l.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(l.symbolLayers)for(const b of l.symbolLayers)if(l=B(b),void 0!==l)return l;break;case "CIMTextSymbol":return B(l.symbol);case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return l.width}}D.adjustTextCase=R;D.analyzeTextParts=I;D.assignTextValuesFromFeature=
p;D.attributesToFields=function(l){return(l?Object.keys(l):[]).map(b=>({name:b,alias:b,type:"string"===typeof l[b]?"esriFieldTypeString":"esriFieldTypeDouble"}))};D.colorToArray=function(l){return[l.r,l.g,l.b,l.a]};D.createLabelOverrideFunction=function(l,b,k){const f=I(b,l);return c=>p(c,f,k)};D.evaluateValueOrFunction=function(l,b,k,f){return"function"===typeof l?l(b,k,f):l};D.fromCIMColor=U;D.fromCIMFontDecoration=function(l){return l.underline?"underline":l.strikethrough?"line-through":"none"};
D.fromCIMFontStyle=function(l){let b="",k="";l&&(l=l.toLowerCase(),l.includes("italic")?b="italic":l.includes("oblique")&&(b="oblique"),l.includes("bold")?k="bold":l.includes("light")&&(k="lighter"));return{style:b,weight:k}};D.fromCIMHorizontalAlignment=function(l){switch(l){default:return"left";case "Right":return"right";case "Center":return"center";case "Justify":return"center"}};D.fromCIMVerticalAlignment=function(l){switch(l){default:return"top";case "Center":return"middle";case "Baseline":return"baseline";
case "Bottom":return"bottom"}};D.getFillColor=H;D.getFontStyle=function(l){if(!l)return"normal";switch(l.toLowerCase()){case "italic":return"italic";case "oblique":return"oblique";default:return"normal"}};D.getFontWeight=function(l){if(!l)return"normal";switch(l.toLowerCase()){case "bold":return"bold";case "bolder":return"bolder";case "lighter":return"lighter";default:return"normal"}};D.getStrokeColor=N;D.getStrokeWidth=B;D.getTintColor=l=>l.tintColor?U(l.tintColor):{r:255,g:255,b:255,a:1};D.getValue=
(l,b=0)=>null==l||isNaN(l)?b:l;D.importGeometryEngine=function(){return new Promise((l,b)=>P(["../../geometry/geometryEngineJSON"],l,b))};D.isCIMFill=function(l){return null!=l&&("CIMGradientFill"===l.type||"CIMHatchFill"===l.type||"CIMPictureFill"===l.type||"CIMSolidFill"===l.type||"CIMWaterFill"===l.type)};D.isCIMMarker=function(l){return"CIMVectorMarker"===l.type||"CIMPictureMarker"===l.type||"CIMBarChartMarker"===l.type||"CIMCharacterMarker"===l.type||"CIMPieChartMarker"===l.type||"CIMStackedBarChartMarker"===
l.type};D.isCIMMarkerStrokePlacement=function(l){return null!=l&&("CIMMarkerPlacementAlongLineRandomSize"===l.type||"CIMMarkerPlacementAlongLineSameSize"===l.type||"CIMMarkerPlacementAlongLineVariableSize"===l.type||"CIMMarkerPlacementAtExtremities"===l.type||"CIMMarkerPlacementAtMeasuredUnits"===l.type||"CIMMarkerPlacementAtRatioPositions"===l.type||"CIMMarkerPlacementOnLine"===l.type||"CIMMarkerPlacementOnVertices"===l.type)};D.isCIMStroke=function(l){return"CIMGradientStroke"===l.type||"CIMPictureStroke"===
l.type||"CIMSolidStroke"===l.type};D.isGeometryEngineRequired=l=>{if(!l)return!1;for(const b of l)switch(b.type){case "CIMGeometricEffectBuffer":case "CIMGeometricEffectOffset":case "CIMGeometricEffectDonut":return!0}return!1};D.isSVGImage=l=>l.includes("data:image/svg+xml");D.mapCIMSymbolToGeometryType=function(l){if(!l)return null;switch(l.type){case "CIMPointSymbol":case "CIMTextSymbol":return"esriGeometryPoint";case "CIMLineSymbol":return"esriGeometryPolyline";case "CIMPolygonSymbol":return"esriGeometryPolygon";
default:return null}};D.resampleHermite=function(l,b,k,f,c,m,h=!0){const r=b/c;k/=m;const E=Math.ceil(r/2),J=Math.ceil(k/2);for(let x=0;x<m;x++)for(let q=0;q<c;q++){const g=4*(q+(h?m-x-1:x)*c);var d=0;let a=0,e=0,t=0,v=0,w=0,y=0;const G=(x+.5)*k;for(let C=Math.floor(x*k);C<(x+1)*k;C++){var n=Math.abs(G-(C+.5))/J;const u=(q+.5)*r;n*=n;for(let z=Math.floor(q*r);z<(q+1)*r;z++){let L=Math.abs(u-(z+.5))/E;d=Math.sqrt(n+L*L);-1<=d&&1>=d&&(d=2*d*d*d-3*d*d+1,0<d&&(L=4*(z+C*b),y+=d*l[L+3],e+=d,255>l[L+3]&&
(d=d*l[L+3]/250),t+=d*l[L],v+=d*l[L+1],w+=d*l[L+2],a+=d))}}f[g]=t/a;f[g+1]=v/a;f[g+2]=w/a;f[g+3]=y/e}};D.toCIMSymbolJSON=function(l){return l.data?.symbol??null};Object.defineProperty(D,Symbol.toStringTag,{value:"Module"})})},"esri/layers/mixins/ImageryTileMixin":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../rasterRenderers ../../request ../../core/Error ../../core/Logger ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass ../../geometry/support/spatialReferenceUtils ../support/arcgisLayerUrl ../support/commonProperties ../support/DimensionalDefinition ../support/MultidimensionalSubset ../support/RasterFunction ../support/RasterJobHandler ../support/TileInfo ../support/rasterDatasets/FunctionRaster ../support/rasterDatasets/multidimensionalUtils ../support/rasterFunctions/rasterFunctionHelper ../support/rasterFunctions/vectorFieldUtils ../../renderers/support/rasterRendererHelper ../../renderers/support/RasterSymbolizer ../../views/2d/engine/flow/dataUtils ../../geometry/SpatialReference".split(" "),
function(P,D,F,I,p,R,U,H,N,B,l,b,k,f,c,m,h,r,E,J,d,n,x,q,g,a,e,t,v){const w=H.getLogger("esri.layers.mixins.ImageryTileMixin");P.ImageryTileMixin=y=>{function G(C){if(!C.raster||!C.rasterInfo)throw new U("imagery-tile","no raster");}y=function(C){function u(...L){var S=C.call(this,...L)||this;S._isConstructedFromFunctionRaster=!1;S._rasterJobHandler={instance:null,refCount:0,connectionPromise:null};S.bandIds=null;S.copyright=null;S.interpolation="nearest";S.multidimensionalSubset=null;S.raster=null;
S.rasterFunction=null;S.rasterInfo=null;S.sourceJSON=null;S.spatialReference=null;S.symbolizer=null;S._isConstructedFromFunctionRaster="Function"===L[0]?.raster?.datasetFormat;return S}D._inheritsLoose(u,C);var z=u.prototype;z.convertVectorFieldData=function(){var L=D._asyncToGenerator(function*(S,Z){if(N.isNone(S)||!this.rasterInfo)return null;const X=this._rasterJobHandler.instance,M=this.rasterInfo.dataType;return X?X.convertVectorFieldData({pixelBlock:S,dataType:M},Z):g.convertVectorFieldData(S,
M)});return function(S,Z){return L.apply(this,arguments)}}();z.createFlowMesh=function(){var L=D._asyncToGenerator(function*(S,Z){const X=this._rasterJobHandler.instance;return X?X.createFlowMesh(S,Z):t.createFlowMesh(S.meshType,S.simulationSettings,S.flowData,N.isSome(Z.signal)?Z.signal:(new AbortController).signal)});return function(S,Z){return L.apply(this,arguments)}}();z.normalizeRasterFetchOptions=function(L){var {multidimensionalInfo:S}=this.rasterInfo??{};if(N.isNone(S))return L;let Z=L.multidimensionalDefinition||
this.multidimensionalDefinition;if(N.isNone(Z)||!Z.length)Z=x.getDefaultMultidimensionalDefinition(this.raster.rasterInfo,{multidimensionalSubset:this.multidimensionalSubset});var X=L.timeExtent||this.timeExtent;if(N.isSome(Z)&&N.isSome(X)&&(N.isSome(X.start)||N.isSome(X.end))){Z=Z.map(T=>T.clone());var M=S.variables.find(({name:T})=>T===Z[0].variableName)?.dimensions?.find(({name:T})=>"StdTime"===T);S=Z.find(({dimensionName:T})=>"StdTime"===T);if(!M||!S)return{...L,multidimensionalDefinition:null};
const {start:O,end:A}=X;X=N.isNone(O)?null:O.getTime();const Q=N.isNone(A)?null:A.getTime(),Y=X??Q,W=Q??X;if(N.isSome(M.values))M=M.values.filter(T=>{if(Array.isArray(T)){if(Y===W)return T[0]<=Y&&T[1]>=Y;const K=T[0]>=Y&&T[1]<=W||T[0]<Y&&T[1]>W;return T[0]<=Y&&T[1]>Y||T[0]<W&&T[1]>=W||K}return Y===W?T===Y:T>=Y&&T<=W}),M.length?(M=M.sort((T,K)=>Y===W?(T[0]??T)-(K[0]??K):Math.abs((T[1]??T)-W)-Math.abs((K[1]??K)-W))[0],S.values=[M]):Z=null;else if(M.hasRegularIntervals&&M.extent){const [T,K]=M.extent;
Y>K||W<T?Z=null:S.values=Y===W?[Y]:[Math.max(T,Y),Math.min(K,W)]}}return N.isSome(Z)&&x.hasExcludedVariableOrDimension(Z,this.multidimensionalSubset)?{...L,multidimensionalDefinition:null}:{...L,multidimensionalDefinition:Z}};z.updateRasterFunction=function(){var L=D._asyncToGenerator(function*(){if("imagery-tile"===this.type&&(this.rasterFunction||this._cachedRasterFunctionJson)&&JSON.stringify(this.rasterFunction)!==JSON.stringify(this._cachedRasterFunctionJson))if(this._isConstructedFromFunctionRaster&&
"Function"===this.raster.datasetFormat){var S=this.raster.rasterFunction.toJSON();!this.rasterFunction&&S&&this._set("rasterFunction",E.fromJSON(S));this._cachedRasterFunctionJson=this.rasterFunction?.toJSON()}else{var Z=this.raster;S=!1;if("Function"===Z.datasetFormat){var X=Z.primaryRasters.rasters;Z=X[0];S=!0}else X=[Z];var {rasterFunction:M}=this;if(M){const A={raster:Z};1<X.length&&X.forEach(Q=>A[Q.url]=Q);Z=q.create(M.rasterFunctionDefinition??M.toJSON(),A);Z=new n({rasterFunction:Z});Z.rasterJobHandler=
this._rasterJobHandler.instance;yield Z.open();this._cachedRasterFunctionJson=this.rasterFunction?.toJSON();this.raster=Z}else this.raster=Z,this._cachedRasterFunctionJson=null;this._cachedRendererJson=null;if(S||M){({bandIds:S}=this);var {bandCount:O}=this.raster.rasterInfo;M=S?.length?S.some(A=>A>=O):3<=O;S&&(M||"raster-stretch"!==this.renderer.type)&&this._set("bandIds",null);this._configDefaultRenderer("auto")}}});return function(){return L.apply(this,arguments)}}();z.updateRenderer=function(){var L=
D._asyncToGenerator(function*(){const {loaded:S,symbolizer:Z}=this;if(S&&Z){var {rasterInfo:X}=this.raster,M=x.getDefaultVariablInfo(X,{multidimensionalDefinition:this.multidimensionalDefinition,multidimensionalSubset:this.multidimensionalSubset})?.name,O=a.normalizeRendererJSON({...this.renderer.toJSON(),variableName:M});if(JSON.stringify(this._cachedRendererJson)!==JSON.stringify(O)){var A=this._rasterJobHandler.instance;A&&(Z.rasterInfo=a.getVariableRasterInfo(X,M),Z.rendererJSON=O,Z.bind(),yield A.updateSymbolizer(Z),
this._cachedRendererJson=O)}}});return function(){return L.apply(this,arguments)}}();z.applyRenderer=function(){var L=D._asyncToGenerator(function*(S,Z){var X=S&&S.pixelBlock;if(!(N.isSome(X)&&X.pixels&&0<X.pixels.length))return null;yield this.updateRenderer();X=this._rasterJobHandler.instance;const M=this.bandIds??[];return X?yield X.symbolize({...S,simpleStretchParams:Z,bandIds:M}):this.symbolizer.symbolize({...S,simpleStretchParams:Z,bandIds:M})});return function(S,Z){return L.apply(this,arguments)}}();
z.getTileUrl=function(L,S,Z){return"RasterTileServer"===this.raster.datasetFormat?`${this.url}/tile/${L}/${S}/${Z}`:""};z.getCompatibleTileInfo=function(L,S,Z=!1){if(!this.loaded||N.isNone(S))return null;if(Z&&L.equals(this.spatialReference))return this.tileInfo;Z=f.getInfo(L);return d.create({size:256,spatialReference:L,origin:Z?{x:Z.origin[0],y:Z.origin[1]}:{x:S.xmin,y:S.ymax}})};z.getCompatibleFullExtent=function(L){return this.loaded?this._compatibleFullExtent&&this._compatibleFullExtent.spatialReference.equals(L)?
this._compatibleFullExtent:this._compatibleFullExtent=this.raster.computeExtent(L):null};z.fetchTile=function(){var L=D._asyncToGenerator(function*(S,Z,X,M={}){G(this);if(M.requestAsImageElement)return S=this.getTileUrl(S,Z,X),R(S,{responseType:"image",query:{...this.refreshParameters,...this.raster.ioConfig.customFetchParameters},signal:M.signal}).then(A=>A.data);const {rasterInfo:O}=this;if(N.isSome(O.multidimensionalInfo)&&(M=this.normalizeRasterFetchOptions(M),N.isNone(M.multidimensionalDefinition)))return{extent:this.raster.getTileExtentFromTileInfo(S,
Z,X,M.tileInfo||O.storageInfo.tileInfo),pixelBlock:null};yield this._initJobHandler();yield this.updateRasterFunction();"raster-shaded-relief"===this.renderer.type&&(M={...M,buffer:{cols:1,rows:1}});return this.raster.fetchTile(S,Z,X,M)});return function(S,Z,X){return L.apply(this,arguments)}}();z.fetchPixels=function(){var L=D._asyncToGenerator(function*(S,Z,X,M={}){if(N.isSome(this.rasterInfo.multidimensionalInfo)&&(M=this.normalizeRasterFetchOptions(M),N.isNone(M.multidimensionalDefinition)))return{extent:S,
pixelBlock:null};yield this._initJobHandler();yield this.updateRasterFunction();return this.raster.fetchPixels(S,Z,X,M)});return function(S,Z,X){return L.apply(this,arguments)}}();z.identify=function(){var L=D._asyncToGenerator(function*(S,Z={}){const {raster:X,rasterInfo:M}=this;if(N.isSome(M.multidimensionalInfo)&&(!M.hasMultidimensionalTranspose||!(x.isMultiSliceOrRangeDefinition(Z.multidimensionalDefinition)||Z.transposedVariableName||Z.timeExtent))&&(Z=this.normalizeRasterFetchOptions(Z),N.isNone(Z.multidimensionalDefinition)))return{location:S,
value:null};const O=this.multidimensionalSubset?.areaOfInterest;if(O&&!O.contains(S))throw new U("imagery-tile-mixin:identify","the request cannot be fulfilled when falling outside of the multidimensional subset");return X.identify(S,Z)});return function(S){return L.apply(this,arguments)}}();z.increaseRasterJobHandlerUsage=function(){this._rasterJobHandler.refCount++};z.decreaseRasterJobHandlerUsage=function(){this._rasterJobHandler.refCount--;0>=this._rasterJobHandler.refCount&&this._shutdownJobHandler()};
z.hasStandardTime=function(){const L=this.rasterInfo?.multidimensionalInfo;if(N.isNone(L)||"standard-time"!==this.rasterInfo?.dataType)return!1;const S=this.multidimensionalDefinition,Z=S?.[0]?.variableName;return L.variables.some(X=>X.name===Z&&(!S?.[0].dimensionName||X.dimensions.some(M=>"StdTime"===M.name)))};z.getStandardTimeValue=function(L){return(new Date(864E5*(L-25569))).toString()};z.getMultidimensionalSubsetVariables=function(L){return x.getSubsetVariablesFromMdInfo(this.multidimensionalSubset,
L??this.rasterInfo?.multidimensionalInfo)};z._configDefaultSettings=function(){this._configDefaultInterpolation();this.multidimensionalDefinition||(this.multidimensionalDefinition=x.getDefaultMultidimensionalDefinition(this.raster.rasterInfo,{multidimensionalSubset:this.multidimensionalSubset}));this._configDefaultRenderer()};z._initJobHandler=function(){if(null!=this._rasterJobHandler.connectionPromise)return this._rasterJobHandler.connectionPromise;const L=new J;this._rasterJobHandler.connectionPromise=
L.initialize().then(()=>{G(this);this._rasterJobHandler.instance=L;this.raster.rasterJobHandler=L;this.renderer&&this.updateRenderer();"Function"===this.raster.datasetFormat&&this.raster.syncJobHandler()}).catch(()=>{});return this._rasterJobHandler.connectionPromise};z._shutdownJobHandler=function(){this._rasterJobHandler.instance&&this._rasterJobHandler.instance.destroy();this._rasterJobHandler.instance=null;this._rasterJobHandler.connectionPromise=null;this._rasterJobHandler.refCount=0;this._cachedRendererJson=
null;this.raster&&(this.raster.rasterJobHandler=null)};z._configDefaultInterpolation=function(){if(null==this.interpolation){G(this);var {raster:L}=this;L=a.getDefaultInterpolation(L.rasterInfo,L.tileType,this.sourceJSON?.defaultResamplingMethod);this._set("interpolation",L)}};z._configDefaultRenderer=function(L="no"){G(this);var {rasterInfo:S}=this.raster;!this.bandIds&&1<S.bandCount&&(this.bandIds=a.getDefaultBandCombination(S));var Z=x.getDefaultVariablInfo(S,{multidimensionalDefinition:this.multidimensionalDefinition,
multidimensionalSubset:this.multidimensionalSubset})?.name;if(!this.renderer||"override"===L){var X=a.createDefaultRenderer(S,{bandIds:this.bandIds,variableName:Z});"WCSServer"===this.raster.datasetFormat&&"raster-stretch"===X.type&&(1E24<(S.statistics?.[0].max??0)||-1E24>(S.statistics?.[0].min??0))&&(X.dynamicRangeAdjustment=!0,X.statistics=null,"none"===X.stretchType&&(X.stretchType="min-max"));this.renderer=X}X=a.normalizeRendererJSON({...this.renderer.toJSON(),variableName:Z});S=a.getVariableRasterInfo(S,
Z);this.symbolizer?(this.symbolizer.rendererJSON=X,this.symbolizer.rasterInfo=S):this.symbolizer=new e({rendererJSON:X,rasterInfo:S});S=this.symbolizer.bind();S.success?"auto"===L&&({colormap:S}=this.raster.rasterInfo,L=this.renderer,N.isSome(S)?"raster-colormap"!==L.type?this._configDefaultRenderer("override"):(S=a.createDefaultRenderer(this.raster.rasterInfo),JSON.stringify(S)!==JSON.stringify(L)&&this._configDefaultRenderer("override")):"raster-stretch"===L.type&&(S=this.bandIds?.length,Z=L.statistics?.length,
!L.dynamicRangeAdjustment&&Z&&S&&Z!==S&&this._configDefaultRenderer("override"))):(w.warn("imagery-tile-mixin",S.error||"The given renderer is not supported by the layer."),"auto"===L&&this._configDefaultRenderer("override"))};D._createClass(u,[{key:"fullExtent",get:function(){return this.rasterInfo?.extent}},{key:"multidimensionalDefinition",set:function(L){this._set("multidimensionalDefinition",L);this.updateRenderer()}},{key:"tileInfo",get:function(){return this.rasterInfo?.storageInfo.tileInfo}},
{key:"url",set:function(L){this._set("url",c.sanitizeUrl(L,w))}},{key:"renderer",set:function(L){this._set("renderer",L);this.updateRenderer()}}]);return u}(y);F.__decorate([B.property()],y.prototype,"_cachedRendererJson",void 0);F.__decorate([B.property()],y.prototype,"_cachedRasterFunctionJson",void 0);F.__decorate([B.property()],y.prototype,"_compatibleFullExtent",void 0);F.__decorate([B.property()],y.prototype,"_isConstructedFromFunctionRaster",void 0);F.__decorate([B.property()],y.prototype,
"_rasterJobHandler",void 0);F.__decorate([B.property()],y.prototype,"bandIds",void 0);F.__decorate([B.property({json:{origins:{service:{read:{source:"copyrightText"}}}}})],y.prototype,"copyright",void 0);F.__decorate([B.property({json:{read:!1}})],y.prototype,"fullExtent",null);F.__decorate([B.property()],y.prototype,"interpolation",void 0);F.__decorate([B.property()],y.prototype,"ioConfig",void 0);F.__decorate([B.property({type:[h],json:{write:!0}})],y.prototype,"multidimensionalDefinition",null);
F.__decorate([B.property({type:r,json:{write:!0}})],y.prototype,"multidimensionalSubset",void 0);F.__decorate([B.property()],y.prototype,"raster",void 0);F.__decorate([B.property({type:E})],y.prototype,"rasterFunction",void 0);F.__decorate([B.property()],y.prototype,"rasterInfo",void 0);F.__decorate([B.property()],y.prototype,"sourceJSON",void 0);F.__decorate([B.property({readOnly:!0,type:v,json:{read:!1}})],y.prototype,"spatialReference",void 0);F.__decorate([B.property({json:{read:!1}})],y.prototype,
"tileInfo",null);F.__decorate([B.property(m.url)],y.prototype,"url",null);F.__decorate([B.property({types:p.rasterRendererTypes})],y.prototype,"renderer",null);F.__decorate([B.property()],y.prototype,"symbolizer",void 0);return y=F.__decorate([k.subclass("esri.layers.ImageryTileMixin")],y)};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/DimensionalDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(P,D,F,I,p,R,U){var H;F=H=function(N){function B(l){l=N.call(this,l)||this;l.variableName=null;l.dimensionName=null;l.values=[];l.isSlice=!1;return l}P._inheritsLoose(B,N);B.prototype.clone=function(){return new H({variableName:this.variableName,dimensionName:this.dimensionName,values:I.clone(this.values),isSlice:this.isSlice})};return B}(F.JSONSupport);D.__decorate([p.property({type:String,json:{write:!0}})],F.prototype,"variableName",void 0);D.__decorate([p.property({type:String,json:{write:!0}})],
F.prototype,"dimensionName",void 0);D.__decorate([p.property({type:R.types.array(R.types.oneOf([R.types.native(Number),R.types.array(R.types.native(Number))])),json:{write:!0}})],F.prototype,"values",void 0);D.__decorate([p.property({type:Boolean,json:{write:!0}})],F.prototype,"isSlice",void 0);return F=H=D.__decorate([U.subclass("esri.layers.support.DimensionalDefinition")],F)})},"esri/layers/support/MultidimensionalSubset":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass ../../geometry/Extent ../../geometry/Polygon ../../geometry/support/jsonUtils ./DimensionalDefinition ../../geometry/Geometry".split(" "),
function(P,D,F,I,p,R,U,H,N,B,l,b,k){var f;F={base:k,key:"type",typeMap:{extent:N,polygon:B}};I=f=function(c){function m(h){h=c.call(this,h)||this;h.areaOfInterest=null;h.subsetDefinitions=null;return h}P._inheritsLoose(m,c);m.prototype.clone=function(){const h=this.subsetDefinitions?.map(E=>E.clone()),r=this.areaOfInterest?this.areaOfInterest.clone():this.areaOfInterest;return new f({areaOfInterest:r,subsetDefinitions:h})};P._createClass(m,[{key:"dimensions",get:function(){var {subsetDefinitions:h}=
this;if(null==h||0===h.length)return[];const r=new Map;h.forEach(E=>{if(E.dimensionName){if(Array.isArray(E.values[0])){var J=E.values;var d=J[0][0];J=J[E.values.length-1][1]}else J=E.values,d=J[0],J=J[E.values.length-1];r.has(E.dimensionName)?(E=r.get(E.dimensionName),E[0]=Math.min(d,E[0]),E[1]=Math.max(J,E[1])):r.set(E.dimensionName,[d,J])}});h=[];for(const E of r)h.push({name:E[0],extent:E[1]});return h}},{key:"variables",get:function(){const {subsetDefinitions:h}=this;if(null==h||0===h.length)return[];
const r=new Set;h.forEach(E=>{E.variableName&&r.add(E.variableName)});return[...r]}}]);return m}(I.JSONSupport);D.__decorate([p.property({types:F,json:{read:l.fromJSON,write:!0}})],I.prototype,"areaOfInterest",void 0);D.__decorate([p.property({readOnly:!0})],I.prototype,"dimensions",null);D.__decorate([p.property({readOnly:!0})],I.prototype,"variables",null);D.__decorate([p.property({type:[b],json:{write:!0}})],I.prototype,"subsetDefinitions",void 0);return I=f=D.__decorate([H.subclass("esri.layers.support.MultidimensionalSubset")],
I)})},"esri/layers/support/RasterFunction":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer".split(" "),function(P,D,F,I,p,R,U,H,N,B){var l;const b=new Set(["raster",
"raster2","dem","fillraster"]),k=new Set(["rasters"]),f=r=>r&&r.rasterFunction?h.fromJSON(r):r,c=r=>r&&r instanceof h?r.toJSON():r,m=r=>r?.functionName&&!r.declaredClass?new h(r):r;let h=l=function(r){function E(d){d=r.call(this,d)||this;d.functionName=null;d.outputPixelType="unknown";d.variableName=null;d.rasterFunctionDefinition=null;return d}P._inheritsLoose(E,r);var J=E.prototype;J.readFunctionArguments=function(d){if(null==d)var n=null;else{d=I.clone(d);var x={};for(n of Object.keys(d))b.has(n.toLowerCase())?
x[n]=f(d[n]):k.has(n.toLowerCase())&&Array.isArray(d[n])?x[n]=d[n].map(f):x[n]=d[n];n=x}return n};J.writeFunctionArguments=function(d,n,x){const q={};for(const g of Object.keys(d))b.has(g.toLowerCase())?q[g]=c(d[g]):k.has(g.toLowerCase())&&Array.isArray(d[g])?q[g]=d[g].map(c):q[g]=c(d[g]);n[x]=q};J.readFunctionName=function(d,n){d=n.rasterFunctionInfos;const x=n.name;return x?x:d&&d.length&&"None"!==d[0].name?d[0].name:n.rasterFunctionDefinition?n.rasterFunctionDefinition.name:n.rasterFunction};J.clone=
function(){return new l({functionName:this.functionName,functionArguments:I.clone(this.functionArguments),outputPixelType:this.outputPixelType,variableName:this.variableName,rasterFunctionDefinition:I.clone(this.rasterFunctionDefinition)})};P._createClass(E,[{key:"functionArguments",set:function(d){if(d){const n=Object.keys(d);if(n.some(x=>{var q;if(q=b.has(x.toLowerCase()))x=d[x],q=x?.functionName&&!x.declaredClass;return q})||n.some(x=>k.has(x.toLowerCase())&&Array.isArray(d[x])&&d[x].some(q=>q?.functionName&&
!q.declaredClass))){d=I.clone(d);for(const x of n)b.has(x.toLowerCase())?d[x]=m(d[x]):k.has(x.toLowerCase())&&Array.isArray(d[x])&&(d[x]=d[x].map(q=>m(q)))}}this._set("functionArguments",d)}}]);return E}(F.JSONSupport);D.__decorate([p.property({json:{type:Object,name:"rasterFunctionArguments"}})],h.prototype,"functionArguments",null);D.__decorate([H.reader("functionArguments")],h.prototype,"readFunctionArguments",null);D.__decorate([B.writer("functionArguments")],h.prototype,"writeFunctionArguments",
null);D.__decorate([p.property({json:{type:String,write:{target:"rasterFunction"}}})],h.prototype,"functionName",void 0);D.__decorate([H.reader("functionName",["rasterFunction","rasterFunctionInfos","rasterFunctionDefinition"])],h.prototype,"readFunctionName",null);D.__decorate([U.enumeration({C128:"c128",C64:"c64",F32:"f32",F64:"f64",S16:"s16",S32:"s32",S8:"s8",U1:"u1",U16:"u16",U2:"u2",U32:"u32",U4:"u4",U8:"u8",UNKNOWN:"unknown"},{ignoreUnknown:!1}),p.property({json:{default:"unknown"}})],h.prototype,
"outputPixelType",void 0);D.__decorate([p.property({type:String,json:{read:!0,write:!0}})],h.prototype,"variableName",void 0);D.__decorate([p.property({type:Object,json:{name:"rasterFunctionDefinition"}})],h.prototype,"rasterFunctionDefinition",void 0);return h=l=D.__decorate([N.subclass("esri.layers.support.RasterFunction")],h)})},"esri/layers/support/RasterJobHandler":function(){define(["../../chunks/_rollupPluginBabelHelpers","../../core/Error","../../core/maybe","../../core/workers/workers","./PixelBlock"],
function(P,D,F,I,p){return function(){function R(){this._workerThread=null;this._destroyed=!1}var U=R.prototype;U.initialize=function(){var H=P._asyncToGenerator(function*(){const N=yield I.open("RasterWorker");this._destroyed?N.close():this._workerThread=N});return function(){return H.apply(this,arguments)}}();U.destroy=function(){this._destroyed=!0;this._workerThread&&(this._workerThread.close(),this._workerThread=null)};U.convertVectorFieldData=function(){var H=P._asyncToGenerator(function*(N,
B){if(!this._workerThread)throw new D("raster-jobhandler:no-connection","no available worker connection");return(N=yield this._workerThread.invoke("convertVectorFieldData",{pixelBlock:N.pixelBlock.toJSON(),type:N.dataType},B))?new p(N):null});return function(N,B){return H.apply(this,arguments)}}();U.decode=function(){var H=P._asyncToGenerator(function*(N,B){if(!this._workerThread)throw new D("raster-jobhandler:no-connection","no available worker connection");return(N=yield this._workerThread.invoke("decode",
N,B))?new p(N):null});return function(N,B){return H.apply(this,arguments)}}();U.symbolize=function(){var H=P._asyncToGenerator(function*(N,B){if(!this._workerThread)throw new D("raster-jobhandler:no-connection","no available worker connection");N={extent:N.extent&&N.extent.toJSON(),pixelBlock:F.isSome(N.pixelBlock)&&N.pixelBlock.toJSON(),simpleStretchParams:N.simpleStretchParams,bandIds:N.bandIds};return(B=yield this._workerThread.invoke("symbolize",N,B))?new p(B):null});return function(N,B){return H.apply(this,
arguments)}}();U.updateSymbolizer=function(){var H=P._asyncToGenerator(function*(N,B){if(!this._workerThread)throw new D("raster-jobhandler:no-connection","no available worker connection");const l=N?.rendererJSON?.histograms;yield Promise.all(this._workerThread.broadcast("updateSymbolizer",{symbolizerJSON:N.toJSON(),histograms:l},B))});return function(N,B){return H.apply(this,arguments)}}();U.updateRasterFunction=function(){var H=P._asyncToGenerator(function*(N,B){if(!this._workerThread)throw new D("raster-jobhandler:no-connection",
"no available worker connection");yield Promise.all(this._workerThread.broadcast("updateRasterFunction",{rasterFunctionJSON:N.toJSON()},B))});return function(N,B){return H.apply(this,arguments)}}();U.process=function(){var H=P._asyncToGenerator(function*(N,B){if(!this._workerThread)throw new D("raster-jobhandler:no-connection","no available worker connection");return(N=yield this._workerThread.invoke("process",{extent:N.extent?.toJSON(),primaryPixelBlocks:N.primaryPixelBlocks.map(l=>F.isSome(l)?l.toJSON():
null),primaryRasterIds:N.primaryRasterIds},B))?new p(N):null});return function(N,B){return H.apply(this,arguments)}}();U.stretch=function(){var H=P._asyncToGenerator(function*(N,B){if(!this._workerThread)throw new D("raster-jobhandler:no-connection","no available worker connection");if(!N?.pixelBlock)return null;N={srcPixelBlock:N.pixelBlock.toJSON(),stretchParams:N.stretchParams};return(B=yield this._workerThread.invoke("stretch",N,B))?new p(B):null});return function(N,B){return H.apply(this,arguments)}}();
U.split=function(){var H=P._asyncToGenerator(function*(N,B){if(!this._workerThread)throw new D("raster-jobhandler:no-connection","no available worker connection");if(!N?.pixelBlock)return null;N={srcPixelBlock:N.pixelBlock.toJSON(),tileSize:N.tileSize,maximumPyramidLevel:N.maximumPyramidLevel};const l=yield this._workerThread.invoke("split",N,B);l&&l.forEach((b,k)=>{l.set(k,b?p.fromJSON(b):null)});return l});return function(N,B){return H.apply(this,arguments)}}();U.estimateStatisticsHistograms=function(){var H=
P._asyncToGenerator(function*(N,B){if(!this._workerThread)throw new D("raster-jobhandler:no-connection","no available worker connection");if(!N?.pixelBlock)return null;N={srcPixelBlock:N.pixelBlock.toJSON()};return yield this._workerThread.invoke("estimateStatisticsHistograms",N,B)});return function(N,B){return H.apply(this,arguments)}}();U.mosaicAndTransform=function(){var H=P._asyncToGenerator(function*(N,B){if(!this._workerThread)throw new D("raster-jobhandler:no-connection","no available worker connection");
if(!N?.srcPixelBlocks?.length)return{pixelBlock:null};N={...N,srcPixelBlocks:N.srcPixelBlocks.map(l=>F.isSome(l)?l.toJSON():null)};B=yield this._workerThread.invoke("mosaicAndTransform",N,B);return{pixelBlock:B.pixelBlock?new p(B.pixelBlock):null,localNorthDirections:B.localNorthDirections}});return function(N,B){return H.apply(this,arguments)}}();U.createFlowMesh=function(){var H=P._asyncToGenerator(function*(N,B){if(!this._workerThread)throw new D("raster-jobhandler:no-connection","no available worker connection");
const l={buffer:N.flowData.data.buffer,maskBuffer:N.flowData.mask.buffer,width:N.flowData.width,height:N.flowData.height},{meshType:b,simulationSettings:k}=N;N=yield this._workerThread.invoke("createFlowMesh",{meshType:b,flowData:l,simulationSettings:k},{...B,transferList:[l.buffer,l.maskBuffer]});return{vertexData:new Float32Array(N.vertexBuffer),indexData:new Uint32Array(N.indexBuffer)}});return function(N,B){return H.apply(this,arguments)}}();U.getProjectionOffsetGrid=function(H,N){if(!this._workerThread)throw new D("raster-jobhandler:no-connection",
"no available worker connection");const B=F.isSome(H.datumTransformation)?H.datumTransformation.steps.map(b=>({wkid:b.wkid,wkt:b.wkt,isInverse:b.isInverse})):null,l=F.isSome(H.rasterTransform)?H.rasterTransform.toJSON():null;H={projectedExtent:H.projectedExtent.toJSON(),srcBufferExtent:H.srcBufferExtent.toJSON(),pixelSize:H.pixelSize,hasWrapAround:H.hasWrapAround,spacing:H.spacing,datumTransformationSteps:B,rasterTransform:l,isAdaptive:H.isAdaptive,includeGCSGrid:H.includeGCSGrid};return this._workerThread.invoke("getProjectionOffsetGrid",
H,N)};return R}()})},"esri/layers/support/TileInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/maybe ../../core/unitUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../geometry/Point ../../geometry/SpatialReference ../../geometry/support/aaBoundingRect ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ./LOD ./TileKey".split(" "),
function(P,D,F,I,p,R,U,H,N,B,l,b,k,f,c,m,h,r,E){var J;F=new F.JSONMap({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});I=J=function(d){function n(q){q=d.call(this,q)||this;q.dpi=96;q.format=null;q.origin=null;q.minScale=0;q.maxScale=0;q.size=null;q.spatialReference=null;return q}P._inheritsLoose(n,d);n.create=function(q=
{}){const {resolutionFactor:g=1,scales:a,size:e=256,spatialReference:t=f.WebMercator,numLODs:v=24}=q;if(!m.isValid(t)){q=[];if(a)for(var w=0;w<a.length;w++){var y=a[w];q.push(new r({level:w,scale:y,resolution:y}))}else for(w=5E-4,y=v-1;0<=y;y--)q.unshift(new r({level:y,scale:w,resolution:w})),w*=2;return new J({dpi:96,lods:q,origin:new k(0,0,t),size:[e,e],spatialReference:t})}w=m.getInfo(t);q=q.origin?new k({x:q.origin.x,y:q.origin.y,spatialReference:t}):w?new k({x:w.origin[0],y:w.origin[1],spatialReference:t}):
new k({x:0,y:0,spatialReference:t});w=1/(39.37*R.getMetersPerUnitForSR(t)*96);y=[];if(a)for(var G=0;G<a.length;G++){var C=a[G];y.push(new r({level:G,scale:C,resolution:C*w}))}else{var u=m.isGeographic(t)?512/e*5.916575275917094E8:256/e*5.91657527591555E8;G=Math.ceil(v/g);y.push(new r({level:0,scale:u,resolution:u*w}));for(C=1;C<G;C++)u/=2**g,y.push(new r({level:C,scale:u,resolution:u*w}))}return new J({dpi:96,lods:y,origin:q,size:[e,e],spatialReference:t})};var x=n.prototype;x.readOrigin=function(q,
g){return k.fromJSON({spatialReference:g.spatialReference,...q})};x.readSize=function(q,g){return[g.cols,g.rows]};x.writeSize=function(q,g){g.cols=q[0];g.rows=q[1]};x.zoomToScale=function(q){const g=this.scales;if(0>=q)return g[0];if(q>=g.length-1)return g[g.length-1];const a=Math.floor(q);return g[a]/(g[a]/g[a+1])**(q-a)};x.scaleToZoom=function(q){const g=this.scales,a=g.length-1;let e=0;for(;e<a;e++){const t=g[e],v=g[e+1];if(t<=q)break;if(v===q)return e+1;if(t>q&&v<q)return e+Math.log(t/q)/Math.log(t/
v)}return e};x.snapScale=function(q,g=.95){q=this.scaleToZoom(q);return q%Math.floor(q)>=g?this.zoomToScale(Math.ceil(q)):this.zoomToScale(Math.floor(q))};x.tileAt=function(q,g,a,e){var t=this.lodAt(q);if(!t)return null;let v;if("number"===typeof g)v=g,g=a;else{if(m.equals(g.spatialReference,this.spatialReference))v=g.x,g=g.y;else{e=h.project(g,this.spatialReference);if(p.isNone(e))return null;v=e.x;g=e.y}e=a}a=t.resolution*this.size[0];t=t.resolution*this.size[1];e||(e=new E.TileKey(null,0,0,0,c.create()));
e.level=q;e.row=Math.floor((this.origin.y-g)/t+.001);e.col=Math.floor((v-this.origin.x)/a+.001);this.updateTileInfo(e);return e};x.updateTileInfo=function(q,g=J.ExtrapolateOptions.NONE){var a=this.lodAt(q.level);a||g!==J.ExtrapolateOptions.POWER_OF_TWO||(g=this.lods[this.lods.length-1],g.level<q.level&&(a=g));if(a){var e=q.level-a.level;g=a.resolution*this.size[0]/2**e;a=a.resolution*this.size[1]/2**e;q.id=`${q.level}/${q.row}/${q.col}`;q.extent||(q.extent=c.create());q.extent[0]=this.origin.x+q.col*
g;q.extent[1]=this.origin.y-(q.row+1)*a;q.extent[2]=q.extent[0]+g;q.extent[3]=q.extent[1]+a}};x.upsampleTile=function(q){const g=this._upsampleLevels[q.level];if(!g||-1===g.parentLevel)return!1;q.level=g.parentLevel;q.row=Math.floor(q.row/g.factor+.001);q.col=Math.floor(q.col/g.factor+.001);this.updateTileInfo(q);return!0};x.getTileBounds=function(q,g){var a=this.lodAt(g.level);if(null==a)return null;var {resolution:e}=a;a=e*this.size[0];e*=this.size[1];q[0]=this.origin.x+g.col*a;q[1]=this.origin.y-
(g.row+1)*e;q[2]=q[0]+a;q[3]=q[1]+e;return q};x.lodAt=function(q){return this._levelToLOD?.[q]??null};x.clone=function(){return J.fromJSON(this.write({}))};x.getOrCreateCompatible=function(q,g){if(256===this.size[0]&&256===this.size[1])return 256===q?this:null;const a=[],e=this.lods.length;for(let t=0;t<e;t++){const v=this.lods[t];a.push(new r({level:v.level,scale:v.scale,resolution:v.resolution*g}))}return new J({size:[q,q],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,
origin:this.origin,spatialReference:this.spatialReference,lods:a})};x._initializeUpsampleLevels=function(){const q=this.lods;this._upsampleLevels=[];let g=null;for(let a=0;a<q.length;a++){const e=q[a];this._upsampleLevels[e.level]={parentLevel:g?g.level:-1,factor:g?g.resolution/e.resolution:0};g=e}};P._createClass(n,[{key:"isWrappable",get:function(){const {spatialReference:q,origin:g}=this;if(q&&g){const a=m.getInfo(q);return q.isWrappable&&!!a&&Math.abs(a.origin[0]-g.x)<=a.dx}return!1}},{key:"lods",
set:function(q){let g=0,a=0;const e=[],t=this._levelToLOD={};q&&(g=-Infinity,a=Infinity,q.forEach(v=>{e.push(v.scale);g=v.scale>g?v.scale:g;a=v.scale<a?v.scale:a;t[v.level]=v}));this._set("scales",e);this._set("minScale",g);this._set("maxScale",a);this._set("lods",q);this._initializeUpsampleLevels()}}]);return n}(I.JSONSupport);D.__decorate([U.property({type:Number,json:{write:!0}})],I.prototype,"compressionQuality",void 0);D.__decorate([U.property({type:Number,json:{write:!0}})],I.prototype,"dpi",
void 0);D.__decorate([U.property({type:String,json:{read:F.read,write:F.write,origins:{"web-scene":{read:!1,write:!1}}}})],I.prototype,"format",void 0);D.__decorate([U.property({readOnly:!0})],I.prototype,"isWrappable",null);D.__decorate([U.property({type:k,json:{write:!0}})],I.prototype,"origin",void 0);D.__decorate([B.reader("origin")],I.prototype,"readOrigin",null);D.__decorate([U.property({type:[r],value:null,json:{write:!0}})],I.prototype,"lods",null);D.__decorate([U.property({readOnly:!0})],
I.prototype,"minScale",void 0);D.__decorate([U.property({readOnly:!0})],I.prototype,"maxScale",void 0);D.__decorate([U.property({readOnly:!0})],I.prototype,"scales",void 0);D.__decorate([U.property({cast:d=>Array.isArray(d)?d:"number"===typeof d?[d,d]:[256,256]})],I.prototype,"size",void 0);D.__decorate([B.reader("size",["rows","cols"])],I.prototype,"readSize",null);D.__decorate([b.writer("size",{cols:{type:H.Integer},rows:{type:H.Integer}})],I.prototype,"writeSize",null);D.__decorate([U.property({type:f,
json:{write:!0}})],I.prototype,"spatialReference",void 0);I=J=D.__decorate([l.subclass("esri.layers.support.TileInfo")],I);(function(d){d=d.ExtrapolateOptions||(d.ExtrapolateOptions={});d[d.NONE=0]="NONE";d[d.POWER_OF_TWO=1]="POWER_OF_TWO"})(I||(I={}));return I})},"esri/layers/support/LOD":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass".split(" "),
function(P,D,F,I,p,R,U){var H;F=H=function(N){function B(l){l=N.call(this,l)||this;l.cols=null;l.level=0;l.levelValue=null;l.origin=null;l.resolution=0;l.rows=null;l.scale=0;return l}P._inheritsLoose(B,N);B.prototype.clone=function(){return new H({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})};return B}(F.JSONSupport);D.__decorate([I.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,
write:!1}}}})],F.prototype,"cols",void 0);D.__decorate([I.property({type:p.Integer,json:{write:!0}})],F.prototype,"level",void 0);D.__decorate([I.property({type:String,json:{write:!0}})],F.prototype,"levelValue",void 0);D.__decorate([I.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],F.prototype,"origin",void 0);D.__decorate([I.property({type:Number,json:{write:!0}})],F.prototype,"resolution",void 0);D.__decorate([I.property({json:{write:!0,
origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],F.prototype,"rows",void 0);D.__decorate([I.property({type:Number,json:{write:!0}})],F.prototype,"scale",void 0);return F=H=D.__decorate([U.subclass("esri.layers.support.LOD")],F)})},"esri/layers/support/TileKey":function(){define(["exports"],function(P){P.TileKey=function(D,F,I,p,R){this.id=D;this.level=F;this.row=I;this.col=p;this.extent=R};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/FunctionRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Error ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ./BaseRaster".split(" "),
function(P,D,F,I,p,R,U,H,N){R=function(B){function l(){var k=B.apply(this,arguments)||this;k.datasetFormat="Function";k.tileType="Raster";k.rasterFunction=null;return k}P._inheritsLoose(l,B);var b=l.prototype;b.open=function(){var k=P._asyncToGenerator(function*(f){yield this.init();const {rasterFunction:c}=this;this.primaryRasters?.rasters?.length?c.sourceRasters=this.primaryRasters.rasters:this.primaryRasters=c.getPrimaryRasters();const {rasters:m,rasterIds:h}=this.primaryRasters;var r=m.map(d=>
d.rasterInfo?void 0:d.open(f));yield Promise.all(r);r=m.map(({rasterInfo:d})=>d);const E=c.bind({rasterInfos:r,rasterIds:h});if(!E.success||0===r.length)throw new F("raster-function:open",`cannot bind the function: ${E.error??""}`);yield this.syncJobHandler();const J=r[0];this.hasUniqueSourceStorageInfo=1===r.length||r.slice(1).every(d=>this._hasSameStorageInfo(d,J));this.set("sourceJSON",m[0].sourceJSON);this.set("rasterInfo",c.rasterInfo)});return function(f){return k.apply(this,arguments)}}();
b.syncJobHandler=function(){var k=P._asyncToGenerator(function*(){return this.rasterJobHandler?.updateRasterFunction(this.rasterFunction)});return function(){return k.apply(this,arguments)}}();b.fetchPixels=function(){var k=P._asyncToGenerator(function*(f,c,m,h={}){const {rasters:r,rasterIds:E}=this.primaryRasters;var J=r.map(x=>x.fetchPixels(f,c,m,h));J=yield Promise.all(J);var d=J.map(x=>x.pixelBlock);if(h.skipRasterFunction||d.every(x=>I.isNone(x)))return J[0];const n=J.find(x=>I.isSome(x.pixelBlock))?.extent??
f;d=this.rasterJobHandler?yield this.rasterJobHandler.process({extent:n,primaryPixelBlocks:d,primaryRasterIds:E}):this.rasterFunction.process({extent:n,primaryPixelBlocks:d,primaryRasterIds:E});return{...J[0],pixelBlock:d}});return function(f,c,m){return k.apply(this,arguments)}}();b._hasSameStorageInfo=function(k,f){const {storageInfo:c,pixelSize:m,spatialReference:h,extent:r}=k,{storageInfo:E,pixelSize:J,spatialReference:d,extent:n}=f;return m.x===J.x&&m.y===J.y&&h.equals(d)&&r.equals(n)&&c.blockHeight===
E.blockHeight&&c.blockWidth===E.blockWidth&&c.maximumPyramidLevel===E.maximumPyramidLevel};return l}(N);D.__decorate([p.property({type:String,json:{write:!0}})],R.prototype,"datasetFormat",void 0);D.__decorate([p.property()],R.prototype,"tileType",void 0);D.__decorate([p.property()],R.prototype,"rasterFunction",void 0);D.__decorate([p.property()],R.prototype,"primaryRasters",void 0);return R=D.__decorate([H.subclass("esri.layers.support.rasterDatasets.FunctionRaster")],R)})},"esri/layers/support/rasterDatasets/BaseRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../request ../../../core/Error ../../../core/JSONSupport ../../../core/Logger ../../../core/maybe ../../../core/Promise ../../../core/promiseUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ../arcgisLayerUrl ../commonProperties ../DimensionalDefinition ../LOD ../RasterStorageInfo ../TileInfo ./multidimensionalUtils ./RawBlockCache ../rasterFormats/pixelRangeUtils ../rasterFormats/RasterCodec ../rasterFunctions/pixelUtils ../rasterFunctions/rasterProjectionHelper ../rasterFunctions/vectorFieldUtils ../../../geometry/Point ../../../geometry/Extent".split(" "),
function(P,D,F,I,p,R,U,H,N,B,l,b,k,f,c,m,h,r,E,J,d,n,x,q,g,a,e,t,v){F=function(w){function y(){var C=w.apply(this,arguments)||this;C.rasterJobHandler=null;C.datasetName=null;C.datasetFormat=null;C.hasUniqueSourceStorageInfo=!0;C.rasterInfo=null;C.ioConfig={sampling:"closest"};return C}P._inheritsLoose(y,w);var G=y.prototype;G.init=function(){var C=P._asyncToGenerator(function*(){const u=a.load();this.addResolvingPromise(u);yield this.when()});return function(){return C.apply(this,arguments)}}();G.normalizeCtorArgs=
function(C){C&&C.ioConfig&&(C={...C,ioConfig:{resolution:null,bandIds:null,sampling:"closest",tileInfo:J.create(),...C.ioConfig}});return C};G.open=function(){var C=P._asyncToGenerator(function*(u){throw new p("BaseRaster:open-not-implemented","open() is not implemented");});return function(u){return C.apply(this,arguments)}}();G.fetchTile=function(){var C=P._asyncToGenerator(function*(u,z,L,S={}){const Z=S.tileInfo||this.rasterInfo.storageInfo.tileInfo;u=this.getTileExtentFromTileInfo(u,z,L,Z);return this.fetchPixels(u,
Z.size[0],Z.size[1],S)});return function(u,z,L){return C.apply(this,arguments)}}();G.identify=function(){var C=P._asyncToGenerator(function*(u,z={}){u=b.ensureClass(t,u).clone().normalize();const {multidimensionalDefinition:L,timeExtent:S}=z;var {rasterInfo:Z}=this;const {hasMultidimensionalTranspose:X,multidimensionalInfo:M}=Z;var {transposedVariableName:O}=z,A=H.isSome(M)&&X&&(null!=S||d.isMultiSliceOrRangeDefinition(L));A&&!O&&(O=H.isSome(L)&&0<L.length?L[0].variableName??void 0:M.variables[0].name,
z={...z,transposedVariableName:O});z=this._getRequestOptionsWithSliceId(z);const {spatialReference:Q,extent:Y}=Z;var {datumTransformation:W}=z;W=a.projectPoint(u,Q,W);if(!Y.intersects(W)||H.isSome(Z.transform)&&(W=Z.transform.inverseTransform(W),!Z.nativeExtent.intersects(W)))return{location:W,value:null};let T=0;var K=H.isSome(O)&&H.isSome(M)&&Z.hasMultidimensionalTranspose;if("Function"===this.datasetFormat){A=this.primaryRasters.rasters[0];if(K)return A.identify(W,z);({pixelSize:K}=Z);z=3*K.x/
2;K=3*K.y/2;z=new v({xmin:W.x-z,xmax:W.x+z,ymin:W.y-K,ymax:W.y+K,spatialReference:Q});K={interpolation:"nearest"};({pixelBlock:A}=yield A.fetchPixels(z,3,3,K));({pixelBlock:z}=yield this.fetchPixels(z,3,3,K));if(H.isNone(A))return{location:W,value:null};A=!A.mask||A.mask[4]?A.pixels.map(ma=>ma[4]):null;var V;H.isSome(z)&&(V=!z.mask||z.mask[4]?z.pixels.map(ma=>ma[4]):void 0);return{location:W,value:A,processedValue:V,pyramidLevel:0}}if(!K)if(z.srcResolution)T=a.snapPyramid(z.srcResolution,Z,this.ioConfig.sampling).pyramidLevel;
else if(T=yield this.computeBestPyramidLevelForLocation(u,z),null==T)return{location:W,value:null};V=this.identifyPixelLocation(W,T,null,K);if(null===V)return{location:W,value:null};const {row:ba,col:aa,rowOffset:ea,colOffset:ja,blockWidth:ha}=V;V=O??H.unwrap(z.sliceId);V=n.getRasterId(this.url,V);Z=`${T}/${ba}/${aa}`;O=n.getBlock(V,null,Z);H.isNone(O)&&(O=this.fetchRawTile(T,ba,aa,z),n.putBlock(V,null,Z,O));V=yield O;return H.isNone(V)||!V.pixels?.length?{location:W,value:null}:this._processIdentifyResult(V,
{srcLocation:W,position:ea*ha+ja,pyramidLevel:T,useTransposedTile:!!K,requestSomeSlices:A,identifyOptions:z})});return function(u){return C.apply(this,arguments)}}();G.fetchPixels=function(){var C=P._asyncToGenerator(function*(u,z,L,S={}){u=a.snapExtent(u);S=this._getRequestOptionsWithSliceId(S);if(S.requestRawData)return this._fetchPixels(u,z,L,S);var Z=a.getWorldWidth(u.spatialReference),X=a.getWorldWrapCount(u);if(H.isNone(Z)||0===X||1===X&&this._isGlobalWrappableSource)return this._fetchPixels(u,
z,L,S);if(3<=X)return{extent:u,pixelBlock:null};const M=[],{xmin:O,xmax:A}=u,Q=Math.round(Z/(A-O)*z),Y=Q-Math.round((Z/2-O)/(A-O)*z);let W=0;const T=[];for(let V=0;V<=X;V++){var K=new v({xmin:0===V?O:-Z/2,xmax:V===X?A-Z*V:Z/2,ymin:u.ymin,ymax:u.ymax,spatialReference:u.spatialReference});const ba=0===V?Q-Y:V===X?z-W:Q;W+=ba;T.push(ba);K=S.disableWrapAround&&0<V?null:this._fetchPixels(K,ba,L,S);M.push(K)}Z=(yield Promise.all(M)).map(V=>V?.pixelBlock);X=null;z={width:z,height:L};X=this.rasterJobHandler?
(yield this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:Z,srcMosaicSize:z,destDimension:null,coefs:null,sampleSpacing:null,interpolation:"nearest",alignmentInfo:null,blockWidths:T},S)).pixelBlock:g.mosaic(Z,z,{blockWidths:T});S=a.projectExtent(u,this.rasterInfo.spatialReference,S.datumTransformation);return{extent:u,srcExtent:S,pixelBlock:X}});return function(u,z,L){return C.apply(this,arguments)}}();G.fetchRawPixels=function(){var C=P._asyncToGenerator(function*(u,z,L,S={}){z={x:Math.floor(z.x),
y:Math.floor(z.y)};const Z=yield this._fetchRawTiles(u,z,L,S),{nativeExtent:X,nativePixelSize:M,storageInfo:O}=this.rasterInfo;var A=2**u,Q=M.x*A;A*=M.y;Q=new v({xmin:X.xmin+Q*z.x,xmax:X.xmin+Q*(z.x+L.width-1),ymin:X.ymax-A*(z.y+L.height-1),ymax:X.ymax-A*z.y,spatialReference:X.spatialReference});if(!Z)return{extent:Q,srcExtent:Q,pixelBlock:null};const {pixelBlocks:Y,mosaicSize:W}=Z;if(1===Y.length&&H.isSome(Y[0])&&Y[0].width===L.width&&Y[0].height===L.height)return{extent:Q,srcExtent:Q,pixelBlock:Z.pixelBlocks[0]};
u={x:z.x%(0<u?O.pyramidBlockWidth:O.blockWidth),y:z.y%(0<u?O.pyramidBlockHeight:O.blockHeight)};L=this.rasterJobHandler?(yield this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:Y,srcMosaicSize:W,destDimension:L,clipOffset:u,clipSize:L,coefs:null,sampleSpacing:null,interpolation:S.interpolation,alignmentInfo:null,blockWidths:null},S)).pixelBlock:g.mosaic(Y,W,{clipOffset:u,clipSize:L});return{extent:Q,srcExtent:Q,pixelBlock:L}});return function(u,z,L){return C.apply(this,arguments)}}();G.fetchRawTile=
function(C,u,z,L){throw new p("BaseRaster:read-not-implemented","fetchRawTile() is not implemented");};G.computeExtent=function(C){return a.projectExtent(this.rasterInfo.extent,C)};G.decodePixelBlock=function(C,u){return!this.rasterJobHandler||u.useCanvas?q.decode(C,u):this.rasterJobHandler.decode({data:C,options:u})};G.request=function(){var C=P._asyncToGenerator(function*(u,z,L=0){const {customFetchParameters:S}=this.ioConfig,{range:Z,query:X,headers:M}=z;L=L??z.retryCount??this.ioConfig.retryCount;
const O=Z?{Range:`bytes=${Z.from}-${Z.to}`}:null;try{return yield I(u,{...z,query:{...X,...S},headers:{...M,...O}})}catch(A){if(0<L)return L--,this.request(u,z,L);throw A;}});return function(u,z){return C.apply(this,arguments)}}();G.getSliceIndex=function(C){const {multidimensionalInfo:u}=this.rasterInfo;return H.isNone(u)||H.isNone(C)||0===C.length?null:d.getSliceIndex(C,u)};G.getTileExtentFromTileInfo=function(C,u,z,L){C=H.unwrapOrThrow(L.lodAt(C));return this.getTileExtent({x:C.resolution,y:C.resolution},
u,z,L.origin,L.spatialReference,L.size)};G.updateTileInfo=function(){const {storageInfo:C,spatialReference:u,extent:z,pixelSize:L}=this.rasterInfo;if(!C.tileInfo){const Z=[];var S=C.maximumPyramidLevel||0;let X=Math.max(L.x,L.y),M=1/.0254*96*X;for(let O=0;O<=S;O++)Z.push(new r({level:S-O,resolution:X,scale:M})),X*=2,M*=2;S=new t({x:z.xmin,y:z.ymax,spatialReference:u});C.tileInfo=new J({origin:S,size:[C.blockWidth,C.blockHeight],spatialReference:u,lods:Z});C.isVirtualTileInfo=!0}};G.createRemoteDatasetStorageInfo=
function(C,u=512,z=512,L){const {width:S,height:Z,nativeExtent:X,pixelSize:M,spatialReference:O}=C,A=new t({x:X.xmin,y:X.ymax,spatialReference:O});null==L&&(L=Math.max(0,Math.round(Math.log(Math.max(S,Z))/Math.LN2-8)));const Q=this.computeBlockBoundary(X,512,512,{x:X.xmin,y:X.ymax},[M],L);C.storageInfo=new E({blockWidth:u,blockHeight:z,pyramidBlockWidth:u,pyramidBlockHeight:z,origin:A,firstPyramidLevel:1,maximumPyramidLevel:L,blockBoundary:Q})};G.computeBestPyramidLevelForLocation=function(){var C=
P._asyncToGenerator(function*(u,z){return 0});return function(u){return C.apply(this,arguments)}}();G.computeBlockBoundary=function(C,u,z,L,S,Z=0,X=2){if(1===S.length&&0<Z){S=[...S];let {x:A,y:Q}=S[0];for(let Y=0;Y<Z;Y++)A*=X,Q*=X,S.push({x:A,y:Q})}Z=[];const {x:M,y:O}=L;for(L=0;L<S.length;L++){const {x:A,y:Q}=S[L];Z.push({minCol:Math.floor((C.xmin-M+.1*A)/u/A),maxCol:Math.floor((C.xmax-M-.1*A)/u/A),minRow:Math.floor((O-C.ymax+.1*Q)/z/Q),maxRow:Math.floor((O-C.ymin-.1*Q)/z/Q)})}return Z};G.getPyramidPixelSize=
function(C){const {nativePixelSize:u}=this.rasterInfo,{pyramidResolutions:z,pyramidScalingFactor:L}=this.rasterInfo.storageInfo;if(0===C)return u;if(H.isSome(z)&&z.length)return z[C-1];C=L**C;return{x:u.x*C,y:u.y*C}};G.identifyPixelLocation=function(C,u,z,L){const {spatialReference:S,nativeExtent:Z,storageInfo:X}=this.rasterInfo,{maximumPyramidLevel:M,origin:O,transposeInfo:A}=X,Q=L&&H.isSome(A)?A.tileSize[0]:X.blockWidth;L=L&&H.isSome(A)?A.tileSize[1]:X.blockHeight;C=a.projectPoint(C,S,z);if(!Z.intersects(C)||
0>u||u>M)return null;z=this.getPyramidPixelSize(u);const {x:Y,y:W}=z;z=(O.y-C.y)/W/L;const T=(C.x-O.x)/Y/Q;return{pyramidLevel:u,row:Math.floor(z),col:Math.floor(T),rowOffset:Math.min(L-1,Math.floor((z-Math.floor(z))*L)),colOffset:Math.min(Q-1,Math.floor((T-Math.floor(T))*Q)),blockWidth:Q,srcLocation:C}};G.getTileExtent=function(C,u,z,L,S,Z){const [X,M]=Z;z=L.x+z*X*C.x;u=L.y-u*M*C.y;return new v({xmin:z,xmax:z+X*C.x,ymin:u-M*C.y,ymax:u,spatialReference:S})};G.getBlockWidthHeight=function(C){return{blockWidth:0<
C?this.rasterInfo.storageInfo.pyramidBlockWidth:this.rasterInfo.storageInfo.blockWidth,blockHeight:0<C?this.rasterInfo.storageInfo.pyramidBlockHeight:this.rasterInfo.storageInfo.blockHeight}};G.isBlockOutside=function(C,u,z){C=this.rasterInfo.storageInfo.blockBoundary[C];return!C||C.maxRow<u||C.maxCol<z||C.minRow>u||C.minCol>z};G._fetchPixels=function(){var C=P._asyncToGenerator(function*(u,z,L,S={}){var Z=a.getWorldWrapCount(u);if(2<=Z)return{extent:u,pixelBlock:null};var X=this._getSourceDataInfo(u,
z,L,S);const {pyramidLevel:M,pyramidResolution:O,srcResolution:A,srcExtent:Q,srcWidth:Y,srcHeight:W}=X;if(0===Y||0===W)return{extent:u,srcExtent:Q,pixelBlock:null};var T=H.unwrap(this.rasterInfo.transform),K="gcs-shift"===T?.type,V=H.isSome(a.getWorldWidth(u.spatialReference));if(K||!V)Z=a.getWorldWrapCount(X.srcExtent,K);var ba=this.rasterInfo.storageInfo,aa={x:Math.floor((Q.xmin-ba.origin.x)/O.x+.1),y:Math.floor((ba.origin.y-Q.ymax)/O.y+.1)};X=yield this._fetchRawTiles(M,aa,{width:Y,height:W,wrapCount:Z},
S);if(!X)return{extent:u,srcExtent:Q,pixelBlock:null};K=0<M?ba.pyramidBlockWidth:ba.blockWidth;const ea=0<M?ba.pyramidBlockHeight:ba.blockHeight,ja=K===Y&&ea===W&&0===aa.x%K&&0===aa.y%ea;aa=new t({x:(u.xmax-u.xmin)/z,y:(u.ymax-u.ymin)/L,spatialReference:u.spatialReference});const ha=!u.spatialReference.equals(this.rasterInfo.spatialReference);({datumTransformation:ba}=S);if(!ha&&ja&&1===X.pixelBlocks.length&&K===z&&ea===L&&A.x===aa.x&&A.y===aa.y)return{extent:u,srcExtent:Q,pixelBlock:X.pixelBlocks[0]};
K=V&&H.isSome(a.getWorldWidth(Q.spatialReference));(V=S.requestProjectedLocalDirections&&this.rasterInfo.dataType.startsWith("vector"))&&!this.rasterJobHandler&&(yield a.load());Z=this.rasterJobHandler?yield this.rasterJobHandler.getProjectionOffsetGrid({projectedExtent:u,srcBufferExtent:X.extent,pixelSize:aa.toJSON(),datumTransformation:ba,rasterTransform:T,hasWrapAround:0<Z||K,isAdaptive:!1!==this.ioConfig.optimizeProjectionAccuracy,includeGCSGrid:V},S):a.getProjectionOffsetGrid({projectedExtent:u,
srcBufferExtent:X.extent,pixelSize:aa,datumTransformation:ba,rasterTransform:T,hasWrapAround:0<Z||K,isAdaptive:!1,includeGCSGrid:V});T=!S.requestRawData;K={rows:Z.spacing[0],cols:Z.spacing[1]};aa=H.unwrap(this._getRasterTileAlignmentInfo(M,X.extent.xmin));const {pixelBlocks:ma,mosaicSize:na,isPartiallyFilled:qa}=X;X=null;this.rasterJobHandler?(z=yield this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:ma,srcMosaicSize:na,destDimension:T?{width:z,height:L}:null,coefs:T?Z.coefficients:null,sampleSpacing:T?
K:null,projectDirections:V,gcsGrid:V?Z.gcsGrid:null,isUV:"vector-uv"===this.rasterInfo.dataType,interpolation:S.interpolation,alignmentInfo:aa,blockWidths:null},S),{pixelBlock:T,localNorthDirections:X}=z):(aa=g.mosaic(ma,na,{alignmentInfo:aa}),T=T?g.approximateTransform(aa,{width:z,height:L},Z.coefficients,K,S.interpolation):aa,V&&Z.gcsGrid&&(X=g.getLocalArithmeticNorthRotations({width:z,height:L},Z.gcsGrid),T=e.convertToLocalDirections(T,this.rasterInfo.dataType,X)));return S.requestRawData||V?{srcExtent:Q,
pixelBlock:T,transformGrid:Z,localNorthDirections:X,extent:u,isPartiallyFilled:qa}:{srcExtent:Q,extent:u,pixelBlock:T}});return function(u,z,L){return C.apply(this,arguments)}}();G._fetchRawTiles=function(){var C=P._asyncToGenerator(function*(u,z,L,S){const {origin:Z,blockBoundary:X}=this.rasterInfo.storageInfo,{blockWidth:M,blockHeight:O}=this.getBlockWidthHeight(u);let {x:A,y:Q}=z,{width:Y,height:W,wrapCount:T}=L;var K=this._getRasterTileAlignmentInfo(u,0);S.buffer&&(A-=S.buffer.cols,Q-=S.buffer.rows,
Y+=2*S.buffer.cols,W+=2*S.buffer.rows);var V=0,ba=0;let aa=0;T&&H.isSome(K)&&({worldColumnCountFromOrigin:ba,originColumnOffset:aa,rightPadding:V}=K,ba*K.blockWidth-V>=A+Y&&(V=0));z=Math.floor(A/M);L=Math.floor(Q/O);const ea=Math.floor((A+Y+V-1)/M);V=Math.floor((Q+W+V-1)/O);var ja=X[u];if(!ja)return null;const {minRow:ha,minCol:ma,maxCol:na,maxRow:qa}=ja;if(0===T&&(V<ha||ea<ma||L>qa||z>na))return null;ja=[];let ra=!1;const pa=null==this.ioConfig.allowPartialFill?S.allowPartialFill:this.ioConfig.allowPartialFill;
for(let va=L;va<=V;va++)for(let ta=z;ta<=ea;ta++){let xa=ta;!S.disableWrapAround&&T&&H.isSome(K)&&ba<=ta&&(xa=ta-ba-aa);if(va>=ha&&xa>=ma&&qa>=va&&na>=xa){const ca=this._fetchRawTile(u,va,xa,S);pa?ja.push(new Promise(ia=>{ca.then(da=>ia(da)).catch(()=>{ra=!0;ia(null)})})):ja.push(ca)}else ja.push(Promise.resolve(null))}if(0===ja.length)return null;S=yield Promise.all(ja);K={height:(V-L+1)*O,width:(ea-z+1)*M};({spatialReference:ba}=this.rasterInfo);u=this.getPyramidPixelSize(u);const {x:oa,y:sa}=u;
return{extent:new v({xmin:Z.x+z*M*oa,xmax:Z.x+(ea+1)*M*oa,ymin:Z.y-(V+1)*O*sa,ymax:Z.y-L*O*sa,spatialReference:ba}),pixelBlocks:S,mosaicSize:K,isPartiallyFilled:ra}});return function(u,z,L,S){return C.apply(this,arguments)}}();G._fetchRawTile=function(C,u,z,L){var S=this.rasterInfo.storageInfo.blockBoundary[C];if(!S)return Promise.resolve(null);const {minRow:Z,minCol:X,maxCol:M,maxRow:O}=S;if(u<Z||z<X||u>O||z>M)return Promise.resolve(null);const A=n.getRasterId(this.url,L.sliceId),Q=`${C}/${u}/${z}`;
S=n.getBlock(A,L.registryId,Q);if(H.isNone(S)){const Y=new AbortController;S=this.fetchRawTile(C,u,z,{...L,signal:Y.signal});n.putBlock(A,L.registryId,Q,S,Y);S.catch(()=>n.deleteBlock(A,L.registryId,Q))}if(L.signal)B.onAbort(L,()=>{n.decreaseRefCount(A,L.registryId,Q)});return S};G._computeMagDirValues=function(C){const {bandCount:u,dataType:z}=this.rasterInfo;if((2!==u||"vector-magdir"!==z)&&"vector-uv"!==z||2!==C?.length||!C[0]?.length)return null;var L=C[0].length;if("vector-magdir"===z)return L=
C[1].map(M=>(M+360)%360),[C[0],L];const [S,Z]=C;C=[];const X=[];for(let M=0;M<L;M++){const [O,A]=e.uvComponentToVector([S[M],Z[M]]);C.push(O);X.push(A)}return[C,X]};G._getRasterTileAlignmentInfo=function(C,u){null==this._rasterTileAlighmentInfo&&(this._rasterTileAlighmentInfo=a.getRasterDatasetAlignmentInfo(this.rasterInfo));return H.isNone(this._rasterTileAlighmentInfo.pyramidsInfo)?null:{startX:u,halfWorldWidth:this._rasterTileAlighmentInfo.halfWorldWidth,hasGCSSShiftTransform:this._rasterTileAlighmentInfo.hasGCSSShiftTransform,
...this._rasterTileAlighmentInfo.pyramidsInfo[C]}};G._getSourceDataInfo=function(C,u,z,L={}){const S={datumTransformation:L.datumTransformation,pyramidLevel:0,pyramidResolution:null,srcExtent:null,srcHeight:0,srcResolution:null,srcWidth:0};L.srcResolution&&(S.srcResolution=L.srcResolution,this._updateSourceDataInfo(C,S));var Z=this.rasterInfo.storageInfo.maximumPyramidLevel||0;const {srcWidth:X,srcHeight:M,pyramidLevel:O}=S;var A=X/u;const Q=M/z,Y=O<Z&&16<=A*Q;var W=O===Z&&this._requireTooManySrcTiles(X,
M,u,z);if(Y||W||0===X||0===M){W=new t({x:(C.xmax-C.xmin)/u,y:(C.ymax-C.ymin)/z,spatialReference:C.spatialReference});W=a.projectResolution(W,this.rasterInfo.spatialReference,C,S.datumTransformation);const T=!W||L.srcResolution&&W.x+W.y<L.srcResolution.x+L.srcResolution.y;Y&&L.srcResolution&&T&&(A=Math.round(Math.log(Math.max(A,Q))/Math.LN2)-1,Z-O+3>=A&&(Z=2**A,W={x:L.srcResolution.x*Z,y:L.srcResolution.y*Z}));W&&(S.srcResolution=W,this._updateSourceDataInfo(C,S))}this._requireTooManySrcTiles(S.srcWidth,
S.srcHeight,u,z)&&(S.srcWidth=0,S.srcHeight=0);return S};G._requireTooManySrcTiles=function(C,u,z,L){const {tileInfo:S}=this.rasterInfo.storageInfo;return 256<=Math.ceil(C/S.size[0])*Math.ceil(u/S.size[1])||8<C/z||8<u/L};G._updateSourceDataInfo=function(C,u){u.srcWidth=0;u.srcHeight=0;var z=this.rasterInfo.spatialReference;const {srcResolution:L,datumTransformation:S}=u,{pyramidLevel:Z,pyramidResolution:X,excessiveReading:M}=a.snapPyramid(L,this.rasterInfo,this.ioConfig.sampling);M||(C=u.srcExtent||
a.projectExtent(C,z,S),null!=C&&((z=H.unwrap(this.rasterInfo.transform))&&(C=z.inverseTransform(C)),u.srcExtent=C,z=Math.ceil((C.xmax-C.xmin)/X.x-.1),C=Math.ceil((C.ymax-C.ymin)/X.y-.1),u.pyramidLevel=Z,u.pyramidResolution=X,u.srcWidth=z,u.srcHeight=C))};G._getRequestOptionsWithSliceId=function(C){H.isSome(this.rasterInfo.multidimensionalInfo)&&null==C.sliceId&&(C={...C,sliceId:this.getSliceIndex(C.multidimensionalDefinition)});return C};G._processIdentifyResult=function(C,u){const {srcLocation:z,
position:L,pyramidLevel:S,useTransposedTile:Z}=u,X=C.pixels[0].length/C.width/C.height;if(C.mask&&!C.mask[L])return{location:z,value:null};const {multidimensionalInfo:M}=this.rasterInfo;if(H.isNone(M)||!Z)return u=C.pixels.map(K=>K[L]),C={location:z,value:u,pyramidLevel:S},u=this._computeMagDirValues(u.map(K=>[K])),u?.length&&(C.magdirValue=u.map(K=>K[0])),C;let O=C.pixels.map(K=>K.slice(L*X,L*X+X)),A=this._computeMagDirValues(O);const {requestSomeSlices:Q,identifyOptions:Y}=u;let W=d.createSlices(M,
Y.transposedVariableName);if(Q){const K=d.getSliceIds(W,H.unwrap(Y.multidimensionalDefinition),H.unwrap(Y.timeExtent));O=O.map(V=>K.map(ba=>V[ba]));A=A?.map(V=>K.map(ba=>V[ba]));W=K.map(V=>W[V])}u=C.noDataValues||this.rasterInfo.noDataValue;C={pixels:O,pixelType:C.pixelType};let T;H.isSome(u)&&(x.convertNoDataToMask(C,u),T=C.mask);C=W.map((K,V)=>{K={value:0===T?.[V]?null:O.map(ba=>ba[V]),multidimensionalDefinition:K.multidimensionalDefinition.map(ba=>new h({...ba,isSlice:!0}))};A?.length&&(K.magdirValue=
[A[0][V],A[1][V]]);return K});return{location:z,value:null,dataSeries:C,pyramidLevel:S}};P._createClass(y,[{key:"_isGlobalWrappableSource",get:function(){const {rasterInfo:C}=this,u=a.getWorldWidth(C.spatialReference);return H.isSome(u)&&C.extent.width>=u/2}},{key:"url",set:function(C){this._set("url",c.sanitizeUrl(C,U.getLogger(this.declaredClass)))}}]);return y}(N.EsriPromiseMixin(R.JSONSupport));D.__decorate([l.property()],F.prototype,"_rasterTileAlighmentInfo",void 0);D.__decorate([l.property({readOnly:!0})],
F.prototype,"_isGlobalWrappableSource",null);D.__decorate([l.property(m.url)],F.prototype,"url",null);D.__decorate([l.property({type:String,json:{write:!0}})],F.prototype,"datasetName",void 0);D.__decorate([l.property({type:String,json:{write:!0}})],F.prototype,"datasetFormat",void 0);D.__decorate([l.property()],F.prototype,"hasUniqueSourceStorageInfo",void 0);D.__decorate([l.property()],F.prototype,"rasterInfo",void 0);D.__decorate([l.property()],F.prototype,"ioConfig",void 0);D.__decorate([l.property()],
F.prototype,"sourceJSON",void 0);return F=D.__decorate([f.subclass("esri.layers.support.rasterDatasets.BaseRaster")],F)})},"esri/layers/support/RasterStorageInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../geometry/Point".split(" "),function(P,D,F,I,p,R,U,H){var N;F=N=function(B){function l(){var b=
B.apply(this,arguments)||this;b.blockWidth=void 0;b.blockHeight=void 0;b.compression=null;b.origin=null;b.firstPyramidLevel=null;b.maximumPyramidLevel=null;b.pyramidScalingFactor=2;b.pyramidBlockWidth=null;b.pyramidBlockHeight=null;b.isVirtualTileInfo=!1;b.tileInfo=null;b.transposeInfo=null;b.blockBoundary=null;return b}P._inheritsLoose(l,B);l.prototype.clone=function(){return new N({blockWidth:this.blockWidth,blockHeight:this.blockHeight,compression:this.compression,origin:I.clone(this.origin),firstPyramidLevel:this.firstPyramidLevel,
maximumPyramidLevel:this.maximumPyramidLevel,pyramidResolutions:I.clone(this.pyramidResolutions),pyramidScalingFactor:this.pyramidScalingFactor,pyramidBlockWidth:this.pyramidBlockWidth,pyramidBlockHeight:this.pyramidBlockHeight,isVirtualTileInfo:this.isVirtualTileInfo,tileInfo:I.clone(this.tileInfo),transposeInfo:I.clone(this.transposeInfo),blockBoundary:I.clone(this.blockBoundary)})};return l}(F.JSONSupport);D.__decorate([p.property({type:Number,json:{write:!0}})],F.prototype,"blockWidth",void 0);
D.__decorate([p.property({type:Number,json:{write:!0}})],F.prototype,"blockHeight",void 0);D.__decorate([p.property({type:String,json:{write:!0}})],F.prototype,"compression",void 0);D.__decorate([p.property({type:H,json:{write:!0}})],F.prototype,"origin",void 0);D.__decorate([p.property({type:Number,json:{write:!0}})],F.prototype,"firstPyramidLevel",void 0);D.__decorate([p.property({type:Number,json:{write:!0}})],F.prototype,"maximumPyramidLevel",void 0);D.__decorate([p.property({json:{write:!0}})],
F.prototype,"pyramidResolutions",void 0);D.__decorate([p.property({type:Number,json:{write:!0}})],F.prototype,"pyramidScalingFactor",void 0);D.__decorate([p.property({type:Number,json:{write:!0}})],F.prototype,"pyramidBlockWidth",void 0);D.__decorate([p.property({type:Number,json:{write:!0}})],F.prototype,"pyramidBlockHeight",void 0);D.__decorate([p.property({type:Boolean,json:{write:!0}})],F.prototype,"isVirtualTileInfo",void 0);D.__decorate([p.property({json:{write:!0}})],F.prototype,"tileInfo",
void 0);D.__decorate([p.property()],F.prototype,"transposeInfo",void 0);D.__decorate([p.property()],F.prototype,"blockBoundary",void 0);return F=N=D.__decorate([U.subclass("esri.layers.support.RasterStorageInfo")],F)})},"esri/layers/support/rasterDatasets/multidimensionalUtils":function(){define(["exports","../../../core/maybe","../DimensionalDefinition"],function(P,D,F){function I(f,c,m){const h=c.shift();0===m.length&&m.push({sliceId:-1,multidimensionalDefinition:[]});const r=m.length;for(let E=
0;E<r;E++){const J=m.shift().multidimensionalDefinition;h.values?.forEach(d=>{m.push({sliceId:-1,multidimensionalDefinition:[...J,{variableName:f,dimensionName:h.name,values:[d]}]})})}c.length&&I(f,c,m)}function p(f,c){return Array.isArray(f)?c[0]===c[1]?f[0]===c[0]||f[1]===c[0]:f[0]>=c[0]&&f[0]<=c[1]&&f[1]>=c[0]&&f[1]<=c[1]:f>=c[0]&&f<=c[1]}function R(f,c){return f[0]<=c[0]&&f[1]>=c[0]||f[0]<=c[1]&&f[1]>=c[1]||f[0]>=c[0]&&f[1]<=c[1]}function U(f){return 1===f.length?[f[0],f[0]]:[f[0],f[f.length-
1]]}function H(f,c,m){if(!c?.subsetDefinitions?.length)return f;if(m){const {variables:r}=c;if(r.length&&!r.includes(m))return null;c=c.subsetDefinitions.find(E=>E.dimensionName===f.name&&E.variableName===m);if(!c?.values?.length)return f;c=U(c.values)}else c=c.dimensions.find(({name:r})=>r===f.name)?.extent;const h=c;if(!h||!h?.length)return f;c=f.values.filter(r=>p(r,h));return{...f,extent:[...h],values:c}}function N(f,c,m){if(!c?.subsetDefinitions?.length)return!1;const {variables:h}=c;if(h.length&&
f.some(({variableName:r})=>r&&!h.includes(r)))return!0;for(let r=0;r<f.length;r++){const E=f[r],J=c.subsetDefinitions.find(d=>(""===E.variableName||d.variableName===E.variableName)&&d.dimensionName===E.dimensionName);if(J?.values.length){const d=U(J.values);if(!E.isSlice&&2===E.values.length&&!Array.isArray(E.values[0])&&E.values[0]!==E.values[1]&&m){if(!R(E.values,d))return!0}else if(E.values.some(n=>!p(n,d)))return!0}}return!1}function B(f,c){var m=f.dimensions.find(({name:J})=>"StdTime"===J);if(null==
m||D.isNone(c.start)&&D.isNone(c.end))return c;c=c.clone();const {start:h,end:r}=c.toJSON(),E=h===r?[h]:null!=h&&null!=r?[h,r]:[h??r];if(2===E.length&&m?.extent.length&&(E[0]=Math.max(E[0],m.extent[0]),E[1]=Math.min(E[1],m.extent[1]??m.extent[0]),E[1]<E[0]))return null;m=new F({variableName:"",dimensionName:"StdTime",isSlice:1===E.length,values:E});if(N([m],f,!0))return null;c.start=new Date(E[0]);c.end=new Date(E[1]??E[0]);return c}function l(f,c={}){const {multidimensionalInfo:m,keyProperties:h}=
f;if(D.isNone(m))return null;const {variableName:r,multidimensionalSubset:E,multidimensionalDefinition:J}=c;f=D.isSome(J)?J[0]?.variableName:null;const d=r||f||h?.DefaultVariable;({variables:f}=m);E?.variables?.length&&(f=f.filter(({name:n})=>E.variables.includes(n)));return d?f.find(({name:n})=>n===d)??f[0]:f[0]}function b(f,c){var {values:m}=c;if(m?.length)return Array.isArray(m[0])!==Array.isArray(f)?-1:Array.isArray(m[0])?m.findIndex(E=>E[0]===f[0]&&E[1]===f[1]):m.indexOf(f);var {extent:h}=c;
if(Array.isArray(f)||f<h[0]||f>h[1])return-1;m=c.interval||1;if("ISO8601"!==c.unit)return Math.round((f-h[0])/m);h=h[0];let r=-1;switch(c.intervalUnit?.toLowerCase()||"seconds"){case "seconds":r=Math.round((f-h)/1E3/m);break;case "minutes":r=Math.round((f-h)/6E4/m);break;case "hours":r=Math.round((f-h)/36E5/m);break;case "days":r=Math.round((f-h)/864E5/m);break;case "months":c=(new Date(f)).getUTCFullYear()-(new Date(h)).getUTCFullYear();m=(new Date(h)).getUTCMonth();h=(new Date(f)).getUTCMonth();
r=0===c?h-m:h+11-m+12*(c-1);break;case "years":r=Math.round(((new Date(f)).getUTCFullYear()-(new Date(h)).getUTCFullYear())/m);break;case "decades":r=Math.round(((new Date(f)).getUTCFullYear()-(new Date(h)).getUTCFullYear())/10/m)}return r}function k(f){var c=f.values?.length;if(c)return c;const {extent:m,unit:h}=f;c=f.interval||1;var r=m?m[1]-m[0]:0;if("ISO8601"!==h)return Math.round(r/c);switch(f.intervalUnit?.toLowerCase()??"seconds"){case "seconds":c=Math.round(r/1E3/c);break;case "minutes":c=
Math.round(r/6E4/c);break;case "hours":c=Math.round(r/36E5/c);break;case "days":c=Math.round(r/864E5/c);break;case "months":f=(new Date(m[1])).getUTCFullYear()-(new Date(m[0])).getUTCFullYear();c=(new Date(m[1][0])).getUTCMonth();r=(new Date(m[1][1])).getUTCMonth();c=0===f?r-c+1:r+11-c+12*(f-1)+1;break;case "years":c=Math.round(((new Date(m[1])).getUTCFullYear()-(new Date(m[0])).getUTCFullYear())/c);break;case "decades":c=Math.round(((new Date(m[1])).getUTCFullYear()-(new Date(m[0])).getUTCFullYear())/
10/c);break;default:c=0}return c}P.createSlices=function(f,c){const m=[];let h=0;(c?f.variables.filter(r=>r.name.toLowerCase()===c.toLowerCase()):[...f.variables].sort((r,E)=>r.name>E.name?1:-1)).forEach(r=>{const E=[],J=[...r.dimensions].sort((d,n)=>d.name>n.name?-1:1);I(r.name,J,E);E.forEach(d=>{m.push({...d,sliceId:h++})})});return m};P.getDefaultMultidimensionalDefinition=function(f,c={}){var m=l(f,c);if(!m)return null;f=[];const {dimensions:h,name:r}=m;if(0===h.length)return[new F({variableName:r,
dimensionName:"",values:[],isSlice:!0})];for(m=0;m<h.length;m++){const E=H(h[m],c.multidimensionalSubset,r);if(!E)return null;const {values:J,extent:d}=E;let n=J?.[0]??d[0];"stdz"===E.name.toLowerCase()&&!E.hasRanges&&Math.abs(d[1])<=Math.abs(d[0])&&(n=J?.length?J[J.length-1]:d[1]);f.push(new F({variableName:r,dimensionName:E.name,values:[n],isSlice:c.useRangeForRangedDimensionInfo?!!E.hasRanges:!0}))}return f};P.getDefaultVariablInfo=l;P.getSliceIds=function(f,c,m){let h=f;c&&(c=[...c].sort((r,E)=>
r.dimensionName<E.dimensionName?-1:1),c.forEach(({dimensionName:r,values:E,isSlice:J})=>{E.length&&(h=h.filter(d=>{d=d.multidimensionalDefinition.find(x=>x.dimensionName===r);if(null==d)return!1;const n=d.values[0];return"number"===typeof n?"number"===typeof E[0]?E.includes(n):E.some(x=>x[0]<=n&&x[1]>=n):"number"===typeof E[0]?E.some(x=>n[0]<=x&&n[1]>=x):J?E.some(x=>x[0]===n[0]&&x[0]===n[1]):E.some(x=>x[0]>=n[0]&&x[0]<=n[1]||x[1]>=n[0]&&x[1]<=n[1]||x[0]<n[0]&&x[1]>n[1])}))}));if(h.length&&m&&D.isSome(m.start)&&
D.isSome(m.end)){const r=m.start.getTime(),E=m.end.getTime(),J=h[0].multidimensionalDefinition.findIndex(d=>"StdTime"===d.dimensionName);-1<J&&(h=h.filter(d=>{d=d.multidimensionalDefinition[J].values[0];return r<=d&&E>=d}))}return h.map(r=>r.sliceId)};P.getSliceIndex=function(f,c){let m=0;var h=f[0].variableName;c=[...c.variables].sort((E,J)=>E.name>J.name?1:-1);for(var r=0;r<c.length;r++){const E=c[r],J=[...E.dimensions].sort((d,n)=>d.name>n.name?-1:1);if(E.name!==h)m+=J.map(d=>k(d)).reduce((d,n)=>
d*n);else{h=J.map(d=>k(d));c=J.length;for(let d=0;d<c;d++){r=f.find(n=>n.dimensionName===J[d].name);if(null==r)return null;r=b(r.values[0],J[d]);if(-1===r)return null;h.shift();m=d===c-1?m+r:m+r*h.reduce((n,x)=>n*x)}break}}return m};P.getSubsetVariablesFromMdInfo=function(f,c){if(D.isNone(c)||D.isNone(f))return null;c=c.variables.map(m=>({...m}));f?.variables?.length&&(c=c.filter(({name:m})=>f.variables.includes(m)),c.forEach(m=>{m.dimensions=m.dimensions.map(h=>H(h,f,m.name)).filter(D.isSome)}));
return c};P.hasExcludedVariableOrDimension=N;P.intersectMultimensionalSubset=function(f,c){if(D.isNone(f))return{isOutside:!1};const {geometry:m,timeExtent:h,multidimensionalDefinition:r}=c;c=null;if(D.isSome(h)&&(c=B(f,h),D.isNone(c)))return{isOutside:!0};const {areaOfInterest:E}=f;if(E&&m){const J="point"===m.type?m:"extent"===m.type?m.center:"polygon"===m.type?m.centroid:null;if(J&&!E.contains(J))return{isOutside:!0}}return D.isSome(r)&&r.length&&N(r,f,!0)?{isOutside:!0}:{isOutside:!1,intersection:{geometry:m,
timeExtent:c,multidimensionalDefinition:r}}};P.isMultiSliceOrRangeDefinition=function(f){return D.isNone(f)||!f.length?!1:f.some(c=>{if(null==c.values)return!0;const m=c.values.length;return 0===m||1<m||!c.isSlice&&Array.isArray(c.values[0])})};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/RawBlockCache":function(){define("exports ../../../geometry ../../../core/maybe ./EphemeralBlockCache ../rasterFunctions/rasterProjectionHelper ../../../geometry/Point".split(" "),
function(P,D,F,I,p,R){function U(B,l){return(B=H.get(B))?B[l]??null:null}const H=new Map,N=new I;P.decreaseRefCount=function(B,l,b){const k=H.get(B);if(!k)return null==l?N.decreaseRefCount(B,b):0;if(null==l||null==k[l])return N.decreaseRefCount(B,b);l=k[l]?.cache;B=l?.get(b);if(l&&B){B.refCount--;if(0===B.refCount){l.delete(b);for(l=0;l<k.length;l++)k[l]?.cache.delete(b);B.controller&&B.controller.abort()}return B.refCount}return 0};P.deleteBlock=function(B,l,b){const k=H.get(B);k?null==l||null==
k[l]?N.deleteBlock(B,b):k[l]?.cache.delete(b):null==l&&N.deleteBlock(B,b)};P.deleteRaster=function(B){H.delete(B)};P.getBlock=function(B,l,b){const k=H.get(B);if(!k)return null==l?N.getBlock(B,b):null;if(null==l||null==k[l]){for(l=0;l<k.length;l++){var f=k[l]?.cache.get(b);if(f)return f.refCount++,f.block}return N.getBlock(B,b)}if(B=k[l]?.cache.get(b))return B.refCount++,B.block;for(B=0;B<k.length;B++){if(B===l||!k[B])continue;f=k[B]?.cache;const c=f?.get(b);if(f&&c)return c.refCount++,f.set(b,c),
c.block}return null};P.getRasterId=function(B,l){return null==l?B:`${B}?sliceId=${l}`};P.putBlock=function(B,l,b,k,f=null){const c=H.get(B);if(c)if(null==l||null==c[l])N.putBlock(B,b,k,f);else{var m={refCount:1,block:k,isResolved:!1,isRejected:!1,controller:f};k.then(()=>m.isResolved=!0).catch(()=>m.isRejected=!0);c[l]?.cache.set(b,m)}else null==l&&N.putBlock(B,b,k,f)};P.register=function(B,l){l={extent:null,rasterInfo:l,cache:new Map};const b=H.get(B);if(b)return b.push(l),b.length-1;H.set(B,[l]);
return 0};P.unregister=function(B,l){const b=H.get(B);b&&(b[l]=null,b.some(k=>null!=k)||H.delete(B))};P.update=function(B,l,b,k,f,c,m=null){if(B=U(B,l)){l=B.extent;var {cache:h,rasterInfo:r}=B;if(!l||l.xmin!==b.xmin||l.xmax!==b.xmax||l.ymin!==b.ymin||l.ymax!==b.ymax){k=k??0;l=b.clone().normalize();var {spatialReference:E,transform:J}=r,d=new Set;for(let e=0;e<l.length;e++){var n=l[e];if(n.xmax-n.xmin<=k||n.ymax-n.ymin<=k)continue;var x=p.projectExtent(n,E,m);F.isSome(J)&&(x=J.inverseTransform(x));
var q=new R({x:k,y:k,spatialReference:n.spatialReference});if(null==f&&(f=p.projectResolution(q,E,n,m),!f))return;const {pyramidLevel:t,pyramidResolution:v,excessiveReading:w}=p.snapPyramid(f,r,c||"closest");if(w)return;({storageInfo:n}=r);var {origin:g}=n;q=Math.max(0,Math.floor((x.xmin-g.x)/v.x));g=Math.max(0,Math.floor((g.y-x.ymax)/v.y));const y=0<t?n.pyramidBlockWidth:n.blockWidth,G=0<t?n.pyramidBlockHeight:n.blockHeight;n=Math.max(0,Math.floor(q/y)-1);var a=Math.max(0,Math.floor(g/G)-1);q=Math.floor((q+
Math.ceil((x.xmax-x.xmin)/v.x-.1)-1)/y)+1;x=Math.floor((g+Math.ceil((x.ymax-x.ymin)/v.y-.1)-1)/G)+1;for(g=a;g<=x;g++)for(a=n;a<=q;a++)d.add(`${t}/${g}/${a}`)}h.forEach((e,t)=>{d.has(t)||(e=h.get(t),(null==e||e.isResolved||e.isRejected)&&h.delete(t))});B.extent={xmin:b.xmin,ymin:b.ymin,xmax:b.xmax,ymax:b.ymax}}}};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/EphemeralBlockCache":function(){define(function(){return function(){function P(F=15E3,I=
5E3){this._timer=null;this._cachedBlocks=new Map;this._size=-1;this._duration=F;this._interval=Math.min(F,I)}var D=P.prototype;D.decreaseRefCount=function(F,I){F=F+"/"+I;I=this._cachedBlocks;if(I.has(F)){const p=I.get(F);p.refCount--;0>=p.refCount&&(I.delete(F),p.controller&&p.controller.abort());return p.refCount}return 0};D.getBlock=function(F,I){F=F+"/"+I;I=this._cachedBlocks;if(I.has(F)){const p=I.get(F);p.ts=Date.now();p.refCount++;I.delete(F);I.set(F,p);return p.block}return null};D.putBlock=
function(F,I,p,R){const U=this._cachedBlocks;F=F+"/"+I;U.has(F)?(p=U.get(F),p.ts=Date.now(),p.refCount++):U.set(F,{block:p,ts:Date.now(),refCount:1,controller:R});this._trim();this._updateTimer()};D.deleteBlock=function(F,I){const p=this._cachedBlocks;F=F+"/"+I;p.has(F)&&p.delete(F)};D.updateMaxSize=function(F){this._size=F;this._trim()};D.empty=function(){this._cachedBlocks.clear();this._clearTimer()};D.getCurrentSize=function(){return this._cachedBlocks.size};D._updateTimer=function(){if(null==
this._timer){var F=this._cachedBlocks;this._timer=setInterval(()=>{const I=Array.from(F),p=Date.now();for(let R=0;R<I.length;R++)if(I[R][1].ts<=p-this._duration)F.delete(I[R][0]);else break;0===F.size&&this._clearTimer()},this._interval)}};D._trim=function(){const F=this._cachedBlocks;if(!(-1===this._size||this._size>=F.size)){var I=Array.from(F);for(let p=0;p<I.length-this._size;p++)F.delete(I[p][0])}};D._clearTimer=function(){null!=this._timer&&(clearInterval(this._timer),this._timer=null)};return P}()})},
"esri/layers/support/rasterFunctions/rasterProjectionHelper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../geometry ../../../core/Error ../../../core/maybe ../../../core/unitUtils ../../../chunks/pe ../../../geometry/projection ../../../geometry/Extent ../../../geometry/Point ../../../geometry/Polygon ../../../geometry/SpatialReference".split(" "),function(P,D,F,I,p,R,U,H,N,B,l,b){function k(A,Q,Y){return!H.canProjectWithoutEngine(A,Q,Y)}function f(A,Q,Y){if((A=k(A,
Q,Y))&&!H.isLoaded())throw new I("rasterprojectionhelper-project","projection engine is not loaded");return A}function c(){c=D._asyncToGenerator(function*(){H.isLoaded()||(yield H.load())});return c.apply(this,arguments)}function m(A,Q,Y,W=null){const T=A.spatialReference;if(T.equals(Q))return A;f(T,Q,W);Y=Y.center;Y=new N({xmin:Y.x-A.x/2,xmax:Y.x+A.x/2,ymin:Y.y-A.y/2,ymax:Y.y+A.y/2,spatialReference:T});W=H.project(Y,Q,W);Y=y(Q);p.isNone(W)||p.isSome(Y)&&W.width>=Y?(Q=R.getMetersPerUnitForSR(T)/R.getMetersPerUnitForSR(Q),
A={x:A.x*Q,y:A.y*Q}):A={x:W.width,y:W.height};return A}function h(A,Q=.01){return R.getMetersPerUnitForSR(A)?Q/R.getMetersPerUnitForSR(A):0}function r(A,Q,Y=null,W=!0){const T=A.spatialReference;if(T.equals(Q))return A;f(T,Q,Y);Y=H.project(A,Q,Y);if(!W||!Y)return Y;E([A],[Y],T,Q);return Y}function E(A,Q,Y,W){const T=G(Y,!0),K=G(W,!0);Y=h(Y,500);W=h(W,500);if(Y&&p.isSome(T)&&p.isSome(K))for(let V=0;V<A.length;V++){const ba=Q[V];if(!ba)continue;const {x:aa}=A[V],{x:ea}=ba;ea>=K[1]-W&&Math.abs(aa-T[0])<
Y?ba.x-=K[1]-K[0]:ea<=K[0]+W&&Math.abs(aa-T[1])<Y&&(ba.x+=K[1]-K[0])}}function J(A){const {inSR:Q,outSR:Y,datumTransformation:W,preferPE:T}=A;if(Q.equals(Y))return{points:A}=g(A,null),A;if(Q.isWebMercator&&Y.isWGS84||Q.isWGS84&&Y.isWebMercator){const {cols:ea,rows:ja,xres:ha,yres:ma,usePixelCenter:na,inSR:qa,outSR:ra}=A;let {xmin:pa,ymax:oa}=A;na&&(pa+=ha/2,oa-=ma/2);A=[];var K=[],V=Math.max(ea,ja);for(var ba=0;ba<V;ba++){var aa=H.project(new B({x:pa+ha*Math.min(ea,ba),y:oa-ma*Math.min(ja,ba),spatialReference:qa}),
ra);ba<=ea&&A.push(aa.x);ba<=ja&&K.push(aa.y)}V=[];for(ba=0;ba<ea;ba++)for(aa=0;aa<ja;aa++)V.push([A[ba],K[aa]]);return V}if(f(Q,Y,W)&&T){if(Q.isGeographic)return n(A);K=x(Q);if(p.isSome(K))return n(A)}return d(A)}function d(A){var {points:Q}=g(A,null);const {inSR:Y,outSR:W,datumTransformation:T}=A;A=Q.map(K=>new B(K[0],K[1],Y));Q=H.project(A,W,T);T&&E(A,Q,Y,W);return Q.map(K=>K?[K.x,K.y]:[NaN,NaN])}function n(A){const {inSR:Q,outSR:Y,datumTransformation:W}=A;var T=x(Q);const {points:K,mask:V}=g(A,
T);Q.isGeographic||(A=Q.wkid?U.PeFactory.coordsys(Q.wkid):U.PeFactory.fromString(Q.isGeographic?U.PeDefs.PE_TYPE_GEOGCS:U.PeDefs.PE_TYPE_PROJCS,Q.wkt),U.PeCSTransformations.projToGeog(A,K.length,K));if(p.isSome(W)&&W.steps.length){var ba;Y.isGeographic&&(ba=K.map(([aa])=>179.9955<aa?1:-179.9955>aa?-1:0));W.steps.forEach(aa=>{const ea=aa.wkid?U.PeFactory.geogtran(aa.wkid):U.PeFactory.fromString(U.PeDefs.PE_TYPE_GEOGTRAN,aa.wkt);U.PeGTTransformations.geogToGeog(ea,K.length,K,null,aa.isInverse?U.PeDefs.PE_TRANSFORM_2_TO_1:
U.PeDefs.PE_TRANSFORM_1_TO_2)});if(ba)for(A=0;A<K.length;A++){T=ba[A];const aa=K[A][0],ea=179.9955<aa?1:-179.9955>aa?-1:0;T&&ea&&T!==ea&&(K[A][0]=0<T?aa+360:aa-360)}}Y.isGeographic||(ba=x(Y,!0),ba=p.isSome(ba)&&ba.isEnvelope?[ba.bbox[1],ba.bbox[3]]:[-90,90],a(K,ba),ba=Y.wkid?U.PeFactory.coordsys(Y.wkid):U.PeFactory.fromString(Y.isGeographic?U.PeDefs.PE_TYPE_GEOGCS:U.PeDefs.PE_TYPE_PROJCS,Y.wkt),U.PeCSTransformations.geogToProj(ba,K.length,K));ba=K;if(V&&K.length!==V.length){ba=[];for(let aa=0,ea=
0;aa<V.length;aa++)V[aa]?ba.push(K[ea++]):ba.push([NaN,NaN])}return ba}function x(A,Q=!1){var Y=A.wkid||A.wkt;if(!Y||A.isGeographic)return null;Y=String(Y);if(M.has(Y))return Y=M.get(Y),Q?Y?.gcs:Y?.pcs;var W=A.wkid?U.PeFactory.coordsys(A.wkid):U.PeFactory.fromString(A.isGeographic?U.PeDefs.PE_TYPE_GEOGCS:U.PeDefs.PE_TYPE_PROJCS,A.wkt);A=h(A,1E-4);A=q(W,A);W=q(W,0,!0);M.set(Y,{pcs:A,gcs:W});return Q?W:A}function q(A,Q=0,Y=!1){var W=U.PePCSInfo.generate(A),T=Y?A.horizonGcsGenerate():A.horizonPcsGenerate();
if(!W||!T?.length)return null;A=!1;var K=T.find(ja=>1===ja.getInclusive()&&1===ja.getKind());if(!K){K=T.find(ja=>1===ja.getInclusive()&&0===ja.getKind());if(!K)return null;A=!0}Y=Y?0:(2===W.getNorthPoleLocation()?1:0)|(2===W.getSouthPoleLocation()?2:0);W=W.isPannableRectangle();K=K.getCoord();if(A)return{isEnvelope:A,isPannable:W,vertices:K,coef:null,bbox:[K[0][0]-Q,K[0][1]-Q,K[1][0]+Q,K[1][1]+Q],poleLocation:Y};Q=0;A=[];let [V,ba]=K[0],[aa,ea]=K[0];for(let ja=0,ha=K.length;ja<ha;ja++){Q++;Q===ha&&
(Q=0);const [ma,na]=K[ja],[qa,ra]=K[Q];if(ra===na)A.push([ma,qa,na,ra,2]);else{T=(qa-ma)/(ra-na||1E-4);const pa=ma-T*na;na<ra?A.push([T,pa,na,ra,0]):A.push([T,pa,ra,na,1])}V=V<ma?V:ma;ba=ba<na?ba:na;aa=aa>ma?aa:ma;ea=ea>na?ea:na}return{isEnvelope:!1,isPannable:W,vertices:K,coef:A,bbox:[V,ba,aa,ea],poleLocation:Y}}function g(A,Q){const Y=[],{cols:W,rows:T,xres:K,yres:V,usePixelCenter:ba}=A;let {xmin:aa,ymax:ea}=A;ba&&(aa+=K/2,ea-=V/2);if(p.isNone(Q)){for(A=0;A<W;A++)for(Q=0;Q<T;Q++)Y.push([aa+K*A,
ea-V*Q]);return{points:Y}}A=new Uint8Array(W*T);if(Q.isEnvelope){const {bbox:[pa,oa,sa,va]}=Q;for(let ta=0,xa=0;ta<W;ta++){var ja=aa+K*ta,ha=Q.isPannable||ja>=pa&&ja<=sa;for(var ma=0;ma<T;ma++,xa++){var na=ea-V*ma;ha&&na>=oa&&na<=va&&(Y.push([ja,na]),A[xa]=1)}}return{points:Y,mask:A}}ja=Q.coef;Q=[];for(ha=0;ha<T;ha++){var qa=ea-V*ha;ma=[];na=[];for(var ra=0;ra<ja.length;ra++){const [pa,oa,sa,va,ta]=ja[ra];qa===sa&&sa===va?(ma.push(pa),ma.push(oa),na.push(2),na.push(2)):qa>=sa&&qa<=va&&(ma.push(pa*
qa+oa),na.push(ta))}qa=ma;if(2<ma.length){ra=2===na[0]?0:na[0];let pa=ma[0];qa=[];for(let oa=1;oa<na.length;oa++)if(2!==na[oa]||oa===na.length-1)na[oa]!==ra&&(qa.push(0===ra?Math.min(pa,ma[oa-1]):Math.max(pa,ma[oa-1])),ra=na[oa],pa=ma[oa]),oa===na.length-1&&qa.push(0===na[oa]?Math.min(pa,ma[oa]):Math.max(pa,ma[oa]));qa.sort((oa,sa)=>oa-sa)}else ma[0]>ma[1]&&(qa=[ma[1],ma[0]]);Q.push(qa)}for(let pa=0,oa=0;pa<W;pa++)for(ja=aa+K*pa,ha=0;ha<T;ha++,oa++)if(ma=ea-V*ha,na=Q[ha],2===na.length)ja>=na[0]&&
ja<=na[1]&&(Y.push([ja,ma]),A[oa]=1);else if(2<na.length){qa=!1;for(ra=0;ra<na.length;ra+=2)if(ja>=na[ra]&&ja<=na[ra+1]){qa=!0;break}qa&&(Y.push([ja,ma]),A[oa]=1)}return{points:Y,mask:A}}function a(A,Q){const [Y,W]=Q;for(Q=0;Q<A.length;Q++){const T=A[Q][1];if(T<Y||T>W)A[Q]=[NaN,NaN]}}function e(A){const Q=y(A[0].spatialReference);if(2>A.length||p.isNone(Q))return A[0];let {xmin:Y,xmax:W,ymin:T,ymax:K}=A[0];for(let V=1;V<A.length;V++){const ba=A[V];W=ba.xmax+Q*V;T=Math.min(T,ba.ymin);K=Math.max(K,
ba.ymax)}return new N({xmin:Y,xmax:W,ymin:T,ymax:K,spatialReference:A[0].spatialReference})}function t(A,Q,Y=null,W=!0){var T=A.spatialReference;if(T.equals(Q))return A;var K=u(A);const V=y(T,!0);var ba=y(Q);if(0===K||p.isNone(V)||p.isNone(ba))return K=w(A,Q,Y,W),p.isNone(V)&&p.isSome(ba)&&Math.abs(K.width-ba)<h(Q)&&H.isLoaded()&&(T=x(T),p.isSome(T)&&T.poleLocation===S.None&&A.width<(T.bbox[2]-T.bbox[0])/2)?v(A,Q)||K:K;ba=A.clone().normalize();if(1===ba.length&&A.xmax<V&&A.xmax-V/2>h(T)){const {xmin:aa,
xmax:ea}=A;for(let ja=0;ja<=K;ja++)ba[ja]=new N({xmin:0===ja?aa:-V/2,xmax:ja===K?ea-V*ja:V/2,ymin:A.ymin,ymax:A.ymax,spatialReference:T})}A=ba.map(aa=>w(aa,Q,Y,W));return e(A.filter(p.isSome))}function v(A,Q){const Y=y(Q);if(p.isNone(Y))return null;let {xmin:W,ymin:T,xmax:K,ymax:V}=A;var ba=A.spatialReference;A=new l({spatialReference:ba,rings:[[[W,T],[K,T],[K,V],[W,V],[W,T]]]});A=H.project(A,Q);if(2!==A.rings.length||!A.rings[0].length||!A.rings[1].length)return null;({rings:A}=A);ba=h(ba);Q=new N({spatialReference:Q});
for(let aa=0;2>aa;aa++){W=K=A[aa][0][0];T=V=A[aa][0][1];for(let ea=0;ea<A[aa].length;ea++)W=W>A[aa][ea][0]?A[aa][ea][0]:W,K=K<A[aa][ea][0]?A[aa][ea][0]:K,T=T>A[aa][ea][1]?A[aa][ea][1]:T,V=V<A[aa][ea][1]?A[aa][ea][1]:V;if(0===aa)Q.ymin=T,Q.ymax=V,Q.xmin=W,Q.xmax=K;else if(Q.ymin=Math.min(Q.ymin,T),Q.ymax=Math.max(Q.ymax,V),Math.abs(K-Y/2)<ba)Q.xmin=W,Q.xmax+=Y;else if(Math.abs(W+Y/2)<ba)Q.xmax=K+Y;else return null}return Q}function w(A,Q,Y=null,W=!0,T=!0){const K=A.spatialReference;if(K.equals(Q)||
!Q)return A;f(K,Q,Y);const V=H.project(A,Q,Y);if(T&&Q.isWebMercator&&V&&(V.ymax=Math.min(2.0037508342787E7,V.ymax),V.ymin=Math.max(-2.0037508342787E7,V.ymin),V.ymin>=V.ymax))return null;if(!W||!V)return V;var ba=G(K,!0);W=G(Q,!0);if(p.isNone(ba)||p.isNone(W))return V;T=h(K,.001);const aa=h(K,500);var ea=h(Q,.001);if(Math.abs(V.xmin-W[0])<ea&&Math.abs(V.xmax-W[1])<ea){ea=Math.abs(A.xmin-ba[0]);ba=Math.abs(ba[1]-A.xmax);if(ea<T&&ba>aa){V.xmin=W[0];var ja=[];ja.push(new B(A.xmax,A.ymin,K));ja.push(new B(A.xmax,
(A.ymin+A.ymax)/2,K));ja.push(new B(A.xmax,A.ymax,K));ja=ja.map(ha=>r(ha,Q,Y)).filter(ha=>!isNaN(ha?.x)).map(ha=>ha.x);V.xmax=Math.max.apply(null,ja)}ba<T&&ea>aa&&(V.xmax=W[1],W=[],W.push(new B(A.xmin,A.ymin,K)),W.push(new B(A.xmin,(A.ymin+A.ymax)/2,K)),W.push(new B(A.xmin,A.ymax,K)),A=W.map(ha=>r(ha,Q,Y)).filter(ha=>!isNaN(ha?.x)).map(ha=>ha.x),V.xmin=Math.min.apply(null,A))}else A=h(Q,.001),Math.abs(V.xmin-W[0])<A&&(V.xmin=W[0]),Math.abs(V.xmax-W[1])<A&&(V.xmax=W[1]);return V}function y(A,Q=!1){return A?
A.isWebMercator?2*(Q?2.0037508342787E7:2.0037508342788905E7):A.wkid&&A.isGeographic?360:2*X[A.wkid]||null:null}function G(A,Q=!1){if(A.isGeographic)return[-180,180];A=y(A,Q);return p.isSome(A)?[-A/2,A/2]:null}function C(A,Q,Y,W){A=(A-Q)/Y;0!==A-Math.floor(A)?A=Math.floor(A):W&&--A;return A}function u(A,Q=!1){var Y=y(A.spatialReference);if(p.isNone(Y))return 0;const W=Q?0:-(Y/2),T=h(A.spatialReference),K=!Q&&Math.abs(A.xmin+Y/2)<T?-Y/2:A.xmin;A=C(!Q&&Math.abs(A.xmax-Y/2)<T?Y/2:A.xmax,W,Y,!0);Y=C(K,
W,Y,!1);return A-Y}function z(A){const {projectedExtent:Q,srcBufferExtent:Y,pixelSize:W,datumTransformation:T,rasterTransform:K}=A;var V=Q.spatialReference;const ba=Y.spatialReference;var aa=f(V,ba);const {xmin:ea,ymin:ja,xmax:ha,ymax:ma}=Q,na=y(ba),qa=p.isSome(na)&&(A.hasWrapAround||"gcs-shift"===K?.type);A=A.spacing||[32,32];var ra=A[0]*W.x,pa=A[1]*W.y;const oa=1===A[0],sa=Math.ceil((ha-ea)/ra-.1/A[0])+(oa?0:1),va=Math.ceil((ma-ja)/pa-.1/A[1])+(oa?0:1);ra=J({cols:sa,rows:va,xmin:ea,ymax:ma,xres:ra,
yres:pa,inSR:V,outSR:ba,datumTransformation:T,preferPE:4>=A[0],usePixelCenter:oa});pa=[];let ta,xa=0;const ca=oa?-1:NaN,{xmin:ia,xmax:da,ymax:ka,width:la,height:fa}=Y,ua=h(ba,500),wa=p.isSome(na)&&0<ia&&da>na/2;var za=!1;aa&&(za=x(V),za=p.isSome(za)&&0<za.poleLocation);for(V=0;V<sa;V++){aa=[];for(let Aa=0;Aa<va;Aa++){var ya=ra[V*va+Aa];qa&&ya[0]>da&&ya[0]>na/2-ua?ya[0]-=na:qa&&0===V&&0>ya[0]&&wa&&!K&&(ya[0]+=na);!ya||isNaN(ya[0])||isNaN(ya[1])?(pa.push(ca),pa.push(ca),aa.push(null),xa++):(K&&(ya=
K.inverseTransform(new B({x:ya[0],y:ya[1],spatialReference:ba})),ya=[ya.x,ya.y]),aa.push(ya),0<V&&qa&&ta[Aa]&&ya[0]<ta[Aa][0]&&(ya[0]+=na,za&&ya[0]>da&&ya[0]>na&&(ya[0]-=na)),pa.push((ya[0]-ia)/la),pa.push((ka-ya[1])/fa))}ta=aa}return{offsets:pa,error:null,coefficients:null,outofBoundPointCount:xa,spacing:A,size:oa?[sa,va]:[sa-1,va-1]}}function L(A,Q,Y){const {cols:W,rows:T}=Q;Q=new Float32Array((W-1)*(T-1)*12);const K=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),V=new Float32Array([-1,1,0,0,-1,1,
1,0,0]);for(let ma=0;ma<W-1;ma++){for(var ba=0;ba<T-1;ba++){var aa=ma*T*2+2*ba,ea=A[aa];const na=A[aa+1];var ja=A[aa+2],ha=A[aa+3];aa+=2*T;const qa=A[aa],ra=A[aa+1],pa=A[aa+2];aa=A[aa+3];let oa=0,sa=12*(ba*(W-1)+ma);for(let va=0;3>va;va++)Q[sa++]=K[oa++]*ea+K[oa++]*ja+K[oa++]*pa;oa=0;for(ja=0;3>ja;ja++)Q[sa++]=K[oa++]*na+K[oa++]*ha+K[oa++]*aa;oa=0;for(ha=0;3>ha;ha++)Q[sa++]=V[oa++]*ea+V[oa++]*qa+V[oa++]*pa;oa=0;for(ea=0;3>ea;ea++)Q[sa++]=V[oa++]*na+V[oa++]*ra+V[oa++]*aa}if(Y)for(ba=0;ba<Q.length;ba++)isNaN(Q[ba])&&
(Q[ba]=-1)}return Q}var S;(function(A){A[A.None=0]="None";A[A.North=1]="North";A[A.South=2]="South";A[A.Both=3]="Both"})(S||(S={}));const Z=(A,Q,Y,W=0)=>{if(1===Y[0])return[0,0];var T=1,K=-1,V=1,ba=-1;for(var aa=0;aa<A.length;aa+=2)isNaN(A[aa])||(T=T>A[aa]?A[aa]:T,K=K>A[aa]?K:A[aa],V=V>A[aa+1]?A[aa+1]:V,ba=ba>A[aa+1]?ba:A[aa+1]);const {cols:ea,rows:ja}=Q;Q=(K-T)/ea/Y[0];Y=(ba-V)/ja/Y[1];W*=2;V=0;ba=!1;T=[0,0];for(K=0;K<ea-3;K++){for(aa=0;aa<ja-3;aa++){var ha=K*ja*2+2*aa;const ma=Math.abs(((A[ha]+
A[ha+4]+A[ha+4*ja]+A[ha+4*ja+4])/4-A[ha+2*ja+2])/Q);ha=Math.abs(((A[ha+1]+A[ha+5]+A[ha+4*ja+1]+A[ha+4*ja+5])/4-A[ha+2*ja+3])/Y);ma+ha>V&&(V=ma+ha,T=[ma,ha]);if(W&&V>W){ba=!0;break}}if(ba)break}return T},X={3395:2.0037508342789244E7,3410:1.7334193943686873E7,3857:2.0037508342788905E7,3975:1.7367530445161372E7,4087:2.0037508342789244E7,4088:2.0015108787169147E7,6933:1.7367530445161372E7,32662:2.0037508342789244E7,53001:2.001508679602057E7,53002:1.000754339801029E7,53003:2.001508679602057E7,53004:2.001508679602057E7,
53016:1.4152803599503474E7,53017:1.7333573624304302E7,53034:2.001508679602057E7,53079:2.0015114352186374E7,53080:2.0015114352186374E7,54001:2.0037508342789244E7,54002:1.0018754171394624E7,54003:2.0037508342789244E7,54004:2.0037508342789244E7,54016:1.4168658027268292E7,54017:1.736753044516137E7,54034:2.0037508342789244E7,54079:2.0037508342789244E7,54080:2.0037508342789244E7,54100:2.0037508342789244E7,54101:2.0037508342789244E7},M=new Map,O=new Map;P.computeProjectedScales=function(A,Q,Y=512,W=!0){const {extent:T,
spatialReference:K,pixelSize:V}=A,ba=m(new B({x:V.x,y:V.y,spatialReference:K}),Q,T);if(null==ba)return{projectedPixelSize:null,scales:null,srcResolutions:null,isCustomTilingScheme:!1};const aa=(ba.x+ba.y)/2,ea=R.getMetersPerUnitForSR(Q);var ja=aa*ea*96*39.37,ha=Q.isGeographic?256/Y*2.958287637958547E8:256/Y*5.91657527591555E8,ma="vector-magdir"===A.dataType||"vector-uv"===A.dataType,na=t(T,Q),qa=Math.min(Math.ceil(Math.log(Math.min(A.width,A.height)/32)/Math.LN2),Math.ceil(Math.log(ha/2/ja)/Math.LN2));
!ma&&W&&(Q.isGeographic||Q.isWebMercator)&&(ma=0>na.xmin*na.xmax,!ma&&3>qa&&(W=y(Q),p.isSome(W)&&(ma=2**qa*aa*Y,Y=Math.ceil(W/ma),ma=1===Y||2===Y&&W/2-na.xmax<ma)));W=ja;A=Math.min(2,Math.max(1.414,A.storageInfo?.pyramidScalingFactor||2));if(ma)W=ha,ha=Q.isGeographic?1.341104507446289E-6:.29858214164761665,qa=96*ha*ea*39.37,Q=m(new B({x:ha,y:ha,spatialReference:{wkid:Q.isGeographic?4326:3857}}),K,na),Q.x*=W/qa,Q.y*=W/qa;else{Q={x:V.x,y:V.y};for(na=0;W<.5005*ha&&na<qa;)na++,W*=A,Q.x*=A,Q.y*=A;1.001>=
Math.max(W,ha)/Math.min(W,ha)&&(W=ha)}ha=[W];na=[{x:Q.x,y:Q.y}];for(ja=Math.min(70.5310735,ja)/1.001;W>=ja;)W/=A,Q.x/=A,Q.y/=A,ha.push(W),na.push({x:Q.x,y:Q.y});return{projectedPixelSize:ba,scales:ha,srcResolutions:na,isCustomTilingScheme:!ma}};P.defaultGridSpacing=32;P.defaultProjectionToleranceInPixels=4;P.getDefaultDatumTransformationForDataset=function(A,Q,Y){return f(A.spatialReference,Q)?Y?H.getTransformation(Q,A.spatialReference,A):H.getTransformation(A.spatialReference,Q,A):null};P.getProjectedGridPoints=
J;P.getProjectionOffsetGrid=function(A){var Q=A.isAdaptive&&null==A.spacing;let Y=A.spacing||[32,32],W=z(A);var T={cols:W.size[0]+1,rows:W.size[1]+1};const K=0<W.outofBoundPointCount&&W.outofBoundPointCount<W.offsets.length/2;let V=W.outofBoundPointCount===W.offsets.length/2||Q&&K?[0,0]:Z(W.offsets,T,Y,4);const ba=(V[0]+V[1])/2;var aa=A.projectedExtent.spatialReference;const ea=A.srcBufferExtent.spatialReference;Q&&(K||4<ba)&&(k(aa,ea,A.datumTransformation)&&(aa.isGeographic||p.isSome(x(aa))),Y=[4,
4],W=z({...A,spacing:Y}),T={cols:W.size[0]+1,rows:W.size[1]+1},V=Z(W.offsets,T,Y,4));W.error=V;1<Y[0]&&(W.coefficients=L(W.offsets,T,K));!A.includeGCSGrid||aa.isGeographic||aa.isWebMercator||(ea.isGeographic?W.gcsGrid={offsets:W.offsets,coefficients:W.coefficients,spacing:Y}:(Q=x(aa),p.isSome(Q)&&!Q.isEnvelope&&(aa&&!aa.isGeographic&&(Q=String(aa.wkid||aa.wkt),O.has(Q)?aa=O.get(Q):(aa=(aa.wkid?U.PeFactory.coordsys(aa.wkid):U.PeFactory.fromString(U.PeDefs.PE_TYPE_PROJCS,aa.wkt)).getGeogcs().getCode(),
O.set(Q,aa)),aa=new b({wkid:aa})),aa=t(A.projectedExtent,aa),{offsets:A}=z({...A,srcBufferExtent:aa,spacing:Y}),T=L(A,T,K),W.gcsGrid={offsets:A,coefficients:T,spacing:Y})));return W};P.getRasterDatasetAlignmentInfo=function(A){const Q=A.storageInfo.origin.x;var Y=y(A.spatialReference,!0);if(p.isNone(Y))return{originX:Q,halfWorldWidth:null,pyramidsInfo:null};const W=Y/2,{nativePixelSize:T,storageInfo:K,extent:V}=A,{maximumPyramidLevel:ba,blockWidth:aa,pyramidScalingFactor:ea}=K;let ja=T.x;const ha=
[];A=p.isSome(A.transform)&&"gcs-shift"===A.transform.type;const ma=Q+(A?0:W);Y=A?Y-Q:W-Q;for(let na=0;na<=ba;na++){const qa=(V.xmax-Q)/ja/aa,ra=Y/ja/aa;ha.push({resolutionX:ja,blockWidth:aa,datsetColumnCount:0===qa-Math.floor(qa)?qa:Math.ceil(qa),worldColumnCountFromOrigin:0===ra-Math.floor(ra)?ra:Math.ceil(ra),leftMargin:Math.round(ma/ja)%aa,rightPadding:(aa-Math.round(Y/ja)%aa)%aa,originColumnOffset:Math.floor(ma/ja/aa)});ja*=ea}return{originX:Q,halfWorldWidth:W,pyramidsInfo:ha,hasGCSSShiftTransform:A}};
P.getWorldWidth=y;P.getWorldWrapCount=u;P.load=function(){return c.apply(this,arguments)};P.minimumGridSpacing=4;P.projectExtent=t;P.projectPoint=r;P.projectResolution=m;P.requirePE=k;P.snapExtent=function(A){A=A.clone().normalize();return 1===A.length?A[0]:e(A)};P.snapPyramid=function(A,Q,Y){const {storageInfo:W,pixelSize:T}=Q;var K=0;let V=!1;var {pyramidResolutions:ba}=W;if(p.isSome(ba)&&ba.length){A=(A.x+A.y)/2;var aa=ba[ba.length-1];aa=(aa.x+aa.y)/2;var ea=(T.x+T.y)/2;if(A<=ea)K=0;else if(A>=
aa)K=ba.length,V=8<A/aa;else{aa=ea;for(let ja=1;ja<=ba.length;ja++){ea=(ba[ja-1].x+ba[ja-1].y)/2;if(A<=ea){A===ea?K=ja:"down"===Y?(K=ja-1,V=8<A/aa):K="up"===Y?ja:A-aa>ea-A||2<A/aa?ja:ja-1;break}aa=ea}}Y=0===K?T:ba[K-1];V&&(ba=Math.min(Y.x,Y.y),A=R.getMetersPerUnitForSR(Q.spatialReference),19567<ba*A&&(V=!1));return{pyramidLevel:K,pyramidResolution:new B({x:Y.x,y:Y.y,spatialReference:Q.spatialReference}),excessiveReading:V}}K=Math.log(A.x/T.x)/Math.LN2;A=Math.log(A.y/T.y)/Math.LN2;ba=Q.storageInfo.maximumPyramidLevel||
0;K="down"===Y?Math.floor(Math.min(K,A)):"up"===Y?Math.ceil(Math.max(K,A)):Math.round((K+A)/2);0>K?K=0:K>ba&&(V=K>ba+3,K=ba);Y=2**K;Q=new B({x:Y*Q.nativePixelSize.x,y:Y*Q.nativePixelSize.y,spatialReference:Q.spatialReference});return{pyramidLevel:K,pyramidResolution:Q,excessiveReading:V}};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/RasterCodec":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/Error ../../../core/maybe ../PixelBlock ./ImageCanvasDecoder ./JpgPlus ./Lerc ./Lzw ./pixelRangeUtils ../../../chunks/Zlib ./Raw ./TiffDecoder ./utils".split(" "),
function(P,D,F,I,p,R,U,H,N,B,l,b,k,f){function c(u,z){return m.apply(this,arguments)}function m(){m=D._asyncToGenerator(function*(u,z){if(!f.isPlatformLittleEndian)throw new F("rasterCoded:decode","lerc decoder is not supported on big endian platform");yield H.load();const {offset:L}=z,{width:S,height:Z,pixelType:X,statistics:M,depthCount:O,noDataValues:A,bandMasks:Q,pixels:Y,mask:W}=H.decode(u,{inputOffset:L,returnInterleaved:z.returnInterleaved});return new p({width:S,height:Z,pixelType:X.toLowerCase(),
pixels:Y,mask:W,statistics:M,bandMasks:Q,depthCount:O,noDataValues:A})});return m.apply(this,arguments)}function h(u,z){return r.apply(this,arguments)}function r(){r=D._asyncToGenerator(function*(u,z){u=yield k.decode(u,{...z,noDataValue:null});I.assertIsSome(u);u=new p({width:u.width,height:u.height,pixels:u.pixels,pixelType:u.pixelType.toLowerCase(),mask:u.mask,statistics:null});u.updateStatistics();return u});return r.apply(this,arguments)}function E(u,z){return J.apply(this,arguments)}function J(){J=
D._asyncToGenerator(function*(u,z){u=yield k.decodeTileOrStrip(u,z.customOptions);u=new p({width:u.width,height:u.height,pixels:u.pixels,pixelType:u.pixelType.toLowerCase(),mask:u.mask,statistics:null});u.updateStatistics();return u});return J.apply(this,arguments)}function d(u,z){const L=z.pixelType||"u8",S=p.getPixelArrayConstructor(L),Z="u8"===L?u:new S(u.buffer),X=[],M=z.planes||1;if(1===M)X.push(Z);else for(let O=0;O<M;O++){const A=(z.width||1)*(z.height||u.length),Q=new S(A);for(let Y=0;Y<A;Y++)Q[Y]=
Z[Y*M+O];X.push(Q)}u=new p({width:z.width||1,height:z.height||u.length,pixels:X,pixelType:L,statistics:null});u.updateStatistics();return u}function n(u,z){u=(new l.Zlib(new Uint8Array(u))).getBytes();return d(u,z)}function x(u,z){u=N.decode(u,z.offset,z.eof,!z.isInputBigEndian);return d(u,z)}function q(u,z){u=U.decode(u,z.hasNoZlibMask??void 0);u=new p({width:u.width,height:u.height,pixels:u.pixels,pixelType:"U8",mask:u.mask,statistics:null});u.updateStatistics();return u}function g(u,z){u=new Uint8Array(u);
u=new G(u);const {width:L,height:S}=z;z=L*S;u=u.decode();let Z=0;var X=0;let M;X=new Uint8Array(z);for(Z=0;Z<z;Z++)X[Z]=u[4*Z+3];const O=new p({width:L,height:S,pixels:[],pixelType:"U8",mask:X,statistics:[]});for(Z=0;3>Z;Z++){M=new Uint8Array(z);for(X=0;X<z;X++)M[X]=u[4*X+Z];O.addData({pixels:M})}O.updateStatistics();return O}function a(u,z,L,S){return e.apply(this,arguments)}function e(){e=D._asyncToGenerator(function*(u,z,L,S){u=yield(new R).decode(u,{applyJpegMask:!1,format:z,...L},S);u=new p(u);
u.updateStatistics();return u});return e.apply(this,arguments)}function t(u){if(null==u)throw new F("rasterCodec:decode","parameter encodeddata is required.");u=new Uint8Array(u,0,10);let z="";255===u[0]&&216===u[1]?z="jpg":137===u[0]&&80===u[1]&&78===u[2]&&71===u[3]?z="png":67===u[0]&&110===u[1]&&116===u[2]&&90===u[3]&&73===u[4]&&109===u[5]&&97===u[6]&&103===u[7]&&101===u[8]&&32===u[9]?z="lerc":76===u[0]&&101===u[1]&&114===u[2]&&99===u[3]&&50===u[4]&&32===u[5]?z="lerc2":73===u[0]&&73===u[1]&&42===
u[2]&&0===u[3]||77===u[0]&&77===u[1]&&0===u[2]&&42===u[3]||73===u[0]&&73===u[1]&&43===u[2]&&0===u[3]||77===u[0]&&77===u[1]&&0===u[2]&&43===u[3]?z="tiff":71===u[0]&&73===u[1]&&70===u[2]?z="gif":66===u[0]&&77===u[1]?z="bmp":String.fromCharCode.apply(null,u).toLowerCase().includes("error")&&(z="error");return z}function v(u){let z=null;switch(u){case "lerc":case "lerc2":z=c;break;case "jpg":z=q;break;case "png":z=g;break;case "bsq":case "bip":z=(L,S)=>{var Z=S.pixelType,X=null;let M=null;switch(Z?Z.toLowerCase():
"f32"){case "u1":case "u2":case "u4":case "u8":M=255;X=Uint8Array;break;case "u16":M=M||65535;X=Uint16Array;break;case "u32":M=M||2**32-1;X=Uint32Array;break;case "s8":M=M||-128;X=Int8Array;break;case "s16":M=M||-32768;X=Int16Array;break;case "s32":M=M||-(2**31);X=Int32Array;break;default:X=Float32Array}({pixelTypeCtor:Z}={pixelTypeCtor:X,noDataValue:M});X=b.decode;L=X(L,{width:S.width,height:S.height,pixelType:Z,format:u});S=new p({width:S.width,height:S.height,pixels:L.pixels,pixelType:S.pixelType,
mask:L.mask,statistics:null});S.updateStatistics();return S};break;case "tiff":z=h;break;case "deflate":z=n;break;case "lzw":z=x;break;case "error":z=()=>{throw new F("rasterCodec:decode","input data contains error");};break;default:z=()=>{throw new F("rasterCodec:decode","unsupported raster format");}}return z}function w(u,z=1){if(u){var {pixels:L,width:S,height:Z,mask:X}=u;if(L&&0!==L.length){var M=L.length,O=S-1,A=Z-1,Q=[],Y,W,T=null,K=p.getPixelArrayConstructor(u.pixelType);if(0===z){for(z=0;z<
M;z++){var V=L[z];var ba=new K(O*A);for(Y=0;Y<A;Y++){var aa=Y*S;for(W=0;W<O;W++)ba[Y*O+W]=V[aa+W]}Q.push(ba)}if(I.isSome(X))for(T=new Uint8Array(O*A),Y=0;Y<A;Y++)for(aa=Y*S,W=0;W<O;W++)T[Y*O+W]=X[aa+W]}else{for(z=0;z<M;z++){V=L[z];ba=new K(O*A);for(Y=0;Y<A;Y++)for(aa=Y*S,W=0;W<O;W++)ba[Y*O+W]=(V[aa+W]+V[aa+W+1]+V[aa+S+W]+V[aa+S+W+1])/4;Q.push(ba)}if(X)for(T=new Uint8Array(O*A),Y=0;Y<A;Y++)for(aa=Y*S,W=0;W<O;W++)T[Y*O+W]=Math.min.apply(null,[X[aa+W],X[aa+W+1],X[aa+S+W],X[aa+S+W+1]])}u.width=O;u.height=
A;u.mask=T;u.pixels=Q}}}function y(){y=D._asyncToGenerator(function*(u,z={},L){if(null==u)throw new F("rasterCodec:decode","missing encodeddata parameter.");let S=z.format&&z.format.toLowerCase();if(!("bsq"!==S&&"bip"!==S||null!=z.width&&null!=z.height))throw new F("rasterCodec:decode","requires width and height in options parameter.");if("tiff"===S&&z.customOptions)return E(u,z);if(!S||"bsq"!==S&&"bip"!==S&&"deflate"!==S&&"lzw"!==S)S=t(u);if(z.useCanvas&&C.has(S))return a(u,S,z,L);L=v(S);z.isPoint&&
(z={...z},null!=z.width&&z.width++,null!=z.height&&z.height++);u=yield L(u,z);if(!u)return u;"jpg"!==S&&null!=z.noDataValue&&1===u.depthCount&&B.convertNoDataToMask(u,z.noDataValue,{customFloatTolerance:z.tolerance});z.isPoint&&w(u);return u});return y.apply(this,arguments)}var G=function(u){function z(X){var M,O;this.data=X;this.pos=8;this.palette=[];this.imgData=[];this.transparency={};this.animation=null;this.text={};for(O=null;;){var A=this.readUInt32();var Q=X=void 0;X=[];for(Q=0;4>Q;++Q)X.push(String.fromCharCode(this.data[this.pos++]));
X=X.join("");switch(X){case "IHDR":this.width=this.readUInt32();this.height=this.readUInt32();this.bits=this.data[this.pos++];this.colorType=this.data[this.pos++];this.compressionMethod=this.data[this.pos++];this.filterMethod=this.data[this.pos++];this.interlaceMethod=this.data[this.pos++];break;case "acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||Infinity,frames:[]};break;case "PLTE":this.palette=this.read(A);break;case "fcTL":O&&this.animation.frames.push(O);this.pos+=
4;O={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()};X=this.readUInt16();A=this.readUInt16()||100;O.delay=1E3*X/A;O.disposeOp=this.data[this.pos++];O.blendOp=this.data[this.pos++];O.data=[];break;case "IDAT":case "fdAT":"fdAT"===X&&(this.pos+=4,A-=4);X=(null!=O?O.data:void 0)||this.imgData;for(Q=0;0<=A?Q<A:Q>A;0<=A?++Q:--Q)X.push(this.data[this.pos++]);break;case "tRNS":this.transparency={};switch(this.colorType){case 3:this.transparency.indexed=
this.read(A);A=255-this.transparency.indexed.length;if(0<A)for(X=0;0<=A?X<A:X>A;0<=A?++X:--X)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(A)[0];break;case 2:this.transparency.rgb=this.read(A)}break;case "tEXt":Q=this.read(A);A=Q.indexOf(0);X=String.fromCharCode.apply(String,Q.slice(0,A));this.text[X]=String.fromCharCode.apply(String,Q.slice(A+1));break;case "IEND":O&&this.animation.frames.push(O);a:{switch(this.colorType){case 0:case 3:case 4:O=1;break a;
case 2:case 6:O=3;break a}O=void 0}this.colors=O;this.hasAlphaChannel=4===(M=this.colorType)||6===M;M=this.colors+(this.hasAlphaChannel?1:0);this.pixelBitlength=this.bits*M;a:{switch(this.colors){case 1:M="DeviceGray";break a;case 3:M="DeviceRGB";break a}M=void 0}this.colorSpace=M;this.imgData=new Uint8Array(this.imgData);return;default:this.pos+=A}this.pos+=4;if(this.pos>this.data.length)throw Error("Incomplete or corrupt PNG file");}}var L;z.load=function(X,M,O){"function"===typeof M&&(O=M);var A=
new XMLHttpRequest;A.open("GET",X,!0);A.responseType="arraybuffer";A.onload=function(){var Q=new Uint8Array(A.response||A.mozResponseArrayBuffer);Q=new z(Q);"function"===typeof(null!=M?M.getContext:void 0)&&Q.render(M);return"function"===typeof O?O(Q):void 0};return A.send(null)};z.prototype.read=function(X){var M;var O=[];for(M=0;0<=X?M<X:M>X;0<=X?++M:--M)O.push(this.data[this.pos++]);return O};z.prototype.readUInt32=function(){var X=this.data[this.pos++]<<24;var M=this.data[this.pos++]<<16;var O=
this.data[this.pos++]<<8;var A=this.data[this.pos++];return X|M|O|A};z.prototype.readUInt16=function(){var X=this.data[this.pos++]<<8;var M=this.data[this.pos++];return X|M};z.prototype.decodePixels=function(X){var M,O,A,Q,Y,W,T,K;null==X&&(X=this.imgData);if(0===X.length)return new Uint8Array(0);X=new l.Zlib(X);X=X.getBytes();var V=this.pixelBitlength/8;var ba=V*this.width;var aa=new Uint8Array(ba*this.height);var ea=X.length;for(O=Q=Y=0;Q<ea;){switch(X[Q++]){case 0:for(A=M=0;M<ba;A=M+=1)aa[O++]=
X[Q++];break;case 1:for(A=W=0;W<ba;A=W+=1){M=X[Q++];var ja=A<V?0:aa[O-V];aa[O++]=(M+ja)%256}break;case 2:for(A=ja=0;ja<ba;A=ja+=1){M=X[Q++];var ha=(A-A%V)/V;W=Y&&aa[(Y-1)*ba+ha*V+A%V];aa[O++]=(W+M)%256}break;case 3:for(A=K=0;K<ba;A=K+=1)M=X[Q++],ha=(A-A%V)/V,ja=A<V?0:aa[O-V],W=Y&&aa[(Y-1)*ba+ha*V+A%V],aa[O++]=(M+Math.floor((ja+W)/2))%256;break;case 4:for(A=K=0;K<ba;A=K+=1){M=X[Q++];ha=(A-A%V)/V;ja=A<V?0:aa[O-V];0===Y?W=T=0:(W=aa[(Y-1)*ba+ha*V+A%V],T=ha&&aa[(Y-1)*ba+(ha-1)*V+A%V]);var ma=ja+W-T;A=
Math.abs(ma-ja);ha=Math.abs(ma-W);ma=Math.abs(ma-T);ja=A<=ha&&A<=ma?ja:ha<=ma?W:T;aa[O++]=(M+ja)%256}break;default:throw Error("Invalid filter algorithm: "+X[Q-1]);}Y++}return aa};z.prototype.decodePalette=function(){var X,M,O,A;var Q=this.palette;var Y=this.transparency.indexed||[];var W=new Uint8Array((Y.length||0)+Q.length);var T=0;Q.length;var K=M=X=0;for(O=Q.length;M<O;K=M+=3)W[T++]=Q[K],W[T++]=Q[K+1],W[T++]=Q[K+2],W[T++]=null!=(A=Y[X++])?A:255;return W};z.prototype.copyToImageData=function(X,
M){var O,A;var Q=this.colors;var Y=null;var W=this.hasAlphaChannel;this.palette.length&&(Y=null!=(O=this._decodedPalette)?O:this._decodedPalette=this.decodePalette(),Q=4,W=!0);X=X.data||X;var T=X.length;var K=Y||M;O=A=0;if(1===Q)for(;O<T;)Q=Y?4*M[O/4]:A,A=K[Q++],X[O++]=A,X[O++]=A,X[O++]=A,X[O++]=W?K[Q++]:this.transparency.grayscale&&this.transparency.grayscale===A?0:255,A=Q;else for(;O<T;)Q=Y?4*M[O/4]:A,X[O++]=K[Q++],X[O++]=K[Q++],X[O++]=K[Q++],X[O++]=W?K[Q++]:this.transparency.rgb&&this.transparency.rgb[1]===
K[Q-3]&&this.transparency.rgb[3]===K[Q-2]&&this.transparency.rgb[5]===K[Q-1]?0:255,A=Q};z.prototype.decode=function(){var X=new Uint8Array(this.width*this.height*4);this.copyToImageData(X,this.decodePixels());return X};var S=(L=u.document&&u.document.createElement("canvas"))&&L.getContext("2d");var Z=function(X){S.width=X.width;S.height=X.height;S.clearRect(0,0,X.width,X.height);S.putImageData(X,0,0);X=new Image;X.src=L.toDataURL();return X};z.prototype.decodeFrames=function(X){var M,O;if(this.animation){var A=
this.animation.frames;var Q=[];var Y=M=0;for(O=A.length;M<O;Y=++M){Y=A[Y];var W=X.createImageData(Y.width,Y.height);var T=this.decodePixels(new Uint8Array(Y.data));this.copyToImageData(W,T);Y.imageData=W;Q.push(Y.image=Z(W))}return Q}};z.prototype.renderFrame=function(X,M){var O=this.animation.frames;var A=O[M];O=O[M-1];0===M&&X.clearRect(0,0,this.width,this.height);1===(null!=O?O.disposeOp:void 0)?X.clearRect(O.xOffset,O.yOffset,O.width,O.height):2===(null!=O?O.disposeOp:void 0)&&X.putImageData(O.imageData,
O.xOffset,O.yOffset);0===A.blendOp&&X.clearRect(A.xOffset,A.yOffset,A.width,A.height);return X.drawImage(A.image,A.xOffset,A.yOffset)};z.prototype.animate=function(X){var M,O=this;var A=0;var Q=this.animation;var Y=Q.numFrames;var W=Q.frames;var T=Q.numPlays;return(M=function(){var K=A++%Y;var V=W[K];O.renderFrame(X,K);if(1<Y&&A/Y<T)return O.animation._timeout=setTimeout(M,V.delay)})()};z.prototype.stopAnimation=function(){var X;return clearTimeout(null!=(X=this.animation)?X._timeout:void 0)};z.prototype.render=
function(X){X._png&&X._png.stopAnimation();X._png=this;X.width=this.width;X.height=this.height;X=X.getContext("2d");if(this.animation)return this.decodeFrames(X),this.animate(X);var M=X.createImageData(this.width,this.height);this.copyToImageData(M,this.decodePixels());return X.putImageData(M,0,0)};return z}(self);const C=new Set(["jpg","png","bmp","gif"]);P.decode=function(u){return y.apply(this,arguments)};P.getFormat=function(u){u=t(u);"lerc2"===u?u="lerc":"error"===u&&(u="");return u};Object.defineProperty(P,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/ImageCanvasDecoder":function(){define(["../../../core/Error","../../../core/promiseUtils","../../../chunks/Zlib"],function(P,D,F){return function(){function I(p){this._ctx=this._canvas=null;p&&(this._canvas=p.canvas,this._ctx=p.ctx||p.canvas&&p.canvas.getContext("2d"))}I.prototype.decode=function(p,R,U){if(!p||10>p.byteLength)throw new P("imagecanvasdecoder: decode","required a valid encoded data as input.");let {width:H=0,
height:N=0,format:B}=R;const {applyJpegMask:l}=R;if(l&&(!H||!N))throw new P("imagecanvasdecoder: decode","image width and height are needed to apply jpeg mask directly to canvas");return new Promise((b,k)=>{let f=null;"jpg"===B&&l&&(f=I._getMask(p,{width:H,height:N}));const c=new Blob([new Uint8Array(p)],{type:"jpg"==="image/"+B?"jpeg":B}),m=URL.createObjectURL(c),h=new Image;let r;h.src=m;h.onload=()=>{URL.revokeObjectURL(m);if(D.isAborted(U))k(D.createAbortError());else{H=h.width;N=h.height;if(this._canvas&&
this._ctx){if(this._canvas.width!==H||this._canvas.height!==N)this._canvas.width=H,this._canvas.height=N;this._ctx.clearRect(0,0,H,N)}else this._canvas=document.createElement("canvas"),this._canvas.width=H,this._canvas.height=N,this._ctx=this._canvas.getContext("2d");this._ctx.drawImage(h,0,0);var E=this._ctx.getImageData(0,0,H,N);r=E.data;var J;if(R.renderOnCanvas){if(f)for(J=0;J<f.length;J++)r[4*J+3]=f[J]?255:0;this._ctx.putImageData(E,0,0);b(null)}else{E=H*N;var d=new Uint8Array(E),n=new Uint8Array(E),
x=new Uint8Array(E);if(f)for(J=0;J<E;J++)d[J]=r[4*J],n[J]=r[4*J+1],x[J]=r[4*J+2];else for(f=new Uint8Array(E),J=0;J<E;J++)d[J]=r[4*J],n[J]=r[4*J+1],x[J]=r[4*J+2],f[J]=r[4*J+3];b({width:H,height:N,pixels:[d,n,x],mask:f,pixelType:"u8"})}}};h.onerror=()=>{URL.revokeObjectURL(m);k("cannot load image")}})};I._getMask=function(p,R){let U=null;try{var H=new Uint8Array(p);p=0;var N=H.length-2;for(p=Math.ceil(H.length/2);p<N&&(255!==H[p]||217!==H[p+1]);p++);p+=2;if(p<H.length-1){const B=(new F.Zlib(H.subarray(p))).getBytes();
U=new Uint8Array(R.width*R.height);R=0;for(H=0;H<B.length;H++)for(N=7;0<=N;N--)U[R++]=B[H]>>N&1}}catch(B){}return U};return I}()})},"esri/chunks/Zlib":function(){define(["exports"],function(P){var D={};(function(F){(function(I){I=I();void 0!==I&&(F.exports=I)})(function(){var I=function(){function p(){this.bufferLength=this.pos=0;this.eof=!1;this.buffer=null}p.prototype={ensureBuffer:function(R){var U=this.buffer,H=U?U.byteLength:0;if(R<H)return U;for(var N=512;N<R;)N<<=1;R=new Uint8Array(N);for(N=
0;N<H;++N)R[N]=U[N];return this.buffer=R},getByte:function(){for(var R=this.pos;this.bufferLength<=R;){if(this.eof)return null;this.readBlock()}return this.buffer[this.pos++]},getBytes:function(R){var U=this.pos;if(R){this.ensureBuffer(U+R);for(R=U+R;!this.eof&&this.bufferLength<R;)this.readBlock();var H=this.bufferLength;R>H&&(R=H)}else{for(;!this.eof;)this.readBlock();R=this.bufferLength}this.pos=R;return this.buffer.subarray(U,R)},lookChar:function(){for(var R=this.pos;this.bufferLength<=R;){if(this.eof)return null;
this.readBlock()}return String.fromCharCode(this.buffer[this.pos])},getChar:function(){for(var R=this.pos;this.bufferLength<=R;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos++])},makeSubStream:function(R,U,H){for(var N=R+U;this.bufferLength<=N&&!this.eof;)this.readBlock();return new Stream(this.buffer,R,U,H)},skip:function(R){R||(R=1);this.pos+=R},reset:function(){this.pos=0}};return p}();return function(){function p(b){throw Error(b);}function R(b){var k=
0,f=b[k++],c=b[k++];-1!=f&&-1!=c||p("Invalid header in flate stream");8!=(f&15)&&p("Unknown compression method in flate stream");0!=((f<<8)+c)%31&&p("Bad FCHECK in flate stream");c&32&&p("FDICT bit set in flate stream");this.bytes=b;this.bytesPos=k;this.codeBuf=this.codeSize=0;I.call(this)}if(!self||!self.Uint32Array)return null;var U=new Uint32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),H=new Uint32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,
196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),N=new Uint32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),B=[new Uint32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,
59E4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,
524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,
589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,
589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,
590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,
524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,
589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],l=[new Uint32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,
0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5];R.prototype=Object.create(I.prototype);R.prototype.getBits=function(b){for(var k=this.codeSize,f=this.codeBuf,c=this.bytes,m=this.bytesPos,h;k<b;)"undefined"==typeof(h=c[m++])&&p("Bad encoding in flate stream"),f|=h<<k,k+=8;this.codeBuf=f>>b;this.codeSize=k-=b;this.bytesPos=m;return f&(1<<b)-1};R.prototype.getCode=function(b){var k=b[0],f=b[1];b=this.codeSize;for(var c=this.codeBuf,m=
this.bytes,h=this.bytesPos;b<f;){var r;"undefined"==typeof(r=m[h++])&&p("Bad encoding in flate stream");c|=r<<b;b+=8}f=k[c&(1<<f)-1];k=f>>16;f&=65535;(0==b||b<k||0==k)&&p("Bad encoding in flate stream");this.codeBuf=c>>k;this.codeSize=b-k;this.bytesPos=h;return f};R.prototype.generateHuffmanTable=function(b){for(var k=b.length,f=0,c=0;c<k;++c)b[c]>f&&(f=b[c]);for(var m=1<<f,h=new Uint32Array(m),r=1,E=0,J=2;r<=f;++r,E<<=1,J<<=1)for(var d=0;d<k;++d)if(b[d]==r){var n=0,x=E;for(c=0;c<r;++c)n=n<<1|x&1,
x>>=1;for(c=n;c<m;c+=J)h[c]=r<<16|d;++E}return[h,f]};R.prototype.readBlock=function(){function b(n,x,q,g,a){for(n=n.getBits(q)+g;0<n--;)x[E++]=a}var k=this.getBits(3);k&1&&(this.eof=!0);k>>=1;if(0==k){var f=this.bytes,c=this.bytesPos,m;"undefined"==typeof(m=f[c++])&&p("Bad block header in flate stream");var h=m;"undefined"==typeof(m=f[c++])&&p("Bad block header in flate stream");h|=m<<8;"undefined"==typeof(m=f[c++])&&p("Bad block header in flate stream");k=m;"undefined"==typeof(m=f[c++])&&p("Bad block header in flate stream");
(k|m<<8)!=(~h&65535)&&p("Bad uncompressed block length in flate stream");this.codeSize=this.codeBuf=0;m=this.bufferLength;k=this.ensureBuffer(m+h);this.bufferLength=h=m+h;for(var r=m;r<h;++r){if("undefined"==typeof(m=f[c++])){this.eof=!0;break}k[r]=m}this.bytesPos=c}else{if(1==k)c=B,m=l;else if(2==k){k=this.getBits(5)+257;m=this.getBits(5)+1;f=this.getBits(4)+4;c=Array(U.length);for(var E=0;E<f;)c[U[E++]]=this.getBits(3);c=this.generateHuffmanTable(c);E=f=0;m=k+m;for(h=Array(m);E<m;)r=this.getCode(c),
16==r?b(this,h,2,3,f):17==r?b(this,h,3,3,f=0):18==r?b(this,h,7,11,f=0):h[E++]=f=r;c=this.generateHuffmanTable(h.slice(0,k));m=this.generateHuffmanTable(h.slice(k,m))}else p("Unknown block type in flate stream");h=(k=this.buffer)?k.length:0;for(r=this.bufferLength;;){var J=this.getCode(c);if(256>J)r+1>=h&&(k=this.ensureBuffer(r+1),h=k.length),k[r++]=J;else{if(256==J){this.bufferLength=r;break}J-=257;J=H[J];var d=J>>16;0<d&&(d=this.getBits(d));f=(J&65535)+d;J=this.getCode(m);J=N[J];d=J>>16;0<d&&(d=
this.getBits(d));J=(J&65535)+d;r+f>=h&&(k=this.ensureBuffer(r+f),h=k.length);for(d=0;d<f;++d,++r)k[r]=k[r-J]}}}};return R}()})})({get exports(){return D},set exports(F){D=F}});P.Zlib=D})},"esri/layers/support/rasterFormats/JpgPlus":function(){define(["../../../chunks/Jpg","../../../chunks/Zlib"],function(P,D){return function(){function F(){}F.decode=function(I,p=!1){const R=new Uint8Array(I);I=new P.JpegImage;I.parse(R);const {width:U,height:H,numComponents:N,eof:B}=I,l=I.getData(U,H,!0),b=U*H;I=
null;let k=0,f=0,c=0;if(!p&&B<R.length-1)try{var m=(new D.Zlib(R.subarray(B))).getBytes();I=new Uint8Array(b);for(k=p=0;k<m.length;k++)for(c=7;0<=c;c--)I[p++]=m[k]>>c&1}catch{}if(1===N&&l.length===U*H)m=new Uint8Array(l.buffer),m=[m,m,m];else{m=[];for(k=0;3>k;k++)m.push(new Uint8Array(b));for(f=c=0;f<b;f++)for(k=0;3>k;k++)m[k][f]=l[c++]}return{width:U,height:H,pixels:m,mask:I}};return F}()})},"esri/chunks/Jpg":function(){define(["exports"],function(P){var D={};(function(F){(function(I){I=I();void 0!==
I&&(F.exports=I)})(function(){var I=function(){function p(R){this.message="JPEG error: "+R}p.prototype=Error();p.prototype.name="JpegError";return p.constructor=p}();return function(){function p(){this.decodeTransform=null;this.colorTransform=-1}function R(l,b){for(var k=0,f=[],c,m,h=16;0<h&&!l[h-1];)h--;f.push({children:[],index:0});var r=f[0],E;for(c=0;c<h;c++){for(m=0;m<l[c];m++){r=f.pop();for(r.children[r.index]=b[k];0<r.index;)r=f.pop();r.index++;for(f.push(r);f.length<=c;)f.push(E={children:[],
index:0}),r.children[r.index]=E.children,r=E;k++}c+1<h&&(f.push(E={children:[],index:0}),r.children[r.index]=E.children,r=E)}return f[0].children}function U(l,b,k,f,c,m,h,r,E){function J(){if(0<G)return G--,y>>G&1;y=l[b++];if(255===y){var T=l[b++];if(T)throw new I("unexpected marker "+(y<<8|T).toString(16));}G=7;return y>>>7}function d(T){for(;;){T=T[J()];if("number"===typeof T)return T;if("object"!==typeof T)throw new I("invalid huffman sequence");}}function n(T){for(var K=0;0<T;)K=K<<1|J(),T--;
return K}function x(T){if(1===T)return 1===J()?1:-1;var K=n(T);return K>=1<<T-1?K:K+(-1<<T)+1}function q(T,K){var V=d(T.huffmanTableDC);V=0===V?0:x(V);T.blockData[K]=T.pred+=V;for(V=1;64>V;){var ba=d(T.huffmanTableAC),aa=ba&15;ba>>=4;if(0===aa){if(15>ba)break;V+=16}else V+=ba,T.blockData[K+B[V]]=x(aa),V++}}function g(T,K){var V=d(T.huffmanTableDC);V=0===V?0:x(V)<<E;T.blockData[K]=T.pred+=V}function a(T,K){T.blockData[K]|=J()<<E}function e(T,K){if(0<C)C--;else for(var V=m;V<=h;){var ba=d(T.huffmanTableAC),
aa=ba&15;ba>>=4;if(0===aa){if(15>ba){C=n(ba)+(1<<ba)-1;break}V+=16}else V+=ba,T.blockData[K+B[V]]=x(aa)*(1<<E),V++}}function t(T,K){for(var V=m,ba=0,aa;V<=h;){aa=B[V];switch(u){case 0:ba=d(T.huffmanTableAC);aa=ba&15;ba>>=4;if(0===aa)15>ba?(C=n(ba)+(1<<ba),u=4):(ba=16,u=1);else{if(1!==aa)throw new I("invalid ACn encoding");z=x(aa);u=ba?2:3}continue;case 1:case 2:T.blockData[K+aa]?T.blockData[K+aa]+=J()<<E:(ba--,0===ba&&(u=2===u?3:0));break;case 3:T.blockData[K+aa]?T.blockData[K+aa]+=J()<<E:(T.blockData[K+
aa]=z<<E,u=0);break;case 4:T.blockData[K+aa]&&(T.blockData[K+aa]+=J()<<E)}V++}4===u&&(C--,0===C&&(u=0))}var v=k.mcusPerLine,w=b,y=0,G=0,C=0,u=0,z,L=f.length,S,Z,X,M;r=k.progressive?0===m?0===r?g:a:0===r?e:t:q;var O=0;k=1===L?f[0].blocksPerLine*f[0].blocksPerColumn:v*k.mcusPerColumn;for(var A,Q;O<k;){var Y=c?Math.min(k-O,c):k;for(S=0;S<L;S++)f[S].pred=0;C=0;if(1===L){var W=f[0];for(M=0;M<Y;M++)r(W,64*((W.blocksPerLine+1)*(O/W.blocksPerLine|0)+O%W.blocksPerLine)),O++}else for(M=0;M<Y;M++){for(S=0;S<
L;S++)for(W=f[S],A=W.h,Q=W.v,Z=0;Z<Q;Z++)for(X=0;X<A;X++)r(W,64*((W.blocksPerLine+1)*((O/v|0)*W.v+Z)+(O%v*W.h+X)));O++}G=0;(W=N(l,b))&&W.invalid&&(console.log("decodeScan - unexpected MCU data, next marker is: "+W.invalid),b=W.offset);W=W&&W.marker;if(!W||65280>=W)throw new I("marker was not found");if(65488<=W&&65495>=W)b+=2;else break}(W=N(l,b))&&W.invalid&&(console.log("decodeScan - unexpected Scan data, next marker is: "+W.invalid),b=W.offset);return b-w}function H(l,b){l=b.blocksPerLine;for(var k=
b.blocksPerColumn,f=new Int16Array(64),c=0;c<k;c++)for(var m=0;m<l;m++){var h=void 0,r=void 0,E=void 0,J=void 0,d=void 0,n=void 0,x=void 0,q=void 0,g=d=n=J=r=h=void 0,a=void 0,e=void 0,t=void 0,v=64*((b.blocksPerLine+1)*c+m),w=f,y=b.quantizationTable,G=b.blockData;if(!y)throw new I("missing required Quantization Table.");for(var C=0;64>C;C+=8)h=G[v+C],q=G[v+C+1],x=G[v+C+2],n=G[v+C+3],d=G[v+C+4],J=G[v+C+5],E=G[v+C+6],r=G[v+C+7],h*=y[C],0===(q|x|n|d|J|E|r)?(h=5793*h+512>>10,w[C]=h,w[C+1]=h,w[C+2]=h,
w[C+3]=h,w[C+4]=h,w[C+5]=h,w[C+6]=h,w[C+7]=h):(q*=y[C+1],x*=y[C+2],n*=y[C+3],d*=y[C+4],J*=y[C+5],E*=y[C+6],r*=y[C+7],t=5793*h+128>>8,e=5793*d+128>>8,a=x,g=E,d=2896*(q-r)+128>>8,r=2896*(q+r)+128>>8,n<<=4,J<<=4,t=t+e+1>>1,e=t-e,h=3784*a+1567*g+128>>8,a=1567*a-3784*g+128>>8,g=h,d=d+J+1>>1,J=d-J,r=r+n+1>>1,n=r-n,t=t+g+1>>1,g=t-g,e=e+a+1>>1,a=e-a,h=2276*d+3406*r+2048>>12,d=3406*d-2276*r+2048>>12,r=h,h=799*n+4017*J+2048>>12,n=4017*n-799*J+2048>>12,J=h,w[C]=t+r,w[C+7]=t-r,w[C+1]=e+J,w[C+6]=e-J,w[C+2]=a+
n,w[C+5]=a-n,w[C+3]=g+d,w[C+4]=g-d);for(y=0;8>y;++y)h=w[y],q=w[y+8],x=w[y+16],n=w[y+24],d=w[y+32],J=w[y+40],E=w[y+48],r=w[y+56],0===(q|x|n|d|J|E|r)?(h=5793*h+8192>>14,h=-2040>h?0:2024<=h?255:h+2056>>4,G[v+y]=h,G[v+y+8]=h,G[v+y+16]=h,G[v+y+24]=h,G[v+y+32]=h,G[v+y+40]=h,G[v+y+48]=h,G[v+y+56]=h):(t=5793*h+2048>>12,e=5793*d+2048>>12,a=x,g=E,d=2896*(q-r)+2048>>12,r=2896*(q+r)+2048>>12,t=(t+e+1>>1)+4112,e=t-e,h=3784*a+1567*g+2048>>12,a=1567*a-3784*g+2048>>12,g=h,d=d+J+1>>1,J=d-J,r=r+n+1>>1,n=r-n,t=t+g+
1>>1,g=t-g,e=e+a+1>>1,a=e-a,h=2276*d+3406*r+2048>>12,d=3406*d-2276*r+2048>>12,r=h,h=799*n+4017*J+2048>>12,n=4017*n-799*J+2048>>12,J=h,h=t+r,r=t-r,q=e+J,E=e-J,x=a+n,J=a-n,n=g+d,d=g-d,h=16>h?0:4080<=h?255:h>>4,q=16>q?0:4080<=q?255:q>>4,x=16>x?0:4080<=x?255:x>>4,n=16>n?0:4080<=n?255:n>>4,d=16>d?0:4080<=d?255:d>>4,J=16>J?0:4080<=J?255:J>>4,E=16>E?0:4080<=E?255:E>>4,r=16>r?0:4080<=r?255:r>>4,G[v+y]=h,G[v+y+8]=q,G[v+y+16]=x,G[v+y+24]=n,G[v+y+32]=d,G[v+y+40]=J,G[v+y+48]=E,G[v+y+56]=r)}return b.blockData}
function N(l,b,k){var f=l.length-1;k=k<b?k:b;if(b>=f)return null;var c=l[b]<<8|l[b+1];if(65472<=c&&65534>=c)return{invalid:null,marker:c,offset:b};for(b=l[k]<<8|l[k+1];!(65472<=b&&65534>=b);){if(++k>=f)return null;b=l[k]<<8|l[k+1]}return{invalid:c.toString(16),marker:b,offset:k}}if(!self||!self.Uint8ClampedArray)return null;var B=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,
46,53,60,61,54,47,55,62,63]);p.prototype={parse:function(l){function b(){var y=l[c]<<8|l[c+1];c+=2;return y}function k(){var y=b();y=c+y-2;var G=N(l,y,c);G&&G.invalid&&(console.log("readDataBlock - incorrect length, next marker is: "+G.invalid),y=G.offset);y=l.subarray(c,y);c+=y.length;return y}function f(y){for(var G=Math.ceil(y.samplesPerLine/8/y.maxH),C=Math.ceil(y.scanLines/8/y.maxV),u=0;u<y.components.length;u++){w=y.components[u];var z=Math.ceil(Math.ceil(y.samplesPerLine/8)*w.h/y.maxH),L=Math.ceil(Math.ceil(y.scanLines/
8)*w.v/y.maxV);w.blockData=new Int16Array(64*C*w.v*(G*w.h+1));w.blocksPerLine=z;w.blocksPerColumn=L}y.mcusPerLine=G;y.mcusPerColumn=C}var c=0,m=null,h=null,r=[],E=[],J=[],d=b();if(65496!==d)throw new I("SOI not found");for(d=b();65497!==d;){switch(d){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var n=k();65504===d&&74===n[0]&&70===n[1]&&73===n[2]&&70===n[3]&&
0===n[4]&&(m={version:{major:n[5],minor:n[6]},densityUnits:n[7],xDensity:n[8]<<8|n[9],yDensity:n[10]<<8|n[11],thumbWidth:n[12],thumbHeight:n[13],thumbData:n.subarray(14,14+3*n[12]*n[13])});65518===d&&65===n[0]&&100===n[1]&&111===n[2]&&98===n[3]&&101===n[4]&&(h={version:n[5]<<8|n[6],flags0:n[7]<<8|n[8],flags1:n[9]<<8|n[10],transformCode:n[11]});break;case 65499:d=b()+c-2;for(var x;c<d;){var q=l[c++],g=new Uint16Array(64);if(0===q>>4)for(n=0;64>n;n++)x=B[n],g[x]=l[c++];else if(1===q>>4)for(n=0;64>n;n++)x=
B[n],g[x]=b();else throw new I("DQT - invalid table spec");r[q&15]=g}break;case 65472:case 65473:case 65474:if(a)throw new I("Only single frame JPEGs supported");b();var a={};a.extended=65473===d;a.progressive=65474===d;a.precision=l[c++];a.scanLines=b();a.samplesPerLine=b();a.components=[];a.componentIds={};n=l[c++];for(d=g=q=0;d<n;d++){x=l[c];var e=l[c+1]>>4;var t=l[c+1]&15;q<e&&(q=e);g<t&&(g=t);e=a.components.push({h:e,v:t,quantizationId:l[c+2],quantizationTable:null});a.componentIds[x]=e-1;c+=
3}a.maxH=q;a.maxV=g;f(a);break;case 65476:x=b();for(d=2;d<x;){q=l[c++];g=new Uint8Array(16);for(n=e=0;16>n;n++,c++)e+=g[n]=l[c];t=new Uint8Array(e);for(n=0;n<e;n++,c++)t[n]=l[c];d+=17+e;(0===q>>4?J:E)[q&15]=R(g,t)}break;case 65501:b();var v=b();break;case 65498:b();x=l[c++];n=[];for(d=0;d<x;d++){q=a.componentIds[l[c++]];var w=a.components[q];q=l[c++];w.huffmanTableDC=J[q>>4];w.huffmanTableAC=E[q&15];n.push(w)}d=l[c++];x=l[c++];q=l[c++];d=U(l,c,a,n,v,d,x,q>>4,q&15);c+=d;break;case 65535:255!==l[c]&&
c--;break;default:if(255===l[c-3]&&192<=l[c-2]&&254>=l[c-2])c-=3;else throw new I("unknown marker "+d.toString(16));}d=b()}this.width=a.samplesPerLine;this.height=a.scanLines;this.jfif=m;this.eof=c;this.adobe=h;this.components=[];for(d=0;d<a.components.length;d++){w=a.components[d];if(m=r[w.quantizationId])w.quantizationTable=m;this.components.push({output:H(a,w),scaleX:w.h/a.maxH,scaleY:w.v/a.maxV,blocksPerLine:w.blocksPerLine,blocksPerColumn:w.blocksPerColumn})}this.numComponents=this.components.length},
_getLinearizedBlockData:function(l,b){var k=this.width/l,f=this.height/b,c,m,h=0,r=this.components.length,E=l*b*r,J=new Uint8ClampedArray(E),d=new Uint32Array(l);for(m=0;m<r;m++){var n=this.components[m];var x=n.scaleX*k;var q=n.scaleY*f;h=m;var g=n.output;var a=n.blocksPerLine+1<<3;for(c=0;c<l;c++)n=0|c*x,d[c]=(n&4294967288)<<3|n&7;for(x=0;x<b;x++)for(n=0|x*q,n=a*(n&4294967288)|(n&7)<<3,c=0;c<l;c++)J[h]=g[n+d[c]],h+=r}if(b=this.decodeTransform)for(m=0;m<E;)for(l=n=0;n<r;n++,m++,l+=2)J[m]=(J[m]*b[l]>>
8)+b[l+1];return J},_isColorConversionNeeded:function(){return this.adobe?!!this.adobe.transformCode:3===this.numComponents?0===this.colorTransform?!1:!0:1===this.colorTransform?!0:!1},_convertYccToRgb:function(l){for(var b,k,f,c=0,m=l.length;c<m;c+=3)b=l[c],k=l[c+1],f=l[c+2],l[c]=b-179.456+1.402*f,l[c+1]=b+135.459-.344*k-.714*f,l[c+2]=b-226.816+1.772*k;return l},_convertYcckToRgb:function(l){for(var b,k,f,c,m=0,h=0,r=l.length;h<r;h+=4)b=l[h],k=l[h+1],f=l[h+2],c=l[h+3],l[m++]=-122.67195406894+k*(-6.60635669420364E-5*
k+4.37130475926232E-4*f-5.4080610064599E-5*b+4.8449797120281E-4*c-.154362151871126)+f*(-9.57964378445773E-4*f+8.17076911346625E-4*b-.00477271405408747*c+1.53380253221734)+b*(9.61250184130688E-4*b-.00266257332283933*c+.48357088451265)+c*(-3.36197177618394E-4*c+.484791561490776),l[m++]=107.268039397724+k*(2.19927104525741E-5*k-6.40992018297945E-4*f+6.59397001245577E-4*b+4.26105652938837E-4*c-.176491792462875)+f*(-7.78269941513683E-4*f+.00130872261408275*b+7.70482631801132E-4*c-.151051492775562)+b*(.00126935368114843*
b-.00265090189010898*c+.25802910206845)+c*(-3.18913117588328E-4*c-.213742400323665),l[m++]=-20.810012546947+k*(-5.70115196973677E-4*k-2.63409051004589E-5*f+.0020741088115012*b-.00288260236853442*c+.814272968359295)+f*(-1.53496057440975E-5*f-1.32689043961446E-4*b+5.60833691242812E-4*c-.195152027534049)+b*(.00174418132927582*b-.00255243321439347*c+.116935020465145)+c*(-3.43531996510555E-4*c+.24165260232407);return l},_convertYcckToCmyk:function(l){for(var b,k,f,c=0,m=l.length;c<m;c+=4)b=l[c],k=l[c+
1],f=l[c+2],l[c]=434.456-b-1.402*f,l[c+1]=119.541-b+.344*k+.714*f,l[c+2]=481.816-b-1.772*k;return l},_convertCmykToRgb:function(l){for(var b,k,f,c,m=0,h=1/255,r=0,E=l.length;r<E;r+=4)b=l[r]*h,k=l[r+1]*h,f=l[r+2]*h,c=l[r+3]*h,l[m++]=255+b*(-4.387332384609988*b+54.48615194189176*k+18.82290502165302*f+212.25662451639585*c-285.2331026137004)+k*(1.7149763477362134*k-5.6096736904047315*f-17.873870861415444*c-5.497006427196366)+f*(-2.5217340131683033*f-21.248923337353073*c+17.5119270841813)-c*(21.86122147463605*
c+189.48180835922747),l[m++]=255+b*(8.841041422036149*b+60.118027045597366*k+6.871425592049007*f+31.159100130055922*c-79.2970844816548)+k*(-15.310361306967817*k+17.575251261109482*f+131.35250912493976*c-190.9453302588951)+f*(4.444339102852739*f+9.8632861493405*c-24.86741582555878)-c*(20.737325471181034*c+187.80453709719578),l[m++]=255+b*(.8842522430003296*b+8.078677503112928*k+30.89978309703729*f-.23883238689178934*c-14.183576799673286)+k*(10.49593273432072*k+63.02378494754052*f+50.606957656360734*
c-112.23884253719248)+f*(.03296041114873217*f+115.60384449646641*c-193.58209356861505)-c*(22.33816807309886*c+180.12613974708367);return l},getData:function(l,b,k){if(4<this.numComponents)throw new I("Unsupported color mode");l=this._getLinearizedBlockData(l,b);if(1===this.numComponents&&k){k=l.length;b=new Uint8ClampedArray(3*k);for(var f=0,c=0;c<k;c++){var m=l[c];b[f++]=m;b[f++]=m;b[f++]=m}return b}if(3===this.numComponents&&this._isColorConversionNeeded())return this._convertYccToRgb(l);if(4===
this.numComponents){if(this._isColorConversionNeeded())return k?this._convertYcckToRgb(l):this._convertYcckToCmyk(l);if(k)return this._convertCmykToRgb(l)}return l}};return p}()})})({get exports(){return D},set exports(F){D=F}});P.JpegImage=D})},"esri/layers/support/rasterFormats/Lerc":function(){define(["require","exports","../../../assets"],function(P,D,F){function I(B,l,b){b.set(B.slice(l,l+b.length))}function p(B){const {_malloc:l,_free:b,_lerc_getBlobInfo:k,_lerc_getDataRanges:f,_lerc_decode_4D:c,
asm:m}=B;let h;const r=Object.values(m).find(J=>J&&"buffer"in J&&J.buffer===B.HEAPU8.buffer),E=J=>{J=J.map(x=>(x>>3<<3)+16);var d=J.reduce((x,q)=>x+q),n=l(d);h=new Uint8Array(r.buffer);d=J[0];J[0]=n;for(n=1;n<J.length;n++){const x=J[n];J[n]=J[n-1]+d;d=x}return J};N.getBlobInfo=J=>{var d=new Uint8Array(48),n=new Uint8Array(24);const [x,q,g]=E([J.length,d.length,n.length]);h.set(J,x);h.set(d,q);h.set(n,g);var a=k(x,J.length,q,g,12,3);if(a)throw b(x),Error(`lerc-getBlobInfo: error code is ${a}`);h=new Uint8Array(r.buffer);
I(h,q,d);I(h,g,n);d=new Uint32Array(d.buffer);var e=new Float64Array(n.buffer);const [t,v,,w,y,G,C,u,z,L,S]=d;n={version:t,depthCount:L,width:w,height:y,validPixelCount:C,bandCount:G,blobSize:u,maskCount:z,dataType:v,minValue:e[0],maxValue:e[1],maxZerror:e[2],statistics:[],bandCountWithNoData:S};if(S)return n;if(1===L&&1===G)return b(x),n.statistics.push({minValue:e[0],maxValue:e[1]}),n;a=L*G*8;var Z=new Uint8Array(a),X=new Uint8Array(a);d=x;var M=e=0;let O=!1;h.byteLength<x+2*a?(b(x),O=!0,[d,e,M]=
E([J.length,a,a]),h.set(J,d)):[e,M]=E([a,a]);h.set(Z,e);h.set(X,M);if(a=f(d,J.length,L,G,e,M))throw b(d),O||b(e),Error(`lerc-getDataRanges: error code is ${a}`);h=new Uint8Array(r.buffer);I(h,e,Z);I(h,M,X);J=new Float64Array(Z.buffer);a=new Float64Array(X.buffer);X=n.statistics;for(Z=0;Z<G;Z++)if(1<L){M=J.slice(Z*L,(Z+1)*L);const A=a.slice(Z*L,(Z+1)*L),Q=Math.min.apply(null,M),Y=Math.max.apply(null,A);X.push({minValue:Q,maxValue:Y,depthStats:{minValues:M,maxValues:A}})}else X.push({minValue:J[Z],
maxValue:a[Z]});b(d);O||b(e);return n};N.decode=(J,d)=>{const {maskCount:n,depthCount:x,bandCount:q,width:g,height:a,dataType:e,bandCountWithNoData:t}=d;var v=R[e],w=g*a;d=new Uint8Array(w*q);v=new Uint8Array(w*x*q*v.size);w=new Uint8Array(q);var y=new Uint8Array(8*q);const [G,C,u,z,L]=E([J.length,d.length,v.length,w.length,y.length]);h.set(J,G);h.set(d,C);h.set(v,u);h.set(w,z);h.set(y,L);if(J=c(G,J.length,n,C,x,g,a,q,e,u,z,L))throw b(G),Error(`lerc-decode: error code is ${J}`);h=new Uint8Array(r.buffer);
I(h,u,v);I(h,C,d);J=null;if(t){I(h,z,w);I(h,L,y);J=[];y=new Float64Array(y.buffer);for(let S=0;S<w.length;S++)J.push(w[S]?y[S]:null)}b(G);return{data:v,maskData:d,noDataValues:J}}}const R=[{pixelType:"S8",size:1,ctor:Int8Array,range:[-128,127]},{pixelType:"U8",size:1,ctor:Uint8Array,range:[0,255]},{pixelType:"S16",size:2,ctor:Int16Array,range:[-32768,32767]},{pixelType:"U16",size:2,ctor:Uint16Array,range:[0,65536]},{pixelType:"S32",size:4,ctor:Int32Array,range:[-2147483648,2147483647]},{pixelType:"U32",
size:4,ctor:Uint32Array,range:[0,4294967296]},{pixelType:"F32",size:4,ctor:Float32Array,range:[-3.4027999387901484E38,3.4027999387901484E38]},{pixelType:"F64",size:8,ctor:Float64Array,range:[-1.7976931348623157E308,1.7976931348623157E308]}];let U=null,H=!1;const N={getBlobInfo:null,decode:null};D.decode=function(B,l={}){var b=l.inputOffset??0;B=B instanceof Uint8Array?B.subarray(b):new Uint8Array(B,b);b=N.getBlobInfo(B);const {data:k,maskData:f,noDataValues:c}=N.decode(B,b),{width:m,height:h,bandCount:r,
depthCount:E,dataType:J,maskCount:d,statistics:n}=b;var x=R[J],q=new x.ctor(k.buffer);B=[];b=[];const g=m*h;var a=g*E;for(var e=0;e<r;e++){var t=q.subarray(e*a,(e+1)*a);if(l.returnInterleaved)B.push(t);else{a:{var v=g,w=E;if(2>w)break a;const y=new x.ctor(v*w);for(let G=0,C=0;G<v;G++)for(let u=0,z=G;u<w;u++,z+=v)y[z]=t[C++];t=y}B.push(t)}b.push(f.subarray(e*a,(e+1)*a))}q=0===d?null:1===d?b[0]:new Uint8Array(g);if(1<d)for(q.set(b[0]),a=1;a<b.length;a++)for(e=b[a],t=0;t<g;t++)q[t]&=e[t];({noDataValue:l}=
l);a=null!=l&&x.range[0]<=l&&x.range[1]>=l;if(0<d&&a)for(a=0;a<r;a++)for(e=B[a],t=b[a]||q,v=0;v<g;v++)0===t[v]&&(e[v]=l);({pixelType:x}=x);return{width:m,height:h,bandCount:r,pixelType:x,depthCount:E,statistics:n,pixels:B,mask:q,bandMasks:d===r&&1<r?b:null,noDataValues:c}};D.getBlobInfo=function(B,l={}){B=B instanceof Uint8Array?B.subarray(l.inputOffset??0):new Uint8Array(B,l.inputOffset??0);return N.getBlobInfo(B)};D.isLoaded=function(){return H};D.load=function(){return U?U:U=(new Promise((B,l)=>
P(["../../../chunks/lerc-wasm"],B,l))).then(B=>B.lercWasm).then(({default:B})=>B({locateFile:l=>F.getAssetUrl(`esri/layers/support/rasterFormats/${l}`)})).then(B=>{p(B);H=!0})};D.pixelTypeInfoMap=R;Object.defineProperty(D,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/Lzw":function(){define(["exports"],function(P){function D(R,U,H,N=!0){if(0!==U%4||0!==H%4){var B=new ArrayBuffer(4*Math.ceil(H/4));B=new Uint8Array(B);R=new Uint8Array(R,U,H);if(N)for(N=0;N<B.length;N+=4)B[N]=
R[N+3],B[N+1]=R[N+2],B[N+2]=R[N+1],B[N+3]=R[N];else B.set(R);return new Uint32Array(B.buffer)}if(N){N=new Uint8Array(R,U,H);B=new Uint8Array(N.length);for(R=0;R<B.length;R+=4)B[R]=N[R+3],B[R+1]=N[R+2],B[R+2]=N[R+1],B[R+3]=N[R];return new Uint32Array(B.buffer)}return new Uint32Array(R,U,H/4)}function F(){const R=[];for(let U=0;257>=U;U++)R[U]=[U];return R}function I(R,U){for(let H=0;H<U.length;H++)R.push(U[H])}const p=new Set;p.add(511);p.add(1023);p.add(2047);p.add(4095);p.add(8191);P.decode=function(R,
U,H,N=!0){R=D(R,U,H,N);U=9;N=F();let B=32,l=N.length,b=[],k=1,f=R[0],c=0;const m=R.length;H=8*(4*m-H);const h=[];for(;null!=f;){if(B>=U)B-=U,c=f>>>32-U,f<<=U;else{c=f>>>32-B;f=R[k++];var r=U-B;B=32-r;c=(c<<r)+(f>>>B);f<<=r}if(257===c)break;if(256===c)U=9,N=F(),l=N.length,b=[];else{r=N[c];if(null==r){if(c>N.length)throw Error("data integrity issue: code does not exist on code page");b.push(b[0]);N[l++]=b.slice();I(h,b)}else I(h,r),b.push(r[0]),1<b.length&&(N[l++]=b.slice()),b=r.slice();p.has(l)&&U++;
0===B&&(f=R[k++],B=32);if(k>m||k===m&&B<=H)break}}return new Uint8Array(h)};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/Raw":function(){define(function(){const P=D=>{let F=1;switch(D){case Uint8Array:case Int8Array:F=1;break;case Uint16Array:case Int16Array:F=2;break;case Uint32Array:case Int32Array:case Float32Array:F=4;break;case Float64Array:F=8}return F};return function(){function D(){}D.decode=function(F,I){var p=I.pixelType;const R=[],U=
I.width*I.height;var H=Math.floor(F.byteLength/(I.width*I.height*P(I.pixelType)));const {bandIds:N,format:B}=I;I=N&&N.length||Math.floor(F.byteLength/(I.width*I.height*P(I.pixelType)));var l=F.byteLength-F.byteLength%(U*P(p)),b=new p(F,0,U*H);let k,f,c,m,h=null;if("bip"===B)for(k=0;k<I;k++){c=new p(U);m=N?N[k]:k;for(f=0;f<U;f++)c[f]=b[f*H+m];R.push(c)}else if("bsq"===B)for(k=0;k<I;k++)m=N?N[k]:k,R.push(b.subarray(m*U,(m+1)*U));if(l<F.byteLength-1)if(F=F.slice(l),8*F.byteLength<U)h=null;else{F=new Uint8Array(F,
0,Math.ceil(U/8));p=new Uint8Array(U);for(l=b=l=I=H=0;l<F.length-1;l++)for(I=F[l],b=7;0<=b;b--)p[H++]=I>>b&1;for(b=7;H<U-1;)I=F[F.length-1],p[H++]=I>>b&1,b--;h=p}return{pixels:R,mask:h}};return D}()})},"esri/layers/support/rasterFormats/TiffDecoder":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../rasterDatasets/byteStreamUtils ../../../chunks/Jpg ./Lerc ./Lzw ./pixelRangeUtils ./TiffTags ./utils ../../../chunks/Zlib".split(" "),function(P,D,F,I,p,R,U,H,N,B){function l(M,O){let A=
"unknown";3===M?A=64===O?"f64":"f32":1===M?1===O?A="u1":2===O?A="u2":4===O?A="u4":8>=O?A="u8":16>=O?A="u16":32>=O&&(A="u32"):2===M&&(8>=O?A="s8":16>=O?A="s16":32>=O&&(A="s32"));return A}function b(M){let O=null;switch(M?M.toLowerCase():"f32"){case "u1":case "u2":case "u4":case "u8":O=Uint8Array;break;case "u16":O=Uint16Array;break;case "u32":O=Uint32Array;break;case "s8":O=Int8Array;break;case "s16":O=Int16Array;break;case "s32":O=Int32Array;break;case "f64":O=Float64Array;break;default:O=Float32Array}return O}
function k(M,O){return{x:O[0]*M.x+O[1]*M.y+O[2],y:O[3]*M.x+O[4]*M.y+O[5]}}function f(M,O){return M.get(O)?.values?.[0]}function c(M,O,A,Q=0,Y=H.TIFF_TAGS,W=4){var T=8===W;const K=T?v(new DataView(M,A,8),0,O):(new DataView(M,A,2)).getUint16(0,O),V=4+2*W;var ba=T?8:2;T=ba+K*V;if(A+T>M.byteLength)return{success:!1,ifd:null,nextIFD:null,requiredBufferSize:T};const aa=A+T+4<=M.byteLength?w(new DataView(M,A+T,8===W?8:4),0,O,8===W):null;A+=ba;ba=new Map;let ea,ja,ha,ma=0,na=0;for(let ra=0;ra<K;ra++){var qa=
new DataView(M,A+V*ra,V);ea=qa.getUint16(0,O);ha=qa.getUint16(2,O);ja=H.getTagName(ea,Y);const pa=[];2===W?(ma=qa.getUint16(4,O),na=qa.getUint16(6,O)):4===W?(ma=qa.getUint32(4,O),na=qa.getUint32(8,O)):8===W&&(ma=w(qa,4,O,!0),na=w(qa,12,O,!0),pa.push(qa.getUint32(12,O)),pa.push(qa.getUint32(16,O)));qa={id:ea,type:ha,valueCount:ma,valueOffset:na,valueOffsets:pa,values:null};x(M,O,qa,Q,!1,W);ba.set(ja,qa)}return{success:!0,ifd:ba,nextIFD:aa,requiredBufferSize:T}}function m(M,O){if(1!==O&&2!==O&&4!==
O)return M;const A=new Uint8Array(M),Q=8/O;M=new Uint8Array(M.byteLength*Q);let Y=0;const W=2**O-1;for(let T=0;T<A.length;T++){const K=A[T];for(let V=0;V<Q;V++)M[Y++]=K<<O*V>>>8-O&W}return M.buffer}function h(M,O,A){const Q=new I.JpegImage;Q.parse(M);Q.colorTransform=6===A?-1:0;M=Q.getData(Q.width,Q.height,1!==O);return new Uint8Array(M.buffer)}function r(M){M=(new B.Zlib(M)).getBytes();var O=new ArrayBuffer(M.length);O=new Uint8Array(O);O.set(M);return O}function E(M,O,A,Q,Y){return J.apply(this,
arguments)}function J(){J=D._asyncToGenerator(function*(M,O,A,Q,Y){var W=N.isPlatformLittleEndian===O,T=f(A,"BITSPERSAMPLE"),K=f(A,"SAMPLESPERPIXEL");const V=f(A,"PHOTOMETRICINTERPRETATION");var ba=f(A,"SAMPLEFORMAT")??1;const aa=l(ba,T);var ea=f(A,"COMPRESSION")??1;ba=b(aa);if(34887===ea)return yield p.load(),p.decode(M,{inputOffset:Q}).pixels[0];if(1===ea)K=M.slice(Q,Q+Y),O=new Uint8Array(K);else if(8===ea||32946===ea)O=new Uint8Array(M,Q,Y),O=r(O),K=O.buffer;else if(6===ea)O=new Uint8Array(M,Q,
Y),O=h(O,K,V),K=O.buffer;else if(7===ea){ea=A.get("JPEGTABLES").values;A=ea.length-2;O=new Uint8Array(A+Y-2);for(let ja=0;ja<A;ja++)O[ja]=ea[ja];M=new Uint8Array(M,Q+2,Y-2);for(Q=0;Q<M.length;Q++)O[A+Q]=M[Q];O=h(O,K,V);K=O.buffer}else if(5===ea)O=R.decode(M,Q,Y,O),K=O.buffer;else throw Error("tiff-decode: unsupport compression "+ea);K=m(K,T);if("u8"!==aa&&"s8"!==aa&&!W)switch(K=new ArrayBuffer(O.length),W=new Uint8Array(K),aa){case "u16":case "s16":for(T=0;T<O.length;T+=2)W[T]=O[T+1],W[T+1]=O[T];
break;case "u32":case "s32":case "f32":for(T=0;T<O.length;T+=4)W[T]=O[T+3],W[T+1]=O[T+2],W[T+2]=O[T+1],W[T+3]=O[T]}return new ba(K)});return J.apply(this,arguments)}function d(M,O,A){return n.apply(this,arguments)}function n(){n=D._asyncToGenerator(function*(M,O,A){const Q=A.get("TILEOFFSETS")?.values;if(void 0===Q)return null;const Y=A.get("TILEBYTECOUNTS")?.values,{width:W,height:T,pixelType:K,tileWidth:V,tileHeight:ba}=q([A]);var aa=g(A,O);const ea=f(A,"SAMPLESPERPIXEL")||O.planes;var ja=W*T,ha=
f(A,"BITSPERSAMPLE"),ma=34887===(f(A,"COMPRESSION")??1),na=b(K);const qa=[];for(var ra=0;ra<ea;ra++)qa.push(new na(ja));let pa,oa,sa,va,ta,xa,ca,ia;ja=Math.ceil(W/V);if(0===ha%8)if(ma&&aa&&1<ea)for(aa=Math.round(Q.length/ea),ha=0;ha<aa;ha++){var da=Math.floor(ha/ja)*ba;sa=ha%ja*V;na=da*W+sa;for(ma=0;ma<ea;ma++)if(ra=ha*ea+ma,0!==Y[ra])for(ra=yield E(M,O.littleEndian,A,Q[ra],Y[ra]),ta=0,va=na,ca=Math.min(V,W-sa),xa=Math.min(ba,T-da),ia=qa[ma],pa=0;pa<xa;pa++)for(va=na+pa*W,ta=pa*V,oa=0;oa<ca;oa++,
va++,ta++)ia[va]=ra[ta]}else for(ha=0;ha<Q.length;ha++)if(0!==Y[ha])for(da=Math.floor(ha/ja)*ba,sa=ha%ja*V,na=da*W+sa,ra=yield E(M,O.littleEndian,A,Q[ha],Y[ha]),ta=0,va=na,ca=Math.min(V,W-sa),xa=Math.min(ba,T-da),da=0;da<ea;da++)if(ia=qa[da],aa||ma)for(pa=0;pa<xa;pa++)for(va=na+pa*W,ta=V*ba*da+pa*V,oa=0;oa<ca;oa++,va++,ta++)ia[va]=ra[ta];else for(pa=0;pa<xa;pa++)for(va=na+pa*W,ta=pa*V*ea+da,oa=0;oa<ca;oa++,va++,ta+=ea)ia[va]=ra[ta];return{width:W,height:T,pixelType:K,pixels:qa}});return n.apply(this,
arguments)}function x(M,O,A,Q=0,Y=!1,W=4){if(A.values)return!0;var T=A.type,K=A.valueCount,V=A.valueOffset;let ba=[];var aa=L[T],ea=8*aa,ja=K*aa,ha=K*L[T]*8,ma=8===W?64:32;W=A.valueOffsets;if(ha>ma&&ja>(Y?M.byteLength:M?M.byteLength-V+Q:0))return A.offlineOffsetSize=[V,ja],A.values=null,!1;if(ha<=ma)if(O||(32>=ma?V>>>=32-ha:(M=W?.length?W[0]:V>>>0,O=W?.length?W[1]:Math.round((V-M)/4294967296),32>=ha?(V=M>>>32-ha,W[0]=V):(V=M*2**(32-ha)+(O>>>32-ha),W[0]=M,W[1]=O>>>32-ha))),1===K&&ea===ma)ba=[V];else if(64===
ma)for(M=W?.length?W[0]:V>>>0,V=W?.length?W[1]:Math.round((V-M)/4294967296),O=M,aa=32,M=1;M<=K;M++)ja=32-ea*M%32,aa<ea?(ja=O<<ja>>>32-aa,ha=V<<32-aa>>>32-aa,O=V,ba.push(ja+ha*2**(ea-aa)),aa-=32-(ea-aa)):(ba.push(O<<ja>>>32-ea),aa-=ea),0===aa&&(aa=32,O=V);else for(M=1;M<=K;M++)ba.push(V<<32-ea*M>>>32-ea);else for(V-=Q,Y&&(V=0),K=V;K<V+ja;K+=aa){switch(T){case 1:ea=(new DataView(M,K,1)).getUint8(0);break;case 2:ea=(new DataView(M,K,1)).getUint8(0);break;case 3:ea=(new DataView(M,K,2)).getUint16(0,O);
break;case 4:case 13:ea=(new DataView(M,K,4)).getUint32(0,O);break;case 5:ea=(new DataView(M,K,4)).getUint32(0,O)/(new DataView(M,K+4,4)).getUint32(0,O);break;case 6:ea=(new DataView(M,K,1)).getInt8(0);break;case 7:ea=(new DataView(M,K,1)).getUint8(0);break;case 8:ea=(new DataView(M,K,2)).getInt16(0,O);break;case 9:ea=(new DataView(M,K,4)).getInt32(0,O);break;case 10:ea=(new DataView(M,K,4)).getInt32(0,O)/(new DataView(M,K+4,4)).getInt32(0,O);break;case 11:ea=(new DataView(M,K,4)).getFloat32(0,O);
break;case 12:ea=(new DataView(M,K,8)).getFloat64(0,O);break;case 16:case 18:ea=v(new DataView(M,K,8),0,O);break;case 17:W=new DataView(M,K,8);ha=(ea=O)?W.getInt32(0,ea):W.getUint32(0,ea);W=ea?W.getUint32(4,ea):W.getInt32(4,ea);ma=0<=(ea?ha:W)?1:-1;ea?ha*=ma:W*=ma;ea=ma*(ea?4294967296*W+ha:4294967296*ha+W);break;default:ea=null}ba.push(ea)}if(2===T){T="";V=ba;ba=[];for(M=0;M<V.length;M++)0===V[M]&&""!==T?(ba.push(T),T=""):T+=String.fromCharCode(V[M]);""===T&&0!==ba.length||ba.push(T)}A.values=ba;
return!0}function q(M){var O=M[0];const A=f(O,"TILEWIDTH"),Q=f(O,"TILELENGTH"),Y=f(O,"IMAGEWIDTH"),W=f(O,"IMAGELENGTH");var T=f(O,"BITSPERSAMPLE");const K=f(O,"SAMPLESPERPIXEL");var V=f(O,"SAMPLEFORMAT")??1;const ba=l(V,T),aa=g(O);var ea=O.get("GDAL_NODATA")?.values;let ja=null;ea?.length&&(ja=ea.map(da=>parseFloat(da)),ja.some(da=>isNaN(da))&&(ja=null));var ha=f(O,"COMPRESSION")??1;switch(ha){case 1:ea="NONE";break;case 2:case 3:case 4:case 32771:ea="CCITT";break;case 5:ea="LZW";break;case 6:case 7:ea=
"JPEG";break;case 32773:ea="PACKBITS";break;case 8:case 32946:ea="DEFLATE";break;case 34712:ea="JPEG2000";break;case 34887:ea="LERC";break;default:ea=String(ha)}let ma=!0,na="";S.has(ha)||(ma=!1,na+="unsupported tag compression "+ha);3<V&&(ma=!1,na+="unsupported tag sampleFormat "+V);1!==T&&2!==T&&4!==T&&0!==T%8&&(ma=!1,na+="unsupported tag bitsPerSample "+T);T=O.get("GEOASCIIPARAMS")?.values?.[0];if(T){var qa=(qa=T.split("|").find(da=>da.includes("ESRI PE String \x3d ")))?qa.replace("ESRI PE String \x3d ",
""):"";qa=qa.startsWith("COMPD_CS")||qa.startsWith("PROJCS")||qa.startsWith("GEOGCS")?{wkid:null,wkt:qa}:null}V=O.get("GEOTIEPOINTS")?.values;T=O.get("GEOPIXELSCALE")?.values;ha=O.get("GEOTRANSMATRIX")?.values;var ra=O.has("GEOKEYDIRECTORY")?O.get("GEOKEYDIRECTORY").data:null,pa=!1;O=!1;if(ra){pa=2===f(ra,"GTRasterTypeGeoKey");var oa=f(ra,"GTModelTypeGeoKey");2===oa?(ra=f(ra,"GeographicTypeGeoKey"),1024<=ra&&32766>=ra&&(qa={wkid:ra}),qa||32767!==ra||(O=!0,qa={wkid:4326})):1===oa&&(ra=f(ra,"ProjectedCSTypeGeoKey"),
1024<=ra&&32766>=ra&&(qa={wkid:ra}))}let sa;T&&V&&6<=V.length?(sa=[T[0],0,V[3]-V[0]*T[0],0,-Math.abs(T[1]),V[4]-V[1]*T[1]],pa&&(sa[2]-=.5*sa[0]+.5*sa[1],sa[5]-=.5*sa[3]+.5*sa[4])):ha&&16===ha.length&&(sa=pa?[ha[0],ha[1],ha[3]-.5*ha[0],ha[4],ha[5],ha[7]-.5*ha[5]]:[ha[0],ha[1],ha[3],ha[4],ha[5],ha[7]]);if(sa){V=[{x:0,y:W},{x:0,y:0},{x:Y,y:W},{x:Y,y:0}];ra=pa=Number.POSITIVE_INFINITY;let da=oa=Number.NEGATIVE_INFINITY;for(let ka=0;ka<V.length;ka++)ha=k(V[ka],sa),pa=ha.x>pa?pa:ha.x,oa=ha.x<oa?oa:ha.x,
ra=ha.y>ra?ra:ha.y,da=ha.y<da?da:ha.y;V={xmin:pa,xmax:oa,ymin:ra,ymax:da,spatialReference:qa}}else V={xmin:-.5,ymin:.5-W,xmax:Y-.5,ymax:.5,spatialReference:qa};O&&(400<V.xmax-V.xmin||361<Math.max(Math.abs(V.xmin),Math.abs(V.xmax)))&&(qa=null,V.spatialReference=null);qa=a(M);let va;let ta,xa;if(0<qa.length){ta=Math.round(Math.log(Y/f(qa[0],"IMAGEWIDTH"))/Math.LN2);var ca=qa[qa.length-1];xa=Math.round(Math.log(Y/f(ca,"IMAGEWIDTH"))/Math.LN2);va=f(ca,"TILEWIDTH");ca=f(ca,"TILELENGTH")}va=null!=xa&&0<
xa?va||A:null;ca=null!=xa&&0<xa?ca||Q:null;let ia;A&&(ia=[{maxCol:Math.ceil(Y/A)-1,maxRow:Math.ceil(W/Q)-1,minRow:0,minCol:0}],qa.forEach(da=>{ia.push({maxCol:Math.ceil(f(da,"IMAGEWIDTH")/f(da,"TILEWIDTH"))-1,maxRow:Math.ceil(f(da,"IMAGELENGTH")/f(da,"TILELENGTH"))-1,minRow:0,minCol:0})}));ha=M[0].get("GDAL_METADATA")?.values?.[0];ha=X(ha);na+=" "+C({width:Y,height:W,tileWidth:A,tileHeight:Q,planes:K,ifds:M});M=e(M).length===qa.length+1;return{width:Y,height:W,tileWidth:A,tileHeight:Q,planes:K,isBSQ:aa,
pixelType:ba,compression:ea,noData:ja,hasMaskBand:M,isSupported:ma,message:na,extent:V,isPseudoGeographic:O,affine:T?null:sa,firstPyramidLevel:ta,maximumPyramidLevel:xa,pyramidBlockWidth:va,pyramidBlockHeight:ca,tileBoundary:ia,metadata:ha}}function g(M,O){return(M=M.get("PLANARCONFIGURATION")?.values)?2===M[0]:O?O.isBSQ:!1}function a(M){return M.filter(O=>1===f(O,"NEWSUBFILETYPE"))}function e(M){return M.filter(O=>{const A=4===((f(O,"NEWSUBFILETYPE")??0)&4);O=4===f(O,"PHOTOMETRICINTERPRETATION");
return A&&O})}function t(M){const {littleEndian:O,isBigTiff:A,firstIFDPos:Q}=y(M);var Y=Q;const W=[];do if(Y=G(M,O,Y,0,H.TIFF_TAGS,A?8:4),Y.success)W.push(Y.ifd),Y=Y.nextIFD;else break;while(0<Y);M=q(W);Y=a(W);const T=e(W);return{...M,littleEndian:O,isBigTiff:A,ifds:W,pyramidIFDs:Y,maskIFDs:T}}function v(M,O,A){const Q=M.getUint32(O,A);M=M.getUint32(O+4,A);return A?4294967296*M+Q:4294967296*Q+M}function w(M,O,A,Q){return Q?v(M,O,A):M.getUint32(O,A)}function y(M){var O=new DataView(M,0,16),A=O.getUint16(0,
!1);M=null;if(18761===A)M=!0;else if(19789===A)M=!1;else throw Error("unexpected endianess byte");var Q=O.getUint16(2,M);if(42!==Q&&43!==Q)throw Error("unexpected tiff identifier");A=4;if(Q=43===Q){const Y=O.getUint16(A,M);A+=2;if(8!==Y)throw Error("unsupported bigtiff version");if(0!==O.getUint16(A,M))throw Error("unsupported bigtiff version");A+=2}O=w(O,A,M,Q);return{littleEndian:M,isBigTiff:Q,firstIFDPos:O}}function G(M,O,A,Q=0,Y=H.TIFF_TAGS,W=4){A=c(M,O,A,Q,Y,W);let T;const K=A.ifd;K&&(H.ifdTags.forEach((V,
ba)=>{K.has(ba)&&(T=K.get(ba),T.data=c(M,O,T.valueOffset-Q,Q,V).ifd)}),K.has("GEOKEYDIRECTORY")&&(T=K.get("GEOKEYDIRECTORY"),(Y=T.values)&&4<Y.length&&(Y=Y[0]+"."+Y[1]+"."+Y[2],T.data=c(M,O,T.valueOffset+6-Q,Q,H.GEO_KEYS,2).ifd,T.data&&T.data.set("GEOTIFFVersion",{id:0,type:2,valueCount:1,valueOffset:null,values:[Y]}))),K.has("XMP")&&(T=K.get("XMP"),Y=T.values,"number"===typeof Y[0]&&7===T.type&&(T.values=[F.bytesToUTF8(new Uint8Array(Y))])));return A}function C(M){const {width:O,height:A,tileHeight:Q,
tileWidth:Y}=M,W=M.planes,T=Y?Y*Q:O*A;M=f(M.ifds[0],"BITSPERSAMPLE");let K="";T*W>2**30/(8<M?M/8:1)&&(K=Y?"tiled tiff exceeding 1 gigabits per tile is not supported":"scanline tiff exceeding 1 gigabits is not supported");return K}function u(){u=D._asyncToGenerator(function*(M,O){const {headerInfo:A,ifd:Q,offsets:Y,sizes:W}=O;var T=[];for(var K=0;K<Y.length;K++){var V=yield E(M,A.littleEndian,Q,Y[K],W[K]||M.byteLength);T.push(V)}var ba=g(Q,A);M=f(Q,"BITSPERSAMPLE");K=f(Q,"SAMPLEFORMAT")??1;K=l(K,M);
var aa=f(Q,"SAMPLESPERPIXEL")||A.planes;const ea=b(K);V=f(Q,"TILEWIDTH");const ja=f(Q,"TILELENGTH");var ha=f(Q,"COMPRESSION")??1;const ma=V*ja;M=[];let na=T[0];const qa=34887===ha;for(let pa=0;pa<aa;pa++){ha=new ea(ma);if(ba&&qa){if(na=T[pa],na.length)for(var ra=0;ra<ma;ra++)ha[ra]=na[pa][ra+pa]}else if(na.length)if(ba||qa&&!ba)ha=na.slice(ma*pa,ma*(pa+1));else for(ra=0;ra<ma;ra++)ha[ra]=na[ra*aa+pa];M.push(ha)}T=A.noData?A.noData[0]:O.noDataValue;ba=(aa=A.metadata?A.metadata.statistics:null)?aa.map(pa=>
pa.min):null;aa=aa?aa.map(pa=>pa.max):null;K={pixelType:K,width:V,height:ja,pixels:M,noDataValue:T};null!=T?U.convertNoDataToMask(K,T):ba&&aa&&O.applyMinMaxConstraint&&(K.mask=Z(M,ba,aa));return K});return u.apply(this,arguments)}function z(){z=D._asyncToGenerator(function*(M,O={}){var A=O.pyramidLevel||0,Q=O.headerInfo||t(M);const {ifds:Y,noData:W}=Q;if(0===Y.length)throw Error("no valid image file directory");var T=C(Q);if(T)throw T;T=null;var K=-1===A?Y[Y.length-1]:Y[A];O=W??O.noDataValue;if(Q.tileWidth)T=
yield d(M,Q,K);else{{const xa=N.isPlatformLittleEndian===Q.littleEndian,ca=K.get("STRIPOFFSETS")?.values;if(void 0===ca)M=null;else{var {width:V,height:ba,pixelType:aa}=q([K]);A=f(K,"SAMPLESPERPIXEL")||Q.planes;var ea=f(K,"PHOTOMETRICINTERPRETATION");T=V*ba;var ja=f(K,"BITSPERSAMPLE"),ha=b(aa),ma=new ha(T*A),na=K.get("STRIPBYTECOUNTS")?.values,qa=f(K,"ROWSPERSTRIP"),ra=f(K,"COMPRESSION")??1;var pa=qa;if(0===ja%8)for(K=0;K<ca.length;K++){var oa=K*qa*V*A;pa=(K+1)*qa>ba?ba-K*qa:qa;if("u8"===aa||"s8"===
aa||xa)if(8===ra||32946===ra){var sa=new Uint8Array(M,ca[K],na[K]);sa=r(sa);var va=sa.buffer}else 6===ra?(sa=new Uint8Array(M,ca[K],na[K]),sa=h(sa,A,ea),va=sa.buffer):5===ra?(sa=R.decode(M,ca[K],na[K],Q.littleEndian),va=sa.buffer):(na[K]!==pa*V*A*ja/8&&console.log("strip byte counts is different than expected"),va=M.slice(ca[K],ca[K]+na[K]));else{if(6===ra||8===ra||32946===ra){sa=new Uint8Array(M,ca[K],na[K]);var ta=r(sa);va=ta.buffer}else na[K]!==pa*V*A*ja/8&&console.log("strip byte counts is different than expected"),
va=new ArrayBuffer(na[K]),sa=new Uint8Array(M,ca[K],na[K]),ta=new Uint8Array(va);switch(aa){case "u16":case "s16":for(pa=0;pa<sa.length;pa+=2)ta[pa]=sa[pa+1],ta[pa+1]=sa[pa];break;case "u32":case "s32":case "f32":for(pa=0;pa<sa.length;pa+=4)ta[pa]=sa[pa+3],ta[pa+1]=sa[pa+2],ta[pa+2]=sa[pa+1],ta[pa+3]=sa[pa]}}va=m(va,ja);pa=new ha(va);ma.set(pa,oa)}ea=[];if(1===A)ea.push(ma);else for(K=0;K<A;K++){Q=new ha(T);for(M=0;M<T;M++)Q[M]=ma[M*A+K];ea.push(Q)}M={width:V,height:ba,pixelType:aa,pixels:ea}}}T=
yield M}if(!T)return T;null!=O&&U.convertNoDataToMask(T,O);return T});return z.apply(this,arguments)}const L=[0,1,1,2,4,8,1,1,2,4,8,4,8,-1,-1,-1,8,8,8],S=new Set([1,5,6,7,8,34712,34887]),Z=(M,O,A)=>{if(!(M&&0<M.length&&O&&A))return null;let Q,Y,W;const T=M[0].length,K=M.length,V=new Uint8Array(T);for(let aa=0;aa<K;aa++)if(Q=M[aa],Y=O[aa],W=A[aa],0===aa)for(var ba=0;ba<T;ba++)V[ba]=Q[ba]<Y||Q[ba]>W?0:1;else for(ba=0;ba<T;ba++)V[ba]&&(V[ba]=Q[ba]<Y||Q[ba]>W?0:1);return V},X=M=>{if(!M)return null;var O=
M.match(/<Item(.*?)Item>/gi);if(!O||0===O.length)return null;M=new Map;var A;for(var Q=0;Q<O.length;Q++){var Y=O[Q];var W=Y.slice(6,Y.indexOf("\x3e"));var T=Y.indexOf("sample\x3d");-1<T&&(A=Y.slice(T+8,Y.indexOf('"',T+8)));T=Y.indexOf("name\x3d");-1<T&&(W=Y.slice(T+6,Y.indexOf('"',T+6)));W&&(Y=Y.slice(Y.indexOf("\x3e")+1,Y.indexOf("\x3c/Item\x3e")).trim(),null!=A?M.has(W)?M.get(W)[A]=Y:M.set(W,[Y]):M.set(W,Y));A=null}O=M.get("STATISTICS_MINIMUM");W=M.get("STATISTICS_MAXIMUM");Q=M.get("STATISTICS_MEAN");
Y=M.get("STATISTICS_STDDEV");A=null;if(O&&W)for(A=[],T=0;T<O.length;T++)A.push({min:parseFloat(O[T]),max:parseFloat(W[T]),avg:Q&&parseFloat(Q[T]),stddev:Y&&parseFloat(Y[T])});W=M.get("BandName");Q=M.get("WavelengthMin");Y=M.get("WavelengthMax");O=null;if(W)for(O=[],T=0;T<W.length;T++)O.push({BandName:W[T],WavelengthMin:Q&&parseFloat(Q[T]),WavelengthMax:Y&&parseFloat(Y[T])});W=M.get("DataType");return{statistics:A,bandProperties:O,dataType:W,rawMetadata:M}};P.decode=function(M){return z.apply(this,
arguments)};P.decodeTileOrStrip=function(M,O){return u.apply(this,arguments)};P.getImageInfo=q;P.getMaskIFDs=e;P.getPyramidIFDs=a;P.isBSQConfig=g;P.parseFieldValues=x;P.parseHeader=t;P.parseIFD=G;P.parseSignature=y;Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/byteStreamUtils":function(){define(["exports"],function(P){P.bytesToUTF8=function(D,F){let I=0,p="",R=0,U=0;const H=D.length;for(;I<H;)if(U=D[I++],R=U>>4,8>R?R=1:15===R?(R=4,U=(U&7)<<18|
(D[I++]&63)<<12|(D[I++]&63)<<6|D[I++]&63):14===R?(R=3,U=(U&15)<<12|(D[I++]&63)<<6|D[I++]&63):(R=2,U=(U&31)<<6|D[I++]&63),0!==U||F)p+=String.fromCharCode(U);return p};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/TiffTags":function(){define(function(){const P=(()=>{const p=[];p[254]="NEWSUBFILETYPE";p[255]="SUBFILETYPE";p[256]="IMAGEWIDTH";p[257]="IMAGELENGTH";p[258]="BITSPERSAMPLE";p[259]="COMPRESSION";p[262]="PHOTOMETRICINTERPRETATION";p[263]=
"THRESHHOLDING";p[264]="CELLWIDTH";p[265]="CELLLENGTH";p[266]="FILLORDER";p[269]="DOCUMENTNAME";p[270]="IMAGEDESCRIPTION";p[271]="MAKE";p[272]="MODEL";p[273]="STRIPOFFSETS";p[274]="ORIENTATION";p[277]="SAMPLESPERPIXEL";p[278]="ROWSPERSTRIP";p[279]="STRIPBYTECOUNTS";p[280]="MINSAMPLEVALUE";p[281]="MAXSAMPLEVALUE";p[282]="XRESOLUTION";p[283]="YRESOLUTION";p[284]="PLANARCONFIGURATION";p[285]="PAGENAME";p[286]="XPOSITION";p[287]="YPOSITION";p[288]="FREEOFFSETS";p[289]="FREEBYTECOUNTS";p[290]="GRAYRESPONSEUNIT";
p[291]="GRAYRESPONSECURVE";p[292]="T4OPTIONS";p[293]="T6OPTIONS";p[296]="RESOLUTIONUNIT";p[297]="PAGENUMBER";p[300]="COLORRESPONSEUNIT";p[301]="TRANSFERFUNCTION";p[305]="SOFTWARE";p[306]="DATETIME";p[315]="ARTIST";p[316]="HOSTCOMPUTER";p[317]="PREDICTOR";p[318]="WHITEPOINT";p[319]="PRIMARYCHROMATICITIES";p[320]="COLORMAP";p[321]="HALFTONEHINTS";p[322]="TILEWIDTH";p[323]="TILELENGTH";p[324]="TILEOFFSETS";p[325]="TILEBYTECOUNTS";p[326]="BADFAXLINES";p[327]="CLEANFAXDATA";p[328]="CONSECUTIVEBADFAXLINES";
p[330]="SUBIFD";p[332]="INKSET";p[333]="INKNAMES";p[334]="NUMBEROFINKS";p[336]="DOTRANGE";p[337]="TARGETPRINTER";p[338]="EXTRASAMPLES";p[339]="SAMPLEFORMAT";p[340]="SMINSAMPLEVALUE";p[341]="SMAXSAMPLEVALUE";p[342]="TRANSFERRANGE";p[347]="JPEGTABLES";p[512]="JPEGPROC";p[513]="JPEGIFOFFSET";p[514]="JPEGIFBYTECOUNT";p[515]="JPEGRESTARTINTERVAL";p[517]="JPEGLOSSLESSPREDICTORS";p[518]="JPEGPOINTTRANSFORM";p[519]="JPEGQTABLES";p[520]="JPEGDCTABLES";p[521]="JPEGACTABLES";p[529]="YCBCRCOEFFICIENTS";p[530]=
"YCBCRSUBSAMPLING";p[531]="YCBCRPOSITIONING";p[532]="REFERENCEBLACKWHITE";p[700]="XMP";p[33550]="GEOPIXELSCALE";p[33922]="GEOTIEPOINTS";p[33432]="COPYRIGHT";p[42112]="GDAL_METADATA";p[42113]="GDAL_NODATA";p[50844]="RPCCOEFFICIENT";p[34264]="GEOTRANSMATRIX";p[34735]="GEOKEYDIRECTORY";p[34736]="GEODOUBLEPARAMS";p[34737]="GEOASCIIPARAMS";p[34665]="EXIFIFD";p[34853]="GPSIFD";p[40965]="INTEROPERABILITYIFD";return p})(),D=(()=>{const p=P.slice();p[36864]="ExifVersion";p[40960]="FlashpixVersion";p[40961]=
"ColorSpace";p[42240]="Gamma";p[37121]="ComponentsConfiguration";p[37122]="CompressedBitsPerPixel";p[40962]="PixelXDimension";p[40963]="PixelYDimension";p[37500]="MakerNote";p[37510]="UserComment";p[40964]="RelatedSoundFile";p[36867]="DateTimeOriginal";p[36868]="DateTimeDigitized";p[36880]="OffsetTime";p[36881]="OffsetTimeOriginal";p[36882]="OffsetTimeDigitized";p[37520]="SubSecTime";p[37521]="SubSecTimeOriginal";p[37522]="SubSecTimeDigitized";p[37888]="Temperature";p[37889]="Humidity";p[37890]="Pressure";
p[37891]="WaterDepth";p[37892]="Acceleration";p[37893]="CameraElevationAngle";p[42016]="ImageUniqueID";p[42032]="CameraOwnerName";p[42033]="BodySerialNumber";p[42034]="LensSpecification";p[42035]="LensMake";p[42036]="LensModel";p[42037]="LensSerialNumber";p[33434]="ExposureTime";p[33437]="FNumber";p[34850]="ExposureProgram";p[34852]="SpectralSensitivity";p[34855]="PhotographicSensitivity";p[34856]="OECF";p[34864]="SensitivityType";p[34865]="StandardOutputSensitivity";p[34866]="RecommendedExposureIndex";
p[34867]="ISOSpeed";p[34868]="ISOSpeedLatitudeyyy";p[34869]="ISOSpeedLatitudezzz";p[37377]="ShutterSpeedValue";p[37378]="ApertureValue";p[37379]="BrightnessValue";p[37380]="ExposureBiasValue";p[37381]="MaxApertureValue";p[37382]="SubjectDistance";p[37383]="MeteringMode";p[37384]="LightSource";p[37385]="Flash";p[37386]="FocalLength";p[37396]="SubjectArea";p[41483]="FlashEnergy";p[41484]="SpatialFrequencyResponse";p[41486]="FocalPlaneXResolution";p[41487]="FocalPlaneYResolution";p[41488]="FocalPlaneResolutionUnit";
p[41492]="SubjectLocation";p[41493]="ExposureIndex";p[41495]="SensingMethod";p[41728]="FileSource";p[41729]="SceneType";p[41730]="CFAPattern";p[41985]="CustomRendered";p[41986]="ExposureMode";p[41987]="WhiteBalance";p[41988]="DigitalZoomRatio";p[41989]="FocalLengthIn35mmFilm";p[41990]="SceneCaptureType";p[41991]="GainControl";p[41992]="Contrast";p[41993]="Saturation";p[41994]="Sharpness";p[41995]="DeviceSettingDescription";p[41996]="SubjectDistanceRange";return p})(),F=(()=>{const p=[];p[1024]="GTModelTypeGeoKey";
p[1025]="GTRasterTypeGeoKey";p[1026]="GTCitationGeoKey";p[2048]="GeographicTypeGeoKey";p[2049]="GeogCitationGeoKey";p[2050]="GeogGeodeticDatumGeoKey";p[2051]="GeogPrimeMeridianGeoKey";p[2052]="GeogLinearUnitsGeoKey";p[2053]="GeogLinearUnitSizeGeoKey";p[2054]="GeogAngularUnitsGeoKey";p[2055]="GeogAngularUnitSizeGeoKey";p[2056]="GeogEllipsoidGeoKey";p[2057]="GeogSemiMajorAxisGeoKey";p[2058]="GeogSemiMinorAxisGeoKey";p[2059]="GeogInvFlatteningGeoKey";p[2061]="GeogPrimeMeridianLongGeoKey";p[2060]="GeogAzimuthUnitsGeoKey";
p[3072]="ProjectedCSTypeGeoKey";p[3073]="PCSCitationGeoKey";p[3074]="ProjectionGeoKey";p[3075]="ProjCoordTransGeoKey";p[3076]="ProjLinearUnitsGeoKey";p[3077]="ProjLinearUnitSizeGeoKey";p[3078]="ProjStdParallel1GeoKey";p[3079]="ProjStdParallel2GeoKey";p[3080]="ProjNatOriginLongGeoKey";p[3081]="ProjNatOriginLatGeoKey";p[3082]="ProjFalseEastingGeoKey";p[3083]="ProjFalseNorthingGeoKey";p[3084]="ProjFalseOriginLongGeoKey";p[3085]="ProjFalseOriginLatGeoKey";p[3086]="ProjFalseOriginEastingGeoKey";p[3087]=
"ProjFalseOriginNorthingGeoKey";p[3088]="ProjCenterLongGeoKey";p[3090]="ProjCenterEastingGeoKey";p[3091]="ProjCenterNorthingGeoKey";p[3092]="ProjScaleAtNatOriginGeoKey";p[3093]="ProjScaleAtCenterGeoKey";p[3094]="ProjAzimuthAngleGeoKey";p[3095]="ProjStraightVertPoleLongGeoKey";p[4096]="VerticalCSTypeGeoKey";p[4097]="VerticalCitationGeoKey";p[4098]="VerticalDatumGeoKey";p[4099]="VerticalUnitsGeoKey";return p})(),I=new Map;I.set("EXIFIFD",D);I.set("GPSIFD","GPSVersionID GPSLatitudeRef GPSLatitude GPSLongitudeRef GPSLongitude GPSAltitudeRef GPSAltitude GPSTimeStamp GPSSatellites GPSStatus GPSMeasureMode GPSDOP GPSSpeedRef GPSSpeed GPSTrackRef GPSTrack GPSImgDirectionRef GPSImgDirection GPSMapDatum GPSDestLatitudeRef GPSDestLatitude GPSDestLongitudeRef GPSDestLongitude GPSDestBearingRef GPSDestBearing GPSDestDistanceRef GPSDestDistance GPSProcessingMethod GPSAreaInformation GPSDateStamp GPSDifferential GPSHPositioningError".split(" "));
return{TIFF_TAGS:P,ifdTags:I,GEO_KEYS:F,getTagName:(p,R)=>{R=(R||P)[p];void 0===R&&(R="unknown"+String(p));return R}}})},"esri/layers/support/rasterFormats/utils":function(){define(["exports"],function(P){const D=new ArrayBuffer(4),F=new Uint8Array(D);(new Uint32Array(D))[0]=1;P.isPlatformLittleEndian=1===F[0];Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/rasterFunctionHelper":function(){define("exports ../../../core/colorUtils ../../../core/Error ../../../core/lang ./AspectFunction ./BandArithmeticFunction ./ColormapFunction ./CompositeBandFunction ./ConvolutionFunction ./ExtractBandFunction ./LocalFunction ./MaskFunction ./NDVIFunction ./RemapFunction ./SlopeFunction ./StatisticsHistogramFunction ./StretchFunction".split(" "),
function(P,D,F,I,p,R,U,H,N,B,l,b,k,f,c,m,h){function r(w,y){({rasterFunctionArguments:w}=w);w&&(w.rasters||[w.raster]).forEach(G=>{G&&"number"!==typeof G&&("string"===typeof G?G.startsWith("http")&&(y.includes(G)||y.push(G)):"rasterFunctionArguments"in G&&r(G,y))})}function E(w,y){return"rasters"===y[0]&&Array.isArray(w.rasters)?w.rasters:y.map(G=>w[G])}function J(w){return!!(w&&"object"===typeof w&&w.rasterFunction&&w.rasterFunctionArguments)}function d(w){const {rasterFunction:y,rasterFunctionArguments:G}=
w,C={};for(const z in G){let L=G[z];var u=z.toLowerCase();if("rasters"===u&&Array.isArray(L))C.rasters=L.map(S=>J(S)?d(S):S);else switch(J(L)&&(L=d(L)),u){case "dra":C.dra=L;break;case "pspower":C.psPower=L;break;case "pszfactor":C.psZFactor=L;break;case "bandids":C.bandIds=L;break;default:u=z[0].toLowerCase()+z.slice(1),C[u]=L}}"Local"!==y||C.rasters?.length||(C.rasters=["$$"]);return{...w,rasterFunctionArguments:C}}function n(w,y){const {rasterFunction:G,rasterFunctionArguments:C}=w;var u=w.outputPixelType?.toLowerCase();
if(null==G||!v.has(G))throw new F("raster-function-helper",`unsupported raster function: ${G}`);var z=v.get(G);w=("function"===typeof z.ctor?z.ctor:z.ctor["default"]).fromJSON({...w,outputPixelType:u});({rasterArgumentNames:u}=w);z=[];const L=E(C,u),S="rasters"===u[0],Z=[];for(let X=0;X<L.length;X++){const M=L[X];let O;null==M||"string"===typeof M&&M.startsWith("$")?z.push(y?.raster):"string"===typeof M?y[M]&&z.push(y[M]):"number"!==typeof M&&"rasterFunction"in M&&(O=n(M,y),S||(w.functionArguments[u[X]]=
O),z.push(O));S&&Z.push(O??M)}S&&(w.functionArguments.rasters=Z);y&&(w.sourceRasters=z,y=y.raster?.url)&&(w.mainPrimaryRasterId=y);return w}function x(w,y){if(w&&y)for(const G in w){const C=w[G];C&&"object"===typeof C&&(C.function&&C.arguments?x(C.arguments,y):"RasterFunctionVariable"===C.type&&null!=y[C.name]&&(C.value=y[C.name]))}}function q(w){if(!w||"object"!==typeof w)return w;if(Array.isArray(w)&&0===w.length)return 0===w.length?null:["number","string"].includes(typeof w[0])?w:w.map(y=>q(y));
if("value"in w&&["number","string","boolean"].includes(typeof w.value))return w.value;if(!("type"in w))return w;switch(w.type){case "Scalar":return w.value;case "AlgorithmicColorRamp":return g(w);case "MultiPartColorRamp":return{type:"multipart",colorRamps:w.ArrayOfColorRamp.map(g)};case "ArgumentArray":return w.elements?.length&&"RasterStatistics"!==w.elements[0].type?"RasterFunctionVariable"===w.elements[0].type?w.elements.map(y=>null!=y.value?q(y.value):y.name.toLowerCase().includes("raster")?
"$$":null):w:w.elements;default:return w}}function g(w){const y=w.algorithm??"esriHSVAlgorithm";let {FromColor:G,ToColor:C}=w;if(!Array.isArray(G)){const {r:u,g:z,b:L}=D.toRGB({h:G.Hue,s:G.Saturation,v:G.Value});G=[u,z,L,G.AlphaValue]}if(!Array.isArray(C)){const {r:u,g:z,b:L}=D.toRGB({h:C.Hue,s:C.Saturation,v:C.Value});C=[u,z,L,C.AlphaValue]}return{type:"algorithmic",algorithm:y,fromColor:G,toColor:C}}function a(w,y){if(w&&y){var {function:G,arguments:C}=w;if(G&&C){y.rasterFunction=G.type.replace("Function",
"");y.outputPixelType=G.pixelType;w={};y.rasterFunctionArguments=w;for(const u in C){const z=C[u];"object"===typeof z&&("function"in z&&z.function&&z.arguments?(y.rasterFunctionArguments[u]={},a(z,y.rasterFunctionArguments[u])):"value"in z&&(w[u]=q(z.value)))}w.DEM&&!w.Raster&&(w.Raster=w.DEM,delete w.DEM);switch(y.rasterFunction){case "Stretch":e(w);break;case "Colormap":"randomcolorramp"===w.ColorRamp?.type?.toLowerCase()&&(delete w.ColorRamp,w.ColormapName="Random");0===w.ColorSchemeType&&delete w.ColorRamp;
break;case "Convolution":null!=w.ConvolutionType&&(w.Type=w.ConvolutionType,delete w.ConvolutionType);break;case "Mask":t(w)}}}}function e(w){w.Statistics?.length&&"object"===typeof w.Statistics&&(w.Statistics=w.Statistics.map(y=>[y.min,y.max,y.mean,y.standardDeviation]));null!=w.NumberOfStandardDeviation&&(w.NumberOfStandardDeviations=w.NumberOfStandardDeviation,delete w.NumberOfStandardDeviation)}function t(w){w.NoDataValues?.length&&"string"===typeof w.NoDataValues[0]&&(w.NoDataValues=w.NoDataValues.filter(y=>
""!==y).map(y=>Number(y)))}const v=new Map;v.set("Aspect",{desc:"Aspect Function",ctor:p,rasterArgumentNames:["raster"]});v.set("BandArithmetic",{desc:"Band Arithmetic Function",ctor:R,rasterArgumentNames:["raster"]});v.set("Colormap",{desc:"Colormap Function",ctor:U,rasterArgumentNames:["raster"]});v.set("CompositeBand",{desc:"CompositeBand Function",ctor:H,rasterArgumentNames:["rasters"]});v.set("Convolution",{desc:"Convolution Function",ctor:N,rasterArgumentNames:["raster"]});v.set("ExtractBand",
{desc:"ExtractBand Function",ctor:B,rasterArgumentNames:["raster"]});v.set("Local",{desc:"Local Function",ctor:l,rasterArgumentNames:["rasters"]});v.set("Mask",{desc:"Mask Function",ctor:b,rasterArgumentNames:["raster"]});v.set("NDVI",{desc:"NDVI Function",ctor:k,rasterArgumentNames:["raster"]});v.set("Remap",{desc:"Remap Function",ctor:f,rasterArgumentNames:["raster"]});v.set("Slope",{desc:"Slope Function",ctor:c,rasterArgumentNames:["raster"]});v.set("StatisticsHistogram",{desc:"Statistics Histogram Function",
ctor:m,rasterArgumentNames:["raster"]});v.set("Stretch",{desc:"Stretch Function",ctor:h,rasterArgumentNames:["raster"]});P.create=function(w,y){y=y??{};w=I.clone(w);if("function"in w&&"arguments"in w&&w.arguments){y&&x(w,y);const G={};a(w,G);w=G}if("rasterFunction"in w)return w=d(w),n(w,y);throw new F("raster-function-helper","unsupported raster function json.");};P.getPrimaryRasterUrls=r;P.getRasterValues=E;P.getSupportedFunctions=function(){const w=new Set;v.forEach((y,G)=>w.add(G));return w};P.register=
function(w,y,G=["raster"],C=""){v.set(w,{desc:C,ctor:y,rasterArgumentNames:G})};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/AspectFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ./AspectFunctionArguments ./BaseRasterFunction ./surfaceUtils".split(" "),
function(P,D,F,I,p,R,U,H,N,B){p=function(l){function b(){var f=l.apply(this,arguments)||this;f.functionName="Aspect";f.functionArguments=null;f.rasterArgumentNames=["raster"];f.isGCS=!1;return f}P._inheritsLoose(b,l);var k=b.prototype;k._bindSourceRasters=function(){var f=this.sourceRasterInfos[0];this.isGCS=f.spatialReference?.isGeographic??!1;this.outputPixelType=this._getOutputPixelType("f32");f=f.clone();f.pixelType=this.outputPixelType;f.statistics=[{min:0,max:360,avg:180,stddev:30}];f.histograms=
null;f.colormap=null;f.attributeTable=null;f.bandCount=1;this.rasterInfo=f;return{success:!0,supportsGPU:!0}};k._processPixels=function(f){const c=f.pixelBlocks?.[0];if(F.isNone(c))return null;({extent:f}=f);return B.aspect(c,{resolution:f?{x:f.width/c.width,y:f.height/c.height}:{x:1,y:1}})};return b}(N);D.__decorate([I.property({json:{write:!0,name:"rasterFunction"}})],p.prototype,"functionName",void 0);D.__decorate([I.property({type:H,json:{write:!0,name:"rasterFunctionArguments"}})],p.prototype,
"functionArguments",void 0);D.__decorate([I.property()],p.prototype,"rasterArgumentNames",void 0);D.__decorate([I.property({json:{write:!0}})],p.prototype,"isGCS",void 0);return p=D.__decorate([U.subclass("esri.layers.support.rasterFunctions.AspectFunction")],p)})},"esri/layers/support/rasterFunctions/AspectFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/Error ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(P,D,F,I,p,R,U,H,N){var B;F=B=function(l){function b(){return l.apply(this,arguments)||this}P._inheritsLoose(b,l);b.prototype.clone=function(){return new B({raster:this.raster})};return b}(N);return F=B=D.__decorate([H.subclass("esri.layers.support.rasterFunctions.AspectFunctionArguments")],F)})},"esri/layers/support/rasterFunctions/BaseFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass".split(" "),
function(P,D,F,I,p,R,U){F=function(H){function N(){var B=H.apply(this,arguments)||this;B.raster=void 0;return B}P._inheritsLoose(N,H);return N}(F.JSONSupport);D.__decorate([I.property({json:{write:!0}})],F.prototype,"raster",void 0);return F=D.__decorate([U.subclass("esri.layers.support.rasterFunctions.AspectFunctionArguments")],F)})},"esri/layers/support/rasterFunctions/BaseRasterFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/cast ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ../PixelBlock ../RasterInfo".split(" "),
function(P,D,F,I,p,R,U,H,N,B){F=function(l){function b(){var f=l.apply(this,arguments)||this;f.functionArguments=null;f.readingBufferSize=0;f.id=-1;f.isNoopProcess=!1;f.rawInputBandIds=[];f.isInputBandIdsSwizzled=!1;f.swizzledBandSelection=[];f.isBranch=!1;f._bindingResult=null;return f}P._inheritsLoose(b,l);var k=b.prototype;k.bind=function(f,c=!1,m=-1){this.id=m+1;m=this._getRasterValues();let h=!0;for(let E=0;E<m.length;E++){var r=m[E];if(I.isSome(r)&&this._isRasterFunctionValue(r)){r=r.bind(f,
c,this.id+E);if(!r.success)return this._bindingResult=r;h=h&&r.supportsGPU}}if(!this.rasterInfo||c)return this.sourceRasterInfos=this._getSourceRasterInfos(f),this._bindingResult=this._bindSourceRasters(),this._bindingResult.supportsGPU=h&&this._bindingResult.supportsGPU,this.processInputBandIds(),this._bindingResult;this._bindingResult={success:!0,supportsGPU:!0};this.processInputBandIds();return this._bindingResult};k.process=function(f){var c=this._getRasterValues();c=0===c.length?f.pixelBlocks??
f.primaryPixelBlocks:c.map(m=>this._readRasterValue(m,f));return this._processPixels({...f,pixelBlocks:c})};k.processInputBandIds=function(){var f=this._getRasterValues().filter(this._isRasterFunctionValue);if(1<f.length)return this.rawInputBandIds=f.map(m=>m.processInputBandIds()[0]),this.isInputBandIdsSwizzled=this.rawInputBandIds.some((m,h)=>m!==h),f=f.filter(m=>"ExtractBand"===m.functionName),f.length&&f.forEach((m,h)=>{m.isInputBandIdsSwizzled=!0;m.swizzledBandSelection=[h,h,h]}),this.rawInputBandIds;
var c=f[0];if(c){if(f=c.processInputBandIds(),c.isInputBandIdsSwizzled)return this.rawInputBandIds=f}else{f=[];({bandCount:c}=this.sourceRasterInfos[0]);for(let m=0;m<c;m++)f.push(m)}f=this._getInputBandIds(f);this.isInputBandIdsSwizzled=f.some((m,h)=>m!==h);return this.rawInputBandIds=f};k.getPrimaryRasters=function(){const f=[],c=[];this._getPrimaryRasters(this,f,c);return{rasters:f,rasterIds:c}};k.getWebGLProcessorDefinition=function(){const f=this._getWebGLParameters(),{raster:c,rasters:m}=this.functionArguments;
m&&Array.isArray(m)&&m.length?(f.rasters=m.map(h=>this._isRasterFunctionValue(h)?h.getWebGLProcessorDefinition():"number"===typeof h?{name:"Constant",parameters:{value:h},pixelType:"f32",id:-1,isNoopProcess:!1}:{name:"Identity",parameters:{value:h},pixelType:"f32",id:-1,isNoopProcess:!1}),f.rasters.some(h=>null!=h)||(f.rasters=null)):this._isRasterFunctionValue(c)&&(f.raster=c.getWebGLProcessorDefinition());return{name:this.functionName,parameters:f,pixelType:this.outputPixelType,id:this.id,isNoopProcess:this.isNoopProcess}};
k.getFlatWebGLFunctionChain=function(){var f=this.getWebGLProcessorDefinition();if(!f)return null;const c=[f];({parameters:f}=f);for(f=f.rasters||f.raster&&[f.raster];f?.length;){c.unshift(...f);var m=[];for(var h=0;h<f.length;h++){var {parameters:r}=f[h];r=r.rasters||r.raster&&[r.raster];r?.length&&m.push(...r)}f=m}for(f=c.length-1;0<=f;f--)c[f].isNoopProcess&&c.splice(f,1);f=!1;for(m=0;m<c.length;m++)h=c[m],h.id=c.length-m-1,{rasters:h}=h.parameters,f=f||null!=h&&1<h.length;return{hasBranches:f,
functions:c}};k._getOutputPixelType=function(f){return"unknown"===this.outputPixelType?f:this.outputPixelType??f};k._getWebGLParameters=function(){return{}};k._getInputBandIds=function(f){return f};k._isOutputRoundingNeeded=function(){const {outputPixelType:f}=this;return(f?.startsWith("u")||f?.startsWith("s"))??!1};k._getRasterValues=function(){const {rasterArgumentNames:f}=this;return"rasters"===f[0]?this.functionArguments.rasters??[]:f.map(c=>this.functionArguments[c])};k._getSourceRasterInfos=
function(f){const c=this._getRasterValues(),{rasterInfos:m,rasterIds:h}=f;if(0===c.length)return m;const r=c.map(J=>{if(J&&"object"===typeof J&&"bind"in J&&J.rasterInfo)return J.rasterInfo;if("string"===typeof J&&h.includes(J))return m[h.indexOf(J)];if("number"!==typeof J)return m[0]}),E=r.find(J=>J)??m[0];r.forEach((J,d)=>{void 0===J&&(r[d]=E)});return r};k._getPrimaryRasterId=function(f){return f?.url};k._getPrimaryRasters=function(f,c=[],m=[]){for(let r=0;r<f.sourceRasters.length;r++){var h=f.sourceRasters[r];
if("number"!==typeof h)if("bind"in h)this._getPrimaryRasters(h,c,m);else{const E=this._getPrimaryRasterId(h);null==E||m.includes(E)||(this.mainPrimaryRasterId===E?(c.unshift(h),m.unshift(E)):(c.push(h),m.push(E)))}}};k._isRasterFunctionValue=function(f){return null!=f&&"object"===typeof f&&"getWebGLProcessorDefinition"in f};k._readRasterValue=function(f,c){var {primaryPixelBlocks:m}=c;if(I.isNone(f)||"$$"===f)return f=m[0],I.isNone(f)?null:f.clone();if("string"===typeof f)return f=c.primaryRasterIds.indexOf(f),
-1===f?null:m[f];if("number"===typeof f){m=m[0];if(I.isNone(m))return null;const {width:h,height:r,pixelType:E,mask:J}=m;m=J?new Uint8Array(J):null;c=new Float32Array(h*r);c.fill(f);f=Array(this.sourceRasterInfos[0].bandCount).fill(c);return new N({width:h,height:r,pixelType:E,pixels:f,mask:m})}return f.process(c)};P._createClass(b,[{key:"supportsGPU",get:function(){return this._bindingResult.supportsGPU}}]);return b}(F.JSONSupport);D.__decorate([p.property({json:{write:!0}})],F.prototype,"functionName",
void 0);D.__decorate([p.property({json:{write:!0}})],F.prototype,"functionArguments",void 0);D.__decorate([p.property()],F.prototype,"rasterArgumentNames",void 0);D.__decorate([p.property({json:{write:!0}}),R.cast(l=>l?.toLowerCase())],F.prototype,"outputPixelType",void 0);D.__decorate([p.property({json:{write:!0}})],F.prototype,"mainPrimaryRasterId",void 0);D.__decorate([p.property()],F.prototype,"sourceRasters",void 0);D.__decorate([p.property({type:[B],json:{write:!0}})],F.prototype,"sourceRasterInfos",
void 0);D.__decorate([p.property({json:{write:!0}})],F.prototype,"rasterInfo",void 0);D.__decorate([p.property({json:{write:!0}})],F.prototype,"readingBufferSize",void 0);D.__decorate([p.property({json:{write:!0}})],F.prototype,"id",void 0);D.__decorate([p.property()],F.prototype,"isNoopProcess",void 0);D.__decorate([p.property()],F.prototype,"supportsGPU",null);D.__decorate([p.property()],F.prototype,"rawInputBandIds",void 0);D.__decorate([p.property()],F.prototype,"isInputBandIdsSwizzled",void 0);
D.__decorate([p.property()],F.prototype,"swizzledBandSelection",void 0);D.__decorate([p.property()],F.prototype,"isBranch",void 0);D.__decorate([p.property()],F.prototype,"_bindingResult",void 0);return F=D.__decorate([H.subclass("esri.layers.support.rasterFunctions.BaseRasterFunction")],F)})},"esri/layers/support/RasterInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../geometry/Extent ../../geometry/SpatialReference ./RasterStorageInfo".split(" "),
function(P,D,F,I,p,R,U,H,N,B,l){var b;F=b=function(k){function f(c){c=k.call(this,c)||this;c.attributeTable=null;c.bandCount=null;c.colormap=null;c.extent=null;c.format=void 0;c.height=null;c.width=null;c.histograms=null;c.keyProperties={};c.multidimensionalInfo=null;c.noDataValue=null;c.pixelSize=null;c.pixelType=null;c.isPseudoSpatialReference=!1;c.spatialReference=null;c.statistics=null;c.storageInfo=null;c.transform=null;return c}P._inheritsLoose(f,k);f.prototype.clone=function(){return new b({attributeTable:I.clone(this.attributeTable),
bandCount:this.bandCount,colormap:I.clone(this.colormap),extent:I.clone(this.extent),nativePixelSize:I.clone(this.nativePixelSize),format:this.format,height:this.height,width:this.width,histograms:I.clone(this.histograms),keyProperties:I.clone(this.keyProperties),multidimensionalInfo:I.clone(this.multidimensionalInfo),noDataValue:this.noDataValue,pixelSize:I.clone(this.pixelSize),pixelType:this.pixelType,isPseudoSpatialReference:this.isPseudoSpatialReference,spatialReference:I.clone(this.spatialReference),
statistics:I.clone(this.statistics),storageInfo:I.clone(this.storageInfo),transform:I.clone(this.transform)})};P._createClass(f,[{key:"dataType",get:function(){const c=this.keyProperties?.DataType?.toLowerCase()??"generic";return"stdtime"===c?"standard-time":c}},{key:"nativeExtent",get:function(){return this._get("nativeExtent")||this.extent},set:function(c){c&&this._set("nativeExtent",c)}},{key:"nativePixelSize",get:function(){if(p.isNone(this.transform)||!this.transform.affectsPixelSize)return this.pixelSize;
const c=this.nativeExtent;return{x:c.width/this.width,y:c.height/this.height}}},{key:"hasMultidimensionalTranspose",get:function(){return!!this.storageInfo?.transposeInfo}}]);return f}(F.JSONSupport);D.__decorate([R.property({json:{write:!0}})],F.prototype,"attributeTable",void 0);D.__decorate([R.property({json:{write:!0}})],F.prototype,"bandCount",void 0);D.__decorate([R.property({json:{write:!0}})],F.prototype,"colormap",void 0);D.__decorate([R.property({type:String,readOnly:!0})],F.prototype,"dataType",
null);D.__decorate([R.property({type:N,json:{write:!0}})],F.prototype,"extent",void 0);D.__decorate([R.property({type:N,json:{write:!0}})],F.prototype,"nativeExtent",null);D.__decorate([R.property({json:{write:!0}})],F.prototype,"nativePixelSize",null);D.__decorate([R.property({json:{write:!0}})],F.prototype,"format",void 0);D.__decorate([R.property({json:{write:!0}})],F.prototype,"height",void 0);D.__decorate([R.property({json:{write:!0}})],F.prototype,"width",void 0);D.__decorate([R.property({json:{write:!0}})],
F.prototype,"hasMultidimensionalTranspose",null);D.__decorate([R.property({json:{write:!0}})],F.prototype,"histograms",void 0);D.__decorate([R.property({json:{write:!0}})],F.prototype,"keyProperties",void 0);D.__decorate([R.property({json:{write:!0}})],F.prototype,"multidimensionalInfo",void 0);D.__decorate([R.property({json:{write:!0}})],F.prototype,"noDataValue",void 0);D.__decorate([R.property({json:{write:!0}})],F.prototype,"pixelSize",void 0);D.__decorate([R.property({json:{write:!0}})],F.prototype,
"pixelType",void 0);D.__decorate([R.property()],F.prototype,"isPseudoSpatialReference",void 0);D.__decorate([R.property({type:B,json:{write:!0}})],F.prototype,"spatialReference",void 0);D.__decorate([R.property({json:{write:!0}})],F.prototype,"statistics",void 0);D.__decorate([R.property({type:l,json:{write:!0}})],F.prototype,"storageInfo",void 0);D.__decorate([R.property({json:{write:!0}})],F.prototype,"transform",void 0);return F=b=D.__decorate([H.subclass("esri.layers.support.RasterInfo")],F)})},
"esri/layers/support/rasterFunctions/surfaceUtils":function(){define(["exports","../../../core/maybe","../PixelBlock","./pixelUtils"],function(P,D,F,I){function p(R){let {altitude:U,azimuth:H}=R;const {hillshadeType:N,pixelSizePower:B=1,pixelSizeFactor:l=1,scalingType:b,isGCS:k,resolution:f}=R;var c="multi-directional"===N?2*R.zFactor:R.zFactor;const {x:m,y:h}=f;R=c/(8*m);var r=c/(8*h);k&&.001<c&&(R/=111E3,r/=111E3);"adjusted"===b&&(k?(R=111E3*m,r=111E3*h,R=(c+R**B*l)/(8*R),r=(c+r**B*l)/(8*r)):(R=
(c+m**B*l)/(8*m),r=(c+h**B*l)/(8*h)));var E=(90-U)*Math.PI/180;c=Math.cos(E);let J=(360-H+90)*Math.PI/180,d=Math.sin(E)*Math.cos(J);E=Math.sin(E)*Math.sin(J);const n=[315,270,225,360,180,0],x=[60,60,60,60,60,90];var q=new Float32Array([3,5,3,2,1,4]);const g=q.reduce((w,y)=>w+y);q=q.map(w=>w/g);const a="multi-directional"===N?n.length:1,e=new Float32Array(6),t=new Float32Array(6),v=new Float32Array(6);if("multi-directional"===N)for(let w=0;w<a;w++)U=x[w],H=n[w],E=(90-U)*Math.PI/180,c=Math.cos(E),J=
(360-H+90)*Math.PI/180,d=Math.sin(E)*Math.cos(J),E=Math.sin(E)*Math.sin(J),e[w]=c,t[w]=d,v[w]=E;else e.fill(c),t.fill(d),v.fill(E);return{resolution:f,factor:[R,r],sinZcosA:d,sinZsinA:E,cosZ:c,sinZcosAs:t,sinZsinAs:v,cosZs:e,weights:q,hillshadeType:["traditional","multi-directional"].indexOf(N)}}P.aspect=function(R,U={}){if(!I.isValidPixelBlock(R))return R;const {width:H,height:N,mask:B}=R;var l=R.pixels[0];const b=new Uint8Array(H*N);D.isSome(B)&&b.set(B);const k=new Float32Array(H*N);var {resolution:f}=
U;U=f?1/f.x:1;f=f?1/f.y:1;let c;let m,h,r,E;const J=D.isSome(B);for(let q=1;q<N-1;q++){const g=q*H;for(let a=1;a<H-1;a++)if(B&&!B[g+a])k[g+a]=0;else{var d=0;if(J&&(d=B[g-H+a-1]+B[g-H+a]+B[g-H+a+1]+B[g+a-1]+B[g+a+1]+B[g+H+a-1]+B[g+H+a]+B[g+H+a+1],7>d)){k[g+a]=0;b[g+a]=0;continue}if(B&&7===d){d=B[g-H+a-1]?l[g-H+a-1]:l[g+a];var n=B[g-H+a]?l[g-H+a]:l[g+a];c=B[g-H+a+1]?l[g-H+a+1]:l[g+a];var x=B[g+a-1]?l[g+a-1]:l[g+a];m=B[g+a+1]?l[g+a+1]:l[g+a];h=B[g+H+a-1]?l[g+H+a-1]:l[g+a];r=B[g+H+a]?l[g+H+a]:l[g+a];
E=B[g+H+a+1]?l[g+H+a+1]:l[g+a]}else d=l[g-H+a-1],n=l[g-H+a],c=l[g-H+a+1],x=l[g+a-1],m=l[g+a+1],h=l[g+H+a-1],r=l[g+H+a],E=l[g+H+a+1];x=(c+m+m+E-(d+x+x+h))*U;d=(h+r+r+E-(d+n+n+c))*f;n=-1;if(0!==x||0!==d)n=90-57.29578*Math.atan2(d,-x),0>n&&(n+=360),360===n?n=0:360<n&&(n%=360);k[g+a]=n}}for(l=0;l<N;l++)k[l*H]=k[l*H+1],k[(l+1)*H-1]=k[(l+1)*H-2];for(l=1;l<H-1;l++)k[l]=k[l+H],k[l+(N-1)*H]=k[l+(N-2)*H];return new F({width:H,height:N,pixels:[k],mask:B?b:null,pixelType:"f32",validPixelCount:R.validPixelCount,
statistics:[{minValue:0,maxValue:360}]})};P.calculateHillshadeParams=p;P.hillshade=function(R,U){if(!I.isValidPixelBlock(R))return R;const {width:H,height:N,mask:B}=R,l=new Uint8Array(H*N);var b=1;if(D.isSome(B)){for(var k=0;k<B.length;k++)if(B[k]){b=B[k];break}l.set(B)}const {factor:f,sinZcosA:c,sinZsinA:m,cosZ:h,sinZcosAs:r,sinZsinAs:E,cosZs:J,weights:d}=p(U),[n,x]=f;({hillshadeType:k}=U);const q=R.pixels[0];U=new Uint8Array(H*N);let g;const a=D.isSome(B);for(let u=1;u<N-1;u++){const z=u*H;for(let L=
1;L<H-1;L++)if(B&&!B[z+L])U[z+L]=0;else{var e=8;if(a&&(e=(B[z-H+L-1]+B[z-H+L]+B[z-H+L+1]+B[z+L-1]+B[z+L+1]+B[z+H+L-1]+B[z+H+L]+B[z+H+L+1])/b,7>e)){U[z+L]=0;l[z+L]=0;continue}if(B&&7===e){var t=B[z-H+L-1]?q[z-H+L-1]:q[z+L];var v=B[z-H+L]?q[z-H+L]:q[z+L];var w=B[z-H+L+1]?q[z-H+L+1]:q[z+L];e=B[z+L-1]?q[z+L-1]:q[z+L];g=B[z+L+1]?q[z+L+1]:q[z+L];var y=B[z+H+L-1]?q[z+H+L-1]:q[z+L];var G=B[z+H+L]?q[z+H+L]:q[z+L];var C=B[z+H+L+1]?q[z+H+L+1]:q[z+L]}else t=q[z-H+L-1],v=q[z-H+L],w=q[z-H+L+1],e=q[z+L-1],g=q[z+
L+1],y=q[z+H+L-1],G=q[z+H+L],C=q[z+H+L+1];e=(w+g+g+C-(t+e+e+y))*n;t=(y+G+G+C-(t+v+v+w))*x;v=Math.sqrt(1+e*e+t*t);w=0;if("traditional"===k)e=255*(h+m*t-c*e)/v,0>e&&(e=0),w=e;else for(y=E.length,G=0;G<y;G++)C=255*(J[G]+E[G]*t-r[G]*e)/v,0>C&&(C=0),w+=C*d[G];U[z+L]=w&255}}for(b=0;b<N;b++)U[b*H]=U[b*H+1],U[(b+1)*H-1]=U[(b+1)*H-2];for(b=1;b<H-1;b++)U[b]=U[b+H],U[b+(N-1)*H]=U[b+(N-2)*H];return new F({width:H,height:N,pixels:[U],mask:B?l:null,pixelType:"u8",validPixelCount:R.validPixelCount,statistics:[{minValue:0,
maxValue:255}]})};P.slope=function(R,U){if(!I.isValidPixelBlock(R))return R;var H=U.zFactor,N=U.pixelSizePower??1,B=U.pixelSizeFactor??1,l=U.slopeType,b=U.isGCS;const {width:k,height:f,mask:c}=R,m=R.pixels[0],h=new Uint8Array(k*f);let r=1;if(D.isSome(c)){for(var E=0;E<c.length;E++)if(c[E]){r=c[E];break}h.set(c)}E=new Float32Array(k*f);const {x:J,y:d}=U.resolution;U=H/(8*J);let n=H/(8*d);b&&1E-4>Math.abs(H-1)&&(U/=111E3,n/=111E3);"adjusted"===l&&(U=(H+J**N*B)/(8*J),n=(H+d**N*B)/(8*d));let x,q;let g,
a,e,t;H=D.isSome(c);for(N=1;N<f-1;N++)for(B=N*k,b=1;b<k-1;b++)if(c&&!c[B+b])E[B+b]=0;else{var v=0;if(H&&(v=(c[B-k+b-1]+c[B-k+b]+c[B-k+b+1]+c[B+b-1]+c[B+b+1]+c[B+k+b-1]+c[B+k+b]+c[B+k+b+1])/r,7>v)){E[B+b]=0;h[B+b]=0;continue}if(c&&7===v){v=c[B-k+b-1]?m[B-k+b-1]:m[B+b];x=c[B-k+b]?m[B-k+b]:m[B+b];q=c[B-k+b+1]?m[B-k+b+1]:m[B+b];var w=c[B+b-1]?m[B+b-1]:m[B+b];g=c[B+b+1]?m[B+b+1]:m[B+b];a=c[B+k+b-1]?m[B+k+b-1]:m[B+b];e=c[B+k+b]?m[B+k+b]:m[B+b];t=c[B+k+b+1]?m[B+k+b+1]:m[B+b]}else v=m[B-k+b-1],x=m[B-k+b],
q=m[B-k+b+1],w=m[B+b-1],g=m[B+b+1],a=m[B+k+b-1],e=m[B+k+b],t=m[B+k+b+1];w=(q+g+g+t-(v+w+w+a))*U;v=(a+e+e+t-(v+x+x+q))*n;v=Math.sqrt(w*w+v*v);E[B+b]="percent-rise"===l?100*v:57.2957795*Math.atan(v)}for(l=0;l<f;l++)E[l*k]=E[l*k+1],E[(l+1)*k-1]=E[(l+1)*k-2];for(l=1;l<k-1;l++)E[l]=E[l+k],E[l+(f-1)*k]=E[l+(f-2)*k];R=new F({width:k,height:f,pixels:[E],mask:c?h:null,pixelType:"f32",validPixelCount:R.validPixelCount});R.updateStatistics();return R};P.tintHillshade=function(R,U,H,N){if(I.isValidPixelBlock(R)&&
I.isValidPixelBlock(U)){var {min:B,max:l}=N;N=R.pixels[0];var {pixels:b,mask:k}=U;U=b[0];var f=255.00001/(l-B),c=new Uint8ClampedArray(U.length),m=new Uint8ClampedArray(U.length),h=new Uint8ClampedArray(U.length),r=H.length-1;for(let d=0;d<U.length;d++){if(k&&0===k[d])continue;var E=Math.floor((U[d]-B)*f);const [n,x]=H[0>E?0:E>r?r:E];var J=N[d];E=J*x;const q=E*(1-Math.abs(n%2-1));J-=E;switch(Math.floor(n)){case 0:c[d]=E+J;m[d]=q+J;h[d]=J;break;case 1:c[d]=q+J;m[d]=E+J;h[d]=J;break;case 2:c[d]=J;m[d]=
E+J;h[d]=q+J;break;case 3:c[d]=J;m[d]=q+J;h[d]=E+J;break;case 4:c[d]=q+J;m[d]=J;h[d]=E+J;break;case 5:case 6:c[d]=E+J,m[d]=J,h[d]=q+J}}R.pixels=[c,m,h];R.updateStatistics()}};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/BandArithmeticFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ./BandArithmeticFunctionArguments ./bandIndexUtils ./BaseRasterFunction".split(" "),
function(P,D,F,I,p,R,U,H,N,B){const l=new Set(["vari","mtvi2","rtvi-core","evi"]);p=function(b){function k(){var c=b.apply(this,arguments)||this;c.functionName="BandArithmetic";c.functionArguments=null;c.rasterArgumentNames=["raster"];return c}P._inheritsLoose(k,b);var f=k.prototype;f._bindSourceRasters=function(){this.outputPixelType=this._getOutputPixelType("f32");const c=this.sourceRasterInfos[0],m=c.clone();m.pixelType=this.outputPixelType;m.statistics=null;m.histograms=null;m.bandCount="sultan"===
this.functionArguments.method?c.bandCount:1;this.rasterInfo=m;return{success:!0,supportsGPU:!["custom","gvitm","sultan"].includes(this.functionArguments.method)}};f._processPixels=function(c){c=c.pixelBlocks?.[0];if(F.isNone(c))return c;const {method:m,bandIndexes:h}=this.functionArguments,r=h.split(" ").map(E=>parseFloat(E));return N.calculateBandIndex(c,{method:m,bandIndexes:r,equation:h})};f._getWebGLParameters=function(){const c=this.functionArguments.bandIndexes.split(" ").map(E=>parseFloat(E)-
1);2===c.length&&c.push(0);var m=this.isInputBandIdsSwizzled?[0,1,2]:c;const h=new Float32Array(3);({method:r}=this.functionArguments);switch(r){case "gndvi":case "nbr":case "ndbi":case "ndvi":case "ndvi-re":case "ndsi":case "ndmi":case "mndwi":m=N.getBandMatrix3([m[0],m[1],0]);var r="ndxi";break;case "ndwi":m=N.getBandMatrix3([m[1],m[0],0]);r="ndxi";break;case "sr":case "sr-re":case "iron-oxide":case "ferrous-minerals":case "clay-minerals":m=N.getBandMatrix3([m[0],m[1],0]);r="sr";break;case "ci-g":case "ci-re":m=
N.getBandMatrix3([m[0],m[1],0]);r="ci";break;case "savi":m=N.getBandMatrix3([m[0],m[1],0]);r="savi";h[0]=c[2]+1;break;case "tsavi":m=N.getBandMatrix3([m[0],m[1],0]);r="tsavi";h[0]=c[2]+1;h[1]=c[3]+1;h[2]=c[4]+1;break;case "msavi":m=N.getBandMatrix3([m[0],m[1],0]);r="msavi";break;case "gemi":m=N.getBandMatrix3([m[0],m[1],0]);r="gemi";break;case "pvi":m=N.getBandMatrix3([m[0],m[1],0]);r="tsavi";h[0]=c[2]+1;h[1]=c[3]+1;break;case "vari":m=N.getBandMatrix3([m[0],m[1],m[2]]);r="vari";break;case "mtvi2":m=
N.getBandMatrix3([m[0],m[1],m[2]]);r="mtvi2";break;case "rtvi-core":m=N.getBandMatrix3([m[0],m[1],m[2]]);r="rtvicore";break;case "evi":m=N.getBandMatrix3([m[0],m[1],m[2]]);r="evi";break;case "wndwi":m=N.getBandMatrix3([m[0],m[1],0]);r="wndwi";h[0]=c[3]?c[3]+1:.5;break;case "bai":m=N.getBandMatrix3([m[1],m[0],0]);r="bai";break;default:m=N.getBandMatrix3([0,1,2]),r="custom"}return{bandIndexMat3:m,indexType:r,adjustments:h}};f._getInputBandIds=function(c){if("custom"===this.functionArguments.method)return c;
var m=this.functionArguments.bandIndexes.split(" ").map(E=>parseFloat(E)-1);const h=c.length;m=m.map(E=>E>=h?h-1:E);const r=l.has(this.functionArguments.method)?3:2;m=m.slice(0,r).map(E=>c[E]);2===m.length&&m.push(0);return m};return k}(B);D.__decorate([I.property({json:{write:!0,name:"rasterFunction"}})],p.prototype,"functionName",void 0);D.__decorate([I.property({type:H,json:{write:!0,name:"rasterFunctionArguments"}})],p.prototype,"functionArguments",void 0);D.__decorate([I.property()],p.prototype,
"rasterArgumentNames",void 0);return p=D.__decorate([U.subclass("esri.layers.support.rasterFunctions.BandArithmeticFunction")],p)})},"esri/layers/support/rasterFunctions/BandArithmeticFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./bandIndexUtils ./BaseFunctionArguments".split(" "),
function(P,D,F,I,p,R,U,H,N){var B;p=B=function(l){function b(){var k=l.apply(this,arguments)||this;k.method="custom";return k}P._inheritsLoose(b,l);b.prototype.clone=function(){return new B({method:this.method,bandIndexes:this.bandIndexes,raster:F.clone(this.raster)})};return b}(N);D.__decorate([I.property({json:{type:String,write:!0}})],p.prototype,"bandIndexes",void 0);D.__decorate([R.enumeration(H.bandIndexMethodMap)],p.prototype,"method",void 0);return p=B=D.__decorate([U.subclass("esri.layers.support.rasterFunctions.BandArithmeticFunctionArguments")],
p)})},"esri/layers/support/rasterFunctions/bandIndexUtils":function(){define("exports ../../../core/jsonMap ../../../core/maybe ../PixelBlock ./customBandIndexUtils ./pixelUtils".split(" "),function(P,D,F,I,p,R){function U(x,q,g){const a=g.length,e=new Float32Array(a);for(let t=0;t<a;t++)if(null==x||x[t]){const v=q[t],w=g[t],y=v+w;y&&(e[t]=(v-w)/y)}return[e]}function H(x,q,g){const a=g.length,e=new Float32Array(a);for(let t=0;t<a;t++)if(null==x||x[t]){const v=q[t],w=g[t];w&&(e[t]=v/w)}return[e]}function N(x,
q,g){const a=q.length,e=new Float32Array(a);for(let t=0;t<a;t++)if(null==x||x[t]){const v=q[t],w=g[t];w&&(e[t]=v/w-1)}return[e]}function B(x,q,g,a){const e=g.length,t=new Float32Array(e);for(let v=0;v<e;v++)if(null==x||x[v]){const w=g[v],y=q[v],G=y+w+a;G&&(t[v]=(y-w)/G*(1+a))}return[t]}function l(x,q,g,a,e,t){const v=g.length,w=new Float32Array(v);t=-e*a+t*(1+a*a);for(let y=0;y<v;y++)if(null==x||x[y]){const G=g[y],C=q[y],u=e*C+G+t;u&&(w[y]=a*(C-a*G-e)/u)}return[w]}function b(x,q,g){const a=g.length,
e=new Float32Array(a);for(let t=0;t<a;t++)if(null==x||x[t]){const v=q[t];e[t]=.5*(2*(v+1)-Math.sqrt((2*v+1)**2-8*(v-g[t])))}return[e]}function k(x,q,g){const a=g.length,e=new Float32Array(a);for(let v=0;v<a;v++)if(null==x||x[v]){const w=g[v];var t=q[v];1!==w&&(t=(2*(t*t-w*w)+1.5*t+.5*w)/(t+w+.5),e[v]=t*(1-.25*t)-(w-.125)/(1-w))}return[e]}function f(x,q,g,a,e){const t=g.length,v=new Float32Array(t),w=Math.sqrt(1+a*a);for(let y=0;y<t;y++)if(null==x||x[y])v[y]=(q[y]-a*g[y]-e)/w;return[v]}function c(x,
q){const [g,a,e,t,v,w]=q;q=g.length;const y=new Float32Array(q);for(let G=0;G<q;G++)if(null==x||x[G])y[G]=-.2848*g[G]-.2435*a[G]-.5436*e[G]+.7243*t[G]+.084*v[G]-1.18*w[G];return[y]}function m(x,q){const [g,,a,e,t,v]=q;q=g.length;const w=new Float32Array(q),y=new Float32Array(q),G=new Float32Array(q);for(let C=0;C<q;C++)if(null==x||x[C])w[C]=v[C]?t[C]/v[C]*100:0,y[C]=g[C]?t[C]/g[C]*100:0,G[C]=e[C]?a[C]/e[C]*(t[C]/e[C])*100:0;return[w,y,G]}function h(x,q){const [g,a,e]=q;q=g.length;const t=new Float32Array(q);
for(let v=0;v<q;v++)if(null==x||x[v])for(v=0;v<q;v++){const w=g[v],y=a[v],G=y+w-e[v];G&&(t[v]=(y-w)/G)}return[t]}function r(x,q){const [g,a,e]=q;q=g.length;const t=new Float32Array(q);for(let v=0;v<q;v++)if(null==x||x[v])for(v=0;v<q;v++){const w=g[v],y=a[v],G=e[v];t[v]=1.5*(1.2*(w-G)-2.5*(y-G))*Math.sqrt((2*w+1)**2-6*w-5*Math.sqrt(y)-.5)}return[t]}function E(x,q){const [g,a,e]=q;q=g.length;const t=new Float32Array(q);for(let v=0;v<q;v++)if(null==x||x[v])for(v=0;v<q;v++){const w=g[v];t[v]=100*(w-a[v])-
10*(w-e[v])}return[t]}function J(x,q){const [g,a,e]=q;q=g.length;const t=new Float32Array(q);for(let v=0;v<q;v++)if(null==x||x[v])for(v=0;v<q;v++){const w=g[v],y=a[v],G=w+6*y-7.5*e[v]+1;G&&(t[v]=2.5*(w-y)/G)}return[t]}function d(x,q,g=.5){const [a,e,t]=q;q=e.length;const v=new Float32Array(q);for(let w=0;w<q;w++)if(null==x||x[w])for(w=0;w<q;w++){const y=a[w],G=e[w],C=t[w],u=y+g*G+(1-g)*C;u&&(v[w]=(y-g*G-(1-g)*C)/u)}return[v]}function n(x,q,g){const a=g.length,e=new Float32Array(a);for(let t=0;t<a;t++)if(null==
x||x[t])for(t=0;t<a;t++){const v=(.1-q[t])**2+(.06-g[t])**2;v&&(e[t]=1/v)}return[e]}D=new D.JSONMap({0:"custom",1:"ndvi",2:"savi",3:"tsavi",4:"msavi",5:"gemi",6:"pvi",7:"gvitm",8:"sultan",9:"vari",10:"gndvi",11:"sr",12:"ndvi-re",13:"sr-re",14:"mtvi2",15:"rtvi-core",16:"ci-re",17:"ci-g",18:"ndwi",19:"evi",20:"iron-oxide",21:"ferrous-minerals",22:"clay-minerals",23:"wndwi",24:"bai",25:"nbr",26:"ndbi",27:"ndmi",28:"ndsi",29:"mndwi"},{useNumericKeys:!0});P.bandIndexMethodMap=D;P.calculateBandIndex=function(x,
q){if(!R.isValidPixelBlock(x))return x;const {equation:g,method:a}=q;q=q.bandIndexes.map(w=>w-1);const {pixels:e,mask:t}=x;switch(a){case "gndvi":case "nbr":case "ndbi":case "ndvi":case "ndvi-re":case "ndsi":case "ndmi":case "mndwi":q=U(t,e[q[0]],e[q[1]]);break;case "ndwi":q=U(t,e[q[1]],e[q[0]]);break;case "sr":case "sr-re":case "iron-oxide":case "ferrous-minerals":case "clay-minerals":q=H(t,e[q[0]],e[q[1]]);break;case "ci-g":case "ci-re":q=N(t,e[q[0]],e[q[1]]);break;case "savi":q=B(t,e[q[0]],e[q[1]],
q[2]+1);break;case "tsavi":q=l(t,e[q[0]],e[q[1]],q[2]+1,q[3]+1,q[4]+1);break;case "msavi":q=b(t,e[q[0]],e[q[1]]);break;case "gemi":q=k(t,e[q[0]],e[q[1]]);break;case "pvi":q=f(t,e[q[0]],e[q[1]],q[2]+1,q[3]+1);break;case "gvitm":q=c(t,[e[q[0]],e[q[1]],e[q[2]],e[q[3]],e[q[4]],e[q[5]]]);break;case "sultan":q=m(t,[e[q[0]],e[q[1]],e[q[2]],e[q[3]],e[q[4]],e[q[5]]]);break;case "vari":q=h(t,[e[q[0]],e[q[1]],e[q[2]]]);break;case "mtvi2":q=r(t,[e[q[0]],e[q[1]],e[q[2]]]);break;case "rtvi-core":q=E(t,[e[q[0]],
e[q[1]],e[q[2]]]);break;case "evi":q=J(t,[e[q[0]],e[q[1]],e[q[2]]]);break;case "wndwi":q=d(t,[e[q[0]],e[q[1]],e[q[2]]],q[3]?q[3]+1:.5);break;case "bai":q=n(t,e[q[0]],e[q[1]]);break;case "custom":q=p.calculateCustomBandIndex(t,e,g);break;default:return x}const v=F.isSome(t)?new Uint8Array(t.length):null;F.isSome(t)&&F.isSome(v)&&v.set(t);x=new I({width:x.width,height:x.height,pixelType:"f32",pixels:q,mask:v});x.updateStatistics();return x};P.calculateNDVI=function(x,q,g,a){const {mask:e,pixels:t,width:v,
height:w}=x;x=t[g];q=t[q];g=q.length;const y=a?new Uint8Array(g):new Float32Array(g),G=a?100:1,C=a?100.5:0;for(let u=0;u<g;u++)if(null==e||e[u]){const z=x[u],L=q[u],S=z+L;S&&(y[u]=(z-L)/S*G+C)}a=new I({width:v,height:w,mask:e,pixelType:a?"u8":"f32",pixels:[y]});a.updateStatistics();return a};P.getBandMatrix3=function(x){const q=new Float32Array(9);q[3*x[0]]=1;q[3*x[1]+1]=1;q[3*x[2]+2]=1;return q};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/customBandIndexUtils":function(){define(["exports",
"../../../core/has"],function(P,D){const F=new Set("+-*/()".split(""));P.calculateCustomBandIndex=function(I,p,R){R=R.replace(/ /g,"");R.startsWith("-")&&(R="0"+R);R.startsWith("+")&&(R=R.slice(1,R.length));R=R.split("");var U=[],H=[],N="";for(let k=0;k<R.length;k++){const f=R[k];F.has(f)?(""!==N&&H.push(parseFloat(N)),U.push(f),N=""):"b"===f.toLowerCase()?(k++,N=f.concat(R[k]),H.push(p[parseInt(N[1],10)-1]),N=""):(N=N.concat(f),k===R.length-1&&H.push(parseFloat(N)))}let {ops:B,nums:l}={ops:U,nums:H};
if(0===B.length){I=1===l.length?l[0]:p[0];if(I instanceof Float32Array)return[I];var b=new Float32Array(p[0].length);"number"===typeof I?b.fill(I):b.set(I);return[b]}for(;0<B.length;){b=B;if(1===b.length)b={opIndex:0,numIndex:0};else{U=R=0;for(p=0;p<b.length;p++)if("("===b[p])R=p;else if(")"===b[p]){U=p;break}H=0===U?b:b.slice(R+1,U);p=-1;for(N=0;N<H.length;N++)if("*"===H[N]||"/"===H[N]){p=N;break}if(!(-1<p))for(N=0;N<H.length;N++)if("+"===H[N]||"-"===H[N]){p=N;break}0<U&&(p+=R+1);R=0;for(U=0;U<p;U++)"("===
b[U]&&R++;b={opIndex:p,numIndex:p-R}}const {numIndex:k,opIndex:f}=b;U=void 0;b=I;N=B[f];p=l[k];R=l[k+1];if("number"===typeof p&&"number"===typeof R)b=p+R;else{"number"===typeof p?(U=R.length,H=p,p=new Float32Array(U),p.fill(H)):(U=p.length,R.constructor===Number&&(H=R,R=new Float32Array(U),R.fill(H)));H=new Float32Array(U);switch(N){case "+":for(N=0;N<U;N++)if(null==b||b[N])H[N]=p[N]+R[N];break;case "-":for(N=0;N<U;N++)if(null==b||b[N])H[N]=p[N]-R[N];break;case "*":for(N=0;N<U;N++)if(null==b||b[N])H[N]=
p[N]*R[N];break;case "/":for(N=0;N<U;N++)(null==b||b[N])&&R[N]&&(H[N]=p[N]/R[N]);break;case "(":case ")":throw Error("encountered error with custom band index equation");}b=H}if(1===B.length)break;else{p=B;p.splice(f,1);U=R=0;do{U=R=0;for(H=0;H<p.length;H++)if("("===p[H])R=H;else if(")"===p[H]){U=H;break}U===R+1&&p.splice(R,2)}while(U===R+1);B=p;l.splice(k,2,b)}}return[b]};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/ColormapFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./ColormapFunctionArguments ./colormaps ../../../renderers/support/colorRampUtils".split(" "),
function(P,D,F,I,p,R,U,H,N,B){I=function(l){function b(){var f=l.apply(this,arguments)||this;f.functionName="Colormap";f.functionArguments=null;f.rasterArgumentNames=["raster"];f.isNoopProcess=!0;return f}P._inheritsLoose(b,l);var k=b.prototype;k._bindSourceRasters=function(){var f=this.sourceRasterInfos[0];if(1<f.bandCount)return{success:!1,supportsGPU:!1,error:"colormap-function: source data must be single band"};let {colormap:c,colormapName:m,colorRamp:h,colorRampName:r}=this.functionArguments;
if(!c?.length)if(h)c=B.convertColorRampToColormap(h,{interpolateAlpha:!0});else if(r){const E=B.getColorRampJSON(r);E&&(c=B.convertColorRampToColormap(E))}else m&&(c=N.getColormapByName(m));if(!c?.length)return{success:!1,supportsGPU:!1,error:"colormap-function: missing colormap argument"};this.outputPixelType=this._getOutputPixelType("u8");f=f.clone();f.pixelType=this.outputPixelType;f.colormap=c;f.bandCount=1;this.rasterInfo=f;return{success:!0,supportsGPU:!0}};k._processPixels=function(f){return f.pixelBlocks?.[0]};
return b}(U);D.__decorate([F.property({json:{write:!0,name:"rasterFunction"}})],I.prototype,"functionName",void 0);D.__decorate([F.property({type:H,json:{write:!0,name:"rasterFunctionArguments"}})],I.prototype,"functionArguments",void 0);D.__decorate([F.property()],I.prototype,"rasterArgumentNames",void 0);D.__decorate([F.property()],I.prototype,"isNoopProcess",void 0);D.__decorate([F.property({json:{write:!0}})],I.prototype,"indexedColormap",void 0);return I=D.__decorate([R.subclass("esri.layers.support.rasterFunctions.ColormapFunction")],
I)})},"esri/layers/support/rasterFunctions/ColormapFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/cast ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ../../../renderers/support/colorRampUtils ../../../rest/support/colorRamps".split(" "),function(P,D,F,I,p,R,
U,H,N,B){var l;H=l=function(b){function k(){return b.apply(this,arguments)||this}P._inheritsLoose(k,b);var f=k.prototype;f.castColormapName=function(c){if(!c)return null;c=c.toLowerCase();return N.rasterColormapNames.includes(c)?c:null};f.readColorRamp=function(c){return B.fromJSON(c)};f.readColorRampName=function(c,m){return c?(m=N.colorRampDict.jsonValues.find(h=>h.toLowerCase()===c.toLowerCase()))?N.colorRampDict.fromJSON(m):null:null};f.clone=function(){return new l({colormap:F.clone(this.colormap),
colormapName:this.colormapName,colorRamp:this.colorRamp?.clone(),colorRampName:this.colorRampName})};return k}(H);D.__decorate([I.property({type:[[Number]],json:{write:!0}})],H.prototype,"colormap",void 0);D.__decorate([I.property({type:String,json:{write:!0}})],H.prototype,"colormapName",void 0);D.__decorate([p.cast("colormapName")],H.prototype,"castColormapName",null);D.__decorate([I.property({types:B.types,json:{write:!0}})],H.prototype,"colorRamp",void 0);D.__decorate([R.reader("colorRamp")],
H.prototype,"readColorRamp",null);D.__decorate([I.property({type:N.colorRampDict.apiValues,json:{type:N.colorRampDict.jsonValues,write:N.colorRampDict.write}})],H.prototype,"colorRampName",void 0);D.__decorate([R.reader("colorRampName")],H.prototype,"readColorRampName",null);return H=l=D.__decorate([U.subclass("esri.layers.support.rasterFunctions.ColormapFunctionArguments")],H)})},"esri/layers/support/rasterFunctions/colormaps":function(){define(["exports","../../../renderers/support/colorRampUtils"],
function(P,D){function F(H,N){const B=[],l=[];for(let b=0;b<H.length-1;b++)B.push({type:"algorithmic",algorithm:"esriHSVAlgorithm",fromColor:H[b].slice(1),toColor:H[b+1].slice(1)}),l.push(H[b+1][0]-H[b][0]);H=H[H.length-1][0];N=N??l;return D.convertColorRampToColors({type:"multipart",colorRamps:B},{numColors:H,weights:N})}function I(){const H=F([[0,255,255,255],[70,0,0,255],[80,205,193,173],[100,150,150,150],[110,120,100,51],[130,120,200,100],[140,28,144,3],[160,6,55,0],[180,10,30,25],[201,6,27,7]]);
for(let N=H.length;256>N;N++)H.push([6,27,7]);return H}function p(){const H=[];for(let N=0;256>N;N++){const B=[];for(let l=0;3>l;l++)B.push(Math.round(255*Math.random()));H.push(B)}return H}const R=[[36,0,255],[36,0,255],[36,0,255],[36,0,255],[112,75,3],[113,76,3],[114,77,3],[115,77,3],[116,78,3],[117,79,3],[118,79,3],[119,80,3],[121,81,4],[122,82,4],[123,82,4],[124,83,4],[125,84,4],[126,84,4],[127,85,4],[128,86,4],[129,86,4],[130,87,4],[131,88,4],[132,89,4],[133,89,4],[134,90,4],[135,91,4],[136,
91,4],[137,92,4],[138,93,4],[139,94,4],[140,94,4],[142,95,5],[143,96,5],[144,96,5],[145,97,5],[146,98,5],[147,99,5],[148,99,5],[149,100,5],[150,101,5],[151,101,5],[152,102,5],[153,103,5],[154,104,5],[155,104,5],[156,105,5],[157,106,5],[158,106,5],[159,107,5],[160,108,5],[161,108,5],[162,109,5],[164,110,6],[165,111,6],[166,111,6],[167,112,6],[168,113,6],[169,113,6],[170,114,6],[171,115,6],[172,116,6],[173,116,6],[174,117,6],[245,0,0],[245,5,0],[245,10,0],[246,15,0],[246,20,0],[246,25,0],[246,30,0],
[247,35,0],[247,40,0],[247,45,0],[247,50,0],[247,55,0],[248,60,0],[248,65,0],[248,70,0],[248,75,0],[249,81,0],[249,86,0],[249,91,0],[249,96,0],[250,101,0],[250,106,0],[250,111,0],[250,116,0],[250,121,0],[251,126,0],[251,131,0],[251,136,0],[251,141,0],[252,146,0],[252,151,0],[252,156,0],[252,156,0],[251,159,0],[250,162,0],[249,165,0],[248,168,0],[247,171,0],[246,174,0],[245,177,0],[245,179,0],[244,182,0],[243,185,0],[242,188,0],[241,191,0],[240,194,0],[239,197,0],[238,200,0],[237,203,0],[236,206,0],
[235,209,0],[234,212,0],[233,215,0],[232,218,0],[231,221,0],[230,224,0],[230,226,0],[229,229,0],[228,232,0],[227,235,0],[226,238,0],[225,241,0],[224,244,0],[223,247,0],[165,247,0],[163,244,0],[161,240,0],[158,237,0],[156,233,1],[154,230,1],[152,227,1],[149,223,1],[147,220,1],[145,216,1],[143,213,1],[140,210,2],[138,206,2],[136,203,2],[134,200,2],[132,196,2],[129,193,2],[127,189,2],[125,186,3],[123,183,3],[120,179,3],[118,176,3],[116,172,3],[114,169,3],[111,166,3],[109,162,4],[107,159,4],[105,155,
4],[103,152,4],[100,149,4],[98,145,4],[96,142,4],[94,138,5],[91,135,5],[89,132,5],[87,128,5],[85,125,5],[82,121,5],[80,118,5],[78,115,6],[76,111,6],[73,108,6],[71,105,6],[69,101,6],[67,98,6],[65,94,6],[62,91,7],[60,88,7],[58,84,7],[56,81,7],[53,77,7],[51,74,7],[49,71,7],[47,67,8],[44,64,8],[42,60,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],
[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,
57,8],[40,57,8]],U=[[36,0,255],[36,0,255],[36,0,255],[36,0,255],[245,20,0],[245,24,0],[245,29,0],[245,31,0],[247,33,0],[247,33,0],[247,37,0],[247,41,0],[247,41,0],[247,41,0],[247,45,0],[247,45,0],[247,47,0],[247,49,0],[247,49,0],[247,54,0],[247,54,0],[247,56,0],[247,58,0],[247,58,0],[250,62,0],[250,62,0],[250,62,0],[250,67,0],[250,67,0],[250,67,0],[250,69,0],[250,71,0],[250,71,0],[250,75,0],[250,75,0],[250,78,0],[250,79,0],[250,79,0],[250,79,0],[250,81,0],[250,83,0],[250,83,0],[250,87,0],[250,87,
0],[250,90,0],[250,92,0],[252,93,0],[252,93,0],[252,97,0],[252,97,0],[252,97,0],[252,97,0],[252,101,0],[252,101,0],[252,101,0],[252,101,0],[252,105,0],[252,105,0],[252,107,0],[252,109,0],[252,109,0],[252,113,13],[255,118,20],[255,119,23],[255,121,25],[255,126,33],[255,132,38],[255,133,40],[255,135,43],[255,141,48],[255,144,54],[255,150,59],[255,152,61],[255,153,64],[255,159,69],[255,163,77],[255,165,79],[255,168,82],[255,174,87],[255,176,92],[255,181,97],[255,183,99],[255,186,102],[255,191,107],[255,
197,115],[255,201,120],[255,203,123],[255,205,125],[255,209,130],[255,214,138],[255,216,141],[255,218,143],[255,224,150],[255,228,156],[255,234,163],[255,236,165],[255,238,168],[255,243,173],[255,248,181],[255,252,186],[253,252,186],[250,252,187],[244,250,180],[238,247,176],[234,246,173],[231,245,169],[223,240,163],[217,237,157],[211,235,150],[205,233,146],[200,230,142],[195,227,136],[189,224,132],[184,222,126],[180,220,123],[174,217,119],[169,214,114],[163,212,108],[160,210,105],[154,207,101],[148,
204,96],[143,201,93],[138,199,88],[134,197,84],[130,194,81],[126,191,77],[117,189,70],[115,186,68],[112,184,64],[106,181,60],[100,179,55],[94,176,49],[92,174,47],[90,173,45],[81,168,37],[75,166,33],[71,163,28],[66,160,24],[62,158,21],[56,156,14],[51,153,0],[51,153,0],[51,153,0],[50,150,0],[50,150,0],[50,150,0],[50,150,0],[49,148,0],[49,148,0],[49,148,0],[48,145,0],[48,145,0],[48,145,0],[48,145,0],[48,143,0],[48,143,0],[48,143,0],[48,143,0],[47,140,0],[47,140,0],[47,140,0],[47,140,0],[46,138,0],[46,
138,0],[46,138,0],[46,138,0],[45,135,0],[45,135,0],[45,135,0],[45,135,0],[44,133,0],[44,133,0],[44,133,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[42,128,0],[42,128,0],[42,128,0],[42,125,0],[42,125,0],[42,125,0],[42,125,0],[41,122,0],[41,122,0],[41,122,0],[41,122,0],[40,120,0],[40,120,0],[40,120,0],[40,120,0],[40,120,0],[39,117,0],[39,117,0],[39,117,0],[39,117,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],
[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,
0],[38,115,0]];P.getColormapByName=function(H){let N;switch(H){case "elevation":N=F([[0,0,191,191],[51,0,255,0],[102,255,255,0],[153,255,127,0],[204,191,127,63],[256,20,20,20]]);break;case "gray":N=D.convertColorRampToColors({type:"algorithmic",algorithm:"esriHSVAlgorithm",fromColor:[0,0,0],toColor:[255,255,255]});break;case "hillshade":N=F([[0,38,54,41],[69,79,90,82],[131,156,156,156],[256,253,241,253]],[.268,.238,.495]);break;case "ndvi":N=R;break;case "ndvi2":N=I();break;case "ndvi3":N=U;break;
case "random":N=p()}return N?N=N.map((B,l)=>[l,...B]):null};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/CompositeBandFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./CompositeBandFunctionArguments ./pixelUtils".split(" "),
function(P,D,F,I,p,R,U,H,N,B){p=function(l){function b(){var f=l.apply(this,arguments)||this;f.functionName="CompositeBand";f.functionArguments=null;f.rasterArgumentNames=["rasters"];return f}P._inheritsLoose(b,l);var k=b.prototype;k._bindSourceRasters=function(){const {sourceRasterInfos:f}=this;var c=f[0];this.outputPixelType=this._getOutputPixelType(c.pixelType);c=c.clone();c.attributeTable=null;c.colormap=null;c.pixelType=this.outputPixelType;c.bandCount=f.map(({bandCount:m})=>m).reduce((m,h)=>
m+h);if(f.every(({statistics:m})=>F.isSome(m)&&m.length)){const m=[];f.forEach(({statistics:h})=>F.isSome(h)&&m.push(...h));c.statistics=m}if(f.every(({histograms:m})=>F.isSome(m)&&m.length)){const m=[];f.forEach(({histograms:h})=>F.isSome(h)&&m.push(...h));c.histograms=m}1<c.bandCount&&(c.colormap=null,c.attributeTable=null);this.rasterInfo=c;return{success:!0,supportsGPU:3>=c.bandCount}};k._processPixels=function(f){({pixelBlocks:f}=f);return!f||F.isNone(f?.[0])?null:B.compositeBands(f)};k._getWebGLParameters=
function(){return{bandCount:this.rasterInfo.bandCount}};return b}(H);D.__decorate([I.property({json:{write:!0,name:"rasterFunction"}})],p.prototype,"functionName",void 0);D.__decorate([I.property({type:N,json:{write:!0,name:"rasterFunctionArguments"}})],p.prototype,"functionArguments",void 0);D.__decorate([I.property()],p.prototype,"rasterArgumentNames",void 0);return p=D.__decorate([U.subclass("esri.layers.support.rasterFunctions.CompositeBandFunction")],p)})},"esri/layers/support/rasterFunctions/CompositeBandFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),
function(P,D,F,I,p,R,U,H){var N;p=N=function(B){function l(){var k=B.apply(this,arguments)||this;k.rasters=[];return k}P._inheritsLoose(l,B);var b=l.prototype;b.writeRasters=function(k,f){f.rasters=k.map(c=>"number"===typeof c||"string"===typeof c?c:c.toJSON())};b.clone=function(){return new N({rasters:F.clone(this.rasters)})};return l}(H);D.__decorate([I.property({json:{write:!0}})],p.prototype,"rasters",void 0);D.__decorate([U.writer("rasters")],p.prototype,"writeRasters",null);return p=N=D.__decorate([R.subclass("esri.layers.support.rasterFunctions.CompositeBandFunctionArguments")],
p)})},"esri/layers/support/rasterFunctions/ConvolutionFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ../rasterFunctionConstants ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./ConvolutionFunctionArguments ./convolutionUtils".split(" "),function(P,D,F,I,p,R,
U,H,N,B,l,b){p=function(k){function f(){var m=k.apply(this,arguments)||this;m.functionName="Convolution";m.rasterArgumentNames=["raster"];return m}P._inheritsLoose(f,k);var c=f.prototype;c._bindSourceRasters=function(){const {convolutionType:m,rows:h,cols:r,kernel:E}=this.functionArguments;if(!Object.values(H.convolutionKernel).includes(m))return{success:!1,supportsGPU:!1,error:`convolution-function: the specified kernel type is not supported ${m}`};if(m!==H.convolutionKernel.none&&h*r!==E.length)return{success:!1,
supportsGPU:!1,error:"convolution-function: the specified rows and cols do not match the length of the kernel"};var J=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType(J.pixelType);J=J.clone();J.pixelType=this.outputPixelType;const d=[H.convolutionKernel.none,H.convolutionKernel.sharpen,H.convolutionKernel.sharpen2,H.convolutionKernel.sharpening3x3,H.convolutionKernel.sharpening5x5];"u8"===this.outputPixelType||d.includes(m)||(J.statistics=null,J.histograms=null);J.colormap=
null;J.attributeTable=null;this.rasterInfo=J;return{success:!0,supportsGPU:25>=E.length}};c._processPixels=function(m){m=m.pixelBlocks?.[0];if(F.isNone(m)||this.functionArguments.convolutionType===H.convolutionKernel.none)return m;let {kernel:h,rows:r,cols:E}=this.functionArguments;const J=h.reduce((d,n)=>d+n);0!==J&&1!==J&&(h=h.map(d=>d/J));return b.convolute(m,{kernel:h,rows:r,cols:E,outputPixelType:this.outputPixelType})};c._getWebGLParameters=function(){let {kernel:m}=this.functionArguments;const h=
m.reduce((E,J)=>E+J);0!==h&&1!==h&&(m=m.map(E=>E/h));const r=new Float32Array(25);r.set(m);return{kernelRows:this.functionArguments.rows,kernelCols:this.functionArguments.cols,kernel:r,clampRange:N.getPixelValueRange(this.outputPixelType)}};return f}(B);D.__decorate([I.property({json:{write:!0,name:"rasterFunction"}})],p.prototype,"functionName",void 0);D.__decorate([I.property({type:l,json:{write:!0,name:"rasterFunctionArguments"}})],p.prototype,"functionArguments",void 0);D.__decorate([I.property()],
p.prototype,"rasterArgumentNames",void 0);return p=D.__decorate([U.subclass("esri.layers.support.rasterFunctions.ConvolutionFunction")],p)})},"esri/layers/support/rasterFunctionConstants":function(){define(["exports"],function(P){const D={plus:1,minus:2,times:3,sqrt:4,power:5,abs:10,divide:23,exp:25,exp10:26,exp2:27,int:30,float:32,ln:35,log10:36,log2:37,mod:44,negate:45,roundDown:48,roundUp:49,square:53,floatDivide:64,floorDivide:65},F={bitwiseAnd:11,bitwiseLeftShift:12,bitwiseNot:13,bitwiseOr:14,
bitwiseRightShift:15,bitwiseXOr:16,booleanAnd:17,booleanNot:18,booleanOr:19,booleanXOr:20,equalTo:24,greaterThan:28,greaterThanEqual:29,lessThan:33,lessThanEqual:34,isNull:31,notEqual:46},I={acos:6,asin:7,atan:8,atanh:9,cos:21,cosh:22,sin:51,sinh:52,tan:56,tanh:57,acosh:59,asinh:60,atan2:61},p={majority:38,max:39,mean:40,med:41,min:42,minority:43,range:47,stddev:54,sum:55,variety:58,majorityIgnoreNoData:66,maxIgnoreNoData:67,meanIgnoreNoData:68,medIgnoreNoData:69,minIgnoreNoData:70,minorityIgnoreNoData:71,
rangeIgnoreNoData:72,stddevIgnoreNoData:73,sumIgnoreNoData:74,varietyIgnoreNoData:75},R={setNull:50,conditional:78},U={...D,...F,...I,...p,...R};P.bandIndexType={userDefined:0,NDVI:1,SAVI:2,TSAVI:3,MSAVI:4,GEMI:5,PVI:6,GVITM:7,Sultan:8,VARI:9,GNDVI:10,SR:11,NDVIRe:12,SRRe:13,MTVI2:14,RTVICore:15,CIRe:16,CIG:17,NDWI:18,EVI:19,ironOxide:20,ferrousMinerals:21,clayMinerals:22,WNDWI:23,BAI:24,NBR:25,NDBI:26,NDMI:27,NDSI:28,MNDWI:29};P.cellStatisticalOperation=p;P.colorRampName={aspect:"Aspect",blackToWhite:"Black to White",
blueBright:"Blue Bright",blueLightToDark:"Blue Light to Dark",blueGreenBright:"Blue-Green Bright",blueGreenLightToDark:"Blue-Green Light to Dark",brownLightToDark:"Brown Light to Dark",brownToBlueGreenDivergingRight:"Brown to Blue Green Diverging, Bright",brownToBlueGreenDiverging:"Brown to Blue Green Diverging, Dark",coefficientBias:"Coefficient Bias",coldToHotDiverging:"Cold to Hot Diverging",conditionNumber:"Condition Number",cyanToPurple:"Cyan to Purple",cyanLightToBlueDark:"Cyan-Light to Blue-Dark",
distance:"Distance",elevation1:"Elevation #1",elevation2:"Elevation #2",errors:"Errors",grayLightToDark:"Gray Light to Dark",greenBright:"Green Bright",greenLightToDark:"Green Light to Dark",greenToBlue:"Green to Blue",orangeBright:"Orange Bright",orangeLightToDark:"Orange Light to Dark",partialSpectrum:"Partial Spectrum",partialSpectrum1Diverging:"Partial Spectrum 1 Diverging",partialSpectrum2Diverging:"Partial Spectrum 2 Diverging",pinkToYellowGreenDivergingBright:"Pink to YellowGreen Diverging, Bright",
pinkToYellowGreenDivergingDark:"Pink to YellowGreen Diverging, Dark",precipitation:"Precipitation",prediction:"Prediction",purpleBright:"Purple Bright",purpleToGreenDivergingBright:"Purple to Green Diverging, Bright",purpleToGreenDivergingDark:"Purple to Green Diverging, Dark",purpleBlueBright:"Purple-Blue Bright",purpleBlueLightToDark:"Purple-Blue Light to Dark",purpleRedBright:"Purple-Red Bright",purpleRedLightToDark:"Purple-Red Light to Dark",redBright:"Red Bright",redLightToDark:"Red Light to Dark",
redToBlueDivergingBright:"Red to Blue Diverging, Bright",redToBlueDivergingDark:"Red to Blue Diverging, Dark",redToGreen:"Red to Green",redToGreenDivergingBright:"Red to Green Diverging, Bright",redToGreenDivergingDark:"Red to Green Diverging, Dark",slope:"Slope",spectrumFullBright:"Spectrum-Full Bright",spectrumFullDark:"Spectrum-Full Dark",spectrumFullLight:"Spectrum-Full Light",surface:"Surface",temperature:"Temperature",whiteToBlack:"White to Black",yellowToDarkRed:"Yellow to Dark Red",yellowToGreenToDarkBlue:"Yellow to Green to Dark Blue",
yellowToRed:"Yellow to Red",yellowGreenBright:"Yellow-Green Bright",yellowGreenLightToDark:"Yellow-Green Light to Dark"};P.colormapName={random:"Random",NDVI:"NDVI",NDVI2:"NDVI2",NDVI3:"NDVI3",elevation:"Elevation",gray:"Gray",hillshade:"Hillshade"};P.convolutionKernel={userDefined:-1,lineDetectionHorizontal:0,lineDetectionVertical:1,lineDetectionLeftDiagonal:2,lineDetectionRightDiagonal:3,gradientNorth:4,gradientWest:5,gradientEast:6,gradientSouth:7,gradientNorthEast:8,gradientNorthWest:9,smoothArithmeticMean:10,
smoothing3x3:11,smoothing5x5:12,sharpening3x3:13,sharpening5x5:14,laplacian3x3:15,laplacian5x5:16,sobelHorizontal:17,sobelVertical:18,sharpen:19,sharpen2:20,pointSpread:21,none:255};P.localArithmeticOperation=D;P.localConditionalOperation=R;P.localLogicalOperation=F;P.localOperators=U;P.localTrigonometricOperation=I;P.missingBandAction={bestMatch:0,fail:1};P.noDataInterpretation={matchAny:0,matchAll:1};P.slopeType={degree:1,percentRise:2,adjusted:3};P.stretchType={none:0,standardDeviation:3,histogramEqualization:4,
minMax:5,percentClip:6,sigmoid:9};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/ConvolutionFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../rasterFunctionConstants ./BaseFunctionArguments ./convolutionUtils".split(" "),function(P,
D,F,I,p,R,U,H,N){var B;p=B=function(l){function b(){var k=l.apply(this,arguments)||this;k.rows=3;k.cols=3;k.kernel=[0,0,0,0,1,0,0,0,0];return k}P._inheritsLoose(b,l);b.prototype.clone=function(){return new B({cols:this.cols,rows:this.rows,kernel:[...this.kernel],convolutionType:this.convolutionType,raster:F.clone(this.raster)})};P._createClass(b,[{key:"convolutionType",set:function(k){this._set("convolutionType",k);const f=N.convolutionKernels.get(k);f&&k!==U.convolutionKernel.userDefined&&k!==U.convolutionKernel.none&&
(k=Math.sqrt(f.length),this._set("kernel",f),this._set("cols",k),this._set("rows",k))}}]);return b}(H);D.__decorate([I.property({json:{type:Number,write:!0}})],p.prototype,"rows",void 0);D.__decorate([I.property({json:{type:Number,write:!0}})],p.prototype,"cols",void 0);D.__decorate([I.property({json:{name:"type",type:Number,write:!0}})],p.prototype,"convolutionType",null);D.__decorate([I.property({json:{type:[Number],write:!0}})],p.prototype,"kernel",void 0);return p=B=D.__decorate([R.subclass("esri.layers.support.rasterFunctions.ConvolutionFunctionArguments")],
p)})},"esri/layers/support/rasterFunctions/convolutionUtils":function(){define(["exports","../PixelBlock","../rasterFunctionConstants"],function(P,D,F){function I(B){const l=Math.sqrt(B.length),b=B.slice(0,l),k=[1];for(let f=1;f<l;f++){let c=null;for(let m=0;m<l;m++){const h=B[m+f*l],r=B[m];if(null==c)if(0===r){if(h)return{separable:!1,row:null,col:null}}else c=h/r;else if(h/r!==c)return{separable:!1,row:null,col:null}}if(null==c)return{separable:!1,row:null,col:null};k.push(c)}return{separable:!0,
row:b,col:k}}function p(B,l,b,k,f,c,m){const h=new Float32Array(l*b),r=c.length,E=m?0:k,J=m?k:0;m=m?1:l;for(let d=E;d<b-E;d++){const n=d*l;for(let x=J;x<l-J;x++){if(f&&!f[n+x])continue;let q=0;for(let g=0;g<r;g++)q+=B[n+x+(g-k)*m]*c[g];h[n+x]=q}}return h}function R(B,l,b=!0){const {pixels:k,width:f,height:c,pixelType:m,mask:h}=B;B=k.length;const r=[],{kernel:E,rows:J,cols:d}=l;for(l=0;l<B;l++){var n=k[l],x=f,q=c,g=J,a=d,e=h,t=E;const v=new Float32Array(x*q),w=Math.floor(g/2),y=Math.floor(a/2);for(let G=
w;G<q-w;G++){const C=G*x;for(let u=y;u<x-y;u++){if(e&&!e[C+u])continue;let z=0;for(let L=0;L<g;L++)for(let S=0;S<a;S++)z+=n[C+u+(L-w)*x+S-y]*t[L*a+S];v[C+u]=z}}n=v;b&&U(n,f,c,J,d);r.push(n)}return new D({width:f,height:c,pixelType:m,pixels:r,mask:h})}function U(B,l,b,k,f){k=Math.floor(k/2);for(var c=0;c<k;c++)for(var m=0;m<l;m++)B[c*l+m]=B[(f-1-c)*l+m],B[(b-1-c)*l+m]=B[(b-f+c)*l+m];k=Math.floor(f/2);for(c=0;c<b;c++){m=c*l;for(let h=0;h<k;h++)B[m+h]=B[m+f-1-h],B[m+l-h-1]=B[m+l+h-f]}}function H(B,l,
b,k=!0){const {pixels:f,width:c,height:m,pixelType:h,mask:r}=B;B=f.length;const E=[],J=l.length,d=b.length,n=Math.floor(J/2),x=Math.floor(d/2);for(let q=0;q<B;q++){let g=p(f[q],c,m,n,r,l,!0);g=p(g,c,m,x,r,b,!1);k&&U(g,c,m,J,d);E.push(g)}return new D({width:c,height:m,pixelType:h,pixels:E,mask:r})}const N=new Map;N.set(F.convolutionKernel.none,[0,0,0,0,1,0,0,0,0]);N.set(F.convolutionKernel.lineDetectionHorizontal,[-1,-1,-1,2,2,2,-1,-1,-1]);N.set(F.convolutionKernel.lineDetectionVertical,[-1,2,-1,-1,
2,-1,-1,2,-1]);N.set(F.convolutionKernel.lineDetectionLeftDiagonal,[2,-1,-1,-1,2,-1,-1,-1,2]);N.set(F.convolutionKernel.lineDetectionRightDiagonal,[-1,-1,2,-1,2,-1,2,-1,-1]);N.set(F.convolutionKernel.gradientNorth,[-1,-2,-1,0,0,0,1,2,1]);N.set(F.convolutionKernel.gradientWest,[-1,0,1,-2,0,2,-1,0,1]);N.set(F.convolutionKernel.gradientEast,[1,0,-1,2,0,-2,1,0,-1]);N.set(F.convolutionKernel.gradientSouth,[1,2,1,0,0,0,-1,-2,-1]);N.set(F.convolutionKernel.gradientNorthEast,[0,-1,-2,1,0,-1,2,1,0]);N.set(F.convolutionKernel.gradientNorthWest,
[-2,-1,0,-1,0,1,0,1,2]);N.set(F.convolutionKernel.smoothArithmeticMean,[.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111]);N.set(F.convolutionKernel.smoothing3x3,[.0625,.125,.0625,.125,.25,.125,.0625,.125,.0625]);N.set(F.convolutionKernel.smoothing5x5,[1,1,1,1,1,1,4,4,4,1,1,4,12,4,1,1,4,4,4,1,1,1,1,1,1]);N.set(F.convolutionKernel.sharpening3x3,[-1,-1,-1,-1,9,-1,-1,-1,-1]);N.set(F.convolutionKernel.sharpening5x5,[-1,-3,-4,
-3,-1,-3,0,6,0,-3,-4,6,21,6,-4,-3,0,6,0,-3,-1,-3,-4,-3,-1]);N.set(F.convolutionKernel.laplacian3x3,[0,-1,0,-1,4,-1,0,-1,0]);N.set(F.convolutionKernel.laplacian5x5,[0,0,-1,0,0,0,-1,-2,-1,0,-1,-2,17,-2,-1,0,-1,-2,-1,0,0,0,-1,0,0]);N.set(F.convolutionKernel.sobelHorizontal,[-1,-2,-1,0,0,0,1,2,1]);N.set(F.convolutionKernel.sobelVertical,[-1,0,1,-2,0,2,-1,0,1]);N.set(F.convolutionKernel.sharpen,[0,-.25,0,-.25,2,-.25,0,-.25,0]);N.set(F.convolutionKernel.sharpen2,[-.25,-.25,-.25,-.25,3,-.25,-.25,-.25,-.25]);
N.set(F.convolutionKernel.pointSpread,[-.627,.352,-.627,.352,2.923,.352,-.627,.352,-.627]);P.convolute=function(B,l){const b=I(l.kernel),k=!1!==l.mirrorEdges;B=b.separable?H(B,b.row,b.col,k):R(B,l,k);({outputPixelType:l}=l);l&&B.clamp(l);return B};P.convoluteSeparable=H;P.convolutionKernels=N;P.separateKernels=I;Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/ExtractBandFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ./bandIndexUtils ./BaseRasterFunction ./ExtractBandFunctionArguments ./pixelUtils".split(" "),
function(P,D,F,I,p,R,U,H,N,B,l){p=function(b){function k(){var c=b.apply(this,arguments)||this;c.functionName="ExtractBand";c.functionArguments=null;c.rasterArgumentNames=["raster"];return c}P._inheritsLoose(k,b);var f=k.prototype;f._bindSourceRasters=function(){var {sourceRasterInfos:c}=this;c=c[0];const {bandCount:m}=c,{bandIds:h,missingBandAction:r}=this.functionArguments;if(r===l.MissingBandAction.fail&&h.some(d=>0>d||d>=m))return{success:!1,supportsGPU:!1,error:"extract-band-function: invalid bandIds"};
this.outputPixelType=this._getOutputPixelType("f32");c=c.clone();c.pixelType=this.outputPixelType;c.bandCount=h.length;const {statistics:E,histograms:J}=c;F.isSome(E)&&E.length&&(c.statistics=h.map(d=>E[d]||E[E.length-1]));F.isSome(J)&&J.length&&(c.histograms=h.map(d=>J[d]||J[J.length-1]));this.rasterInfo=c;return{success:!0,supportsGPU:3>=c.bandCount}};f._processPixels=function(c){c=c.pixelBlocks?.[0];if(F.isNone(c))return null;const m=c.pixels.length,h=this.functionArguments.bandIds.map(r=>r>=m?
m-1:r);return c.extractBands(h)};f._getWebGLParameters=function(){let c;if(this.isInputBandIdsSwizzled)c=this.swizzledBandSelection.length?this.swizzledBandSelection:[0,1,2];else{c=[...this.functionArguments.bandIds];0===c.length?c=[0,1,2]:3>c.length&&(c[1]=c[1]??c[0],c[2]=c[2]??c[1]);for(let m=0;3>m;m++)c[m]=Math.min(c[m],2)}return{bandIndexMat3:H.getBandMatrix3(c)}};f._getInputBandIds=function(c){const m=c.length;return this.functionArguments.bandIds.map(h=>h>=m?m-1:h).map(h=>c[h])};return k}(N);
D.__decorate([I.property({json:{write:!0,name:"rasterFunction"}})],p.prototype,"functionName",void 0);D.__decorate([I.property({type:B,json:{write:!0,name:"rasterFunctionArguments"}})],p.prototype,"functionArguments",void 0);D.__decorate([I.property()],p.prototype,"rasterArgumentNames",void 0);return p=D.__decorate([U.subclass("esri.layers.support.rasterFunctions.ExtractBandFunction")],p)})},"esri/layers/support/rasterFunctions/ExtractBandFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ./pixelUtils".split(" "),
function(P,D,F,I,p,R,U,H){var N;I=N=function(B){function l(){var b=B.apply(this,arguments)||this;b.bandIds=[];b.missingBandAction=H.MissingBandAction.bestMatch;return b}P._inheritsLoose(l,B);l.prototype.clone=function(){return new N({bandIds:[...this.bandIds],missingBandAction:this.missingBandAction})};return l}(U);D.__decorate([F.property({json:{write:!0}})],I.prototype,"bandIds",void 0);D.__decorate([F.property({json:{write:!0}})],I.prototype,"missingBandAction",void 0);return I=N=D.__decorate([R.subclass("esri.layers.support.rasterFunctions.ExtractBandFunctionArguments")],
I)})},"esri/layers/support/rasterFunctions/LocalFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ../rasterFunctionConstants ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./LocalFunctionArguments ./localUtils".split(" "),function(P,D,F,I,p,R,U,H,N,B,l,b){p=function(k){function f(){var m=
k.apply(this,arguments)||this;m.functionName="Local";m.functionArguments=null;m.rasterArgumentNames=["rasters"];return m}P._inheritsLoose(f,k);var c=f.prototype;c._bindSourceRasters=function(){var {sourceRasterInfos:m}=this,h=m[0];const {bandCount:r}=h;var {processAsMultiband:E}=this.functionArguments;if(m.some(n=>n.bandCount!==r))return{success:!1,supportsGPU:!1,error:"local-function: input rasters do not have same band count"};const {operation:J,rasters:d}=this.functionArguments;m=b.operandsCount[J];
if(!(999===m||d.length===m||1>=d.length&&1===m))return{success:!1,supportsGPU:!1,error:`local-function: the length of functionArguments.rasters does not match operation's requirement: ${m}`};this.outputPixelType=this._getOutputPixelType("f32");h=h.clone();h.pixelType=this.outputPixelType;h.statistics=null;h.histograms=null;h.colormap=null;h.attributeTable=null;h.bandCount=999!==m||E?r:1;if(E=b.getOutputDomain(J)){h.statistics=[];for(let n=0;n<h.bandCount;n++)h.statistics[n]={min:E[0],max:E[1],avg:(E[0]+
E[1])/2,stddev:(E[0]+E[1])/10}}this.rasterInfo=h;return{success:!0,supportsGPU:1===h.bandCount&&3>=m&&(11>J||16<J)}};c._processPixels=function(m){({pixelBlocks:m}=m);return F.isNone(m)||m.some(h=>F.isNone(h))?null:b.local(m,this.functionArguments.operation,{processAsMultiband:this.functionArguments.processAsMultiband,outputPixelType:this.outputPixelType??void 0})};c._getWebGLParameters=function(){const {operation:m}=this.functionArguments,h=b.operandsCount[m],r=Object.keys(H.localOperators).find(n=>
H.localOperators[n]===m)?.toLowerCase()??"undefined";var E=this.outputPixelType??"f32";let [J,d]=N.getPixelValueRange(E);if(E=E.startsWith("u")||E.startsWith("s"))J-=1E-4,d+=1E-4;return{imageCount:h,operationName:r,domainRange:[J,d],isOutputRounded:E}};return f}(B);D.__decorate([I.property({json:{write:!0,name:"rasterFunction"}})],p.prototype,"functionName",void 0);D.__decorate([I.property({type:l,json:{write:!0,name:"rasterFunctionArguments"}})],p.prototype,"functionArguments",void 0);D.__decorate([I.property()],
p.prototype,"rasterArgumentNames",void 0);return p=D.__decorate([U.subclass("esri.layers.support.rasterFunctions.LocalFunction")],p)})},"esri/layers/support/rasterFunctions/LocalFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),
function(P,D,F,I,p,R,U,H){var N;p=N=function(B){function l(){var k=B.apply(this,arguments)||this;k.rasters=[];k.processAsMultiband=!0;return k}P._inheritsLoose(l,B);var b=l.prototype;b.writeRasters=function(k,f){f.rasters=k.map(c=>"number"===typeof c||"string"===typeof c?c:c.toJSON())};b.clone=function(){return new N({operation:this.operation,processAsMultiband:this.processAsMultiband,rasters:F.clone(this.rasters)})};return l}(H);D.__decorate([I.property({json:{write:!0}})],p.prototype,"operation",
void 0);D.__decorate([I.property({json:{write:!0}})],p.prototype,"rasters",void 0);D.__decorate([U.writer("rasters")],p.prototype,"writeRasters",null);D.__decorate([I.property({json:{write:!0}})],p.prototype,"processAsMultiband",void 0);return p=N=D.__decorate([R.subclass("esri.layers.support.rasterFunctions.LocalFunctionArguments")],p)})},"esri/layers/support/rasterFunctions/localUtils":function(){define(["exports","../../../core/maybe","../PixelBlock","../rasterFunctionConstants","../rasterFormats/pixelRangeUtils"],
function(P,D,F,I,p){function R(ca,ia=!1){var da=ca.map(fa=>fa.mask);const ka=da.filter(fa=>D.isSome(fa));var la=ca[0].pixels[0].length;if(0===ka.length)return(new Uint8Array(la)).fill(255);ca=new Uint8Array(ka[0]);if(1===ka.length)return ca;if(!ia){for(ia=1;ia<ka.length;ia++)for(da=ka[ia],la=0;la<ca.length;la++)ca[la]&&(ca[la]=da[la]?255:0);return ca}if(ka.length!==da.length)return(new Uint8Array(la)).fill(255);for(ia=1;ia<ka.length;ia++)for(da=ka[ia],la=0;la<ca.length;la++)0===ca[la]&&(ca[la]=da[la]?
255:0);return ca}function U(ca,ia,da){const [ka,la]=ca;ca=ka.length;da=F.createEmptyBand(da,ca);for(let fa=0;fa<ca;fa++)if(!ia||ia[fa])da[fa]=ka[fa]+la[fa];return da}function H(ca,ia,da){[ca]=ca;ia=F.createEmptyBand("f32",ca.length);ia.set(ca);return ia}function N(ca,ia,da){const [ka,la]=ca;ca=ka.length;da=F.createEmptyBand(da,ca);for(let fa=0;fa<ca;fa++)if(!ia||ia[fa])da[fa]=ka[fa]-la[fa];return da}function B(ca,ia,da){const [ka,la]=ca;ca=ka.length;da=F.createEmptyBand(da,ca);for(let fa=0;fa<ca;fa++)if(!ia||
ia[fa])da[fa]=ka[fa]*la[fa];return da}function l(ca,ia,da){[ca]=ca;const ka=ca.length;da=F.createEmptyBand(da,ka);for(let la=0;la<ka;la++)if(!ia||ia[la])da[la]=Math.sign(ca[la])*Math.floor(Math.abs(ca[la]));return da}function b(ca,ia,da){const [ka,la]=ca;ca=ka.length;da=F.createEmptyBand(da,ca);for(let fa=0;fa<ca;fa++)if(!ia||ia[fa])da[fa]=ka[fa]/la[fa];return da}function k(ca,ia,da){return b(ca,ia,"f32")}function f(ca,ia,da){const [ka,la]=ca;ca=ka.length;da=F.createEmptyBand(da,ca);for(let fa=0;fa<
ca;fa++)if(!ia||ia[fa])da[fa]=Math.floor(ka[fa]/la[fa]);return da}function c(ca,ia,da,ka){ca=ca[0];const la=ca.length;da=F.createEmptyBand(da,la);if(ka===I.localTrigonometricOperation.atanh){for(ka=0;ka<la;ka++)if(ia[ka]){var fa=ca[ka];1<=Math.abs(fa)?ia[ka]=0:da[ka]=Math.atanh(fa)}return da}ka=ka===I.localTrigonometricOperation.asin?Math.asin:Math.acos;for(fa=0;fa<la;fa++)if(ia[fa]){const ua=ca[fa];1<Math.abs(ua)?ia[fa]=0:da[fa]=ka(ua)}return da}function m(ca,ia,da,ka){[ca]=ca;const la=ca.length;
da=F.createEmptyBand(da,la);for(let fa=0;fa<la;fa++)if(!ia||ia[fa])da[fa]=ka(ca[fa]);return da}function h(ca,ia,da,ka){const [la,fa]=ca;ca=la.length;da=F.createEmptyBand(da,ca);for(let ua=0;ua<ca;ua++)if(!ia||ia[ua])da[ua]=ka(la[ua],fa[ua]);return da}function r(ca,ia,da){const [ka,la]=ca;ca=ka.length;da=F.createEmptyBand(da,ca);for(let fa=0;fa<ca;fa++)if(!ia||ia[fa])da[fa]=ka[fa]&la[fa];return da}function E(ca,ia,da){const [ka,la]=ca;ca=ka.length;da=F.createEmptyBand(da,ca);for(let fa=0;fa<ca;fa++)if(!ia||
ia[fa])da[fa]=ka[fa]<<la[fa];return da}function J(ca,ia,da){[ca]=ca;const ka=ca.length;da=F.createEmptyBand(da,ka);for(let la=0;la<ka;la++)if(!ia||ia[la])da[la]=~ca[la];return da}function d(ca,ia,da){const [ka,la]=ca;ca=ka.length;da=F.createEmptyBand(da,ca);for(let fa=0;fa<ca;fa++)if(!ia||ia[fa])da[fa]=ka[fa]|la[fa];return da}function n(ca,ia,da){const [ka,la]=ca;ca=ka.length;da=F.createEmptyBand(da,ca);for(let fa=0;fa<ca;fa++)if(!ia||ia[fa])da[fa]=ka[fa]>>la[fa];return da}function x(ca,ia,da){const [ka,
la]=ca;ca=ka.length;da=F.createEmptyBand(da,ca);for(let fa=0;fa<ca;fa++)if(!ia||ia[fa])da[fa]=ka[fa]^la[fa];return da}function q(ca,ia,da){const [ka,la]=ca;ca=ka.length;da=F.createEmptyBand(da,ca);for(let fa=0;fa<ca;fa++)if(!ia||ia[fa])da[fa]=ka[fa]&&la[fa]?1:0;return da}function g(ca,ia,da){[ca]=ca;const ka=ca.length;da=F.createEmptyBand(da,ka);for(let la=0;la<ka;la++)if(!ia||ia[la])da[la]=ca[la]?0:1;return da}function a(ca,ia,da){const [ka,la]=ca;ca=ka.length;da=F.createEmptyBand(da,ca);for(let fa=
0;fa<ca;fa++)if(!ia||ia[fa])da[fa]=ka[fa]||la[fa]?1:0;return da}function e(ca,ia,da){const [ka,la]=ca;ca=ka.length;da=F.createEmptyBand(da,ca);for(let fa=0;fa<ca;fa++)if(!ia||ia[fa])da[fa]=(ka[fa]?1:0)^(la[fa]?1:0);return da}function t(ca,ia,da){const [ka,la]=ca;ca=ka.length;da=F.createEmptyBand(da,ca);for(let fa=0;fa<ca;fa++)if(!ia||ia[fa])da[fa]=ka[fa]===la[fa]?1:0;return da}function v(ca,ia,da,ka){[ca]=ca;const la=ca.length;da=F.createEmptyBand(da,la);const fa=ka===Math.E;for(let ua=0;ua<la;ua++)if(!ia||
ia[ua])da[ua]=fa?Math.exp(ca[ua]):ka**ca[ua];return da}function w(ca,ia,da){return v(ca,ia,da,10)}function y(ca,ia,da){return v(ca,ia,da,2)}function G(ca,ia,da){return v(ca,ia,da,Math.E)}function C(ca,ia,da,ka){[ca]=ca;const la=ca.length;da=F.createEmptyBand(da,la);for(let fa=0;fa<la;fa++)if(!ia||ia[fa])0>=ca[fa]?ia[fa]=0:da[fa]=ka(ca[fa]);return da}function u(ca,ia,da){return C(ca,ia,da,Math.log10)}function z(ca,ia,da){return C(ca,ia,da,Math.log2)}function L(ca,ia,da){return C(ca,ia,da,Math.log)}
function S(ca,ia,da){const [ka,la]=ca;ca=ka.length;da=F.createEmptyBand(da,ca);for(let fa=0;fa<ca;fa++)if(!ia||ia[fa])da[fa]=ka[fa]>la[fa]?1:0;return da}function Z(ca,ia,da){const [ka,la]=ca;ca=ka.length;da=F.createEmptyBand(da,ca);for(let fa=0;fa<ca;fa++)if(!ia||ia[fa])da[fa]=ka[fa]>=la[fa]?1:0;return da}function X(ca,ia,da){const [ka,la]=ca;ca=ka.length;da=F.createEmptyBand(da,ca);for(let fa=0;fa<ca;fa++)if(!ia||ia[fa])da[fa]=ka[fa]<la[fa]?1:0;return da}function M(ca,ia,da){const [ka,la]=ca;ca=
ka.length;da=F.createEmptyBand(da,ca);for(let fa=0;fa<ca;fa++)if(!ia||ia[fa])da[fa]=ka[fa]<=la[fa]?1:0;return da}function O(ca,ia,da){[ca]=ca;ca=ca.length;da=F.createEmptyBand(da,ca);if(!ia)return da;for(let ka=0;ka<ca;ka++)da[ka]=ia[ka]?0:1;return da}function A(ca,ia,da){const [ka,la]=ca;ca=ka.length;da=F.createEmptyBand(da,ca);for(let fa=0;fa<ca;fa++)if(!ia||ia[fa])da[fa]=ka[fa]%la[fa];return da}function Q(ca,ia,da){[ca]=ca;const ka=ca.length;da=F.createEmptyBand(da,ka);for(let la=0;la<ka;la++)if(!ia||
ia[la])da[la]=-ca[la];return da}function Y(ca,ia,da){const [ka,la]=ca;ca=ka.length;da=F.createEmptyBand(da,ca);for(let fa=0;fa<ca;fa++)if(!ia||ia[fa])da[fa]=ka[fa]===la[fa]?0:1;return da}function W(ca,ia,da){const [ka,la]=ca;ca=ka.length;da=F.createEmptyBand(da,ca);const fa=new Uint8Array(ca);for(let ua=0;ua<ca;ua++)null!=ia&&!ia[ua]||0!==ka[ua]||(da[ua]=la[ua],fa[ua]=255);return{band:da,mask:fa}}function T(ca,ia,da){const [ka,la,fa]=ca;ca=ka.length;da=F.createEmptyBand(da,ca);for(let ua=0;ua<ca;ua++)if(!ia||
ia[ua])da[ua]=ka[ua]?la[ua]:fa[ua];return da}function K(ca,ia,da){const ka=ca.length;if(2>ka)return ca[0];const [la]=ca,fa=la.length;da=F.createEmptyBand(da,fa);for(let ua=0;ua<fa;ua++)if(!ia||ia[ua]){let wa=la[ua];for(let za=1;za<ka;za++){const ya=ca[za][ua];wa<ya&&(wa=ya)}da[ua]=wa}return da}function V(ca,ia,da){const ka=ca.length;if(2>ka)return ca[0];const [la]=ca,fa=la.length;da=F.createEmptyBand(da,fa);for(let ua=0;ua<fa;ua++)if(!ia||ia[ua]){let wa=la[ua];for(let za=1;za<ka;za++){const ya=ca[za][ua];
wa>ya&&(wa=ya)}da[ua]=wa}return da}function ba(ca,ia,da){const ka=ca.length;if(2>ka)return ca[0];const [la]=ca,fa=la.length;da=F.createEmptyBand(da,fa);for(let ua=0;ua<fa;ua++)if(!ia||ia[ua]){let wa=la[ua],za=wa;for(let ya=1;ya<ka;ya++){const Aa=ca[ya][ua];za<Aa?za=Aa:wa>Aa&&(wa=Aa)}da[ua]=za-wa}return da}function aa(ca,ia,da){const ka=ca.length;if(2>ka)return ca[0];var [la]=ca;la=la.length;da=F.createEmptyBand(da,la);for(let fa=0;fa<la;fa++)if(!ia||ia[fa]){let ua=0;for(let wa=0;wa<ka;wa++)ua+=ca[wa][fa];
da[fa]=ua/ka}return da}function ea(ca,ia,da){const ka=ca.length;if(2>ka)return ca[0];var [la]=ca;la=la.length;da=F.createEmptyBand(da,la);for(let fa=0;fa<la;fa++)if(!ia||ia[fa])for(let ua=0;ua<ka;ua++)da[fa]+=ca[ua][fa];return da}function ja(ca,ia,da){const ka=ca.length;if(2>ka)return ca[0];var [la]=ca;la=la.length;da=F.createEmptyBand(da,la);for(let wa=0;wa<la;wa++)if(!ia||ia[wa]){const za=new Float32Array(ka);let ya=0;for(var fa=0;fa<ka;fa++){var ua=ca[fa];ya+=ua[wa];za[fa]=ua[wa]}ya/=ka;fa=0;for(ua=
0;ua<ka;ua++)fa+=(za[ua]-ya)**2;da[wa]=Math.sqrt(fa/ka)}return da}function ha(ca,ia,da){const ka=ca.length;if(2>ka)return ca[0];const la=Math.floor(ka/2);var [fa]=ca;fa=fa.length;da=F.createEmptyBand(da,fa);const ua=new Float32Array(ka),wa=1===ka%2;for(let za=0;za<fa;za++)if(!ia||ia[za]){for(let ya=0;ya<ka;ya++)ua[ya]=ca[ya][za];ua.sort();da[za]=wa?ua[la]:(ua[la]+ua[la-1])/2}return da}function ma(ca,ia,da){const [ka,la]=ca;if(null==la)return ka;ca=ka.length;da=F.createEmptyBand(da,ca);for(let fa=
0;fa<ca;fa++)ia[fa]&&(ka[fa]===la[fa]?da[fa]=ka[fa]:ia[fa]=0);return da}function na(ca,ia,da){const ka=ca.length;if(2>=ka)return ma(ca,ia,da);const la=ca[0].length;da=F.createEmptyBand(da,la);const fa=new Map;for(let wa=0;wa<la;wa++)if(!ia||ia[wa]){fa.clear();let za;for(var ua=0;ua<ka;ua++)za=ca[ua][wa],fa.set(za,fa.has(za)?fa.get(za)+1:1);let ya=ua=0;for(const Aa of fa.keys())ua=fa.get(Aa),ua>ya&&(ya=ua,za=Aa);da[wa]=za}return da}function qa(ca,ia,da){const ka=ca.length;if(2>=ka)return ma(ca,ia,
da);const la=ca[0].length;da=F.createEmptyBand(da,la);const fa=new Map;for(let wa=0;wa<la;wa++)if(!ia||ia[wa]){fa.clear();let za;for(var ua=0;ua<ka;ua++)za=ca[ua][wa],fa.set(za,fa.has(za)?fa.get(za)+1:1);ua=0;let ya=ca.length;for(const Aa of fa.keys())ua=fa.get(Aa),ua<ya&&(ya=ua,za=Aa);da[wa]=za}return da}function ra(ca,ia,da){const ka=ca.length;if(2>ka)return ca[0];var [la]=ca;la=la.length;da=F.createEmptyBand(da,la);const fa=new Set;for(let ua=0;ua<la;ua++)if(!ia||ia[ua]){fa.clear();let wa;for(let za=
0;za<ka;za++)wa=ca[za][ua],fa.add(wa);da[ua]=fa.size}return da}function pa(ca,ia,da,ka){let [la,fa]=p.getPixelValueRange(da);if(da=da.startsWith("u")||da.startsWith("s"))la-=1E-5,fa+=1E-5;for(let ua=0;ua<ia.length;ua++)if(ia[ua]){const wa=ca[ua];isNaN(wa)||wa<la||wa>fa?ia[ua]=0:ka[ua]=da?Math.round(wa):wa}}const oa=new Map;oa.set(I.localTrigonometricOperation.acos,[0,Math.PI]);oa.set(I.localTrigonometricOperation.asin,[-Math.PI/2,Math.PI/2]);oa.set(I.localTrigonometricOperation.atan,[-Math.PI/2,Math.PI/
2]);oa.set(I.localTrigonometricOperation.cos,[-1,1]);oa.set(I.localTrigonometricOperation.sin,[-1,1]);oa.set(I.localLogicalOperation.booleanAnd,[0,1]);oa.set(I.localLogicalOperation.booleanNot,[0,1]);oa.set(I.localLogicalOperation.booleanOr,[0,1]);oa.set(I.localLogicalOperation.booleanXOr,[0,1]);oa.set(I.localLogicalOperation.equalTo,[0,1]);oa.set(I.localLogicalOperation.notEqual,[0,1]);oa.set(I.localLogicalOperation.greaterThan,[0,1]);oa.set(I.localLogicalOperation.greaterThanEqual,[0,1]);oa.set(I.localLogicalOperation.lessThan,
[0,1]);oa.set(I.localLogicalOperation.lessThanEqual,[0,1]);oa.set(I.localLogicalOperation.isNull,[0,1]);const sa=new Map,va=new Map,ta=new Map,xa=new Map;P.getOutputDomain=function(ca){return oa.get(ca)};P.local=function(ca,ia,da={}){sa.size||(sa.set(4,Math.sqrt),sa.set(6,Math.acos),sa.set(7,Math.asin),sa.set(8,Math.atan),sa.set(9,Math.atanh),sa.set(10,Math.abs),sa.set(21,Math.cos),sa.set(22,Math.cosh),sa.set(48,Math.floor),sa.set(49,Math.ceil),sa.set(51,Math.sin),sa.set(52,Math.sinh),sa.set(56,Math.tan),
sa.set(57,Math.tanh),sa.set(59,Math.acosh),sa.set(60,Math.asinh),sa.set(65,Math.floor),va.set(5,Math.pow),va.set(61,Math.atan2),ta.set(1,U),ta.set(2,N),ta.set(3,B),ta.set(11,r),ta.set(12,E),ta.set(12,E),ta.set(13,J),ta.set(14,d),ta.set(15,n),ta.set(16,x),ta.set(17,q),ta.set(18,g),ta.set(19,a),ta.set(20,e),ta.set(23,b),ta.set(24,t),ta.set(25,G),ta.set(26,w),ta.set(27,y),ta.set(28,S),ta.set(29,Z),ta.set(30,l),ta.set(31,O),ta.set(32,H),ta.set(33,X),ta.set(34,M),ta.set(35,L),ta.set(36,u),ta.set(37,z),
ta.set(44,A),ta.set(45,Q),ta.set(46,Y),ta.set(64,k),ta.set(65,f),ta.set(76,T),ta.set(78,T),xa.set(38,na),xa.set(39,K),xa.set(40,aa),xa.set(41,ha),xa.set(42,V),xa.set(43,qa),xa.set(47,ba),xa.set(54,ja),xa.set(55,ea),xa.set(58,ra),xa.set(66,na),xa.set(67,K),xa.set(68,aa),xa.set(69,ha),xa.set(70,V),xa.set(71,qa),xa.set(72,ba),xa.set(73,ja),xa.set(74,ea),xa.set(75,ra));var ka=R(ca,66<=ia&&75>=ia);const {outputPixelType:la="f32"}=da,fa=!xa.has(ia)||da.processAsMultiband,ua=fa?ca[0].pixels.length:1;da=
[];for(let ya=0;ya<ua;ya++){var wa=xa.has(ia)&&!fa?ca.flatMap(Aa=>Aa.pixels):ca.map(Aa=>Aa.pixels[ya]),za=!0;ia===I.localConditionalOperation.setNull?(ka=W(wa,ka,la),wa=ka.band,ka=ka.mask,za=!1):ta.has(ia)?wa=ta.get(ia)(wa,ka,"f64"):sa.has(ia)?wa=ia===I.localTrigonometricOperation.asin||ia===I.localTrigonometricOperation.acos||ia===I.localTrigonometricOperation.atanh?c(wa,ka,"f64",ia):m(wa,ka,"f64",sa.get(ia)):va.has(ia)?wa=h(wa,ka,"f64",va.get(ia)):xa.has(ia)?wa=xa.get(ia)(wa,ka,"f64"):(wa=wa[0],
za=!1);za&&ia!==I.localLogicalOperation.isNull&&!oa.has(ia)&&(za=F.createEmptyBand(la,wa.length),ka||(ka=(new Uint8Array(wa.length)).fill(255)),pa(wa,ka,la,za),wa=za);da.push(wa)}ca=ca[0];return new F({width:ca.width,height:ca.height,pixelType:la,mask:ia===I.localLogicalOperation.isNull?null:ka,pixels:da})};P.operandsCount=[0,2,2,2,1,2,1,1,1,1,1,2,2,1,2,2,2,2,1,2,2,1,1,2,2,1,1,1,2,2,1,1,1,2,2,1,1,1,999,999,999,999,999,999,2,1,2,999,1,1,2,1,1,1,999,999,1,1,999,1,1,2,999,999,2,2,999,999,999,999,999,
999,999,999,999,999,3,999,3];Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/MaskFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/mathUtils ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./MaskFunctionArguments ./pixelUtils".split(" "),
function(P,D,F,I,p,R,U,H,N,B,l){R=function(b){function k(){var c=b.apply(this,arguments)||this;c.functionName="Mask";c.functionArguments=null;c.rasterArgumentNames=["raster"];return c}P._inheritsLoose(k,b);var f=k.prototype;f._bindSourceRasters=function(){var c=this.sourceRasterInfos[0].clone();const {pixelType:m}=c;this.outputPixelType=this._getOutputPixelType(m);c.pixelType=this.outputPixelType;this.rasterInfo=c;const {includedRanges:h,normalizedNoDataValues:r}=this.functionArguments;if(!h?.length&&
!r?.length)return{success:!1,supportsGPU:!1,error:"missing includedRanges or noDataValues argument"};let E=[];for(let J=0;J<c.bandCount;J++){const d=l.createMaskLUT(m,h?.slice(2*J,2*J+2),r?.[J]);if(null==d){E=null;break}E.push(d)}this.lookups=E;c=null!=r&&r.every(J=>J?.length===r[0]?.length);return{success:!0,supportsGPU:(!h||h.length<=2*l.MAX_MAP_SIZE_GPU)&&(!r||c&&r[0].length<=l.MAX_MAP_SIZE_GPU)}};f._processPixels=function(c){c=c.pixelBlocks?.[0];if(I.isNone(c))return null;const {outputPixelType:m,
lookups:h}=this,{includedRanges:r,noDataInterpretation:E,normalizedNoDataValues:J}=this.functionArguments;return l.mask(c,{includedRanges:r,noDataValues:J,outputPixelType:m,matchAll:E===l.NoDataInterpretation.matchAll,lookups:h})};f._getWebGLParameters=function(){const {includedRanges:c,normalizedNoDataValues:m}=this.functionArguments,h=new Float32Array(l.MAX_MAP_SIZE_GPU);h.fill(F.NUMBER_MAX_FLOAT32);m?.[0]?.length&&h.set(m[0]);const r=new Float32Array(l.MAX_MAP_SIZE_GPU);for(let E=0;E<r.length;E+=
2)r[E]=c?.[E]??-F.NUMBER_MAX_FLOAT32,r[E+1]=c?.[E+1]??F.NUMBER_MAX_FLOAT32;c&&c.length&&r.set(c);return{bandCount:this.sourceRasterInfos[0].bandCount,noDataValues:h,includedRanges:r}};return k}(N);D.__decorate([p.property({json:{write:!0,name:"rasterFunction"}})],R.prototype,"functionName",void 0);D.__decorate([p.property({type:B,json:{write:!0,name:"rasterFunctionArguments"}})],R.prototype,"functionArguments",void 0);D.__decorate([p.property()],R.prototype,"rasterArgumentNames",void 0);D.__decorate([p.property({json:{write:!0}})],
R.prototype,"lookups",void 0);return R=D.__decorate([H.subclass("esri.layers.support.rasterFunctions.MaskFunction")],R)})},"esri/layers/support/rasterFunctions/MaskFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ./pixelUtils".split(" "),function(P,D,F,I,
p,R,U,H){var N;I=N=function(B){function l(){var b=B.apply(this,arguments)||this;b.includedRanges=null;b.noDataValues=null;b.noDataInterpretation=H.NoDataInterpretation.matchAny;return b}P._inheritsLoose(l,B);l.prototype.clone=function(){return new N({includedRanges:this.includedRanges?.slice()??[],noDataValues:this.noDataValues?.slice()??[],noDataInterpretation:this.noDataInterpretation})};P._createClass(l,[{key:"normalizedNoDataValues",get:function(){var {noDataValues:b}=this;if(!b?.length)return null;
let k=!1;b=b.map(f=>"number"===typeof f?(k=!0,[f]):"string"===typeof f?(f=f.trim().split(" ").filter(c=>""!==c.trim()).map(c=>Number(c)),k=k||0<f.length,0===f.length?null:f):null);return k?b:null}}]);return l}(U);D.__decorate([F.property({json:{write:!0}})],I.prototype,"includedRanges",void 0);D.__decorate([F.property({json:{write:!0}})],I.prototype,"noDataValues",void 0);D.__decorate([F.property()],I.prototype,"normalizedNoDataValues",null);D.__decorate([F.property({json:{write:!0}})],I.prototype,
"noDataInterpretation",void 0);return I=N=D.__decorate([R.subclass("esri.layers.support.rasterFunctions.MaskFunctionArguments")],I)})},"esri/layers/support/rasterFunctions/NDVIFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ./bandIndexUtils ./BaseRasterFunction ./NDVIFunctionArguments".split(" "),
function(P,D,F,I,p,R,U,H,N,B){p=function(l){function b(){var f=l.apply(this,arguments)||this;f.functionName="NDVI";f.functionArguments=null;f.rasterArgumentNames=["raster"];return f}P._inheritsLoose(b,l);var k=b.prototype;k._bindSourceRasters=function(){const {scientificOutput:f}=this.functionArguments;this.outputPixelType=this._getOutputPixelType(f?"f32":"u8");const c=this.sourceRasterInfos[0].clone();c.pixelType=this.outputPixelType;c.colormap=null;c.histograms=null;c.bandCount=1;const [m,h,r,E]=
f?[-1,1,0,.1]:[0,200,100,10];c.statistics=[{min:m,max:h,avg:r,stddev:E}];this.rasterInfo=c;return{success:!0,supportsGPU:!0}};k._processPixels=function(f){f=f.pixelBlocks?.[0];if(F.isNone(f))return null;const {visibleBandID:c,infraredBandID:m,scientificOutput:h}=this.functionArguments;return H.calculateNDVI(f,c,m,!h)};k._getWebGLParameters=function(){const {visibleBandID:f,infraredBandID:c,scientificOutput:m}=this.functionArguments;return{bandIndexMat3:H.getBandMatrix3(this.isInputBandIdsSwizzled?
[0,1,2]:[c,f,0]),scaled:!m}};k._getInputBandIds=function(f){const {visibleBandID:c,infraredBandID:m}=this.functionArguments;return[m,c,0].map(h=>f[h])};return b}(N);D.__decorate([I.property({json:{write:!0,name:"rasterFunction"}})],p.prototype,"functionName",void 0);D.__decorate([I.property({type:B,json:{write:!0,name:"rasterFunctionArguments"}})],p.prototype,"functionArguments",void 0);D.__decorate([I.property()],p.prototype,"rasterArgumentNames",void 0);return p=D.__decorate([U.subclass("esri.layers.support.rasterFunctions.NDVIFunction")],
p)})},"esri/layers/support/rasterFunctions/NDVIFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),function(P,D,F,I,p,R,U){var H;I=H=function(N){function B(){var l=N.apply(this,arguments)||this;l.visibleBandID=0;l.infraredBandID=1;l.scientificOutput=
!1;return l}P._inheritsLoose(B,N);B.prototype.clone=function(){const {visibleBandID:l,infraredBandID:b,scientificOutput:k}=this;return new H({visibleBandID:l,infraredBandID:b,scientificOutput:k})};return B}(U);D.__decorate([F.property({json:{write:!0}})],I.prototype,"visibleBandID",void 0);D.__decorate([F.property({json:{write:!0}})],I.prototype,"infraredBandID",void 0);D.__decorate([F.property({json:{write:!0}})],I.prototype,"scientificOutput",void 0);return I=H=D.__decorate([R.subclass("esri.layers.support.rasterFunctions.NDVIFunctionArguments")],
I)})},"esri/layers/support/rasterFunctions/RemapFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/mathUtils ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./pixelUtils ./RemapFunctionArguments".split(" "),function(P,D,F,I,p,R,U,H,N,B,l,b){R=function(k){function f(){var m=
k.apply(this,arguments)||this;m.functionName="Remap";m.functionArguments=null;m.rasterArgumentNames=["raster"];m.lookup=null;return m}P._inheritsLoose(f,k);var c=f.prototype;c._bindSourceRasters=function(){const m=this.sourceRasterInfos[0].clone(),{pixelType:h}=m;this.outputPixelType=this._getOutputPixelType(h);m.pixelType=this.outputPixelType;m.colormap=null;m.histograms=null;m.bandCount=1;m.attributeTable=null;const {statistics:r}=m,{allowUnmatched:E,outputValues:J,inputRanges:d,noDataRanges:n,
isLastInputRangeInclusive:x}=this.functionArguments;if(I.isSome(r)&&r.length&&J?.length)if(E){var q=Math.min.apply(null,[...J,r[0].min]),g=Math.max.apply(null,[...J,r[0].max]);m.statistics=[{...r[0],min:q,max:g}]}else{g=q=J[0];for(let a=0;a<J.length;a++)q=q>J[a]?J[a]:q,g=g>J[a]?g:J[a];m.statistics=[{...r[0],min:q,max:g}]}this.rasterInfo=m;this.lookup=E?null:l.createRemapLUT({srcPixelType:h,inputRanges:d,outputValues:J,noDataRanges:n,allowUnmatched:E,isLastInputRangeInclusive:x,outputPixelType:this.outputPixelType});
return{success:!0,supportsGPU:(!J||J.length<=l.MAX_MAP_SIZE_GPU)&&(!n||n.length<=l.MAX_MAP_SIZE_GPU)}};c._processPixels=function(m){m=m.pixelBlocks?.[0];if(I.isNone(m))return null;const {lookup:h,outputPixelType:r}=this;if(h){const q=l.lookupPixels(m,{lut:[h.lut],offset:h.offset,outputPixelType:r});I.isSome(q)&&h.mask&&(q.mask=l.lookupBandValues(m.pixels[0],m.mask,h.mask,h.offset,"u8"));return q}const {inputRanges:E,outputValues:J,noDataRanges:d,allowUnmatched:n,isLastInputRangeInclusive:x}=this.functionArguments;
return l.remap(m,{inputRanges:E,outputValues:J,noDataRanges:d,outputPixelType:r,allowUnmatched:n,isLastInputRangeInclusive:x})};c._getWebGLParameters=function(){const {allowUnmatched:m,inputRanges:h,outputValues:r,noDataRanges:E,isLastInputRangeInclusive:J}=this.functionArguments,d=new Float32Array(3*l.MAX_MAP_SIZE_GPU);var n=r.length;if(h?.length){var x=0;let q=0;for(let g=0;g<d.length;g+=3)if(d[g]=h[x++]??F.NUMBER_MAX_FLOAT32-1,d[g+1]=h[x++]??F.NUMBER_MAX_FLOAT32,d[g+2]=r[q++]??0,q<=n&&(0<g&&(d[g]-=
1E-5),q<n||!J))d[g+1]-=1E-5}n=new Float32Array(2*l.MAX_MAP_SIZE_GPU);n.fill(F.NUMBER_MAX_FLOAT32);E?.length&&n.set(E);x=N.getPixelValueRange(this.outputPixelType);return{allowUnmatched:m,rangeMaps:d,noDataRanges:n,clampRange:x}};return f}(B);D.__decorate([p.property({json:{write:!0,name:"rasterFunction"}})],R.prototype,"functionName",void 0);D.__decorate([p.property({type:b,json:{write:!0,name:"rasterFunctionArguments"}})],R.prototype,"functionArguments",void 0);D.__decorate([p.property()],R.prototype,
"rasterArgumentNames",void 0);D.__decorate([p.property({json:{write:!0}})],R.prototype,"lookup",void 0);return R=D.__decorate([H.subclass("esri.layers.support.rasterFunctions.RemapFunction")],R)})},"esri/layers/support/rasterFunctions/RemapFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(P,D,F,I,p,R,U){var H;I=H=function(N){function B(){var l=N.apply(this,arguments)||this;l.inputRanges=null;l.outputValues=null;l.noDataRanges=null;l.allowUnmatched=!1;l.isLastInputRangeInclusive=!1;return l}P._inheritsLoose(B,N);B.prototype.clone=function(){return new H({inputRanges:[...this.inputRanges],outputValues:[...this.outputValues],noDataRanges:[...this.noDataRanges],allowUnmatched:this.allowUnmatched,isLastInputRangeInclusive:this.isLastInputRangeInclusive})};return B}(U);D.__decorate([F.property({json:{write:!0}})],
I.prototype,"inputRanges",void 0);D.__decorate([F.property({json:{write:!0}})],I.prototype,"outputValues",void 0);D.__decorate([F.property({json:{write:!0}})],I.prototype,"noDataRanges",void 0);D.__decorate([F.property({json:{write:!0}})],I.prototype,"allowUnmatched",void 0);D.__decorate([F.property({json:{write:!0}})],I.prototype,"isLastInputRangeInclusive",void 0);return I=H=D.__decorate([R.subclass("esri.layers.support.rasterFunctions.RemapFunctionArguments")],I)})},"esri/layers/support/rasterFunctions/SlopeFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./SlopeFunctionArguments ./surfaceUtils".split(" "),
function(P,D,F,I,p,R,U,H,N,B){const l=1/111E3;p=function(b){function k(){var c=b.apply(this,arguments)||this;c.functionName="Slope";c.functionArguments=null;c.rasterArgumentNames=["raster"];c.isGCS=!1;return c}P._inheritsLoose(k,b);var f=k.prototype;f._bindSourceRasters=function(){this.outputPixelType=this._getOutputPixelType("f32");const c=this.sourceRasterInfos[0].clone();c.pixelType=this.outputPixelType;c.statistics="percent-rise"!==this.functionArguments.slopeType?[{min:0,max:90,avg:1,stddev:1}]:
null;c.histograms=null;c.colormap=null;c.attributeTable=null;c.bandCount=1;this.rasterInfo=c;this.isGCS=c.spatialReference?.isGeographic??!1;return{success:!0,supportsGPU:!0}};f._processPixels=function(c){const m=c.pixelBlocks?.[0];if(F.isNone(m))return null;const {zFactor:h,slopeType:r,pixelSizePower:E,pixelSizeFactor:J}=this.functionArguments,{isGCS:d}=this;({extent:c}=c);return B.slope(m,{zFactor:h,slopeType:r,pixelSizePower:E,pixelSizeFactor:J,isGCS:d,resolution:c?{x:c.width/m.width,y:c.height/
m.height}:{x:1,y:1}})};f._getWebGLParameters=function(){const {zFactor:c,slopeType:m,pixelSizeFactor:h,pixelSizePower:r}=this.functionArguments;return{zFactor:this.isGCS&&1<=c?c*l:c,slopeType:m,pixelSizeFactor:h??0,pixelSizePower:r??0}};return k}(H);D.__decorate([I.property({json:{write:!0,name:"rasterFunction"}})],p.prototype,"functionName",void 0);D.__decorate([I.property({type:N,json:{write:!0,name:"rasterFunctionArguments"}})],p.prototype,"functionArguments",void 0);D.__decorate([I.property()],
p.prototype,"rasterArgumentNames",void 0);D.__decorate([I.property({json:{write:!0}})],p.prototype,"isGCS",void 0);return p=D.__decorate([U.subclass("esri.layers.support.rasterFunctions.SlopeFunction")],p)})},"esri/layers/support/rasterFunctions/SlopeFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(P,D,F,I,p,R,U,H,N){var B;F=new F.JSONMap({1:"degree",2:"percent-rise",3:"adjusted"},{useNumericKeys:!0});N=B=function(l){function b(){var k=l.apply(this,arguments)||this;k.slopeType="degree";k.zFactor=1;k.pixelSizePower=.664;k.pixelSizeFactor=.024;k.removeEdgeEffect=!1;return k}P._inheritsLoose(b,l);b.prototype.clone=function(){return new B({slopeType:this.slopeType,zFactor:this.zFactor,pixelSizePower:this.pixelSizePower,pixelSizeFactor:this.pixelSizeFactor,removeEdgeEffect:this.removeEdgeEffect,
raster:this.raster})};return b}(N);D.__decorate([U.enumeration(F)],N.prototype,"slopeType",void 0);D.__decorate([I.property({type:Number,json:{write:!0}})],N.prototype,"zFactor",void 0);D.__decorate([I.property({type:Number,json:{name:"psPower",write:!0}})],N.prototype,"pixelSizePower",void 0);D.__decorate([I.property({type:Number,json:{name:"psZFactor",write:!0}})],N.prototype,"pixelSizeFactor",void 0);D.__decorate([I.property({type:Boolean,json:{write:!0}})],N.prototype,"removeEdgeEffect",void 0);
return N=B=D.__decorate([H.subclass("esri.layers.support.rasterFunctions.SlopeFunctionArguments")],N)})},"esri/layers/support/rasterFunctions/StatisticsHistogramFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./StatisticsHistogramFunctionArguments".split(" "),function(P,
D,F,I,p,R,U,H){I=function(N){function B(){var b=N.apply(this,arguments)||this;b.functionName="StatisticsHistogram";b.functionArguments=null;b.rasterArgumentNames=["raster"];b.isNoopProcess=!0;return b}P._inheritsLoose(B,N);var l=B.prototype;l._bindSourceRasters=function(){var b=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType("u8");b=b.clone();const {statistics:k,histograms:f}=this.functionArguments;f&&(b.histograms=f);k&&(b.statistics=k);this.rasterInfo=b;return{success:!0,
supportsGPU:!0}};l._processPixels=function(b){return b.pixelBlocks?.[0]};return B}(U);D.__decorate([F.property({json:{write:!0,name:"rasterFunction"}})],I.prototype,"functionName",void 0);D.__decorate([F.property({type:H,json:{write:!0,name:"rasterFunctionArguments"}})],I.prototype,"functionArguments",void 0);D.__decorate([F.property()],I.prototype,"rasterArgumentNames",void 0);D.__decorate([F.property({json:{write:!0}})],I.prototype,"indexedColormap",void 0);D.__decorate([F.property()],I.prototype,
"isNoopProcess",void 0);return I=D.__decorate([R.subclass("esri.layers.support.rasterFunctions.StatisticsHistogramFunction")],I)})},"esri/layers/support/rasterFunctions/StatisticsHistogramFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),
function(P,D,F,I,p,R,U,H,N){var B;p=B=function(l){function b(){var f=l.apply(this,arguments)||this;f.statistics=null;f.histograms=null;return f}P._inheritsLoose(b,l);var k=b.prototype;k.readStatistics=function(f,c){if(!f?.length)return null;const m=[];f.forEach(h=>{m.push({min:h.min,max:h.max,avg:h.avg??h.mean,stddev:h.stddev??h.standardDeviation})});return m};k.writeStatistics=function(f,c,m){if(f?.length){var h=[];f.forEach(r=>{r={...r,mean:r.avg,standardDeviation:r.stddev};delete r.avg;delete r.stddev;
h.push(r)});c[m]=h}};k.clone=function(){return new B({statistics:F.clone(this.statistics),histograms:F.clone(this.histograms)})};return b}(N);D.__decorate([I.property({json:{write:!0}})],p.prototype,"statistics",void 0);D.__decorate([R.reader("statistics")],p.prototype,"readStatistics",null);D.__decorate([H.writer("statistics")],p.prototype,"writeStatistics",null);D.__decorate([I.property({json:{write:!0}})],p.prototype,"histograms",void 0);return p=B=D.__decorate([U.subclass("esri.layers.support.rasterFunctions.StatisticsHistogramFunctionArguments")],
p)})},"esri/layers/support/rasterFunctions/StretchFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./pixelUtils ./StretchFunctionArguments ./stretchUtils".split(" "),function(P,D,F,I,p,R,U,H,N,B,l){p=function(b){function k(){var c=b.apply(this,arguments)||
this;c.functionName="Stretch";c.functionArguments=null;c.rasterArgumentNames=["raster"];c.lookup=null;c.cutOffs=null;return c}P._inheritsLoose(k,b);var f=k.prototype;f._bindSourceRasters=function(){this.cutOffs=this.lookup=null;var c=this.sourceRasterInfos[0];const {pixelType:m}=c;var {functionArguments:h}=this;const {dynamicRangeAdjustment:r,gamma:E,useGamma:J}=h;if(!r&&["u8","u16","s8","s16"].includes(m)){h=l.getStretchCutoff(h.toJSON(),{rasterInfo:c});const d=this._isOutputRoundingNeeded()?"round":
"float";this.lookup=l.createStretchLUT({pixelType:m,...h,gamma:J?E:null,rounding:d});this.cutOffs=h}else r||(this.cutOffs=l.getStretchCutoff(h.toJSON(),{rasterInfo:c}));this.outputPixelType=this._getOutputPixelType(m);c=c.clone();c.pixelType=this.outputPixelType;c.statistics=null;c.histograms=null;c.colormap=null;c.attributeTable=null;"u8"===this.outputPixelType&&(c.keyProperties.DataType="processed");this.rasterInfo=c;return{success:!0,supportsGPU:!r}};f._processPixels=function(c){c=c.pixelBlocks?.[0];
if(F.isNone(c))return c;var {lookup:m}=this;if(m)return N.lookupPixels(c,{...m,outputPixelType:this.rasterInfo.pixelType});({functionArguments:m}=this);const h=this.cutOffs||l.getStretchCutoff(m.toJSON(),{rasterInfo:this.sourceRasterInfos[0],pixelBlock:c});return l.stretch(c,{...h,gamma:m.useGamma?m.gamma:null,outputPixelType:this.outputPixelType})};f._getWebGLParameters=function(){const {outputMin:c=0,outputMax:m=255,gamma:h,useGamma:r}=this.functionArguments,E=2<=this.rasterInfo.bandCount?3:1,J=
r&&h&&h.length?l.computeGammaCorrection(E,h):[1,1,1],{minCutOff:d,maxCutOff:n}=this.cutOffs??{minCutOff:[0,0,0],maxCutOff:[255,255,255]};1===d.length&&(d[1]=d[2]=d[0],n[1]=n[2]=n[0]);const x=new Float32Array(E);var q;for(q=0;q<E;q++)x[q]=(m-c)/(n[q]-d[q]);q=this._isOutputRoundingNeeded();return{bandCount:E,outMin:c,outMax:m,minCutOff:d,maxCutOff:n,factor:x,useGamma:r,gamma:r&&h?h:[1,1,1],gammaCorrection:r&&J?J:[1,1,1],stretchType:this.functionArguments.stretchType,isOutputRounded:q,type:"stretch"}};
return k}(H);D.__decorate([I.property({json:{write:!0,name:"rasterFunction"}})],p.prototype,"functionName",void 0);D.__decorate([I.property({type:B,json:{write:!0,name:"rasterFunctionArguments"}})],p.prototype,"functionArguments",void 0);D.__decorate([I.property()],p.prototype,"rasterArgumentNames",void 0);D.__decorate([I.property({json:{write:!0}})],p.prototype,"lookup",void 0);D.__decorate([I.property({json:{write:!0}})],p.prototype,"cutOffs",void 0);return p=D.__decorate([U.subclass("esri.layers.support.rasterFunctions.StretchFunction")],
p)})},"esri/layers/support/rasterFunctions/StretchFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),function(P,D,F,I,p,R,U,H,N,
B){var l;F=new F.JSONMap({0:"none",3:"standard-deviation",4:"histogram-equalization",5:"min-max",6:"percent-clip",9:"sigmoid"},{useNumericKeys:!0});B=l=function(b){function k(){var c=b.apply(this,arguments)||this;c.computeGamma=!1;c.dynamicRangeAdjustment=!1;c.gamma=[];c.histograms=null;c.statistics=null;c.stretchType="none";c.useGamma=!1;return c}P._inheritsLoose(k,b);var f=k.prototype;f.writeStatistics=function(c,m,h){c?.length&&(Array.isArray(c[0])||(c=c.map(r=>[r.min,r.max,r.avg,r.stddev])),m[h]=
c)};f.clone=function(){return new l({stretchType:this.stretchType,outputMin:this.outputMin,outputMax:this.outputMax,useGamma:this.useGamma,computeGamma:this.computeGamma,statistics:I.clone(this.statistics),gamma:I.clone(this.gamma),sigmoidStrengthLevel:this.sigmoidStrengthLevel,numberOfStandardDeviations:this.numberOfStandardDeviations,minPercent:this.minPercent,maxPercent:this.maxPercent,histograms:I.clone(this.histograms),dynamicRangeAdjustment:this.dynamicRangeAdjustment,raster:this.raster})};
return k}(B);D.__decorate([p.property({type:Boolean,json:{write:!0}})],B.prototype,"computeGamma",void 0);D.__decorate([p.property({type:Boolean,json:{name:"dra",write:!0}})],B.prototype,"dynamicRangeAdjustment",void 0);D.__decorate([p.property({type:[Number],json:{write:!0}})],B.prototype,"gamma",void 0);D.__decorate([p.property()],B.prototype,"histograms",void 0);D.__decorate([p.property({type:Number,json:{write:!0}})],B.prototype,"maxPercent",void 0);D.__decorate([p.property({type:Number,json:{write:!0}})],
B.prototype,"minPercent",void 0);D.__decorate([p.property({type:Number,json:{write:!0}})],B.prototype,"numberOfStandardDeviations",void 0);D.__decorate([p.property({type:Number,json:{name:"max",write:!0}})],B.prototype,"outputMax",void 0);D.__decorate([p.property({type:Number,json:{name:"min",write:!0}})],B.prototype,"outputMin",void 0);D.__decorate([p.property({type:Number,json:{write:!0}})],B.prototype,"sigmoidStrengthLevel",void 0);D.__decorate([p.property({json:{type:[[Number]],write:!0}})],B.prototype,
"statistics",void 0);D.__decorate([N.writer("statistics")],B.prototype,"writeStatistics",null);D.__decorate([U.enumeration(F)],B.prototype,"stretchType",void 0);D.__decorate([p.property({type:Boolean,json:{write:!0}})],B.prototype,"useGamma",void 0);return B=l=D.__decorate([H.subclass("esri.layers.support.rasterFunctions.StretchFunctionArguments")],B)})},"esri/layers/support/rasterFunctions/stretchUtils":function(){define(["exports","../../../core/maybe","../PixelBlock","../rasterFormats/pixelRangeUtils",
"../../../renderers/support/stretchRendererUtils"],function(P,D,F,I,p){function R(b,k=256){k=Math.min(k,256);const {size:f,counts:c}=b;b=new Uint8Array(f);var m=c.reduce((d,n)=>d+n/k,0);let h=0;var r=0;let E=0,J=m;for(let d=0;d<f;d++)if(E+=c[d],!(d<f-1&&E+c[d+1]<J)){for(;h<k-1&&J<E;)h++,J+=m;for(;r<=d;r++)b[r]=h;r=d+1}for(m=r;m<f;m++)b[m]=k-1;return b}function U(b,k){b=Math.min(Math.max(b,-100),100);k=Math.min(Math.max(k??0,-100),100);let f=0,c=0;const m=new Uint8Array(256);for(f=0;256>f;f++)0<b&&
100>b?c=(200*f-25500+510*k)/(2*(100-b))+128:0>=b&&-100<b?c=(200*f-25500+510*k)*(100+b)/2E4+128:100===b?(c=200*f-25500+256*(100-b)+510*k,c=0<c?255:0):-100===b&&(c=128),m[f]=255<c?255:0>c?0:c;return m}function H(b){if(D.isNone(b)||!b.pixels?.length)return null;const {pixels:k,mask:f,pixelType:c}=b,m=b.width*b.height,h=k.length;let r,E;let J;var d;const n=[],x=[];for(J=0;J<h;J++){var q=new Uint32Array(256);var g=k[J];if("u8"===c)if(r=-.5,E=255.5,f)for(d=0;d<m;d++)f[d]&&q[g[d]]++;else for(d=0;d<m;d++)q[g[d]]++;
else{d=!1;b.statistics||(b.updateStatistics(),d=!0);var a=b.statistics;r=a[J].minValue;E=a[J].maxValue;var e=(E-r)/256;if(0===e)for(!a||b.validPixelCount||d||b.updateStatistics(),e=(b.validPixelCount||b.width*b.height)/256,d=0;256>d;d++)q[d]=Math.round(e*(d+1))-Math.round(e*d);else{a=new Uint32Array(257);for(d=0;d<m;d++)f&&!f[d]||a[Math.floor((g[d]-r)/e)]++;for(d=0;255>d;d++)q[d]=a[d];q[255]=a[255]+a[256]}}n.push({min:r,max:E,size:256,counts:q});for(d=a=g=e=0;256>d;d++)e+=q[d],g+=d*q[d];g/=e;for(d=
0;256>d;d++)a+=q[d]*(d-g)**2;d=Math.sqrt(a/(e-1));e=(E-r)/256;q=(g+.5)*e+r;e*=d;x.push({min:r,max:E,avg:q,stddev:e})}return{statistics:x,histograms:n}}function N(b,k){if(null==k||0===k.length)return b;const f=Math.max.apply(null,k),{minCutOff:c,maxCutOff:m,outMin:h,outMax:r,histogramLut:E}=b;return c.length===k.length||c.length<=f?b:{minCutOff:k.map(J=>c[J]),maxCutOff:k.map(J=>m[J]),histogramLut:E?k.map(J=>E[J]):null,outMin:h,outMax:r}}function B(b,k){const f=new Float32Array(b);for(let c=0;c<b;c++)f[c]=
1<k[c]?2<k[c]?6.5+(k[c]-2)**2.5:6.5+100*(2-k[c])**4:1;return f}const l=[.299,.587,.114];P.computeGammaCorrection=B;P.computeGammaValues=function(b,k,f){const c=[];for(let J=0;J<k.length;J++){var m=0,h=0,r=0;"min"in k[J]?{min:m,max:h,avg:r}=k[J]:[m,h,r]=k[J];r=r??0;"u8"!==b&&(r=255*(r-m)/(h-m));f&&(r*=l[J]);m=c;h=m.push;if(0>=r||255<=r)r=1;else{var E=0;150!==r&&(E=150>=r?45*Math.cos(.01047*r):17*Math.sin(.021*r));E=Math.log((r+E)/255);0===E?r=1:(r=Math.log(r/255)/E,r=isNaN(r)?1:Math.min(9.9,Math.max(.01,
r)))}h.call(m,r)}return c};P.createContrastBrightnessLUT=U;P.createHistogramEqualizationLUT=R;P.createStretchLUT=function(b){const {minCutOff:k,maxCutOff:f,gamma:c,pixelType:m,rounding:h}=b,r=b.outMin||0,E=b.outMax||255;if(!["u8","u16","s8","s16"].includes(m))return null;const J=k.length;let d,n,x=0;"s8"===m?x=-127:"s16"===m&&(x=-32767);let q=256;["u16","s16"].includes(m)&&(q=65536);var g=[],a=[];const e=E-r;for(d=0;d<J;d++)a[d]=f[d]-k[d],g[d]=0===a[d]?0:e/a[d];let t;const v=[];let w,y;if(c&&c.length>=
J)for(g=B(J,c),d=0;d<J;d++){y=[];for(n=0;n<q;n++)if(0===a[d])y[n]=r;else{var G=n+x;t=(G-k[d])/a[d];w=1;1<c[d]&&(w-=(1/e)**(t*g[d]));G<f[d]&&G>k[d]?(G=w*e*t**(1/c[d])+r,y[n]="floor"===h?Math.floor(G):"round"===h?Math.round(G):G):y[n]=G>=f[d]?E:r}v[d]=y}else for(d=0;d<J;d++){y=[];for(n=0;n<q;n++)G=n+x,G<=k[d]?y[n]=r:G>=f[d]?y[n]=E:(a=(G-k[d])*g[d]+r,y[n]="floor"===h?Math.floor(a):"round"===h?Math.round(a):a);v[d]=y}if(null!=b.contrastOffset)for(b=U(b.contrastOffset,b.brightnessOffset),d=0;d<J;d++)for(y=
v[d],n=0;n<q;n++)y[n]=b[y[n]];return{lut:v,offset:x}};P.estimateStatisticsFromHistograms=function(b){const k=[];for(let h=0;h<b.length;h++){const {min:r,max:E,size:J,counts:d}=b[h];let n=0;var f=0;for(var c=0;c<J;c++)n+=d[c],f+=c*d[c];f/=n;c=0;for(var m=0;m<J;m++)c+=d[m]*(m-f)**2;m=(E-r)/J;k.push({min:r,max:E,avg:(f+.5)*m+r,stddev:Math.sqrt(c/(n-1))*m})}return k};P.estimateStatisticsHistograms=H;P.getStretchCutoff=function(b,k){const {pixelBlock:f,bandIds:c,returnHistogramLut:m,rasterInfo:h}=k;var r=
null;k=null;var E=b.stretchType;"number"===typeof E&&(E=p.stretchTypeFunctionEnum[E]);b.dra?"minMax"===E&&D.isSome(f)&&f.statistics?r=f.statistics.map(G=>[G.minValue,G.maxValue,0,0]):(k=H(f),r=D.isSome(k)?k.statistics:null,k=D.isSome(k)?k.histograms:null):(r=0<b.statistics?.length?b.statistics:D.unwrap(h.statistics),k=b.histograms||D.unwrap(h.histograms));"percentClip"!==E&&"histogramEqualization"!==E||k?.length||(E="minMax");var J=r?.length||k?.length||h.bandCount;const d=[],n=[];let x;let q,g,a,
e;r&&!Array.isArray(r[0])&&(r=r.map(G=>[G.min,G.max,G.avg,G.stddev]));const [t,v]=I.getPixelValueRange(h.pixelType);if(!r?.length){r=[];for(a=0;a<J;a++)r.push([t,v,1,1]);"standardDeviation"===E&&(E="minMax")}switch(E){case "none":for(a=0;a<J;a++)d[a]=t,n[a]=v;break;case "minMax":for(a=0;a<J;a++)d[a]=r[a][0],n[a]=r[a][1];break;case "standardDeviation":for(a=0;a<J;a++)d[a]=r[a][2]-b.numberOfStandardDeviations*r[a][3],n[a]=r[a][2]+b.numberOfStandardDeviations*r[a][3],d[a]<r[a][0]&&(d[a]=r[a][0]),n[a]>
r[a][1]&&(n[a]=r[a][1]);break;case "histogramEqualization":D.assertIsSome(k);for(a=0;a<J;a++)d[a]=k[a].min,n[a]=k[a].max;break;case "percentClip":D.assertIsSome(k);for(a=0;a<k.length;a++){r=k[a];q=new Uint32Array(r.size);var w=[...r.counts];20<=w.length&&(w[0]=w[1]=w[2]=w[w.length-1]=w[w.length-2]=0);x=0;J=(r.max-r.min)/r.size;g=-.5===r.min&&1===J?.5:0;for(e=0;e<r.size;e++)x+=w[e],q[e]=x;w=(b.minPercent||0)*x/100;d[a]=r.min+g;for(e=0;e<r.size;e++)if(q[e]>w){d[a]=r.min+J*(e+g);break}w=(1-(b.maxPercent||
0)/100)*x;n[a]=r.max+g;for(e=r.size-2;0<=e;e--)if(q[e]<w){n[a]=r.min+J*(e+2-g);break}n[a]<d[a]&&(r=d[a],d[a]=n[a],n[a]=r)}break;default:for(a=0;a<J;a++)d[a]=r[a][0],n[a]=r[a][1]}let y;"histogramEqualization"===E?(D.assertIsSome(k),E=k[0].size||256,b=0,m&&(y=k.map(G=>R(G)))):(E=b.max||255,b=b.min||0);return N({minCutOff:d,maxCutOff:n,outMax:E,outMin:b,histogramLut:y},c)};P.stretch=function(b,k){if(D.isNone(b)||!b.pixels?.length)return b;const {mask:f,width:c,height:m,pixels:h}=b,{minCutOff:r,maxCutOff:E,
gamma:J}=k;var d=k.outMin||0;const n=k.outMax||255,x=c*m,q=k.outputPixelType||"u8";b=b.pixels.map(()=>F.createEmptyBand(q,x));const g=b.length;let a;let e,t;var v=n-d,w=[];const y=[];for(a=0;a<g;a++)y[a]=E[a]-r[a],w[a]=0===y[a]?0:v/y[a];const G=q.startsWith("u")||q.startsWith("s"),C=!!k.isRenderer;if(J&&J.length>=g)for(w=B(g,J),k=0;k<x;k++){if(null==f||f[k])for(a=0;a<g;a++)if(0===y[a])b[a][k]=d;else{var u=h[a][k];t=(u-r[a])/y[a];e=1;1<J[a]&&(e-=(1/v)**(t*w[a]));u<E[a]&&u>r[a]?(u=e*v*t**(1/J[a])+d,
b[a][k]=C?Math.floor(u):G?Math.round(u):u):b[a][k]=u>=E[a]?n:d}}else for(k=0;k<x;k++)if(null==f||f[k])for(a=0;a<g;a++)u=h[a][k],u<E[a]&&u>r[a]?(v=(u-r[a])*w[a]+d,b[a][k]=C?Math.floor(v):G?Math.round(v):v):b[a][k]=u>=E[a]?n:d;d=new F({width:c,height:m,mask:f,pixels:b,pixelType:q});d.updateStatistics();return d};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/rasterRendererHelper":function(){define("exports ../../Color ../../rasterRenderers ../../core/maybe ../../core/unitUtils ../../layers/support/Field ../../layers/support/RasterInfo ../FlowRenderer ./AuthoringInfo ./ClassBreakInfo ./colorRampUtils ./UniqueValueInfo ../../rest/support/ClassBreaksDefinition ../../rest/support/generateRendererUtils ../../rest/support/MultipartColorRamp ../RasterStretchRenderer ../UniqueValueRenderer ../RasterColormapRenderer ../RasterShadedReliefRenderer ../ClassBreaksRenderer ../VectorFieldRenderer".split(" "),
function(P,D,F,I,p,R,U,H,N,B,l,b,k,f,c,m,h,r,E,J,d){function n(K,V){K=x(K,V?.variableName);const {bandCount:ba}=K;let {bandIds:aa,stretchType:ea}=V||{};aa?.some(qa=>qa>=ba)&&(aa=null);let ja=I.unwrap(K.statistics),ha=I.unwrap(K.histograms);1<ba?(aa=aa?.length?aa:q(K),ja=null==ja?null:aa?.map(qa=>ja[qa]),ha=null==ha?null:aa?.map(qa=>ha[qa])):aa=[0];null==ea&&(ea=a(K));let ma=!1;switch(ea){case "none":ma=!1;break;case "percent-clip":ma=!ha?.length;break;default:ma=!ja?.length}var {dataType:na}=K;na=
1===aa?.length&&W.has(na)?Q:null;na=new m({stretchType:ea,dynamicRangeAdjustment:ma,colorRamp:na,outputMin:0,outputMax:255,gamma:1===aa?.length?[1]:[1,1,1],useGamma:!1});"percent-clip"===ea?na.maxPercent=na.minPercent=.25:"standard-deviation"===ea&&(na.numberOfStandardDeviations=2);if(!ma&&(I.isSome(K.multidimensionalInfo)||V?.includeStatisticsInStretch))if("percent-clip"===ea)na.histograms=ha;else if("min-max"===ea||"standard-deviation"===ea)na.statistics=ja;return na}function x(K,V){if(!V)return K;
let ba=I.unwrap(K.statistics),aa=I.unwrap(K.histograms);var {multidimensionalInfo:ea}=K;if(V&&I.isSome(ea)&&(ea=ea.variables.find(ja=>ja.name===V))){const {statistics:ja,histograms:ha}=ea;ja?.length&&(ba=ja);ha?.length&&(aa=ha)}return U.fromJSON({...K.toJSON(),statistics:ba,histograms:aa})}function q(K){const V=K.bandCount;if(1===V)return null;if(2===V)return[0];K=K.keyProperties&&K.keyProperties.BandProperties;let ba;if(K&&K.length===V){const {red:aa,green:ea,blue:ja,nir:ha}=g(K);null!=aa&&null!=
ea&&null!=ja?ba=[aa,ea,ja]:null!=ha&&null!=aa&&null!=ea&&(ba=[ha,aa,ea])}!ba&&3<=V&&(ba=[0,1,2]);return ba}function g(K){const V={};for(let ea=0;ea<K.length;ea++){var ba=K[ea],aa=ba.BandName?.toLowerCase();"red"===aa?V.red=ea:"green"===aa?V.green=ea:"blue"===aa?V.blue=ea:"nearinfrared"===aa||"nearinfrared_1"===aa||"nir"===aa?V.nir=ea:ba.WavelengthMax&&ba.WavelengthMin&&(aa=ba.WavelengthMin,ba=ba.WavelengthMax,null==V.blue&&410<=aa&&480>=aa&&480<=ba&&540>=ba?V.blue=ea:null==V.green&&490<=aa&&560>=
aa&&560<=ba&&610>=ba?V.green=ea:null==V.red&&595<=aa&&670>=aa&&660<=ba&&730>=ba?V.red=ea:null==V.nir&&700<=aa&&860>=aa&&800<=ba&&950>=ba&&(V.nir=ea))}return V}function a(K){let V="percent-clip";const {pixelType:ba,dataType:aa,histograms:ea,statistics:ja,multidimensionalInfo:ha}=K;K=W.has(aa)||"generic"===aa&&I.isSome(ha);"u8"!==ba||"processed"!==aa&&I.isSome(ea)&&I.isSome(ja)?"u8"===ba||"elevation"===aa||K?V="min-max":I.isSome(ea)?V="percent-clip":I.isSome(ja)&&(V="min-max"):V="none";return V}function e(K,
V,ba,aa){if(!y(K,V))return null;const {attributeTable:ea,statistics:ja}=K,ha=t(ea,V),ma=w(ea,"red"),na=w(ea,"green"),qa=w(ea,"blue");K=new N;const ra=[],pa=new Set,oa=!!(ma&&na&&qa);if(I.isSome(ea))ea.features.forEach(sa=>{var va=sa.attributes[ha.name];pa.has(sa.attributes[ha.name])||null==va||(pa.add(va),va=!oa||"single"!==ma.type&&"double"!==ma.type||"single"!==na.type&&"double"!==na.type||"single"!==qa.type&&"double"!==qa.type||ea.features.some(ta=>1<ta.attributes[ma.name]||1<ta.attributes[na.name]||
1<ta.attributes[qa.name])?1:255,ra.push(new b({value:sa.attributes[ha.name],label:sa.attributes[ha.name]+"",symbol:{type:"simple-fill",style:"solid",outline:null,color:oa?new D([sa.attributes[ma.name]*va,sa.attributes[na.name]*va,sa.attributes[qa.name]*va,1]):new D([0,0,0,0])}})))});else if(ja?.[0])for(V=ja[0].min;V<=ja[0].max;V++)ra.push(new b({value:V,label:V.toString(),symbol:{type:"simple-fill",style:"solid",outline:null,color:new D([0,0,0,0])}}));ra.sort((sa,va)=>sa.value&&"string"===typeof sa.value.valueOf()?
0:sa.value>va.value?1:-1);if(!oa){const sa=l.convertColorRampToColormap(Y,{numColors:ra.length});ra.forEach((va,ta)=>va.symbol.color=new D(sa[ta].slice(1,4)));K.colorRamp=Y}if(ba||aa){const sa=ba||l.convertColorRampToColormap(aa,{numColors:ra.length}).map(va=>va.slice(1));ra.forEach((va,ta)=>va.symbol.color=new D(sa[ta]));K.colorRamp=aa}return new h({field:ha.name,uniqueValueInfos:ra,authoringInfo:K})}function t(K,V,ba){let aa;I.isSome(K)?(aa=V?K.fields.find(ea=>V.toLowerCase()===ea.name.toLowerCase()):
v(K.fields),aa||(ba||(aa=K.fields.find(ea=>"string"===ea.type)),aa||(aa=w(K,"value")))):aa=new R({name:"value"});return aa}function v(K){let V;for(let ba=0;ba<K.length;ba++){const aa=K[ba].name.toLowerCase();if("string"===K[ba].type){if(aa.startsWith("class")){V=K[ba];break}null==V&&(aa.endsWith("name")||aa.endsWith("type"))&&(V=K[ba])}}return V}function w(K,V){return I.isNone(K)?null:K.fields.find(ba=>ba.name.toLowerCase()===V)}function y(K,V){const {attributeTable:ba,bandCount:aa}=K;return I.isNone(ba)&&
S(K)?!0:I.isNone(ba)||1<aa||V&&null==ba.fields.find(ea=>ea.name.toLowerCase()===V.toLowerCase())?!1:!0}function G(K){const {bandCount:V,colormap:ba}=K;return I.isSome(ba)&&0<ba.length&&1===V}function C(K){if(!G(K))return null;let V;const {attributeTable:ba,colormap:aa}=K;if(I.isSome(ba)){const ea=w(ba,"value"),ja=t(ba,null,!0);"string"===ja.type&&(V={},ba.features.forEach(ha=>{ha=ha.attributes;V[ha[ea.name]]=ja?ha[ja.name]:ha[ea.name]}))}return r.createFromColormap(I.unwrap(aa),V)}function u(K){const {bandCount:V,
dataType:ba,pixelType:aa}=K;return"elevation"===ba||"generic"===ba&&1===V&&("s16"===aa||"s32"===aa||"f32"===aa||"f64"===aa)}function z(K,V=!1){const {attributeTable:ba,bandCount:aa}=K;return 1===aa&&(!V||I.isSome(ba)||I.isSome(K.histograms))}function L(K,V,ba){let aa=0,ea=0;I.isSome(K.attributeTable)?(K=K.attributeTable,aa=ea=K.features[0].attributes[V.name],K.features.forEach(ja=>{ja=ja.attributes[V.name];ja<aa&&(aa=ja);ja>ea&&(ea=ja)})):I.isSome(K.histograms)&&(K=K.histograms,aa=K[0].min,ea=K[0].max);
return(ea-aa)/ba}function S(K){return["u8","s8"].includes(K.pixelType)&&null!=K.statistics?.[0]?.min&&null!=K.statistics[0]?.max&&1===K.bandCount}function Z(K){({dataType:K}=K);return"vector-uv"===K||"vector-magdir"===K}function X(K){({dataType:K}=K);return"vector-uv"===K||"vector-magdir"===K}function M(K){if(!Z(K))return null;if(I.isSome(K.statistics)&&K.statistics.length&&("vector-magdir"===K.dataType||"vector-uv"===K.dataType)){const {minMagnitude:ba,maxMagnitude:aa}=A(K.dataType,K.statistics);
var V=[{type:"size",field:"Magnitude",minSize:10,maxSize:40,minDataValue:ba,maxDataValue:aa}]}K=I.isSome(K.multidimensionalInfo)?T.get(K.multidimensionalInfo.variables[0].unit):null;V=new d({visualVariables:V,inputUnit:K,rotationType:"geographic"});V.visualVariables=[...V.sizeVariables,...V.rotationVariables];return V}function O(K){return{color:K.symbolLayers[0].material?.color,type:"esriSFS",style:"esriSFSSolid"}}function A(K,V){if("vector-magdir"===K)K=V[0].min,V=V[0].max;else{const ba=V[0].min,
aa=V[0].max,ea=V[1].min;V=V[1].max;K=0;V=Math.max(Math.abs(ba),Math.abs(ea),Math.abs(aa),Math.abs(V))}return{minMagnitude:K,maxMagnitude:V}}const Q=c.fromJSON({type:"multipart",colorRamps:[{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]}),Y=c.fromJSON(l.PREDEFINED_JSON_COLOR_RAMPS[0]),W=new Set("scientific standard-time vector-uv vector-magdir vector-u vector-v vector-magnitude vector-direction".split(" ")),T=new Map([["m/s",
"meter-per-second"],["km/h","kilometer-per-hour"],["knots","knots"],["ft/s","feet-per-second"],["mph","mile-per-hour"]]);P.createClassBreaksRenderer=function(K,V){K=x(K,V?.variableName);const {attributeTable:ba}=K;if(!z(K))return null;const aa=I.isSome(K.histograms)?K.histograms[0]:null,ea=null!=V?.numClasses&&isFinite(V?.numClasses)?V.numClasses:5,ja=new N({classificationMethod:V?.classificationMethod,colorRamp:V?.colorRamp});let ha=V?.field||"value";const ma=[],na=[],qa=I.isSome(ba),ra=qa&&ba.fields.find(ta=>
"count"===ta.name.toLowerCase()),pa=qa?ba.fields.find(ta=>ta.name.toLowerCase()===ha.toLowerCase()):void 0;if(pa&&qa){ha=pa.name;const ta=ba.features.length;let xa=0;ba.features.forEach(ca=>xa+=(ra?ca.attributes[ra.name]:50)/ta);ba.features.forEach(ca=>{const ia=ca.attributes[pa.name];ca=ra?ca.attributes[ra.name]:50;if(0<ca){na.push(ca);ca=Math.max(1,Math.round(ca/ta/xa*1E3));for(let da=0;da<ca;da++)ma.push(ia)}})}else{var {pixelType:oa}=K;const ta=(aa.max-aa.min)/aa.size,xa=(oa=oa.includes("s")||
oa.includes("u"))&&1===ta?Math.floor(aa.min+.5):aa.min,ca=oa&&1===ta?Math.floor(aa.max-.5):aa.max,ia=aa.size;let da=0,ka;aa.counts.forEach(la=>da+=la/ia);aa.counts.forEach((la,fa)=>{if(0<la)for(na.push(la),la=Math.max(1,Math.round(la/ia/da*1E3)),ka=qa?ba.features[fa].attributes[pa.name]:0===fa?xa:fa===ia-1?ca:aa.min+ta*(fa+.5),fa=0;fa<la;fa++)ma.push(ka)})}oa=V?.classificationMethod||"natural-breaks";let sa=V?.definedInterval;"defined-interval"!==oa||sa||(sa=L(K,pa,ea));K=f.createGenerateRendererClassBreaks({values:ma,
valueFrequency:na,normalizationTotal:null,definition:new k({classificationMethod:oa,breakCount:ea,definedInterval:sa})});let va=V?.colors;va||(V=V?.colorRamp||Q,ja.colorRamp=V,va=l.convertColorRampToColormap(V,{numColors:K.classBreaks.length,interpolateAlpha:!0}).map(ta=>ta.slice(1)));V=K.classBreaks.map((ta,xa)=>new B({minValue:ta.minValue,maxValue:ta.maxValue,label:ta.label,symbol:{type:"simple-fill",color:va[xa]}}));return new J({field:ha,classBreakInfos:V,authoringInfo:ja})};P.createColormapRenderer=
C;P.createDefaultRenderer=function(K,V){const {attributeTable:ba,colormap:aa}=K;if(Z(K)){var ea=M(K);if(I.isSome(ea))return ea}return I.isSome(aa)&&(ea=C(K),I.isSome(ea))||I.isSome(ba)&&(ea=e(K),I.isSome(ea))?ea:n(K,V)};P.createFlowRenderer=function(K){if(!X(K))return null;let V;if(I.isSome(K.statistics)&&0<K.statistics.length&&("vector-magdir"===K.dataType||"vector-uv"===K.dataType)){const {minMagnitude:ba,maxMagnitude:aa}=A(K.dataType,K.statistics);V=[{type:"color",field:"Magnitude",stops:[{value:ba,
color:"#1020C0"},{value:aa,color:"#C02010"}]}]}return new H({visualVariables:V})};P.createShadedReliefRenderer=function(K,V="traditional"){if(!u(K))return null;({extent:K}=K);K=K.width*p.getMetersPerUnitForSR(K.spatialReference);return new E({hillshadeType:V,scalingType:5E6<K?"adjusted":"none"})};P.createStretchRenderer=n;P.createUVRenderer=e;P.createVectorFieldRenderer=M;P.estimateMagnitudeRange=A;P.getBandNames=function(K,V){const ba=K.keyProperties&&K.keyProperties.BandProperties;V=V?.length?V:
Array.from(Array(K.bandCount).keys());return V.map(aa=>ba&&ba.length===K.bandCount?ba[aa]&&ba[aa].BandName||"band_"+(aa+1):"band_"+(aa+1))};P.getClassField=t;P.getDefaultBandCombination=q;P.getDefaultInterpolation=function(K,V,ba){const aa=["nearest","bilinear","cubic","majority"].find(ea=>ea===ba?.toLowerCase());return"Map"===V?aa??"bilinear":"standard-time"===K.dataType?aa??"nearest":"thematic"===K.dataType||K.attributeTable||K.colormap?"nearest"===aa||"majority"===aa?aa:"nearest":aa??"bilinear"};
P.getDefinedInterval=L;P.getField=w;P.getSupportedRendererTypes=function(K,V=!1){const ba=["raster-stretch"];G(K)&&ba.push("raster-colormap");y(K)&&ba.push("unique-value");z(K,V)&&ba.push("class-breaks");u(K)&&ba.push("raster-shaded-relief");Z(K)&&ba.push("vector-field");X(K)&&ba.push("flow");return ba};P.getVariableRasterInfo=x;P.getWellKnownBandIndexes=g;P.isClassBreaksSupported=z;P.isColormapRendererSupported=G;P.isFlowRendererSupported=X;P.isShadedReliefRendererSupported=u;P.isSingleBand8BitRasterWithStats=
S;P.isUVRendererSupported=y;P.isVectorFieldRendererSupported=Z;P.normalizeRendererJSON=function(K){if("uniqueValue"===K.type){var V=K.uniqueValueInfos;V?.[0].symbol?.symbolLayers?.length&&(K.uniqueValueInfos=V?.map(ba=>({value:ba.value,label:ba.label,symbol:ba.symbol?O(ba.symbol):null})));return K}"classBreaks"===K.type&&(V=K.classBreakInfos,V[0].symbol?.symbolLayers?.length&&(K.classBreakInfos=V.map(ba=>({classMinValue:ba.classMinValue,classMaxValue:ba.classMaxValue,label:ba.label,symbol:ba.symbol?
O(ba.symbol):null}))));return K};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/ClassBreaksDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),function(P,D,F,I,p,R,U,
H,N){R=new F.JSONMap({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"});F=new F.JSONMap({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});I=function(B){function l(b){b=B.call(this,b)||this;b.type="class-breaks-definition";b.breakCount=null;b.classificationField=
null;b.classificationMethod=null;b.normalizationField=null;b.normalizationType=null;return b}P._inheritsLoose(l,B);P._createClass(l,[{key:"standardDeviationInterval",set:function(b){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",b)}},{key:"definedInterval",set:function(b){"defined-interval"===this.classificationMethod&&this._set("definedInterval",b)}}]);return l}(I.JSONSupport);D.__decorate([H.enumeration({classBreaksDef:"class-breaks-definition"})],I.prototype,
"type",void 0);D.__decorate([p.property({json:{write:!0}})],I.prototype,"breakCount",void 0);D.__decorate([p.property({json:{write:!0}})],I.prototype,"classificationField",void 0);D.__decorate([p.property({type:String,json:{read:R.read,write:R.write}})],I.prototype,"classificationMethod",void 0);D.__decorate([p.property({json:{write:!0}})],I.prototype,"normalizationField",void 0);D.__decorate([p.property({json:{read:F.read,write:F.write}})],I.prototype,"normalizationType",void 0);D.__decorate([p.property({value:null,
json:{write:!0}})],I.prototype,"standardDeviationInterval",null);D.__decorate([p.property({value:null,json:{write:!0}})],I.prototype,"definedInterval",null);return I=D.__decorate([N.subclass("esri.rest.support.ClassBreaksDefinition")],I)})},"esri/rest/support/generateRendererUtils":function(){define(["exports","../../core/Logger"],function(P,D){function F(k){var f=k.definition;const {classificationMethod:c,normalizationType:m,definedInterval:h}=f;f=f.breakCount??1;const r=[];var E=k.values;if(0===
E.length)return[];E=E.sort((g,a)=>g-a);var J=E[0],d=E[E.length-1];if("equal-interval"===c)if(E.length>=f){E=(d-J)/f;k=J;for(var n=1;n<f;n++){var x=Number((J+n*E).toFixed(6));r.push({minValue:k,maxValue:x,label:I(k,x,m)});k=x}r.push({minValue:k,maxValue:d,label:I(k,d,m)})}else E.forEach(g=>{r.push({minValue:g,maxValue:g,label:I(g,g,m)})});else if("natural-breaks"===c){E=p(E);k=R(E.uniqueValues,k.valueFrequency||E.valueFrequency,f);for(n=1;n<f;n++)E.uniqueValues.length>n&&(x=Number(E.uniqueValues[k[n]].toFixed(6)),
r.push({minValue:J,maxValue:x,label:I(J,x,m)}),J=x);r.push({minValue:J,maxValue:d,label:I(J,d,m)})}else if("quantile"===c)if(E.length>=f&&J!==d){k=Math.ceil(E.length/f);n=0;for(x=1;x<f;x++){var q=k+n-1;q>E.length&&(q=E.length-1);0>q&&(q=0);r.push({minValue:J,maxValue:E[q],label:I(J,E[q],m)});J=E[q];n+=k;k=Math.ceil((E.length-n)/(f-x))}r.push({minValue:J,maxValue:d,label:I(J,d,m)})}else for(f=-1,d=0;d<E.length;d++)J=E[d],J!==f&&(f=J,r.push({minValue:f,maxValue:J,label:I(f,J,m)}),f=J);else if("standard-deviation"===
c)if(k=N(E),n=B(E,k),0===n)r.push({minValue:E[0],maxValue:E[0],label:I(E[0],E[0],m)});else{E=H(J,d,f,k,n)*n;n=0;for(x=f;1<=x;x--)q=Number((k-(x-.5)*E).toFixed(6)),r.push({minValue:J,maxValue:q,label:I(J,q,m)}),J=q,n++;x=Number((k+.5*E).toFixed(6));r.push({minValue:J,maxValue:x,label:I(J,x,m)});J=x;n++;for(q=1;q<=f;q++)x=n===2*f?d:Number((k+(q+.5)*E).toFixed(6)),r.push({minValue:J,maxValue:x,label:I(J,x,m)}),J=x,n++}else if("defined-interval"===c){if(!h)return r;f=E[0];d=E[E.length-1];E=Math.ceil((d-
f)/h);J=f;for(k=1;k<E;k++)n=Number((f+k*h).toFixed(6)),r.push({minValue:J,maxValue:n,label:I(J,n,m)}),J=n;r.push({minValue:J,maxValue:d,label:I(J,d,m)})}return r}function I(k,f,c){let m=null;return m=k===f?c&&"percent-of-total"===c?k+"%":k.toString():c&&"percent-of-total"===c?k+"% - "+f+"%":k+" - "+f}function p(k){const f=[],c=[];let m=Number.MIN_VALUE,h=1,r=-1;for(let E=0;E<k.length;E++){const J=k[E];J===m?(h++,c[r]=h):null!==J&&(f.push(J),m=J,h=1,c.push(h),r++)}return{uniqueValues:f,valueFrequency:c}}
function R(k,f,c){var m=k.length;const h=[];c>m&&(c=m);for(var r=0;r<c;r++)h.push(Math.round(r*m/c-1));h.push(m-1);r=U(h,k,f,c);m=r.mean;r=r.sdcm;var E=c,J=0,d=0;let n=0,x=0,q=!0;for(let a=0;2>a&&q;a++){0===a&&(q=!1);for(var g=0;g<E-1;g++)for(;h[g+1]+1!==h[g+2];)if(h[g+1]+=1,J=l(g,h,k,f),n=J.sbMean,J=J.sbSdcm,d=l(g+1,h,k,f),x=d.sbMean,d=d.sbSdcm,J+d<r[g]+r[g+1])r[g]=J,r[g+1]=d,m[g]=n,m[g+1]=x,q=!0;else{--h[g+1];break}for(g=E-1;0<g;g--)for(;h[g]!==h[g-1]+1;)if(--h[g],J=l(g-1,h,k,f),n=J.sbMean,J=J.sbSdcm,
d=l(g,h,k,f),x=d.sbMean,d=d.sbSdcm,J+d<r[g-1]+r[g])r[g-1]=J,r[g]=d,m[g-1]=n,m[g]=x,q=!0;else{h[g]+=1;break}}q&&(r=U(h,k,f,c));return h}function U(k,f,c,m){let h=[];var r=[],E=[];let J=0;const d=[],n=[];for(var x=0;x<m;x++){var q=l(x,k,f,c);d.push(q.sbMean);n.push(q.sbSdcm);J+=n[x]}q=J;for(x=!0;x||J<q;){x=!1;h=[];for(r=0;r<m;r++)h.push(k[r]);for(E=0;E<m;E++)for(q=k[E]+1;q<=k[E+1];q++)if(r=f[q],0<E&&q!==k[E+1]&&Math.abs(r-d[E])>Math.abs(r-d[E-1]))k[E]=q;else if(E<m-1&&k[E]!==q-1&&Math.abs(r-d[E])>Math.abs(r-
d[E+1])){k[E+1]=q-1;break}q=J;J=0;r=[];E=[];for(let g=0;g<m;g++){r.push(d[g]);E.push(n[g]);const a=l(g,k,f,c);d[g]=a.sbMean;n[g]=a.sbSdcm;J+=n[g]}}if(J>q){for(f=0;f<m;f++)k[f]=h[f],d[f]=r[f],n[f]=E[f];J=q}return{mean:d,sdcm:n}}function H(k,f,c,m,h){k=Math.max(m-k,f-m)/h/c;return 1<=k?1:.5<=k?.5:.25}function N(k){let f=0;for(let c=0;c<k.length;c++)f+=k[c];return f/=k.length}function B(k,f){let c=0;for(let m=0;m<k.length;m++){const h=k[m];c+=(h-f)*(h-f)}c/=k.length;return Math.sqrt(c)}function l(k,
f,c,m){var h=0,r=0;for(var E=f[k]+1;E<=f[k+1];E++){const J=m[E];h+=c[E]*J;r+=J}0>=r&&b.warn("Exception in Natural Breaks calculation");h/=r;r=0;for(E=f[k]+1;E<=f[k+1];E++)r+=m[E]*(c[E]-h)**2;return{sbMean:h,sbSdcm:r}}const b=D.getLogger("esri.rest.support.generateRendererUtils");P.createGenerateRendererClassBreaks=function(k){const {normalizationTotal:f}=k;return{classBreaks:F(k),normalizationTotal:f}};P.createGenerateRendererUniqueValues=function(k){k=p(k);const f=[],c=k.uniqueValues.length;for(let m=
0;m<c;m++){const h=k.uniqueValues[m];f.push({value:h,count:k.valueFrequency[m],label:h.toString()})}return{uniqueValues:f}};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/RasterSymbolizer":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/colorUtils ../../core/JSONSupport ../../core/Logger ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass ../../layers/support/RasterInfo ../../layers/support/rasterFunctions/pixelUtils ../../layers/support/rasterFunctions/stretchUtils ../../layers/support/rasterFunctions/surfaceUtils ./colorRampUtils".split(" "),
function(P,D,F,I,p,R,U,H,N,B,l,b,k,f,c){function m(E,J){const {attributeTable:d,bandCount:n}=E;return R.isNone(d)||1<n||J&&null==d.fields.find(x=>x.name.toLowerCase()===J.toLowerCase())?!1:!0}function h(E){const {bandCount:J,colormap:d}=E;return R.isSome(d)&&0<d.length&&1===J}function r(E){return b.isValidPixelBlock(E)&&0!==E.validPixelCount}I=function(E){function J(n){return E.call(this,n)||this}P._inheritsLoose(J,E);var d=J.prototype;d.bind=function(){const {rendererJSON:n}=this;if(!n)return{success:!1};
this.lookup={rendererJSON:{}};let x;switch(n.type){case "uniqueValue":x=this._updateUVRenderer(n);break;case "rasterColormap":x=this._updateColormapRenderer(n);break;case "rasterStretch":x=this._updateStretchRenderer(n);break;case "classBreaks":x=this._updateClassBreaksRenderer(n);break;case "rasterShadedRelief":x=this._updateShadedReliefRenderer(n);break;case "vectorField":x=this._updateVectorFieldRenderer();break;case "flowRenderer":x=this._updateFlowRenderer()}return x};d.symbolize=function(n){let x=
n&&n.pixelBlock;if(!r(x))return x;if(n.simpleStretchParams&&"rasterStretch"===this.rendererJSON.type)return this.simpleStretch(x,n.simpleStretchParams);try{3<x.pixels.length&&(x=b.extractBands(x,[0,1,2]));let q;switch(this.rendererJSON.type){case "uniqueValue":case "rasterColormap":q=this._symbolizeColormap(x);break;case "classBreaks":q=this._symbolizeClassBreaks(x);break;case "rasterStretch":q=this._symbolizeStretch(x,n.bandIds);break;case "rasterShadedRelief":const g=n.extent;q=this._symbolizeShadedRelief(x,
{isGCS:g.spatialReference.isGeographic,resolution:{x:(g.xmax-g.xmin)/x.width,y:(g.ymax-g.ymin)/x.height}})}return q}catch(q){return p.getLogger(this.declaredClass).error("symbolize",q.message),x}};d.simpleStretch=function(n,x){if(!r(n))return n;try{return 3<n.pixels.length&&(n=b.extractBands(n,[0,1,2])),k.stretch(n,{...x,isRenderer:!0})}catch(q){return p.getLogger(this.declaredClass).error("symbolize",q.message),n}};d.generateWebGLParameters=function(n){if(["uniqueValue","rasterColormap","classBreaks"].includes(this.rendererJSON.type)){const {indexedColormap:e,
offset:t}=this.lookup.colormapLut||{};return{colormap:e,colormapOffset:t,type:"lut"}}const {pixelBlock:x,isGCS:q,resolution:g,bandIds:a}=n;({rendererJSON:n}=this);return"rasterStretch"===n.type?this._generateStretchWebGLParams(x,n,a):"rasterShadedRelief"===n.type?this._generateShadedReliefWebGLParams(n,q,g??void 0):"vectorField"===n.type?this._generateVectorFieldWebGLParams(n):null};d._isLUTChanged=function(n){if(!this.lookup||!this.lookup.rendererJSON)return!0;if("colorRamp"in this.rendererJSON){const x=
this.rendererJSON.colorRamp;if(n)return JSON.stringify(x)!==JSON.stringify(this.lookup.rendererJSON.colorRamp);({...this.rendererJSON});({...this.lookup.rendererJSON})}return JSON.stringify(this.rendererJSON)!==JSON.stringify(this.lookup.rendererJSON)};d._symbolizeColormap=function(n){return this._isLUTChanged()&&!this.bind().success?n:b.colorize(n,this.lookup.colormapLut)};d._symbolizeClassBreaks=function(n){const {canUseIndexedLUT:x}=this._analyzeClassBreaks(this.rendererJSON);return this._isLUTChanged()&&
!this.bind().success?n:x?b.colorize(n,this.lookup.colormapLut):b.remapColor(n,this.lookup.remapLut??[])};d._symbolizeStretch=function(n,x){const {rasterInfo:q}=this,{pixelType:g,bandCount:a}=q,e=this.rendererJSON;var t=["u8","u16","s8","s16"].includes(g);let v;var {dra:w}=e;({gamma:y}=this.lookup);if("histogramEqualization"===e.stretchType){t=w?null:this.lookup?.histogramLut;x=k.getStretchCutoff(e,{rasterInfo:q,pixelBlock:n,bandIds:x,returnHistogramLut:!t});var y=k.stretch(n,{...x,gamma:y,isRenderer:!0});
y=b.lookupPixels(y,{lut:w?x.histogramLut:t,offset:0})}else if(t){if(w)w=k.getStretchCutoff(e,{rasterInfo:q,pixelBlock:n,bandIds:x}),v=k.createStretchLUT({pixelType:g,...w,gamma:y,rounding:"floor"});else{if(this._isLUTChanged()&&!this.bind().success)return n;v=this.lookup?this.lookup.stretchLut:null}if(!v)return n;1<a&&x?.length===R.unwrap(n)?.pixels.length&&v?.lut.length===a&&(v={lut:x.map(G=>v.lut[G]),offset:v.offset});y=b.lookupPixels(n,v)}else w=k.getStretchCutoff(e,{rasterInfo:q,pixelBlock:n,
bandIds:x}),y=k.stretch(n,{...w,gamma:y,isRenderer:!0});if(e.colorRamp){if(this._isLUTChanged(!0)&&!this.bind().success)return n;y=b.colorize(y,this.lookup?.colormapLut)}return y};d._symbolizeShadedRelief=function(n,x){var q=this.rendererJSON;x=f.hillshade(n,{...q,...x});if(!q.colorRamp||this._isLUTChanged(!0)&&!this.bind().success)return x;q=this.lookup?this.lookup.hsvMap:null;if(!q)return x;const g=R.unwrap(this.rasterInfo.statistics)?.[0]??{min:0,max:8E3};f.tintHillshade(x,n,q,g);return x};d._isVectorFieldData=
function(){const {bandCount:n,dataType:x}=this.rasterInfo;return 2===n&&("vector-magdir"===x||"vector-uv"===x)};d._updateVectorFieldRenderer=function(){return this._isVectorFieldData()?{success:!0}:{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; VectorFieldRenderer only supports "vector-magdir" and "vector-uv".`}};d._updateFlowRenderer=function(){return this._isVectorFieldData()?{success:!0}:{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; FlowRenderer only supports "vector-magdir" and "vector-uv".`}};
d._updateUVRenderer=function(n){const {bandCount:x,attributeTable:q,pixelType:g}=this.rasterInfo,a=n.field1;if(!a)return{success:!1,error:"Unsupported renderer; missing UniqueValueRenderer.field."};const e=n.defaultSymbol;var t=1===x&&["u8","s8"].includes(g);if(!m(this.rasterInfo,a)&&!t)return{success:!1,error:"Unsupported data; UniqueValueRenderer is only supported on single band data with a valid raster attribute table."};const v=[];if(R.isSome(q)){const w=q.fields.find(y=>"value"===y.name.toLowerCase());
if(!w)return{success:!1,error:"Unsupported data; the data's raster attribute table does not have a value field."};q.features.forEach(y=>{const G=n.uniqueValueInfos?.find(C=>String(C.value)===String(y.attributes[a]))?.symbol?.color;G?v.push([y.attributes[w.name]].concat(G)):e&&v.push([y.attributes[w.name]].concat(e.color))})}else{if("value"!==a.toLowerCase())return{success:!1,error:'Unsupported renderer; UniqueValueRenderer.field must be "Value" when raster attribute table is not availalbe.'};n.uniqueValueInfos?.forEach(w=>
{const y=w?.symbol?.color;y?v.push([parseInt(""+w.value,10)].concat(y)):e&&v.push([parseInt(""+w.value,10)].concat(e?.color))})}if(0===v.length)return{success:!1,error:"Invalid UniqueValueRenderer. Cannot find matching records in the raster attribute table."};t=b.createColormapLUT({colormap:v});this.lookup={rendererJSON:n,colormapLut:t};this.canRenderInWebGL=!0;return{success:!0}};d._updateColormapRenderer=function(n){if(!h(this.rasterInfo))return{success:!1,error:"Unsupported data; the data source does not have a colormap."};
var x=n.colormapInfos.map(q=>[q.value].concat(q.color)).sort((q,g)=>q[0]-g[0]);if(!x||0===x.length)return{success:!1,error:"Unsupported renderer; ColormapRenderer must have meaningful colormapInfos."};x=b.createColormapLUT({colormap:x});this.lookup={rendererJSON:n,colormapLut:x};this.canRenderInWebGL=!0;return{success:!0}};d._updateShadedReliefRenderer=function(n){const {bandCount:x,dataType:q,pixelType:g}=this.rasterInfo;if("elevation"!==q&&("generic"!==q||1!==x||"s16"!==g&&"f32"!==g&&"f64"!==g))return{success:!1,
error:`Unsupported data type "${this.rasterInfo.dataType}"; ShadedReliefRenderer only supports "elevation", or single band float/s16 data.`};if(n.colorRamp){var a=c.convertColorRampToColormap(n.colorRamp,{interpolateAlpha:!0});a=b.createColormapLUT({colormap:a});const e=[],t=a.indexedColormap;for(let v=0;v<t.length;v+=4){const w=F.toHSV({r:t[v],g:t[v+1],b:t[v+2]});e.push([w.h/60,w.s/100,255*w.v/100])}this.lookup={rendererJSON:n,colormapLut:a,hsvMap:e}}else this.lookup=null;this.canRenderInWebGL=!0;
return{success:!0}};d._analyzeClassBreaks=function(n){const {attributeTable:x,pixelType:q}=this.rasterInfo,g=R.isSome(x)?x.fields.find(t=>"value"===t.name.toLowerCase()):null,a=R.isSome(x)?x.fields.find(t=>t.name.toLowerCase()===n.field.toLowerCase()):null,e=null!=g&&null!==a;return{canUseIndexedLUT:["u8","u16","s8","s16"].includes(q)||e,tableValueField:g,tableBreakField:a}};d._updateClassBreaksRenderer=function(n){var {attributeTable:x}=this.rasterInfo;const {canUseIndexedLUT:q,tableValueField:g,
tableBreakField:a}=this._analyzeClassBreaks(n);var e=n.classBreakInfos;if(!e?.length)return{success:!1,error:"Unsupported renderer; missing or invalid ClassBreaksRenderer.classBreakInfos."};e=e.sort((G,C)=>G.classMaxValue-C.classMaxValue);var t=e[e.length-1],v=n.minValue;if(!q){var w=[];for(var y=0;y<e.length;y++)w.push({value:e[y].classMinValue??v,mappedColor:e[y].symbol.color}),v=e[y].classMaxValue;w.push({value:t.classMaxValue,mappedColor:t.symbol.color});this.lookup={rendererJSON:n,remapLut:w};
this.canRenderInWebGL=!1;return{success:!0}}w=[];if(R.isSome(x)&&null!=g&&null!==a&&g!==a){t=g.name;const G=a.name,C=e[e.length-1],{classMaxValue:u}=C;v=n.minValue;for(y of x.features){x=y.attributes[t];const z=y.attributes[G],L=z===u?C:z<v?null:e.find(({classMaxValue:S})=>S>z);L&&w.push([x].concat(L.symbol.color))}}else{v=Math.floor(n.minValue);for(y=0;y<e.length;y++){for(x=e[y];v<x.classMaxValue;v++)w.push([v].concat(x.symbol.color));v=Math.ceil(x.classMaxValue)}t.classMaxValue===v&&w.push([t.classMaxValue].concat(t.symbol.color))}e=
b.createColormapLUT({colormap:w,fillUnspecified:!1});this.lookup={rendererJSON:n,colormapLut:e};this.canRenderInWebGL=!0;return{success:!0}};d._isHistogramRequired=function(n){return"percentClip"===n||"histogramEqualization"===n};d._isValidRasterStatistics=function(n){return R.isSome(n)&&0<n.length&&null!=n[0].min&&null!=n[0].max};d._updateStretchRenderer=function(n){let {stretchType:x,dra:q}=n;if(!("none"===x||n.statistics?.length||this._isValidRasterStatistics(this.rasterInfo.statistics)||q))return{success:!1,
error:"Unsupported renderer; StretchRenderer.statistics is required when dynamic range adjustment is not used."};var g=R.unwrap(n.histograms||this.rasterInfo.histograms);!this._isHistogramRequired(n.stretchType)||g?.length||q||(x="minMax");const {computeGamma:a,useGamma:e,colorRamp:t}=n;var {gamma:v}=n;e&&a&&!v?.length&&(v=n.statistics?.length?n.statistics:R.unwrap(this.rasterInfo.statistics),v=k.computeGammaValues(this.rasterInfo.pixelType,v));const w=this.rasterInfo.pixelType,y=!q&&["u8","u16",
"s8","s16"].includes(w);"histogramEqualization"===x?(g=g.map(G=>k.createHistogramEqualizationLUT(G)),this.lookup={rendererJSON:n,histogramLut:g}):y&&(g=k.getStretchCutoff(n,{rasterInfo:this.rasterInfo}),g=k.createStretchLUT({pixelType:w,...g,gamma:e?v:null,rounding:"floor"}),this.lookup={rendererJSON:n,stretchLut:g});t&&(g=c.convertColorRampToColormap(t,{interpolateAlpha:!0}),this.lookup||(this.lookup={rendererJSON:n}),this.lookup.colormapLut=b.createColormapLUT({colormap:g}),this.lookup.rendererJSON=
n);this.lookup.gamma=e&&v?.length?v:null;this.canRenderInWebGL=!0;return{success:!0}};d._generateStretchWebGLParams=function(n,x,q){let g=null,a=null;var e=this.lookup&&this.lookup.colormapLut;x.colorRamp&&e&&(g=e.indexedColormap,a=e.offset);"histogramEqualization"===x.stretchType&&(x={...x,stretchType:"minMax"});({gamma:e}=this.lookup);const t=!!(x.useGamma&&e&&e.some(L=>1!==L)),{minCutOff:v,maxCutOff:w,outMin:y,outMax:G}=k.getStretchCutoff(x,{rasterInfo:this.rasterInfo,pixelBlock:n,bandIds:q});
var C=0;R.isSome(n)&&(C=n.getPlaneCount(),2===C&&(n=n.clone(),n.statistics=[n.statistics[0]],n.pixels=[n.pixels[0]]));({bandCount:n}=this.rasterInfo);q=Math.min(3,q?.length||C||n,n);n=new Float32Array(q);C=g||t?1:255;let u;for(u=0;u<v.length;u++)n[u]=w[u]===v[u]?0:(G-y)/(w[u]-v[u])/C;const z=new Float32Array(q);if(t&&e)for(u=0;u<q;u++)z[u]=1<e[u]?2<e[u]?6.5+(e[u]-2)**2.5:6.5+100*(2-e[u])**4:1;return{bandCount:q,outMin:y/C,outMax:G/C,minCutOff:v,maxCutOff:w,factor:n,useGamma:t,gamma:t?e:[1,1,1],gammaCorrection:t?
z:[1,1,1],colormap:g,colormapOffset:a,stretchType:x.stretchType,type:"stretch"}};d._generateShadedReliefWebGLParams=function(n,x=!1,q={x:0,y:0}){let g=null,a=null;const e=this.lookup&&this.lookup.colormapLut;n.colorRamp&&e&&(g=e.indexedColormap,a=e.offset);x=f.calculateHillshadeParams({...n,isGCS:x,resolution:q});q=R.unwrap(this.rasterInfo.statistics)?.[0];return{...x,minValue:q?.min??0,maxValue:q?.max??8E3,hillshadeType:"traditional"===n.hillshadeType?0:1,type:"hillshade",colormap:g,colormapOffset:a}};
d._generateVectorFieldWebGLParams=function(n){const {style:x,inputUnit:q,outputUnit:g,visualVariables:a,symbolTileSize:e,flowRepresentation:t}=n;let v;var w=this.rasterInfo.statistics?.[0].min??0,y=this.rasterInfo.statistics?.[0].max??50,G=a?.find(z=>"sizeInfo"===z.type)??{type:"sizeInfo",field:"Magnitude",maxDataValue:y,maxSize:.8*e,minDataValue:w,minSize:.2*e},C=G.minDataValue??w,u=G.maxDataValue??y;y=R.isSome(G.maxSize)&&R.isSome(G.minSize)?[G.minSize/e,G.maxSize/e]:[.2,.8];"wind_speed"===x&&(y[0]=
y[1]=(y[0]+y[1])/2);w=R.isSome(C)&&R.isSome(u)?[C,u]:null;if("classified_arrow"===x)if(R.isSome(C)&&R.isSome(u)&&R.isSome(G))for(v=[],C=(G.maxDataValue-G.minDataValue)/5,u=0;6>u;u++)v.push(G.minDataValue+C*u);else v=[0,1E-6,3.5,7,10.5,14];G="flow_to"===t===("ocean_current_kn"===x||"ocean_current_m"===x)?0:Math.PI;C=a?.find(z=>"rotationInfo"===z.type);return{breakValues:v,dataRange:w,inputUnit:q,outputUnit:g,symbolTileSize:e,symbolPercentRange:y,style:x||"single_arrow",rotation:G,rotationType:this.rasterInfo.storageInfo?.tileInfo&&
"vector-uv"===this.rasterInfo.dataType?"geographic":C?.rotationType||n.rotationType,type:"vectorField"}};return J}(I.JSONSupport);D.__decorate([U.property({json:{write:!0}})],I.prototype,"rendererJSON",void 0);D.__decorate([U.property({type:l,json:{write:!0}})],I.prototype,"rasterInfo",void 0);D.__decorate([U.property({json:{write:!0}})],I.prototype,"lookup",void 0);D.__decorate([U.property()],I.prototype,"canRenderInWebGL",void 0);return I=D.__decorate([B.subclass("esri.renderers.support.RasterSymbolizer")],
I)})},"esri/views/2d/engine/flow/dataUtils":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../geometry ../../../../core/has ../../../../core/Logger ../../../../core/mathUtils ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/RandomLCG ../../../../geometry/support/spatialReferenceUtils ../../../../geometry/Extent".split(" "),function(P,D,F,I,p,R,U,H,N,B,l){function b(){b=D._asyncToGenerator(function*(g,a,e,t){const v=performance.now();var w=k(a,
e);const y=performance.now();e=c(a,w,e.width,e.height);a=performance.now();w=h(e,!0);e=performance.now();g="Streamlines"===g?r(w,10):E(w);w=performance.now();I("esri-2d-profiler")&&(q.info("I.1","_createFlowFieldFromData (ms)",Math.round(y-v)),q.info("I.2","_getStreamlines (ms)",Math.round(a-y)),q.info("I.3","createAnimatedLinesData (ms)",Math.round(e-a)),q.info("I.4","create{Streamlines|Particles}Mesh (ms)",Math.round(w-e)),q.info("I.5","createFlowMesh (ms)",Math.round(w-v)),q.info("I.6","Mesh size (bytes)",
g.vertexData.buffer.byteLength+g.indexData.buffer.byteLength));yield Promise.resolve();H.throwIfAborted(t);return g});return b.apply(this,arguments)}function k(g,a){const e=m(a.data,a.width,a.height,g.smoothing);return g.interpolate?(t,v)=>{const w=Math.floor(t),y=Math.floor(v);if(0>w||w>=a.width||0>y||y>=a.height)return[0,0];t-=w;v-=y;const G=w<a.width-1?w+1:w,C=y<a.height-1?y+1:y;return[(e[2*(y*a.width+w)]*(1-v)+e[2*(C*a.width+w)]*v)*(1-t)+(e[2*(y*a.width+G)]*(1-v)+e[2*(C*a.width+G)]*v)*t,(e[2*
(y*a.width+w)+1]*(1-v)+e[2*(C*a.width+w)+1]*v)*(1-t)+(e[2*(y*a.width+G)+1]*(1-v)+e[2*(C*a.width+G)+1]*v)*t]}:(t,v)=>{t=Math.round(t);v=Math.round(v);return 0>t||t>=a.width||0>v||v>=a.height?[0,0]:[e[2*(v*a.width+t)],e[2*(v*a.width+t)+1]]}}function f(g,a,e,t,v,w,y,G,C){const u=[];let z=0,[L,S]=a(e,t);L*=g.velocityScale;S*=g.velocityScale;u.push({x:e,y:t,t:z,speed:Math.sqrt(L*L+S*S)});for(let M=0;M<g.verticesPerLine;M++){let [O,A]=a(e,t);O*=g.velocityScale;A*=g.velocityScale;const Q=Math.sqrt(O*O+A*
A);if(Q<g.minSpeedThreshold)break;const Y=O/Q,W=A/Q;e+=Y*g.segmentLength;t+=W*g.segmentLength;z+=g.segmentLength/Q;if(Math.acos(Y*Z+W*X)>g.maxTurnAngle)break;if(g.collisions){var Z=Math.round(e*C);var X=Math.round(t*C);if(0>Z||Z>y-1||0>X||X>G-1)break;const T=w[X*y+Z];if(-1!==T&&T!==v)break;w[X*y+Z]=v}u.push({x:e,y:t,t:z,speed:Q});Z=Y;X=W}return u}function c(g,a,e,t){const v=[],w=new N,y=1/Math.max(g.lineCollisionWidth,1),G=Math.round(e*y),C=Math.round(t*y),u=new Int32Array(G*C);for(var z=0;z<u.length;z++)u[z]=
-1;z=[];for(let L=0;L<t;L+=g.lineSpacing)for(let S=0;S<e;S+=g.lineSpacing)z.push({x:S,y:L,sort:w.getFloat()});z.sort((L,S)=>L.sort-S.sort);for(const {x:L,y:S}of z)w.getFloat()<g.density&&(e=f(g,a,L,S,v.length,u,G,C,y),2>e.length||v.push(e));return v}function m(g,a,e,t){if(0===t)return g;const v=Math.round(3*t),w=Array(2*v+1);var y=0;for(var G=-v;G<=v;G++){var C=Math.exp(-G*G/(t*t));w[G+v]=C;y+=C}for(t=-v;t<=v;t++)w[t+v]/=y;y=new Float32Array(g.length);for(t=0;t<e;t++)for(G=0;G<a;G++){var u=C=0;for(var z=
-v;z<=v;z++)if(!(0>G+z||G+z>=a)){var L=w[z+v];C+=L*g[2*(t*a+(G+z))];u+=L*g[2*(t*a+(G+z))+1]}y[2*(t*a+G)]=C;y[2*(t*a+G)+1]=u}g=new Float32Array(g.length);for(t=0;t<a;t++)for(G=0;G<e;G++){u=C=0;for(z=-v;z<=v;z++)0>G+z||G+z>=e||(L=w[z+v],C+=L*y[2*((G+z)*a+t)],u+=L*y[2*((G+z)*a+t)+1]);g[2*(G*a+t)]=C;g[2*(G*a+t)+1]=u}return g}function h(g,a){const e=new N;var t=g.reduce((G,C)=>G+C.length,0);t=new Float32Array(4*t);const v=Array(g.length);let w=0,y=0;for(const G of g){g=w;for(const C of G)t[4*w]=C.x,t[4*
w+1]=C.y,t[4*w+2]=C.t,t[4*w+3]=C.speed,w++;v[y++]={startVertex:g,numberOfVertices:G.length,totalTime:G[G.length-1].t,timeSeed:a?e.getFloat():0}}return{lineVertices:t,lineDescriptors:v}}function r(g,a){function e(Z,X,M,O,A,Q,Y,W){const T=9*C;let K=0;G[T+K++]=Z;G[T+K++]=X;G[T+K++]=1;G[T+K++]=M;G[T+K++]=Q;G[T+K++]=Y;G[T+K++]=O/2;G[T+K++]=A/2;G[T+K++]=W;C++;G[T+K++]=Z;G[T+K++]=X;G[T+K++]=-1;G[T+K++]=M;G[T+K++]=Q;G[T+K++]=Y;G[T+K++]=-O/2;G[T+K++]=-A/2;G[T+K++]=W;C++}const {lineVertices:t,lineDescriptors:v}=
g;var w=g=0;for(var y of v)g+=2*y.numberOfVertices,w+=6*(y.numberOfVertices-1);const G=new Float32Array(9*g);y=new Uint32Array(w);let C=0;g=0;for(const Z of v){const {totalTime:X,timeSeed:M}=Z;let O=w=null,A=null;var u=null,z=null,L=null;for(let Q=0;Q<Z.numberOfVertices;Q++){u=t[4*(Z.startVertex+Q)];const Y=t[4*(Z.startVertex+Q)+1],W=t[4*(Z.startVertex+Q)+2],T=t[4*(Z.startVertex+Q)+3];let K=null,V=null;var S=null;let ba=null;0<Q&&(K=u-w,V=Y-O,S=Math.sqrt(K*K+V*V),K/=S,V/=S,1<Q?(z=K+z,L=V+L,S=Math.sqrt(z*
z+L*L),z/=S,L/=S,S=Math.min(1/(z*K+L*V),a),z*=S,L*=S,S=-L,ba=z):(S=-V,ba=K),null!==S&&null!==ba&&(e(w,O,A,S,ba,X,M,T),y[g++]=C-2,y[g++]=C,y[g++]=C-1,y[g++]=C,y[g++]=C+1,y[g++]=C-1));w=u;O=Y;A=W;z=K;L=V;u=T}e(w,O,A,-L,z,X,M,u)}return{vertexData:G,indexData:y}}function E(g){function a(ea,ja){var ha=W+K,ma=T+V,na=Math.sqrt(ha*ha+ma*ma);ha/=na;ma/=na;var qa=W*ha+T*ma,ra=K+ba,pa=V+aa;na=Math.sqrt(ra*ra+pa*pa);ra/=na;pa/=na;var oa=K*ra+V*pa;na=S;var sa=Z,va=X,ta=M;ma=-(ma/qa);ha/=qa;qa=O;var xa=A,ca=Q,
ia=Y;pa=-(pa/oa);ra/=oa;oa=16*z;let da=0;for(const ka of[1,2])for(const la of[1,2,3,4])C[oa+da++]=na,C[oa+da++]=sa,C[oa+da++]=va,C[oa+da++]=ta,C[oa+da++]=qa,C[oa+da++]=xa,C[oa+da++]=ca,C[oa+da++]=ia,C[oa+da++]=ka,C[oa+da++]=la,C[oa+da++]=ea,C[oa+da++]=ja,C[oa+da++]=ma/2,C[oa+da++]=ha/2,C[oa+da++]=pa/2,C[oa+da++]=ra/2,z++;u[L++]=z-8;u[L++]=z-7;u[L++]=z-6;u[L++]=z-7;u[L++]=z-5;u[L++]=z-6;u[L++]=z-4;u[L++]=z-3;u[L++]=z-2;u[L++]=z-3;u[L++]=z-1;u[L++]=z-2}function e(ea,ja,ha,ma,na,qa){W=K;T=V;K=ba;V=aa;
null==W&&null==T&&(W=K,T=V);if(null!=O&&null!=A){ba=ea-O;aa=ja-A;const ra=Math.sqrt(ba*ba+aa*aa);ba/=ra;aa/=ra}null!=W&&null!=T&&a(na,qa);S=O;Z=A;X=Q;M=Y;O=ea;A=ja;Q=ha;Y=ma}function t(ea,ja){W=K;T=V;K=ba;V=aa;null==W&&null==T&&(W=K,T=V);null!=W&&null!=T&&a(ea,ja)}const {lineVertices:v,lineDescriptors:w}=g;let y=g=0;for(var G of w){const ea=G.numberOfVertices-1;g+=8*ea;y+=12*ea}const C=new Float32Array(16*g),u=new Uint32Array(y);let z=0,L=0,S,Z,X,M,O,A,Q,Y,W,T,K,V,ba,aa;for(const ea of w){aa=ba=V=
K=T=W=Y=Q=A=O=M=X=Z=S=null;const {totalTime:ja,timeSeed:ha}=ea;for(G=0;G<ea.numberOfVertices;G++)e(v[4*(ea.startVertex+G)],v[4*(ea.startVertex+G)+1],v[4*(ea.startVertex+G)+2],v[4*(ea.startVertex+G)+3],ja,ha);t(ja,ha)}return{vertexData:C,indexData:u}}function J(g,a){const e=a.pixels,{width:t,height:v}=a,w=new Float32Array(t*v*2),y=a.mask||new Uint8Array(t*v*2);a.mask||y.fill(255);if("vector-uv"===g)for(g=0;g<t*v;g++)w[2*g]=e[0][g],w[2*g+1]=-e[1][g];else if("vector-magdir"===g)for(g=0;g<t*v;g++){a=
e[0][g];const G=R.deg2rad(e[1][g]),C=Math.sin(G-Math.PI/2);w[2*g]=Math.cos(G-Math.PI/2)*a;w[2*g+1]=C*a}return{data:w,mask:y,width:t,height:v}}function d(){d=D._asyncToGenerator(function*(g,a,e,t,v,w){const y=performance.now();var G=B.getInfo(a.spatialReference);if(!G)return e=yield n(g,a,e,t,v,w),I("esri-2d-profiler")&&q.info("I.7","loadImagery, early exit (ms)",Math.round(performance.now()-y)),I("esri-2d-profiler")&&q.info("I.9","Number of parts",1),e;const [C,u]=G.valid,z=Math.ceil(a.width/(u-C)),
L=a.width/z,S=Math.round(e/z);let Z=a.xmin;const X=[];G=performance.now();for(let M=0;M<z;M++){const O=new l({xmin:Z,xmax:Z+L,ymin:a.ymin,ymax:a.ymax,spatialReference:a.spatialReference});X.push(n(g,O,S,t,v,w));Z+=L}g=yield Promise.all(X);I("esri-2d-profiler")&&q.info("I.8","All calls to _fetchPart (ms)",Math.round(performance.now()-G));I("esri-2d-profiler")&&q.info("I.9","Number of parts",g.length);t={data:new Float32Array(e*t*2),mask:new Uint8Array(e*t),width:e,height:t};a=0;for(const M of g){for(g=
0;g<M.height;g++)for(v=0;v<M.width;v++)a+v>=e||(t.data[2*(g*e+a+v)]=M.data[2*(g*M.width+v)],t.data[2*(g*e+a+v)+1]=M.data[2*(g*M.width+v)+1],t.mask[g*e+a+v]=M.mask[g*M.width+v]);a+=M.width}I("esri-2d-profiler")&&q.info("I.10","loadImagery, general exit (ms)",Math.round(performance.now()-y));return t});return d.apply(this,arguments)}function n(g,a,e,t,v,w){return x.apply(this,arguments)}function x(){x=D._asyncToGenerator(function*(g,a,e,t,v,w){const y={requestProjectedLocalDirections:!0,signal:w};U.isSome(v)&&
(y.timeExtent=v);if("imagery"===g.type)return yield g.load({signal:w}),v=g.rasterInfo.dataType,g=yield g.fetchImage(a,e,t,y),!g||U.isNone(g.pixelData)||U.isNone(g.pixelData.pixelBlock)?{data:new Float32Array(e*t*2),mask:new Uint8Array(e*t),width:e,height:t}:J(v,g.pixelData.pixelBlock);yield g.load({signal:w});v=g.rasterInfo.dataType;g=yield g.fetchPixels(a,e,t,y);return!g||U.isNone(g.pixelBlock)?{data:new Float32Array(e*t*2),mask:new Uint8Array(e*t),width:e,height:t}:J(v,g.pixelBlock)});return x.apply(this,
arguments)}const q=p.getLogger("esri.views.2d.engine.flow.dataUtils");P.createAnimatedLinesData=h;P.createFlowMesh=function(g,a,e,t){return b.apply(this,arguments)};P.createParticlesMesh=E;P.createStreamlinesMesh=r;P.loadImagery=function(g,a,e,t,v,w){return d.apply(this,arguments)};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterEnums":function(){define(["exports","../../core/jsonMap"],function(P,D){const F=D.strict()({RSP_NearestNeighbor:"nearest",RSP_BilinearInterpolation:"bilinear",
RSP_CubicConvolution:"cubic",RSP_Majority:"majority"});D=D.strict()({esriNoDataMatchAny:"any",esriNoDataMatchAll:"all"});P.interpolationKebab=F;P.noDataInterpretationKebab=D;Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/RasterFactory":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../core/Error ./CloudRaster ./ImageAuxRaster ./ImageServerRaster ./MRFRaster ./TIFFRaster".split(" "),function(P,D,F,I,p,R,U){const H=new Map;H.set("CRF",
{desc:"Cloud Raster Format",constructor:F});H.set("MRF",{desc:"Meta Raster Format",constructor:R});H.set("TIFF",{desc:"GeoTIFF",constructor:U});H.set("RasterTileServer",{desc:"Raster Tile Server",constructor:p});H.set("JPG",{desc:"JPG Raster Format",constructor:I});H.set("PNG",{desc:"PNG Raster Format",constructor:I});H.set("GIF",{desc:"GIF Raster Format",constructor:I});H.set("BMP",{desc:"BMP Raster Format",constructor:I});return function(){function N(){}N.open=function(){var B=P._asyncToGenerator(function*(l){const {url:b,
ioConfig:k,sourceJSON:f}=l;let c=l.datasetFormat;null==c&&b.lastIndexOf(".")&&(c=b.slice(b.lastIndexOf(".")+1).toUpperCase());if("OVR"===c||"TIF"===c)c="TIFF";else if("JPG"===c||"JPEG"===c||"JFIF"===c)c="JPG";b.toLowerCase().includes("/imageserver")&&!b.toLowerCase().includes("/wcsserver")&&(c="RasterTileServer");const m={bandIds:null,sampling:null},h={url:b,sourceJSON:f,datasetFormat:c,ioConfig:k??m};let r,E;if(c&&this.supportedFormats.has(c)){if("CRF"===c&&!k?.enableCRF)throw new D("rasterfactory:open",
`cannot open raster: ${b}`);r=H.get(c).constructor;E=new r(h);yield E.open({signal:l.signal});return E}if(c)throw new D("rasterfactory:open","not a supported format "+c);const J=Array.from(H.keys());let d=0;const n=()=>{c=J[d++];if(!c||"CRF"===c&&!k?.enableCRF)return null;r=H.get(c).constructor;E=new r(h);return E.open({signal:l.signal}).then(()=>E).catch(()=>n())};return n()});return function(l){return B.apply(this,arguments)}}();N.register=function(B,l,b){H.has(B.toUpperCase())||H.set(B.toUpperCase(),
{desc:l,constructor:b})};P._createClass(N,null,[{key:"supportedFormats",get:function(){const B=new Set;H.forEach((l,b)=>B.add(b));return B}}]);return N}()})},"esri/layers/support/rasterDatasets/CloudRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ../LOD ../RasterInfo ../RasterStorageInfo ../TileInfo ./BaseRaster ./DBFParser ../rasterTransforms/utils ../../../rest/support/FeatureSet ../../../geometry/SpatialReference ../../../geometry/Extent ../../../geometry/Point".split(" "),
function(P,D,F,I,p,R,U,H,N,B,l,b,k,f,c,m,h,r,E,J){const d=new Map;d.set("int16","esriFieldTypeSmallInteger");d.set("int32","esriFieldTypeInteger");d.set("int64","esriFieldTypeInteger");d.set("float32","esriFieldTypeSingle");d.set("float64","esriFieldTypeDouble");d.set("text","esriFieldTypeString");F=function(n){function x(){var g=n.apply(this,arguments)||this;g.storageInfo=null;g.datasetFormat="CRF";return g}P._inheritsLoose(x,n);var q=x.prototype;q.open=function(){var g=P._asyncToGenerator(function*(a){yield this.init();
({data:a}=yield this.request(this.url+"/conf.json",{signal:a?.signal}));if(!this._validateHeader(a))throw new I("cloudraster:open","Invalid or unsupported conf.json.");this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1);const {storageInfo:e,rasterInfo:t}=this._parseHeader(a);"thematic"===t.dataType&&(a=yield this._fetchAuxiliaryInformation(),t.attributeTable=a);this._set("storageInfo",e);this._set("rasterInfo",t);this.ioConfig.retryCount=this.ioConfig.retryCount||0});return function(a){return g.apply(this,
arguments)}}();q.fetchRawTile=function(){var g=P._asyncToGenerator(function*(a,e,t,v={}){var {transposeInfo:w}=this.rasterInfo.storageInfo,{transposedVariableName:y}=v;a=(w=!(!w||!y))?0:this.rasterInfo.storageInfo.maximumPyramidLevel-a;if(0>a)return null;y=this._buildCacheFilePath(a,e,t,v.multidimensionalDefinition,y);e=this._getIndexRecordFromBundle(e,t,w);t=yield this.request(y,{range:{from:0,to:this.storageInfo.headerSize-1},responseType:"array-buffer",signal:v.signal});if(!t)return null;t=new Uint8Array(t.data);
e=this._getTileEndAndContentType(t,e);if(0===e.recordSize)return null;v=yield this.request(y,{range:{from:e.position,to:e.position+e.recordSize},responseType:"array-buffer",signal:v.signal});if(!v)return null;const [G,C]=this._getTileSize(w);return this.decodePixelBlock(v.data,{width:G,height:C,planes:null,pixelType:null,returnInterleaved:w})});return function(a,e,t){return g.apply(this,arguments)}}();q._validateHeader=function(g){const a="origin extent geodataXform LODInfos blockWidth blockHeight bandCount pixelType pixelSizeX pixelSizeY format packetSize".split(" ");
return g&&"RasterInfo"===g.type&&!a.some(e=>!g[e])};q._parseHeader=function(g){var a="u1 u2 u4 u8 s8 u16 s16 u32 s32 f32 f64".split(" ")[g.pixelType];const {bandCount:e,histograms:t,colormap:v,blockWidth:w,blockHeight:y,firstPyramidLevel:G,maximumPyramidLevel:C}=g,u=g.statistics&&g.statistics.map(aa=>({min:aa.min,max:aa.max,avg:aa.mean,stddev:aa.standardDeviation,median:aa.median,mode:aa.mode}));var z=g.extent.spatialReference,L=g.geodataXform?.spatialReference;z=new r(z?.wkid||z?.wkt?z:L);L=new E({xmin:g.extent.xmin,
ymin:g.extent.ymin,xmax:g.extent.xmax,ymax:g.extent.ymax,spatialReference:z});const S=new J({x:g.pixelSizeX,y:g.pixelSizeY,spatialReference:z}),Z=Math.round((L.xmax-L.xmin)/S.x),X=Math.round((L.ymax-L.ymin)/S.y),M=this._parseTransform(g.geodataXform),O=M?L:null;M&&(L=M.forwardTransform(L),S.x=(L.xmax-L.xmin)/Z,S.y=(L.ymax-L.ymin)/X);const A=g.properties??{};var Q=g.format.toLowerCase().replace("cache/","");const Y=new J(g.origin.x,g.origin.y,z);let W;var T;if(v&&v.colors)for(W=[],T=0;T<v.colors.length;T++){var K=
v.colors[T];var V=v.values?v.values[T]:T;W.push([V,K&255,K<<16>>>24,K<<8>>>24,K>>>24])}K=g.LODInfos;V=[];for(T=0;T<K.levels.length;T++)V.push(new B({level:K.levels[T],resolution:K.resolutions[T],scale:96/.0254*K.resolutions[T]}));K=new k({dpi:96,lods:V,format:Q,origin:Y,size:[w,y],spatialReference:z});Q={recordSize:8,packetSize:g.packetSize,headerSize:g.packetSize*g.packetSize*8+64};V=[{maxCol:Math.ceil(Z/w)-1,maxRow:Math.ceil(X/y)-1,minCol:0,minRow:0}];let ba=2;if(0<C)for(T=0;T<C;T++)V.push({maxCol:Math.ceil(Z/
ba/w)-1,maxRow:Math.ceil(X/ba/y)-1,minCol:0,minRow:0}),ba*=2;g=g.mdInfo;T=null;g&&A._yxs&&(T=A._yxs,T={packetSize:T.PacketSize,tileSize:[T.TileXSize,T.TileYSize]});a=new l({width:Z,height:X,pixelType:a,bandCount:e,extent:L,nativeExtent:O,transform:M,spatialReference:z,pixelSize:S,keyProperties:A,statistics:u,histograms:t,multidimensionalInfo:g,colormap:W,storageInfo:new b({blockWidth:w,blockHeight:y,pyramidBlockWidth:w,pyramidBlockHeight:y,origin:Y,tileInfo:K,transposeInfo:T,firstPyramidLevel:G,maximumPyramidLevel:C,
blockBoundary:V})});return{storageInfo:Q,rasterInfo:a}};q._parseTransform=function(g){if(!m.isTransformSupported(g))throw new I("cloudraster:open","the data contains unsupported geodata transform types");g=m.readTransform(g);if("identity"===g.type)return null;if("polynomial"!==g.type||!g.forwardCoefficients?.length||!g.inverseCoefficients?.length)throw new I("cloudraster:open","the data contains unsupported geodata transforms - both forward and inverse coefficients are required currently");return g};
q._fetchAuxiliaryInformation=function(){var g=P._asyncToGenerator(function*(a){var e=this.request(this.url+"/conf.vat.json",{signal:a}).then(v=>v.data).catch(()=>null);a=this.request(this.url+"/conf.vat.dbf",{responseType:"array-buffer",signal:a}).then(v=>v.data).catch(()=>null);e=yield Promise.all([e,a]);let t;if(e[0]){a=e[0].fields;const v=e[0].values;if(a&&v){a=a.map(y=>({type:"OID"===y.name?"esriFieldTypeOID":d.get(y.type),name:y.name,alias:y.alias||y.name}));const w=v.map(y=>({attributes:y}));
a&&v&&(t={fields:a,features:w})}}!t&&e[1]&&(t=c.parse(e[1]).recordSet);return h.fromJSON(t)});return function(a){return g.apply(this,arguments)}}();q._buildCacheFilePath=function(g,a,e,t,v){var w=this._getPackageSize(!!v);e=Math.floor(e/w)*w;a="R"+this._toHexString4(Math.floor(a/w)*w)+"C"+this._toHexString4(e);w="L";w=10<=g?w+g.toString():w+("0"+g.toString());({multidimensionalInfo:g}=this.rasterInfo);const y=t?.[0];if(p.isNone(g)||!y)return`${this.url}/_alllayers/${w}/${a}.bundle`;t="_yxs";if(!v){t=
g.variables.find(G=>G.name===y.variableName).dimensions[0].values.indexOf(y.values[0]).toString(16);g=4-t.length;for(e=0;e<g;e++)t="0"+t;t="S"+t}v=this._getVariableFolderName(v||y.variableName);return`${this.url}/_alllayers/${v}/${t}/${w}/${a}.bundle`};q._getPackageSize=function(g=!1){const {transposeInfo:a}=this.rasterInfo.storageInfo;return g&&p.isSome(a)?a.packetSize??0:this.storageInfo.packetSize};q._getTileSize=function(g=!1){const {storageInfo:a}=this.rasterInfo,{transposeInfo:e}=a;return g&&
p.isSome(e)?e.tileSize:a.tileInfo.size};q._getVariableFolderName=function(g){g=g.trim();return""===g?"_v":g.replace(/[\{|\}\-]/g,"_").replace("\\*","_v")};q._getIndexRecordFromBundle=function(g,a,e=!1){e=this._getPackageSize(e);g=g%e*e+a%e;if(0>g)throw Error("Invalid level / row / col");return g*this.storageInfo.recordSize+64};q._getTileEndAndContentType=function(g,a){g=g.subarray(a,a+8);a=0;let e;for(e=0;5>e;e++)a|=(g[e]&255)<<8*e;const t=a&0xffffffffff;a=0;for(e=5;8>e;e++)a|=(g[e]&255)<<8*(e-5);
return{position:t,recordSize:a&0xffffffffff}};q._toHexString4=function(g){g=g.toString(16);if(4!==g.length){let a=4-g.length;for(;0<a--;)g="0"+g}return g};return x}(f);D.__decorate([R.property({readOnly:!0})],F.prototype,"storageInfo",void 0);D.__decorate([R.property({type:String,json:{write:!0}})],F.prototype,"datasetFormat",void 0);return F=D.__decorate([N.subclass("esri.layers.support.rasterDatasets.CloudRaster")],F)})},"esri/layers/support/rasterDatasets/DBFParser":function(){define(["../../../chunks/_rollupPluginBabelHelpers",
"./byteStreamUtils"],function(P,D){function F(I){var p=I.fields;I=I.records;const R=p.some(l=>"oid"===l.name.toLowerCase())?"OBJECTID":"OID";p=[{name:R,type:"esriFieldTypeOID",alias:"OID"}].concat(p.map(l=>({name:l.name,type:"esriFieldType"+l.typeName,alias:l.name})));const U=p.map(l=>l.name),H=[];let N=0,B=0;I.forEach(l=>{const b={};b[R]=N++;for(B=1;B<U.length;B++)b[U[B]]=l[B-1];H.push({attributes:b})});return{displayFieldName:"",fields:p,features:H}}return function(){function I(){}I.parse=function(p){var R=
new DataView(p),U=R.getUint8(0)&3;if(3!==U)return{header:{version:U},recordSet:null};const H=R.getUint32(4,!0);var N=R.getUint16(8,!0);const B=R.getUint16(10,!0);N={version:U,recordCount:H,headerByteCount:N,recordByteCount:B};let l=32;const b=[],k=[];if(3===U){for(;13!==R.getUint8(l);)U=String.fromCharCode(R.getUint8(l+11)).trim(),b.push({name:D.bytesToUTF8(new Uint8Array(p,l,11)),type:U,typeName:"String Date Double Boolean String Integer".split(" ")["CDFLMN".split("").indexOf(U)],length:R.getUint8(l+
16)}),l+=32;l+=1;if(0<b.length)for(;k.length<H&&p.byteLength-l>B;){const f=[];32===R.getUint8(l)?(l+=1,b.forEach(c=>{if("C"===c.type)f.push(D.bytesToUTF8(new Uint8Array(p,l,c.length)).trim());else if("N"===c.type)f.push(parseInt(String.fromCharCode.apply(null,new Uint8Array(p,l,c.length)).trim(),10));else if("F"===c.type)f.push(parseFloat(String.fromCharCode.apply(null,new Uint8Array(p,l,c.length)).trim()));else if("D"===c.type){const m=String.fromCharCode.apply(null,new Uint8Array(p,l,c.length)).trim();
f.push(new Date(parseInt(m.substring(0,4),10),parseInt(m.substring(4,6),10)-1,parseInt(m.substring(6,8),10)))}l+=c.length}),k.push(f)):l+=B}}R=F({fields:b,records:k});return{header:N,fields:b,records:k,recordSet:R}};P._createClass(I,null,[{key:"supportedVersions",get:function(){return[5]}}]);return I}()})},"esri/layers/support/rasterTransforms/utils":function(){define(["exports","./GCSShiftTransform","./IdentityTransform","./PolynomialTransform"],function(P,D,F,I){const p={GCSShiftXform:D,IdentityXform:F,
PolynomialXform:I},R=Object.keys(p);P.isTransformSupported=function(U){return!U||R.includes(U?.type)};P.readTransform=function(U){if(!U?.type)return null;var H=p[U?.type];return H?(H=new H,H.read(U),H):null};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterTransforms/GCSShiftTransform":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseRasterTransform".split(" "),
function(P,D,F,I,p,R,U,H){I=function(N){function B(){var b=N.apply(this,arguments)||this;b.type="gcs-shift";b.tolerance=1E-8;return b}P._inheritsLoose(B,N);var l=B.prototype;l.forwardTransform=function(b){b=b.clone();if("point"===b.type)return b.x>180+this.tolerance&&(b.x-=360),b;b.xmin>=180-this.tolerance?(b.xmax-=360,b.xmin-=360):b.xmax>180+this.tolerance&&(b.xmin=-180,b.xmax=180);return b};l.inverseTransform=function(b){b=b.clone();if("point"===b.type)return b.x<-this.tolerance&&(b.x+=360),b;b.xmin<
-this.tolerance&&(b.xmin+=360,b.xmax+=360);return b};return B}(H);D.__decorate([R.enumeration({GCSShiftXform:"gcs-shift"})],I.prototype,"type",void 0);D.__decorate([F.property()],I.prototype,"tolerance",void 0);return I=D.__decorate([U.subclass("esri.layers.support.rasterTransforms.GCSShiftTransform")],I)})},"esri/layers/support/rasterTransforms/BaseRasterTransform":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass".split(" "),
function(P,D,F,I,p,R,U){F=function(H){function N(){return H.apply(this,arguments)||this}P._inheritsLoose(N,H);var B=N.prototype;B.forwardTransform=function(l){return l};B.inverseTransform=function(l){return l};P._createClass(N,[{key:"affectsPixelSize",get:function(){return!1}}]);return N}(F.JSONSupport);D.__decorate([I.property()],F.prototype,"affectsPixelSize",null);D.__decorate([I.property({json:{write:!0}})],F.prototype,"spatialReference",void 0);return F=D.__decorate([U.subclass("esri.layers.support.rasterTransforms.BaseRasterTransform")],
F)})},"esri/layers/support/rasterTransforms/IdentityTransform":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/Error ../../../core/has ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseRasterTransform".split(" "),function(P,D,F,I,p,R,U,H,N,B){F=function(l){function b(){var k=l.apply(this,arguments)||this;
k.type="identity";return k}P._inheritsLoose(b,l);return b}(B);D.__decorate([H.enumeration({IdentityXform:"identity"})],F.prototype,"type",void 0);return F=D.__decorate([N.subclass("esri.layers.support.rasterTransforms.IdentityTransform")],F)})},"esri/layers/support/rasterTransforms/PolynomialTransform":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseRasterTransform ../../../geometry/Point ../../../geometry/Extent".split(" "),
function(P,D,F,I,p,R,U,H,N,B,l,b,k){function f(m,h,r){const {x:E,y:J}=h;if(2>r)return{x:m[0]+E*m[2]+J*m[4],y:m[1]+E*m[3]+J*m[5]};if(2===r){h=E*E;r=J*J;var d=E*J;return{x:m[0]+E*m[2]+J*m[4]+h*m[6]+d*m[8]+r*m[10],y:m[1]+E*m[3]+J*m[5]+h*m[7]+d*m[9]+r*m[11]}}h=E*E;r=J*J;d=E*J;const n=h*E,x=h*J,q=E*r,g=J*r;return{x:m[0]+E*m[2]+J*m[4]+h*m[6]+d*m[8]+r*m[10]+n*m[12]+x*m[14]+q*m[16]+g*m[18],y:m[1]+E*m[3]+J*m[5]+h*m[7]+d*m[9]+r*m[11]+n*m[13]+x*m[15]+q*m[17]+g*m[19]}}function c(m,h,r){const {xmin:E,ymin:J,xmax:d,
ymax:n,spatialReference:x}=h;h=[];if(2>r)h.push({x:E,y:n}),h.push({x:d,y:n}),h.push({x:E,y:J}),h.push({x:d,y:J});else{var q=10;for(var g=0;g<q;g++)h.push({x:E,y:J+(n-J)*g/(q-1)}),h.push({x:d,y:J+(n-J)*g/(q-1)});q=8;for(g=1;g<=q;g++)h.push({x:E+(d-E)*g/q,y:J}),h.push({x:E+(d-E)*g/q,y:n})}h=h.map(a=>f(m,a,r));q=h.map(a=>a.x);h=h.map(a=>a.y);return new k({xmin:Math.min.apply(null,q),xmax:Math.max.apply(null,q),ymin:Math.min.apply(null,h),ymax:Math.max.apply(null,h),spatialReference:x})}F=function(m){function h(){var E=
m.apply(this,arguments)||this;E.polynomialOrder=1;E.type="polynomial";return E}P._inheritsLoose(h,m);var r=h.prototype;r.readForwardCoefficients=function(E,J){const {coeffX:d,coeffY:n}=J;if(!d?.length||!n?.length||d.length!==n.length)return null;E=[];for(J=0;J<d.length;J++)E.push(d[J]),E.push(n[J]);return E};r.writeForwardCoefficients=function(E,J,d){d=[];const n=[];for(let x=0;x<E?.length;x++)0===x%2?d.push(E[x]):n.push(E[x]);J.coeffX=d;J.coeffY=n};r.readInverseCoefficients=function(E,J){const {inverseCoeffX:d,
inverseCoeffY:n}=J;if(!d?.length||!n?.length||d.length!==n.length)return null;E=[];for(J=0;J<d.length;J++)E.push(d[J]),E.push(n[J]);return E};r.writeInverseCoefficients=function(E,J,d){d=[];const n=[];for(let x=0;x<E?.length;x++)0===x%2?d.push(E[x]):n.push(E[x]);J.inverseCoeffX=d;J.inverseCoeffY=n};r.forwardTransform=function(E){if("point"===E.type){const J=f(this.forwardCoefficients,E,this.polynomialOrder);return new b({x:J.x,y:J.y,spatialReference:E.spatialReference})}return c(this.forwardCoefficients,
E,this.polynomialOrder)};r.inverseTransform=function(E){if("point"===E.type){const J=f(this.inverseCoefficients,E,this.polynomialOrder);return new b({x:J.x,y:J.y,spatialReference:E.spatialReference})}return c(this.inverseCoefficients,E,this.polynomialOrder)};P._createClass(h,[{key:"inverseCoefficients",get:function(){var E=this._get("inverseCoefficients"),J=this._get("forwardCoefficients");if(!E&&J&&2>this.polynomialOrder){const [d,n,x,q,g,a]=J;E=x*a-g*q;J=g*q-x*a;E=[(g*n-d*a)/E,(x*n-d*q)/J,a/E,q/
J,-g/E,-x/J]}return E},set:function(E){this._set("inverseCoefficients",E)}},{key:"affectsPixelSize",get:function(){return 0<this.polynomialOrder}}]);return h}(l);D.__decorate([I.property({json:{write:!0}})],F.prototype,"polynomialOrder",void 0);D.__decorate([I.property()],F.prototype,"forwardCoefficients",void 0);D.__decorate([H.reader("forwardCoefficients",["coeffX","coeffY"])],F.prototype,"readForwardCoefficients",null);D.__decorate([B.writer("forwardCoefficients")],F.prototype,"writeForwardCoefficients",
null);D.__decorate([I.property({json:{write:!0}})],F.prototype,"inverseCoefficients",null);D.__decorate([H.reader("inverseCoefficients",["inverseCoeffX","inverseCoeffY"])],F.prototype,"readInverseCoefficients",null);D.__decorate([B.writer("inverseCoefficients")],F.prototype,"writeInverseCoefficients",null);D.__decorate([I.property()],F.prototype,"affectsPixelSize",null);D.__decorate([U.enumeration({PolynomialXform:"polynomial"})],F.prototype,"type",void 0);return F=D.__decorate([N.subclass("esri.layers.support.rasterTransforms.PolynomialTransform")],
F)})},"esri/layers/support/rasterDatasets/ImageAuxRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/has ../../../core/maybe ../../../core/promiseUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ./BaseRaster ./InMemoryRaster ./pamParser ../rasterFormats/RasterCodec ../rasterFunctions/stretchUtils ../rasterTransforms/PolynomialTransform ../../../geometry/SpatialReference ../../../geometry/Extent".split(" "),
function(P,D,F,I,p,R,U,H,N,B,l,b,k,f,c,m,h,r,E){F=function(J){function d(){return J.apply(this,arguments)||this}P._inheritsLoose(d,J);var n=d.prototype;n.open=function(){var x=P._asyncToGenerator(function*(q){yield this.init();var g=yield this._fetchData(q);let {spatialReference:a,statistics:e,histograms:t,transform:v}=yield this._fetchAuxiliaryData(q);(q=!a)&&(a=new r({wkid:3857}));t?.length&&null==e&&(e=m.estimateStatisticsFromHistograms(t));const {width:w,height:y}=g;let G=new E({xmin:-.5,ymin:.5-
y,xmax:w-.5,ymax:.5,spatialReference:a});const C=v?v.forwardTransform(G):G;var u=!0;v&&(u=(u=v.forwardCoefficients)&&0===u[1]&&0===u[2])&&(v=null,G=C);g=new k({data:{extent:C,nativeExtent:G,transform:v,pixelBlock:g,statistics:e,histograms:t,keyProperties:{DateType:"Processed"},isPseudoSpatialReference:q}});yield g.open();g.data=null;this._set("rasterInfo",g.rasterInfo);this._inMemoryRaster=g});return function(q){return x.apply(this,arguments)}}();n.fetchRawTile=function(x,q,g,a={}){return this._inMemoryRaster.fetchRawTile(x,
q,g,a)};n._fetchData=function(){var x=P._asyncToGenerator(function*(q){({data:q}=yield this.request(this.url,{responseType:"array-buffer",signal:q?.signal}));var g=c.getFormat(q).toUpperCase();if("JPG"===g||"PNG"===g||"GIF"===g||"BMP"===g)this._set("datasetFormat",g);else throw new I("image-aux-raster:open","the data is not a supported format");g=g.toLowerCase();const a="gif"===g||"bmp"===g||!p("ios");q=yield this.decodePixelBlock(q,{format:g,useCanvas:a,hasNoZlibMask:!0});if(null==q)throw new I("image-aux-raster:open",
"the data cannot be decoded");return q});return function(q){return x.apply(this,arguments)}}();n._fetchAuxiliaryData=function(){var x=P._asyncToGenerator(function*(q){q=R.unwrap(q?.signal);var g=this.ioConfig.skipExtensions??[],a=g.includes("aux.xml")?null:this.request(this.url+".aux.xml",{responseType:"xml",signal:q}),e=this.datasetFormat;g=(e="JPG"===e?"jgw":"PNG"===e?"pgw":"BMP"===e?"bpw":null)&&g.includes(e)?null:this.request(this.url.slice(0,this.url.lastIndexOf("."))+"."+e,{responseType:"text",
signal:q});a=yield U.eachAlways([a,g]);if(q?.aborted)throw U.createAbortError();q=f.parsePAMInfo(a[0].value?.data);q.transform||(a=a[1].value?a[1].value.data.split("\n").slice(0,6).map(t=>Number(t)):null,q.transform=6===a?.length?new h({forwardCoefficients:[a[4],a[5],a[0],-a[1],a[2],-a[3]]}):null);return q});return function(q){return x.apply(this,arguments)}}();return d}(b);D.__decorate([H.property({type:String,json:{write:!0}})],F.prototype,"datasetFormat",void 0);return F=D.__decorate([l.subclass("esri.layers.support.rasterDatasets.ImageAuxRaster")],
F)})},"esri/layers/support/rasterDatasets/InMemoryRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/maybe ../../../core/promiseUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ../RasterInfo ./BaseRaster ../rasterFunctions/pixelUtils ../rasterFunctions/stretchUtils ../../../geometry/Extent ../../../geometry/SpatialReference".split(" "),
function(P,D,F,I,p,R,U,H,N,B,l,b,k,f,c,m){F=function(h){function r(){var J=h.apply(this,arguments)||this;J.datasetFormat="MEMORY";J.data=null;return J}P._inheritsLoose(r,h);var E=r.prototype;E.open=function(){var J=P._asyncToGenerator(function*(d){yield this.init();var n=this.data;const {pixelBlock:x,statistics:q,histograms:g,name:a,keyProperties:e,nativeExtent:t,transform:v}=this.data,{width:w,height:y,pixelType:G}=x,C=n.extent??new c({xmin:-.5,ymin:.5,xmax:w-.5,ymax:y-.5,spatialReference:new m({wkid:3857})});
n=new l({width:w,height:y,pixelType:G,extent:C,nativeExtent:t,transform:v,pixelSize:{x:C.width/w,y:C.height/y},spatialReference:C.spatialReference,bandCount:x.pixels.length,keyProperties:e||{},statistics:q,isPseudoSpatialReference:n.isPseudoSpatialReference??!n.extent,histograms:g});this.createRemoteDatasetStorageInfo(n,512,512);this._set("rasterInfo",n);this.updateTileInfo();yield this._buildInMemoryRaster(x,{width:512,height:512},d);this.datasetName=a;this.url="/InMemory/"+a});return function(d){return J.apply(this,
arguments)}}();E.fetchRawTile=function(J,d,n,x){J=this._pixelBlockTiles.get(`${J}/${d}/${n}`);return Promise.resolve(J)};E._buildInMemoryRaster=function(){var J=P._asyncToGenerator(function*(d,n,x){var q=this.rasterInfo.storageInfo.maximumPyramidLevel;const g=this.rasterJobHandler?this.rasterJobHandler.split({pixelBlock:d,tileSize:n,maximumPyramidLevel:q},x):Promise.resolve(k.split(d,n,q));n=p.isSome(this.rasterInfo.statistics);q=p.isSome(this.rasterInfo.histograms);d=n?Promise.resolve({statistics:null,
histograms:null}):this.rasterJobHandler?this.rasterJobHandler.estimateStatisticsHistograms({pixelBlock:d},x):Promise.resolve(f.estimateStatisticsHistograms(d));d=yield R.eachAlways([g,d]);if(!d[0].value&&d[1].value)throw new I("inmemory-raster:open","failed to build in memory raster");this._pixelBlockTiles=d[0].value;n||(this.rasterInfo.statistics=d[1].value?.statistics);q||(this.rasterInfo.histograms=d[1].value?.histograms)});return function(d,n,x){return J.apply(this,arguments)}}();return r}(b);
D.__decorate([U.property({type:String,json:{write:!0}})],F.prototype,"datasetFormat",void 0);D.__decorate([U.property()],F.prototype,"data",void 0);return F=D.__decorate([B.subclass("esri.layers.support.rasterDatasets.InMemoryRaster")],F)})},"esri/layers/support/rasterDatasets/pamParser":function(){define("exports ../../../geometry ../../../core/maybe ./xmlUtilities ../rasterTransforms/PolynomialTransform ../../../geometry/SpatialReference".split(" "),function(P,D,F,I,p,R){function U(b,k){if(!b||
!k)return null;const f=[];for(let c=0;c<b.length;c++)f.push(b[c]),f.push(k[c]);return f}function H(b){var k=I.getElement(b,"GeodataXform");b=I.getElementNumericValue(k,"SpatialReference/WKID")||I.getElementValue(k,"SpatialReference/WKT");b=B(b);if("typens:PolynomialXform"!==k.getAttribute("xsi:type"))return{spatialReference:b,transform:null};var f=I.getElementNumericValue(k,"PolynomialOrder")??1,c=I.getElementNumericValues(k,"CoeffX/Double");const m=I.getElementNumericValues(k,"CoeffY/Double");var h=
I.getElementNumericValues(k,"InverseCoeffX/Double");k=I.getElementNumericValues(k,"InverseCoeffY/Double");c=U(c,m);h=U(h,k);f=c&&h&&c.length&&h.length?new p({spatialReference:b,polynomialOrder:f,forwardCoefficients:c,inverseCoefficients:h}):null;return{spatialReference:b,transform:f}}function N(b){const k=I.getElementNumericValue(b,"NoDataValue");var f=I.getElement(b,"Histograms/HistItem");const c=I.getElementNumericValue(f,"HistMin"),m=I.getElementNumericValue(f,"HistMax"),h=I.getElementNumericValue(f,
"BucketCount");f=I.getElementValue(f,"HistCounts")?.split("|").map(n=>Number(n));let r,E,J,d;I.getElements(b,"Metadata/MDI").forEach(n=>{const x=Number(n.textContent??n.nodeValue);switch(n.getAttribute("key").toUpperCase()){case "STATISTICS_MINIMUM":r=x;break;case "STATISTICS_MAXIMUM":E=x;break;case "STATISTICS_MEAN":J=x;break;case "STATISTICS_STDDEV":d=x}});b=I.getElementNumericValue(b,"Metadata/SourceBandIndex");return{noDataValue:k,histogram:f?.length&&null!=c&&null!=m?{min:c,max:m,size:h||f.length,
counts:f}:null,sourceBandIndex:b,statistics:null!=r&&null!=E?{min:r,max:E,avg:J,stddev:d}:null}}function B(b){if(!b)return null;var k=Number(b);if(!isNaN(k)&&0!==k)return new R({wkid:k});b=String(b);if(b.startsWith("COMPD_CS")){if(!b.includes("VERTCS")||!b.includes("GEOGCS")&&!b.startsWith("PROJCS"))return null;k=b.indexOf("VERTCS");var f=b.indexOf("PROJCS");f=-1<f?f:b.indexOf("GEOGCS");if(-1===f)return null;f=b.slice(f,b.lastIndexOf("]",k)+1).trim();b=b.slice(k,b.lastIndexOf("]")).trim();k=(k=l(f))?
new R({wkid:k}):new R({wkt:f});if(b=l(b))k.vcsWkid=b;return k}if(!b.startsWith("GEOGCS")&&!b.startsWith("PROJCS"))return null;k=l(b);return 0!==k?new R({wkid:k}):new R({wkt:b})}function l(b){var k=b.replace(/\]/g,"[").replace(/"/g,"").split("[").map(c=>c.trim()).filter(c=>""!==c);k=k[k.length-1].split(",");const f=k[0]?.toLowerCase();return"epsg"!==f&&"esri"!==f||!b.endsWith('"]]')||(b=Number(k[1]),isNaN(b)||0===b)?0:b}P.parsePAMInfo=function(b){if("pamdataset"!==b?.documentElement.tagName?.toLowerCase())return{};
const k={spatialReference:null,transform:null,metadata:{},rasterBands:[],statistics:null,histograms:null};b.documentElement.childNodes.forEach(f=>{if(1===f.nodeType)if(I.isSameTagIgnoreNS(f,"SRS"))k.spatialReference||(f=I.getElementValue(f),k.spatialReference=B(f));else if(I.isSameTagIgnoreNS(f,"Metadata"))if("xml:ESRI"===f.getAttribute("domain")){const {spatialReference:c,transform:m}=H(f);k.transform=m;k.spatialReference||(k.spatialReference=c)}else I.getElements(f,"MDI").forEach(c=>k.metadata[c.getAttribute("key")]=
I.getElementValue(c));else I.isSameTagIgnoreNS(f,"PAMRasterBand")&&(f=N(f),null!=f.sourceBandIndex&&null==k.rasterBands[f.sourceBandIndex]?k.rasterBands[f.sourceBandIndex]=f:k.rasterBands.push(f))});b=k.rasterBands;b.length&&(k.statistics=b[0].statistics?b.map(f=>f.statistics).filter(F.isSome):null,k.histograms=b[0].histogram?b.map(f=>f.histogram).filter(F.isSome):null);return k};P.parseSpatialReference=B;Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/xmlUtilities":function(){define(["exports"],
function(P){function D(R,U){if(!R||!U)return[];var H=U;U.includes("/")?(H=U.slice(0,U.indexOf("/")),U=U.slice(U.indexOf("/")+1)):U="";const N=[];if(U){R=D(R,H);for(H=0;H<R.length;H++)D(R[H],U).forEach(B=>N.push(B));return N}U=R.getElementsByTagNameNS("*",H);if(!U||0===U.length)return[];for(R=0;R<U.length;R++)N.push(U[R]||U.item[R]);return N}function F(R,U){if(!R||!U)return null;let H=U;U.includes("/")?(H=U.slice(0,U.indexOf("/")),U=U.slice(U.indexOf("/")+1)):U="";R=D(R,H);return 0<R.length?U?F(R[0],
U):R[0]:null}function I(R,U=null){if(R=U?F(R,U):R)if(R=R.textContent||R.nodeValue)return R.trim();return null}function p(R,U){R=D(R,U);U=[];let H;for(let N=0;N<R.length;N++)if(H=R[N].textContent||R[N].nodeValue)H=H.trim(),""!==H&&U.push(H);return U}P.getElement=F;P.getElementNumericValue=function(R,U){R=I(R,U);return Number(R)};P.getElementNumericValues=function(R,U){return p(R,U).map(H=>Number(H))};P.getElementValue=I;P.getElementValues=p;P.getElements=D;P.getNodeNameIgnoreNS=function(R){return R.nodeName.slice(R.nodeName.lastIndexOf(":")+
1)};P.getSpaceDelimitedNumericValues=function(R,U=null){return I(R,U)?.split(" ").map(H=>Number(H))??[]};P.isSameTagIgnoreNS=function(R,U){R=R?.nodeName?.toLowerCase();U=U.toLowerCase();return R.slice(R.lastIndexOf(":")+1)===U};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/ImageServerRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/maybe ../../../core/urlUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ../RasterInfo ../RasterStorageInfo ../serviceTileInfoProperty ../TileInfo ../TilemapCache ./BaseRaster ../rasterFunctions/pixelUtils ../rasterTransforms/GCSShiftTransform ../../../rest/imageService/fetchRasterInfo ../../../geometry/SpatialReference ../../../geometry/Point ../../../geometry/Extent".split(" "),
function(P,D,F,I,p,R,U,H,N,B,l,b,k,f,c,m,h,r,E,J,d,n){F=function(x){function q(){var a=x.apply(this,arguments)||this;a._levelOffset=0;a._tilemapCache=null;a._slices=null;a.datasetFormat="RasterTileServer";a.tileType=null;return a}P._inheritsLoose(q,x);var g=q.prototype;g.open=function(){var a=P._asyncToGenerator(function*(e){yield this.init();var t=e&&e.signal;e=this.sourceJSON?{data:this.sourceJSON}:yield this.request(this.url,{query:{f:"json"},signal:t});e.ssl&&(this.url=this.url.replace(/^http:/i,
"https:"));this.sourceJSON=e=e.data;if(!e)throw new I("imageserverraster:open","cannot initialize tiled image service, missing service info");if(!e.tileInfo)throw new I("imageserverraster:open","use ImageryLayer to open non-tiled image services");this._fixScaleInServiceInfo();var v="jpg jpeg png png8 png24 png32 mixed".split(" ");this.tileType=e.cacheType;null==this.tileType&&(v.includes(e.tileInfo.format.toLowerCase())?this.tileType="Map":"lerc"===e.tileInfo.format.toLowerCase()?this.tileType="Elevation":
this.tileType="Raster");this.datasetName=e.name?.slice(e.name.indexOf("/")+1)??"";t=yield this._fetchRasterInfo({signal:t});if(p.isNone(t))throw new I("image-server-raster:open","cannot initialize image service");v="Map"===this.tileType?k.readServiceTileInfo(e.tileInfo,e):f.fromJSON(e.tileInfo);p.assertIsSome(v);const [w,y]=this._computeMinMaxLOD(t,v),{extent:G,pixelSize:C}=t,u=.5/t.width*C.x,z=Math.max(C.x,C.y),{lods:L}=v;if("Map"!==this.tileType&&0!==e.maxScale||Math.abs(C.x-C.y)>u||!L.some(T=>
Math.abs(T.resolution-z)<u))C.x=C.y=w.resolution,t.width=Math.ceil((G.xmax-G.xmin)/C.x-.1),t.height=Math.ceil((G.ymax-G.ymin)/C.y-.1);const S=w.level-y.level,[Z,X]=v.size,M=[],O=[];L.forEach((T,K)=>{T.level>=y.level&&T.level<=w.level&&M.push({x:T.resolution,y:T.resolution});K<L.length-1&&O.push(Math.round(10*T.resolution/L[K+1].resolution)/10)});M.sort((T,K)=>T.x-K.x);const A=this.computeBlockBoundary(G,Z,X,v.origin,M,S),Q=1<M.length?M.slice(1):null;var Y;e.transposeInfo&&(Y={tileSize:[e.transposeInfo.rows,
e.transposeInfo.cols],packetSize:t.keyProperties?._yxs.PacketSize??0});const W=1>=O.length||3<=O.length&&O.slice(0,O.length-1).every(T=>T===O[0])?O[0]??2:Math.round(10/(y.resolution/w.resolution)**(-1/S))/10;t.storageInfo=new b({blockWidth:v.size[0],blockHeight:v.size[1],pyramidBlockWidth:v.size[0],pyramidBlockHeight:v.size[1],pyramidResolutions:Q,pyramidScalingFactor:W,compression:v.format,origin:v.origin,firstPyramidLevel:1,maximumPyramidLevel:S,tileInfo:v,transposeInfo:Y,blockBoundary:A});this._fixGCSShift(t);
this._set("rasterInfo",t);e.capabilities.toLowerCase().includes("tilemap")&&(Y={tileInfo:t.storageInfo.tileInfo,parsedUrl:R.urlToObject(this.url),url:this.url,tileServers:[],type:"tile"},this._tilemapCache=new c.TilemapCache({layer:Y}))});return function(e){return a.apply(this,arguments)}}();g.fetchRawTile=function(){var a=P._asyncToGenerator(function*(e,t,v,w={}){const {storageInfo:y,extent:G}=this.rasterInfo;var {transposeInfo:C}=y,u=p.isSome(C)&&!!w.transposedVariableName;if(this._slices&&!u&&
null==w.sliceId)return null;({data:w}=yield this.request(`${this.url}/tile/${u?0:y.maximumPyramidLevel-e+this._levelOffset}/${t}/${v}`,{query:this._slices?u?{variable:w.transposedVariableName}:{sliceId:w.sliceId||0}:null,responseType:"array-buffer",signal:w.signal}));if(!w)return null;C=u?C.tileSize:y.tileInfo.size;u=yield this.decodePixelBlock(w,{width:C[0],height:C[1],planes:null,pixelType:null,isPoint:"Elevation"===this.tileType,returnInterleaved:u,noDataValue:p.unwrap(this.rasterInfo.noDataValue)});
if(null==u)return null;C=y.blockBoundary[e];if("jpg"!==y.compression||v>C.minCol&&v<C.maxCol&&t>C.minRow&&t<C.maxRow)return u;const {origin:z,blockWidth:L,blockHeight:S}=y,{x:Z,y:X}=this.getPyramidPixelSize(e);var M=Math.round((G.xmin-z.x)/Z)%L;e=Math.round((G.xmax-z.x)/Z)%L||L;var O=Math.round((z.y-G.ymax)/X)%S;w=Math.round((z.y-G.ymin)/X)%S||S;M=v===C.minCol?M:0;O=t===C.minRow?O:0;h.setValidBoundary(u,{x:M,y:O},{width:(v===C.maxCol?e:L)-M,height:(t===C.maxRow?w:S)-O});return u});return function(e,
t,v){return a.apply(this,arguments)}}();g.getSliceIndex=function(a){if(!this._slices||p.isNone(a)||0===a.length)return null;for(let e=0;e<this._slices.length;e++){const t=this._slices[e].multidimensionalDefinition;if(t.length===a.length&&!t.some(v=>{var w=a.find(G=>v.variableName===G.variableName&&G.dimensionName===v.dimensionName);if(!w)return!0;const y=Array.isArray(v.values[0])?`${v.values[0][0]}-${v.values[0][1]}`:v.values[0];w=Array.isArray(w.values[0])?`${w.values[0][0]}-${w.values[0][1]}`:
w.values[0];return y!==w}))return e}return null};g.fetchVariableStatisticsHistograms=function(){var a=P._asyncToGenerator(function*(e,t){var v=this.request(this.url+"/statistics",{query:{variable:e,f:"json"},signal:t}).then(w=>w.data?.statistics);e=this.request(this.url+"/histograms",{query:{variable:e,f:"json"},signal:t}).then(w=>w.data?.histograms);v=yield Promise.all([v,e]);v[0]&&v[0].forEach(w=>{w.avg=w.mean;w.stddev=w.standardDeviation});return{statistics:v[0]||null,histograms:v[1]||null}});
return function(e,t){return a.apply(this,arguments)}}();g.computeBestPyramidLevelForLocation=function(){var a=P._asyncToGenerator(function*(e,t={}){if(!this._tilemapCache)return 0;e=this.identifyPixelLocation(e,0,p.unwrap(t.datumTransformation));if(null===e)return null;let v=0;var {maximumPyramidLevel:w}=this.rasterInfo.storageInfo;w=w-v+this._levelOffset;const y=e.srcLocation;for(;0<=w;){try{if("available"===(yield this._tilemapCache.fetchAvailability(w,e.row,e.col,t)))break}catch{}w--;v++;e=this.identifyPixelLocation(y,
v,p.unwrap(t.datumTransformation));if(null===e)return null}return-1===w||null==e?null:v});return function(e){return a.apply(this,arguments)}}();g._fetchRasterInfo=function(){var a=P._asyncToGenerator(function*(e){var t=this.sourceJSON;if("Map"===this.tileType){e=t.fullExtent||t.extent;var v=Math.ceil((e.xmax-e.xmin)/t.pixelSizeX-.1);const w=Math.ceil((e.ymax-e.ymin)/t.pixelSizeY-.1),y=J.fromJSON(t.spatialReference||e.spatialReference);t=new d({x:t.pixelSizeX,y:t.pixelSizeY,spatialReference:y});return new l({width:v,
height:w,bandCount:3,extent:n.fromJSON(e),spatialReference:y,pixelSize:t,pixelType:"u8",statistics:null,keyProperties:{DataType:"processed"}})}({signal:v}=e);e=E.fetchServiceRasterInfo(this.url,this.sourceJSON,{signal:v,query:this.ioConfig.customFetchParameters});t=t.hasMultidimensions?this.request(`${this.url}/slices`,{query:{f:"json"},signal:v}).then(w=>w.data&&w.data.slices).catch(()=>null):null;t=yield Promise.all([e,t]);this._slices=t[1];return t[0]});return function(e){return a.apply(this,arguments)}}();
g._fixScaleInServiceInfo=function(){const {sourceJSON:a}=this;a.minScale&&0>a.minScale&&(a.minScale=0);a.maxScale&&0>a.maxScale&&(a.maxScale=0)};g._fixGCSShift=function(a){const {extent:e,spatialReference:t}=a;-1<e.xmin&&181<e.xmax&&t?.wkid&&t.isGeographic&&(a.nativeExtent=a.extent,a.transform=new r,a.extent=a.transform.forwardTransform(e))};g._computeMinMaxLOD=function(a,e){const {pixelSize:t}=a,v=.5/a.width*t.x;({lods:a}=e);var w=e.lodAt(Math.max.apply(null,a.map(u=>u.level)));e=e.lodAt(Math.min.apply(null,
a.map(u=>u.level)));var {tileType:y}=this;if("Map"===y)return this._levelOffset=a[0].level,[w,e];if("Raster"===y)return[a.find(u=>u.resolution===t.x)??w,e];const {minScale:G,maxScale:C}=this.sourceJSON;y=w;0<C&&((y=a.find(u=>Math.abs(u.scale-C)<v))||(y=a.filter(u=>u.scale>C).sort((u,z)=>u.scale>z.scale?1:-1)[0]??w));w=e;0<G&&(w=a.find(u=>Math.abs(u.scale-G)<v)??e,this._levelOffset=w.level-e.level);return[y,w]};return q}(m);D.__decorate([U.property({type:String,json:{write:!0}})],F.prototype,"datasetFormat",
void 0);D.__decorate([U.property()],F.prototype,"tileType",void 0);return F=D.__decorate([B.subclass("esri.layers.support.rasterDatasets.ImageServerRaster")],F)})},"esri/layers/support/serviceTileInfoProperty":function(){define(["exports","./TileInfo"],function(P,D){function F(p,R,U,H){if(!p)return null;const {minScale:N,maxScale:B,minLOD:l,maxLOD:b}=R;if(null!=l&&null!=b)return H&&H.ignoreMinMaxLOD?D.fromJSON(p):D.fromJSON({...p,lods:p.lods.filter(({level:k})=>null!=k&&k>=l&&k<=b)});if(0!==N&&0!==
B){const k=N?Math.round(1E4*N)/1E4:Infinity,f=B?Math.round(1E4*B)/1E4:-Infinity;return D.fromJSON({...p,lods:p.lods.filter(c=>{c=Math.round(1E4*c.scale)/1E4;return c<=k&&c>=f})})}return D.fromJSON(p)}const I={type:D,json:{origins:{service:{read:{source:["tileInfo","minScale","maxScale","minLOD","maxLOD"],reader:F}}}}};P.readServiceTileInfo=F;P.serviceTileInfoProperty=I;Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/TilemapCache":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../request ../../core/Accessor ../../core/byteSizeEstimations ../../core/Error ../../core/HandleOwner ../../core/Logger ../../core/LRUCache ../../core/PooledArray ../../core/promiseUtils ../../core/reactiveUtils ../../core/scheduling ../../core/urlUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass ./TileKey ./Tilemap".split(" "),
function(P,D,F,I,p,R,U,H,N,B,l,b,k,f,c,m,h,r,E,J,d){var n;P.TilemapCache=n=function(x){function q(a){a=x.call(this,a)||this;a._pendingTilemapRequests={};a._availableLevels={};a.levels=5;a.cacheByteSize=2*R.ByteSizeUnit.MEGABYTES;a.request=I;a._prefetchingEnabled=!0;return a}D._inheritsLoose(q,x);var g=q.prototype;g.initialize=function(){this._tilemapCache=new B(this.cacheByteSize);this.addHandles([k.watch(()=>{const {layer:a}=this;return[a?.parsedUrl,a?.tileServers,a?.apiKey,a?.customParameters]},
()=>this._initializeTilemapDefinition()),k.watch(()=>this.layer?.tileInfo?.lods,a=>this._initializeAvailableLevels(a),k.syncAndInitial)]);this._initializeTilemapDefinition()};g.castLevels=function(a){return 2>=a?(N.getLogger(this.declaredClass).error("Minimum levels for Tilemap is 3, but got ",a),3):a};g.fetchTilemap=function(a,e,t,v){if(!this._availableLevels[a])return Promise.reject(new U("tilemap-cache:level-unavailable",`Level ${a} is unavailable in the service`));const w=this._tmpTilemapDefinition;
if(a=this._tilemapFromCache(a,e,t,w))return Promise.resolve(a);const y=v&&v.signal;v={...v,signal:null};return new Promise((G,C)=>{b.onAbort(y,()=>C(b.createAbortError()));const u=d.tilemapDefinitionId(w);let z=this._pendingTilemapRequests[u];if(!z){z=d.Tilemap.fromDefinition(w,v).then(S=>{this._tilemapCache.put(u,S,S.byteSize);return S});const L=()=>delete this._pendingTilemapRequests[u];this._pendingTilemapRequests[u]=z;z.then(L,L)}z.then(G,C)})};g.getAvailability=function(a,e,t){return this._availableLevels[a]?
(a=this._tilemapFromCache(a,e,t,this._tmpTilemapDefinition))?a.getAvailability(e,t):"unknown":"unavailable"};g.fetchAvailability=function(a,e,t,v){return this._availableLevels[a]?this.fetchTilemap(a,e,t,v).catch(w=>w).then(w=>{if(w instanceof d.Tilemap){w=w.getAvailability(e,t);if("unavailable"===w)throw new U("tile-map:tile-unavailable","Tile is not available",{level:a,row:e,col:t});return w}if(b.isAbortError(w))throw w;return"unknown"}):Promise.reject(new U("tilemap-cache:level-unavailable",`Level ${a} is unavailable in the service`))};
g.fetchAvailabilityUpsample=function(a,e,t,v,w){v.level=a;v.row=e;v.col=t;const y=this.layer.tileInfo;y.updateTileInfo(v);const G=this.fetchAvailability(a,e,t,w).catch(C=>{if(b.isAbortError(C))throw C;if(y.upsampleTile(v))return this.fetchAvailabilityUpsample(v.level,v.row,v.col,v);throw C;});this._fetchAvailabilityUpsamplePrefetch(v.id,a,e,t,w,G);return G};g._fetchAvailabilityUpsamplePrefetch=function(){var a=D._asyncToGenerator(function*(e,t,v,w,y,G){if(this._prefetchingEnabled&&null!=e){var C=
`prefetch-${e}`;if(!this.handles.has(C)){var u=new AbortController;G.then(()=>u.abort(),()=>u.abort());var z=!1;this.handles.add({remove(){z||(z=!0,u.abort())}},C);yield f.waitTicks(10,u.signal).catch(()=>{});z||(z=!0,this.handles.remove(C));if(!b.isAborted(u))for(e=new J.TileKey(e,t,v,w),y={...y,signal:u.signal},t=this.layer.tileInfo,v=0;n._prefetches.length<n._maxPrefetch&&t.upsampleTile(e);++v){const L=this.fetchAvailability(e.level,e.row,e.col,y);n._prefetches.push(L);w=()=>{n._prefetches.removeUnordered(L)};
L.then(w,w)}}}});return function(e,t,v,w,y,G){return a.apply(this,arguments)}}();g._initializeTilemapDefinition=function(){if(this.layer.parsedUrl){var {parsedUrl:a,apiKey:e,customParameters:t}=this.layer;this._tilemapCache.clear();this._tmpTilemapDefinition={service:{url:a.path,query:c.objectToQuery({...a.query,...t,token:e??a.query?.token}),tileServers:this.layer.tileServers,request:this.request,type:this.layer.type},width:this.size,height:this.size,level:0,row:0,col:0}}};g._tilemapFromCache=function(a,
e,t,v){v.level=a;v.row=e-e%this.size;v.col=t-t%this.size;a=d.tilemapDefinitionId(v);return this._tilemapCache.get(a)};g._initializeAvailableLevels=function(a){this._availableLevels={};a&&a.forEach(e=>this._availableLevels[e.level]=!0)};D._createClass(q,[{key:"size",get:function(){return 1<<this.levels}},{key:"test",get:function(){const a=this;return{get prefetchingEnabled(){return a._prefetchingEnabled},set prefetchingEnabled(e){a._prefetchingEnabled=e},hasTilemap(e,t,v){return!!a._tilemapFromCache(e,
t,v,a._tmpTilemapDefinition)}}}}]);return q}(H.HandleOwnerMixin(p));P.TilemapCache._maxPrefetch=4;P.TilemapCache._prefetches=new l({initialSize:n._maxPrefetch});F.__decorate([m.property({constructOnly:!0,type:Number})],P.TilemapCache.prototype,"levels",void 0);F.__decorate([h.cast("levels")],P.TilemapCache.prototype,"castLevels",null);F.__decorate([m.property({readOnly:!0,type:Number})],P.TilemapCache.prototype,"size",null);F.__decorate([m.property({constructOnly:!0,type:Number})],P.TilemapCache.prototype,
"cacheByteSize",void 0);F.__decorate([m.property({constructOnly:!0})],P.TilemapCache.prototype,"layer",void 0);F.__decorate([m.property({constructOnly:!0})],P.TilemapCache.prototype,"request",void 0);P.TilemapCache=n=F.__decorate([E.subclass("esri.layers.support.TilemapCache")],P.TilemapCache);Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/core/byteSizeEstimations":function(){define(["exports"],function(P){function D(p){return 32+p.length}function F(p){if(!p)return 0;if(Array.isArray(p)){var R=
p.length;if(0===R||"number"===typeof p[0])p=32+8*R;else{var U=32;for(let H=0;H<R;H++)U+=I(p[H]);p=U}return p}U=32;for(R in p)p.hasOwnProperty(R)&&(U+=I(p[R]));return U}function I(p){switch(typeof p){case "object":return F(p);case "string":return D(p);case "number":return 16;case "boolean":return 4;default:return 8}}P.ByteSizeUnit=void 0;(function(p){p[p.KILOBYTES=1024]="KILOBYTES";p[p.MEGABYTES=1048576]="MEGABYTES";p[p.GIGABYTES=1073741824]="GIGABYTES"})(P.ByteSizeUnit||(P.ByteSizeUnit={}));P.estimateAttributesObjectSize=
function(p){if(!p)return 0;let R=32;for(const U in p)if(p.hasOwnProperty(U)){const H=p[U];switch(typeof H){case "string":R+=D(H);break;case "number":R+=16;break;case "boolean":R+=4}}return R};P.estimateFixedArraySize=function(p,R){return 32+p.length*R};P.estimateNestedObjectSize=F;P.estimateNumberByteSize=function(p){return 16};P.estimateStringByteSize=D;Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/Tilemap":function(){define(["exports","../../request","../../core/arrayUtils",
"../../core/Error","../../core/lang"],function(P,D,F,I,p){function R(H){if("vector-tile"===H.service.type)var N=`${H.service.url}/tilemap/${H.level}/${H.row}/${H.col}/${H.width}/${H.height}`;else N=H.service.tileServers,N=`${N&&N.length?N[H.row%N.length]:H.service.url}/tilemap/${H.level}/${H.row}/${H.col}/${H.width}/${H.height}`;(H=H.service.query)&&(N=`${N}?${H}`);return N}let U=function(){function H(){this.location={left:0,top:0,width:0,height:0};this._allAvailability="unknown";this.byteSize=40}
var N=H.prototype;N.getAvailability=function(B,l){if("unknown"!==this._allAvailability)return this._allAvailability;B=(B-this.location.top)*this.location.width+(l-this.location.left);l=B>>3;const b=this._tileAvailabilityBitSet;return 0>l||l>b.length?"unknown":b[l]&1<<B%8?"available":"unavailable"};N._updateFromData=function(B){let l=!0,b=!0;const k=new Uint8Array(Math.ceil(this.location.width*this.location.height/8));let f=0;for(let c=0;c<B.length;c++){const m=c%8;B[c]?(b=!1,k[f]|=1<<m):l=!1;7===
m&&++f}b?this._allAvailability="unavailable":l?this._allAvailability="available":(this._allAvailability="unknown",this._tileAvailabilityBitSet=k,this.byteSize+=k.length)};H.fromDefinition=function(B,l){const b=B.service.request||D,{row:k,col:f,width:c,height:m}=B,h={query:{f:"json"}};l=l?{...h,...l}:h;return b(R(B),l).then(r=>r.data).catch(r=>{if(r&&r.details&&422===r.details.httpStatus)return{location:{top:k,left:f,width:c,height:m},valid:!0,data:F.constant(c*m,0)};throw r;}).then(r=>{if(r.location&&
(r.location.top!==k||r.location.left!==f||r.location.width!==c||r.location.height!==m))throw new I("tilemap:location-mismatch","Tilemap response for different location than requested",{response:r,definition:{top:k,left:f,width:c,height:m}});return H.fromJSON(r)})};H.fromJSON=function(B){H._validateJSON(B);const l=new H;l.location=Object.freeze(p.clone(B.location));l._updateFromData(B.data);return Object.freeze(l)};H._validateJSON=function(B){if(!B||!B.location)throw new I("tilemap:missing-location",
"Location missing from tilemap response");if(!1===B.valid)throw new I("tilemap:invalid","Tilemap response was marked as invalid");if(!B.data)throw new I("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(B.data))throw new I("tilemap:data-mismatch","Data must be an array of numbers");if(B.data.length!==B.location.width*B.location.height)throw new I("tilemap:data-mismatch","Number of data items does not match width/height of tilemap");};return H}();P.Tilemap=U;P.tilemapDefinitionId=
function(H){return`${H.level}/${H.row}/${H.col}/${H.width}/${H.height}`};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/rest/imageService/fetchRasterInfo":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../request ../../geometry/Extent ../../geometry/Point ../../geometry/SpatialReference ../../layers/support/RasterInfo ../utils ../support/FeatureSet".split(" "),function(P,D,F,I,p,R,U,H,N){function B(b,k,f){return l.apply(this,arguments)}function l(){l=D._asyncToGenerator(function*(b,
k,f){b=H.parseUrl(b);const {renderingRule:c,sourceJSON:m}=k||{};k=c?JSON.stringify(c.rasterFunctionDefinition||c):null;k=H.encode({...b.query,renderingRule:k,f:"json"});k=H.asValidOptions(k,f);b=b.path;f=m||(yield F(b,k).then(e=>e.data));var h=f.hasRasterAttributeTable?F(`${b}/rasterAttributeTable`,k):null,r=f.hasColormap?F(`${b}/colormap`,k):null,E=f.hasHistograms?F(`${b}/histograms`,k):null,J=10.3<=f.currentVersion?F(`${b}/keyProperties`,k):null;b=f.hasMultidimensions?F(`${b}/multidimensionalInfo`,
k):null;k=yield Promise.allSettled([h,r,E,J,b]);b=null;if(f.minValues&&f.minValues.length===f.bandCount)for(b=[],h=0;h<f.minValues.length;h++)b.push({min:f.minValues[h],max:f.maxValues[h],avg:f.meanValues[h],stddev:f.stdvValues[h]});r=I.fromJSON(f.extent);h=Math.ceil(r.width/f.pixelSizeX-.1);r=Math.ceil(r.height/f.pixelSizeY-.1);E=R.fromJSON(f.spatialReference||f.extent.spatialReference);J="fulfilled"===k[0].status?k[0].value?N.fromJSON(k[0].value.data):null:null;const d="fulfilled"===k[1].status?
k[1].value?.data.colormap:null,n="fulfilled"===k[2].status?k[2].value?.data.histograms:null,x="fulfilled"===k[3].status?k[3].value?.data??{}:{};k="fulfilled"===k[4].status?k[4].value?.data.multidimensionalInfo:null;k?.variables?.length&&k.variables.forEach(e=>{e.statistics?.length&&e.statistics.forEach(t=>{t.avg=t.mean;t.stddev=t.standardDeviation})});const {defaultVariable:q,serviceDataType:g}=f;q&&q!==x.DefaultVariable&&(x.DefaultVariable=q);g&&g.includes("esriImageServiceDataTypeVector")&&!g.includes(x.DataType)&&
(x.DataType=g.replace("esriImageServiceDataType",""));let a=f.noDataValue;f.noDataValues?.length&&f.noDataValues.some(e=>e!==a)&&(a=f.noDataValues);return new U({width:h,height:r,bandCount:f.bandCount,extent:I.fromJSON(f.extent),spatialReference:E,pixelSize:new p({x:f.pixelSizeX,y:f.pixelSizeY,spatialReference:E}),pixelType:f.pixelType.toLowerCase(),statistics:b,attributeTable:J,colormap:d,histograms:n,keyProperties:x,noDataValue:a,multidimensionalInfo:k})});return l.apply(this,arguments)}P.fetchServiceRasterInfo=
function(b,k,f){return B(b,{sourceJSON:k},f)};P.generateRasterInfo=function(b,k,f){return B(b,{renderingRule:k},f)};Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/MRFRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ../PixelBlock ../RasterInfo ../RasterStorageInfo ./BaseRaster ./pamParser ./xmlUtilities ../rasterFormats/utils ../rasterFunctions/stretchUtils ../../../geometry/SpatialReference ../../../geometry/Extent ../../../geometry/Point".split(" "),
function(P,D,F,I,p,R,U,H,N,B,l,b,k,f,c,m,h,r,E,J){const d=new Map;d.set("Int8","s8");d.set("UInt8","u8");d.set("Int16","s16");d.set("UInt16","u16");d.set("Int32","s32");d.set("UInt32","u32");d.set("Float32","f32");d.set("Float64","f32");d.set("Double64","f32");const n=new Map;n.set("none",{blobExtension:".til",isOneSegment:!0,decoderFormat:"bip"});n.set("lerc",{blobExtension:".lrc",isOneSegment:!1,decoderFormat:"lerc"});n.set("deflate",{blobExtension:".pzp",isOneSegment:!0,decoderFormat:"deflate"});
n.set("jpeg",{blobExtension:".pjg",isOneSegment:!0,decoderFormat:"jpg"});F=function(x){function q(){var a=x.apply(this,arguments)||this;a._files=null;a._storageIndex=null;a.datasetFormat="MRF";return a}P._inheritsLoose(q,x);var g=q.prototype;g.open=function(){var a=P._asyncToGenerator(function*(e){yield this.init();this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1);var t=e?p.unwrap(e.signal):null,v=yield this.request(this.url,{responseType:"xml",signal:t});const {rasterInfo:w,files:y}=this._parseHeader(v.data);
-1===this.ioConfig.skipExtensions?.indexOf("aux.xml")&&(e=yield this._fetchAuxiliaryData(e),null!=e&&(w.statistics=e.statistics??w.statistics,(w.histograms=e.histograms)&&p.isNone(w.statistics)&&(w.statistics=h.estimateStatisticsFromHistograms(e.histograms))));this._set("rasterInfo",w);this._files=y;t=yield this.request(y.index,{responseType:"array-buffer",signal:t});this._storageIndex=this._parseIndex(t.data);const {blockWidth:G,blockHeight:C}=this.rasterInfo.storageInfo;t=this.rasterInfo.storageInfo.pyramidScalingFactor;
const {width:u,height:z}=this.rasterInfo;e=[];v=this._getBandSegmentCount();let L=0,S=-1;for(;L<this._storageIndex.length;){S++;const Z=Math.ceil(u/G/t**S)-1,X=Math.ceil(z/C/t**S)-1;L+=(Z+1)*(X+1)*v*4;e.push({maxRow:X,maxCol:Z,minCol:0,minRow:0})}this.rasterInfo.storageInfo.blockBoundary=e;0<S&&(this.rasterInfo.storageInfo.firstPyramidLevel=1,this.rasterInfo.storageInfo.maximumPyramidLevel=S);this.updateTileInfo()});return function(e){return a.apply(this,arguments)}}();g.fetchRawTile=function(){var a=
P._asyncToGenerator(function*(e,t,v,w={}){const {blockWidth:y,blockHeight:G,blockBoundary:C}=this.rasterInfo.storageInfo;var u=C[e];if(!u||u.maxRow<t||u.maxCol<v||u.minRow>t||u.minCol>v)return null;const {bandCount:z,pixelType:L}=this.rasterInfo,{ranges:S,actualTileWidth:Z,actualTileHeight:X}=this._getTileLocation(e,t,v);if(!S||0===S.length)return null;if(0===S[0].from&&0===S[0].to)return e=new Uint8Array(y*G),new B({width:y,height:G,pixels:null,mask:e,validPixelCount:0});({bandIds:t}=this.ioConfig);
v=this._getBandSegmentCount();u=[];for(e=e=0;e<v;e++)(!t||-1<t.indexOf[e])&&u.push(this.request(this._files.data,{range:{from:S[e].from,to:S[e].to},responseType:"array-buffer",signal:w.signal}));w=yield Promise.all(u);e=w.map(O=>O.data.byteLength).reduce((O,A)=>O+A);u=new Uint8Array(e);let M=0;for(e=0;e<v;e++)u.set(new Uint8Array(w[e].data),M),M+=w[e].data.byteLength;e=n.get(this.rasterInfo.storageInfo.compression).decoderFormat;t=yield this.decodePixelBlock(u.buffer,{width:y,height:G,format:e,planes:t?.length||
z,pixelType:L});if(null==t)return null;if(p.isSome(this.rasterInfo.noDataValue)&&"lerc"!==e&&!t.mask&&(w=this.rasterInfo.noDataValue[0],null!=w)){v=t.width*t.height;u=new Uint8Array(v);if(1E24<Math.abs(w))for(e=0;e<v;e++)1E-6<Math.abs((t.pixels[0][e]-w)/w)&&(u[e]=1);else for(e=0;e<v;e++)t.pixels[0][e]!==w&&(u[e]=1);t.mask=u}v=w=0;if(Z!==y||X!==G)if(u=t.mask)for(e=0;e<G;e++)for(v=e*y,w=e<X?Z:0;w<y;w++)u[v+w]=0;else for(u=new Uint8Array(y*G),t.mask=u,e=0;e<X;e++)for(v=e*y,w=0;w<Z;w++)u[v+w]=1;return t});
return function(e,t,v){return a.apply(this,arguments)}}();g._parseIndex=function(a){if(0<a.byteLength%16)throw Error("invalid array buffer must be multiples of 16");let e,t,v,w,y;if(m.isPlatformLittleEndian){e=new Uint8Array(a);v=new ArrayBuffer(a.byteLength);t=new Uint8Array(v);for(w=0;w<a.byteLength/4;w++)for(y=0;4>y;y++)t[4*w+y]=e[4*w+3-y];a=new Uint32Array(v)}else a=new Uint32Array(a);return a};g._getBandSegmentCount=function(){return n.get(this.rasterInfo.storageInfo.compression).isOneSegment?
1:this.rasterInfo.bandCount};g._getTileLocation=function(a,e,t){const {blockWidth:v,blockHeight:w,pyramidScalingFactor:y}=this.rasterInfo.storageInfo,{width:G,height:C}=this.rasterInfo,u=this._getBandSegmentCount();let z,L;var S,Z=0;let X=0;for(S=0;S<a;S++)X=y**S,z=Math.ceil(G/v/X),L=Math.ceil(C/w/X),Z+=z*L;X=y**a;z=Math.ceil(G/v/X);L=Math.ceil(C/w/X);Z=4*(Z+(e*z+t))*u;a=this._storageIndex.subarray(Z,Z+4*u);Z=S=0;const M=[];for(let O=0;O<u;O++)S=a[4*O]*2**32+a[4*O+1],Z=S+a[4*O+2]*2**32+a[4*O+3],M.push({from:S,
to:Z});return{ranges:M,actualTileWidth:t<z-1?v:Math.ceil(G/X)-v*(z-1),actualTileHeight:e<L-1?w:Math.ceil(C/X)-w*(L-1)}};g._parseHeader=function(a){var e=c.getElement(a,"MRF_META/Raster");if(!e)throw new I("mrf:open","not a valid MRF format");var t=c.getElement(e,"Size"),v=parseInt(t.getAttribute("x"),10),w=parseInt(t.getAttribute("y"),10);const y=parseInt(t.getAttribute("c"),10);t=(c.getElementValue(e,"Compression")||"none").toLowerCase();if(!n.has(t))throw new I("mrf:open","currently does not support compression "+
t);var G=c.getElementValue(e,"DataType")||"UInt8";const C=d.get(G);if(null==C)throw new I("mrf:open","currently does not support pixel type "+G);var u=c.getElement(e,"PageSize");G=parseInt(u.getAttribute("x"),10);u=parseInt(u.getAttribute("y"),10);e=c.getElement(e,"DataValues");let z;e&&(e=e.getAttribute("NoData"),null!=e&&(z=e.trim().split(" ").map(A=>parseFloat(A))));if(c.getElement(a,"MRF_META/CachedSource"))throw new I("mrf:open","currently does not support MRF referencing other data files");
var L=c.getElement(a,"MRF_META/GeoTags"),S=c.getElement(L,"BoundingBox");e=!1;if(null!=S){var Z=parseFloat(S.getAttribute("minx"));var X=parseFloat(S.getAttribute("miny")),M=parseFloat(S.getAttribute("maxx"));S=parseFloat(S.getAttribute("maxy"));var O=c.getElementValue(L,"Projection")||"";L=r.WGS84;"LOCAL_CS[]"!==O?O.toLowerCase().startsWith("epsg:")?(O=Number(O.slice(5)),isNaN(O)||0===O||(L=new r({wkid:O}))):L=f.parseSpatialReference(O)??r.WGS84:(e=!0,L=new r({wkid:3857}));Z=new E(Z,X,M,S);Z.spatialReference=
L}else e=!0,Z=new E({xmin:-.5,ymin:.5-w,xmax:v-.5,ymax:.5,spatialReference:new r({wkid:3857})});X=c.getElement(a,"MRF_META/Rsets");M=parseInt(X&&X.getAttribute("scale")||"2",10);X=Z.spatialReference;G=new b({origin:new J({x:Z.xmin,y:Z.ymax,spatialReference:X}),blockWidth:G,blockHeight:u,pyramidBlockWidth:G,pyramidBlockHeight:u,compression:t,pyramidScalingFactor:M});u=new J({x:Z.width/v,y:Z.height/w,spatialReference:X});v=new l({width:v,height:w,extent:Z,isPseudoSpatialReference:e,spatialReference:X,
bandCount:y,pixelType:C,pixelSize:u,noDataValue:z,storageInfo:G});w=c.getElementValue(a,"datafile");a=c.getElementValue(a,"IndexFile");a={mrf:this.url,index:a||this.url.replace(".mrf",".idx"),data:w||this.url.replace(".mrf",n.get(t).blobExtension)};return{rasterInfo:v,files:a}};g._fetchAuxiliaryData=function(){var a=P._asyncToGenerator(function*(e){try{const {data:t}=yield this.request(this.url+".aux.xml",{responseType:"xml",signal:e?.signal});return f.parsePAMInfo(t)}catch{return null}});return function(e){return a.apply(this,
arguments)}}();return q}(k);D.__decorate([R.property()],F.prototype,"_files",void 0);D.__decorate([R.property()],F.prototype,"_storageIndex",void 0);D.__decorate([R.property({type:String,json:{write:!0}})],F.prototype,"datasetFormat",void 0);return F=D.__decorate([N.subclass("esri.layers.support.rasterIO.MRFRaster")],F)})},"esri/layers/support/rasterDatasets/TIFFRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ../RasterInfo ../RasterStorageInfo ./BaseRaster ./DBFParser ./pamParser ../rasterFormats/TiffDecoder ../rasterFormats/TiffTags ../rasterFunctions/stretchUtils ../rasterTransforms/PolynomialTransform ../../../rest/support/FeatureSet ../../../geometry/SpatialReference ../../../geometry/Extent ../../../geometry/Point".split(" "),
function(P,D,F,I,p,R,U,H,N,B,l,b,k,f,c,m,h,r,E,J,d,n){F=function(x){function q(){var a=x.apply(this,arguments)||this;a._files=null;a._headerInfo=null;a._bufferSize=1048576;a.datasetFormat="TIFF";return a}P._inheritsLoose(q,x);var g=q.prototype;g.open=function(){var a=P._asyncToGenerator(function*(e){yield this.init();var t=e?p.unwrap(e.signal):null,{data:v}=yield this.request(this.url,{range:{from:0,to:this._bufferSize},responseType:"array-buffer",signal:t});if(!v)throw new I("tiffraster:open","failed to open url "+
this.url);this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1,this.url.lastIndexOf("."));const {littleEndian:w,firstIFDPos:y,isBigTiff:G}=c.parseSignature(v);var C=[];yield this._readIFDs(C,v,w,y,0,G?8:4,t);const {imageInfo:u,rasterInfo:z}=this._parseIFDs(C);t=c.getPyramidIFDs(C);v=c.getMaskIFDs(C);this._headerInfo={littleEndian:w,isBigTiff:G,ifds:C,pyramidIFDs:t,maskIFDs:v,...u};this._set("rasterInfo",z);if(!u.isSupported)throw new I("tiffraster:open","this tiff is not supported: "+u.message);
if(!u.tileWidth)throw new I("tiffraster:open","none-tiled tiff is not optimized for access, convert to COG and retry.");({skipExtensions:C=[]}=this.ioConfig);C.includes("aux.xml")||(t=yield this._fetchAuxiliaryMetaData(e),null!=t&&this._processPAMInfo(t,z));C.includes("vat.dbf")||1!==z.bandCount||"u8"!==z.pixelType||(z.attributeTable=yield this._fetchAuxiliaryTable(e),p.isSome(z.attributeTable)&&(z.keyProperties.DataType="thematic"));this.updateTileInfo()});return function(e){return a.apply(this,
arguments)}}();g.fetchRawTile=function(){var a=P._asyncToGenerator(function*(e,t,v,w={}){if(!this._headerInfo?.isSupported||this.isBlockOutside(e,t,v))return null;const y=yield this._fetchRawTiffTile(e,t,v,!1,w);p.isSome(y)&&this._headerInfo.hasMaskBand&&(e=yield this._fetchRawTiffTile(e,t,v,!0,w),p.isSome(e)&&e.pixels[0]instanceof Uint8Array&&(y.mask=e.pixels[0]));return y});return function(e,t,v){return a.apply(this,arguments)}}();g._parseIFDs=function(a){const e=c.getImageInfo(a),{width:t,height:v,
tileWidth:w,tileHeight:y,planes:G,pixelType:C,compression:u,firstPyramidLevel:z,maximumPyramidLevel:L,pyramidBlockWidth:S,pyramidBlockHeight:Z,tileBoundary:X,affine:M,metadata:O}=e;let A=f.parseSpatialReference(e.extent.spatialReference?.wkt||e.extent.spatialReference?.wkid);var Q=!!e.isPseudoGeographic;null==A&&(Q=!0,A=new J({wkid:3857}));const Y=new d({...e.extent,spatialReference:A});var W=Y?new n({x:Y.xmin,y:Y.ymax,spatialReference:A}):new n({x:0,y:0});W=new l({blockWidth:w,blockHeight:y,pyramidBlockWidth:S,
pyramidBlockHeight:Z,compression:u,origin:W,firstPyramidLevel:z,maximumPyramidLevel:L,blockBoundary:X});const T=new n({x:(Y.xmax-Y.xmin)/t,y:(Y.ymax-Y.ymin)/v,spatialReference:A}),K=O?{BandProperties:O.bandProperties,DataType:O.dataType}:{};let V=null;var ba=a[0].get("PHOTOMETRICINTERPRETATION")?.values?.[0];a=a[0].get("COLORMAP")?.values;if(3>=ba&&3<a?.length&&0===a.length%3){V=[];ba=a.length/3;for(let aa=0;aa<ba;aa++)V.push([aa,a[aa]>>>8,a[aa+ba]>>>8,a[aa+2*ba]>>>8])}Q=new B({width:t,height:v,bandCount:G,
pixelType:C,pixelSize:T,storageInfo:W,spatialReference:A,isPseudoSpatialReference:Q,keyProperties:K,extent:Y,colormap:V,statistics:O?O.statistics:null});M?.length&&(Q.nativeExtent=new d({xmin:-.5,ymin:.5-v,xmax:t-.5,ymax:.5,spatialReference:A}),Q.transform=new r({polynomialOrder:1,forwardCoefficients:[M[2]+M[0]/2,M[5]-M[3]/2,M[0],M[3],-M[1],-M[4]]}),Q.extent=Q.transform.forwardTransform(Q.nativeExtent),Q.pixelSize=new n({x:(Y.xmax-Y.xmin)/t,y:(Y.ymax-Y.ymin)/v,spatialReference:A}),W.origin.x=-.5,
W.origin.y=.5);return{imageInfo:e,rasterInfo:Q}};g._processPAMInfo=function(a,e){e.statistics=a.statistics??e.statistics;(e.histograms=a.histograms)&&p.isNone(e.statistics)&&(e.statistics=h.estimateStatisticsFromHistograms(a.histograms));if(a.transform&&p.isNone(e.transform)){e.transform=a.transform;e.nativeExtent=e.extent;const t=e.transform.forwardTransform(e.nativeExtent);e.pixelSize=new n({x:(t.xmax-t.xmin)/e.width,y:(t.ymax-t.ymin)/e.height,spatialReference:e.spatialReference});e.extent=t}e.isPseudoSpatialReference&&
a.spatialReference&&(e.spatialReference=a.spatialReference)};g._readIFDs=function(){var a=P._asyncToGenerator(function*(e,t,v,w,y,G=4,C){if(!w)return null;if(w>=t.byteLength||0>w)t=(yield this.request(this.url,{range:{from:w+y,to:w+y+this._bufferSize},responseType:"array-buffer",signal:C})).data,y=w+y,w=0;w=yield this._readIFD(t,v,w,y,m.TIFF_TAGS,G,C);e.push(w.ifd);if(!w.nextIFD)return null;yield this._readIFDs(e,t,v,w.nextIFD-y,y,G,C)});return function(e,t,v,w,y){return a.apply(this,arguments)}}();
g._readIFD=function(){var a=P._asyncToGenerator(function*(e,t,v,w,y=m.TIFF_TAGS,G=4,C){if(!e)return null;v=c.parseIFD(e,t,v,w,y,G);if(v.success){const u=[];v.ifd?.forEach(z=>{z.values||u.push(z)});0<u.length&&(G=u.map(z=>z.offlineOffsetSize).filter(p.isSome),y=Math.min.apply(null,G.map(z=>z[0])),Math.min.apply(null,G.map(z=>z[0]+z[1]))-y<=this._bufferSize&&({data:G}=yield this.request(this.url,{range:{from:y,to:y+this._bufferSize},responseType:"array-buffer",signal:C}),e=G,w=y,u.forEach(z=>c.parseFieldValues(e,
t,z,w))));v.ifd?.has("GEOKEYDIRECTORY")&&(y=v.ifd.get("GEOKEYDIRECTORY"),(G=y?.values)&&4<G.length&&(G=G[0]+"."+G[1]+"."+G[2],C=yield this._readIFD(e,t,y.valueOffset+6-w,w,m.GEO_KEYS,2,C),y.data=C.ifd,y.data&&y.data.set("GEOTIFFVersion",{id:0,type:2,valueCount:1,valueOffset:null,values:[G]})));return v}if(v.requiredBufferSize&&v.requiredBufferSize!==e.byteLength)return e=(yield this.request(this.url,{range:{from:w,to:w+v.requiredBufferSize+4},responseType:"array-buffer",signal:C})).data,e.byteLength<
v.requiredBufferSize?null:this._readIFD(e,t,0,w,m.TIFF_TAGS,4,C)});return function(e,t,v,w){return a.apply(this,arguments)}}();g._fetchRawTiffTile=function(){var a=P._asyncToGenerator(function*(e,t,v,w,y={}){t=this._getTileLocation(e,t,v,w);if(!t)return null;const {ranges:G,actualTileWidth:C,actualTileHeight:u,ifd:z}=t;t=G.map(X=>this.request(this.url,{range:X,responseType:"array-buffer",signal:y.signal}));t=yield Promise.all(t);v=t.map(X=>X.data.byteLength).reduce((X,M)=>X+M);v=1===t.length?t[0].data:
new ArrayBuffer(v);w=[0];var L=[0];if(1<t.length){const X=new Uint8Array(v);for(let M=0,O=0;M<t.length;M++){const A=t[M].data;X.set(new Uint8Array(A),O);w[M]=O;O+=A.byteLength;L[M]=A.byteLength}}const {blockWidth:S,blockHeight:Z}=this.getBlockWidthHeight(e);e=yield this.decodePixelBlock(v,{format:"tiff",customOptions:{headerInfo:this._headerInfo,ifd:z,offsets:w,sizes:L},width:S,height:Z,planes:null,pixelType:null});if(null==e)return null;if(C!==S||u!==Z)if(L=e.mask)for(t=0;t<Z;t++)for(w=t*S,v=t<u?
C:0;v<S;v++)L[w+v]=0;else for(L=new Uint8Array(S*Z),e.mask=L,t=0;t<u;t++)for(w=t*S,v=0;v<C;v++)L[w+v]=1;return e});return function(e,t,v,w){return a.apply(this,arguments)}}();g._getTileLocation=function(a,e,t,v=!1){const {firstPyramidLevel:w,blockBoundary:y}=this.rasterInfo.storageInfo;var G=0===a?0:a-(w-1);({_headerInfo:a}=this);if(!a)return null;v=v?a.maskIFDs[G]:0===G?a?.ifds[0]:a?.pyramidIFDs[G-1];if(!v)return null;var C=c.isBSQConfig(v,a);a=v.get("TILEOFFSETS")?.values;if(void 0===a)return null;
var u=v.get("TILEBYTECOUNTS")?.values;const {minRow:z,minCol:L,maxRow:S,maxCol:Z}=y[G];if(e>S||t>Z||e<z||t<L)return null;G=v.get("IMAGEWIDTH")?.values?.[0];const X=v.get("IMAGELENGTH")?.values?.[0],M=v.get("TILEWIDTH")?.values?.[0],O=v.get("TILELENGTH")?.values?.[0],A=C?this.rasterInfo.bandCount:1,Q=A*e*(Z+1)+t,Y=[{from:a[Q],to:a[Q+A-1]+u[Q+A-1]-1}];if(C){C=!0;for(let W=0;W<A;W++)if(a[Q+W]+u[Q+W]!==a[Q+W+1]){C=!1;break}if(!C)for(C=0;C<A;C++)Y[C]={from:a[Q+C],to:a[Q+C]+u[Q+C]-1}}u=u[Q];return null==
a[Q]||null==u?null:{ranges:Y,ifd:v,actualTileWidth:t===Z?G%M||M:M,actualTileHeight:e===S?X%O||O:O}};g._fetchAuxiliaryMetaData=function(){var a=P._asyncToGenerator(function*(e){try{const {data:t}=yield this.request(this.url+".aux.xml",{responseType:"xml",signal:e?.signal});return f.parsePAMInfo(t)}catch{return null}});return function(e){return a.apply(this,arguments)}}();g._fetchAuxiliaryTable=function(){var a=P._asyncToGenerator(function*(e){try{const {data:t}=yield this.request(this.url+".vat.dbf",
{responseType:"array-buffer",signal:e?.signal}),v=k.parse(t);return v?.recordSet?E.fromJSON(v.recordSet):null}catch{return null}});return function(e){return a.apply(this,arguments)}}();return q}(b);D.__decorate([R.property()],F.prototype,"_files",void 0);D.__decorate([R.property()],F.prototype,"_headerInfo",void 0);D.__decorate([R.property()],F.prototype,"_bufferSize",void 0);D.__decorate([R.property({type:String,json:{write:!0}})],F.prototype,"datasetFormat",void 0);return F=D.__decorate([N.subclass("esri.layers.support.rasterDatasets.TIFFRaster")],
F)})},"*noref":1}});
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../PopupTemplate ../rasterRenderers ../core/Error ../core/Logger ../core/maybe ../core/MultiOriginJSONSupport ../core/promiseUtils ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ./Layer ./mixins/ArcGISService ./mixins/BlendLayer ./mixins/CustomParametersMixin ./mixins/ImageryTileMixin ./mixins/OperationalLayer ./mixins/PortalLayer ./mixins/RefreshableLayer ./mixins/ScaleRangeLayer ./mixins/TemporalLayer ./support/commonProperties ./support/Field ./support/rasterEnums ./support/RasterFunction ./support/rasterDatasets/FunctionRaster ./support/rasterDatasets/RasterFactory ./support/rasterFunctions/rasterFunctionHelper ../support/popupUtils".split(" "),function(P,
D,F,I,p,R,U,H,N,B,l,b,k,f,c,m,h,r,E,J,d,n,x,q,g,a,e,t,v,w,y,G,C,u){H=function(z){function L(...Z){Z=z.call(this,...Z)||this;Z._primaryRasters=null;Z.bandIds=null;Z.interpolation=null;Z.legendEnabled=!0;Z.isReference=null;Z.listMode="show";Z.sourceJSON=null;Z.version=null;Z.type="imagery-tile";Z.operationalLayerType="ArcGISTiledImageServiceLayer";Z.popupEnabled=!0;Z.popupTemplate=null;Z.fields=null;return Z}P._inheritsLoose(L,z);var S=L.prototype;S.normalizeCtorArgs=function(Z,X){return"string"===
typeof Z?{url:Z,...X}:Z};S.load=function(Z){const X=U.isSome(Z)?Z.signal:null;this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service"]},Z).catch(N.throwIfAbortError).then(()=>this._openRaster(X)));return Promise.resolve(this)};S.readRenderer=function(Z,X,M){Z=I.read(X&&X.layerDefinition&&X.layerDefinition.drawingInfo&&X.layerDefinition.drawingInfo.renderer,M)||void 0;if(null!=Z)return Z};S.createPopupTemplate=function(Z){return u.createPopupTemplate({fields:this.rasterFields,
title:this.title},Z)};S.generateRasterInfo=function(){var Z=P._asyncToGenerator(function*(X,M){X=b.ensureClass(w,X);if(!X)return this._primaryRasters[0].rasterInfo;try{const O={raster:this._primaryRasters[0]};1<this._primaryRasters.length&&this._primaryRasters.forEach(Y=>O[Y.url]=Y);const A=C.create(X.toJSON(),O),Q=new y({rasterFunction:A});yield Q.open(M);return Q.rasterInfo}catch{return null}});return function(X,M){return Z.apply(this,arguments)}}();S.write=function(Z,X){const {raster:M}=this;if(this.loaded?
"RasterTileServer"===M.datasetFormat&&("Raster"===M.tileType||"Map"===M.tileType):this.url&&/\/ImageServer(\/|\/?$)/i.test(this.url))return z.prototype.write.call(this,Z,X);X&&X.messages&&X.messages.push(new p("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${`${X.origin}/${X.layerContainerType||"operational-layers"}`}'`,{layer:this}));return null};S._openRaster=function(){var Z=P._asyncToGenerator(function*(X){let M=!1;
if(this.raster)this.raster.rasterInfo||(yield this.raster.open()),"Function"===this.raster.datasetFormat?(M=!0,this._primaryRasters=this.raster.primaryRasters.rasters):this._primaryRasters=[this.raster],this.url=this.raster.url;else{var {rasterFunction:O}=this;const Q=[this.url];O&&C.getPrimaryRasterUrls(O.toJSON(),Q);var A=yield Promise.all(Q.map(W=>G.open({url:W,sourceJSON:this.sourceJSON,ioConfig:{sampling:"closest",...this.ioConfig,customFetchParameters:this.customParameters},signal:X})));const Y=
A.findIndex(W=>null==W);if(-1<Y)throw new p("imagery-tile-layer:open",`cannot open raster: ${Q[Y]}`);this._primaryRasters=A;if(O){const W={raster:this._primaryRasters[0]};1<this._primaryRasters.length&&this._primaryRasters.forEach(T=>W[T.url]=T);O=C.create(O.rasterFunctionDefinition??O.toJSON(),W);O=new y({rasterFunction:O});try{yield O.open(),this.raster=O}catch(T){O=R.getLogger(this.declaredClass),T instanceof p&&O.error("imagery-tile-layer:open",T.message),O.warn("imagery-tile-layer:open","the raster function cannot be applied and is removed"),
this._set("rasterFunction",null),this.raster=A[0]}}else this.raster=A[0]}A=this.raster.rasterInfo;if(!A)throw new p("imagery-tile-layer:load","cannot load resources on "+this.url);this._set("rasterInfo",M?A:this._primaryRasters[0].rasterInfo);this._set("spatialReference",A.spatialReference);this.sourceJSON=this.sourceJSON||this.raster.sourceJSON;null!=this.sourceJSON&&this.read("Map"===this.raster.tileType&&null!=this.sourceJSON.minLOD&&null!=this.sourceJSON.maxLOD?this.sourceJSON:{...this.sourceJSON,
minScale:0,maxScale:0},{origin:"service"});this.title||(this.title=this.raster.datasetName);"Map"===this.raster.tileType&&(this.popupEnabled=!1);this._configDefaultSettings();this.addHandles(B.watch(()=>this.customParameters,Q=>{this.raster&&(this.raster.ioConfig.customFetchParameters=Q)}))});return function(X){return Z.apply(this,arguments)}}();P._createClass(L,[{key:"defaultPopupTemplate",get:function(){return this.createPopupTemplate()}},{key:"rasterFields",get:function(){let Z=[new t({name:"Raster.ServicePixelValue",
alias:"Pixel Value",domain:null,editable:!1,length:50,type:"string"})];var {rasterInfo:X}=this,M=X?.attributeTable;if(M=U.isSome(M)?M.fields:null)M=M.filter(O=>"oid"!==O.type&&"value"!==O.name.toLowerCase()).map(O=>{const A=O.clone();A.name="Raster."+O.name;return A}),Z=Z.concat(M);M=X?.dataType;X=X?.multidimensionalInfo;"vector-magdir"!==M&&"vector-uv"!==M||!U.isSome(X)||(X=X.variables[0].unit?.trim(),Z.push(new t({name:"Raster.Magnitude",alias:"Magnitude"+(X?` (${X})`:""),domain:null,editable:!1,
type:"double"})),Z.push(new t({name:"Raster.Direction",alias:"Direction (\u00b0)",domain:null,editable:!1,type:"double"})));return Z}},{key:"renderer",set:function(Z){this._set("renderer",Z);this.updateRenderer()}}]);return L}(E.BlendLayer(g.ScaleRangeLayer(n.OperationalLayer(x.PortalLayer(J.CustomParametersMixin(d.ImageryTileMixin(a.TemporalLayer(r.ArcGISService(q.RefreshableLayer(H.MultiOriginJSONMixin(h)))))))))));D.__decorate([l.property()],H.prototype,"_primaryRasters",void 0);D.__decorate([l.property({type:[b.Integer],
json:{write:{overridePolicy(){return{enabled:!this.loaded||"Raster"===this.raster.tileType||"0,1,2"!==this.bandIds?.join(",")}}}}})],H.prototype,"bandIds",void 0);D.__decorate([l.property({json:{write:{overridePolicy(){return{enabled:!this.loaded||"Raster"===this.raster.tileType||"bilinear"!==this.interpolation}}}}}),f.enumeration(v.interpolationKebab)],H.prototype,"interpolation",void 0);D.__decorate([l.property(e.legendEnabled)],H.prototype,"legendEnabled",void 0);D.__decorate([l.property({type:Boolean,
json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],H.prototype,"isReference",void 0);D.__decorate([l.property({type:["show","hide"]})],H.prototype,"listMode",void 0);D.__decorate([l.property({json:{read:!0,write:!0}})],H.prototype,"blendMode",void 0);D.__decorate([l.property()],H.prototype,"sourceJSON",void 0);D.__decorate([l.property({readOnly:!0,json:{origins:{service:{read:{source:"currentVersion"}}}}})],H.prototype,"version",void 0);D.__decorate([l.property({readOnly:!0,json:{read:!1}})],
H.prototype,"type",void 0);D.__decorate([l.property({type:["ArcGISTiledImageServiceLayer"]})],H.prototype,"operationalLayerType",void 0);D.__decorate([l.property({type:Boolean,value:!0,json:{read:{source:"disablePopup",reader(z,L){return!L.disablePopup}},write:{target:"disablePopup",overridePolicy(){return{enabled:!this.loaded||"Raster"===this.raster.tileType}},writer(z,L,S){L[S]=!z}}}})],H.prototype,"popupEnabled",void 0);D.__decorate([l.property({type:F,json:{read:{source:"popupInfo"},write:{target:"popupInfo",
overridePolicy(){return{enabled:!this.loaded||"Raster"===this.raster.tileType}}}}})],H.prototype,"popupTemplate",void 0);D.__decorate([l.property({readOnly:!0})],H.prototype,"defaultPopupTemplate",null);D.__decorate([l.property({readOnly:!0,type:[t]})],H.prototype,"fields",void 0);D.__decorate([l.property({readOnly:!0,type:[t]})],H.prototype,"rasterFields",null);D.__decorate([l.property({types:I.rasterRendererTypes,json:{name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy(){const z=
"raster-stretch"===this.renderer?.type&&"none"===this.renderer.stretchType&&!this.renderer.useGamma;return{enabled:!this.loaded||"Raster"===this.raster.tileType||!z}}},origins:{"web-scene":{types:I.websceneRasterRendererTypes,name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy(z){return{enabled:z&&"vector-field"!==z.type&&"flow"!==z.type}}}}}}})],H.prototype,"renderer",null);D.__decorate([c.reader("renderer")],H.prototype,"readRenderer",null);return H=D.__decorate([m.subclass("esri.layers.ImageryTileLayer")],
H)});