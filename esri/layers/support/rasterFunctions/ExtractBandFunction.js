// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.26/esri/copyright.txt for details.
//>>built
define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ./bandIndexUtils ./BaseRasterFunction ./ExtractBandFunctionArguments ./pixelUtils".split(" "),function(r,h,m,n,d,y,t,u,v,w,x){d=function(q){function p(){var a=q.apply(this,arguments)||this;a.functionName="ExtractBand";a.functionArguments=null;
a.rasterArgumentNames=["raster"];return a}r._inheritsLoose(p,q);var k=p.prototype;k._bindSourceRasters=function(){var {sourceRasterInfos:a}=this;a=a[0];const {bandCount:b}=a,{bandIds:c,missingBandAction:l}=this.functionArguments;if(l===x.MissingBandAction.fail&&c.some(e=>0>e||e>=b))return{success:!1,supportsGPU:!1,error:"extract-band-function: invalid bandIds"};this.outputPixelType=this._getOutputPixelType("f32");a=a.clone();a.pixelType=this.outputPixelType;a.bandCount=c.length;const {statistics:f,
histograms:g}=a;m.isSome(f)&&f.length&&(a.statistics=c.map(e=>f[e]||f[f.length-1]));m.isSome(g)&&g.length&&(a.histograms=c.map(e=>g[e]||g[g.length-1]));this.rasterInfo=a;return{success:!0,supportsGPU:3>=a.bandCount}};k._processPixels=function(a){a=a.pixelBlocks?.[0];if(m.isNone(a))return null;const b=a.pixels.length,c=this.functionArguments.bandIds.map(l=>l>=b?b-1:l);return a.extractBands(c)};k._getWebGLParameters=function(){let a;if(this.isInputBandIdsSwizzled)a=this.swizzledBandSelection.length?
this.swizzledBandSelection:[0,1,2];else{a=[...this.functionArguments.bandIds];0===a.length?a=[0,1,2]:3>a.length&&(a[1]=a[1]??a[0],a[2]=a[2]??a[1]);for(let b=0;3>b;b++)a[b]=Math.min(a[b],2)}return{bandIndexMat3:u.getBandMatrix3(a)}};k._getInputBandIds=function(a){const b=a.length;return this.functionArguments.bandIds.map(c=>c>=b?b-1:c).map(c=>a[c])};return p}(v);h.__decorate([n.property({json:{write:!0,name:"rasterFunction"}})],d.prototype,"functionName",void 0);h.__decorate([n.property({type:w,json:{write:!0,
name:"rasterFunctionArguments"}})],d.prototype,"functionArguments",void 0);h.__decorate([n.property()],d.prototype,"rasterArgumentNames",void 0);return d=h.__decorate([t.subclass("esri.layers.support.rasterFunctions.ExtractBandFunction")],d)});