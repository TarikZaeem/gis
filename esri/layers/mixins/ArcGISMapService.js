// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.26/esri/copyright.txt for details.
//>>built
define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../request ../../core/promiseUtils ../../core/urlUtils ../../core/Version ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../geometry/Extent ../../geometry/SpatialReference ../support/commonProperties".split(" "),function(p,m,e,w,x,y,z,g,I,J,q,A,B,C,r){p.ArcGISMapService=
c=>{c=function(t){function n(){var a=t.apply(this,arguments)||this;a.capabilities=void 0;a.copyright=null;a.fullExtent=null;a.legendEnabled=!0;a.spatialReference=null;a.version=void 0;a._allLayersAndTablesPromise=null;a._allLayersAndTablesMap=null;return a}m._inheritsLoose(n,t);var h=n.prototype;h.readCapabilities=function(a,b){var d=b.capabilities&&b.capabilities.split(",").map(D=>D.toLowerCase().trim());if(!d)return{operations:{supportsExportMap:!1,supportsExportTiles:!1,supportsIdentify:!1,supportsQuery:!1,
supportsTileMap:!1},exportMap:null,exportTiles:null};var f=this.type;a="tile"!==f&&!!b.supportsDynamicLayers;const k=d.includes("query"),u=d.includes("map"),v=!!b.exportTilesAllowed,E=d.includes("tilemap");d=d.includes("data");const F="tile"!==f&&(!b.tileInfo||a),G="tile"!==f&&(!b.tileInfo||a);f="tile"!==f;var l=b.cimVersion&&z.Version.parse(b.cimVersion);const H=l?.since(1,4)??!1;l=l?.since(2,0)??!1;return{operations:{supportsExportMap:u,supportsExportTiles:v,supportsIdentify:k,supportsQuery:d,supportsTileMap:E},
exportMap:u?{supportsArcadeExpressionForLabeling:H,supportsSublayersChanges:f,supportsDynamicLayers:a,supportsSublayerVisibility:F,supportsSublayerDefinitionExpression:G,supportsCIMSymbols:l}:null,exportTiles:v?{maxExportTilesCount:+b.maxExportTilesCount}:null}};h.readVersion=function(a,b){(a=b.currentVersion)||(a=b.hasOwnProperty("capabilities")||b.hasOwnProperty("tables")?10:b.hasOwnProperty("supportedImageFormatTypes")?9.31:9.3);return a};h.fetchSublayerInfo=function(){var a=m._asyncToGenerator(function*(b,
d){try{return yield this.fetchAllLayersAndTables(d),this._allLayersAndTablesMap?.get(b)}catch{}});return function(b,d){return a.apply(this,arguments)}}();h.fetchAllLayersAndTables=function(){var a=m._asyncToGenerator(function*(b){yield this.load(b);this._allLayersAndTablesPromise||(this._allLayersAndTablesPromise=w(y.urlToObject(this.url).path+"/layers",{responseType:"json",query:{f:"json",...this.customParameters,token:this.apiKey}}).then(f=>{this._allLayersAndTablesMap=new Map;for(const k of f.data.layers)this._allLayersAndTablesMap.set(k.id,
k);return{result:f.data}},f=>({error:f})));const d=yield this._allLayersAndTablesPromise;x.throwIfAborted(b);if("result"in d)return d.result;throw d.error;});return function(b){return a.apply(this,arguments)}}();return n}(c);e.__decorate([g.property({readOnly:!0})],c.prototype,"capabilities",void 0);e.__decorate([q.reader("service","capabilities",["capabilities","exportTilesAllowed","maxExportTilesCount","supportsDynamicLayers","tileInfo"])],c.prototype,"readCapabilities",null);e.__decorate([g.property({json:{read:{source:"copyrightText"}}})],
c.prototype,"copyright",void 0);e.__decorate([g.property({type:B})],c.prototype,"fullExtent",void 0);e.__decorate([g.property(r.id)],c.prototype,"id",void 0);e.__decorate([g.property({type:Boolean,json:{origins:{service:{read:{enabled:!1}}},read:{source:"showLegend"},write:{target:"showLegend"}}})],c.prototype,"legendEnabled",void 0);e.__decorate([g.property(r.popupEnabled)],c.prototype,"popupEnabled",void 0);e.__decorate([g.property({type:C})],c.prototype,"spatialReference",void 0);e.__decorate([g.property({readOnly:!0})],
c.prototype,"version",void 0);e.__decorate([q.reader("version",["currentVersion","capabilities","tables","supportedImageFormatTypes"])],c.prototype,"readVersion",null);return c=e.__decorate([A.subclass("esri.layers.mixins.ArcGISMapService")],c)};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})});