// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.26/esri/copyright.txt for details.
//>>built
define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Handles ../../../../../chunks/vec3 ../../../../../chunks/vec3f64 ./Manipulation ./utils ../../../../draw/support/drawUtils ../../../../interactive/dragEventPipeline ../../../../interactive/GraphicManipulator ../../../../interactive/editGeometry/interfaces ../../../../interactive/editGeometry/operations/UpdateVertices ../../../../interactive/editGeometry/support/editPlaneUtils".split(" "),function(k,t,u,v,w,l,x,y,m,
z,n,A,B){let E=function(p){function g(c){var a=p.call(this)||this;a._handles=new u;a._originCache=w.create();a._view=c.view;a._tool=c.tool;a._graphic=c.graphic;a._snapRotation=c.snapRotation;a._manipulator=a._createManipulator();a._handles.add([a._manipulator.events.on("grab-changed",d=>x.onGrabChangedHandle(d,a._manipulator))]);a.forEachManipulator(d=>a._tool.manipulators.add(d));return a}t._inheritsLoose(g,p);var f=g.prototype;f.destroy=function(){this._handles.destroy();this.forEachManipulator(c=>
{this._tool.manipulators.remove(c);c.destroy()});this._originCache=this._handles=this._graphic=this._snapRotation=this._manipulator=this._view=this._tool=null};f.forEachManipulator=function(c){c(this._manipulator,l.ManipulatorType.ROTATE)};f.createDragPipeline=function(c,a){let d=null,h=null;return m.createManipulatorDragEventPipeline(this._manipulator,(q,C)=>{C.next(b=>{if("start"===b.action){q.cursor="grabbing";const e=c();d=e.plane;h=e.editGeometryOperations}return b}).next(m.screenToMap(this._view)).next(b=>
({...b,rotateAngle:y.getRotationAngle(b.mapStart,b.mapEnd,{x:d.origin[0],y:d.origin[1]},!0)})).next(this._snapRotation.createDragEventPipelineStep(),this._snapRotation.next).next(b=>{var e=v.copy(this._originCache,d.origin);const r=[];for(const D of h.data.components)r.push(...D.vertices);e=h.rotateVertices(r,e,b.rotateAngle,"start"===b.action?n.AccumulationBehaviour.NEW_STEP:n.AccumulationBehaviour.ACCUMULATE_STEPS,A.AccumulationType.REPLACE);B.apply(e,d);a(b,e);return b}).next(b=>{"end"===b.action&&
(q.cursor="grab");return b})})};f._createManipulator=function(){return new z.GraphicManipulator({view:this._view,graphic:this._graphic,selectable:!0,cursor:"grab"})};return g}(l.Manipulation);k.RotateManipulation=E;Object.defineProperty(k,Symbol.toStringTag,{value:"Module"})});