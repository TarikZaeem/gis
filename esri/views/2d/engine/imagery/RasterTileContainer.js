// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.26/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../geometry/support/aaBoundingRect ../../viewpointUtils ./BrushRasterBitmap ./RasterTile ../webgl/enums ../webgl/TileContainer".split(" "),function(m,p,q,r,t,u,n,h){h=function(f){function k(){var a=f.apply(this,arguments)||this;a.isCustomTilingScheme=!1;return a}p._inheritsLoose(k,f);var g=k.prototype;g.createTile=function(a){const b=this._getTileBounds(a),[c,e]=this._tileInfoView.tileInfo.size,d=this._tileInfoView.getTileResolution(a.level);
return new u.RasterTile(a,d,b[0],b[3],c,e)};g.prepareRenderPasses=function(a){const b=a.registerRenderPass({name:"imagery (tile)",brushes:[t],target:()=>this.children.map(c=>c.bitmap),drawPhase:n.WGLDrawPhase.MAP});return[...f.prototype.prepareRenderPasses.call(this,a),b]};g.doRender=function(a){if(this.visible&&a.drawPhase===n.WGLDrawPhase.MAP){var {rasterFunctionChain:b}=this;if(b){var [c,e]=this._tileInfoView.tileInfo.size;a.renderPass="raster";a.rasterFunction={name:"Reproject",parameters:{targetImageSize:[c,
e]},pixelType:"f32",id:0,isNoopProcess:!1};f.prototype.doRender.call(this,a);if(b?.functions.length){const {functions:d,hasBranches:v}=b;for(b=0;b<d.length;b++){const l=d[b];"Constant"!==l.name&&"Identity"!==l.name&&(a.renderPass="raster",a.rasterFunction=l,a.hasBranches=v,f.prototype.doRender.call(this,a))}}a.rasterFunction=null;a.renderPass="bitmap"}else a.renderPass="raster-bitmap";f.prototype.doRender.call(this,a)}};g._getTileBounds=function(a){const b=this._tileInfoView.getTileBounds(q.create(),
a);if(this.isCustomTilingScheme&&a.world){var {tileInfo:c}=this._tileInfoView,e=r.getWorldWidth(c.spatialReference);if(e){var d=c.lodAt(a.level);if(!d)return b;({resolution:d}=d);c=(e=e/d%c.size[0])?(c.size[0]-e)*d:0;b[0]-=c*a.world;b[2]-=c*a.world}}return b};return k}(h);m.RasterTileContainer=h;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})});