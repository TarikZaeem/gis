// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.26/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/2d/engine/Stage":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/Error ../../../core/events ../../../core/has ../../../core/maybe ../../../core/scheduling ../../../chunks/mat3f32 ../../../symbols/cim/CIMResourceManager ./Container ./webgl/BufferPool ./webgl/enums ./webgl/Painter ./webgl/Profiler ../support/Timeline ../../support/screenshotUtils ../../webgl/context-util ../../webgl/enums ../../webgl/FramebufferObject ../../webgl/RenderingContext ../../../core/imageUtils".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d,a,c,f,g,n,k,x,r,v,q){let y=function(A){function w(C,E){var F=A.call(this)||this;F._trash=new Set;F._renderRemainingTime=0;F._lastFrameRenderTime=0;F.renderRequested=!1;F.stage=p._assertThisInitialized(F);F._stationary=!0;const {canvas:G=document.createElement("canvas"),alpha:H=!0,stencil:L=!0,contextOptions:K={}}=E;F._canvas=G;const M=k.createContextOrErrorHTML("2d",G,{alpha:H,antialias:!1,depth:!0,stencil:L});F.context=new v.RenderingContext(t.unwrap(M)??null,K);F.resourceManager=
new e;F.painter=new c(F.context,p._assertThisInitialized(F),F.resourceManager);u("esri-2d-profiler")&&(F._debugOutput=document.createElement("div"),F._debugOutput.setAttribute("style","margin: 24px 64px; position: absolute; color: red;"),C.appendChild(F._debugOutput));F._renderParameters={drawPhase:0,state:F.state,pixelRatio:window.devicePixelRatio,stationary:!1,globalOpacity:1,blendMode:null,deltaTime:-1,time:0,inFadeTransition:!1,effects:null,context:F.context,painter:F.painter,timeline:E.timeline||
new g.Timeline,renderingOptions:E.renderingOptions,requestRender:()=>F.requestRender(),allowDelayedRender:!1,requireFBO:!1,profiler:new f.Profiler(F.context,F._debugOutput),dataUploadCounter:0,get highlightGradient(){return F._highlightGradient}};F._taskHandle=h.addFrameTask({render:U=>F.renderFrame(U)});F._taskHandle.pause();F._lostWebGLContextHandle=B.on(G,"webglcontextlost",()=>{F.emit("webgl-error",{error:new D("webgl-context-lost")})});F._bufferPool=new d.BufferPool;G.setAttribute("style","width: 100%; height:100%; display:block;");
C.appendChild(G);return F}p._inheritsLoose(w,A);var z=w.prototype;z.destroy=function(){this.removeAllChildren();this._emptyTrash();this._taskHandle=t.removeMaybe(this._taskHandle);this._lostWebGLContextHandle=t.removeMaybe(this._lostWebGLContextHandle);this._canvas.parentNode?.removeChild(this._canvas);this._debugOutput?.parentNode?.removeChild(this._debugOutput);this._bufferPool.destroy();this.resourceManager.destroy();this.painter.dispose();this.context.dispose();this._canvas=null};z.trashDisplayObject=
function(C){this._trash.add(C);this.requestRender()};z.untrashDisplayObject=function(C){return this._trash.delete(C)};z.requestRender=function(){this._renderRemainingTime=2E3;this.renderRequested||(this.renderRequested=!0,this.emit("will-render"),this._taskHandle.resume())};z.renderFrame=function(C){this._renderRemainingTime-=this._lastFrameRenderTime?C.time-this._lastFrameRenderTime:0;0>=this._renderRemainingTime&&this._taskHandle.pause();this._lastFrameRenderTime=C.time;this.renderRequested=!1;
this._renderParameters.state=this._state;this._renderParameters.stationary=this.stationary;this._renderParameters.pixelRatio=window.devicePixelRatio;this._renderParameters.globalOpacity=1;this._renderParameters.time=C.time;this._renderParameters.deltaTime=C.deltaTime;this._renderParameters.effects=null;this.processRender(this._renderParameters);this._emptyTrash();this.emit("post-render")};z._createTransforms=function(){return{dvs:l.create()}};z.renderChildren=function(C){for(const E of this.children)E.beforeRender(C);
this._renderChildren(this.children,C);for(const E of this.children)E.afterRender(C)};z._renderChildren=function(C,E){const F=this.context;this.painter.textureUploadManager.upload();F.resetInfo();E.profiler.recordStart("drawLayers");E.dataUploadCounter=0;E.drawPhase=a.WGLDrawPhase.MAP;this.painter.beforeRenderLayers(F,this.background);for(const G of C)G.processRender(E);this.painter.prepareDisplay(E,this.background,this.state.padding);this.painter.renderLayers(F);E.drawPhase=a.WGLDrawPhase.HIGHLIGHT;
this.painter.beforeRenderLayers(F);for(const G of C)G.processRender(E);this.painter.renderLayers(F);if(this._isLabelDrawPhaseRequired(C)){E.drawPhase=a.WGLDrawPhase.LABEL;this.painter.beforeRenderLayers(F);for(const G of C)G.processRender(E);this.painter.renderLayers(F)}if(u("esri-tiles-debug")){E.drawPhase=a.WGLDrawPhase.DEBUG;this.painter.beforeRenderLayers(F);for(const G of C)G.processRender(E);this.painter.renderLayers(F)}E.profiler.recordEnd("drawLayers");F.logInfo()};z.doRender=function(C){const E=
this.context,{state:F,pixelRatio:G}=C;this._resizeCanvas(C);E.setViewport(0,0,G*F.size[0],G*F.size[1]);E.setDepthWriteEnabled(!0);E.setStencilWriteMask(255);A.prototype.doRender.call(this,C)};z.takeScreenshot=function(){var C=p._asyncToGenerator(function*(E){const {framebufferWidth:F,framebufferHeight:G}={framebufferWidth:Math.round(this.state.size[0]*E.resolutionScale),framebufferHeight:Math.round(this.state.size[1]*E.resolutionScale)};var H=E.resolutionScale,L=this.context,K=this._state.clone();
if(null!=E.rotation){var M=K.viewpoint;K.viewpoint.rotation=E.rotation;K.viewpoint=M}M={...this._renderParameters,drawPhase:null,globalOpacity:1,stationary:!0,state:K,pixelRatio:H,time:performance.now(),deltaTime:0,blendMode:null,effects:null,inFadeTransition:!1};const U=new r.FramebufferObject(L,{colorTarget:x.TargetType.TEXTURE,depthStencilTarget:x.DepthStencilTargetType.DEPTH_STENCIL_RENDER_BUFFER,width:F,height:G});H=L.getBoundFramebufferObject();K=L.getViewport();L.bindFramebuffer(U);L.setViewport(0,
0,F,G);this._renderChildren(E.children,M);M=this._readbackScreenshot(U,{...E.cropArea,y:G-(E.cropArea.y+E.cropArea.height)});L.bindFramebuffer(H);L.setViewport(K.x,K.y,K.width,K.height);this.requestRender();L=yield M;1===E.outputScale?E=L:(E=new ImageData(Math.round(L.width*E.outputScale),Math.round(L.height*E.outputScale)),n.resampleHermite(L,E,!0));return E});return function(E){return C.apply(this,arguments)}}();z._readbackScreenshot=function(){var C=p._asyncToGenerator(function*(E,F){const G=q.createEmptyImageData(F.width,
F.height,document.createElement("canvas"));yield E.readPixelsAsync(F.x,F.y,F.width,F.height,x.PixelFormat.RGBA,x.PixelType.UNSIGNED_BYTE,new Uint8Array(G.data.buffer));return G});return function(E,F){return C.apply(this,arguments)}}();z._resizeCanvas=function(C){const E=this._canvas,F=E.style,{state:{size:G},pixelRatio:H}=C;C=G[0];const L=G[1],K=Math.round(C*H),M=Math.round(L*H);if(E.width!==K||E.height!==M)E.width=K,E.height=M;F.width=C+"px";F.height=L+"px"};z._emptyTrash=function(){for(;0<this._trash.size;){const C=
Array.from(this._trash);this._trash.clear();for(const E of C)E.processDetach()}};z._isLabelDrawPhaseRequired=function(C){let E=!1;for(const F of C){if(!(F instanceof b.Container)){E=E||!1;break}if(F.hasLabels)return!0;E=E||this._isLabelDrawPhaseRequired(F.children)}return E};p._createClass(w,[{key:"background",get:function(){return this._background},set:function(C){this._background=C;this.requestRender()}},{key:"bufferPool",get:function(){return this._bufferPool}},{key:"renderingOptions",get:function(){return this._renderingOptions},
set:function(C){this._renderingOptions=C;this.requestRender()}},{key:"state",get:function(){return this._state},set:function(C){this._state=C;this.requestRender()}},{key:"stationary",get:function(){return this._stationary},set:function(C){this._stationary!==C&&(this._stationary=C,this.requestRender())}}]);return w}(b.Container);m.EXTRA_RENDER_TIME=2E3;m.Stage=y;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/CIMResourceManager":function(){define("../../chunks/_rollupPluginBabelHelpers ../../request ../../core/Error ../../core/promiseUtils ../../views/2d/engine/webgl/animatedFormats/apng ../../views/2d/engine/webgl/animatedFormats/gif".split(" "),
function(m,p,D,B,u,t){function h(c,f){return l.apply(this,arguments)}function l(){l=m._asyncToGenerator(function*(c,f){c=window.URL.createObjectURL(c);try{const {data:g}=yield p(c,{...f,responseType:"image"});return g}catch(g){if(!B.isAbortError(g))throw new D("mapview-invalid-resource",`Could not fetch requested resource at ${c}`);throw g;}finally{window.URL.revokeObjectURL(c)}});return l.apply(this,arguments)}function e(c,f){return b.apply(this,arguments)}function b(){b=m._asyncToGenerator(function*(c,
f){const {arrayBuffer:g,mediaType:n}=yield d(c,f);c="image/png"===n;if("image/gif"===n&&t.isAnimatedGIF(g))return t.parseGif(g,f);if(c&&u.isAnimatedPNG(g))return u.parseApng(g,f);c=new Blob([g],{type:n});return h(c,f)});return b.apply(this,arguments)}function d(c,f){return a.apply(this,arguments)}function a(){a=m._asyncToGenerator(function*(c,f){if(c.includes(";base64,")){f=c.indexOf(";base64,");var g=c.indexOf(";base64,")+8;g=c.substring(g);g=atob(g);var n=new Uint8Array(g.length);for(var k=0;k<
g.length;k++)n[k]=g.charCodeAt(k);g=n.buffer;c=c.substring(0,f).replace("data:","");g={arrayBuffer:g,mediaType:c}}else try{n=yield p(c,{responseType:"array-buffer",...f});k=n.data;const x=n.getHeader("Content-Type");g={arrayBuffer:k,mediaType:x}}catch(x){if(!B.isAbortError(x))throw new D("mapview-invalid-resource",`Could not fetch requested resource at ${c}`);}return g});return a.apply(this,arguments)}return function(){function c(){this._resourceMap=new Map;this._inFlightResourceMap=new Map;this.geometryEnginePromise=
this.geometryEngine=null}var f=c.prototype;f.destroy=function(){this._inFlightResourceMap.clear();this._resourceMap.clear()};f.getResource=function(g){return this._resourceMap.get(g)??null};f.fetchResource=function(){var g=m._asyncToGenerator(function*(n,k){var x=this._resourceMap.get(n);if(x)return{width:x.width,height:x.height};if(x=this._inFlightResourceMap.get(n))return x.then(r=>({width:r.width,height:r.height}));x=e(n,k);this._inFlightResourceMap.set(n,x);return x.then(r=>{this._inFlightResourceMap.delete(n);
this._resourceMap.set(n,r);return{width:r.width,height:r.height}},()=>({width:0,height:0}))});return function(n,k){return g.apply(this,arguments)}}();f.deleteResource=function(g){this._inFlightResourceMap.delete(g);this._resourceMap.delete(g)};return c}()})},"esri/views/2d/engine/webgl/animatedFormats/apng":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../chunks/index3","../../../../../core/promiseUtils","../../../../../core/time"],function(m,p,D,B,u){function t(){t=
p._asyncToGenerator(function*(e,b){e=D.parseApng3rdParty(e);if(e instanceof Error)throw e;yield e.createImages();B.throwIfAborted(b);const {frames:d,width:a,height:c}=e;b=document.createElement("canvas");b.width=a;b.height=c;b=b.getContext("2d",{willReadFrequently:!0});const f=[];e=[];for(const n of d){e.push(u.Milliseconds(n.delay||100));var g=n.imageElement;b.globalCompositeOperation=0===n.blendOp?"copy":"source-over";const k=2===n.disposeOp?b.getImageData(n.left,n.top,n.width,n.height):void 0;
b.drawImage(g,n.left,n.top);g=b.getImageData(0,0,a,c);f.push(g);0!==n.disposeOp&&(1===n.disposeOp?b.clearRect(n.left,n.top,n.width,n.height):2===n.disposeOp&&b.putImageData(k,n.left,n.top))}return{frameDurations:e,getFrame:n=>f[n],width:a,height:c}});return t.apply(this,arguments)}function h(e){const b=new Uint8Array(e);return!l.some((d,a)=>d!==b[a])}const l=[137,80,78,71,13,10,26,10];m.isAnimatedPNG=function(e){if(!h(e))return!1;const b=new DataView(e);e=new Uint8Array(e);let d=8,a;do{const c=b.getUint32(d);
a=String.fromCharCode.apply(String,Array.prototype.slice.call(e.subarray(d+4,d+8)));if("acTL"===a)return!0;d+=12+c}while("IEND"!==a&&d<e.length);return!1};m.isPNG=h;m.parseApng=function(e,b){return t.apply(this,arguments)};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/index3":function(){define(["exports","./_commonjsHelpers"],function(m,p){var D={};(function(u,t){(function(h,l){u.exports=l()})(p.commonjsGlobal,function(){return function(h){function l(b){if(e[b])return e[b].exports;
var d=e[b]={exports:{},id:b,loaded:!1};h[b].call(d.exports,d,d.exports,l);d.loaded=!0;return d.exports}var e={};l.m=h;l.c=e;l.p="";return l(0)}([function(h,l,e){function b(r,v){var q=new DataView(r.buffer),y=8,A=void 0,w=void 0,z=void 0;do w=q.getUint32(y),A=y+4,A=Array.prototype.slice.call(r.subarray(A,A+4)),A=String.fromCharCode.apply(String,A),z=v(A,r,y,w),y+=12+w;while(!1!==z&&"IEND"!=A&&y<r.length)}function d(r,v,q){var y=new Uint8Array(q);y.set(r.subarray(v,v+q));return y}Object.defineProperty(l,
"__esModule",{value:!0});l.isNotPNG=function(r){return r===f};l.isNotAPNG=function(r){return r===g};l.default=function(r){var v=new Uint8Array(r);if(Array.prototype.some.call(n,function(H,L){return H!==v[L]}))return f;var q=!1;b(v,function(H){return!(q="acTL"===H)});if(!q)return g;var y=[],A=[],w=null,z=null,C=0,E=new c.APNG;b(v,function(H,L,K,M){var U=new DataView(L.buffer);switch(H){case "IHDR":w=L.subarray(K+8,K+8+M);E.width=U.getUint32(K+8);E.height=U.getUint32(K+12);break;case "acTL":E.numPlays=
U.getUint32(K+8+4);break;case "fcTL":z&&(E.frames.push(z),C++);z=new c.Frame;z.width=U.getUint32(K+8+4);z.height=U.getUint32(K+8+8);z.left=U.getUint32(K+8+12);z.top=U.getUint32(K+8+16);H=U.getUint16(K+8+20);L=U.getUint16(K+8+22);0===L&&(L=100);z.delay=1E3*H/L;10>=z.delay&&(z.delay=100);E.playTime+=z.delay;z.disposeOp=U.getUint8(K+8+24);z.blendOp=U.getUint8(K+8+25);z.dataParts=[];0===C&&2===z.disposeOp&&(z.disposeOp=1);break;case "fdAT":z&&z.dataParts.push(L.subarray(K+8+4,K+8+M));break;case "IDAT":z&&
z.dataParts.push(L.subarray(K+8,K+8+M));break;case "IEND":A.push(d(L,K,12+M));break;default:y.push(d(L,K,12+M))}});z&&E.frames.push(z);if(0==E.frames.length)return g;var F=new Blob(y),G=new Blob(A);E.frames.forEach(function(H){var L=[];L.push(n);w.set(x(H.width),0);w.set(x(H.height),4);L.push(k("IHDR",w));L.push(F);H.dataParts.forEach(function(K){return L.push(k("IDAT",K))});L.push(G);H.imageData=new Blob(L,{type:"image/png"});delete H.dataParts;L=null});return E};var a=(h=e(1))&&h.__esModule?h:{default:h},
c=e(2),f=Error("Not a PNG"),g=Error("Not an animated PNG"),n=new Uint8Array([137,80,78,71,13,10,26,10]),k=function(r,v){var q=r.length+v.length,y=new Uint8Array(q+8),A=new DataView(y.buffer);A.setUint32(0,v.length);for(var w=y.set,z=new Uint8Array(r.length),C=0;C<r.length;C++)z[C]=r.charCodeAt(C);w.call(y,z,4);y.set(v,8);r=(0,a.default)(y,4,q);A.setUint32(q+4,r);return y},x=function(r){return new Uint8Array([r>>>24&255,r>>>16&255,r>>>8&255,r&255])}},function(h,l){Object.defineProperty(l,"__esModule",
{value:!0});l.default=function(d){var a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,c=-1,f=a;for(a+=2<arguments.length&&void 0!==arguments[2]?arguments[2]:d.length-a;f<a;f++)c=c>>>8^e[(c^d[f])&255];return c^-1};var e=new Uint32Array(256);for(h=0;256>h;h++){l=h;for(var b=0;8>b;b++)l=0!==(l&1)?3988292384^l>>>1:l>>>1;e[h]=l}},function(h,l,e){function b(c,f){if(!(c instanceof f))throw new TypeError("Cannot call a class as a function");}Object.defineProperty(l,"__esModule",{value:!0});l.Frame=
l.APNG=void 0;var d=function(){function c(f,g){for(var n=0;n<g.length;n++){var k=g[n];k.enumerable=k.enumerable||!1;k.configurable=!0;"value"in k&&(k.writable=!0);Object.defineProperty(f,k.key,k)}}return function(f,g,n){g&&c(f.prototype,g);n&&c(f,n);return f}}(),a=(h=e(3))&&h.__esModule?h:{default:h};l.APNG=function(){function c(){b(this,c);this.playTime=this.numPlays=this.height=this.width=0;this.frames=[]}d(c,[{key:"createImages",value:function(){return Promise.all(this.frames.map(function(f){return f.createImage()}))}},
{key:"getPlayer",value:function(f){var g=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!1;return this.createImages().then(function(){return new a.default(g,f,n)})}}]);return c}();l.Frame=function(){function c(){b(this,c);this.blendOp=this.disposeOp=this.delay=this.height=this.width=this.top=this.left=0;this.imageElement=this.imageData=null}d(c,[{key:"createImage",value:function(){var f=this;return this.imageElement?Promise.resolve():new Promise(function(g,n){var k=URL.createObjectURL(f.imageData);
f.imageElement=document.createElement("img");f.imageElement.onload=function(){URL.revokeObjectURL(k);g()};f.imageElement.onerror=function(){URL.revokeObjectURL(k);f.imageElement=null;n(Error("Image creation error"))};f.imageElement.src=k})}}]);return c}()},function(h,l,e){function b(a,c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,
configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}Object.defineProperty(l,"__esModule",{value:!0});var d=function(){function a(c,f){for(var g=0;g<f.length;g++){var n=f[g];n.enumerable=n.enumerable||!1;n.configurable=!0;"value"in n&&(n.writable=!0);Object.defineProperty(c,n.key,n)}}return function(c,f,g){f&&a(c.prototype,f);g&&a(c,g);return c}}();h=e(4);h=function(a){function c(f,g,n){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");
var k=(c.__proto__||Object.getPrototypeOf(c)).call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");k=!k||"object"!==typeof k&&"function"!==typeof k?this:k;k.playbackRate=1;k._currentFrameNumber=0;k._ended=!1;k._paused=!0;k._numPlays=0;k._apng=f;k.context=g;k.stop();n&&k.play();return k}b(c,a);d(c,[{key:"renderNextFrame",value:function(){this._currentFrameNumber=(this._currentFrameNumber+1)%this._apng.frames.length;this._currentFrameNumber===this._apng.frames.length-
1&&(this._numPlays++,0!==this._apng.numPlays&&this._numPlays>=this._apng.numPlays&&(this._paused=this._ended=!0));this._prevFrame&&1==this._prevFrame.disposeOp?this.context.clearRect(this._prevFrame.left,this._prevFrame.top,this._prevFrame.width,this._prevFrame.height):this._prevFrame&&2==this._prevFrame.disposeOp&&this.context.putImageData(this._prevFrameData,this._prevFrame.left,this._prevFrame.top);var f=this.currentFrame;this._prevFrame=f;this._prevFrameData=null;2==f.disposeOp&&(this._prevFrameData=
this.context.getImageData(f.left,f.top,f.width,f.height));0==f.blendOp&&this.context.clearRect(f.left,f.top,f.width,f.height);this.context.drawImage(f.imageElement,f.left,f.top);this.emit("frame",this._currentFrameNumber);this._ended&&this.emit("end")}},{key:"play",value:function(){var f=this;this.emit("play");this._ended&&this.stop();this._paused=!1;var g=performance.now()+this.currentFrame.delay/this.playbackRate;requestAnimationFrame(function x(k){if(!f._ended&&!f._paused){if(k>=g){for(;k-g>=f._apng.playTime/
f.playbackRate;)g+=f._apng.playTime/f.playbackRate,f._numPlays++;do f.renderNextFrame(),g+=f.currentFrame.delay/f.playbackRate;while(!f._ended&&k>g)}requestAnimationFrame(x)}})}},{key:"pause",value:function(){this._paused||(this.emit("pause"),this._paused=!0)}},{key:"stop",value:function(){this.emit("stop");this._numPlays=0;this._ended=!1;this._paused=!0;this._currentFrameNumber=-1;this.context.clearRect(0,0,this._apng.width,this._apng.height);this.renderNextFrame()}},{key:"currentFrameNumber",get:function(){return this._currentFrameNumber}},
{key:"currentFrame",get:function(){return this._apng.frames[this._currentFrameNumber]}},{key:"paused",get:function(){return this._paused}},{key:"ended",get:function(){return this._ended}}]);return c}((h&&h.__esModule?h:{default:h}).default);l.default=h},function(h,l){function e(){this._events=this._events||{};this._maxListeners=this._maxListeners||void 0}function b(a){return"function"===typeof a}function d(a){return"object"===typeof a&&null!==a}h.exports=e;e.EventEmitter=e;e.prototype._events=void 0;
e.prototype._maxListeners=void 0;e.defaultMaxListeners=10;e.prototype.setMaxListeners=function(a){if("number"!==typeof a||0>a||isNaN(a))throw TypeError("n must be a positive number");this._maxListeners=a;return this};e.prototype.emit=function(a){var c;this._events||(this._events={});if("error"===a&&(!this._events.error||d(this._events.error)&&!this._events.error.length)){var f=arguments[1];if(f instanceof Error)throw f;var g=Error('Uncaught, unspecified "error" event. ('+f+")");g.context=f;throw g;
}g=this._events[a];if(void 0===g)return!1;if(b(g))switch(arguments.length){case 1:g.call(this);break;case 2:g.call(this,arguments[1]);break;case 3:g.call(this,arguments[1],arguments[2]);break;default:f=Array.prototype.slice.call(arguments,1),g.apply(this,f)}else if(d(g)){f=Array.prototype.slice.call(arguments,1);var n=g.slice();g=n.length;for(c=0;c<g;c++)n[c].apply(this,f)}return!0};e.prototype.addListener=function(a,c){if(!b(c))throw TypeError("listener must be a function");this._events||(this._events=
{});this._events.newListener&&this.emit("newListener",a,b(c.listener)?c.listener:c);this._events[a]?d(this._events[a])?this._events[a].push(c):this._events[a]=[this._events[a],c]:this._events[a]=c;d(this._events[a])&&!this._events[a].warned&&(c=void 0!==this._maxListeners?this._maxListeners:e.defaultMaxListeners)&&0<c&&this._events[a].length>c&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",
this._events[a].length),"function"===typeof console.trace&&console.trace());return this};e.prototype.on=e.prototype.addListener;e.prototype.once=function(a,c){function f(){this.removeListener(a,f);g||(g=!0,c.apply(this,arguments))}if(!b(c))throw TypeError("listener must be a function");var g=!1;f.listener=c;this.on(a,f);return this};e.prototype.removeListener=function(a,c){if(!b(c))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;var f=this._events[a];
var g=f.length;var n=-1;if(f===c||b(f.listener)&&f.listener===c)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,c);else if(d(f)){for(;0<g--;)if(f[g]===c||f[g].listener&&f[g].listener===c){n=g;break}if(0>n)return this;1===f.length?(f.length=0,delete this._events[a]):f.splice(n,1);this._events.removeListener&&this.emit("removeListener",a,c)}return this};e.prototype.removeAllListeners=function(a){if(!this._events)return this;if(!this._events.removeListener)return 0===
arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(c in this._events)"removeListener"!==c&&this.removeAllListeners(c);this.removeAllListeners("removeListener");this._events={};return this}var c=this._events[a];if(b(c))this.removeListener(a,c);else if(c)for(;c.length;)this.removeListener(a,c[c.length-1]);delete this._events[a];return this};e.prototype.listeners=function(a){return this._events&&this._events[a]?b(this._events[a])?[this._events[a]]:
this._events[a].slice():[]};e.prototype.listenerCount=function(a){if(this._events){a=this._events[a];if(b(a))return 1;if(a)return a.length}return 0};e.listenerCount=function(a,c){return a.listenerCount(c)}}])})})({get exports(){return D},set exports(u){D=u}});const B=p.getDefaultExportFromCjs(D);m.parseApng3rdParty=B})},"esri/views/2d/engine/webgl/animatedFormats/gif":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/time","../../../../../geometry/support/meshUtils/exporters/gltf/imageutils",
"../../../../../chunks/index4"],function(m,p,D,B,u){function t(){t=p._asyncToGenerator(function*(e,b){e=u.parseGIF_1(e);var d=u.decompressFrames_1(e,!0);const {width:a,height:c}=e.lsd;e=document.createElement("canvas");e.width=a;e.height=c;e=e.getContext("2d",{willReadFrequently:!0});const f=[];b=[];for(const n of d){b.push(D.Milliseconds(n.delay||100));d=new ImageData(n.patch,n.dims.width,n.dims.height);var g=B.imageTypeToCanvas(d);d=3===n.disposalType?e.getImageData(n.dims.left,n.dims.top,n.dims.width,
n.dims.height):void 0;e.drawImage(g,n.dims.left,n.dims.top);g=e.getImageData(0,0,a,c);f.push(g);1!==n.disposalType&&(2===n.disposalType?e.clearRect(n.dims.left,n.dims.top,n.dims.width,n.dims.height):3===n.disposalType&&e.putImageData(d,n.dims.left,n.dims.top))}return{frameDurations:b,getFrame:n=>f[n],width:a,height:c}});return t.apply(this,arguments)}function h(e){const b=new Uint8Array(e);return!l.some((d,a)=>d!==b[a])}const l=[71,73,70];m.isAnimatedGIF=function(e){function b(){f++;c+=8;const n=
a.getUint8(c++);c+=n&128?3*2**((n&7)+1):0;c++;d()}function d(){let n;for(;n=a.getUint8(c++);)c+=n}if(!h(e))return!1;const a=new DataView(e);e=a.getUint8(10);let c=13+(e&128?3*2**((e&7)+1):0),f=0;for(e=!1;!e;){switch(a.getUint8(c++)){case 33:a:{switch(a.getUint8(c++)){case 249:c++;c+=4;d();break;case 1:f++;c++;c+=12;d();break;case 254:d();break;case 255:c++;c+=8;c+=3;d();break;default:var g=!1;break a}g=!0}if(!g)return!1;break;case 44:b();break;case 59:e=!0;break;default:return!1}if(1<f)return!0}return!1};
m.isGIF=h;m.parseGif=function(e,b){return t.apply(this,arguments)};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/meshUtils/exporters/gltf/imageutils":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../../../../../core/Error ../../../../../core/maybe ../../../../../core/urlUtils".split(" "),function(m,p,D,B,u,t){function h(){h=p._asyncToGenerator(function*(d){const a=b(d);if(u.isNone(a))throw new B("imageToArrayBuffer",
"Unsupported image type");const c=yield l(d);d=yield new Promise(f=>a.toBlob(f,c));if(!d)throw new B("imageToArrayBuffer","Failed to encode image");return{data:yield d.arrayBuffer(),type:c}});return h.apply(this,arguments)}function l(d){return e.apply(this,arguments)}function e(){e=p._asyncToGenerator(function*(d){if(!(d instanceof HTMLImageElement))return"image/png";d=d.src;return t.isDataProtocol(d)?(d=t.dataComponents(d),"image/jpeg"===d?.mediaType?d.mediaType:"image/png"):/\.png$/i.test(d)?"image/png":
/\.(jpg|jpeg)$/i.test(d)?"image/jpeg":"image/png"});return e.apply(this,arguments)}function b(d){if(d instanceof HTMLCanvasElement)return d;if(d instanceof HTMLVideoElement)return null;const a=document.createElement("canvas");a.width=d.width;a.height=d.height;const c=a.getContext("2d");d instanceof HTMLImageElement?c.drawImage(d,0,0,d.width,d.height):d instanceof ImageData&&c.putImageData(d,0,0);return a}m.encodeBase64DataUri=function(d){const a=[];d=new Uint8Array(d);for(let c=0;c<d.length;c++)a.push(String.fromCharCode(d[c]));
return"data:application/octet-stream;base64,"+btoa(a.join(""))};m.imageToArrayBuffer=function(d){return h.apply(this,arguments)};m.imageToDataURI=function(d){d=b(d);return u.isSome(d)?d.toDataURL():""};m.imageTypeToCanvas=b;m.isArrayBufferPNG=function(d){if(8>d.byteLength)return!1;d=new Uint8Array(d);return 137===d[0]&&80===d[1]&&78===d[2]&&71===d[3]&&13===d[4]&&10===d[5]&&26===d[6]&&10===d[7]};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/index4":function(){define(["exports"],
function(m){var p={},D={},B={};Object.defineProperty(B,"__esModule",{value:!0});B.loop=B.conditional=B.parse=void 0;B.parse=function g(c,f){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},k=3<arguments.length&&void 0!==arguments[3]?arguments[3]:n;if(Array.isArray(f))f.forEach(function(r){return g(c,r,n,k)});else if("function"===typeof f)f(c,n,k,g);else{var x=Object.keys(f)[0];Array.isArray(f[x])?(k[x]={},g(c,f[x],n,k[x])):k[x]=f[x](c,n,k,g)}return n};B.conditional=function(c,f){return function(g,
n,k,x){f(g,n,k)&&x(g,c,n,k)}};B.loop=function(c,f){return function(g,n,k,x){for(var r=[],v=g.pos;f(g,n,k);){var q={};x(g,c,n,q);if(g.pos===v)break;v=g.pos;r.push(q)}return r}};var u={};Object.defineProperty(u,"__esModule",{value:!0});u.readBits=u.readArray=u.readUnsigned=u.readString=u.peekBytes=u.readBytes=u.peekByte=u.readByte=u.buildStream=void 0;u.buildStream=function(c){return{data:c,pos:0}};var t=function(){return function(c){return c.data[c.pos++]}};u.readByte=t;u.peekByte=function(){var c=
0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return function(f){return f.data[f.pos+c]}};var h=function(c){return function(f){return f.data.subarray(f.pos,f.pos+=c)}};u.readBytes=h;u.peekBytes=function(c){return function(f){return f.data.subarray(f.pos,f.pos+c)}};u.readString=function(c){return function(f){return Array.from(h(c)(f)).map(function(g){return String.fromCharCode(g)}).join("")}};u.readUnsigned=function(c){return function(f){f=h(2)(f);return c?(f[1]<<8)+f[0]:(f[0]<<8)+f[1]}};
u.readArray=function(c,f){return function(g,n,k){n="function"===typeof f?f(g,n,k):f;k=h(c);for(var x=Array(n),r=0;r<n;r++)x[r]=k(g);return x}};u.readBits=function(c){return function(f){f=t()(f);for(var g=Array(8),n=0;8>n;n++)g[7-n]=!!(f&1<<n);return Object.keys(c).reduce(function(k,x){var r=c[x];if(r.length){for(var v=r.length,q=0,y=0;y<v;y++)q+=g[r.index+y]&&Math.pow(2,v-y-1);k[x]=q}else k[x]=g[r.index];return k},{})}};(function(c){Object.defineProperty(c,"__esModule",{value:!0});c["default"]=void 0;
var f={blocks:function(r){for(var v=[],q=r.data.length,y=0,A=(0,u.readByte)()(r);0!==A&&A;A=(0,u.readByte)()(r)){if(r.pos+A>=q){q-=r.pos;v.push((0,u.readBytes)(q)(r));y+=q;break}v.push((0,u.readBytes)(A)(r));y+=A}r=new Uint8Array(y);for(q=y=0;q<v.length;q++)r.set(v[q],y),y+=v[q].length;return r}},g=(0,B.conditional)({gce:[{codes:(0,u.readBytes)(2)},{byteSize:(0,u.readByte)()},{extras:(0,u.readBits)({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},
{delay:(0,u.readUnsigned)(!0)},{transparentColorIndex:(0,u.readByte)()},{terminator:(0,u.readByte)()}]},function(r){r=(0,u.peekBytes)(2)(r);return 33===r[0]&&249===r[1]}),n=(0,B.conditional)({image:[{code:(0,u.readByte)()},{descriptor:[{left:(0,u.readUnsigned)(!0)},{top:(0,u.readUnsigned)(!0)},{width:(0,u.readUnsigned)(!0)},{height:(0,u.readUnsigned)(!0)},{lct:(0,u.readBits)({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},(0,B.conditional)({lct:(0,u.readArray)(3,
function(r,v,q){return Math.pow(2,q.descriptor.lct.size+1)})},function(r,v,q){return q.descriptor.lct.exists}),{data:[{minCodeSize:(0,u.readByte)()},f]}]},function(r){return 44===(0,u.peekByte)()(r)}),k=(0,B.conditional)({text:[{codes:(0,u.readBytes)(2)},{blockSize:(0,u.readByte)()},{preData:function(r,v,q){return(0,u.readBytes)(q.text.blockSize)(r)}},f]},function(r){r=(0,u.peekBytes)(2)(r);return 33===r[0]&&1===r[1]}),x=(0,B.conditional)({application:[{codes:(0,u.readBytes)(2)},{blockSize:(0,u.readByte)()},
{id:function(r,v,q){return(0,u.readString)(q.blockSize)(r)}},f]},function(r){r=(0,u.peekBytes)(2)(r);return 33===r[0]&&255===r[1]});f=(0,B.conditional)({comment:[{codes:(0,u.readBytes)(2)},f]},function(r){r=(0,u.peekBytes)(2)(r);return 33===r[0]&&254===r[1]});g=[{header:[{signature:(0,u.readString)(3)},{version:(0,u.readString)(3)}]},{lsd:[{width:(0,u.readUnsigned)(!0)},{height:(0,u.readUnsigned)(!0)},{gct:(0,u.readBits)({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,
length:3}})},{backgroundColorIndex:(0,u.readByte)()},{pixelAspectRatio:(0,u.readByte)()}]},(0,B.conditional)({gct:(0,u.readArray)(3,function(r,v){return Math.pow(2,v.lsd.gct.size+1)})},function(r,v){return v.lsd.gct.exists}),{frames:(0,B.loop)([g,x,f,n,k],function(r){r=(0,u.peekByte)()(r);return 33===r||44===r})}];c["default"]=g})(D);var l={};Object.defineProperty(l,"__esModule",{value:!0});l.deinterlace=void 0;l.deinterlace=function(c,f){for(var g=Array(c.length),n=c.length/f,k=[0,4,2,1],x=[8,8,
4,2],r=0,v=0;4>v;v++)for(var q=k[v];q<n;q+=x[v]){var y=q,A=c.slice(r*f,(r+1)*f);g.splice.apply(g,[y*f,f].concat(A));r++}return g};var e={};Object.defineProperty(e,"__esModule",{value:!0});e.lzw=void 0;e.lzw=function(c,f,g){var n,k,x,r,v,q,y,A,w=Array(g),z=Array(4096),C=Array(4096),E=Array(4097);var F=1<<c;var G=F+1;var H=F+2;var L=-1;var K=c+1;var M=(1<<K)-1;for(k=0;k<F;k++)z[k]=0,C[k]=k;for(x=r=n=v=q=A=y=0;x<g;){if(0===q){if(n<K){r+=f[y]<<n;n+=8;y++;continue}k=r&M;r>>=K;n-=K;if(k>H||k==G)break;if(k==
F){K=c+1;M=(1<<K)-1;H=F+2;L=-1;continue}if(-1==L){E[q++]=C[k];v=L=k;continue}var U=k;k==H&&(E[q++]=v,k=L);for(;k>F;)E[q++]=C[k],k=z[k];v=C[k]&255;E[q++]=v;4096>H&&(z[H]=L,C[H]=v,H++,0===(H&M)&&4096>H&&(K++,M+=H));L=U}q--;w[A++]=E[q];x++}for(x=A;x<g;x++)w[x]=0;return w};Object.defineProperty(p,"__esModule",{value:!0});m.decompressFrames_1=p.decompressFrames=p.decompressFrame=m.parseGIF_1=p.parseGIF=void 0;var b=D&&D.__esModule?D:{default:D};m.parseGIF_1=p.parseGIF=function(c){c=new Uint8Array(c);return(0,B.parse)((0,u.buildStream)(c),
b["default"])};var d=function(c,f,g){if(c.image){var n=c.image,k=(0,e.lzw)(n.data.minCodeSize,n.data.blocks,n.descriptor.width*n.descriptor.height);n.descriptor.lct.interlaced&&(k=(0,l.deinterlace)(k,n.descriptor.width));k={pixels:k,dims:{top:c.image.descriptor.top,left:c.image.descriptor.left,width:c.image.descriptor.width,height:c.image.descriptor.height}};k.colorTable=n.descriptor.lct&&n.descriptor.lct.exists?n.lct:f;c.gce&&(k.delay=10*(c.gce.delay||10),k.disposalType=c.gce.extras.disposal,c.gce.extras.transparentColorGiven&&
(k.transparentIndex=c.gce.transparentColorIndex));if(g){c=k.pixels.length;f=new Uint8ClampedArray(4*c);for(g=0;g<c;g++){n=4*g;var x=k.pixels[g],r=k.colorTable[x]||[0,0,0];f[n]=r[0];f[n+1]=r[1];f[n+2]=r[2];f[n+3]=x!==k.transparentIndex?255:0}k.patch=f}return k}console.warn("gif frame does not have associated image.")};p.decompressFrame=d;m.decompressFrames_1=p.decompressFrames=function(c,f){return c.frames.filter(function(g){return g.image}).map(function(g){return d(g,c.gct,f)})}})},"esri/views/2d/engine/Container":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/mat3f32 ../../../layers/effects/EffectView ./DisplayObject ./webgl/effects/highlight/HighlightGradient".split(" "),
function(m,p,D,B,u,t){u=function(h){function l(){var b=h.apply(this,arguments)||this;b._childrenSet=new Set;b._needsSort=!1;b.children=[];b._effectView=null;b._highlightOptions=null;b._highlightGradient=null;return b}p._inheritsLoose(l,h);var e=l.prototype;e.updateTransitionProperties=function(b,d){h.prototype.updateTransitionProperties.call(this,b,d);this._effectView&&(this._effectView.transitionStep(b,d),this._effectView.transitioning&&this.requestRender())};e.doRender=function(b){b=this.createRenderParams(b);
this.renderChildren(b)};e.addChild=function(b){return this.addChildAt(b,this.children.length)};e.addChildAt=function(b,d=this.children.length){if(!b||this.contains(b))return b;this._needsSort=!0;const a=b.parent;a&&a!==this&&a.removeChild(b);d>=this.children.length?this.children.push(b):this.children.splice(d,0,b);this._childrenSet.add(b);b.parent=this;b.stage=this.stage;this!==this.stage&&(b.clips=this.clips);this.requestRender();return b};e.contains=function(b){return this._childrenSet.has(b)};
e.endTransitions=function(){h.prototype.endTransitions.call(this);this._effectView&&(this._effectView.endTransitions(),this.requestRender())};e.removeAllChildren=function(){this._childrenSet.clear();this._needsSort=!0;for(const b of this.children)this!==this.stage&&(b.clips=null),b.stage=null,b.parent=null;this.children.length=0};e.removeChild=function(b){return this.contains(b)?this.removeChildAt(this.children.indexOf(b)):b};e.removeChildAt=function(b){if(0>b||b>=this.children.length)return null;
this._needsSort=!0;b=this.children.splice(b,1)[0];this._childrenSet.delete(b);this!==this.stage&&(b.clips=null);b.stage=null;b.parent=null;return b};e.sortChildren=function(b){this._needsSort&&(this.children.sort(b),this._needsSort=!1)};e.beforeRender=function(b){h.prototype.beforeRender.call(this,b);for(const d of this.children)d.beforeRender(b)};e.afterRender=function(b){h.prototype.afterRender.call(this,b);for(const d of this.children)d.afterRender(b)};e._createTransforms=function(){return{dvs:D.create()}};
e.onAttach=function(){h.prototype.onAttach.call(this);const b=this.stage;for(const d of this.children)d.stage=b};e.onDetach=function(){h.prototype.onDetach.call(this);for(const b of this.children)b.stage=null};e.renderChildren=function(b){for(const d of this.children)d.processRender(b)};e.createRenderParams=function(b){return{...b,blendMode:this.blendMode,effects:this.computedEffects,globalOpacity:b.globalOpacity*this.computedOpacity,inFadeTransition:this.inFadeTransition,highlightGradient:this._highlightGradient||
b.highlightGradient}};p._createClass(l,[{key:"blendMode",get:function(){return this._blendMode},set:function(b){this._blendMode=b;this.requestRender()}},{key:"clips",get:function(){return this._clips},set:function(b){this._clips=b;this.children.forEach(d=>d.clips=b)}},{key:"computedEffects",get:function(){return this._effectView?.effects??null}},{key:"effect",get:function(){return this._effectView?.effect??""},set:function(b){if(this._effectView||b)this._effectView||(this._effectView=new B.EffectView),
this._effectView.effect=b,this.requestRender()}},{key:"highlightOptions",get:function(){return this._highlightOptions},set:function(b){b?this._highlightOptions&&this._highlightOptions.equals(b)||(this._highlightOptions=b,this._highlightGradient||(this._highlightGradient=new t),this._highlightGradient.setHighlightOptions(b),this.requestRender()):(this._highlightOptions=null,this._highlightGradient&&(this._highlightGradient.destroy(),this._highlightGradient=null,this.requestRender()))}}]);return l}(u.DisplayObject);
m.Container=u;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/effects/EffectView":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/has ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./parser ./utils".split(" "),function(m,p,D,B,u,t,h,l,e,b,d,a){function c(n){n=d.parse(n)||[];var k=
(k=n[0])?"type"in k:!1;return k?[{scale:-1,effects:n}]:n}function f(n,k,x){return n[0]?.effects&&k[0]?.effects?(-1===n[0]?.scale||-1===k[0]?.scale)&&(1<n.length||1<k.length)&&0>=x?!1:a.canInterpolateEffects(n[0].effects,k[0].effects):!0}function g(n,k,x){const r=n.length>k.length?n:k;n=n.length>k.length?k:n;var v=n[n.length-1];k=v?.scale??x;v=v?.effects??[];for(let q=n.length;q<r.length;q++)n.push({scale:k,effects:[...v]});for(k=0;k<r.length;k++)n[k].scale=-1===n[k].scale?x:n[k].scale,r[k].scale=
-1===r[k].scale?x:r[k].scale,a.normalizeEffects(n[k].effects,r[k].effects)}m.EffectView=function(n){function k(r){r=n.call(this,r)||this;r._from=null;r._to=null;r._final=null;r._current=[];r._time=0;r.duration=u("mapview-transitions-duration");r.effects=[];return r}p._inheritsLoose(k,n);var x=k.prototype;x.canTransitionTo=function(r){try{return 0<this.scale&&f(this._current,c(r),this.scale)}catch{return!1}};x.transitionStep=function(r,v){this._applyTimeTransition(r);this._updateForScale(v)};x.endTransitions=
function(){this._applyTimeTransition(this.duration)};x._transitionTo=function(r){0<this.scale&&f(this._current,r,this.scale)?(this._final=r,this._to=t.clone(r),g(this._current,this._to,this.scale),this._from=t.clone(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=r);this._set("effects",this._current[0]?t.clone(this._current[0].effects):[])};x._applyTimeTransition=function(r){if(this._to&&this._from&&this._current&&this._final){this._time+=r;r=Math.min(1,this._time/
this.duration);for(let q=0;q<this._current.length;q++){const y=this._current[q],A=this._from[q],w=this._to[q];var v=A.scale;y.scale=v+(w.scale-v)*r;for(v=0;v<y.effects.length;v++)y.effects[v].interpolate(A.effects[v],w.effects[v],r)}1===r&&(this._current=this._final,this._set("effects",this._current[0]?t.clone(this._current[0].effects):[]),this._from=this._to=this._final=null)}};x._updateForScale=function(r){this._set("scale",r);if(0!==this._current.length){var v=this._current,q=this._current.length-
1,y,A=1;if(1===v.length||r>=v[0].scale)var w=y=v[0].effects;else if(r<=v[q].scale)w=y=v[q].effects;else for(let z=0;z<q;z++){const C=v[z],E=v[z+1];if(C.scale>=r&&E.scale<=r){A=(r-C.scale)/(E.scale-C.scale);y=C.effects;w=E.effects;break}}for(r=0;r<this.effects.length;r++)this.effects[r].interpolate(y[r],w[r],A)}};p._createClass(k,[{key:"effect",set:function(r){const v=this._get("effect");r=r||"";if(v!==r){this._set("effect",r);try{this._transitionTo(c(r))}catch(q){this._transitionTo([]),h.getLogger(this.declaredClass).warn("Invalid Effect",
{effect:r,error:q})}}}},{key:"hasEffects",get:function(){return this.transitioning||!!this.effects.length}},{key:"scale",set:function(r){this._updateForScale(r)}},{key:"transitioning",get:function(){return null!==this._to}}]);return k}(B);D.__decorate([l.property()],m.EffectView.prototype,"_to",void 0);D.__decorate([l.property()],m.EffectView.prototype,"duration",void 0);D.__decorate([l.property({value:""})],m.EffectView.prototype,"effect",null);D.__decorate([l.property({readOnly:!0})],m.EffectView.prototype,
"effects",void 0);D.__decorate([l.property({readOnly:!0})],m.EffectView.prototype,"hasEffects",null);D.__decorate([l.property({value:0})],m.EffectView.prototype,"scale",null);D.__decorate([l.property({readOnly:!0})],m.EffectView.prototype,"transitioning",null);m.EffectView=D.__decorate([b.subclass("esri.layers.effects.EffectView")],m.EffectView);m.canInterpolateEffectStops=f;m.convertEffectToStops=c;m.normalizeEffectStops=g;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/DisplayObject":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/Evented ../../../core/has ../../../core/maybe ../../../core/promiseUtils".split(" "),
function(m,p,D,B,u,t){const h=1/B("mapview-transitions-duration");D=function(l){function e(){var d=l.apply(this,arguments)||this;d._fadeOutResolver=null;d._fadeInResolver=null;d._clips=null;d.computedVisible=!0;d.computedOpacity=1;d.fadeTransitionEnabled=!1;d.inFadeTransition=!1;d._isReady=!1;d._opacity=1;d.parent=null;d._stage=null;d._visible=!0;return d}p._inheritsLoose(e,l);var b=e.prototype;b._getTransforms=function(){u.isNone(this._transforms)&&(this._transforms=this._createTransforms());return this._transforms};
b.fadeIn=function(){if(this._fadeInResolver)return this._fadeInResolver.promise;this._fadeOutResolver&&(this._fadeOutResolver(),this._fadeOutResolver=null);this.opacity=1;this.computedOpacity=0;this.fadeTransitionEnabled=!0;this._fadeInResolver=t.createResolver();this.requestRender();return this._fadeInResolver.promise};b.fadeOut=function(){if(this._fadeOutResolver)return this._fadeOutResolver.promise;this.opacity=0;this._fadeInResolver&&(this._fadeInResolver(),this._fadeInResolver=null);this.fadeTransitionEnabled=
!0;this._fadeOutResolver=t.createResolver();this.requestRender();return this._fadeOutResolver.promise};b.endTransitions=function(){this._fadeInResolver?.();this._fadeInResolver=null;this._fadeOutResolver?.();this._fadeOutResolver=null;this.computedOpacity=this.visible?this.opacity:0;this.requestRender()};b.beforeRender=function(d){this.updateTransitionProperties(d.deltaTime,d.state.scale)};b.afterRender=function(d){this._fadeInResolver&&this.computedOpacity===this.opacity?(this._fadeInResolver(),
this._fadeInResolver=null):this._fadeOutResolver&&0===this.computedOpacity&&(this._fadeOutResolver(),this._fadeOutResolver=null)};b.remove=function(){this.parent?.removeChild(this)};b.setTransform=function(d){};b.processRender=function(d){this.stage&&this.computedVisible&&this.doRender(d)};b.requestRender=function(){this.stage&&this.stage.requestRender()};b.processDetach=function(){this._fadeInResolver&&(this._fadeInResolver(),this._fadeInResolver=null);this._fadeOutResolver&&(this._fadeOutResolver(),
this._fadeOutResolver=null);this.onDetach();this.emit("detach")};b.updateTransitionProperties=function(d,a){if(this.fadeTransitionEnabled){a=this._fadeOutResolver||!this.visible?0:this.opacity;const c=this.computedOpacity;c===a?this.computedVisible=this.visible:(d*=h,this.computedOpacity=c>a?Math.max(a,c-d):Math.min(a,c+d),this.computedVisible=0<this.computedOpacity,d=a===this.computedOpacity,this.inFadeTransition=!d,d||this.requestRender())}else this.computedOpacity=this.opacity,this.computedVisible=
this.visible};b.onAttach=function(){};b.onDetach=function(){};b.doRender=function(d){};b.ready=function(){this._isReady||(this._isReady=!0,this.emit("isReady"),this.requestRender())};p._createClass(e,[{key:"clips",get:function(){return this._clips},set:function(d){this._clips=d;this.requestRender()}},{key:"isReady",get:function(){return this._isReady}},{key:"opacity",get:function(){return this._opacity},set:function(d){this._opacity!==d&&(this._opacity=Math.min(1,Math.max(d,0)),this.requestRender())}},
{key:"stage",get:function(){return this._stage},set:function(d){if(this._stage!==d){var a=this._stage;(this._stage=d)?this._stage?.untrashDisplayObject(this)||(this.onAttach(),this.emit("attach")):a?.trashDisplayObject(this)}}},{key:"transforms",get:function(){return this._getTransforms()}},{key:"visible",get:function(){return this._visible},set:function(d){this._visible!==d&&(this._visible=d,this.requestRender())}}]);return e}(D);m.DisplayObject=D;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},
"esri/views/2d/engine/webgl/effects/highlight/HighlightGradient":function(){define(["../../../../../../core/Logger","../../definitions","./parameters","../../../../../webgl/enums","../../../../../webgl/Texture"],function(m,p,D,B,u){function t(e,b){b.fillColor[0]=e.color.r/255;b.fillColor[1]=e.color.g/255;b.fillColor[2]=e.color.b/255;b.fillColor[3]=e.color.a;e.haloColor?(b.outlineColor[0]=e.haloColor.r/255,b.outlineColor[1]=e.haloColor.g/255,b.outlineColor[2]=e.haloColor.b/255,b.outlineColor[3]=e.haloColor.a):
(b.outlineColor[0]=b.fillColor[0],b.outlineColor[1]=b.fillColor[1],b.outlineColor[2]=b.fillColor[2],b.outlineColor[3]=b.fillColor[3]);b.fillColor[3]*=e.fillOpacity;b.outlineColor[3]*=e.haloOpacity;b.fillColor[0]*=b.fillColor[3];b.fillColor[1]*=b.fillColor[3];b.fillColor[2]*=b.fillColor[3];b.outlineColor[0]*=b.outlineColor[3];b.outlineColor[1]*=b.outlineColor[3];b.outlineColor[2]*=b.outlineColor[3];b.outlineWidth=D.HIGHLIGHT_SIZING.outlineWidth;b.outerHaloWidth=D.HIGHLIGHT_SIZING.outerHaloWidth;b.innerHaloWidth=
D.HIGHLIGHT_SIZING.innerHaloWidth;b.outlinePosition=D.HIGHLIGHT_SIZING.outlinePosition}const h=m.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient"),l=[0,0,0,0];return function(){function e(){this._convertedHighlightOptions={fillColor:[.2*.75,.6*.75,.675,.75],outlineColor:[.2*.9,.54,.81,.9],outlinePosition:D.HIGHLIGHT_SIZING.outlinePosition,outlineWidth:D.HIGHLIGHT_SIZING.outlineWidth,innerHaloWidth:D.HIGHLIGHT_SIZING.innerHaloWidth,outerHaloWidth:D.HIGHLIGHT_SIZING.outerHaloWidth};
this._shadeTexChanged=!0;this._texelData=new Uint8Array(4*D.SHADE_TEXTURE_SIZE);this._minMaxDistance=[0,0]}var b=e.prototype;b.setHighlightOptions=function(d){function a(v,q,y){r[0]=(1-y)*v[0]+y*q[0];r[1]=(1-y)*v[1]+y*q[1];r[2]=(1-y)*v[2]+y*q[2];r[3]=(1-y)*v[3]+y*q[3]}const c=this._convertedHighlightOptions;t(d,c);d=c.outlinePosition-c.outlineWidth/2-c.outerHaloWidth;const f=c.outlinePosition-c.outlineWidth/2,g=c.outlinePosition+c.outlineWidth/2,n=c.outlinePosition+c.outlineWidth/2+c.innerHaloWidth;
var k=Math.sqrt(Math.PI/2)*D.SIGMA,x=Math.abs(d)>k?Math.round(10*(Math.abs(d)-k))/10:0;k=Math.abs(n)>k?Math.round(10*(Math.abs(n)-k))/10:0;x&&!k?h.error("The outer rim of the highlight is "+x+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!x&&k?h.error("The inner rim of the highlight is "+k+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):
x&&k&&h.error("The highlight is "+Math.max(x,k)+"px away from the edge of the feature; consider reducing some width values.");const r=[void 0,void 0,void 0,void 0];({_texelData:k}=this);for(let v=0;v<D.SHADE_TEXTURE_SIZE;++v)x=d+v/(D.SHADE_TEXTURE_SIZE-1)*(n-d),x<d?(r[4*v]=0,r[4*v+1]=0,r[4*v+2]=0,r[4*v+3]=0):x<f?a(l,c.outlineColor,(x-d)/(f-d)):x<g?[r[0],r[1],r[2],r[3]]=c.outlineColor:x<n?a(c.outlineColor,c.fillColor,(x-g)/(n-g)):[r[4*v],r[4*v+1],r[4*v+2],r[4*v+3]]=c.fillColor,k[4*v]=255*r[0],k[4*
v+1]=255*r[1],k[4*v+2]=255*r[2],k[4*v+3]=255*r[3];this._minMaxDistance[0]=d;this._minMaxDistance[1]=n;this._shadeTexChanged=!0};b.applyHighlightOptions=function(d,a){this._shadeTex||(this._shadeTex=new u.Texture(d,{target:B.TextureType.TEXTURE_2D,pixelFormat:B.PixelFormat.RGBA,dataType:B.PixelType.UNSIGNED_BYTE,wrapMode:B.TextureWrapMode.CLAMP_TO_EDGE,width:D.SHADE_TEXTURE_SIZE,height:1,samplingMode:B.TextureSamplingMode.LINEAR}));this._shadeTexChanged&&(this._shadeTex.updateData(0,0,0,D.SHADE_TEXTURE_SIZE,
1,this._texelData),this._shadeTexChanged=!1);d.bindTexture(this._shadeTex,p.TEXTURE_BINDING_HIGHLIGHT_1);a.setUniform2fv("u_minMaxDistance",this._minMaxDistance)};b.destroy=function(){this._shadeTex?.dispose();this._shadeTex=null};return e}()})},"esri/views/2d/engine/webgl/definitions":function(){define(["exports"],function(m){m.ANGLE_FACTOR_256=256/360;m.ATTRIBUTE_DATA_ANIMATION=1;m.ATTRIBUTE_DATA_DD0=3;m.ATTRIBUTE_DATA_DD1=4;m.ATTRIBUTE_DATA_FILTER_FLAGS=0;m.ATTRIBUTE_DATA_GPGPU=2;m.ATTRIBUTE_DATA_VV=
3;m.ATTRIBUTE_STORE_TEXTURE_SIZE=1024;m.AVERAGE_GLYPH_MOSAIC_ITEM={metrics:{width:15,height:17,left:0,top:-7,advance:14}};m.BITSET_FILL_HAS_UNRESOLVED_REPLACEMENT_COLOR=8;m.BITSET_FILL_RANDOM_PATTERN_OFFSET=4;m.BITSET_GENERIC_CONSIDER_ALPHA_ONLY=16;m.BITSET_GENERIC_LOCK_COLOR=2;m.BITSET_LINE_SCALE_DASH=4;m.BITSET_MARKER_ALIGNMENT_MAP=1;m.BITSET_MARKER_ALIGNMENT_SCREEN=0;m.BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE=4;m.BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY=8;m.BITSET_TYPE_FILL_OUTLINE=1;m.BUFFER_DATA_MINIMUM_SIZE=
128;m.BUFFER_DATA_POOL_SIZE=4;m.CHART_MAX_FIELDS=10;m.COLLISION_BOX_PADDING=16;m.COLLISION_BUCKET_SIZE=128;m.COLLISION_EARLY_REJECT_BUCKET_SIZE=16;m.COLLISION_MAX_ZOOM_DELTA=1;m.COLLISION_PLACEMENT_PADDING=8;m.COLLISION_TILE_BOX_SIZE=4;m.DEBUG_LABELS=!1;m.DISPLAY_RECORD_INT_PER_ELEMENT=8;m.DOT_DENSITY_MAX_FIELDS=8;m.EFFECT_FLAG_0=4;m.ENABLE_EARLY_LABEL_DISCARD=!1;m.EXTRUDE_SCALE=64;m.FILTER_FLAG_0=2;m.GLYPH_SIZE=24;m.HEURISTIC_GLYPHS_PER_FEATURE=10;m.HEURISTIC_GLYPHS_PER_LINE=50;m.HIGHLIGHT_FLAG=
1;m.HITTEST_RADIUS=3;m.MAGIC_LABEL_LINE_HEIGHT=29;m.MAX_FILTERS=2;m.MAX_GPU_UPLOADS_PER_FRAME=2;m.MIN_MAX_ZOOM_PRECISION_FACTOR=10;m.NAN_MAGIC_NUMBER=1E-30;m.PATCH_PIXEL_BUFFER_ALLOC_SIZE=500;m.PATTERN_FILL_RASTERIZATION_SCALE=2;m.PICTURE_FILL_COLOR=4294967295;m.RANDOM_INSIDE_POLYGON_TEXTURE_SIZE=1024;m.RASTER_TILE_SIZE=256;m.SPRITE_PADDING=2;m.TEXTURE_BINDING_ATTRIBUTE_DATA_0=1;m.TEXTURE_BINDING_ATTRIBUTE_DATA_1=2;m.TEXTURE_BINDING_ATTRIBUTE_DATA_2=3;m.TEXTURE_BINDING_ATTRIBUTE_DATA_3=4;m.TEXTURE_BINDING_ATTRIBUTE_DATA_4=
5;m.TEXTURE_BINDING_ATTRIBUTE_DATA_5=6;m.TEXTURE_BINDING_BITMAP=0;m.TEXTURE_BINDING_GLYPH_ATLAS=0;m.TEXTURE_BINDING_GPGPU=12;m.TEXTURE_BINDING_HIGHLIGHT_0=5;m.TEXTURE_BINDING_HIGHLIGHT_1=6;m.TEXTURE_BINDING_RENDERER_0=5;m.TEXTURE_BINDING_RENDERER_1=6;m.TEXTURE_BINDING_SPRITE_ATLAS=0;m.TEXTURE_UPLOAD_MANAGER_BUDGET=4;m.TEXTURE_UPLOAD_MANAGER_CHUNK_SIZE=128;m.TEXT_PLACEMENT_PADDING=8;m.THIN_LINE_HALF_WIDTH_THRESHOLD=1.05;m.TILE_SIZE=512;m.VTL_HIGH_RES_CUTOFF=1.15;m.VTL_TEXTURE_BINDING_UNIT_GLYPHS=6;
m.VTL_TEXTURE_BINDING_UNIT_SPRITES=5;m.WEBGL_MAX_INNER_STOPS=6;m.WEBGL_MAX_STOPS=8;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/effects/highlight/parameters":function(){define(["exports"],function(m){m.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1];m.HIGHLIGHT_SIZING={outlineWidth:1.3,outerHaloWidth:.4,innerHaloWidth:.4,outlinePosition:0};m.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];m.SHADE_TEXTURE_SIZE=
256;m.SIGMA=1;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/BufferPool":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../core/has","../../../../core/maybe","./cpuMapped/FreeList"],function(m,p,D,B,u){const t=D("esri-2d-log-allocations");D=function(){function e(d,a){this._array=d;this._pool=a}e.create=function(d,a){d=a.acquire(d);return new e(d,a)};var b=e.prototype;b.expand=function(d){d=this._pool.acquire(d);d.set(this._array);
this._pool.release(this._array);this._array=d};b.destroy=function(){this._pool.release(this._array)};b.set=function(d,a){this._array.set(d._array,a)};b.slice=function(){const d=this._pool.acquire(this._array.byteLength);d.set(this._array);return new e(d,this._pool)};p._createClass(e,[{key:"array",get:function(){return this._array}},{key:"length",get:function(){return this._array.length}}]);return e}();let h=function(){function e(){this._data=new ArrayBuffer(e.BYTE_LENGTH);this._freeList=new u.FreeList({start:0,
end:this._data.byteLength})}var b=e.prototype;b.allocate=function(d){const a=this._freeList.firstFit(d);return B.isNone(a)?null:new Uint32Array(this._data,a,d/Uint32Array.BYTES_PER_ELEMENT)};b.free=function(d){this._freeList.free(d.byteOffset,d.byteLength)};p._createClass(e,[{key:"buffer",get:function(){return this._data}}],[{key:"BYTE_LENGTH",get:function(){return 64E6}}]);return e}(),l=function(){function e(){this._bytesAllocated=0;this._pages=[];this._pagesByBuffer=new Map;this._addPage()}var b=
e.prototype;b.destroy=function(){this._pages=[];this._pagesByBuffer=null};b.acquire=function(d){this._bytesAllocated+=d;t&&console.log(`Allocating ${d}, (${this._bytesAllocated} / ${this._bytesTotal})`);if(d>h.BYTE_LENGTH)return new Uint32Array(d/Uint32Array.BYTES_PER_ELEMENT);for(const a of this._pages){const c=a.allocate(d);if(B.isSome(c))return c}return B.unwrapOrThrow(this._addPage().allocate(d),"Expected to allocate page")};b.release=function(d){this._bytesAllocated-=d.byteLength;t&&console.log(`Freeing ${d.byteLength}, (${this._bytesAllocated} / ${this._bytesTotal})`);
const a=this._pagesByBuffer.get(d.buffer);a&&a.free(d)};b._addPage=function(){const d=new h;this._pages.push(d);this._pagesByBuffer.set(d.buffer,d);return d};p._createClass(e,[{key:"_bytesTotal",get:function(){return this._pages.length*h.BYTE_LENGTH}}]);return e}();m.BufferPool=l;m.TypedBuffer=D;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/cpuMapped/FreeList":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe"],
function(m,p,D){let B=function(){function t(l){this.next=null;if(Array.isArray(l)){this.data=l[0];var e=this;for(let b=1;b<l.length;b++)e.next=new t([l[b]]),e=e.next}else this.data=l}var h=t.prototype;h.values=function*(){let l=this;for(;l;)yield l.data,l=l.next};h.forEach=function(l){let e=this;for(;e;)l(e.data),e=e.next};h.find=function(l){return l(this.data)?this:this.next?.find(l)};h.max=function(l,e=this){e=l(this.data)>l(e.data)?this:e;return this.next?this.next.max(l,e):e};h.remove=function(l,
e=null){return this===l?e?(e.next=this.next,e):this.next:this.next?.remove(l,this)??null};p._createClass(t,[{key:"last",get:function(){return this.next?this.next.last:this}}]);return t}(),u=function(){function t(l){this._head=null;D.isNone(l)||(this._head=new B(l))}var h=t.prototype;h.maxAvailableSpace=function(){if(D.isNone(this._head))return 0;const l=this._head.max(e=>e.end-e.start);return l.data.end-l.data.start};h.firstFit=function(l){if(D.isNone(this._head))return null;var e=null;let b=this._head;
for(;b;){const d=b.data.end-b.data.start;if(d===l)return e?e.next=b.next:this._head=b.next,b.data.start;if(d>l)return e=b.data.start,b.data.start+=l,e;e=b;b=b.next}return null};h.free=function(l,e){const b=l+e;if(D.isNone(this._head))this._head=new B({start:l,end:b});else if(b<=this._head.data.start)if(b===this._head.data.start)this._head.data.start-=e;else{var d=new B({start:l,end:b});d.next=this._head;this._head=d}else{d=this._head;for(var a=d.next;a;){if(a.data.start>=b){if(d.data.end===l){d.data.end+=
e;d.data.end===a.data.start&&(d.data.end+=a.data.end-a.data.start,d.next=a.next);return}if(a.data.start===b){a.data.start-=e;return}l=new B({start:l,end:b});l.next=d.next;d.next=l;return}d=a;a=a.next}l===d.data.end?d.data.end+=e:(l=new B({start:l,end:b}),d.next=l)}};p._createClass(t,[{key:"head",get:function(){return this._head}}]);return t}();m.FreeList=u;m.List=B;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/enums":function(){define(["exports"],function(m){m.WGLGeometryType=
void 0;(function(p){p[p.FILL=0]="FILL";p[p.LINE=1]="LINE";p[p.MARKER=2]="MARKER";p[p.TEXT=3]="TEXT";p[p.LABEL=4]="LABEL"})(m.WGLGeometryType||(m.WGLGeometryType={}));m.WGLDrawPhase=void 0;(function(p){p[p.NONE=0]="NONE";p[p.MAP=1]="MAP";p[p.LABEL=2]="LABEL";p[p.LABEL_ALPHA=4]="LABEL_ALPHA";p[p.HITTEST=8]="HITTEST";p[p.HIGHLIGHT=16]="HIGHLIGHT";p[p.CLIP=32]="CLIP";p[p.DEBUG=64]="DEBUG";p[p.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"})(m.WGLDrawPhase||(m.WGLDrawPhase={}));m.VVType=void 0;(function(p){p[p.SIZE=
0]="SIZE";p[p.COLOR=1]="COLOR";p[p.OPACITY=2]="OPACITY";p[p.ROTATION=3]="ROTATION"})(m.VVType||(m.VVType={}));m.WGLVVFlag=void 0;(function(p){p[p.NONE=0]="NONE";p[p.OPACITY=1]="OPACITY";p[p.COLOR=2]="COLOR";p[p.ROTATION=4]="ROTATION";p[p.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE";p[p.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS";p[p.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS";p[p.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"})(m.WGLVVFlag||(m.WGLVVFlag={}));m.WGLVVTarget=void 0;(function(p){p[p.MINMAX_TARGETS_OUTLINE=
128]="MINMAX_TARGETS_OUTLINE";p[p.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE";p[p.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE";p[p.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"})(m.WGLVVTarget||(m.WGLVVTarget={}));m.MosaicType=void 0;(function(p){p[p.SPRITE=0]="SPRITE";p[p.GLYPH=1]="GLYPH"})(m.MosaicType||(m.MosaicType={}));m.WGLSymbologyType=void 0;(function(p){p[p.DEFAULT=0]="DEFAULT";p[p.SIMPLE=1]="SIMPLE";p[p.DOT_DENSITY=2]="DOT_DENSITY";p[p.OUTLINE_FILL=3]="OUTLINE_FILL";p[p.OUTLINE_FILL_SIMPLE=
4]="OUTLINE_FILL_SIMPLE";p[p.HEATMAP=5]="HEATMAP";p[p.PIE_CHART=6]="PIE_CHART"})(m.WGLSymbologyType||(m.WGLSymbologyType={}));Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/Painter":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../brushes ../vectorTiles/shaders/VTLMaterialManager ./BitBlitRenderer ./enums ./MaterialManager ./TextureManager ./TextureUploadManager ./WorldExtentClipRenderer ./effects/AnimationEffect ./effects/BlendEffect ./effects/FeatureEffect ./effects/HighlightEffect ./effects/HittestEffect ./effects/HittestEffectVTL ./effects/post-processing/EffectManager ./painter/RenderPass ../../../webgl/context-util ../../../webgl/enums ../../../webgl/FramebufferObject ../../../webgl/Renderbuffer".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d,a,c,f,g,n,k,x,r,v,q,y){function A(z,C){switch(z){case t.WGLGeometryType.LINE:return D.brushes.line;case t.WGLGeometryType.TEXT:return D.brushes.text;case t.WGLGeometryType.LABEL:return D.brushes.label;case t.WGLGeometryType.FILL:switch(C){case t.WGLSymbologyType.DOT_DENSITY:return D.brushes.dotDensity;default:return D.brushes.fill}case t.WGLGeometryType.MARKER:switch(C){case t.WGLSymbologyType.HEATMAP:return D.brushes.heatmap;case t.WGLSymbologyType.PIE_CHART:return D.brushes.pieChart;
default:return D.brushes.marker}}}function w(z,C,E,F){return z!==t.WGLDrawPhase.HIGHLIGHT&&(1!==F||p.isSome(C)&&"normal"!==C||p.isSome(E)&&0<E.length)}return function(){function z(E,F,G){this.context=E;this._blitRenderer=new u.BitBlitRenderer;this._worldExtentClipRenderer=new b.WorldExtentClipRenderer;this._isClippedToWorldExtent=!1;this._brushCache=new Map;this._prevFBO=this._lastHeight=this._lastWidth=null;this._vtlMaterialManager=new B;this._blendEffect=new a.BlendEffect;this._fbos=this._stencilBuf=
null;this._fboPool=[];this._renderTarget=null;this.effects={highlight:new f,hittest:new g.HittestEffect,hittestVTL:new n.HittestEffectVTL,integrate:new d.AnimationEffect,insideEffect:new c.FeatureEffect("inside"),outsideEffect:new c.FeatureEffect("outside")};this.materialManager=new h(E);this.textureManager=new l(F,G,E.type===r.ContextType.WEBGL2);this.textureUploadManager=new e.TextureUploadManager(E,F);this._effectsManager=new k.EffectManager}var C=z.prototype;C.getRenderTarget=function(){return this._renderTarget};
C.setRenderTarget=function(E){this._renderTarget=E};C.getFbos=function(E,F){if(E!==this._lastWidth||F!==this._lastHeight){this._lastWidth=E;this._lastHeight=F;if(this._fbos){for(var G in this._fbos)this._fbos[G].resize(E,F);return this._fbos}G={target:v.TextureType.TEXTURE_2D,pixelFormat:v.PixelFormat.RGBA,dataType:v.PixelType.UNSIGNED_BYTE,samplingMode:v.TextureSamplingMode.NEAREST,wrapMode:v.TextureWrapMode.CLAMP_TO_EDGE,width:E,height:F};const H={colorTarget:v.TargetType.TEXTURE,depthStencilTarget:v.DepthStencilTargetType.DEPTH_STENCIL_RENDER_BUFFER};
this._stencilBuf=E=new y.Renderbuffer(this.context,{width:E,height:F,internalFormat:v.RenderbufferFormat.DEPTH_STENCIL});this._fbos={output:new q.FramebufferObject(this.context,H,G,E),blend:new q.FramebufferObject(this.context,H,G,E),effect0:new q.FramebufferObject(this.context,H,G,E)}}return this._fbos};C.acquireFbo=function(E,F){let G;G=0<this._fboPool.length?this._fboPool.pop():new q.FramebufferObject(this.context,{colorTarget:v.TargetType.TEXTURE,depthStencilTarget:v.DepthStencilTargetType.DEPTH_STENCIL_RENDER_BUFFER},
{target:v.TextureType.TEXTURE_2D,pixelFormat:v.PixelFormat.RGBA,dataType:v.PixelType.UNSIGNED_BYTE,samplingMode:v.TextureSamplingMode.NEAREST,wrapMode:v.TextureWrapMode.CLAMP_TO_EDGE,width:E,height:F},this._stencilBuf);const H=G.descriptor;H.width===E&&H.height===F||G.resize(E,F);return G};C.releaseFbo=function(E){this._fboPool.push(E)};C.getSharedStencilBuffer=function(){return this._stencilBuf};C.beforeRenderLayers=function(E,F=null){const {width:G,height:H}=E.getViewport();this._prevFBO=E.getBoundFramebufferObject();
const L=this.getFbos(G,H);E.bindFramebuffer(L?.output);E.setColorMask(!0,!0,!0,!0);if(p.isSome(F)){const {r:K,g:M,b:U,a:T}=F.color;E.setClearColor(T*K/255,T*M/255,T*U/255,T)}else E.setClearColor(0,0,0,0);E.setDepthWriteEnabled(!0);E.setClearDepth(1);E.clear(E.gl.COLOR_BUFFER_BIT|E.gl.DEPTH_BUFFER_BIT);E.setDepthWriteEnabled(!1)};C.beforeRenderLayer=function(E,F,G){const {context:H,blendMode:L,effects:K,requireFBO:M,drawPhase:U}=E;M||w(U,L,K,G)?(H.bindFramebuffer(this._fbos?.blend),H.setColorMask(!0,
!0,!0,!0),H.setClearColor(0,0,0,0),H.setDepthWriteEnabled(!0),H.setClearDepth(1),H.clear(H.gl.COLOR_BUFFER_BIT|H.gl.DEPTH_BUFFER_BIT),H.setDepthWriteEnabled(!1)):(E=this._getOutputFBO(),H.bindFramebuffer(E));H.setDepthWriteEnabled(!1);H.setDepthTestEnabled(!1);H.setStencilTestEnabled(!0);H.setClearStencil(F);H.setStencilWriteMask(255);H.clear(H.gl.STENCIL_BUFFER_BIT)};C.compositeLayer=function(E,F){const {context:G,blendMode:H,effects:L,requireFBO:K,drawPhase:M}=E;if(K||w(M,H,L,F)){p.isSome(L)&&0<
L.length&&M===t.WGLDrawPhase.MAP&&this._applyEffects(E,L);var U=this._getOutputFBO();G.bindFramebuffer(U);G.setStencilTestEnabled(!1);G.setStencilWriteMask(0);G.setBlendingEnabled(!0);G.setBlendFunctionSeparate(v.BlendFactor.ONE,v.BlendFactor.ONE_MINUS_SRC_ALPHA,v.BlendFactor.ONE,v.BlendFactor.ONE_MINUS_SRC_ALPHA);G.setColorMask(!0,!0,!0,!0);U=p.isNone(H)||M===t.WGLDrawPhase.HIGHLIGHT?"normal":H;const T=this._fbos;T?.blend.colorTexture&&this._blendEffect.draw(E,T.blend.colorTexture,v.TextureSamplingMode.NEAREST,
U,F)}};C.renderLayers=function(E){E.bindFramebuffer(this._prevFBO);const F=this._getOutputFBO();F&&(E.setDepthTestEnabled(!1),E.setStencilWriteMask(0),this._isClippedToWorldExtent?(E.setStencilTestEnabled(!0),E.setStencilFunction(v.CompareFunction.EQUAL,1,255)):E.setStencilTestEnabled(!1),this.blitTexture(E,F.colorTexture,v.TextureSamplingMode.NEAREST))};C.prepareDisplay=function(E,F,G){const {context:H}=E;H.bindFramebuffer(this._prevFBO);H.setColorMask(!0,!0,!0,!0);if(p.isSome(F)){const {r:L,g:K,
b:M,a:U}=F.color;H.setClearColor(U*L/255,U*K/255,U*M/255,U)}else H.setClearColor(0,0,0,0);H.setStencilWriteMask(255);H.setClearStencil(0);H.clear(H.gl.COLOR_BUFFER_BIT|H.gl.STENCIL_BUFFER_BIT);this._isClippedToWorldExtent=this._worldExtentClipRenderer.render(E,G)};C.dispose=function(){this.materialManager.dispose();this.textureManager.dispose();this.textureUploadManager.destroy();this._blitRenderer=p.disposeMaybe(this._blitRenderer);this._worldExtentClipRenderer=p.disposeMaybe(this._worldExtentClipRenderer);
this._brushCache&&(this._brushCache.forEach(E=>E.dispose()),this._brushCache.clear(),this._brushCache=null);if(this._fbos)for(const E in this._fbos)this._fbos[E]&&this._fbos[E].dispose();for(const E of this._fboPool)E.dispose();this._fboPool.length=0;if(this.effects)for(const E in this.effects)this.effects[E]&&this.effects[E].dispose();this._effectsManager.dispose();this._vtlMaterialManager=p.disposeMaybe(this._vtlMaterialManager);this._prevFBO=null};C.getBrush=function(E,F){E=A(E,F);F=this._brushCache.get(E);
void 0===F&&(F=new E,this._brushCache.set(E,F));return F};C.renderObject=function(E,F,G,H){if(G=D.brushes[G]){var L=this._brushCache.get(G);void 0===L&&(L=new G,this._brushCache.set(G,L));L.prepareState(E,H);L.draw(E,F,H)}};C.renderObjects=function(E,F,G,H){if(G=D.brushes[G]){var L=this._brushCache.get(G);void 0===L&&(L=new G,this._brushCache.set(G,L));L.drawMany(E,F,H)}};C.registerRenderPass=function(E){const F=E.brushes.map(G=>{this._brushCache.has(G)||this._brushCache.set(G,new G);return this._brushCache.get(G)});
return new x(F,E)};C.blitTexture=function(E,F,G,H=1){E.setBlendingEnabled(!0);E.setBlendFunctionSeparate(v.BlendFactor.ONE,v.BlendFactor.ONE_MINUS_SRC_ALPHA,v.BlendFactor.ONE,v.BlendFactor.ONE_MINUS_SRC_ALPHA);E.setColorMask(!0,!0,!0,!0);this._blitRenderer.render(E,F,G,H)};C.getPostProcessingEffects=function(E){return this._effectsManager.getPostProcessingEffects(E)};C._getOutputFBO=function(){return null!=this._renderTarget?this._renderTarget:this._fbos?.output??null};C._applyEffects=function(E,
F){const G=this._fbos?.blend;if(G){var {context:H}=E;F=this._effectsManager.getPostProcessingEffects(F);for(const {postProcessingEffect:L,effect:K}of F)H.bindFramebuffer(G),L.draw(E,G,K)}};m._createClass(z,[{key:"vectorTilesMaterialManager",get:function(){return this._vtlMaterialManager}}]);return z}()})},"esri/views/2d/engine/brushes":function(){define("exports ./webgl/brushes/BrushBitmap ./webgl/brushes/BrushClip ./webgl/brushes/BrushOverlay ./webgl/brushes/WGLBrushDotDensity ./webgl/brushes/WGLBrushHeatmap ./webgl/brushes/WGLBrushInfo ./webgl/brushes/WGLBrushPieChart ./webgl/brushes/WGLBrushStencil ./webgl/brushes/WGLBrushVTLBackground ./webgl/brushes/WGLBrushVTLCircle ./webgl/brushes/WGLBrushVTLFill ./webgl/brushes/WGLBrushVTLLine ./webgl/brushes/WGLBrushVTLSymbol ./webgl/brushes/WGLGeometryBrushFill ./webgl/brushes/WGLGeometryBrushLabel ./webgl/brushes/WGLGeometryBrushLine ./webgl/brushes/WGLGeometryBrushMarker ./webgl/brushes/WGLGeometryBrushText".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d,a,c,f,g,n,k,x,r){m.brushes={marker:x,line:k,fill:g,text:r,label:n,clip:D,stencil:e,bitmap:p,overlay:B,tileInfo:h,vtlBackground:b.WGLBrushVTLBackground,vtlFill:a.WGLBrushVTLFill,vtlLine:c.WGLBrushVTLLine,vtlCircle:d.WGLBrushVTLCircle,vtlSymbol:f.WGLBrushVTLSymbol,dotDensity:u,heatmap:t,pieChart:l};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/brushes/BrushBitmap":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ../VertexStream ./WGLBrush ../../../../webgl/enums".split(" "),
function(m,p,D,B,u,t){const h={nearest:{defines:[],samplingMode:t.TextureSamplingMode.NEAREST,mips:!1},bilinear:{defines:[],samplingMode:t.TextureSamplingMode.LINEAR,mips:!1},bicubic:{defines:["bicubic"],samplingMode:t.TextureSamplingMode.LINEAR,mips:!1},trilinear:{defines:[],samplingMode:t.TextureSamplingMode.LINEAR_MIPMAP_LINEAR,mips:!0}};return function(l){function e(){var d=l.apply(this,arguments)||this;d._desc={vsPath:"raster/bitmap",fsPath:"raster/bitmap",attributes:new Map([["a_pos",0]])};
return d}m._inheritsLoose(e,l);var b=e.prototype;b.dispose=function(){this._quad&&this._quad.dispose()};b.prepareState=function({context:d}){d.setBlendingEnabled(!0);d.setColorMask(!0,!0,!0,!0);d.setStencilWriteMask(0);d.setStencilTestEnabled(!0)};b.draw=function(d,a){const {context:c,renderingOptions:f,painter:g,requestRender:n,allowDelayedRender:k}=d;if(a.source&&a.isReady){if("dynamic"===f.samplingMode){({state:r}=d);var x=a.resolution/a.pixelRatio/r.resolution;const A=Math.round(d.pixelRatio)!==
d.pixelRatio;var r=r.rotation||1.05<x||.95>x||A||a.isSourceScaled||a.rotation?h.bilinear:h.nearest}else r=h[f.samplingMode];x=g.materialManager.getProgram(this._desc,r.defines);if(k&&p.isSome(n)&&!x.compiled)n();else{d.timeline.begin(this.name);"additive"===a.blendFunction?c.setBlendFunctionSeparate(t.BlendFactor.ONE,t.BlendFactor.ONE,t.BlendFactor.ONE,t.BlendFactor.ONE):c.setBlendFunctionSeparate(t.BlendFactor.ONE,t.BlendFactor.ONE_MINUS_SRC_ALPHA,t.BlendFactor.ONE,t.BlendFactor.ONE_MINUS_SRC_ALPHA);
c.setStencilFunction(t.CompareFunction.EQUAL,a.stencilRef,255);this._quad||(this._quad=new B(c,[0,0,1,0,0,1,1,1]));var {coordScale:v,computedOpacity:q,transforms:y}=a;a.setSamplingProfile(r);a.bind(d.context,D.TEXTURE_BINDING_BITMAP);c.useProgram(x);x.setUniformMatrix3fv("u_dvsMat3",y.dvs);x.setUniform1i("u_texture",D.TEXTURE_BINDING_BITMAP);x.setUniform2fv("u_coordScale",v);x.setUniform1f("u_opacity",q);this._quad.draw();d.timeline.end(this.name)}}};return e}(u)})},"esri/views/2d/engine/webgl/VertexStream":function(){define(["../../../webgl/BufferObject",
"../../../webgl/enums","../../../webgl/VertexArrayObject","../../../webgl/VertexElementDescriptor"],function(m,p,D,B){return function(){function u(h,l){this._rctx=h;this._vertexBuffer=m.BufferObject.createVertex(h,p.Usage.STATIC_DRAW,new Uint16Array(l));this._vao=new D.VertexArrayObject(h,new Map([["a_position",0]]),{geometry:[new B.VertexElementDescriptor("a_position",2,p.DataType.SHORT,0,4)]},{geometry:this._vertexBuffer});this._count=l.length/2}var t=u.prototype;t.bind=function(){this._rctx.bindVAO(this._vao)};
t.unbind=function(){this._rctx.bindVAO(null)};t.dispose=function(){this._vao.dispose(!1);this._vertexBuffer.dispose()};t.draw=function(){this._rctx.bindVAO(this._vao);this._rctx.drawArrays(p.PrimitiveType.TRIANGLE_STRIP,0,this._count)};return u}()})},"esri/views/webgl/VertexElementDescriptor":function(){define(["exports"],function(m){m.VertexElementDescriptor=function(p,D,B,u,t,h=!1,l=0){this.name=p;this.count=D;this.type=B;this.offset=u;this.stride=t;this.normalized=h;this.divisor=l};Object.defineProperty(m,
Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/brushes/WGLBrush":function(){define(function(){return function(){function m(){this.name=this.constructor.name||"UnnamedBrush";this.brushEffect=null}var p=m.prototype;p.prepareState=function(D,B){};p.draw=function(D,B,u){};p.drawMany=function(D,B,u){for(const t of B)t.visible&&this.draw(D,t,u)};return m}()})},"esri/views/2d/engine/webgl/brushes/BrushClip":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../chunks/vec4f32 ../Utils ./WGLBrush ../shaders/BackgroundPrograms ../../../../webgl/enums ../../../../webgl/ProgramTemplate".split(" "),
function(m,p,D,B,u,t,h,l){return function(e){function b(){var a=e.apply(this,arguments)||this;a._color=D.fromValues(0,1,0,1);return a}m._inheritsLoose(b,e);var d=b.prototype;d.dispose=function(){this._program&&this._program.dispose()};d.prepareState=function({context:a}){a.setStencilTestEnabled(!0);a.setBlendingEnabled(!1);a.setFaceCullingEnabled(!1);a.setColorMask(!1,!1,!1,!1);a.setStencilOp(h.StencilOperation.KEEP,h.StencilOperation.KEEP,h.StencilOperation.REPLACE);a.setStencilWriteMask(255);a.setStencilFunction(h.CompareFunction.ALWAYS,
0,255)};d.draw=function(a,c){const {context:f,state:g,requestRender:n,allowDelayedRender:k}=a;a=B.createProgramDescriptor("clip",{geometry:[{location:0,name:"a_pos",count:2,type:h.DataType.SHORT}]});c=c.getVAO(f,g,a.attributes,a.bufferLayouts);p.isNone(c.indexBuffer)||(this._program||(this._program=l.createProgram(f,t.background)),k&&p.isSome(n)&&!this._program.compiled?n():(f.useProgram(this._program),this._program.setUniform2fv("u_coord_range",[1,1]),this._program.setUniform4fv("u_color",this._color),
this._program.setUniformMatrix3fv("u_dvsMat3",g.displayMat3),f.bindVAO(c),f.drawElements(h.PrimitiveType.TRIANGLES,c.indexBuffer.size,h.DataType.UNSIGNED_INT,0),f.bindVAO()))};return b}(u)})},"esri/chunks/vec4f32":function(){define(["exports"],function(m){function p(){return new Float32Array(4)}function D(r){const v=new Float32Array(4);v[0]=r[0];v[1]=r[1];v[2]=r[2];v[3]=r[3];return v}function B(r,v,q,y){const A=new Float32Array(4);A[0]=r;A[1]=v;A[2]=q;A[3]=y;return A}function u(r,v){return new Float32Array(r,
v,4)}function t(){return p()}function h(){return B(1,1,1,1)}function l(){return B(1,0,0,0)}function e(){return B(0,1,0,0)}function b(){return B(0,0,1,0)}function d(){return B(0,0,0,1)}const a=p(),c=h(),f=l(),g=e(),n=b(),k=d(),x=Object.freeze(Object.defineProperty({__proto__:null,ONES:c,UNIT_W:k,UNIT_X:f,UNIT_Y:g,UNIT_Z:n,ZEROS:a,clone:D,create:p,createView:u,fromValues:B,ones:h,unitW:d,unitX:l,unitY:e,unitZ:b,zeros:t},Symbol.toStringTag,{value:"Module"}));m.ONES=c;m.UNIT_W=k;m.UNIT_X=f;m.UNIT_Y=g;
m.UNIT_Z=n;m.ZEROS=a;m.clone=D;m.create=p;m.createView=u;m.fromValues=B;m.ones=h;m.unitW=d;m.unitX=l;m.unitY=e;m.unitZ=b;m.vec4f32=x;m.zeros=t})},"esri/views/2d/engine/webgl/Utils":function(){define("exports ../../../../core/Error ../../../../core/Logger ../../../../symbols/cim/enums ./enums ../../../webgl/enums ../../../webgl/VertexElementDescriptor".split(" "),function(m,p,D,B,u,t,h){function l(K){const M={};for(const U of K)M[U.name]=U.strideInBytes;return M}function e(K){switch(K){case u.WGLGeometryType.MARKER:return y;
case u.WGLGeometryType.FILL:return A;case u.WGLGeometryType.LINE:return w;case u.WGLGeometryType.TEXT:return z;case u.WGLGeometryType.LABEL:return C}}function b(K){switch(K%4){case 0:case 2:return 4;case 1:case 3:return 1}}function d(K){switch(K){case t.DataType.BYTE:case t.DataType.UNSIGNED_BYTE:return 1;case t.DataType.SHORT:case t.DataType.UNSIGNED_SHORT:return 2;case t.DataType.FLOAT:case t.DataType.INT:case t.DataType.UNSIGNED_INT:return 4}}function a(K){const M={};for(const U in K){let T=0;
M[U]=K[U].map(Z=>{const X=new h.VertexElementDescriptor(Z.name,Z.count,Z.type,T,0,Z.normalized||!1);T+=Z.count*d(Z.type);return X});M[U]?.forEach(Z=>Z.stride=T)}return M}const c=D.getLogger("esri.views.2d.engine.webgl.Utils"),f=l([{name:"geometry",strideInBytes:36}]),g=l([{name:"geometry",strideInBytes:12}]),n=l([{name:"geometry",strideInBytes:36}]),k=l([{name:"geometry",strideInBytes:24}]),x=l([{name:"geometry",strideInBytes:12}]),r=l([{name:"geometry",strideInBytes:40}]),v=l([{name:"geometry",strideInBytes:36}]),
q=l([{name:"geometry",strideInBytes:36}]),y=["geometry"],A=["geometry"],w=["geometry"],z=["geometry"],C=["geometry"];D={geometry:t.Usage.STATIC_DRAW};const E=new Map,F=K=>null!=K&&K.startsWith("data:image/gif"),G=K=>null!=K&&K.startsWith("data:image/png"),H=K=>{if(!K)return!1;K=K.trim();return/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(K)&&/[\dz]$/i.test(K)&&4<K.length?!0:!1},L=K=>"fill"===K.type&&"CIMMarkerPlacementInsidePolygon"===K?.cim?.markerPlacement?.type;m.C_VBO_INFO=D;m.allocateTypedArrayBuffer=
function(K,M){switch(M%4){case 0:case 2:return new Uint32Array(Math.floor(K*M/4));case 1:case 3:return new Uint8Array(K*M)}};m.allocateTypedArrayBufferwithData=function(K,M){switch(M%4){case 0:case 2:return new Uint32Array(K);case 1:case 3:return new Uint8Array(K)}};m.charCodes=function(K){const M=[];for(let U=0;U<K.length;U++)M.push(K.charCodeAt(U));return M};m.copyMeshData=function(K,M,U,T,Z,X,ca){for(const N in X){var P=X[N].stride,J=b(P);const S=X[N].data,Q=U[N].data;if(null==S||null==Q)continue;
const Y=P*Z.vertexCount/J,ba=P*K/J;P=P*Z.vertexFrom/J;for(J=0;J<Y;++J)Q[J+ba]=S[J+P]}if(null!=ca&&null!=T)for(U=Z.indexCount,X=0;X<U;++X)T[X+M]=ca[X+Z.indexFrom]-Z.vertexFrom+K};m.createGeometryData=function(K,M){const U=[];for(let T=0;5>T;++T){const Z=e(T),X={};for(const ca of Z)X[ca]={data:M(T,ca)};U.push({data:K(T),buffers:X})}return U};m.createProgramDescriptor=(K,M)=>{if(!E.has(K)){const Z=a(M);var U=Z;var T={};for(const X in U){const ca=U[X];T[X]=ca?.length?ca[0].stride:0}U=T;T=new Map;for(const X in M)for(const ca of M[X])T.set(ca.name,
ca.location);E.set(K,{strides:U,bufferLayouts:Z,attributes:T})}return E.get(K)};m.forEachGeometryType=function(K){K(u.WGLGeometryType.FILL);K(u.WGLGeometryType.LINE);K(u.WGLGeometryType.MARKER);K(u.WGLGeometryType.TEXT);K(u.WGLGeometryType.LABEL)};m.getBytes=d;m.getCapType=function(K){switch(K){case "butt":return B.CapType.BUTT;case "round":return B.CapType.ROUND;case "square":return B.CapType.SQUARE;default:return c.error(new p("mapview-invalid-type",`Cap type ${K} is not a valid option. Defaulting to round`)),
B.CapType.ROUND}};m.getJoinType=function(K){switch(K){case "miter":return B.JoinType.MITER;case "bevel":return B.JoinType.BEVEL;case "round":return B.JoinType.ROUND;default:return c.error(new p("mapview-invalid-type",`Join type ${K} is not a valid option. Defaulting to round`)),B.JoinType.ROUND}};m.getNamedBuffers=e;m.getPMSResourceSize=function(K){const M="maxVVSize"in K&&K.maxVVSize;K="width"in K&&K.width||"size"in K&&K.size||0;return M?M:K};m.getPixelArrayCtor=function(K){switch(K){case t.PixelType.UNSIGNED_BYTE:return Uint8Array;
case t.PixelType.UNSIGNED_SHORT_4_4_4_4:return Uint16Array;case t.PixelType.FLOAT:return Float32Array;default:c.error(new p("webgl-utils",`Unable to handle type ${K}`))}};m.getPixelBytes=function(K){switch(K){case t.PixelType.UNSIGNED_BYTE:return 1;case t.PixelType.UNSIGNED_SHORT_4_4_4_4:return 2;case t.PixelType.FLOAT:return 4;default:c.error(new p("webgl-utils",`Unable to handle type ${K}`))}};m.getStrides=function(K,M){switch(K){case u.WGLGeometryType.MARKER:switch(M){case u.WGLSymbologyType.HEATMAP:return g;
default:return f}case u.WGLGeometryType.FILL:switch(M){case u.WGLSymbologyType.DOT_DENSITY:return x;case u.WGLSymbologyType.SIMPLE:case u.WGLSymbologyType.OUTLINE_FILL_SIMPLE:return k;default:return n}case u.WGLGeometryType.LINE:return r;case u.WGLGeometryType.TEXT:return v;case u.WGLGeometryType.LABEL:return q}};m.getUrl=K=>"imageData"in K&&K.imageData&&"contentType"in K&&K.contentType?`data:${K.contentType};base64,${K.imageData}`:"url"in K?K.url:null;m.getVVType=function(K){switch(K){case "opacity":return u.VVType.OPACITY;
case "color":return u.VVType.COLOR;case "rotation":return u.VVType.ROTATION;case "size":return u.VVType.SIZE;default:return c.error(`Cannot interpret unknown vv: ${K}`),null}};m.is3D=K=>K.type&&K.type.toLowerCase().includes("3d");m.isDefined=function(K){return null!=K};m.isGIF=K=>"url"in K&&K.url&&(K.url.includes(".gif")||F(K.url))||"contentType"in K&&"image/gif"===K.contentType||"imageData"in K&&F(K.imageData);m.isGIFDataUri=F;m.isImageResource=K=>"url"in K&&K.url||"imageData"in K&&K.imageData;m.isMarkerPlacementInsidePolygon=
L;m.isNumber=function(K){return"number"===typeof K};m.isPNG=K=>"url"in K&&K.url&&(K.url.includes(".png")||G(K.url))||"contentType"in K&&"image/png"===K.contentType||"imageData"in K&&G(K.imageData);m.isPNGDataUri=G;m.isSVGImage=K=>K.includes("data:image/svg+xml");m.isSVGResource=K=>"path"in K&&H(K.path);m.isSimple=function(K){switch(K.type){case "line":return"CIMSolidStroke"===K.cim.type&&!K.dashTemplate;case "fill":return"CIMSolidFill"===K.cim.type;case "esriSFS":return"esriSFSSolid"===K.style||"esriSFSNull"===
K.style;case "esriSLS":return"esriSLSSolid"===K.style||"esriSLSNull"===K.style;default:return!1}};m.isValidSVG=H;m.shouldRepeat=function(K){switch("cim"in K?K.cim.type:K.type){case "esriSMS":case "esriPMS":case "CIMPointSymbol":return!1;case "CIMVectorMarker":case "CIMCharacterMarker":case "CIMPictureMarker":return L(K);default:return!0}};m.strideToPackingFactor=b;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/enums":function(){define(["exports"],function(m){m.CapType=
void 0;(function(p){p[p.BUTT=0]="BUTT";p[p.ROUND=1]="ROUND";p[p.SQUARE=2]="SQUARE";p[p.UNKNOWN=4]="UNKNOWN"})(m.CapType||(m.CapType={}));m.JoinType=void 0;(function(p){p[p.BEVEL=0]="BEVEL";p[p.ROUND=1]="ROUND";p[p.MITER=2]="MITER";p[p.UNKNOWN=4]="UNKNOWN"})(m.JoinType||(m.JoinType={}));m.Alignment=void 0;(function(p){p[p.SCREEN=0]="SCREEN";p[p.MAP=1]="MAP"})(m.Alignment||(m.Alignment={}));m.ExternalColorMixMode=void 0;(function(p){p[p.Tint=0]="Tint";p[p.Ignore=1]="Ignore";p[p.Multiply=99]="Multiply"})(m.ExternalColorMixMode||
(m.ExternalColorMixMode={}));m.ExtremityPlacement=void 0;(function(p){p.Both="Both";p.JustBegin="JustBegin";p.JustEnd="JustEnd";p.None="None"})(m.ExtremityPlacement||(m.ExtremityPlacement={}));m.FillMode=void 0;(function(p){p[p.Mosaic=0]="Mosaic";p[p.Centered=1]="Centered"})(m.FillMode||(m.FillMode={}));m.FontEffects=void 0;(function(p){p[p.Normal=0]="Normal";p[p.Superscript=1]="Superscript";p[p.Subscript=2]="Subscript"})(m.FontEffects||(m.FontEffects={}));m.FontEncoding=void 0;(function(p){p[p.MSSymbol=
0]="MSSymbol";p[p.Unicode=1]="Unicode"})(m.FontEncoding||(m.FontEncoding={}));m.FontType=void 0;(function(p){p[p.Unspecified=0]="Unspecified";p[p.TrueType=1]="TrueType";p[p.PSOpenType=2]="PSOpenType";p[p.TTOpenType=3]="TTOpenType";p[p.Type1=4]="Type1"})(m.FontType||(m.FontType={}));m.AngleAlignment=void 0;(function(p){p[p.Display=0]="Display";p[p.Map=1]="Map"})(m.AngleAlignment||(m.AngleAlignment={}));m.AnimatedSymbolRepeatType=void 0;(function(p){p.None="None";p.Loop="Loop";p.Oscillate="Oscillate"})(m.AnimatedSymbolRepeatType||
(m.AnimatedSymbolRepeatType={}));m.DominantSizeAxis=void 0;(function(p){p[p.Z=0]="Z";p[p.X=1]="X";p[p.Y=2]="Y"})(m.DominantSizeAxis||(m.DominantSizeAxis={}));m.RotationOrder=void 0;(function(p){p[p.XYZ=0]="XYZ";p[p.ZXY=1]="ZXY";p[p.YXZ=2]="YXZ"})(m.RotationOrder||(m.RotationOrder={}));m.BalloonCalloutStyle=void 0;(function(p){p[p.Rectangle=0]="Rectangle";p[p.RoundedRectangle=1]="RoundedRectangle";p[p.Oval=2]="Oval"})(m.BalloonCalloutStyle||(m.BalloonCalloutStyle={}));m.BlendingMode=void 0;(function(p){p[p.None=
0]="None";p[p.Alpha=1]="Alpha";p[p.Screen=2]="Screen";p[p.Multiply=3]="Multiply";p[p.Add=4]="Add"})(m.BlendingMode||(m.BlendingMode={}));m.BlockProgression=void 0;(function(p){p[p.TTB=0]="TTB";p[p.RTL=1]="RTL";p[p.BTT=2]="BTT"})(m.BlockProgression||(m.BlockProgression={}));m.BillBoardMode=void 0;(function(p){p[p.None=0]="None";p[p.SignPost=1]="SignPost";p[p.FaceNearPlane=2]="FaceNearPlane"})(m.BillBoardMode||(m.BillBoardMode={}));m.CGAAttributeType=void 0;(function(p){p[p.Float=0]="Float";p[p.String=
1]="String";p[p.Boolean=2]="Boolean"})(m.CGAAttributeType||(m.CGAAttributeType={}));m.ClippingType=void 0;(function(p){p[p.Intersect=0]="Intersect";p[p.Subtract=1]="Subtract"})(m.ClippingType||(m.ClippingType={}));m.GeometricEffectArrowType=void 0;(function(p){p.OpenEnded="OpenEnded";p.Block="Block";p.Crossed="Crossed"})(m.GeometricEffectArrowType||(m.GeometricEffectArrowType={}));m.GeometricEffectControlMeasureLineRule=void 0;(function(p){p.FullGeometry="FullGeometry";p.PerpendicularFromFirstSegment=
"PerpendicularFromFirstSegment";p.ReversedFirstSegment="ReversedFirstSegment";p.PerpendicularToSecondSegment="PerpendicularToSecondSegment";p.SecondSegmentWithTicks="SecondSegmentWithTicks";p.DoublePerpendicular="DoublePerpendicular";p.OppositeToFirstSegment="OppositeToFirstSegment";p.TriplePerpendicular="TriplePerpendicular";p.HalfCircleFirstSegment="HalfCircleFirstSegment";p.HalfCircleSecondSegment="HalfCircleSecondSegment";p.HalfCircleExtended="HalfCircleExtended";p.OpenCircle="OpenCircle";p.CoverageEdgesWithTicks=
"CoverageEdgesWithTicks";p.GapExtentWithDoubleTicks="GapExtentWithDoubleTicks";p.GapExtentMidline="GapExtentMidline";p.Chevron="Chevron";p.PerpendicularWithArc="PerpendicularWithArc";p.ClosedHalfCircle="ClosedHalfCircle";p.TripleParallelExtended="TripleParallelExtended";p.ParallelWithTicks="ParallelWithTicks";p.Parallel="Parallel";p.PerpendicularToFirstSegment="PerpendicularToFirstSegment";p.ParallelOffset="ParallelOffset";p.OffsetOpposite="OffsetOpposite";p.OffsetSame="OffsetSame";p.CircleWithArc=
"CircleWithArc";p.DoubleJog="DoubleJog";p.PerpendicularOffset="PerpendicularOffset";p.LineExcludingLastSegment="LineExcludingLastSegment";p.MultivertexArrow="MultivertexArrow";p.CrossedArrow="CrossedArrow";p.ChevronArrow="ChevronArrow";p.ChevronArrowOffset="ChevronArrowOffset";p.PartialFirstSegment="PartialFirstSegment";p.Arch="Arch";p.CurvedParallelTicks="CurvedParallelTicks";p.Arc90Degrees="Arc90Degrees"})(m.GeometricEffectControlMeasureLineRule||(m.GeometricEffectControlMeasureLineRule={}));m.GeometricEffectDonutMethod=
void 0;(function(p){p.Mitered="Mitered";p.Bevelled="Bevelled";p.Rounded="Rounded";p.Square="Square";p.TrueBuffer="TrueBuffer"})(m.GeometricEffectDonutMethod||(m.GeometricEffectDonutMethod={}));m.GeometricEffectEnclosingPolygonMethod=void 0;(function(p){p.ClosePath="ClosePath";p.ConvexHull="ConvexHull";p.RectangularBox="RectangularBox"})(m.GeometricEffectEnclosingPolygonMethod||(m.GeometricEffectEnclosingPolygonMethod={}));m.GeometricEffectExtensionOrigin=void 0;(function(p){p.BeginningOfLine="BeginningOfLine";
p.EndOfLine="EndOfLine"})(m.GeometricEffectExtensionOrigin||(m.GeometricEffectExtensionOrigin={}));m.GeometricEffectOffsetMethod=void 0;(function(p){p.Mitered="Mitered";p.Bevelled="Bevelled";p.Rounded="Rounded";p.Square="Square"})(m.GeometricEffectOffsetMethod||(m.GeometricEffectOffsetMethod={}));m.GeometricEffectOffsetOption=void 0;(function(p){p.Fast="Fast";p.Accurate="Accurate"})(m.GeometricEffectOffsetOption||(m.GeometricEffectOffsetOption={}));m.GeometricEffectOffsetTangentMethod=void 0;(function(p){p.BeginningOfLine=
"BeginningOfLine";p.EndOfLine="EndOfLine"})(m.GeometricEffectOffsetTangentMethod||(m.GeometricEffectOffsetTangentMethod={}));m.GeometricEffectWaveform=void 0;(function(p){p.Sinus="Sinus";p.Square="Square";p.Triangle="Triangle";p.Random="Random"})(m.GeometricEffectWaveform||(m.GeometricEffectWaveform={}));m.GlyphHinting=void 0;(function(p){p[p.None=0]="None";p[p.Default=1]="Default";p[p.Force=2]="Force"})(m.GlyphHinting||(m.GlyphHinting={}));m.GradientAlignment=void 0;(function(p){p[p.Buffered=0]=
"Buffered";p[p.Left=1]="Left";p[p.Right=2]="Right";p[p.AlongLine=3]="AlongLine"})(m.GradientAlignment||(m.GradientAlignment={}));m.GradientFillMethod=void 0;(function(p){p[p.Linear=0]="Linear";p[p.Rectangular=1]="Rectangular";p[p.Circular=2]="Circular";p[p.Buffered=3]="Buffered"})(m.GradientFillMethod||(m.GradientFillMethod={}));m.GradientStrokeType=void 0;(function(p){p[p.Discrete=0]="Discrete";p[p.Continuous=1]="Continuous"})(m.GradientStrokeType||(m.GradientStrokeType={}));m.GradientStrokeMethod=
void 0;(function(p){p[p.AcrossLine=0]="AcrossLine";p[p.AloneLine=1]="AloneLine"})(m.GradientStrokeMethod||(m.GradientStrokeMethod={}));m.HorizontalAlignment=void 0;(function(p){p[p.Left=0]="Left";p[p.Right=1]="Right";p[p.Center=2]="Center";p[p.Justify=3]="Justify"})(m.HorizontalAlignment||(m.HorizontalAlignment={}));m.LeaderLineStyle=void 0;(function(p){p[p.Base=0]="Base";p[p.MidPoint=1]="MidPoint";p[p.ThreePoint=2]="ThreePoint";p[p.FourPoint=3]="FourPoint";p[p.Underline=4]="Underline";p[p.CircularCW=
5]="CircularCW";p[p.CircularCCW=6]="CircularCCW"})(m.LeaderLineStyle||(m.LeaderLineStyle={}));m.LineCapStyle=void 0;(function(p){p.Butt="Butt";p.Round="Round";p.Square="Square"})(m.LineCapStyle||(m.LineCapStyle={}));m.LineDashEnding=void 0;(function(p){p.NoConstraint="NoConstraint";p.HalfPattern="HalfPattern";p.HalfGap="HalfGap";p.FullPattern="FullPattern";p.FullGap="FullGap";p.Custom="Custom"})(m.LineDashEnding||(m.LineDashEnding={}));m.LineDecorationStyle=void 0;(function(p){p[p.None=-1]="None";
p[p.Custom=0]="Custom";p[p.Circle=1]="Circle";p[p.OpenArrow=2]="OpenArrow";p[p.ClosedArrow=3]="ClosedArrow";p[p.Diamond=4]="Diamond"})(m.LineDecorationStyle||(m.LineDecorationStyle={}));m.LineGapType=void 0;(function(p){p[p.ExtraLeading=0]="ExtraLeading";p[p.Multiple=1]="Multiple";p[p.Exact=2]="Exact"})(m.LineGapType||(m.LineGapType={}));m.LineJoinStyle=void 0;(function(p){p.Bevel="Bevel";p.Round="Round";p.Miter="Miter"})(m.LineJoinStyle||(m.LineJoinStyle={}));m.ExpressionReturnType=void 0;(function(p){p[p.Default=
0]="Default";p[p.String=1]="String";p[p.Numeric=2]="Numeric"})(m.ExpressionReturnType||(m.ExpressionReturnType={}));m.MarkerPlacementType=void 0;(function(p){p[p.InsidePolygon=0]="InsidePolygon";p[p.PolygonCenter=1]="PolygonCenter";p[p.RandomlyInsidePolygon=2]="RandomlyInsidePolygon"})(m.MarkerPlacementType||(m.MarkerPlacementType={}));m.MaterialMode=void 0;(function(p){p[p.Tint=0]="Tint";p[p.Replace=1]="Replace";p[p.Multiply=2]="Multiply"})(m.MaterialMode||(m.MaterialMode={}));m.PlacementClip=void 0;
(function(p){p[p.ClipAtBoundary=0]="ClipAtBoundary";p[p.RemoveIfCenterOutsideBoundary=1]="RemoveIfCenterOutsideBoundary";p[p.DoNotTouchBoundary=2]="DoNotTouchBoundary";p[p.DoNotClip=3]="DoNotClip"})(m.PlacementClip||(m.PlacementClip={}));m.PlacementEndings=void 0;(function(p){p.NoConstraint="NoConstraint";p.WithMarkers="WithMarkers";p.WithFullGap="WithFullGap";p.WithHalfGap="WithHalfGap";p.Custom="Custom"})(m.PlacementEndings||(m.PlacementEndings={}));m.PlacementGridType=void 0;(function(p){p.Fixed=
"Fixed";p.Random="Random";p.RandomFixedQuantity="RandomFixedQuantity"})(m.PlacementGridType||(m.PlacementGridType={}));m.PlacementOnLineRelativeTo=void 0;(function(p){p.LineMiddle="LineMiddle";p.LineBeginning="LineBeginning";p.LineEnd="LineEnd";p.SegmentMidpoint="SegmentMidpoint"})(m.PlacementOnLineRelativeTo||(m.PlacementOnLineRelativeTo={}));m.PlacementPolygonCenterMethod=void 0;(function(p){p.OnPolygon="OnPolygon";p.CenterOfMass="CenterOfMass";p.BoundingBoxCenter="BoundingBoxCenter"})(m.PlacementPolygonCenterMethod||
(m.PlacementPolygonCenterMethod={}));m.PlacementRandomlyAlongLineRandomization=void 0;(function(p){p[p.Low=0]="Low";p[p.Medium=1]="Medium";p[p.High=2]="High"})(m.PlacementRandomlyAlongLineRandomization||(m.PlacementRandomlyAlongLineRandomization={}));m.PlacementStepPosition=void 0;(function(p){p[p.MarkerCenter=0]="MarkerCenter";p[p.MarkerBounds=1]="MarkerBounds"})(m.PlacementStepPosition||(m.PlacementStepPosition={}));m.PointSymbolCalloutScale=void 0;(function(p){p[p.None=0]="None";p[p.PropUniform=
1]="PropUniform";p[p.PropNonuniform=2]="PropNonuniform";p[p.DifUniform=3]="DifUniform";p[p.DifNonuniform=4]="DifNonuniform"})(m.PointSymbolCalloutScale||(m.PointSymbolCalloutScale={}));m.Simple3DLineStyle=void 0;(function(p){p.Tube="Tube";p.Strip="Strip";p.Wall="Wall"})(m.Simple3DLineStyle||(m.Simple3DLineStyle={}));m.SizeVariationMethod=void 0;(function(p){p[p.Random=0]="Random";p[p.Increasing=1]="Increasing";p[p.Decreasing=2]="Decreasing";p[p.IncreasingThenDecreasing=3]="IncreasingThenDecreasing"})(m.SizeVariationMethod||
(m.SizeVariationMethod={}));m.SymbolUnits=void 0;(function(p){p[p.Relative=0]="Relative";p[p.Absolute=1]="Absolute"})(m.SymbolUnits||(m.SymbolUnits={}));m.TextCase=void 0;(function(p){p[p.Normal=0]="Normal";p[p.LowerCase=1]="LowerCase";p[p.Allcaps=2]="Allcaps"})(m.TextCase||(m.TextCase={}));m.TextReadingDirection=void 0;(function(p){p[p.LTR=0]="LTR";p[p.RTL=1]="RTL"})(m.TextReadingDirection||(m.TextReadingDirection={}));m.TextureFilter=void 0;(function(p){p.Draft="Draft";p.Picture="Picture";p.Text=
"Text"})(m.TextureFilter||(m.TextureFilter={}));m.VerticalAlignment=void 0;(function(p){p[p.Top=0]="Top";p[p.Center=1]="Center";p[p.Baseline=2]="Baseline";p[p.Bottom=3]="Bottom"})(m.VerticalAlignment||(m.VerticalAlignment={}));m.VerticalGlyphOrientation=void 0;(function(p){p[p.Right=0]="Right";p[p.Upright=1]="Upright"})(m.VerticalGlyphOrientation||(m.VerticalGlyphOrientation={}));m.WaterbodySize=void 0;(function(p){p[p.Small=0]="Small";p[p.Medium=1]="Medium";p[p.Large=2]="Large"})(m.WaterbodySize||
(m.WaterbodySize={}));m.WaveStrength=void 0;(function(p){p[p.Calm=0]="Calm";p[p.Rippled=1]="Rippled";p[p.Slight=2]="Slight";p[p.Moderate=3]="Moderate"})(m.WaveStrength||(m.WaveStrength={}));Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/shaders/BackgroundPrograms":function(){define(["exports","./sources/resolver"],function(m,p){p={shaders:{vertexShader:p.resolveIncludes("background/background.vert"),fragmentShader:p.resolveIncludes("background/background.frag")},
attributes:new Map([["a_pos",0]])};m.background=p;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/shaders/sources/resolver":function(){define(["exports","./shaderRepository","../../../../../webgl/ShaderCompiler"],function(m,p,D){const B=new D.ShaderCompiler(function(u){let t=p;u.split("/").forEach(h=>{t&&(t=t[h])});return t});m.resolveIncludes=function(u){return B.resolveIncludes(u)};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/shaders/sources/shaderRepository":function(){define(function(){return{background:{"background.frag":"uniform lowp vec4 u_color;\nvoid main() {\ngl_FragColor \x3d u_color;\n}",
"background.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump vec2 u_coord_range;\nuniform mediump float u_depth;\nvoid main() {\nvec3 v_pos \x3d u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0);\ngl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\n}"},bitBlit:{"bitBlit.frag":"uniform lowp sampler2D u_tex;\nuniform lowp float u_opacity;\nvarying mediump vec2 v_uv;\nvoid main() {\nlowp vec4 color \x3d texture2D(u_tex, v_uv);\ngl_FragColor \x3d color *  u_opacity;\n}","bitBlit.vert":"attribute vec2 a_pos;\nattribute vec2 a_tex;\nvarying mediump vec2 v_uv;\nvoid main(void) {\ngl_Position \x3d vec4(a_pos, 0.0, 1.0);\nv_uv \x3d a_tex;\n}"},
blend:{"blend.frag":"precision mediump float;\nuniform sampler2D u_layerTexture;\nuniform lowp float u_opacity;\nuniform lowp float u_inFadeOpacity;\n#ifndef NORMAL\nuniform sampler2D u_backbufferTexture;\n#endif\nvarying mediump vec2 v_uv;\nfloat rgb2v(in vec3 c) {\nreturn max(c.x, max(c.y, c.z));\n}\nvec3 rgb2hsv(in vec3 c) {\nvec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\nvec4 p \x3d c.g \x3c c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\nvec4 q \x3d c.r \x3c p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\nfloat d \x3d q.x - min(q.w, q.y);\nfloat e \x3d 1.0e-10;\nreturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n}\nvec3 hsv2rgb(in vec3 c) {\nvec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\nvec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\nreturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nvec3 tint(in vec3 Cb, in vec3 Cs) {\nfloat vIn \x3d rgb2v(Cb);\nvec3 hsvTint \x3d rgb2hsv(Cs);\nvec3 hsvOut \x3d vec3(hsvTint.x, hsvTint.y, vIn * hsvTint.z);\nreturn hsv2rgb(hsvOut);\n}\nfloat overlay(in float Cb, in float Cs) {\nreturn (1.0 - step(0.5, Cs)) * (1.0 - 2.0 * (1.0 - Cs ) * (1.0 - Cb)) + step(0.5, Cs) * (2.0 * Cs * Cb);\n}\nfloat colorDodge(in float Cb, in float Cs) {\nreturn (Cb \x3d\x3d 0.0) ? 0.0 : (Cs \x3d\x3d 1.0) ? 1.0 : min(1.0, Cb / (1.0 - Cs));\n}\nfloat colorBurn(in float Cb, in float Cs) {\nreturn (Cb \x3d\x3d 1.0) ? 1.0 : (Cs \x3d\x3d 0.0) ? 0.0 : 1.0 - min(1.0, (1.0 - Cb) / Cs);\n}\nfloat hardLight(in float Cb, in float Cs) {\nreturn (1.0 - step(0.5, Cs)) * (2.0 * Cs * Cb) + step(0.5, Cs) * (1.0 - 2.0 * (1.0 - Cs) * (1.0 - Cb));\n}\nfloat reflectBlend(in float Cb, in float Cs) {\nreturn (Cs \x3d\x3d 1.0) ? Cs : min(Cb * Cb / (1.0 - Cs), 1.0);\n}\nfloat softLight(in float Cb, in float Cs) {\nif (Cs \x3c\x3d 0.5) {\nreturn Cb - (1.0 - 2.0 * Cs) * Cb * (1.0 - Cb);\n}\nif (Cb \x3c\x3d 0.25) {\nreturn Cb + (2.0 * Cs - 1.0) * Cb * ((16.0 * Cb - 12.0) * Cb + 3.0);\n}\nreturn Cb + (2.0 * Cs - 1.0) * (sqrt(Cb) - Cb);\n}\nfloat vividLight(in float Cb, in float Cs) {\nreturn (1.0 - step(0.5, Cs)) * colorBurn(Cb, 2.0 * Cs) + step(0.5, Cs) * colorDodge(Cb, (2.0 * (Cs - 0.5)));\n}\nfloat minv3(in vec3 c) {\nreturn min(min(c.r, c.g), c.b);\n}\nfloat maxv3(in vec3 c) {\nreturn max(max(c.r, c.g), c.b);\n}\nfloat lumv3(in vec3 c) {\nreturn dot(c, vec3(0.3, 0.59, 0.11));\n}\nfloat satv3(vec3 c) {\nreturn maxv3(c) - minv3(c);\n}\nvec3 clipColor(vec3 color) {\nfloat lum \x3d lumv3(color);\nfloat mincol \x3d minv3(color);\nfloat maxcol \x3d maxv3(color);\nif (mincol \x3c 0.0) {\ncolor \x3d lum + ((color - lum) * lum) / (lum - mincol);\n}\nif (maxcol \x3e 1.0) {\ncolor \x3d lum + ((color - lum) * (1.0 - lum)) / (maxcol - lum);\n}\nreturn color;\n}\nvec3 setLum(vec3 cbase, vec3 clum) {\nfloat lbase \x3d lumv3(cbase);\nfloat llum \x3d lumv3(clum);\nfloat ldiff \x3d llum - lbase;\nvec3 color \x3d cbase + vec3(ldiff);\nreturn clipColor(color);\n}\nvec3 setLumSat(vec3 cbase, vec3 csat, vec3 clum)\n{\nfloat minbase \x3d minv3(cbase);\nfloat sbase \x3d satv3(cbase);\nfloat ssat \x3d satv3(csat);\nvec3 color;\nif (sbase \x3e 0.0) {\ncolor \x3d (cbase - minbase) * ssat / sbase;\n} else {\ncolor \x3d vec3(0.0);\n}\nreturn setLum(color, clum);\n}\nvoid main() {\nvec4 src \x3d texture2D(u_layerTexture, v_uv);\n#ifdef NORMAL\ngl_FragColor \x3d src *  u_opacity;\n#else\nvec4 dst \x3d texture2D(u_backbufferTexture, v_uv);\nvec3 Cs \x3d src.a \x3d\x3d 0.0 ? src.rgb : vec3(src.rgb / src.a);\nvec3 Cb \x3d dst.a \x3d\x3d 0.0 ? dst.rgb : vec3(dst.rgb / dst.a);\nfloat as \x3d u_opacity * src.a;\nfloat ab \x3d dst.a;\n#ifdef DESTINATION_OVER\ngl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb, as + ab - as * ab);\n#endif\n#ifdef SOURCE_IN\nvec4 color \x3d vec4(as * Cs * ab, as * ab);\nvec4 fadeColor \x3d (1.0 - u_opacity) * u_inFadeOpacity * vec4(ab * Cb, ab);\ngl_FragColor \x3d color + fadeColor;\n#endif\n#ifdef DESTINATION_IN\nvec4 color \x3d vec4(ab * Cb * as, ab * as);\nvec4 fadeColor \x3d (1.0 - u_opacity) * u_inFadeOpacity * vec4(ab * Cb, ab);\ngl_FragColor \x3d color + fadeColor;\n#endif\n#ifdef SOURCE_OUT\ngl_FragColor \x3d vec4(as * Cs * (1.0 - ab), as * (1.0 - ab));\n#endif\n#ifdef DESTINATION_OUT\ngl_FragColor \x3d vec4(ab * Cb * (1.0 - as), ab * (1.0 - as));\n#endif\n#ifdef SOURCE_ATOP\ngl_FragColor \x3d vec4(as * Cs * ab + ab * Cb * (1.0 - as), ab);\n#endif\n#ifdef DESTINATION_ATOP\ngl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb * as, as);\n#endif\n#ifdef XOR\ngl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb * (1.0 - as),\nas * (1.0 - ab) + ab * (1.0 - as));\n#endif\n#ifdef MULTIPLY\ngl_FragColor \x3d vec4(as * Cs * ab * Cb + (1.0 - ab) * as * Cs + (1.0 - as) * ab * Cb,\nas + ab * (1.0 - as));\n#endif\n#ifdef SCREEN\ngl_FragColor \x3d vec4((Cs + Cb - Cs * Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef OVERLAY\nvec3 f \x3d vec3(overlay(Cb.r, Cs.r), overlay(Cb.g, Cs.g), overlay(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef DARKEN\ngl_FragColor \x3d vec4(min(Cs, Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef LIGHTER\ngl_FragColor \x3d vec4(as * Cs + ab * Cb, as + ab);\n#endif\n#ifdef LIGHTEN\ngl_FragColor \x3d vec4(max(Cs, Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef COLOR_DODGE\nvec3 f \x3d clamp(vec3(colorDodge(Cb.r, Cs.r), colorDodge(Cb.g, Cs.g), colorDodge(Cb.b, Cs.b)), vec3(0.0), vec3(1.0));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef COLOR_BURN\nvec3 f \x3d vec3(colorBurn(Cb.r, Cs.r), colorBurn(Cb.g, Cs.g), colorBurn(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef HARD_LIGHT\nvec3 f \x3d vec3(hardLight(Cb.r, Cs.r), hardLight(Cb.g, Cs.g), hardLight(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef SOFT_LIGHT\nvec3 f \x3d vec3(softLight(Cb.r, Cs.r), softLight(Cb.g, Cs.g), softLight(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef DIFFERENCE\ngl_FragColor \x3d vec4(abs(Cb - Cs) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef EXCLUSION\nvec3 f \x3d Cs + Cb - 2.0 * Cs * Cb;\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef INVERT\ngl_FragColor \x3d vec4((1.0 - Cb) * as * ab + Cb * ab * (1.0 - as), ab);\n#endif\n#ifdef VIVID_LIGHT\nvec3 f \x3d vec3(clamp(vividLight(Cb.r, Cs.r), 0.0, 1.0),\nclamp(vividLight(Cb.g, Cs.g), 0.0, 1.0),\nclamp(vividLight(Cb.b, Cs.b), 0.0, 1.0));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef HUE\nvec3 f \x3d setLumSat(Cs,Cb,Cb);\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef SATURATION\nvec3 f \x3d setLumSat(Cb,Cs,Cb);\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef COLOR\nvec3 f \x3d setLum(Cs,Cb);\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef LUMINOSITY\nvec3 f \x3d setLum(Cb,Cs);\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef PLUS\ngl_FragColor \x3d clamp(vec4(src.r + Cb.r, src.g + Cb.g, src.b + Cb.b, as + ab), 0.0, 1.0);\n#endif\n#ifdef MINUS\ngl_FragColor \x3d vec4(clamp(vec3(Cb.r - src.r, Cb.g - src.g, Cb.b - src.b), 0.0, 1.0), ab * as);\n#endif\n#ifdef AVERAGE\nvec3 f \x3d (Cb + Cs) / 2.0;\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef REFLECT\nvec3 f \x3d clamp(vec3(reflectBlend(Cb.r, Cs.r),\nreflectBlend(Cb.g, Cs.g),\nreflectBlend(Cb.b, Cs.b)), vec3(0.0), vec3(1.0));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#endif\n}",
"blend.vert":"attribute vec2 a_position;\nvarying mediump vec2 v_uv;\nvoid main(void) {\ngl_Position \x3d vec4(a_position , 0.0, 1.0);\nv_uv \x3d (a_position + 1.0) / 2.0;\n}"},debug:{overlay:{"overlay.frag":"precision mediump float;\nvarying vec4 v_color;\nvoid main(void) {\ngl_FragColor \x3d v_color;\n}","overlay.vert":"attribute vec3 a_PositionAndFlags;\nuniform mat3 u_dvsMat3;\nuniform vec4 u_colors[4];\nuniform float u_opacities[4];\nvarying vec4 v_color;\nvoid main(void) {\nvec2 position \x3d a_PositionAndFlags.xy;\nfloat flags \x3d a_PositionAndFlags.z;\nint colorIndex \x3d int(mod(flags, 4.0));\nvec4 color;\nfor (int i \x3d 0; i \x3c 4; i++) {\ncolor \x3d u_colors[i];\nif (i \x3d\x3d colorIndex) {\nbreak;\n}\n}\nint opacityIndex \x3d int(mod(floor(flags / 4.0), 4.0));\nfloat opacity;\nfor (int i \x3d 0; i \x3c 4; i++) {\nopacity \x3d u_opacities[i];\nif (i \x3d\x3d opacityIndex) {\nbreak;\n}\n}\nv_color \x3d color * opacity;\ngl_Position \x3d vec4((u_dvsMat3 * vec3(position, 1.0)).xy, 0.0, 1.0);\n}"}},
dot:{dot:{"dot.frag":"precision mediump float;\nvarying vec4 v_color;\nvarying float v_dotRatio;\nvarying float v_invEdgeRatio;\nuniform highp float u_tileZoomFactor;\nvoid main()\n{\nfloat dist \x3d length(gl_PointCoord - vec2(.5, .5)) * 2.;\nfloat alpha \x3d smoothstep(0., 1., v_invEdgeRatio * (dist - v_dotRatio) + 1.);\ngl_FragColor \x3d v_color * alpha;\n}","dot.vert":"precision highp float;\nattribute vec2 a_pos;\nuniform sampler2D u_texture;\nuniform highp mat3 u_dvsMat3;\nuniform highp float u_tileZoomFactor;\nuniform highp float u_dotSize;\nuniform highp float u_pixelRatio;\nvarying vec2 v_pos;\nvarying vec4 v_color;\nvarying float v_dotRatio;\nvarying float v_invEdgeRatio;\nconst float EPSILON \x3d 0.000001;\nvoid main()\n{\nmat3 tileToTileTexture \x3d mat3(  1., 0., 0.,\n0., -1., 0.,\n0., 1., 1.  );\nvec3 texCoords \x3d tileToTileTexture * vec3(a_pos.xy / 512., 1.);\nv_color \x3d texture2D(u_texture, texCoords.xy);\nfloat smoothEdgeWidth \x3d max(u_dotSize / 2., 1.) ;\nfloat z \x3d 0.;\nz +\x3d 2.0 * step(v_color.a, EPSILON);\ngl_PointSize \x3d (smoothEdgeWidth + u_dotSize);\ngl_Position \x3d vec4((u_dvsMat3 * vec3(a_pos + .5, 1.)).xy, z, 1.);\nv_dotRatio \x3d u_dotSize / gl_PointSize;\nv_invEdgeRatio \x3d -1. / ( smoothEdgeWidth / gl_PointSize );\ngl_PointSize  *\x3d (u_pixelRatio * u_tileZoomFactor);\n}"}},
filtering:{"bicubic.glsl":"vec4 computeWeights(float v) {\nfloat b \x3d 1.0 / 6.0;\nfloat v2 \x3d v * v;\nfloat v3 \x3d v2 * v;\nfloat w0 \x3d b * (-v3 + 3.0 * v2 - 3.0 * v + 1.0);\nfloat w1 \x3d b * (3.0 * v3  - 6.0 * v2 + 4.0);\nfloat w2 \x3d b * (-3.0 * v3 + 3.0 * v2 + 3.0 * v + 1.0);\nfloat w3 \x3d b * v3;\nreturn vec4(w0, w1, w2, w3);\n}\nvec4 bicubicOffsetsAndWeights(float v) {\nvec4 w \x3d computeWeights(v);\nfloat g0 \x3d w.x + w.y;\nfloat g1 \x3d w.z + w.w;\nfloat h0 \x3d 1.0 - (w.y / g0) + v;\nfloat h1 \x3d 1.0 + (w.w / g1) - v;\nreturn vec4(h0, h1, g0, g1);\n}\nvec4 sampleBicubicBSpline(sampler2D sampler, vec2 coords, vec2 texSize) {\nvec2 eX \x3d vec2(1.0 / texSize.x, 0.0);\nvec2 eY \x3d vec2(0.0, 1.0 / texSize.y);\nvec2 texel \x3d coords * texSize - 0.5;\nvec3 hgX \x3d bicubicOffsetsAndWeights(fract(texel).x).xyz;\nvec3 hgY \x3d bicubicOffsetsAndWeights(fract(texel).y).xyz;\nvec2 coords10 \x3d coords + hgX.x * eX;\nvec2 coords00 \x3d coords - hgX.y * eX;\nvec2 coords11 \x3d coords10 + hgY.x * eY;\nvec2 coords01 \x3d coords00 + hgY.x * eY;\ncoords10 \x3d coords10 - hgY.y * eY;\ncoords00 \x3d coords00 - hgY.y * eY;\nvec4 color00 \x3d texture2D(sampler, coords00);\nvec4 color10 \x3d texture2D(sampler, coords10);\nvec4 color01 \x3d texture2D(sampler, coords01);\nvec4 color11 \x3d texture2D(sampler, coords11);\ncolor00 \x3d mix(color00, color01, hgY.z);\ncolor10 \x3d mix(color10, color11, hgY.z);\ncolor00 \x3d mix(color00, color10, hgX.z);\nreturn color00;\n}",
"bilinear.glsl":"vec4 sampleBilinear(sampler2D sampler, vec2 coords, vec2 texSize) {\nvec2 texelStart \x3d floor(coords * texSize);\nvec2 coord0 \x3d texelStart / texSize;\nvec2 coord1 \x3d (texelStart +  vec2(1.0, 0.0)) / texSize;\nvec2 coord2 \x3d (texelStart +  vec2(0.0, 1.0)) / texSize;\nvec2 coord3 \x3d (texelStart +  vec2(1.0, 1.0)) / texSize;\nvec4 color0 \x3d texture2D(sampler, coord0);\nvec4 color1 \x3d texture2D(sampler, coord1);\nvec4 color2 \x3d texture2D(sampler, coord2);\nvec4 color3 \x3d texture2D(sampler, coord3);\nvec2 blend \x3d fract(coords * texSize);\nvec4 color01 \x3d mix(color0, color1, blend.x);\nvec4 color23 \x3d mix(color2, color3, blend.x);\nvec4 color \x3d mix(color01, color23, blend.y);\n#ifdef NNEDGE\nfloat alpha \x3d floor(color0.a * color1.a * color2.a * color3.a + 0.5);\ncolor \x3d color * alpha + (1.0 - alpha) * texture2D(sampler, coords);\n#endif\nreturn color;\n}",
"epx.glsl":"vec4 sampleEPX(sampler2D sampler, float size, vec2 coords, vec2 texSize) {\nvec2 invSize \x3d 1.0 / texSize;\nvec2 texel \x3d coords * texSize;\nvec2 texel_i \x3d floor(texel);\nvec2 texel_frac \x3d fract(texel);\nvec4 colorP \x3d texture2D(sampler, texel_i * invSize);\nvec4 colorP1 \x3d vec4(colorP);\nvec4 colorP2 \x3d vec4(colorP);\nvec4 colorP3 \x3d vec4(colorP);\nvec4 colorP4 \x3d vec4(colorP);\nvec4 colorA \x3d texture2D(sampler, (texel_i - vec2(0.0, 1.0)) * invSize);\nvec4 colorB \x3d texture2D(sampler, (texel_i + vec2(1.0, 0.0)) * invSize);\nvec4 colorC \x3d texture2D(sampler, (texel_i - vec2(1.0, 0.0)) * invSize);\nvec4 colorD \x3d texture2D(sampler, (texel_i + vec2(0.0, 1.0)) * invSize);\nif (colorC \x3d\x3d colorA \x26\x26 colorC !\x3d colorD \x26\x26 colorA !\x3d colorB) {\ncolorP1 \x3d colorA;\n}\nif (colorA \x3d\x3d colorB \x26\x26 colorA !\x3d colorC \x26\x26 colorB !\x3d colorD) {\ncolorP2 \x3d colorB;\n}\nif (colorD \x3d\x3d colorC \x26\x26 colorD !\x3d colorB \x26\x26 colorC !\x3d colorA) {\ncolorP3 \x3d colorC;\n}\nif (colorB \x3d\x3d colorD \x26\x26 colorB !\x3d colorA \x26\x26 colorD !\x3d colorC) {\ncolorP4 \x3d colorD;\n}\nvec4 colorP12 \x3d mix(colorP1, colorP2, texel_frac.x);\nvec4 colorP34 \x3d mix(colorP1, colorP2, texel_frac.x);\nreturn mix(colorP12, colorP34, texel_frac.y);\n}"},
fx:{integrate:{"integrate.frag":"precision mediump float;\nuniform lowp sampler2D u_sourceTexture;\nuniform lowp sampler2D u_maskTexture;\nuniform mediump float u_zoomLevel;\nuniform highp float u_timeDelta;\nuniform highp float u_animationTime;\nvarying highp vec2 v_texcoord;\n#include \x3cmaterials/utils.glsl\x3e\nvoid main()\n{\n#ifdef DELTA\nvec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\nvec4 data0 \x3d texture2D(u_maskTexture, v_texcoord);\nfloat flags \x3d data0.r * 255.0;\nfloat groupMinZoom \x3d data0.g * 255.0;\nfloat isVisible \x3d getFilterBit(flags, 0);\nfloat wouldClip \x3d step(groupMinZoom, u_zoomLevel);\nfloat direction \x3d wouldClip * 1.0 + (1.0 - wouldClip) * -1.0;\nfloat dt \x3d u_timeDelta / max(u_animationTime, 0.0001);\nvec4 nextState \x3d vec4(texel + direction * dt);\ngl_FragColor \x3d  vec4(nextState);\n#elif defined(UPDATE)\nvec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\ngl_FragColor \x3d texel;\n#endif\n}",
"integrate.vert":"precision mediump float;\nattribute vec2 a_pos;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos;\ngl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}"}},heatmap:{heatmapResolve:{"heatmapResolve.frag":"precision highp float;\n#ifdef HEATMAP_PRECISION_HALF_FLOAT\n#define COMPRESSION_FACTOR 4.0\n#else\n#define COMPRESSION_FACTOR 1.0\n#endif\nuniform sampler2D u_texture;\nuniform sampler2D u_gradient;\nuniform vec2 u_densityMinAndInvRange;\nuniform float u_densityNormalization;\nvarying vec2 v_uv;\nvoid main() {\nvec4 data \x3d texture2D(u_texture, v_uv);\nfloat density \x3d data.r * COMPRESSION_FACTOR;\ndensity *\x3d u_densityNormalization;\ndensity \x3d (density - u_densityMinAndInvRange.x) * u_densityMinAndInvRange.y;\nvec4 color \x3d texture2D(u_gradient, vec2(density, 0.5));\ngl_FragColor \x3d vec4(color.rgb * color.a, color.a);\n}",
"heatmapResolve.vert":"precision highp float;\nattribute vec2 a_pos;\nvarying vec2 v_uv;\nvoid main() {\nv_uv \x3d a_pos;\ngl_Position \x3d vec4(a_pos * 2.0 - 1.0, 1., 1.);\n}"}},highlight:{"blur.frag":"varying mediump vec2 v_texcoord;\nuniform mediump vec4 u_direction;\nuniform mediump mat4 u_channelSelector;\nuniform mediump float u_sigma;\nuniform sampler2D u_texture;\nmediump float gauss1(mediump vec2 dir) {\nreturn exp(-dot(dir, dir) / (2.0 * u_sigma * u_sigma));\n}\nmediump vec4 selectChannel(mediump vec4 sample) {\nreturn u_channelSelector * sample;\n}\nvoid accumGauss1(mediump float i, inout mediump float tot, inout mediump float weight) {\nmediump float w \x3d gauss1(i * u_direction.xy);\ntot +\x3d selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw))[3] * w;\nweight +\x3d w;\n}\nvoid main(void) {\nmediump float tot \x3d 0.0;\nmediump float weight \x3d 0.0;\naccumGauss1(-5.0, tot, weight);\naccumGauss1(-4.0, tot, weight);\naccumGauss1(-3.0, tot, weight);\naccumGauss1(-2.0, tot, weight);\naccumGauss1(-1.0, tot, weight);\naccumGauss1(0.0, tot, weight);\naccumGauss1(1.0, tot, weight);\naccumGauss1(2.0, tot, weight);\naccumGauss1(3.0, tot, weight);\naccumGauss1(4.0, tot, weight);\naccumGauss1(5.0, tot, weight);\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, tot / weight);\n}",
"highlight.frag":"varying mediump vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform mediump float u_sigma;\nuniform sampler2D u_shade;\nuniform mediump vec2 u_minMaxDistance;\nmediump float estimateDistance() {\nmediump float y \x3d texture2D(u_texture, v_texcoord)[3];\nconst mediump float y0 \x3d 0.5;\nmediump float m0 \x3d 1.0 / (sqrt(2.0 * 3.1415) * u_sigma);\nmediump float d \x3d (y - y0) / m0;\nreturn d;\n}\nmediump vec4 shade(mediump float d) {\nmediump float mappedDistance \x3d (d - u_minMaxDistance.x) / (u_minMaxDistance.y - u_minMaxDistance.x);\nmappedDistance \x3d clamp(mappedDistance, 0.0, 1.0);\nreturn texture2D(u_shade, vec2(mappedDistance, 0.5));\n}\nvoid main(void) {\nmediump float d \x3d estimateDistance();\ngl_FragColor \x3d shade(d);\n}",
"textured.vert":"attribute mediump vec2 a_position;\nattribute mediump vec2 a_texcoord;\nvarying mediump vec2 v_texcoord;\nvoid main(void) {\ngl_Position \x3d vec4(a_position, 0.0, 1.0);\nv_texcoord \x3d a_texcoord;\n}"},magnifier:{"magnifier.frag":"uniform lowp vec4 u_background;\nuniform mediump sampler2D u_readbackTexture;\nuniform mediump sampler2D u_maskTexture;\nuniform mediump sampler2D u_overlayTexture;\nuniform bool u_maskEnabled;\nuniform bool u_overlayEnabled;\nvarying mediump vec2 v_texCoord;\nconst lowp float barrelFactor \x3d 1.1;\nlowp vec2 barrel(lowp vec2 uv) {\nlowp vec2 uvn \x3d uv * 2.0 - 1.0;\nif (uvn.x \x3d\x3d 0.0 \x26\x26 uvn.y \x3d\x3d 0.0) {\nreturn vec2(0.5, 0.5);\n}\nlowp float theta \x3d atan(uvn.y, uvn.x);\nlowp float r \x3d pow(length(uvn), barrelFactor);\nreturn r * vec2(cos(theta), sin(theta)) * 0.5 + 0.5;\n}\nvoid main(void)\n{\nlowp vec4 color \x3d texture2D(u_readbackTexture, barrel(v_texCoord));\ncolor \x3d (color + (1.0 - color.a) * u_background);\nlowp float mask \x3d u_maskEnabled ? texture2D(u_maskTexture, v_texCoord).a : 1.0;\ncolor *\x3d mask;\nlowp vec4 overlayColor \x3d u_overlayEnabled ? texture2D(u_overlayTexture, v_texCoord) : vec4(0);\ngl_FragColor \x3d overlayColor + (1.0 - overlayColor.a) * color;\n}",
"magnifier.vert":"precision mediump float;\nattribute mediump vec2 a_pos;\nuniform mediump vec4 u_drawPos;\nvarying mediump vec2 v_texCoord;\nvoid main(void)\n{\nv_texCoord \x3d a_pos;\ngl_Position \x3d vec4(u_drawPos.xy + vec2(a_pos - 0.5) * u_drawPos.zw, 0.0, 1.0);\n}"},materials:{"attributeData.glsl":"uniform highp sampler2D u_attributeData0;\nuniform highp sampler2D u_attributeData1;\nuniform highp sampler2D u_attributeData2;\nuniform highp sampler2D u_attributeData3;\nuniform highp sampler2D u_attributeData4;\nuniform highp sampler2D u_attributeData5;\nuniform highp int u_attributeTextureSize;\nhighp vec2 getAttributeDataCoords(in highp vec3 id) {\nhighp vec3  texel \x3d unpackDisplayIdTexel(id);\nhighp float size \x3d float(u_attributeTextureSize);\nhighp float u32 \x3d float(int(texel.r) + int(texel.g) * 256 + int(texel.b) * 256 * 256);\nhighp float col \x3d mod(u32, size);\nhighp float row \x3d (u32 - col) / size;\nhighp float u \x3d col / size;\nhighp float v \x3d row / size;\nreturn vec2(u, v);\n}\nhighp vec2 getAttributeDataTextureCoords(in highp vec3 id) {\nreturn (getAttributeDataCoords(id) * 2.0) - 1.0 + (.5 / vec2(u_attributeTextureSize));\n}\nhighp vec4 getAttributeData0(in highp vec3 id) {\nvec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData0, coords);\n}\nhighp vec4 getAttributeData1(in highp vec3 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData1, coords);\n}\nhighp vec4 getAttributeData2(in highp vec3 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData2, coords);\n}\nhighp vec4 getAttributeData3(in highp vec3 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData3, coords);\n}\nhighp vec4 getAttributeData4(in highp vec3 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData4, coords);\n}\nhighp vec4 getAttributeData5(in highp vec3 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData5, coords);\n}\nfloat u88VVToFloat(in vec2 v) {\nbool isMagic \x3d v.x \x3d\x3d 255.0 \x26\x26 v.y \x3d\x3d 255.0;\nif (isMagic) {\nreturn NAN_MAGIC_NUMBER;\n}\nreturn (v.x + v.y * float(0x100)) - 32768.0;\n}",
"barycentric.glsl":"float inTriangle(vec3 bary) {\nvec3 absBary \x3d abs(bary);\nreturn step((absBary.x + absBary.y + absBary.z), 1.05);\n}\nvec3 xyToBarycentric(in vec2 pos, in vec2 v0,  in vec2 v1, in vec2 v2) {\nmat3 xyToBarycentricMat3 \x3d mat3(\nv1.x * v2.y - v2.x * v1.y, v2.x * v0.y - v0.x * v2.y, v0.x * v1.y - v1.x * v0.y,\nv1.y - v2.y, v2.y - v0.y, v0.y - v1.y,\nv2.x - v1.x, v0.x - v2.x, v1.x - v0.x\n);\nfloat A2 \x3d v0.x * (v1.y - v2.y) + v1.x * (v2.y - v0.y) + v2.x * (v0.y - v1.y);\nreturn (1. / A2) * xyToBarycentricMat3 * vec3(1., pos);\n}",
"constants.glsl":"const float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\nconst float C_RAD_TO_DEG \x3d 180.0 / 3.141592654;\nconst float POSITION_PRECISION \x3d 1.0 / 8.0;\nconst float FILL_POSITION_PRECISION \x3d 1.0 / 1.0;\nconst float SOFT_EDGE_RATIO \x3d 1.0;\nconst float THIN_LINE_WIDTH_FACTOR \x3d 1.1;\nconst float THIN_LINE_HALF_WIDTH \x3d 1.0;\nconst float EXTRUDE_SCALE_PLACEMENT_PADDING \x3d 1.0 / 4.0;\nconst float OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float OUTLINE_SCALE \x3d 1.0 / 5.0;\nconst float SDF_FONT_SIZE \x3d 24.0;\nconst float MAX_SDF_DISTANCE \x3d 8.0;\nconst float PLACEMENT_PADDING \x3d 8.0;\nconst float EPSILON \x3d 0.00001;\nconst float EPSILON_HITTEST \x3d 0.05;\nconst int MAX_FILTER_COUNT \x3d 2;\nconst int ATTR_VV_SIZE \x3d 0;\nconst int ATTR_VV_COLOR \x3d 1;\nconst int ATTR_VV_OPACITY \x3d 2;\nconst int ATTR_VV_ROTATION \x3d 3;\nconst highp float NAN_MAGIC_NUMBER \x3d 1e-30;\nconst int BITSET_GENERIC_LOCK_COLOR \x3d 1;\nconst int BITSET_GENERIC_CONSIDER_ALPHA_ONLY \x3d 4;\nconst int BITSET_MARKER_ALIGNMENT_MAP \x3d 0;\nconst int BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE \x3d 2;\nconst int BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY \x3d 3;\nconst int BITSET_TYPE_FILL_OUTLINE \x3d 0;\nconst int BITSET_FILL_RANDOM_PATTERN_OFFSET \x3d 2;\nconst int BITSET_FILL_HAS_UNRESOLVED_REPLACEMENT_COLOR \x3d 3;\nconst int BITSET_LINE_SCALE_DASH \x3d 2;",
fill:{"common.glsl":"#include \x3cmaterials/symbologyTypeUtils.glsl\x3e\n#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\nvarying mediump float v_sampleAlphaOnly;\n#endif\n#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY\nuniform lowp vec4 u_isActive[ 2 ];\nuniform highp float u_dotValue;\nuniform highp float u_tileDotsOverArea;\nuniform highp float u_dotTextureDotCount;\nuniform mediump float u_tileZoomFactor;\n#endif\nvarying highp vec3 v_id;\nvarying lowp vec4 v_color;\nvarying lowp float v_opacity;\nvarying mediump vec4 v_aux1;\n#ifdef PATTERN\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\nvarying lowp float v_isOutline;\n#endif\n#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY\nvarying highp vec2 v_dotTextureCoords;\nvarying highp vec4 v_dotThresholds[ 2 ];\n#endif",
"fill.frag":"precision highp float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\n#endif\n#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY\nuniform mediump mat4 u_dotColors[ 2 ];\nuniform sampler2D u_dotTextures[ 2 ];\nuniform vec4 u_dotBackgroundColor;\n#endif\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#include \x3cmaterials/shared/line/common.glsl\x3e\n#include \x3cmaterials/shared/line/line.frag\x3e\nlowp vec4 drawLine() {\nfloat v_lineWidth \x3d v_aux1.x;\nvec2  v_normal    \x3d v_aux1.yz;\nLineData inputs \x3d LineData(\nv_color,\nv_normal,\nv_lineWidth,\nv_opacity,\nv_id\n);\nreturn shadeLine(inputs);\n}\n#endif\nlowp vec4 drawFill() {\nlowp vec4 out_color \x3d vec4(0.);\n#ifdef HITTEST\nout_color \x3d v_color;\n#elif defined(PATTERN)\nmediump vec4 v_tlbr \x3d v_aux1;\nmediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\nmediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\nlowp vec4 color \x3d texture2D(u_texture, samplePos);\nif (v_sampleAlphaOnly \x3e 0.5) {\ncolor.rgb \x3d vec3(color.a);\n}\nout_color \x3d v_opacity * v_color * color;\n#elif SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY \x26\x26 !defined(HIGHLIGHT)\nvec4 textureThresholds0 \x3d texture2D(u_dotTextures[0], v_dotTextureCoords);\nvec4 textureThresholds1 \x3d texture2D(u_dotTextures[1], v_dotTextureCoords);\nvec4 difference0 \x3d v_dotThresholds[0] - textureThresholds0;\nvec4 difference1 \x3d v_dotThresholds[1] - textureThresholds1;\n#ifdef DD_DOT_BLENDING\nvec4 isPositive0 \x3d step(0.0, difference0);\nvec4 isPositive1 \x3d step(0.0, difference1);\nfloat weightSum \x3d dot(isPositive0, difference0) + dot(isPositive1, difference1);\nfloat lessThanEqZero \x3d step(weightSum, 0.0);\nfloat greaterThanZero \x3d 1.0 - lessThanEqZero ;\nfloat divisor \x3d (weightSum + lessThanEqZero);\nvec4 weights0 \x3d difference0 * isPositive0 / divisor;\nvec4 weights1 \x3d difference1 * isPositive1 / divisor;\nvec4 dotColor \x3d u_dotColors[0] * weights0 + u_dotColors[1] * weights1;\nvec4 preEffectColor \x3d greaterThanZero * dotColor + lessThanEqZero * u_dotBackgroundColor;\n#else\nfloat diffMax \x3d max(max4(difference0), max4(difference1));\nfloat lessThanZero \x3d step(diffMax, 0.0);\nfloat greaterOrEqZero \x3d 1.0 - lessThanZero;\nvec4 isMax0 \x3d step(diffMax, difference0);\nvec4 isMax1 \x3d step(diffMax, difference1);\nvec4 dotColor \x3d u_dotColors[0] * isMax0 + u_dotColors[1] * isMax1;\nvec4 preEffectColor \x3d greaterOrEqZero * dotColor + lessThanZero * u_dotBackgroundColor;\n#endif\nout_color \x3d preEffectColor;\n#else\nout_color \x3d v_opacity * v_color;\n#endif\n#ifdef HIGHLIGHT\nout_color.a \x3d 1.0;\n#endif\nreturn out_color;\n}\nvoid main() {\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\nif (v_isOutline \x3e 0.5) {\ngl_FragColor \x3d drawLine();\n} else {\ngl_FragColor \x3d drawFill();\n}\n#else\ngl_FragColor \x3d drawFill();\n#endif\n}",
"fill.vert":"#include \x3cmaterials/symbologyTypeUtils.glsl\x3e\n#define PACKED_LINE\nprecision highp float;\nattribute float a_bitset;\n#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY\nattribute float a_inverseArea;\nvec4 a_color \x3d vec4(0.0, 0.0, 0.0, 1.0);\nvec2 a_zoomRange \x3d vec2(0.0, 10000.0);\n#else\nattribute vec4 a_color;\nattribute vec4 a_aux2;\nattribute vec4 a_aux3;\n#ifndef SYMBOLOGY_TYPE_IS_SIMPLE_LIKE\nattribute vec4 a_aux1;\nattribute vec2 a_zoomRange;\n#else\nvec2 a_zoomRange \x3d vec2(0.0, 10000.0);\n#endif\n#endif\nuniform vec2 u_tileOffset;\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#include \x3cmaterials/fill/hittest.glsl\x3e\nconst float INV_SCALE_COMPRESSION_FACTOR \x3d 1.0 / 128.0;\n#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY\nvec4 dotThreshold(vec4 featureAttrOverFeatureArea, float dotValue, float tileDotsOverArea) {\nreturn featureAttrOverFeatureArea * (1.0 / dotValue)  * (1.0 / tileDotsOverArea);\n}\n#endif\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#include \x3cmaterials/shared/line/common.glsl\x3e\n#include \x3cmaterials/shared/line/line.vert\x3e\nvoid drawLine(out lowp vec4 out_color, out highp vec3 out_pos) {\nLineData outputs \x3d buildLine(\nout_pos,\na_id,\na_pos,\na_color,\n(a_aux3.xy - 128.) / 16.,\n(a_aux3.zw - 128.) / 16.,\n0.,\na_aux2.z / 16.,\na_bitset,\nvec4(0.),\nvec2(0.),\na_aux2.w / 16.\n);\nv_id      \x3d outputs.id;\nv_opacity \x3d outputs.opacity;\nv_aux1    \x3d vec4(outputs.lineHalfWidth, outputs.normal, 0.);\nout_color \x3d outputs.color;\n}\n#endif\nvoid drawFill(out lowp vec4 out_color, out highp vec3 out_pos) {\nfloat a_bitSet \x3d a_bitset;\nout_color \x3d getColor(a_color, a_bitSet, BITSET_GENERIC_LOCK_COLOR);\nv_opacity \x3d getOpacity();\nv_id      \x3d norm(a_id);\n#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY\nmat3 tileToTileNormalized \x3d mat3(  2. / 512.,  0.,  0.,\n0., -2. / 512.,  0.,\n-1.,  1.,  1.  );\nout_pos   \x3d tileToTileNormalized * vec3((a_pos * FILL_POSITION_PRECISION), 1.);\n#else\nout_pos   \x3d u_dvsMat3 * vec3(a_pos * FILL_POSITION_PRECISION, 1.);\n#endif\n#ifdef PATTERN\nvec4  a_tlbr   \x3d a_aux1;\nfloat a_width  \x3d a_aux2.x;\nfloat a_height \x3d a_aux2.y;\nvec2  a_offset \x3d a_aux2.zw;\nvec2  a_scale  \x3d a_aux3.xy;\nfloat a_angle  \x3d a_aux3.z;\nvec2 scale \x3d INV_SCALE_COMPRESSION_FACTOR * a_scale;\nfloat width \x3d u_zoomFactor * a_width * scale.x;\nfloat height \x3d u_zoomFactor * a_height * scale.y;\nfloat angle \x3d C_256_TO_RAD * a_angle;\nfloat sinA \x3d sin(angle);\nfloat cosA \x3d cos(angle);\nfloat dx \x3d 0.0;\nfloat dy \x3d 0.0;\nif (getBit(a_bitset, BITSET_FILL_RANDOM_PATTERN_OFFSET) \x3e 0.5) {\nfloat id \x3d rgba2float(vec4(a_id, 0.0));\ndx \x3d rand(vec2(id, 0.0));\ndy \x3d rand(vec2(0.0, id));\n}\nmat3 patternMatrix \x3d mat3(cosA / width, sinA / height, 0,\n-sinA / width, cosA / height, 0,\ndx,            dy,           1);\nvec2 tileOffset \x3d vec2(u_tileOffset.x * cosA - u_tileOffset.y * sinA, u_tileOffset.x * sinA + u_tileOffset.y * cosA);\ntileOffset \x3d mod(tileOffset, vec2(a_aux2.x, a_aux2.y));\nvec2 symbolOffset \x3d (a_offset - tileOffset) / vec2(width, height);\nv_tileTextureCoord \x3d (patternMatrix * vec3(a_pos * FILL_POSITION_PRECISION, 1.0)).xy - symbolOffset;\nv_aux1 \x3d a_tlbr / u_mosaicSize.xyxy;\nv_sampleAlphaOnly \x3d getBit(a_bitset, BITSET_GENERIC_CONSIDER_ALPHA_ONLY);\nif (getBit(a_bitSet, BITSET_FILL_HAS_UNRESOLVED_REPLACEMENT_COLOR) \x3e 0.5) {\n#ifdef VV_COLOR\nv_sampleAlphaOnly *\x3d 1.0 - getBit(a_bitSet, BITSET_GENERIC_LOCK_COLOR);\n#else\nv_sampleAlphaOnly \x3d 0.0;\n#endif\n}\n#elif SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY\nvec4 ddAttributeData0 \x3d getAttributeData2(a_id) * u_isActive[0] * a_inverseArea;\nvec4 ddAttributeData1 \x3d getAttributeData3(a_id) * u_isActive[1] * a_inverseArea;\nfloat size \x3d u_tileZoomFactor * 512.0 * 1.0 / u_pixelRatio;\nv_dotThresholds[0] \x3d dotThreshold(ddAttributeData0, u_dotValue, u_tileDotsOverArea);\nv_dotThresholds[1] \x3d dotThreshold(ddAttributeData1, u_dotValue, u_tileDotsOverArea);\nv_dotTextureCoords \x3d (a_pos * FILL_POSITION_PRECISION + 0.5) / size;\n#endif\n}\n#ifdef HITTEST\nvoid draw(out lowp vec4 out_color, out highp vec3 out_pos) {\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\nif (getBit(a_bitset, BITSET_TYPE_FILL_OUTLINE) \x3e 0.5) {\nout_pos \x3d vec3(0., 0., 2.);\nreturn;\n}\n#endif\nhittestFill(out_color, out_pos);\ngl_PointSize \x3d 1.0;\n}\n#elif defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE)\nvoid draw(out lowp vec4 out_color, out highp vec3 out_pos) {\nv_isOutline \x3d getBit(a_bitset, BITSET_TYPE_FILL_OUTLINE);\nif (v_isOutline \x3e 0.5) {\ndrawLine(out_color, out_pos);\n} else {\ndrawFill(out_color, out_pos);\n}\n}\n#else\n#define draw drawFill\n#endif\nvoid main()\n{\nINIT;\nhighp vec3 pos  \x3d vec3(0.);\nhighp vec4 color  \x3d vec4(0.);\ndraw(color, pos);\nv_color \x3d color;\ngl_Position \x3d vec4(clip(v_color, pos, getFilterFlags(), a_zoomRange), 1.0);\n}",
"hittest.glsl":"#ifdef HITTEST\n#include \x3cmaterials/hittest/common.glsl\x3e\nattribute vec2 a_pos1;\nattribute vec2 a_pos2;\nvoid hittestFill(\nout lowp vec4 out_color,\nout highp vec3 out_pos\n) {\nvec3 pos        \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos  * FILL_POSITION_PRECISION, 1.);\nvec3 pos1       \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos1 * FILL_POSITION_PRECISION, 1.);\nvec3 pos2       \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos2 * FILL_POSITION_PRECISION, 1.);\nfloat hittestDist \x3d u_hittestDist;\nfloat dist \x3d distPointTriangle(u_hittestPos, pos.xy, pos1.xy, pos2.xy);\nout_pos \x3d vec3(getAttributeDataTextureCoords(a_id), 0.0);\nif (dist \x3c 0. || dist \x3e\x3d hittestDist) {\nout_pos.z +\x3d 2.0;\n}\nout_color \x3d vec4(1. / 255., 0, 0, dist \x3d\x3d 0. ? (1. / 255.) : 0.);\n}\n#endif"},
hittest:{"common.glsl":"#ifdef HITTEST\nuniform float u_hittestDist;\nuniform highp vec2 u_hittestPos;\nfloat projectScalar(vec2 a, vec2 b) {\nreturn dot(a, normalize(b));\n}\nfloat distPointSegment(vec2 p0, vec2 p1, vec2 p2) {\nvec2 L \x3d p2 - p1;\nvec2 A \x3d p0 - p1;\nfloat projAL \x3d projectScalar(A, L);\nfloat t \x3d clamp(projAL / length(L), 0., 1.);\nreturn distance(p0, p1 + t * (p2 - p1));\n}\nvoid hittestMarker(out lowp vec4 out_color, out highp vec3 out_pos, in highp vec3 pos, float size) {\nfloat dist \x3d distance(pos, vec3(u_hittestPos, 1.));\nout_pos \x3d vec3(getAttributeDataTextureCoords(a_id), 0.0);\nif ((dist - size) \x3e u_hittestDist) {\nout_pos.z +\x3d 2.0;\n}\nout_color \x3d vec4(1. / 255., 0, 0, (dist - size) \x3c 0. ? (1. / 255.) : 0.);\n}\nfloat intersectPointTriangleBary(vec2 p, vec2 a, vec2 b, vec2 c) {\nreturn inTriangle(xyToBarycentric(p, a, b, c));\n}\nfloat distPointTriangle(vec2 p, vec2 a, vec2 b, vec2 c) {\nvec2 ba \x3d b - a;\nvec2 ca \x3d c - a;\nfloat crossProduct \x3d ba.x * ca.y - ca.x * ba.y;\nbool isParallel \x3d crossProduct \x3c EPSILON_HITTEST \x26\x26 crossProduct \x3e -EPSILON_HITTEST;\nif (isParallel) {\nreturn -1.;\n}\nif (intersectPointTriangleBary(p.xy, a, b, c) \x3d\x3d 1.) {\nreturn 0.;\n}\nfloat distAB \x3d distPointSegment(p, a, b);\nfloat distBC \x3d distPointSegment(p, b, c);\nfloat distCA \x3d distPointSegment(p, c, a);\nreturn min(min(distAB, distBC), distCA);\n}\n#endif"},
icon:{"common.glsl":"#include \x3cutil/encoding.glsl\x3e\nuniform lowp vec2 u_mosaicSize;\nvarying lowp vec4 v_color;\nvarying highp vec3 v_id;\nvarying highp vec4 v_sizeTex;\nvarying mediump vec3 v_pos;\nvarying lowp float v_opacity;\nuniform lowp sampler2D u_texture;\n#ifdef SDF\nvarying lowp vec4 v_outlineColor;\nvarying mediump float v_outlineWidth;\nvarying mediump float v_distRatio;\nvarying mediump float v_overridingOutlineColor;\nvarying mediump float v_isThin;\n#endif\n#ifdef SDF\nvec4 getColor(vec2 v_size, vec2 v_tex) {\nlowp vec4 fillPixelColor \x3d v_color;\nfloat d \x3d 0.5 - rgba2float(texture2D(u_texture, v_tex));\nfloat size \x3d max(v_size.x, v_size.y);\nfloat dist \x3d d * size * SOFT_EDGE_RATIO * v_distRatio;\nfillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\nfloat outlineWidth \x3d v_outlineWidth;\n#ifdef HIGHLIGHT\noutlineWidth \x3d max(outlineWidth, 4.0 * v_isThin);\n#endif\nif (outlineWidth \x3e 0.25) {\nlowp vec4 outlinePixelColor \x3d v_overridingOutlineColor * v_color + (1.0 - v_overridingOutlineColor) * v_outlineColor;\nfloat clampedOutlineSize \x3d min(outlineWidth, size);\noutlinePixelColor *\x3d clamp(0.5 - abs(dist) + clampedOutlineSize * 0.5, 0.0, 1.0);\nreturn v_opacity * ((1.0 - outlinePixelColor.a) * fillPixelColor + outlinePixelColor);\n}\nreturn v_opacity * fillPixelColor;\n}\n#else\nvec4 getColor(vec2 _v_size, vec2 v_tex) {\nlowp vec4 texColor \x3d texture2D(u_texture, v_tex);\nreturn v_opacity * texColor * v_color;\n}\n#endif",
heatmapAccumulate:{"common.glsl":"varying lowp vec4 v_hittestResult;\nvarying mediump vec2 v_offsetFromCenter;\nvarying highp float v_fieldValue;","heatmapAccumulate.frag":"precision mediump float;\n#include \x3cmaterials/icon/heatmapAccumulate/common.glsl\x3e\n#ifdef HEATMAP_PRECISION_HALF_FLOAT\n#define COMPRESSION_FACTOR 0.25\n#else\n#define COMPRESSION_FACTOR 1.0\n#endif\nuniform lowp sampler2D u_texture;\nvoid main() {\n#ifdef HITTEST\ngl_FragColor \x3d v_hittestResult;\n#else\nfloat radius \x3d length(v_offsetFromCenter);\nfloat shapeWeight \x3d step(radius, 1.0);\nfloat oneMinusRadiusSquared \x3d 1.0 - radius * radius;\nfloat kernelWeight \x3d oneMinusRadiusSquared * oneMinusRadiusSquared;\ngl_FragColor \x3d vec4(shapeWeight * kernelWeight * v_fieldValue * COMPRESSION_FACTOR);\n#endif\n}",
"heatmapAccumulate.vert":"precision highp float;\nattribute vec2 a_vertexOffset;\nvec4 a_color \x3d vec4(0.0);\nvec2 a_zoomRange \x3d vec2(0.0, 10000.0);\nuniform float u_radius;\nuniform float u_isFieldActive;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/hittest/common.glsl\x3e\n#include \x3cmaterials/icon/heatmapAccumulate/common.glsl\x3e\nvoid main() {\nfloat filterFlags \x3d getFilterFlags();\n#ifdef HITTEST\nhighp vec4 out_hittestResult \x3d vec4(0.);\nhighp vec3 out_pos \x3d vec3(0.);\nvec3 pos \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos * POSITION_PRECISION, 1.0);\nhittestMarker(out_hittestResult, out_pos, pos, u_radius);\nv_hittestResult \x3d out_hittestResult;\ngl_PointSize \x3d 1.;\ngl_Position \x3d vec4(clip(a_color, out_pos, filterFlags, a_zoomRange), 1.0);\n#else\nv_offsetFromCenter \x3d sign(a_vertexOffset);\nv_fieldValue \x3d getAttributeData2(a_id).x * u_isFieldActive + 1.0 - u_isFieldActive;\nvec3 centerPos \x3d u_dvsMat3 * vec3(a_pos * POSITION_PRECISION, 1.0);\nvec3 vertexPos \x3d centerPos + u_displayViewMat3 * vec3(v_offsetFromCenter, 0.0) * u_radius;\ngl_Position \x3d vec4(clip(a_color, vertexPos, filterFlags, a_zoomRange), 1.0);\n#endif\n}"},
"hittest.glsl":"#ifdef HITTEST\n#include \x3cmaterials/hittest/common.glsl\x3e\nattribute vec2 a_vertexOffset1;\nattribute vec2 a_vertexOffset2;\nattribute vec2 a_texCoords1;\nattribute vec2 a_texCoords2;\nvec2 getTextureCoords(in vec3 bary, in vec2 texCoords0, in vec2 texCoords1, in vec2 texCoords2) {\nreturn texCoords0 * bary.x + texCoords1 * bary.y + texCoords2 * bary.z;\n}\nvoid hittestIcon(\ninout lowp vec4 out_color,\nout highp vec3 out_pos,\nin vec3 pos,\nin vec3 offset,\nin vec2 size,\nin float scaleFactor,\nin float isMapAligned\n) {\nout_pos \x3d vec3(getAttributeDataTextureCoords(a_id), 0.0);\nvec3 posBase \x3d u_viewMat3 * u_tileMat3  * pos;\nvec3 offset1 \x3d scaleFactor * vec3(a_vertexOffset1 / 16.0, 0.);\nvec3 offset2 \x3d scaleFactor * vec3(a_vertexOffset2 / 16.0, 0.);\nvec2 pos0    \x3d (posBase + getMatrixNoDisplay(isMapAligned) * offset).xy;\nvec2 pos1    \x3d (posBase + getMatrixNoDisplay(isMapAligned) * offset1).xy;\nvec2 pos2    \x3d (posBase + getMatrixNoDisplay(isMapAligned) * offset2).xy;\nvec3 bary0 \x3d xyToBarycentric(u_hittestPos + vec2(-u_hittestDist, -u_hittestDist), pos0, pos1, pos2);\nvec3 bary1 \x3d xyToBarycentric(u_hittestPos + vec2(0., -u_hittestDist), pos0, pos1, pos2);\nvec3 bary2 \x3d xyToBarycentric(u_hittestPos + vec2(u_hittestDist, -u_hittestDist), pos0, pos1, pos2);\nvec3 bary3 \x3d xyToBarycentric(u_hittestPos + vec2(-u_hittestDist, 0.), pos0, pos1, pos2);\nvec3 bary4 \x3d xyToBarycentric(u_hittestPos, pos0, pos1, pos2);\nvec3 bary5 \x3d xyToBarycentric(u_hittestPos + vec2(u_hittestDist, 0.), pos0, pos1, pos2);\nvec3 bary6 \x3d xyToBarycentric(u_hittestPos + vec2(-u_hittestDist, u_hittestDist), pos0, pos1, pos2);\nvec3 bary7 \x3d xyToBarycentric(u_hittestPos + vec2(0., u_hittestDist), pos0, pos1, pos2);\nvec3 bary8 \x3d xyToBarycentric(u_hittestPos + vec2(u_hittestDist, u_hittestDist), pos0, pos1, pos2);\nvec2 tex0 \x3d a_texCoords  / u_mosaicSize;\nvec2 tex1 \x3d a_texCoords1 / u_mosaicSize;\nvec2 tex2 \x3d a_texCoords2 / u_mosaicSize;\nfloat alphaSum \x3d 0.;\nalphaSum +\x3d inTriangle(bary0) * getColor(size, getTextureCoords(bary0, tex0, tex1, tex2)).a;\nalphaSum +\x3d inTriangle(bary1) * getColor(size, getTextureCoords(bary1, tex0, tex1, tex2)).a;\nalphaSum +\x3d inTriangle(bary2) * getColor(size, getTextureCoords(bary2, tex0, tex1, tex2)).a;\nalphaSum +\x3d inTriangle(bary3) * getColor(size, getTextureCoords(bary3, tex0, tex1, tex2)).a;\nalphaSum +\x3d inTriangle(bary4) * getColor(size, getTextureCoords(bary4, tex0, tex1, tex2)).a;\nalphaSum +\x3d inTriangle(bary5) * getColor(size, getTextureCoords(bary5, tex0, tex1, tex2)).a;\nalphaSum +\x3d inTriangle(bary6) * getColor(size, getTextureCoords(bary6, tex0, tex1, tex2)).a;\nalphaSum +\x3d inTriangle(bary7) * getColor(size, getTextureCoords(bary7, tex0, tex1, tex2)).a;\nout_pos.z +\x3d step(alphaSum, .05) * 2.0;\nout_color \x3d vec4(1. / 255., 0., 0., alphaSum / 255.);\n}\n#endif",
"icon.frag":"precision mediump float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nvoid main()\n{\n#ifdef HITTEST\nvec4 color \x3d v_color;\n#else\nvec4 color \x3d getColor(v_sizeTex.xy, v_sizeTex.zw);\n#endif\n#ifdef HIGHLIGHT\ncolor.a \x3d step(1.0 / 255.0, color.a);\n#endif\ngl_FragColor \x3d color;\n}","icon.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_outlineColor;\nattribute vec4 a_sizeAndOutlineWidth;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nattribute vec2 a_bitSetAndDistRatio;\nattribute vec2 a_zoomRange;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\n#include \x3cmaterials/icon/hittest.glsl\x3e\nfloat getMarkerScaleFactor(inout vec2 size, in float referenceSize) {\n#ifdef VV_SIZE\nfloat f \x3d getSize(size.y) / size.y;\nfloat sizeFactor \x3d size.y / referenceSize;\nreturn getSize(referenceSize) / referenceSize;\n#else\nreturn 1.;\n#endif\n}\nvoid main()\n{\nINIT;\nfloat a_bitSet \x3d a_bitSetAndDistRatio.x;\nvec3  pos           \x3d vec3(a_pos * POSITION_PRECISION, 1.0);\nvec2  size          \x3d a_sizeAndOutlineWidth.xy * a_sizeAndOutlineWidth.xy / 128.0;\nvec3  offset        \x3d vec3(a_vertexOffset / 16.0, 0.);\nfloat outlineSize   \x3d a_sizeAndOutlineWidth.z * a_sizeAndOutlineWidth.z / 128.0;\nfloat isMapAligned  \x3d getBit(a_bitSet, BITSET_MARKER_ALIGNMENT_MAP);\nfloat referenceSize \x3d a_sizeAndOutlineWidth.w * a_sizeAndOutlineWidth.w / 128.0;\nfloat scaleSymbolProportionally \x3d getBit(a_bitSet, BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY);\nfloat scaleFactor               \x3d getMarkerScaleFactor(size, referenceSize);\nsize.xy     *\x3d scaleFactor;\noffset.xy   *\x3d scaleFactor;\noutlineSize *\x3d scaleSymbolProportionally * (scaleFactor - 1.0) + 1.0;\nvec2 v_tex   \x3d a_texCoords / u_mosaicSize;\nfloat filterFlags \x3d getFilterFlags();\nv_color    \x3d getColor(a_color, a_bitSet, BITSET_GENERIC_LOCK_COLOR);\nv_opacity  \x3d getOpacity();\nv_id       \x3d norm(a_id);\nv_pos      \x3d u_dvsMat3 * pos + getMatrix(isMapAligned) * getRotation()  * offset;\nv_sizeTex  \x3d vec4(size.xy, v_tex.xy);\n#ifdef SDF\nv_isThin   \x3d getBit(a_bitSet, BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE);\n#ifdef VV_COLOR\nv_overridingOutlineColor \x3d v_isThin;\n#else\nv_overridingOutlineColor \x3d 0.0;\n#endif\nv_outlineWidth \x3d min(outlineSize, max(max(size.x, size.y) - 0.99, 0.0));\nv_outlineColor \x3d a_outlineColor;\nv_distRatio \x3d a_bitSetAndDistRatio.y / 126.0;\n#endif\n#ifdef HITTEST\nhighp vec4 out_color \x3d vec4(0.);\nhighp vec3 out_pos   \x3d vec3(0.);\nhittestIcon(out_color, out_pos, pos, offset, size, scaleFactor, isMapAligned);\nv_color \x3d out_color;\ngl_PointSize \x3d 1.;\ngl_Position \x3d vec4(clip(v_color, out_pos, filterFlags, a_zoomRange), 1.0);\n#else\ngl_Position \x3d vec4(clip(v_color, v_pos, filterFlags, a_zoomRange), 1.0);\n#endif\n}"},
label:{"common.glsl":"uniform mediump float u_zoomLevel;\nuniform mediump float u_mapRotation;\nuniform mediump float u_mapAligned;\nuniform mediump vec2 u_mosaicSize;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying mediump vec2 v_tex;\nvarying mediump vec4 v_color;\nvarying lowp vec4 v_animation;","label.frag":"#include \x3cmaterials/text/text.frag\x3e","label.vert":"precision highp float;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/text/common.glsl\x3e\nattribute vec4 a_color;\nattribute vec4 a_haloColor;\nattribute vec4 a_texAndSize;\nattribute vec4 a_refSymbolAndPlacementOffset;\nattribute vec4 a_glyphData;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nuniform float u_isHaloPass;\nuniform float u_isBackgroundPass;\nuniform float u_mapRotation;\nuniform float u_mapAligned;\nfloat getZ(in float minZoom, in float maxZoom, in float angle) {\nfloat glyphAngle \x3d angle * 360.0 / 254.0;\nfloat mapAngle \x3d u_mapRotation * 360.0 / 254.0;\nfloat diffAngle \x3d min(360.0 - abs(mapAngle - glyphAngle), abs(mapAngle - glyphAngle));\nfloat z \x3d 0.0;\nz +\x3d u_mapAligned * (2.0 * (1.0 - step(minZoom, u_currentZoom)));\nz +\x3d u_mapAligned * 2.0 * step(90.0, diffAngle);\nz +\x3d 2.0 * (1.0 - step(u_currentZoom, maxZoom));\nreturn z;\n}\nvoid main()\n{\nINIT;\nfloat groupMinZoom    \x3d getMinZoom();\nfloat glyphMinZoom    \x3d a_glyphData.x;\nfloat glyphMaxZoom    \x3d a_glyphData.y;\nfloat glyphAngle      \x3d a_glyphData.z;\nfloat a_isBackground  \x3d a_glyphData.w;\nfloat a_minZoom          \x3d max(groupMinZoom, glyphMinZoom);\nfloat a_placementPadding \x3d a_refSymbolAndPlacementOffset.x * EXTRUDE_SCALE_PLACEMENT_PADDING;\nvec2  a_placementDir     \x3d unpack_u8_nf32(a_refSymbolAndPlacementOffset.zw);\nfloat a_refSymbolSize    \x3d a_refSymbolAndPlacementOffset.y;\nfloat fontSize           \x3d a_texAndSize.z;\nfloat haloSize           \x3d a_texAndSize.w * OUTLINE_SCALE;\nvec2  vertexOffset \x3d a_vertexOffset * OFFSET_PRECISION;\nvec3  pos          \x3d vec3(a_pos * POSITION_PRECISION, 1.0);\nfloat z            \x3d getZ(a_minZoom, glyphMaxZoom, glyphAngle);\nfloat fontScale    \x3d fontSize / SDF_FONT_SIZE;\nfloat halfSize     \x3d getSize(a_refSymbolSize) / 2.0;\nfloat animation    \x3d pow(getAnimationState(), vec4(2.0)).r;\nfloat isText \x3d 1.0 - a_isBackground;\nfloat isBackground \x3d u_isBackgroundPass * a_isBackground;\nvec4  nonHaloColor \x3d (isBackground + isText) * a_color;\nv_color     \x3d animation * ((1.0 - u_isHaloPass) * nonHaloColor + (u_isHaloPass * a_haloColor));\nv_opacity   \x3d 1.0;\nv_tex       \x3d a_texCoords / u_mosaicSize;\nv_edgeDistanceOffset \x3d u_isHaloPass * haloSize / fontScale / MAX_SDF_DISTANCE;\nv_antialiasingWidth  \x3d 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\nvec2 placementOffset \x3d a_placementDir * (halfSize + a_placementPadding);\nvec3 glyphOffset     \x3d u_displayMat3 * vec3(vertexOffset + placementOffset, 0.0);\nvec3 v_pos           \x3d vec3((u_dvsMat3 * pos + glyphOffset).xy, z);\nfloat isHidden \x3d u_isBackgroundPass * isText + (1.0 - u_isBackgroundPass) * a_isBackground;\nv_pos.z +\x3d 2.0 * isHidden;\ngl_Position \x3d vec4(v_pos, 1.0);\n#ifdef DEBUG\nv_color \x3d vec4(a_color.rgb, z \x3d\x3d 0.0 ? 1.0 : 0.645);\n#endif\n}"},
line:{"common.glsl":"varying lowp vec4 v_color;\nvarying highp vec3 v_id;\nvarying mediump vec2 v_normal;\nvarying mediump float v_lineHalfWidth;\nvarying lowp float v_opacity;\n#ifdef PATTERN\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\n#endif\n#if defined(PATTERN) || defined(SDF)\nvarying highp float v_accumulatedDistance;\n#endif\n#ifdef SDF\nvarying mediump float v_lineWidthRatio;\n#endif","hittest.glsl":"#include \x3cmaterials/hittest/common.glsl\x3e\n#ifdef HITTEST\nattribute vec2 a_pos1;\nattribute vec2 a_pos2;\nvoid hittestLine(out lowp vec4 out_color, out highp vec3 out_pos, float halfWidth) {\nvec3 pos        \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos  * POSITION_PRECISION, 1.);\nvec3 pos1       \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos1 * POSITION_PRECISION, 1.);\nvec3 pos2       \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos2 * POSITION_PRECISION, 1.);\nvec3 outTextureCoords \x3d vec3(getAttributeDataTextureCoords(a_id), 0.0);\nfloat dist \x3d min(distPointSegment(u_hittestPos, pos.xy, pos1.xy),\ndistPointSegment(u_hittestPos, pos.xy, pos2.xy)) - halfWidth;\nout_pos \x3d vec3(getAttributeDataTextureCoords(a_id), 0.0);\nif (dist \x3e\x3d u_hittestDist) {\nout_pos.z +\x3d 2.0;\n}\nout_color \x3d vec4(1. / 255., 0, 0, dist \x3c\x3d 0. ? (1. / 255.) : 0.);\n}\n#endif",
"line.frag":"precision lowp float;\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/symbologyTypeUtils.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\n#include \x3cmaterials/shared/line/common.glsl\x3e\n#include \x3cmaterials/shared/line/line.frag\x3e\n#ifdef HITTEST\nvoid main() {\ngl_FragColor \x3d v_color;\n}\n#else\nvoid main() {\nLineData inputs \x3d LineData(\nv_color,\nv_normal,\nv_lineHalfWidth,\nv_opacity,\n#ifndef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#ifdef PATTERN\nv_tlbr,\nv_patternSize,\n#endif\n#ifdef SDF\nv_lineWidthRatio,\n#endif\n#if defined(PATTERN) || defined(SDF)\nv_accumulatedDistance,\n#endif\n#endif\nv_id\n);\ngl_FragColor \x3d shadeLine(inputs);\n}\n#endif",
"line.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistanceAndHalfWidth;\nattribute vec4 a_tlbr;\nattribute vec4 a_segmentDirection;\nattribute vec2 a_aux;\nattribute vec2 a_zoomRange;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/symbologyTypeUtils.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\n#include \x3cmaterials/line/hittest.glsl\x3e\n#include \x3cmaterials/shared/line/common.glsl\x3e\n#include \x3cmaterials/shared/line/line.vert\x3e\n#ifdef HITTEST\nvoid draw() {\nfloat aa        \x3d 0.5 * u_antialiasing;\nfloat a_halfWidth \x3d a_accumulatedDistanceAndHalfWidth.y / 16.;\nfloat a_cimHalfWidth \x3d a_aux.x / 16. ;\nvec2  a_offset \x3d a_offsetAndNormal.xy / 16.;\nfloat baseWidth \x3d getBaseLineHalfWidth(a_halfWidth, a_cimHalfWidth);\nfloat halfWidth \x3d getLineHalfWidth(baseWidth, aa);\nhighp vec3 pos  \x3d vec3(0.);\nv_color \x3d vec4(0.);\nhittestLine(v_color, pos, halfWidth);\ngl_PointSize \x3d 1.;\ngl_Position \x3d vec4(clip(v_color, pos, getFilterFlags(), a_zoomRange), 1.0);\n}\n#else\nvoid draw()\n{\nhighp vec3 pos \x3d vec3(0.);\nLineData outputs \x3d buildLine(\npos,\na_id,\na_pos,\na_color,\na_offsetAndNormal.xy / 16.,\na_offsetAndNormal.zw / 16.,\na_accumulatedDistanceAndHalfWidth.x,\na_accumulatedDistanceAndHalfWidth.y / 16.,\na_segmentDirection.w,\na_tlbr,\na_segmentDirection.xy / 16.,\na_aux.x / 16.\n);\nv_id              \x3d outputs.id;\nv_color           \x3d outputs.color;\nv_normal          \x3d outputs.normal;\nv_lineHalfWidth   \x3d outputs.lineHalfWidth;\nv_opacity         \x3d outputs.opacity;\n#ifndef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#ifdef PATTERN\nv_tlbr          \x3d outputs.tlbr;\nv_patternSize   \x3d outputs.patternSize;\n#endif\n#ifdef SDF\nv_lineWidthRatio \x3d outputs.lineWidthRatio;\n#endif\n#if defined(PATTERN) || defined(SDF)\nv_accumulatedDistance \x3d outputs.accumulatedDistance;\n#endif\n#endif\ngl_Position \x3d vec4(clip(outputs.color, pos, getFilterFlags(), a_zoomRange), 1.0);\n}\n#endif\nvoid main() {\nINIT;\ndraw();\n}"},
pie:{"pie.frag":"precision mediump float;\n#include \x3cutil/atan2.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nvarying float v_size;\nvarying vec2 v_offset;\nvarying vec2 v_filteredSectorToColorId[NUMBER_OF_FIELDS];\nvarying float v_numOfEntries;\nvarying float v_maxSectorAngle;\nuniform lowp vec4 u_colors[NUMBER_OF_FIELDS];\nuniform lowp vec4 u_defaultColor;\nuniform lowp vec4 u_othersColor;\nuniform lowp vec4 u_outlineColor;\nuniform float u_donutRatio;\nuniform float u_sectorThreshold;\nstruct FilteredChartInfo {\nfloat endSectorAngle;\nint colorId;\n};\nlowp vec4 getSectorColor(in int index, in vec2 filteredSectorToColorId[NUMBER_OF_FIELDS]) {\n#if __VERSION__ \x3d\x3d 300\nmediump int colorIndex \x3d int(filteredSectorToColorId[index].y);\nreturn u_colors[colorIndex];\n#else\nmediump int colorIndex;\nfor (int i \x3d 0; i \x3c NUMBER_OF_FIELDS; ++i) {\nif (i \x3d\x3d index) {\ncolorIndex \x3d int(filteredSectorToColorId[i].y);\n}\n}\nfor (int i \x3d 0; i \x3c NUMBER_OF_FIELDS; ++i) {\nif (i \x3d\x3d colorIndex) {\nreturn u_colors[i];\n}\n}\nreturn u_colors[NUMBER_OF_FIELDS - 1];\n#endif\n}\nconst int OTHER_SECTOR_ID \x3d 255;\n#ifdef HITTEST\nvec4 getColor() {\nreturn v_color;\n}\n#else\nvec4 getColor() {\nfloat angle \x3d 90.0 - C_RAD_TO_DEG * atan2(v_offset.y, v_offset.x);\nif (angle \x3c 0.0) {\nangle +\x3d 360.0;\n} else if (angle \x3e 360.0) {\nangle \x3d mod(angle, 360.0);\n}\nint numOfEntries \x3d int(v_numOfEntries);\nfloat maxSectorAngle \x3d v_maxSectorAngle;\nlowp vec4 fillColor \x3d (maxSectorAngle \x3e 0.0 || u_sectorThreshold \x3e 0.0) ? u_othersColor : u_defaultColor;\nlowp vec4 prevColor \x3d vec4(0.0);\nlowp vec4 nextColor \x3d vec4(0.0);\nfloat startSectorAngle \x3d 0.0;\nfloat endSectorAngle \x3d 0.0;\nif (angle \x3c maxSectorAngle) {\nfor (int index \x3d 0; index \x3c NUMBER_OF_FIELDS; ++index) {\nstartSectorAngle \x3d endSectorAngle;\nendSectorAngle \x3d v_filteredSectorToColorId[index].x;\nif (endSectorAngle \x3e angle) {\nfillColor \x3d getSectorColor(index, v_filteredSectorToColorId);\nprevColor \x3d u_sectorThreshold !\x3d 0.0 \x26\x26 index \x3d\x3d 0 \x26\x26 abs(360.0 - maxSectorAngle) \x3c EPSILON ? u_othersColor :\ngetSectorColor(index \x3e 0 ? index - 1 : numOfEntries - 1, v_filteredSectorToColorId);\nnextColor \x3d u_sectorThreshold !\x3d 0.0 \x26\x26 abs(endSectorAngle - maxSectorAngle) \x3c EPSILON ? u_othersColor :\ngetSectorColor(index \x3c numOfEntries - 1 ? index + 1 : 0, v_filteredSectorToColorId);\nbreak;\n}\nif (index \x3d\x3d numOfEntries - 1) {\nbreak;\n}\n}\n} else {\nprevColor \x3d getSectorColor(numOfEntries - 1, v_filteredSectorToColorId);\nnextColor \x3d getSectorColor(0, v_filteredSectorToColorId);\nstartSectorAngle \x3d maxSectorAngle;\nendSectorAngle \x3d 360.0;\n}\nlowp vec4 outlineColor \x3d u_outlineColor;\nfloat offset \x3d length(v_offset);\nfloat distanceSize \x3d offset * v_size;\nif (startSectorAngle !\x3d 0.0 || endSectorAngle !\x3d 360.0) {\nfloat distanceToStartSector \x3d (angle - startSectorAngle);\nfloat distanceToEndSector \x3d (endSectorAngle - angle);\nfloat sectorThreshold \x3d 0.6;\nfloat beginSectorAlpha \x3d smoothstep(0.0, sectorThreshold, distanceToStartSector * offset);\nfloat endSectorAlpha \x3d smoothstep(0.0, sectorThreshold, distanceToEndSector * offset);\nif (endSectorAlpha \x3e 0.0) {\nfillColor \x3d mix(nextColor, fillColor, endSectorAlpha);\n} else if (beginSectorAlpha \x3e 0.0) {\nfillColor \x3d mix(prevColor, fillColor, beginSectorAlpha);\n}\n}\nfloat donutSize \x3d u_donutRatio * (v_size - v_outlineWidth);\nfloat endOfDonut \x3d donutSize - v_outlineWidth;\nfloat aaThreshold \x3d 0.75;\nfloat innerCircleAlpha \x3d endOfDonut - aaThreshold \x3e 0.0 ? smoothstep(endOfDonut - aaThreshold, endOfDonut + aaThreshold, distanceSize) : 1.0;\nfloat outerCircleAlpha \x3d 1.0 - smoothstep(v_size - aaThreshold, v_size + aaThreshold , distanceSize);\nfloat circleAlpha \x3d innerCircleAlpha * outerCircleAlpha;\nfloat startOfOutline \x3d v_size - v_outlineWidth;\nif (startOfOutline \x3e 0.0 \x26\x26 v_outlineWidth \x3e 0.25) {\nfloat outlineFactor \x3d smoothstep(startOfOutline - aaThreshold, startOfOutline + aaThreshold, distanceSize);\nfloat innerLineFactor \x3d donutSize - aaThreshold \x3e 0.0 ? 1.0 - smoothstep(donutSize - aaThreshold, donutSize + aaThreshold , distanceSize) : 0.0;\nfillColor \x3d mix(fillColor, outlineColor, innerLineFactor + outlineFactor);\n}\nreturn v_opacity * circleAlpha * fillColor;\n}\n#endif\nvoid main()\n{\nvec4 color \x3d getColor();\n#ifdef HIGHLIGHT\ncolor.a \x3d step(1.0 / 255.0, color.a);\n#endif\ngl_FragColor \x3d color;\n}",
"pie.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_outlineColor;\nattribute vec4 a_sizeAndOutlineWidth;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nattribute vec2 a_bitSetAndDistRatio;\nattribute vec2 a_zoomRange;\nuniform float u_outlineWidth;\nuniform mediump float u_sectorThreshold;\nvarying float v_size;\nvarying vec2 v_offset;\nvarying vec2 v_filteredSectorToColorId[NUMBER_OF_FIELDS];\nvarying float v_numOfEntries;\nvarying float v_maxSectorAngle;\nstruct FilteredChartInfo {\nfloat endSectorAngle;\nint colorId;\n};\nint filter(in float sectorAngle,\nin int currentIndex,\ninout FilteredChartInfo filteredInfo,\ninout vec2 filteredSectorToColorId[NUMBER_OF_FIELDS]) {\nif (sectorAngle \x3e u_sectorThreshold * 360.0) {\nfilteredInfo.endSectorAngle +\x3d sectorAngle;\n#if __VERSION__ \x3d\x3d 300\nfilteredSectorToColorId[filteredInfo.colorId] \x3d vec2(filteredInfo.endSectorAngle, currentIndex);\n#else\nfor (int i \x3d 0; i \x3c NUMBER_OF_FIELDS; i++) {\nif (i \x3d\x3d filteredInfo.colorId) {\nfilteredSectorToColorId[i] \x3d vec2(filteredInfo.endSectorAngle, currentIndex);\n}\n}\n#endif\n++filteredInfo.colorId;\n}\nreturn 0;\n}\nint filterValues(inout vec2 filteredSectorToColorId[NUMBER_OF_FIELDS],\ninout FilteredChartInfo filteredInfo,\nin float sectorAngles[NUMBER_OF_FIELDS]) {\nfor (int index \x3d 0; index \x3c NUMBER_OF_FIELDS; ++index) {\nfloat sectorValue \x3d sectorAngles[index];\nfilter(sectorValue, index, filteredInfo, filteredSectorToColorId);\n}\nreturn filteredInfo.colorId;\n}\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\n#include \x3cmaterials/hittest/common.glsl\x3e\nvec2 getMarkerSize(inout vec2 offset, inout vec2 baseSize, inout float outlineSize, in float referenceSize, in float bitSet) {\nvec2 outSize \x3d baseSize;\n#ifdef VV_SIZE\nfloat r \x3d 0.5 * getSize(referenceSize) / referenceSize;\noutSize.xy *\x3d r;\noffset.xy *\x3d r;\nfloat scaleSymbolProportionally \x3d getBit(bitSet, BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY);\noutlineSize *\x3d scaleSymbolProportionally * (r - 1.0) + 1.0;\n#endif\nreturn outSize;\n}\nvec3 getOffset(in vec2 in_offset, float a_bitSet) {\nfloat isMapAligned \x3d getBit(a_bitSet, BITSET_MARKER_ALIGNMENT_MAP);\nvec3  offset       \x3d vec3(in_offset, 0.0);\nreturn getMatrix(isMapAligned) * offset;\n}\nfloat filterNaNValues(in float value) {\nreturn value !\x3d NAN_MAGIC_NUMBER \x26\x26 value \x3e 0.0 ? value : 0.0;\n}\nvoid main()\n{\nINIT;\nvec2  a_size   \x3d a_sizeAndOutlineWidth.xy * a_sizeAndOutlineWidth.xy / 128.0;\nvec2  a_offset \x3d a_vertexOffset / 16.0;\nfloat outlineSize \x3d u_outlineWidth;\nfloat a_bitSet \x3d a_bitSetAndDistRatio.x;\nvec2 size \x3d getMarkerSize(a_offset, a_size, outlineSize, a_sizeAndOutlineWidth.w * a_sizeAndOutlineWidth.w / 128.0, a_bitSet);\nfloat filterFlags \x3d getFilterFlags();\nvec3  pos         \x3d vec3(a_pos * POSITION_PRECISION, 1.0);\nv_opacity      \x3d getOpacity();\nv_id           \x3d norm(a_id);\nv_pos          \x3d u_dvsMat3 * pos + getOffset(a_offset, a_bitSet);\nv_offset       \x3d sign(a_texCoords - 0.5);\nv_size         \x3d max(size.x, size.y);\nv_outlineWidth \x3d outlineSize;\nfloat attributeData[10];\nvec4 attributeData0 \x3d getAttributeData3(a_id);\nattributeData[0] \x3d filterNaNValues(attributeData0.x);\nattributeData[1] \x3d filterNaNValues(attributeData0.y);\nattributeData[2] \x3d filterNaNValues(attributeData0.z);\nattributeData[3] \x3d filterNaNValues(attributeData0.w);\n#if (NUMBER_OF_FIELDS \x3e 4)\nvec4 attributeData1 \x3d getAttributeData4(a_id);\nattributeData[4] \x3d filterNaNValues(attributeData1.x);\nattributeData[5] \x3d filterNaNValues(attributeData1.y);\nattributeData[6] \x3d filterNaNValues(attributeData1.z);\nattributeData[7] \x3d filterNaNValues(attributeData1.w);\n#endif\n#if (NUMBER_OF_FIELDS \x3e 8)\nvec4 attributeData2 \x3d getAttributeData5(a_id);\nattributeData[8] \x3d filterNaNValues(attributeData2.x);\nattributeData[9] \x3d filterNaNValues(attributeData2.y);\n#endif\nfloat sum \x3d 0.0;\nfor (int i \x3d 0; i \x3c NUMBER_OF_FIELDS; ++i) {\nsum +\x3d attributeData[i];\n}\nfloat sectorAngles[NUMBER_OF_FIELDS];\nfor (int i \x3d 0; i \x3c NUMBER_OF_FIELDS; ++i) {\nsectorAngles[i] \x3d 360.0 * attributeData[i] / sum;\n}\nvec2 filteredSectorToColorId[NUMBER_OF_FIELDS];\nFilteredChartInfo filteredInfo \x3d FilteredChartInfo(0.0, 0);\nint numOfEntries \x3d filterValues(filteredSectorToColorId, filteredInfo, sectorAngles);\nv_numOfEntries \x3d float(numOfEntries);\nv_maxSectorAngle \x3d filteredInfo.endSectorAngle;\n#if __VERSION__ \x3d\x3d 300\nv_filteredSectorToColorId \x3d filteredSectorToColorId;\n#else\nfor (int i \x3d 0; i \x3c NUMBER_OF_FIELDS; ++i) {\nif (i \x3d\x3d numOfEntries) {\nbreak;\n}\nv_filteredSectorToColorId[i] \x3d filteredSectorToColorId[i];\n}\n#endif\n#ifdef HITTEST\nhighp vec3 out_pos \x3d vec3(0.0);\nv_color            \x3d vec4(0.0);\nhittestMarker(v_color, out_pos, u_viewMat3 * u_tileMat3 *  pos, v_size);\ngl_PointSize \x3d 1.0;\ngl_Position \x3d vec4(clip(v_color, out_pos, filterFlags, a_zoomRange), 1.0);\n#else\ngl_Position \x3d vec4(clip(v_color, v_pos, filterFlags, a_zoomRange), 1.0);\n#endif\n}"},
shared:{line:{"common.glsl":"#if !defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE) \x26\x26 defined(PATTERN)\nuniform mediump vec2 u_mosaicSize;\nvarying mediump float v_sampleAlphaOnly;\n#endif\nstruct LineData {\nlowp vec4 color;\nmediump vec2 normal;\nmediump float lineHalfWidth;\nlowp float opacity;\n#ifndef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#ifdef PATTERN\nmediump vec4 tlbr;\nmediump vec2 patternSize;\n#endif\n#ifdef SDF\nmediump float lineWidthRatio;\n#endif\n#if defined(PATTERN) || defined(SDF)\nhighp float accumulatedDistance;\n#endif\n#endif\nhighp vec3 id;\n};",
"line.frag":"uniform lowp float u_blur;\n#if !defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE) \x26\x26 !defined(HIGHLIGHT)\n#if defined(PATTERN) || defined(SDF)\nuniform sampler2D u_texture;\nuniform highp float u_pixelRatio;\n#endif\n#endif\n#if defined(SDF) \x26\x26 !defined(HIGHLIGHT) \x26\x26 !defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE)\nlowp vec4 getLineColor(LineData line) {\nmediump float adjustedPatternWidth \x3d line.patternSize.x * 2.0 * line.lineWidthRatio;\nmediump float relativeTexX \x3d fract(line.accumulatedDistance / adjustedPatternWidth);\nmediump float relativeTexY \x3d 0.5 + 0.25 * line.normal.y;\nmediump vec2 texCoord \x3d mix(line.tlbr.xy, line.tlbr.zw, vec2(relativeTexX, relativeTexY));\nmediump float d \x3d rgba2float(texture2D(u_texture, texCoord)) - 0.5;\nfloat dist \x3d d * line.lineHalfWidth;\nreturn line.opacity * clamp(0.5 - dist, 0.0, 1.0) * line.color;\n}\n#elif defined(PATTERN) \x26\x26 !defined(HIGHLIGHT) \x26\x26 !defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE)\nlowp vec4 getLineColor(LineData line) {\nmediump float lineHalfWidth \x3d line.lineHalfWidth;\nmediump float adjustedPatternHeight \x3d line.patternSize.y * 2.0 * lineHalfWidth / line.patternSize.x;\nmediump float relativeTexY \x3d fract(line.accumulatedDistance / adjustedPatternHeight);\nmediump float relativeTexX \x3d 0.5 + 0.5 * line.normal.y;\nmediump vec2 texCoord \x3d mix(line.tlbr.xy, line.tlbr.zw, vec2(relativeTexX, relativeTexY));\nlowp vec4 color \x3d texture2D(u_texture, texCoord);\n#ifdef VV_COLOR\nif (v_sampleAlphaOnly \x3e 0.5) {\ncolor.rgb \x3d vec3(color.a);\n}\n#endif\nreturn line.opacity * line.color * color;\n}\n#else\nlowp vec4 getLineColor(LineData line) {\nreturn line.opacity * line.color;\n}\n#endif\nvec4 shadeLine(LineData line)\n{\nmediump float thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(line.lineHalfWidth, THIN_LINE_HALF_WIDTH), 1.0);\nmediump float fragDist \x3d length(line.normal) * line.lineHalfWidth;\nlowp float alpha \x3d clamp(thinLineFactor * (line.lineHalfWidth - fragDist) / (u_blur + thinLineFactor - 1.0), 0.0, 1.0);\nlowp vec4 out_color \x3d getLineColor(line) * alpha;\n#ifdef HIGHLIGHT\nout_color.a \x3d step(1.0 / 255.0, out_color.a);\n#endif\n#ifdef ID\nif (out_color.a \x3c 1.0 / 255.0) {\ndiscard;\n}\nout_color \x3d vec4(line.id, 0.0);\n#endif\nreturn out_color;\n}",
"line.vert":"float getBaseLineHalfWidth(in float lineHalfWidth, in float referenceHalfWidth) {\n#ifdef VV_SIZE\nfloat refLineWidth \x3d 2.0 * referenceHalfWidth;\nreturn 0.5 * (lineHalfWidth / max(referenceHalfWidth, EPSILON)) * getSize(refLineWidth);\n#else\nreturn lineHalfWidth;\n#endif\n}\nfloat getLineHalfWidth(in float baseWidth, in float aa) {\nfloat halfWidth \x3d max(baseWidth + aa, 0.45) + 0.1 * aa;\n#ifdef HIGHLIGHT\nhalfWidth \x3d max(halfWidth, 2.0);\n#endif\nreturn halfWidth;\n}\nvec2 getDist(in vec2 offset, in float halfWidth) {\nfloat thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(halfWidth, THIN_LINE_HALF_WIDTH), 1.0);\nreturn thinLineFactor * halfWidth * offset;\n}\nLineData buildLine(\nout vec3 out_pos,\nin vec3 in_id,\nin vec2 in_pos,\nin vec4 in_color,\nin vec2 in_offset,\nin vec2 in_normal,\nin float in_accumulatedDist,\nin float in_lineHalfWidth,\nin float in_bitSet,\nin vec4 in_tlbr,\nin vec2 in_segmentDirection,\nin float in_referenceHalfWidth\n)\n{\nfloat aa        \x3d 0.5 * u_antialiasing;\nfloat baseWidth \x3d getBaseLineHalfWidth(in_lineHalfWidth, in_referenceHalfWidth);\nfloat halfWidth \x3d getLineHalfWidth(baseWidth, aa);\nfloat z         \x3d 2.0 * step(baseWidth, 0.0);\nvec2  dist      \x3d getDist(in_offset, halfWidth);\nvec3  offset    \x3d u_displayViewMat3 * vec3(dist, 0.0);\nvec3  pos       \x3d u_dvsMat3 * vec3(in_pos * POSITION_PRECISION, 1.0) + offset;\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\nvec4  color     \x3d in_color;\nfloat opacity   \x3d 1.0;\n#else\nvec4  color     \x3d getColor(in_color, in_bitSet, BITSET_GENERIC_LOCK_COLOR);\nfloat opacity   \x3d getOpacity();\n#ifdef SDF\nconst float SDF_PATTERN_HALF_WIDTH \x3d 15.5;\nfloat scaleDash \x3d getBit(in_bitSet, BITSET_LINE_SCALE_DASH);\nfloat lineWidthRatio \x3d (scaleDash * max(halfWidth - 0.55 * u_antialiasing, 0.25) + (1.0 - scaleDash)) / SDF_PATTERN_HALF_WIDTH;\n#endif\n#endif\n#if !defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE) \x26\x26 defined(PATTERN)\nv_sampleAlphaOnly \x3d getBit(in_bitSet, BITSET_GENERIC_CONSIDER_ALPHA_ONLY);\n#endif\nout_pos \x3d vec3(pos.xy, z);\nreturn LineData(\ncolor,\nin_normal,\nhalfWidth,\nopacity,\n#ifndef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#ifdef PATTERN\nin_tlbr / u_mosaicSize.xyxy,\nvec2(in_tlbr.z - in_tlbr.x, in_tlbr.w - in_tlbr.y),\n#endif\n#ifdef SDF\nlineWidthRatio,\n#endif\n#if defined(PATTERN) || defined(SDF)\nin_accumulatedDist * u_zoomFactor + dot(in_segmentDirection, dist),\n#endif\n#endif\nnorm(in_id)\n);\n}"}},
"symbologyTypeUtils.glsl":"#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_OUTLINE_FILL || SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_OUTLINE_FILL_SIMPLE\n#define SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#endif\n#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_SIMPLE || SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_OUTLINE_FILL_SIMPLE\n#define SYMBOLOGY_TYPE_IS_SIMPLE_LIKE\n#endif",text:{"common.glsl":"uniform highp vec2 u_mosaicSize;\nvarying highp vec3 v_id;\nvarying mediump vec3 v_pos;\nvarying lowp float v_opacity;\nvarying lowp vec4 v_color;\nvarying highp vec2 v_tex;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying lowp float v_transparency;",
"hittest.glsl":"#include \x3cmaterials/hittest/common.glsl\x3e","text.frag":"precision mediump float;\n#include \x3cmaterials/text/common.glsl\x3e\nuniform lowp sampler2D u_texture;\n#ifdef HITTEST\nvec4 getColor() {\nreturn v_color;\n}\n#else\nvec4 getColor()\n{\nfloat SDF_CUTOFF \x3d (2.0 / 8.0);\nfloat SDF_BASE_EDGE_DIST \x3d 1.0 - SDF_CUTOFF;\nlowp float dist \x3d texture2D(u_texture, v_tex).a;\nmediump float edge \x3d SDF_BASE_EDGE_DIST - v_edgeDistanceOffset;\n#ifdef HIGHLIGHT\nedge /\x3d 2.0;\n#endif\nlowp float aa \x3d v_antialiasingWidth;\nlowp float alpha \x3d smoothstep(edge - aa, edge + aa, dist);\nreturn alpha * v_color * v_opacity;\n}\n#endif\nvoid main()\n{\ngl_FragColor \x3d getColor();\n}",
"text.vert":"precision highp float;\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/text/common.glsl\x3e\n#include \x3cmaterials/text/hittest.glsl\x3e\nattribute vec4 a_color;\nattribute vec4 a_haloColor;\nattribute vec4 a_texFontSize;\nattribute vec4 a_aux;\nattribute vec2 a_zoomRange;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nuniform float u_isHaloPass;\nuniform float u_isBackgroundPass;\nfloat getTextSize(inout vec2 offset, inout float baseSize, in float referenceSize) {\n#ifdef VV_SIZE\nfloat r \x3d getSize(referenceSize) / referenceSize;\nbaseSize *\x3d r;\noffset.xy *\x3d r;\nreturn baseSize;\n#endif\nreturn baseSize;\n}\nvoid main()\n{\nINIT;\nfloat a_isBackground  \x3d a_aux.y;\nfloat a_referenceSize \x3d a_aux.z * a_aux.z / 256.0;\nfloat a_bitSet        \x3d a_aux.w;\nfloat a_fontSize      \x3d a_texFontSize.z;\nvec2  a_offset        \x3d a_vertexOffset * OFFSET_PRECISION;\nvec3  in_pos        \x3d vec3(a_pos * POSITION_PRECISION, 1.0);\nfloat fontSize      \x3d getTextSize(a_offset, a_fontSize, a_referenceSize);\nfloat fontScale     \x3d fontSize / SDF_FONT_SIZE;\nvec3  offset        \x3d getRotation() * vec3(a_offset, 0.0);\nmat3  extrudeMatrix \x3d getBit(a_bitSet, 0) \x3d\x3d 1.0 ? u_displayViewMat3 : u_displayMat3;\nfloat isText \x3d 1.0 - a_isBackground;\nfloat isBackground \x3d u_isBackgroundPass * a_isBackground;\nvec4  nonHaloColor  \x3d (isBackground * a_color) + (isText * getColor(a_color, a_bitSet, 1));\nv_color   \x3d u_isHaloPass * a_haloColor + (1.0 - u_isHaloPass) * nonHaloColor;\nv_opacity \x3d getOpacity();\nv_id      \x3d norm(a_id);\nv_tex     \x3d a_texCoords / u_mosaicSize;\nv_pos     \x3d u_dvsMat3 * in_pos + extrudeMatrix * offset;\nfloat isHidden \x3d u_isBackgroundPass * isText + (1.0 - u_isBackgroundPass) * a_isBackground;\nv_pos.z +\x3d 2.0 * isHidden;\nv_edgeDistanceOffset \x3d u_isHaloPass * OUTLINE_SCALE * a_texFontSize.w / fontScale / MAX_SDF_DISTANCE;\nv_antialiasingWidth  \x3d 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\n#ifdef HITTEST\nhighp vec3 out_pos  \x3d vec3(0.);\nv_color \x3d vec4(0.);\nhittestMarker(v_color, out_pos, u_viewMat3 * u_tileMat3 *  vec3(a_pos * POSITION_PRECISION, 1.0)\n+ u_tileMat3 * offset, fontSize / 2.);\ngl_PointSize \x3d 1.;\ngl_Position \x3d vec4(clip(v_color, out_pos, getFilterFlags(), a_zoomRange), 1.0);\n#else\ngl_Position \x3d  vec4(clip(v_color, v_pos, getFilterFlags(), a_zoomRange), 1.0);\n#endif\n}"},
"utils.glsl":"float rshift(in float u32, in int amount) {\nreturn floor(u32 / pow(2.0, float(amount)));\n}\nfloat getBit(in float bitset, in int bitIndex) {\nfloat offset \x3d pow(2.0, float(bitIndex));\nreturn mod(floor(bitset / offset), 2.0);\n}\nfloat getFilterBit(in float bitset, in int bitIndex) {\nreturn getBit(bitset, bitIndex + 1);\n}\nfloat getHighlightBit(in float bitset) {\nreturn getBit(bitset, 0);\n}\nhighp vec3 unpackDisplayIdTexel(in highp vec3 bitset) {\nfloat isAggregate \x3d getBit(bitset.b, 7);\nreturn (1.0 - isAggregate) * bitset + isAggregate * (vec3(bitset.rgb) - vec3(0.0, 0.0, float(0x80)));\n}\nvec4 unpack(in float u32) {\nfloat r \x3d mod(rshift(u32, 0), 255.0);\nfloat g \x3d mod(rshift(u32, 8), 255.0);\nfloat b \x3d mod(rshift(u32, 16), 255.0);\nfloat a \x3d mod(rshift(u32, 24), 255.0);\nreturn vec4(r, g, b, a);\n}\nvec3 norm(in vec3 v) {\nreturn v /\x3d 255.0;\n}\nvec4 norm(in vec4 v) {\nreturn v /\x3d 255.0;\n}\nfloat max4(vec4 target) {\nreturn max(max(max(target.x, target.y), target.z), target.w);\n}\nvec2 unpack_u8_nf32(vec2 bytes) {\nreturn (bytes - 127.0) / 127.0;\n}\nhighp float rand(in vec2 co) {\nhighp float a \x3d 12.9898;\nhighp float b \x3d 78.233;\nhighp float c \x3d 43758.5453;\nhighp float dt \x3d dot(co, vec2(a,b));\nhighp float sn \x3d mod(dt, 3.14);\nreturn fract(sin(sn) * c);\n}",
"vcommon.glsl":"#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/attributeData.glsl\x3e\n#include \x3cmaterials/vv.glsl\x3e\n#include \x3cmaterials/barycentric.glsl\x3e\nattribute vec2 a_pos;\nattribute highp vec3 a_id;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform highp mat3 u_tileMat3;\nuniform highp mat3 u_viewMat3;\nuniform highp float u_pixelRatio;\nuniform mediump float u_zoomFactor;\nuniform mediump float u_antialiasing;\nuniform mediump float u_currentZoom;\nvec4 VV_ADATA \x3d vec4(0.0);\nvoid loadVisualVariableData(inout vec4 target) {\n#ifdef SUPPORTS_TEXTURE_FLOAT\ntarget.rgba \x3d getAttributeData2(a_id);\n#else\nvec4 data0 \x3d getAttributeData2(a_id);\nvec4 data1 \x3d getAttributeData3(a_id);\ntarget.r \x3d u88VVToFloat(data0.rg * 255.0);\ntarget.g \x3d u88VVToFloat(data0.ba * 255.0);\ntarget.b \x3d u88VVToFloat(data1.rg * 255.0);\ntarget.a \x3d u88VVToFloat(data1.ba * 255.0);\n#endif\n}\n#ifdef VV\n#define INIT loadVisualVariableData(VV_ADATA)\n#else\n#define INIT\n#endif\nvec4 getColor(in vec4 a_color, in float a_bitSet, int index) {\n#ifdef VV_COLOR\nfloat isColorLocked   \x3d getBit(a_bitSet, index);\nreturn getVVColor(VV_ADATA[ATTR_VV_COLOR], a_color, isColorLocked);\n#else\nreturn a_color;\n#endif\n}\nfloat getOpacity() {\n#ifdef VV_OPACITY\nreturn getVVOpacity(VV_ADATA[ATTR_VV_OPACITY]);\n#else\nreturn 1.0;\n#endif\n}\nfloat getSize(in float in_size) {\n#ifdef VV_SIZE\nreturn getVVSize(in_size, VV_ADATA[ATTR_VV_SIZE]);\n#else\nreturn in_size;\n#endif\n}\nmat3 getRotation() {\n#ifdef VV_ROTATION\nreturn getVVRotationMat3(mod(VV_ADATA[ATTR_VV_ROTATION], 360.0));\n#else\nreturn mat3(1.0);\n#endif\n}\nfloat getFilterFlags() {\n#ifdef IGNORES_SAMPLER_PRECISION\nreturn ceil(getAttributeData0(a_id).x * 255.0);\n#else\nreturn getAttributeData0(a_id).x * 255.0;\n#endif\n}\nvec4 getAnimationState() {\nreturn getAttributeData1(a_id);\n}\nfloat getMinZoom() {\nvec4 data0 \x3d getAttributeData0(a_id) * 255.0;\nreturn data0.g;\n}\nmat3 getMatrixNoDisplay(float isMapAligned) {\nreturn isMapAligned * u_viewMat3 * u_tileMat3 + (1.0 - isMapAligned) * u_tileMat3;\n}\nmat3 getMatrix(float isMapAligned) {\nreturn isMapAligned * u_displayViewMat3 + (1.0 - isMapAligned) * u_displayMat3;\n}\nvec3 clip(inout vec4 color, inout vec3 pos, in float filterFlags, in vec2 minMaxZoom) {\npos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 0));\n#ifdef INSIDE\npos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 1));\n#elif defined(OUTSIDE)\npos.z +\x3d 2.0 * getFilterBit(filterFlags, 1);\n#elif defined(HIGHLIGHT)\n#if !defined(HIGHLIGHT_ALL)\npos.z +\x3d 2.0 * (1.0 - getHighlightBit(filterFlags));\n#endif\n#endif\npos.z +\x3d 2.0 * (step(minMaxZoom.y, u_currentZoom) + (1.0 - step(minMaxZoom.x, u_currentZoom)));\nreturn pos;\n}",
"vv.glsl":"#if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n#define VV_SIZE\n#endif\n#if defined(VV_COLOR) || defined(VV_SIZE) || defined(VV_OPACITY) || defined(VV_ROTATION)\n#define VV\n#endif\n#ifdef VV_COLOR\nuniform highp float u_vvColorValues[8];\nuniform vec4 u_vvColors[8];\n#endif\n#ifdef VV_SIZE_MIN_MAX_VALUE\nuniform highp vec4 u_vvSizeMinMaxValue;\n#endif\n#ifdef VV_SIZE_SCALE_STOPS\nuniform highp float u_vvSizeScaleStopsValue;\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nuniform highp float u_vvSizeFieldStopsValues[6];\nuniform float u_vvSizeFieldStopsSizes[6];\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nuniform highp float u_vvSizeUnitValueWorldToPixelsRatio;\n#endif\n#ifdef VV_OPACITY\nuniform highp float u_vvOpacityValues[8];\nuniform float u_vvOpacities[8];\n#endif\n#ifdef VV_ROTATION\nuniform lowp float u_vvRotationType;\n#endif\nbool isNan(float val) {\nreturn (val \x3d\x3d NAN_MAGIC_NUMBER);\n}\n#ifdef VV_SIZE_MIN_MAX_VALUE\nfloat getVVMinMaxSize(float sizeValue, float fallback) {\nif (isNan(sizeValue)) {\nreturn fallback;\n}\nfloat interpolationRatio \x3d (sizeValue  - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\ninterpolationRatio \x3d clamp(interpolationRatio, 0.0, 1.0);\nreturn u_vvSizeMinMaxValue.z + interpolationRatio * (u_vvSizeMinMaxValue.w - u_vvSizeMinMaxValue.z);\n}\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nconst int VV_SIZE_N \x3d 6;\nfloat getVVStopsSize(float sizeValue, float fallback) {\nif (isNan(sizeValue)) {\nreturn fallback;\n}\nif (sizeValue \x3c\x3d u_vvSizeFieldStopsValues[0]) {\nreturn u_vvSizeFieldStopsSizes[0];\n}\nfor (int i \x3d 1; i \x3c VV_SIZE_N; ++i) {\nif (u_vvSizeFieldStopsValues[i] \x3e\x3d sizeValue) {\nfloat f \x3d (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\nreturn mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\n}\n}\nreturn u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\n}\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nfloat getVVUnitValue(float sizeValue, float fallback) {\nif (isNan(sizeValue)) {\nreturn fallback;\n}\nreturn u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\n}\n#endif\n#ifdef VV_OPACITY\nconst int VV_OPACITY_N \x3d 8;\nfloat getVVOpacity(float opacityValue) {\nif (isNan(opacityValue)) {\nreturn 1.0;\n}\nif (opacityValue \x3c\x3d u_vvOpacityValues[0]) {\nreturn u_vvOpacities[0];\n}\nfor (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\nif (u_vvOpacityValues[i] \x3e\x3d opacityValue) {\nfloat f \x3d (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\nreturn mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n}\n}\nreturn u_vvOpacities[VV_OPACITY_N - 1];\n}\n#endif\n#ifdef VV_ROTATION\nmat4 getVVRotation(float rotationValue) {\nif (isNan(rotationValue)) {\nreturn mat4(1, 0, 0, 0,\n0, 1, 0, 0,\n0, 0, 1, 0,\n0, 0, 0, 1);\n}\nfloat rotation \x3d rotationValue;\nif (u_vvRotationType \x3d\x3d 1.0) {\nrotation \x3d 90.0 - rotation;\n}\nfloat angle \x3d C_DEG_TO_RAD * rotation;\nfloat sinA \x3d sin(angle);\nfloat cosA \x3d cos(angle);\nreturn mat4(cosA, sinA, 0, 0,\n-sinA,  cosA, 0, 0,\n0,     0, 1, 0,\n0,     0, 0, 1);\n}\nmat3 getVVRotationMat3(float rotationValue) {\nif (isNan(rotationValue)) {\nreturn mat3(1, 0, 0,\n0, 1, 0,\n0, 0, 1);\n}\nfloat rotation \x3d rotationValue;\nif (u_vvRotationType \x3d\x3d 1.0) {\nrotation \x3d 90.0 - rotation;\n}\nfloat angle \x3d C_DEG_TO_RAD * -rotation;\nfloat sinA \x3d sin(angle);\nfloat cosA \x3d cos(angle);\nreturn mat3(cosA, -sinA, 0,\nsinA, cosA, 0,\n0,    0,    1);\n}\n#endif\n#ifdef VV_COLOR\nconst int VV_COLOR_N \x3d 8;\nvec4 getVVColor(float colorValue, vec4 fallback, float isColorLocked) {\nif (isNan(colorValue) || isColorLocked \x3d\x3d 1.0) {\nreturn fallback;\n}\nif (colorValue \x3c\x3d u_vvColorValues[0]) {\nreturn u_vvColors[0];\n}\nfor (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\nif (u_vvColorValues[i] \x3e\x3d colorValue) {\nfloat f \x3d (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\nreturn mix(u_vvColors[i-1], u_vvColors[i], f);\n}\n}\nreturn u_vvColors[VV_COLOR_N - 1];\n}\n#endif\nfloat getVVSize(in float size, in float vvSize)  {\n#ifdef VV_SIZE_MIN_MAX_VALUE\nreturn getVVMinMaxSize(vvSize, size);\n#elif defined(VV_SIZE_SCALE_STOPS)\nreturn u_vvSizeScaleStopsValue;\n#elif defined(VV_SIZE_FIELD_STOPS)\nfloat outSize \x3d getVVStopsSize(vvSize, size);\nreturn isNan(outSize) ? size : outSize;\n#elif defined(VV_SIZE_UNIT_VALUE)\nreturn getVVUnitValue(vvSize, size);\n#else\nreturn size;\n#endif\n}"},
overlay:{overlay:{"overlay.frag":"precision lowp float;\nuniform lowp sampler2D u_texture;\nuniform lowp float u_opacity;\nvarying mediump vec2 v_uv;\nvoid main() {\nvec4 color \x3d texture2D(u_texture, v_uv);\ngl_FragColor \x3d color *  u_opacity;\n}","overlay.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec2 a_uv;\nuniform highp mat3 u_dvsMat3;\nuniform mediump vec2 u_perspective;\nvarying mediump vec2 v_uv;\nvoid main(void) {\nv_uv \x3d a_uv;\nfloat w \x3d 1.0 + dot(a_uv, u_perspective);\nvec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0);\ngl_Position \x3d vec4(w * pos.xy, 0.0, w);\n}"}},
"post-processing":{blit:{"blit.frag":"precision mediump float;\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\nvoid main() {\ngl_FragColor \x3d texture2D(u_texture, v_uv);\n}"},bloom:{composite:{"composite.frag":"precision mediump float;\nvarying vec2 v_uv;\nuniform sampler2D u_blurTexture1;\nuniform sampler2D u_blurTexture2;\nuniform sampler2D u_blurTexture3;\nuniform sampler2D u_blurTexture4;\nuniform sampler2D u_blurTexture5;\nuniform float u_bloomStrength;\nuniform float u_bloomRadius;\nuniform float u_bloomFactors[NUMMIPS];\nuniform vec3 u_bloomTintColors[NUMMIPS];\nfloat lerpBloomFactor(const in float factor) {\nfloat mirrorFactor \x3d 1.2 - factor;\nreturn mix(factor, mirrorFactor, u_bloomRadius);\n}\nvoid main() {\nvec4 color \x3d u_bloomStrength * (\nlerpBloomFactor(u_bloomFactors[0]) * vec4(u_bloomTintColors[0], 1.0) * texture2D(u_blurTexture1, v_uv) +\nlerpBloomFactor(u_bloomFactors[1]) * vec4(u_bloomTintColors[1], 1.0) * texture2D(u_blurTexture2, v_uv) +\nlerpBloomFactor(u_bloomFactors[2]) * vec4(u_bloomTintColors[2], 1.0) * texture2D(u_blurTexture3, v_uv) +\nlerpBloomFactor(u_bloomFactors[3]) * vec4(u_bloomTintColors[3], 1.0) * texture2D(u_blurTexture4, v_uv) +\nlerpBloomFactor(u_bloomFactors[4]) * vec4(u_bloomTintColors[4], 1.0) * texture2D(u_blurTexture5, v_uv)\n);\ngl_FragColor \x3d clamp(color, 0.0, 1.0);\n}"},
gaussianBlur:{"gaussianBlur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nuniform vec2 u_direction;\nvarying vec2 v_uv;\n#define KERNEL_RADIUS RADIUS\n#define SIGMA RADIUS\nfloat gaussianPdf(in float x, in float sigma) {\nreturn 0.39894 * exp(-0.5 * x * x / ( sigma * sigma)) / sigma;\n}\nvoid main() {\nvec2 invSize \x3d 1.0 / u_texSize;\nfloat fSigma \x3d float(SIGMA);\nfloat weightSum \x3d gaussianPdf(0.0, fSigma);\nvec4 pixelColorSum \x3d texture2D(u_colorTexture, v_uv) * weightSum;\nfor (int i \x3d 1; i \x3c KERNEL_RADIUS; i ++) {\nfloat x \x3d float(i);\nfloat w \x3d gaussianPdf(x, fSigma);\nvec2 uvOffset \x3d u_direction * invSize * x;\nvec4 sample1 \x3d texture2D(u_colorTexture, v_uv + uvOffset);\nvec4 sample2 \x3d texture2D(u_colorTexture, v_uv - uvOffset);\npixelColorSum +\x3d (sample1 + sample2) * w;\nweightSum +\x3d 2.0 * w;\n}\ngl_FragColor \x3d pixelColorSum /weightSum;\n}"},
luminosityHighPass:{"luminosityHighPass.frag":"precision mediump float;\nuniform sampler2D u_texture;\nuniform vec3 u_defaultColor;\nuniform float u_defaultOpacity;\nuniform float u_luminosityThreshold;\nuniform float u_smoothWidth;\nvarying vec2 v_uv;\nvoid main() {\nvec4 texel \x3d texture2D(u_texture, v_uv);\nvec3 luma \x3d vec3(0.299, 0.587, 0.114);\nfloat v \x3d dot(texel.xyz, luma);\nvec4 outputColor \x3d vec4(u_defaultColor.rgb, u_defaultOpacity);\nfloat alpha \x3d smoothstep(u_luminosityThreshold, u_luminosityThreshold + u_smoothWidth, v);\ngl_FragColor \x3d mix(outputColor, texel, alpha);\n}"}},
blur:{gaussianBlur:{"gaussianBlur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nuniform vec2 u_direction;\nuniform float u_sigma;\nvarying vec2 v_uv;\n#define KERNEL_RADIUS RADIUS\nfloat gaussianPdf(in float x, in float sigma) {\nreturn 0.39894 * exp(-0.5 * x * x / ( sigma * sigma)) / sigma;\n}\nvoid main() {\nvec2 invSize \x3d 1.0 / u_texSize;\nfloat fSigma \x3d u_sigma;\nfloat weightSum \x3d gaussianPdf(0.0, fSigma);\nvec4 pixelColorSum \x3d texture2D(u_colorTexture, v_uv) * weightSum;\nfor (int i \x3d 1; i \x3c KERNEL_RADIUS; i ++) {\nfloat x \x3d float(i);\nfloat w \x3d gaussianPdf(x, fSigma);\nvec2 uvOffset \x3d u_direction * invSize * x;\nvec4 sample1 \x3d texture2D(u_colorTexture, v_uv + uvOffset);\nvec4 sample2 \x3d texture2D(u_colorTexture, v_uv - uvOffset);\npixelColorSum +\x3d (sample1 + sample2) * w;\nweightSum +\x3d 2.0 * w;\n}\ngl_FragColor \x3d pixelColorSum /weightSum;\n}"},
"radial-blur":{"radial-blur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nconst float sampleDist \x3d 1.0;\nconst float sampleStrength \x3d 2.2;\nvoid main(void) {\nfloat samples[10];\nsamples[0] \x3d -0.08;\nsamples[1] \x3d -0.05;\nsamples[2] \x3d -0.03;\nsamples[3] \x3d -0.02;\nsamples[4] \x3d -0.01;\nsamples[5] \x3d  0.01;\nsamples[6] \x3d  0.02;\nsamples[7] \x3d  0.03;\nsamples[8] \x3d  0.05;\nsamples[9] \x3d  0.08;\nvec2 dir \x3d 0.5 - v_uv;\nfloat dist \x3d sqrt(dir.x * dir.x + dir.y * dir.y);\ndir \x3d dir / dist;\nvec4 color \x3d texture2D(u_colorTexture,v_uv);\nvec4 sum \x3d color;\nfor (int i \x3d 0; i \x3c 10; i++) {\nsum +\x3d texture2D(u_colorTexture, v_uv + dir * samples[i] * sampleDist);\n}\nsum *\x3d 1.0 / 11.0;\nfloat t \x3d dist * sampleStrength;\nt \x3d clamp(t, 0.0, 1.0);\ngl_FragColor \x3d mix(color, sum, t);\n}"}},
dra:{"dra.frag":"precision mediump float;\nuniform sampler2D u_minColor;\nuniform sampler2D u_maxColor;\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\nvoid main() {\nvec4 minColor \x3d texture2D(u_minColor, vec2(0.5));\nvec4 maxColor \x3d texture2D(u_maxColor, vec2(0.5));\nvec4 color \x3d texture2D(u_texture, v_uv);\nvec3 minColorUnpremultiply \x3d minColor.rgb / minColor.a;\nvec3 maxColorUnpremultiply \x3d maxColor.rgb / maxColor.a;\nvec3 colorUnpremultiply \x3d color.rgb / color.a;\nvec3 range \x3d maxColorUnpremultiply - minColorUnpremultiply;\ngl_FragColor \x3d vec4(color.a * (colorUnpremultiply - minColorUnpremultiply) / range, color.a);\n}",
"min-max":{"min-max.frag":"#extension GL_EXT_draw_buffers : require\nprecision mediump float;\n#define CELL_SIZE 2\nuniform sampler2D u_minTexture;\nuniform sampler2D u_maxTexture;\nuniform vec2 u_srcResolution;\nuniform vec2 u_dstResolution;\nvarying vec2 v_uv;\nvoid main() {\nvec2 srcPixel \x3d floor(gl_FragCoord.xy) * float(CELL_SIZE);\nvec2 onePixel \x3d vec2(1.0) / u_srcResolution;\nvec2 uv \x3d (srcPixel + 0.5) / u_srcResolution;\nvec4 minColor \x3d vec4(1.0);\nvec4 maxColor \x3d vec4(0.0);\nfor (int y \x3d 0; y \x3c CELL_SIZE; ++y) {\nfor (int x \x3d 0; x \x3c CELL_SIZE; ++x) {\nvec2 offset \x3d uv + vec2(x, y) * onePixel;\nminColor \x3d min(minColor, texture2D(u_minTexture, offset));\nmaxColor \x3d max(maxColor, texture2D(u_maxTexture, offset));\n}\n}\ngl_FragData[0] \x3d minColor;\ngl_FragData[1] \x3d maxColor;\n}"}},
"drop-shadow":{composite:{"composite.frag":"precision mediump float;\nuniform sampler2D u_layerFBOTexture;\nuniform sampler2D u_blurTexture;\nuniform vec4 u_shadowColor;\nuniform vec2 u_shadowOffset;\nuniform highp mat3 u_displayViewMat3;\nvarying vec2 v_uv;\nvoid main() {\nvec3 offset \x3d u_displayViewMat3 * vec3(u_shadowOffset, 0.0);\nvec4 layerColor \x3d texture2D(u_layerFBOTexture, v_uv);\nvec4 blurColor \x3d texture2D(u_blurTexture, v_uv - offset.xy / 2.0);\ngl_FragColor \x3d ((1.0 - layerColor.a) * blurColor.a * u_shadowColor + layerColor);\n}"}},
"edge-detect":{"frei-chen":{"frei-chen.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nvarying vec2 v_uv;\nvec2 texel \x3d vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[9];\nconst mat3 g0 \x3d mat3( 0.3535533845424652, 0, -0.3535533845424652, 0.5, 0, -0.5, 0.3535533845424652, 0, -0.3535533845424652 );\nconst mat3 g1 \x3d mat3( 0.3535533845424652, 0.5, 0.3535533845424652, 0, 0, 0, -0.3535533845424652, -0.5, -0.3535533845424652 );\nconst mat3 g2 \x3d mat3( 0, 0.3535533845424652, -0.5, -0.3535533845424652, 0, 0.3535533845424652, 0.5, -0.3535533845424652, 0 );\nconst mat3 g3 \x3d mat3( 0.5, -0.3535533845424652, 0, -0.3535533845424652, 0, 0.3535533845424652, 0, 0.3535533845424652, -0.5 );\nconst mat3 g4 \x3d mat3( 0, -0.5, 0, 0.5, 0, 0.5, 0, -0.5, 0 );\nconst mat3 g5 \x3d mat3( -0.5, 0, 0.5, 0, 0, 0, 0.5, 0, -0.5 );\nconst mat3 g6 \x3d mat3( 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.6666666865348816, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204 );\nconst mat3 g7 \x3d mat3( -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, 0.6666666865348816, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408 );\nconst mat3 g8 \x3d mat3( 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408 );\nvoid main() {\nG[0] \x3d g0,\nG[1] \x3d g1,\nG[2] \x3d g2,\nG[3] \x3d g3,\nG[4] \x3d g4,\nG[5] \x3d g5,\nG[6] \x3d g6,\nG[7] \x3d g7,\nG[8] \x3d g8;\nmat3 I;\nfloat cnv[9];\nvec3 sample;\nfor (float i \x3d 0.0; i \x3c 3.0; i++) {\nfor (float j \x3d 0.0; j \x3c 3.0; j++) {\nsample \x3d texture2D(u_colorTexture, v_uv + texel * vec2(i - 1.0,j - 1.0)).rgb;\nI[int(i)][int(j)] \x3d length(sample);\n}\n}\nfor (int i \x3d 0; i \x3c 9; i++) {\nfloat dp3 \x3d dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\ncnv[i] \x3d dp3 * dp3;\n}\nfloat M \x3d (cnv[0] + cnv[1]) + (cnv[2] + cnv[3]);\nfloat S \x3d (cnv[4] + cnv[5]) + (cnv[6] + cnv[7]) + (cnv[8] + M);\ngl_FragColor \x3d vec4(vec3(sqrt(M / S)), texture2D(u_colorTexture, v_uv).a);\n}"},
sobel:{"sobel.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nuniform vec2 u_texSize;\nvec2 texel \x3d vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[2];\nconst mat3 g0 \x3d mat3( 1.0, 2.0, 1.0, 0.0, 0.0, 0.0, -1.0, -2.0, -1.0 );\nconst mat3 g1 \x3d mat3( 1.0, 0.0, -1.0, 2.0, 0.0, -2.0, 1.0, 0.0, -1.0 );\nvoid main() {\nmat3 I;\nfloat cnv[2];\nvec3 sample;\nG[0] \x3d g0;\nG[1] \x3d g1;\nfor (float i \x3d 0.0; i \x3c 3.0; i++) {\nfor (float j \x3d 0.0; j \x3c 3.0; j++) {\nsample \x3d texture2D( u_colorTexture, v_uv + texel * vec2(i-1.0,j-1.0) ).rgb;\nI[int(i)][int(j)] \x3d length(sample);\n}\n}\nfor (int i \x3d 0; i \x3c 2; i++) {\nfloat dp3 \x3d dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\ncnv[i] \x3d dp3 * dp3;\n}\ngl_FragColor \x3d vec4(vec3(0.5 * sqrt(cnv[0] * cnv[0] + cnv[1] * cnv[1])), texture2D(u_colorTexture, v_uv).a);\n}"}},
"edge-enhance":{"edge-enhance.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nuniform vec2 u_texSize;\nvec2 texel \x3d vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[2];\nconst mat3 g0 \x3d mat3( 1.0, 0.0, -1.0, 1.0, 0.0, -1.0, 1.0, 0.0, -1.0 );\nconst mat3 g1 \x3d mat3( 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, -1.0, -1.0, -1.0 );\nvoid main() {\nmat3 I;\nfloat cnv[2];\nvec3 sample;\nG[0] \x3d g0;\nG[1] \x3d g1;\nfor (float i \x3d 0.0; i \x3c 3.0; i++) {\nfor (float j \x3d 0.0; j \x3c 3.0; j++) {\nsample \x3d texture2D( u_colorTexture, v_uv + texel * vec2(i-1.0,j-1.0) ).rgb;\nI[int(i)][int(j)] \x3d length(sample);\n}\n}\nfor (int i \x3d 0; i \x3c 2; i++) {\nfloat dp3 \x3d dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\ncnv[i] \x3d dp3 * dp3;\n}\nvec4 color \x3d texture2D(u_colorTexture, v_uv);\ngl_FragColor \x3d vec4(0.5 * sqrt(cnv[0] * cnv[0] + cnv[1] * cnv[1]) * color);\n}"},
filterEffect:{"filterEffect.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform mat4 u_coefficients;\nvarying vec2 v_uv;\nvoid main() {\nvec4 color \x3d texture2D(u_colorTexture, v_uv);\nvec4 rgbw \x3d u_coefficients * vec4(color.a \x3e 0.0 ? color.rgb / color.a : vec3(0.0), 1.0);\nfloat a \x3d color.a;\ngl_FragColor \x3d vec4(a * rgbw.rgb, a);\n}"},pp:{"pp.vert":"precision mediump float;\nattribute vec2 a_position;\nvarying vec2 v_uv;\nvoid main() {\ngl_Position \x3d vec4(a_position, 0.0, 1.0);\nv_uv \x3d (a_position + 1.0) / 2.0;\n}"}},
raster:{bitmap:{"bitmap.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform highp vec2 u_coordScale;\nuniform lowp float u_opacity;\n#include \x3cfiltering/bicubic.glsl\x3e\nvoid main() {\n#ifdef BICUBIC\nvec4 color \x3d sampleBicubicBSpline(u_texture, v_texcoord, u_coordScale);\n#else\nvec4 color \x3d texture2D(u_texture, v_texcoord);\n#endif\ngl_FragColor \x3d vec4(color.rgb * u_opacity, color.a * u_opacity);\n}","bitmap.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},
common:{"common.glsl":"uniform sampler2D u_image;\nuniform int u_bandCount;\nuniform bool u_flipY;\nuniform float u_opacity;\nuniform int u_resampling;\nuniform vec2 u_srcImageSize;\n#ifdef APPLY_PROJECTION\n#include \x3craster/common/projection.glsl\x3e\n#endif\n#ifdef BICUBIC\n#include \x3cfiltering/bicubic.glsl\x3e\n#endif\n#ifdef BILINEAR\n#include \x3cfiltering/bilinear.glsl\x3e\n#endif\nvec2 getPixelLocation(vec2 coords) {\nvec2 targetLocation \x3d u_flipY ? vec2(coords.s, 1.0 - coords.t) : coords;\n#ifdef APPLY_PROJECTION\ntargetLocation \x3d projectPixelLocation(targetLocation);\n#endif\nreturn targetLocation;\n}\nbool isOutside(vec2 coords){\nif (coords.t\x3e1.00001 ||coords.t\x3c-0.00001 || coords.s\x3e1.00001 ||coords.s\x3c-0.00001) {\nreturn true;\n} else {\nreturn false;\n}\n}\nvec4 getPixel(vec2 pixelLocation) {\n#ifdef BICUBIC\nvec4 color \x3d sampleBicubicBSpline(u_image, pixelLocation, u_srcImageSize);\n#elif defined(BILINEAR)\nvec4 color \x3d sampleBilinear(u_image, pixelLocation, u_srcImageSize);\n#else\nvec4 color \x3d texture2D(u_image, pixelLocation);\n#endif\nreturn color;\n}",
"common.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform highp float u_scale;\nuniform highp vec2 u_offset;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos * u_scale + u_offset;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}","contrastBrightness.glsl":"uniform float u_contrastOffset;\nuniform float u_brightnessOffset;\nvec4 adjustContrastBrightness(vec4 currentPixel, bool isFloat) {\nvec4 pixelValue \x3d isFloat ? currentPixel * 255.0 : currentPixel;\nfloat maxI \x3d 255.0;\nfloat mid \x3d 128.0;\nfloat c \x3d u_contrastOffset;\nfloat b \x3d u_brightnessOffset;\nvec4 v;\nif (c \x3e 0.0 \x26\x26 c \x3c 100.0) {\nv \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) / (2.0 * (100.0 - c)) + mid;\n} else if (c \x3c\x3d 0.0 \x26\x26 c \x3e -100.0) {\nv \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) * (100.0 + c) / 20000.0 + mid;\n} else if (c \x3d\x3d 100.0) {\nv \x3d (200.0 * pixelValue - 100.0 * maxI + (maxI + 1.0) * (100.0 - c) + 2.0 * maxI * b);\nv \x3d (sign(v) + 1.0) / 2.0;\n} else if (c \x3d\x3d -100.0) {\nv \x3d vec4(mid, mid, mid, currentPixel.a);\n}\nreturn vec4(v.r / 255.0, v.g / 255.0, v.b / 255.0, currentPixel.a);\n}",
"inverse.glsl":"float invertValue(float value) {\nfloat s \x3d sign(value);\nreturn (s * s) / (value + abs(s) - 1.0);\n}","mirror.glsl":"vec2 mirror(vec2 pos) {\nvec2 pos1 \x3d abs(pos);\nreturn step(pos1, vec2(1.0, 1.0)) * pos1 + step(1.0, pos1) * (2.0 - pos1);\n}","projection.glsl":"uniform sampler2D u_transformGrid;\nuniform vec2 u_transformSpacing;\nuniform vec2 u_transformGridSize;\nuniform vec2 u_targetImageSize;\nvec2 projectPixelLocation(vec2 coords) {\n#ifdef LOOKUP_PROJECTION\nvec4 pv \x3d texture2D(u_transformGrid, coords);\nreturn vec2(pv.r, pv.g);\n#endif\nvec2 index_image \x3d floor(coords * u_targetImageSize);\nvec2 oneTransformPixel \x3d vec2(0.25 / u_transformGridSize.s, 1.0 / u_transformGridSize.t);\nvec2 index_transform \x3d floor(index_image / u_transformSpacing) / u_transformGridSize;\nvec2 pos \x3d fract((index_image + vec2(0.5, 0.5)) / u_transformSpacing);\nvec2 srcLocation;\nvec2 transform_location \x3d index_transform + oneTransformPixel * 0.5;\nif (pos.s \x3c\x3d pos.t) {\nvec4 ll_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s, transform_location.t));\nvec4 ll_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + oneTransformPixel.s, transform_location.t));\nsrcLocation.s \x3d dot(ll_abc.rgb, vec3(pos, 1.0));\nsrcLocation.t \x3d dot(ll_def.rgb, vec3(pos, 1.0));\n} else {\nvec4 ur_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s + 2.0 * oneTransformPixel.s, transform_location.t));\nvec4 ur_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + 3.0 * oneTransformPixel.s, transform_location.t));\nsrcLocation.s \x3d dot(ur_abc.rgb, vec3(pos, 1.0));\nsrcLocation.t \x3d dot(ur_def.rgb, vec3(pos, 1.0));\n}\nreturn srcLocation;\n}"},
flow:{"getFadeOpacity.glsl":"uniform float u_decayRate;\nuniform float u_fadeToZero;\nfloat getFadeOpacity(float x) {\nfloat cutOff \x3d mix(0.0, exp(-u_decayRate), u_fadeToZero);\nreturn (exp(-u_decayRate * x) - cutOff) / (1.0 - cutOff);\n}","getFragmentColor.glsl":"vec4 getFragmentColor(vec4 color, float dist, float size, float featheringSize) {\nfloat featheringStart \x3d clamp(0.5 - featheringSize / size, 0.0, 0.5);\nif (dist \x3e featheringStart) {\ncolor *\x3d 1.0 - (dist - featheringStart) / (0.5 - featheringStart);\n}\nreturn color;\n}",
imagery:{"imagery.frag":"precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform float u_Min;\nuniform float u_Max;\nuniform float u_featheringSize;\n#include \x3craster/flow/vv.glsl\x3e\nfloat getIntensity(float v) {\nreturn u_Min + v * (u_Max - u_Min);\n}\nvoid main(void) {\nvec4 sampled \x3d texture2D(u_texture, v_texcoord);\nfloat intensity \x3d getIntensity(sampled.r);\ngl_FragColor \x3d getColor(intensity);\ngl_FragColor.a *\x3d getOpacity(sampled.r);\ngl_FragColor.a *\x3d sampled.a;\ngl_FragColor.rgb *\x3d gl_FragColor.a;\n}",
"imagery.vert":"attribute vec2 a_position;\nattribute vec2 a_texcoord;\nuniform mat3 u_dvsMat3;\nvarying vec2 v_texcoord;\nvoid main(void) {\nvec2 xy \x3d (u_dvsMat3 * vec3(a_position, 1.0)).xy;\ngl_Position \x3d vec4(xy, 0.0, 1.0);\nv_texcoord \x3d a_texcoord;\n}"},particles:{"particles.frag":"precision highp float;\nvarying vec4 v_color;\nvarying vec2 v_texcoord;\nvarying float v_size;\nuniform float u_featheringSize;\n#include \x3craster/flow/getFragmentColor.glsl\x3e\nvoid main(void) {\ngl_FragColor \x3d getFragmentColor(v_color, length(v_texcoord - 0.5), v_size, u_featheringSize);\n}",
"particles.vert":"attribute vec4 a_xyts0;\nattribute vec4 a_xyts1;\nattribute vec4 a_typeIdDurationSeed;\nattribute vec4 a_extrudeInfo;\nuniform mat3 u_dvsMat3;\nuniform mat3 u_displayViewMat3;\nuniform float u_time;\nuniform float u_trailLength;\nuniform float u_flowSpeed;\nvarying vec4 v_color;\nvarying vec2 v_texcoord;\nvarying float v_size;\nuniform float u_featheringSize;\nuniform float u_introFade;\n#include \x3craster/flow/vv.glsl\x3e\n#include \x3craster/flow/getFadeOpacity.glsl\x3e\nvoid main(void) {\nvec2 position0 \x3d a_xyts0.xy;\nfloat t0 \x3d a_xyts0.z;\nfloat speed0 \x3d a_xyts0.w;\nvec2 position1 \x3d a_xyts1.xy;\nfloat t1 \x3d a_xyts1.z;\nfloat speed1 \x3d a_xyts1.w;\nfloat type \x3d a_typeIdDurationSeed.x;\nfloat id \x3d a_typeIdDurationSeed.y;\nfloat duration \x3d a_typeIdDurationSeed.z;\nfloat seed \x3d a_typeIdDurationSeed.w;\nvec2 e0 \x3d a_extrudeInfo.xy;\nvec2 e1 \x3d a_extrudeInfo.zw;\nfloat animationPeriod \x3d duration + u_trailLength;\nfloat scaledTime \x3d u_time * u_flowSpeed;\nfloat randomizedTime \x3d scaledTime + seed * animationPeriod;\nfloat t \x3d mod(randomizedTime, animationPeriod);\nfloat fUnclamped \x3d (t - t0) / (t1 - t0);\nfloat f \x3d clamp(fUnclamped, 0.0, 1.0);\nfloat clampedTime \x3d mix(t0, t1, f);\nfloat speed \x3d mix(speed0, speed1, f);\nvec2 extrude;\nvec2 position;\nfloat fadeOpacity;\nfloat introOpacity;\nif (type \x3d\x3d 2.0) {\nif (fUnclamped \x3c 0.0 || (fUnclamped \x3e 1.0 \x26\x26 t1 !\x3d duration)) {\ngl_Position \x3d vec4(0.0, 0.0, -2.0, 1.0);\nreturn;\n}\nvec2 ortho \x3d mix(e0, e1, f);\nvec2 parallel;\nparallel \x3d normalize(position1 - position0) * 0.5;\nif (id \x3d\x3d 1.0) {\nextrude \x3d ortho;\nv_texcoord \x3d vec2(0.5, 0.0);\n} else if (id \x3d\x3d 2.0) {\nextrude \x3d -ortho;\nv_texcoord \x3d vec2(0.5, 1.0);\n} else if (id \x3d\x3d 3.0) {\nextrude \x3d ortho + parallel;\nv_texcoord \x3d vec2(1.0, 0.0);\n} else if (id \x3d\x3d 4.0) {\nextrude \x3d -ortho + parallel;\nv_texcoord \x3d vec2(1.0, 1.0);\n}\nfadeOpacity \x3d getFadeOpacity((t - clampedTime) / u_trailLength);\nintroOpacity \x3d 1.0 - exp(-clampedTime);\nv_size \x3d getSize(speed);\nv_color \x3d getColor(speed);\nv_color.a *\x3d getOpacity(speed);\nposition \x3d mix(position0, position1, f);\n} else {\nif (fUnclamped \x3c 0.0) {\ngl_Position \x3d vec4(0.0, 0.0, -2.0, 1.0);\nreturn;\n}\nif (id \x3d\x3d 1.0) {\nextrude \x3d e0;\nv_texcoord \x3d vec2(0.5, 0.0);\nfadeOpacity \x3d getFadeOpacity((t - t0) / u_trailLength);\nintroOpacity \x3d 1.0 - exp(-t0);\nv_size \x3d getSize(speed0);\nv_color \x3d getColor(speed0);\nv_color.a *\x3d getOpacity(speed0);\nposition \x3d position0;\n} else if (id \x3d\x3d 2.0) {\nextrude \x3d -e0;\nv_texcoord \x3d vec2(0.5, 1.0);\nfadeOpacity \x3d getFadeOpacity((t - t0) / u_trailLength);\nintroOpacity \x3d 1.0 - exp(-t0);\nv_size \x3d getSize(speed0);\nv_color \x3d getColor(speed0);\nv_color.a *\x3d getOpacity(speed0);\nposition \x3d position0;\n} else if (id \x3d\x3d 3.0) {\nextrude \x3d mix(e0, e1, f);\nv_texcoord \x3d vec2(0.5, 0.0);\nfadeOpacity \x3d getFadeOpacity((t - clampedTime) / u_trailLength);\nintroOpacity \x3d 1.0 - exp(-clampedTime);\nv_size \x3d getSize(speed);\nv_color \x3d getColor(speed);\nv_color.a *\x3d getOpacity(speed);\nposition \x3d mix(position0, position1, f);\n} else if (id \x3d\x3d 4.0) {\nextrude \x3d -mix(e0, e1, f);\nv_texcoord \x3d vec2(0.5, 1.0);\nfadeOpacity \x3d getFadeOpacity((t - clampedTime) / u_trailLength);\nintroOpacity \x3d 1.0 - exp(-clampedTime);\nv_size \x3d getSize(speed);\nv_color \x3d getColor(speed);\nv_color.a *\x3d getOpacity(speed);\nposition \x3d mix(position0, position1, f);\n}\n}\nvec2 xy \x3d (u_dvsMat3 * vec3(position, 1.0) + u_displayViewMat3 * vec3(extrude * v_size, 0.0)).xy;\ngl_Position \x3d vec4(xy, 0.0, 1.0);\nv_color.a *\x3d fadeOpacity;\nv_color.a *\x3d mix(1.0, introOpacity, u_introFade);\nv_color.rgb *\x3d v_color.a;\n}"},
streamlines:{"streamlines.frag":"precision highp float;\nvarying float v_side;\nvarying float v_time;\nvarying float v_totalTime;\nvarying float v_timeSeed;\nvarying vec4 v_color;\nvarying float v_size;\nuniform float u_time;\nuniform float u_trailLength;\nuniform float u_flowSpeed;\nuniform float u_featheringSize;\nuniform float u_introFade;\n#include \x3craster/flow/getFragmentColor.glsl\x3e\n#include \x3craster/flow/getFadeOpacity.glsl\x3e\nvoid main(void) {\nfloat t \x3d mod(v_timeSeed * (v_totalTime + u_trailLength) + u_time * u_flowSpeed, v_totalTime + u_trailLength) - v_time;\nvec4 color \x3d v_color * step(0.0, t) * getFadeOpacity(t / u_trailLength);\ncolor *\x3d mix(1.0, 1.0 - exp(-v_time), u_introFade);\ngl_FragColor \x3d getFragmentColor(color, length((v_side + 1.0) / 2.0 - 0.5), v_size, u_featheringSize);\n}",
"streamlines.vert":"attribute vec3 a_positionAndSide;\nattribute vec3 a_timeInfo;\nattribute vec2 a_extrude;\nattribute float a_speed;\nuniform mat3 u_dvsMat3;\nuniform mat3 u_displayViewMat3;\nvarying float v_time;\nvarying float v_totalTime;\nvarying float v_timeSeed;\nvarying vec4 v_color;\nvarying float v_side;\nvarying float v_size;\nuniform float u_featheringSize;\n#include \x3craster/flow/vv.glsl\x3e\nvoid main(void) {\nvec4 lineColor \x3d getColor(a_speed);\nfloat lineOpacity \x3d getOpacity(a_speed);\nfloat lineSize \x3d getSize(a_speed);\nvec2 position \x3d a_positionAndSide.xy;\nv_side \x3d a_positionAndSide.z;\nvec2 xy \x3d (u_dvsMat3 * vec3(position, 1.0) + u_displayViewMat3 * vec3(a_extrude * lineSize, 0.0)).xy;\ngl_Position \x3d vec4(xy, 0.0, 1.0);\nv_time \x3d a_timeInfo.x;\nv_totalTime \x3d a_timeInfo.y;\nv_timeSeed \x3d a_timeInfo.z;\nv_color \x3d lineColor;\nv_color.a *\x3d lineOpacity;\nv_color.rgb *\x3d v_color.a;\nv_size \x3d lineSize;\n}"},
"vv.glsl":"#define MAX_STOPS 8\n#ifdef VV_COLOR\nuniform float u_color_stops[MAX_STOPS];\nuniform vec4 u_color_values[MAX_STOPS];\nuniform int u_color_count;\n#else\nuniform vec4 u_color;\n#endif\n#ifdef VV_OPACITY\nuniform float u_opacity_stops[MAX_STOPS];\nuniform float u_opacity_values[MAX_STOPS];\nuniform int u_opacity_count;\n#else\nuniform float u_opacity;\n#endif\n#ifdef VV_SIZE\nuniform float u_size_stops[MAX_STOPS];\nuniform float u_size_values[MAX_STOPS];\nuniform int u_size_count;\n#else\nuniform float u_size;\n#endif\nuniform float u_featheringOffset;\nvec4 getColor(float x) {\n#ifdef VV_COLOR\nvec4 color \x3d u_color_values[0];\n{\nfor (int i \x3d 1; i \x3c MAX_STOPS; i++) {\nif (i \x3e\x3d u_color_count) {\nbreak;\n}\nfloat x1 \x3d u_color_stops[i - 1];\nif (x \x3c x1) {\nbreak;\n}\nfloat x2 \x3d u_color_stops[i];\nvec4 y2 \x3d u_color_values[i];\nif (x \x3c x2) {\nvec4 y1 \x3d u_color_values[i - 1];\ncolor \x3d y1 + (y2 - y1) * (x - x1) / (x2 - x1);\n} else {\ncolor \x3d y2;\n}\n}\n}\n#else\nvec4 color \x3d u_color;\n#endif\nreturn color;\n}\nfloat getOpacity(float x) {\n#ifdef VV_OPACITY\nfloat opacity \x3d u_opacity_values[0];\n{\nfor (int i \x3d 1; i \x3c MAX_STOPS; i++) {\nif (i \x3e\x3d u_opacity_count) {\nbreak;\n}\nfloat x1 \x3d u_opacity_stops[i - 1];\nif (x \x3c x1) {\nbreak;\n}\nfloat x2 \x3d u_opacity_stops[i];\nfloat y2 \x3d u_opacity_values[i];\nif (x \x3c x2) {\nfloat y1 \x3d u_opacity_values[i - 1];\nopacity \x3d y1 + (y2 - y1) * (x - x1) / (x2 - x1);\n} else {\nopacity \x3d y2;\n}\n}\n}\n#else\nfloat opacity \x3d u_opacity;\n#endif\nreturn opacity;\n}\nfloat getSize(float x) {\n#ifdef VV_SIZE\nfloat size \x3d u_size_values[0];\n{\nfor (int i \x3d 1; i \x3c MAX_STOPS; i++) {\nif (i \x3e\x3d u_size_count) {\nbreak;\n}\nfloat x1 \x3d u_size_stops[i - 1];\nif (x \x3c x1) {\nbreak;\n}\nfloat x2 \x3d u_size_stops[i];\nfloat y2 \x3d u_size_values[i];\nif (x \x3c x2) {\nfloat y1 \x3d u_size_values[i - 1];\nsize \x3d y1 + (y2 - y1) * (x - x1) / (x2 - x1);\n} else {\nsize \x3d y2;\n}\n}\n}\n#else\nfloat size \x3d u_size;\n#endif\nreturn size + 2.0 * u_featheringSize * u_featheringOffset;\n}"},
hillshade:{"hillshade.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nuniform int u_hillshadeType;\nuniform float u_sinZcosAs[6];\nuniform float u_sinZsinAs[6];\nuniform float u_cosZs[6];\nuniform float u_weights[6];\nuniform vec2 u_factor;\nuniform float u_minValue;\nuniform float u_maxValue;\n#include \x3craster/lut/colorize.glsl\x3e\nfloat getNeighborHoodAlpha(float a, float b, float c, float d, float e, float f, float g, float h, float i){\nif (a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0 || a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0 || a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0) {\nreturn 0.0;\n}\nelse {\nreturn e;\n}\n}\nvec3 rgb2hsv(vec3 c) {\nvec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\nvec4 p \x3d c.g \x3c c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\nvec4 q \x3d c.r \x3c p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\nfloat d \x3d q.x - min(q.w, q.y);\nfloat e \x3d 1.0e-10;\nreturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n}\nvec3 hsv2rgb(vec3 c) {\nvec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\nvec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\nreturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nvec4 overlay(float val, float minValue, float maxValue, float hillshade) {\nval \x3d clamp((val - minValue) / (maxValue - minValue), 0.0, 1.0);\nvec4 rgb \x3d colorize(vec4(val, val, val, 1.0), 255.0);\nvec3 hsv \x3d rgb2hsv(rgb.xyz);\nhsv.z \x3d hillshade;\nreturn vec4(hsv2rgb(hsv), 1.0) * rgb.a;\n}\nvoid main() {\nvec2 pixelLocation \x3d getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel \x3d getPixel(pixelLocation);\nif (currentPixel.a \x3d\x3d 0.0) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec2 axy \x3d vec2(-1.0, -1.0);\nvec2 bxy \x3d vec2(0.0, -1.0);\nvec2 cxy \x3d vec2(1.0, -1.0);\nvec2 dxy \x3d vec2(-1.0, 0.0);\nvec2 fxy \x3d vec2(1.0, 0.0);\nvec2 gxy \x3d vec2(-1.0, 1.0);\nvec2 hxy \x3d vec2(0.0, 1.0);\nvec2 ixy \x3d vec2(1.0, 1.0);\nvec2 onePixel \x3d 1.0 / u_srcImageSize;\nif (pixelLocation.s \x3c onePixel.s) {\naxy[0] \x3d 1.0;\ndxy[0] \x3d 1.0;\ngxy[0] \x3d 1.0;\n}\nif (pixelLocation.t \x3c onePixel.t) {\naxy[1] \x3d 1.0;\nbxy[1] \x3d 1.0;\ncxy[1] \x3d 1.0;\n}\nif (pixelLocation.s \x3e 1.0 - onePixel.s) {\ncxy[0] \x3d -1.0;\nfxy[0] \x3d -1.0;\nixy[0] \x3d -1.0;\n}\nif (pixelLocation.t \x3e 1.0 - onePixel.t) {\ngxy[1] \x3d -1.0;\nhxy[1] \x3d -1.0;\nixy[1] \x3d -1.0;\n}\nvec4 va \x3d texture2D(u_image, pixelLocation + onePixel * axy);\nvec4 vb \x3d texture2D(u_image, pixelLocation + onePixel * bxy);\nvec4 vc \x3d texture2D(u_image, pixelLocation + onePixel * cxy);\nvec4 vd \x3d texture2D(u_image, pixelLocation + onePixel * dxy);\nvec4 ve \x3d texture2D(u_image, pixelLocation);\nvec4 vf \x3d texture2D(u_image, pixelLocation + onePixel * fxy);\nvec4 vg \x3d texture2D(u_image, pixelLocation + onePixel * gxy);\nvec4 vh \x3d texture2D(u_image, pixelLocation + onePixel * hxy);\nvec4 vi \x3d texture2D(u_image, pixelLocation + onePixel * ixy);\nfloat dzx \x3d (vc + 2.0 * vf + vi - va - 2.0 * vd - vg).r * u_factor.s;\nfloat dzy \x3d (vg + 2.0 * vh + vi - va - 2.0 * vb - vc).r * u_factor.t;\nfloat dzd \x3d sqrt(1.0 + dzx * dzx + dzy * dzy);\nfloat hillshade \x3d 0.0;\nif (u_hillshadeType \x3d\x3d 0){\nfloat cosDelta \x3d u_sinZsinAs[0] * dzy - u_sinZcosAs[0] * dzx;\nfloat z \x3d (u_cosZs[0] + cosDelta) / dzd;\nif (z \x3c 0.0)  z \x3d 0.0;\nhillshade \x3d z;\n} else {\nfor (int k \x3d 0; k \x3c 6; k++) {\nfloat cosDelta \x3d u_sinZsinAs[k] * dzy - u_sinZcosAs[k] * dzx;\nfloat z \x3d (u_cosZs[k] + cosDelta) / dzd;\nif (z \x3c 0.0) z \x3d 0.0;\nhillshade \x3d hillshade + z * u_weights[k];\nif (k \x3d\x3d 5) break;\n}\n}\nfloat alpha \x3d getNeighborHoodAlpha(va.a, vb.a, vc.a, vd.a, ve.a, vf.a, vg.a, vh.a, vi.a);\n#ifdef APPLY_COLORMAP\ngl_FragColor \x3d overlay(ve.r, u_minValue, u_maxValue, hillshade) * alpha * u_opacity;\n#else\ngl_FragColor \x3d vec4(hillshade, hillshade, hillshade, 1.0) * alpha * u_opacity;\n#endif\n}"},
lut:{"colorize.glsl":"uniform sampler2D u_colormap;\nuniform float u_colormapOffset;\nuniform float u_colormapMaxIndex;\nvec4 colorize(vec4 currentPixel, float scaleFactor) {\nfloat clrIndex \x3d clamp(currentPixel.r * scaleFactor - u_colormapOffset, 0.0, u_colormapMaxIndex);\nvec2 clrPosition \x3d vec2((clrIndex + 0.5) / (u_colormapMaxIndex + 1.0), 0.0);\nvec4 color \x3d texture2D(u_colormap, clrPosition);\nvec4 result \x3d vec4(color.rgb, color.a * currentPixel.a);\nreturn result;\n}","lut.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\n#include \x3craster/lut/colorize.glsl\x3e\nvoid main() {\nvec2 pixelLocation \x3d getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel \x3d getPixel(pixelLocation);\nvec4 result \x3d colorize(currentPixel, 1.0);\ngl_FragColor \x3d vec4(result.xyz, 1.0) * result.a * u_opacity;\n}"},
magdir:{"magdir.frag":"precision mediump float;\nvarying vec4 v_color;\nuniform lowp float u_opacity;\nvoid main() {\ngl_FragColor \x3d v_color * u_opacity;\n}","magdir.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_vv;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform vec2 u_symbolSize;\nuniform vec2 u_symbolPercentRange;\nuniform vec2 u_dataRange;\nuniform float u_rotation;\nuniform vec4 u_colors[12];\nvarying vec4 v_color;\nvoid main()\n{\nfloat angle \x3d a_offset.y + u_rotation;\n#ifndef ROTATION_GEOGRAPHIC\nangle \x3d 3.14159265359 * 2.0 - angle - 3.14159265359 / 2.0;\n#endif\nvec2 offset \x3d vec2(cos(angle), sin(angle)) * a_offset.x;\n#ifdef DATA_RANGE\nfloat valuePercentage \x3d clamp((a_vv.y - u_dataRange.x) / (u_dataRange.y - u_dataRange.x), 0.0, 1.0);\nfloat sizeRatio \x3d u_symbolPercentRange.x + valuePercentage * (u_symbolPercentRange.y - u_symbolPercentRange.x);\nfloat sizePercentage \x3d clamp(sizeRatio, u_symbolPercentRange.x, u_symbolPercentRange.y);\n#else\nfloat sizePercentage \x3d (u_symbolPercentRange.x + u_symbolPercentRange.y) / 2.0;\n#endif\nvec2 pos \x3d a_pos + offset * sizePercentage * u_symbolSize;\nv_color \x3d u_colors[int(a_vv.x)];\ngl_Position \x3d vec4(u_dvsMat3 * vec3(pos * u_coordScale, 1.0), 1.0);\n}"},
reproject:{"reproject.frag":"precision mediump float;\nvarying vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nvoid main() {\nvec2 pixelLocation \x3d getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 1.0);\nreturn;\n}\nvec4 currentPixel \x3d getPixel(pixelLocation);\ngl_FragColor \x3d vec4(currentPixel.rgb, 1.0) * currentPixel.a * u_opacity;\n}","reproject.vert":"precision mediump float;\nattribute vec2 a_position;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_position;\ngl_Position \x3d vec4(2.0 * (a_position - 0.5), 0.0, 1.0);\n}"},
rfx:{aspect:{"aspect.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\nuniform vec2 u_cellSize;\nuniform vec2 u_srcImageSize;\n#include \x3craster/common/mirror.glsl\x3e\nconst float pi \x3d 3.14159265359;\nvoid main() {\nvec2 axy \x3d vec2(-1.0, -1.0);\nvec2 bxy \x3d vec2(0.0, -1.0);\nvec2 cxy \x3d vec2(1.0, -1.0);\nvec2 dxy \x3d vec2(-1.0, 0.0);\nvec2 fxy \x3d vec2(1.0, 0.0);\nvec2 gxy \x3d vec2(-1.0, 1.0);\nvec2 hxy \x3d vec2(0.0, 1.0);\nvec2 ixy \x3d vec2(1.0, 1.0);\nvec2 onePixel \x3d 1.0 / u_srcImageSize;\nvec4 va \x3d texture2D(u_image, mirror(v_texcoord + onePixel * axy));\nvec4 vb \x3d texture2D(u_image, mirror(v_texcoord + onePixel * bxy));\nvec4 vc \x3d texture2D(u_image, mirror(v_texcoord + onePixel * cxy));\nvec4 vd \x3d texture2D(u_image, mirror(v_texcoord + onePixel * dxy));\nvec4 ve \x3d texture2D(u_image, mirror(v_texcoord + onePixel * vec2(0, 0)));\nvec4 vf \x3d texture2D(u_image, mirror(v_texcoord + onePixel * fxy));\nvec4 vg \x3d texture2D(u_image, mirror(v_texcoord + onePixel * gxy));\nvec4 vh \x3d texture2D(u_image, mirror(v_texcoord + onePixel * hxy));\nvec4 vi \x3d texture2D(u_image, mirror(v_texcoord + onePixel * ixy));\nfloat dzx \x3d (vc + 2.0 * vf + vi - va - 2.0 * vd - vg).r / (8.0 * u_cellSize[0]);\nfloat dzy \x3d -(vg + 2.0 * vh + vi - va - 2.0 * vb - vc).r / (8.0 * u_cellSize[1]);\nfloat alpha \x3d va.a * vb.a * vc.a * vd.a * ve.a * vf.a * vg.a * vh.a * vi.a * sign(abs(dzx) + abs(dzy));\nfloat aspect_rad \x3d (dzx \x3d\x3d 0.0) ? (step(0.0, dzy) * 0.5 * pi + step(dzy, 0.0) * 1.5 * pi) : mod((2.5 * pi + atan(dzy, -dzx)), 2.0 * pi);\nfloat aspect \x3d aspect_rad * 180.0 / pi;\ngl_FragColor \x3d vec4(aspect, aspect, aspect, 1.0) * alpha;\n}"},
bandarithmetic:{"bandarithmetic.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\nuniform mediump mat3 u_bandIndexMat3;\nuniform float u_adjustments[3];\n#include \x3craster/common/inverse.glsl\x3e\nvoid main() {\nvec4 pv \x3d texture2D(u_image, v_texcoord);\nvec3 pv2 \x3d u_bandIndexMat3 * pv.rgb;\nfloat nir \x3d pv2.r;\nfloat red \x3d pv2.g;\nfloat index;\n#ifdef NDXI\nindex \x3d (nir - red) * invertValue(nir + red);\n#elif defined(SR)\nindex \x3d nir * invertValue(red);\n#elif defined(CI)\nindex \x3d nir * invertValue(red) - 1.0;\n#elif defined(SAVI)\nindex \x3d (nir - red) * invertValue(nir + red + u_adjustments[0]) * (1.0 + u_adjustments[0]);\n#elif defined(TSAVI)\nfloat s \x3d u_adjustments[0];\nfloat a \x3d u_adjustments[1];\nfloat x \x3d u_adjustments[2];\nfloat y \x3d -a * s + x * (1.0 + s * s);\nindex \x3d (s * (nir - s * red - a)) * invertValue(a * nir + red + y);\n#elif defined(MAVI)\nindex \x3d 0.5 * (2.0 * (nir + 1.0) - sqrt(pow((2.0 * nir + 1.0), 2.0) - 8.0 * (nir - red)));\n#elif defined(GEMI)\nfloat eta \x3d (2.0 * (nir * nir - red * red) + 1.5 * nir + 0.5 * red) * invertValue(nir + red + 0.5);\nindex \x3d eta * (1.0 - 0.25 * eta) - (red - 0.125) * invertValue(1.0 - red);\n#elif defined(PVI)\nfloat a \x3d u_adjustments[0];\nfloat b \x3d u_adjustments[1];\nfloat y \x3d sqrt(1.0 + a * a);\nindex \x3d (nir - a * red - b) * invertValue(y);\n#elif defined(VARI)\nindex \x3d (pv2.g - pv2.r) * invertValue(pv2.g + pv2.r - pv2.b);\n#elif defined(MTVI2)\nfloat green \x3d pv2.b;\nfloat v \x3d pow(sqrt((2.0 * nir + 1.0), 2.0) - 6.0 * nir - 5.0 * sqrt(red) - 0.5);\nindex \x3d 1.5 * (1.2 * (nir - green) - 2.5 * (red - green)) * v;\n#elif defined(RTVICORE)\nfloat green \x3d pv2.b;\nindex \x3d 100.0 * (nir - red) - 10.0 * (nir - green);\n#elif defined(EVI)\nfloat blue \x3d pv2.b;\nfloat denom \x3d nir + 6.0 * red - 7.5 * blue + 1.0;\nindex \x3d  (2.5 * (nir - red)) * invertValue(denom);\n#elif defined(WNDWI)\nfloat g \x3d pv2.r;\nfloat n \x3d pv2.g;\nfloat s \x3d pv2.s;\nfloat a \x3d u_adjustments[0];\nfloat denom \x3d g + a * n + (1.0 - a) * s;\nindex \x3d (g - a * n - (1 - a) * s) * invertValue(denom);\n#elif defined(BAI)\nindex \x3d invertValue(pow((0.1 - red), 2.0) + pow((0.06 - nir), 2.0));\n#else\ngl_FragColor \x3d pv;\nreturn;\n#endif\ngl_FragColor \x3d vec4(index, index, index, pv.a);\n}"},
compositeband:{"compositeband.frag":"precision mediump float;\nuniform sampler2D u_image;\nuniform sampler2D u_image1;\nuniform sampler2D u_image2;\nvarying vec2 v_texcoord;\nvoid main() {\nvec4 p0 \x3d texture2D(u_image, v_texcoord);\nvec4 p1 \x3d texture2D(u_image1, v_texcoord);\nvec4 p2 \x3d texture2D(u_image2, v_texcoord);\ngl_FragColor \x3d vec4(p0.r, p1.r, p2.r, p0.a * p1.a * p2.a);\n}"},convolution:{"convolution.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\nuniform vec2 u_srcImageSize;\n#define KERNEL_SIZE_ROWS ROWS\n#define KERNEL_SIZE_COLS COLS\nuniform vec2 u_clampRange;\nuniform float u_kernel[25];\n#include \x3craster/common/mirror.glsl\x3e\nvoid main() {\nvec3 rgb \x3d vec3(0.0, 0.0, 0.0);\nvec2 resolution \x3d 1.0 / u_srcImageSize;\nfloat rowOffset \x3d -float(floor(float(KERNEL_SIZE_ROWS) / 2.0));\nfloat colOffset \x3d -float(floor(float(KERNEL_SIZE_COLS) / 2.0));\nfloat alpha \x3d 1.0;\nfor (int row \x3d 0; row \x3c KERNEL_SIZE_ROWS; row++) {\nfloat pos_row \x3d rowOffset + float(row);\nfor (int col \x3d 0; col \x3c KERNEL_SIZE_COLS; col++) {\nvec2 pos \x3d v_texcoord + vec2(colOffset + float(col), pos_row) * resolution;\nvec4 pv \x3d texture2D(u_image, mirror(pos));\nrgb +\x3d pv.rgb * u_kernel[row * KERNEL_SIZE_COLS + col];\nalpha *\x3d pv.a;\n}\n}\nrgb \x3d clamp(rgb, u_clampRange.s, u_clampRange.t);\ngl_FragColor \x3d vec4(rgb * alpha, alpha);\n}"},
extractband:{"extractband.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\nuniform mediump mat3 u_bandIndexMat3;\nvoid main() {\nvec4 pv \x3d texture2D(u_image, v_texcoord);\nvec3 pv2 \x3d u_bandIndexMat3 * pv.rgb;\ngl_FragColor \x3d vec4(pv2, pv.a);\n}"},local:{"local.frag":"precision mediump float;\nuniform sampler2D u_image;\nuniform sampler2D u_image1;\n#ifdef ONE_CONSTANT\nuniform float u_image1Const;\n#ifdef TWO_CONSTANT\nuniform float u_image2Const;\n#endif\nuniform mat3 u_imageSwap;\n#endif\nvarying vec2 v_texcoord;\nuniform vec2 u_domainRange;\n#include \x3craster/common/inverse.glsl\x3e\nvoid main() {\nvec4 pv0 \x3d texture2D(u_image, v_texcoord);\nfloat a \x3d pv0.r;\n#ifdef TWO_IMAGES\n#ifdef ONE_CONSTANT\nfloat b \x3d u_image1Const;\nvec3 abc \x3d u_imageSwap * vec3(a, b, 0);\na \x3d abc.s;\nb \x3d abc.t;\n#else\nvec4 pv1 \x3d texture2D(u_image1, v_texcoord);\nfloat b \x3d pv1.r;\n#endif\n#elif defined(CONDITIONAL)\n#ifdef TWO_CONSTANT\nfloat b \x3d u_image1Const;\nfloat c \x3d u_image2Const;\nvec3 abc \x3d u_imageSwap * vec3(a, b, c);\na \x3d abc.s;\nb \x3d abc.t;\nc \x3d abc.p;\n#elif defined(ONE_CONSTANT)\nvec4 pv1 \x3d texture2D(u_image1, v_texcoord);\nfloat b \x3d pv1.r;\nfloat c \x3d u_image1Const;\nvec3 abc \x3d u_imageSwap * vec3(a, b, c);\na \x3d abc.s;\nb \x3d abc.t;\nc \x3d abc.p;\n#else\nvec4 pv1 \x3d texture2D(u_image1, v_texcoord);\nvec4 pv2 \x3d texture2D(u_image2, v_texcoord);\nfloat b \x3d pv1.r;\nfloat c \x3d pv2.r;\n#endif\n#endif\nfloat result \x3d a;\nfloat alpha \x3d pv0.a;\n#ifdef PLUS\nresult \x3d a + b;\n#elif defined(MINUS)\nresult \x3d a - b;\n#elif defined(TIMES)\nresult \x3d a * b;\n#elif defined(DIVIDE)\nresult \x3d a * invertValue(b);\nalpha *\x3d float(abs(sign(b)));\n#elif defined(FLOATDIVIDE)\nresult \x3d a * invertValue(b);\nalpha *\x3d float(abs(sign(b)));\n#elif defined(FLOORDIVIDE)\nresult \x3d floor(a * invertValue(b));\nalpha *\x3d float(abs(sign(b)));\n#elif defined(SQUARE)\nresult \x3d a * a;\n#elif defined(SQRT)\nresult \x3d sqrt(a);\n#elif defined(POWER)\nresult \x3d pow(a, b);\n#elif defined(LN)\nresult \x3d a \x3c\x3d 0.0 ? 0.0: log(a);\nalpha *\x3d float(a \x3e 0.0);\n#elif defined(LOG_1_0)\nresult \x3d a \x3c\x3d 0.0 ? 0.0: log2(a) * invertValue(log2(10.0));\nalpha *\x3d float(a \x3e 0.0);\n#elif defined(LOG_2)\nresult \x3d a \x3c\x3d 0.0 ? 0.0: log2(a);\nalpha *\x3d float(a \x3e 0.0);\n#elif defined(EXP)\nresult \x3d exp(a);\n#elif defined(EXP_1_0)\nresult \x3d pow(10.0, a);\n#elif defined(EXP_2)\nresult \x3d pow(2.0, a);\n#elif defined(ROUNDDOWN)\nresult \x3d floor(a);\n#elif defined(ROUNDUP)\nresult \x3d ceil(a);\n#elif defined(INT)\nresult \x3d float(sign(a)) * floor(abs(a));\n#elif defined(MOD)\nresult \x3d mod(a, b);\n#elif defined(NEGATE)\nresult \x3d -a;\n#elif defined(ABS)\nresult \x3d abs(a);\n#elif defined(ACOS)\nresult \x3d abs(a) \x3e 1.0 ? 0.0: acos(a);\nalpha *\x3d step(abs(a), 1.00001);\n#elif defined(ACOSH)\nresult \x3d acosh(a);\n#elif defined(POLYFILLACOSH)\nresult \x3d log(a + sqrt(a * a - 1.0));\n#elif defined(ASIN)\nresult \x3d abs(a) \x3e 1.0 ? 0.0: asin(a);\nalpha *\x3d step(abs(a), 1.00001);\n#elif defined(ASINH)\nresult \x3d asinh(a);\n#elif defined(POLYFILLASINH)\nresult \x3d log(a + sqrt(a * a + 1.0));\n#elif defined(ATAN)\nresult \x3d atan(a);\n#elif defined(ATANH)\nresult \x3d abs(a) \x3e 1.0 ? 0.0: atanh(a);\nalpha *\x3d step(abs(a), 1.0);\n#elif defined(POLYFILLATANH)\nresult \x3d a \x3d\x3d 1.0 ? 0.0 : 0.5 * log((1.0 + a)/(1.0 -a));\n#elif defined(ATAN_2)\nresult \x3d atan(a, b);\n#elif defined(COS)\nresult \x3d cos(a);\n#elif defined(COSH)\nresult \x3d cosh(a);\n#elif defined(POLYFILLCOSH)\nfloat halfexp \x3d exp(a) / 2.0;\nresult \x3d halfexp + 1.0 / halfexp;\n#elif defined(SIN)\nresult \x3d sin(a);\n#elif defined(SINH)\nresult \x3d sinh(a);\n#elif defined(POLYFILLSINH)\nfloat halfexp \x3d exp(a) / 2.0;\nresult \x3d halfexp - 1.0 / halfexp;\n#elif defined(TAN)\nresult \x3d tan(a);\n#elif defined(TANH)\nresult \x3d tanh(a);\n#elif defined(POLYFILLTANH)\nfloat expx \x3d exp(a);\nresult \x3d (expx - 1.0 / expx) / (expx + 1.0 / expx);\n#elif defined(BITWISEAND)\nresult \x3d a \x26 b;\n#elif defined(BITWISEOR)\nresult \x3d a | b;\n#elif defined(BITWISELEFTSHIFT)\nresult \x3d a \x3c\x3c b;\n#elif defined(BITWISERIGHTSHIFT)\nresult \x3d a \x3e\x3e b;\n#elif defined(BITWISENOT)\nresult \x3d ~a;\n#elif defined(BITWISEXOR)\nresult \x3d a ^ b;\n#elif defined(BOOLEANAND)\nresult \x3d float((a !\x3d 0.0) \x26\x26 (b !\x3d 0.0));\n#elif defined(BOOLEANNOT)\nresult \x3d float(a \x3d\x3d 0.0);\n#elif defined(BOOLEANOR)\nresult \x3d float((a !\x3d 0.0) || (b !\x3d 0.0));\n#elif defined(BOOLEANXOR)\nresult \x3d float((a !\x3d 0.0) ^^ (b !\x3d 0.0));\n#elif defined(GREATERTHAN)\nresult \x3d float(a \x3e b);\n#elif defined(GREATERTHANEQUAL)\nresult \x3d float(a \x3e\x3d b);\n#elif defined(LESSTHAN)\nresult \x3d float(a \x3c b);\n#elif defined(LESSTHANEQUAL)\nresult \x3d float(a \x3c\x3d b);\n#elif defined(EQUALTO)\nresult \x3d float(a \x3d\x3d b);\n#elif defined(NOTEQUAL)\nresult \x3d float(a !\x3d b);\n#elif defined(ISNULL)\nresult \x3d float(alpha \x3d\x3d 0.0);\nalpha \x3d 1.0;\n#elif defined(SETNULL)\nfloat maskValue \x3d float(a \x3d\x3d 0.0);\nresult \x3d maskValue * b;\nalpha *\x3d maskValue;\n#elif defined(CONDITIONAL)\nfloat weight \x3d float(abs(sign(a)));\nresult \x3d weight * b + (1.0 - weight) * c;\n#endif\nbool isInvalid \x3d result \x3c u_domainRange.s || result \x3e u_domainRange.t;\nresult \x3d isInvalid ? 0.0 : result;\nalpha *\x3d float(!isInvalid);\n#ifdef ROUND_OUTPUT\nresult \x3d floor(result + 0.5);\n#endif\ngl_FragColor \x3d vec4(result, result, result, alpha);\n}"},
mask:{"mask.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\n#define LEN_INCLUDED_RANGES 6\n#define LEN_NODATA_VALUES 6\nuniform highp float u_includedRanges[6];\nuniform highp float u_noDataValues[6];\nfloat maskFactor(float bandValue, float fromValue, float to) {\nfloat factor \x3d 1.0;\nfor (int i \x3d 0; i \x3c LEN_NODATA_VALUES; i++) {\nfactor *\x3d float(u_noDataValues[i] !\x3d bandValue);\n}\nfactor *\x3d step(fromValue, bandValue) * step(bandValue, to);\nreturn factor;\n}\nvoid main() {\nvec4 pv \x3d texture2D(u_image, v_texcoord);\nfloat redFactor \x3d maskFactor(pv.r, u_includedRanges[0], u_includedRanges[1]);\n#ifdef MULTI_BAND\nfloat greenFactor \x3d maskFactor(pv.g, u_includedRanges[2], u_includedRanges[3]);\nfloat blueFactor \x3d maskFactor(pv.b, u_includedRanges[4], u_includedRanges[5]);\nfloat maskFactor \x3d redFactor * greenFactor * blueFactor;\ngl_FragColor \x3d pv * maskFactor;\n#else\ngl_FragColor \x3d pv * redFactor;\n#endif\n}"},
ndvi:{"ndvi.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\nuniform mediump mat3 u_bandIndexMat3;\n#include \x3craster/common/inverse.glsl\x3e\nvoid main() {\nvec4 pv \x3d texture2D(u_image, v_texcoord);\nvec3 pv2 \x3d u_bandIndexMat3 * pv.rgb;\nfloat nir \x3d pv2.r;\nfloat red \x3d pv2.g;\nfloat index \x3d (nir - red) * invertValue(nir + red);\n#ifdef SCALED\nindex \x3d floor((index + 1.0) * 100.0 + 0.5);\n#endif\ngl_FragColor \x3d vec4(index, index, index, pv.a);\n}"},
remap:{"remap.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\n#define LEN_REMAP_RANGES 18\n#define LEN_NODATA_RANGES 12\nuniform highp float u_rangeMaps[18];\nuniform highp float u_noDataRanges[12];\nuniform highp float u_unmatchMask;\nuniform vec2 u_clampRange;\nvoid main() {\nvec4 pv \x3d texture2D(u_image, v_texcoord);\nfloat factor \x3d 1.0;\nfloat bandValue \x3d pv.r;\nfor (int i \x3d 0; i \x3c LEN_NODATA_RANGES; i+\x3d2) {\nfloat inside \x3d 1.0 - step(u_noDataRanges[i], bandValue) * step(bandValue, u_noDataRanges[i+1]);\nfactor *\x3d inside;\n}\nfloat mapValue \x3d 0.0;\nfloat includeMask \x3d 0.0;\nfor (int i \x3d 0; i \x3c LEN_REMAP_RANGES; i+\x3d3) {\nfloat stepMask \x3d step(u_rangeMaps[i], bandValue) * step(bandValue, u_rangeMaps[i+1]);\nincludeMask \x3d (1.0 - stepMask) * includeMask + stepMask;\nmapValue \x3d (1.0 - stepMask) * mapValue + stepMask * u_rangeMaps[i+2];\n}\nbandValue \x3d factor * (mapValue + (1.0 - includeMask) * u_unmatchMask * pv.r);\nfloat bandMask \x3d factor * max(u_unmatchMask, includeMask);\nbandValue \x3d clamp(bandValue, u_clampRange.s, u_clampRange.t);\ngl_FragColor \x3d vec4(bandValue, bandValue, bandValue, bandMask * pv.a);\n}"},
slope:{"slope.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\nuniform vec2 u_cellSize;\nuniform float u_zFactor;\nuniform vec2 u_srcImageSize;\nuniform float u_pixelSizePower;\nuniform float u_pixelSizeFactor;\n#include \x3craster/common/mirror.glsl\x3e\nvoid main() {\nvec2 axy \x3d vec2(-1.0, -1.0);\nvec2 bxy \x3d vec2(0.0, -1.0);\nvec2 cxy \x3d vec2(1.0, -1.0);\nvec2 dxy \x3d vec2(-1.0, 0.0);\nvec2 fxy \x3d vec2(1.0, 0.0);\nvec2 gxy \x3d vec2(-1.0, 1.0);\nvec2 hxy \x3d vec2(0.0, 1.0);\nvec2 ixy \x3d vec2(1.0, 1.0);\nvec2 onePixel \x3d 1.0 / u_srcImageSize;\nvec4 va \x3d texture2D(u_image, mirror(v_texcoord + onePixel * axy));\nvec4 vb \x3d texture2D(u_image, mirror(v_texcoord + onePixel * bxy));\nvec4 vc \x3d texture2D(u_image, mirror(v_texcoord + onePixel * cxy));\nvec4 vd \x3d texture2D(u_image, mirror(v_texcoord + onePixel * dxy));\nvec4 ve \x3d texture2D(u_image, mirror(v_texcoord + onePixel * vec2(0, 0)));\nvec4 vf \x3d texture2D(u_image, mirror(v_texcoord + onePixel * fxy));\nvec4 vg \x3d texture2D(u_image, mirror(v_texcoord + onePixel * gxy));\nvec4 vh \x3d texture2D(u_image, mirror(v_texcoord + onePixel * hxy));\nvec4 vi \x3d texture2D(u_image, mirror(v_texcoord + onePixel * ixy));\nfloat xf \x3d (u_zFactor + pow(u_cellSize[0], u_pixelSizePower) * u_pixelSizeFactor) / (8.0 * u_cellSize[0]);\nfloat yf \x3d (u_zFactor + pow(u_cellSize[1], u_pixelSizePower) * u_pixelSizeFactor) / (8.0 * u_cellSize[1]);\nfloat dzx \x3d (vc + 2.0 * vf + vi - va - 2.0 * vd - vg).r * xf;\nfloat dzy \x3d -(vg + 2.0 * vh + vi - va - 2.0 * vb - vc).r * yf;\nfloat alpha \x3d va.a * vb.a * vc.a * vd.a * ve.a * vf.a * vg.a * vh.a * vi.a;\nfloat rise2run \x3d sqrt(dzx * dzx + dzy * dzy);\n#ifdef PERCENT_RISE\nfloat percentRise \x3d rise2run * 100.0;\ngl_FragColor \x3d vec4(percentRise, percentRise, percentRise, alpha);\n#else\nfloat degree \x3d atan(rise2run) * 57.2957795;\ngl_FragColor \x3d vec4(degree, degree, degree, alpha);\n#endif\n}"},
stretch:{"stretch.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying highp vec2 v_texcoord;\nuniform float u_minCutOff[3];\nuniform float u_maxCutOff[3];\nuniform float u_minOutput;\nuniform float u_maxOutput;\nuniform float u_factor[3];\nuniform float u_gamma[3];\nuniform float u_gammaCorrection[3];\nfloat stretchOneValue(float val, float minCutOff, float maxCutOff, float minOutput, float maxOutput, float factor, float gamma, float gammaCorrection) {\nval \x3d clamp(val, minCutOff, maxCutOff);\nfloat stretchedVal;\n#ifdef USE_GAMMA\nfloat tempf \x3d 1.0;\nfloat outRange \x3d maxOutput - minOutput;\nfloat relativeVal \x3d (val - minCutOff) / (maxCutOff - minCutOff);\ntempf -\x3d step(1.0, gamma) * sign(gamma - 1.0) * pow(1.0 / outRange, relativeVal * gammaCorrection);\nstretchedVal \x3d tempf * outRange * pow(relativeVal, 1.0 / gamma) + minOutput;\nstretchedVal \x3d clamp(stretchedVal, minOutput, maxOutput);\n#else\nstretchedVal \x3d minOutput + (val - minCutOff) * factor;\n#endif\n#ifdef ROUND_OUTPUT\nstretchedVal \x3d floor(stretchedVal + 0.5);\n#endif\nreturn stretchedVal;\n}\nvoid main() {\nvec4 currentPixel \x3d texture2D(u_image, v_texcoord);\nfloat redVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_gamma[0], u_gammaCorrection[0]);\n#ifdef MULTI_BAND\nfloat greenVal \x3d stretchOneValue(currentPixel.g, u_minCutOff[1], u_maxCutOff[1], u_minOutput, u_maxOutput, u_factor[1], u_gamma[1], u_gammaCorrection[1]);\nfloat blueVal \x3d stretchOneValue(currentPixel.b, u_minCutOff[2], u_maxCutOff[2], u_minOutput, u_maxOutput, u_factor[2], u_gamma[2], u_gammaCorrection[2]);\ngl_FragColor \x3d vec4(redVal, greenVal, blueVal, currentPixel.a);\n#else\ngl_FragColor \x3d vec4(redVal, redVal, redVal, currentPixel.a);\n#endif\n}"},
vs:{"vs.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"}},scalar:{"scalar.frag":"precision mediump float;\nuniform lowp float u_opacity;\nvarying vec2 v_pos;\nconst vec4 outlineColor \x3d vec4(0.2, 0.2, 0.2, 1.0);\nconst float outlineSize \x3d 0.02;\nconst float innerRadius \x3d 0.25;\nconst float outerRadius \x3d 0.42;\nconst float innerSquareLength \x3d 0.15;\nvoid main() {\nmediump float dist \x3d length(v_pos);\nmediump float fillalpha1 \x3d smoothstep(outerRadius, outerRadius + outlineSize, dist);\nfillalpha1 *\x3d (1.0-smoothstep(outerRadius + outlineSize, outerRadius + 0.1 + outlineSize, dist));\n#ifdef INNER_CIRCLE\nmediump float fillalpha2 \x3d smoothstep(innerRadius, innerRadius + outlineSize, dist);\nfillalpha2 *\x3d (1.0-smoothstep(innerRadius + outlineSize, innerRadius + 0.1 + outlineSize, dist));\n#else\nmediump float fillalpha2 \x3d (abs(v_pos.x) \x3c innerSquareLength ? 1.0 : 0.0) * (abs(v_pos.y) \x3c innerSquareLength ? 1.0 : 0.0);\n#endif\ngl_FragColor \x3d (fillalpha2 + fillalpha1) * outlineColor * u_opacity;\n}",
"scalar.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_vv;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform vec2 u_symbolSize;\nuniform vec2 u_symbolPercentRange;\nuniform vec2 u_dataRange;\nvarying vec2 v_pos;\nvoid main()\n{\n#ifdef DATA_RANGE\nfloat valuePercentage \x3d clamp((a_vv.y - u_dataRange.x) / (u_dataRange.y - u_dataRange.x), 0.0, 1.0);\nfloat sizeRatio \x3d u_symbolPercentRange.x + valuePercentage * (u_symbolPercentRange.y - u_symbolPercentRange.x);\nfloat sizePercentage \x3d clamp(sizeRatio, u_symbolPercentRange.x, u_symbolPercentRange.y);\n#else\nfloat sizePercentage \x3d (u_symbolPercentRange.x + u_symbolPercentRange.y) / 2.0;\n#endif\nvec2 size \x3d u_symbolSize * sizePercentage;\nvec2 pos \x3d a_pos + a_offset * size;\nv_pos \x3d a_offset;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(pos * u_coordScale, 1.0), 1.0);\n}"},
stretch:{"stretch.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nuniform float u_minCutOff[3];\nuniform float u_maxCutOff[3];\nuniform float u_minOutput;\nuniform float u_maxOutput;\nuniform float u_factor[3];\nuniform bool u_useGamma;\nuniform float u_gamma[3];\nuniform float u_gammaCorrection[3];\n#include \x3craster/lut/colorize.glsl\x3e\nfloat stretchOneValue(float val, float minCutOff, float maxCutOff, float minOutput, float maxOutput, float factor, bool useGamma, float gamma, float gammaCorrection) {\nif (val \x3e\x3d maxCutOff) {\nreturn maxOutput;\n} else if (val \x3c\x3d minCutOff) {\nreturn minOutput;\n}\nfloat stretchedVal;\nif (useGamma) {\nfloat tempf \x3d 1.0;\nfloat outRange \x3d maxOutput - minOutput;\nfloat relativeVal \x3d (val - minCutOff) / (maxCutOff - minCutOff);\nif (gamma \x3e 1.0) {\ntempf -\x3d pow(1.0 / outRange, relativeVal * gammaCorrection);\n}\nstretchedVal \x3d (tempf * outRange * pow(relativeVal, 1.0 / gamma) + minOutput) / 255.0;\n} else {\nstretchedVal \x3d minOutput + (val - minCutOff) * factor;\n}\nreturn stretchedVal;\n}\nvoid main() {\nvec2 pixelLocation \x3d getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel \x3d getPixel(pixelLocation);\n#ifdef NOOP\ngl_FragColor \x3d vec4(currentPixel.rgb, 1.0) * currentPixel.a * u_opacity;\nreturn;\n#endif\nif (u_bandCount \x3d\x3d 1) {\nfloat grayVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\n#ifdef APPLY_COLORMAP\nvec4 result \x3d colorize(vec4(grayVal, grayVal, grayVal, 1.0), u_useGamma ? 255.0 : 1.0);\ngl_FragColor \x3d vec4(result.xyz, 1.0) * result.a * currentPixel.a * u_opacity;\n#else\ngl_FragColor \x3d vec4(grayVal, grayVal, grayVal, 1.0) * currentPixel.a * u_opacity;\n#endif\n} else {\nfloat redVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\nfloat greenVal \x3d stretchOneValue(currentPixel.g, u_minCutOff[1], u_maxCutOff[1], u_minOutput, u_maxOutput, u_factor[1], u_useGamma, u_gamma[1], u_gammaCorrection[1]);\nfloat blueVal \x3d stretchOneValue(currentPixel.b, u_minCutOff[2], u_maxCutOff[2], u_minOutput, u_maxOutput, u_factor[2], u_useGamma, u_gamma[2], u_gammaCorrection[2]);\ngl_FragColor \x3d vec4(redVal, greenVal, blueVal, 1.0) * currentPixel.a * u_opacity;\n}\n}"}},
stencil:{"stencil.frag":"void main() {\ngl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\n}","stencil.vert":"attribute vec2 a_pos;\nuniform mat3 u_worldExtent;\nvoid main() {\ngl_Position \x3d vec4(u_worldExtent * vec3(a_pos, 1.0), 1.0);\n}"},tileInfo:{"tileInfo.frag":"uniform mediump sampler2D u_texture;\nvarying mediump vec2 v_tex;\nvoid main(void) {\nlowp vec4 color \x3d texture2D(u_texture, v_tex);\ngl_FragColor \x3d 0.75 * color;\n}","tileInfo.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_coord_ratio;\nuniform mediump vec2 u_delta;\nuniform mediump vec2 u_dimensions;\nvarying mediump vec2 v_tex;\nvoid main() {\nmediump vec2 offset \x3d u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\nvec3 v_pos \x3d u_dvsMat3 * vec3(offset, 1.0);\ngl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\nv_tex \x3d a_pos;\n}"},
util:{"atan2.glsl":"float atan2(in float y, in float x) {\nfloat t0, t1, t2, t3, t4;\nt3 \x3d abs(x);\nt1 \x3d abs(y);\nt0 \x3d max(t3, t1);\nt1 \x3d min(t3, t1);\nt3 \x3d 1.0 / t0;\nt3 \x3d t1 * t3;\nt4 \x3d t3 * t3;\nt0 \x3d         - 0.013480470;\nt0 \x3d t0 * t4 + 0.057477314;\nt0 \x3d t0 * t4 - 0.121239071;\nt0 \x3d t0 * t4 + 0.195635925;\nt0 \x3d t0 * t4 - 0.332994597;\nt0 \x3d t0 * t4 + 0.999995630;\nt3 \x3d t0 * t3;\nt3 \x3d (abs(y) \x3e abs(x)) ? 1.570796327 - t3 : t3;\nt3 \x3d x \x3c 0.0 ?  3.141592654 - t3 : t3;\nt3 \x3d y \x3c 0.0 ? -t3 : t3;\nreturn t3;\n}",
"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n255.0 / (256.0),\n255.0 / (256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n);\nfloat rgba2float(vec4 rgba) {\nreturn dot(rgba, rgba2float_factors);\n}"}}})},"esri/views/2d/engine/webgl/brushes/BrushOverlay":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ../Utils ./WGLBrush ../../../../webgl/enums".split(" "),function(m,p,D,B,u,t){return function(h){function l(){var b=
h.apply(this,arguments)||this;b._desc={vsPath:"overlay/overlay",fsPath:"overlay/overlay",attributes:new Map([["a_pos",0],["a_uv",1]])};return b}m._inheritsLoose(l,h);var e=l.prototype;e.dispose=function(){};e.prepareState=function({context:b}){b.setBlendingEnabled(!0);b.setColorMask(!0,!0,!0,!0);b.setBlendFunctionSeparate(t.BlendFactor.ONE,t.BlendFactor.ONE_MINUS_SRC_ALPHA,t.BlendFactor.ONE,t.BlendFactor.ONE_MINUS_SRC_ALPHA);b.setStencilWriteMask(0);b.setStencilTestEnabled(!0);b.setStencilFunction(t.CompareFunction.GREATER,
255,255)};e.draw=function(b,d){const {context:a,painter:c,requestRender:f,allowDelayedRender:g}=b;if(d.isReady){var {computedOpacity:n,dvsMat3:k,isWrapAround:x,perspectiveTransform:r,texture:v}=d;b.timeline.begin(this.name);var q=c.materialManager.getProgram(this._desc);if(g&&p.isSome(f)&&!q.compiled)f();else{var y=B.createProgramDescriptor("overlay",{geometry:[{location:0,name:"a_pos",count:2,type:t.DataType.FLOAT}],tex:[{location:1,name:"a_uv",count:2,type:t.DataType.UNSIGNED_SHORT}]});if(d=d.getVAO(a,
y.bufferLayouts,y.attributes))a.bindVAO(d),a.useProgram(q),a.bindTexture(v,D.TEXTURE_BINDING_BITMAP),q.setUniformMatrix3fv("u_dvsMat3",k),q.setUniform1i("u_texture",D.TEXTURE_BINDING_BITMAP),q.setUniform1f("u_opacity",n),q.setUniform2fv("u_perspective",r),a.drawArrays(t.PrimitiveType.TRIANGLE_STRIP,0,x?10:4),a.bindVAO(),b.timeline.end(this.name)}}};return l}(u)})},"esri/views/2d/engine/webgl/brushes/WGLBrushDotDensity":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../core/RandomLCG ../definitions ../enums ./WGLGeometryBrushFill ../techniques/utils ../../../../webgl/BufferObject ../../../../webgl/enums ../../../../webgl/FramebufferObject ../../../../webgl/Renderbuffer ../../../../webgl/Texture ../../../../webgl/VertexArrayObject".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d,a,c){return function(f){function g(){var k=f.apply(this,arguments)||this;k._dotTextureSize=0;k._dotTextures=null;k._dotSamplers=new Int32Array([B.TEXTURE_BINDING_RENDERER_0,B.TEXTURE_BINDING_RENDERER_1]);k._dotVAO=null;k._dotDesc={vsPath:"dot/dot",fsPath:"dot/dot",attributes:new Map([["a_pos",0]])};return k}m._inheritsLoose(g,f);var n=g.prototype;n.dispose=function(){f.prototype.dispose.call(this);this._disposeTextures();this._dotFBO=p.disposeMaybe(this._dotFBO);this._dotVAO=
p.disposeMaybe(this._dotVAO)};n.getGeometryType=function(){return u.WGLGeometryType.FILL};n.supportsSymbology=function(k){return k===u.WGLSymbologyType.DOT_DENSITY};n._drawFills=function(k,x,r,v,q,y){const {passOptions:A}=k;p.isSome(A)&&"hittest"===A.type?f.prototype._drawFills.call(this,k,x,r,v,q,y):(r=this._drawDotLocations(k,x,r,q,y),this._drawDotDensity(k,x,r))};n._drawDotDensity=function(k,x,r){const {context:v,painter:q,rendererInfo:y,requestRender:A,allowDelayedRender:w}=k,z=q.materialManager.getProgram(this._dotDesc);
if(w&&p.isSome(A)&&!z.compiled)A();else{var {rendererSchema:C}=y;h.assertRendererSchema(C,"dot-density");var E=this._createDotDensityMesh(v,this._dotDesc.attributes,{geometry:[{name:"a_pos",count:2,type:e.DataType.SHORT,divisor:0,normalized:!1,offset:0,stride:4}]});v.setStencilTestEnabled(!0);v.useProgram(z);z.setUniform1f("u_tileZoomFactor",1);z.setUniform1i("u_texture",this._dotSamplers[0]);z.setUniform1f("u_dotSize",Math.max(C.dotSize,1));z.setUniform1f("u_pixelRatio",window.devicePixelRatio);
this._setSharedUniforms(z,k,x);v.bindTexture(r,this._dotSamplers[0]);v.bindVAO(E);v.drawArrays(e.PrimitiveType.POINTS,0,262144)}};n._drawDotLocations=function(k,x,r,v,q){const {context:y,rendererInfo:A,requiredLevel:w}=k,z=y.getViewport();var {rendererSchema:C}=A;h.assertRendererSchema(C,"dot-density");const {dotScale:E,colors:F,activeDots:G,backgroundColor:H,dotValue:L}=C;y.setViewport(0,0,512,512);C=y.getBoundFramebufferObject();const K=this._createFBO(y);y.bindFramebuffer(K);y.setClearColor(0,
0,0,0);y.clear(y.gl.COLOR_BUFFER_BIT|y.gl.STENCIL_BUFFER_BIT);y.setStencilTestEnabled(!1);x=1/2**(w-x.key.level);const M=B.TILE_SIZE,U=M*window.devicePixelRatio*M*window.devicePixelRatio,T=1/x*(1/x);k=E?k.state.scale/E:1;r.setUniform1f("u_tileZoomFactor",x);r.setUniform1f("u_tileDotsOverArea",U/(B.TILE_SIZE*window.devicePixelRatio*B.TILE_SIZE*window.devicePixelRatio));r.setUniformMatrix4fv("u_dotColors",F);r.setUniform4fv("u_isActive",G);r.setUniform4fv("u_dotBackgroundColor",H);r.setUniform1f("u_dotValue",
Math.max(1,L*k*T));this._bindDotDensityTextures(y,r,A,M);y.drawElements(e.PrimitiveType.TRIANGLES,v,e.DataType.UNSIGNED_INT,q);y.setViewport(z.x,z.y,z.width,z.height);y.bindFramebuffer(C);return K.colorTexture};n._createFBO=function(k){if(p.isNone(this._dotFBO)){const x={target:e.TextureType.TEXTURE_2D,pixelFormat:e.PixelFormat.RGBA,dataType:e.PixelType.UNSIGNED_BYTE,samplingMode:e.TextureSamplingMode.NEAREST,wrapMode:e.TextureWrapMode.CLAMP_TO_EDGE,width:512,height:512},r={colorTarget:e.TargetType.TEXTURE,
depthStencilTarget:e.DepthStencilTargetType.DEPTH_STENCIL_RENDER_BUFFER},v=new d.Renderbuffer(k,{width:512,height:512,internalFormat:e.RenderbufferFormat.DEPTH_STENCIL});this._dotFBO=new b.FramebufferObject(k,r,x,v)}return this._dotFBO};n._disposeTextures=function(){if(this._dotTextures){for(let k=0;k<this._dotTextures.length;k++)this._dotTextures[k].dispose();this._dotTextures=null}};n._bindDotDensityTextures=function(k,x,r,v){({rendererSchema:r}=r);h.assertRendererSchema(r,"dot-density");v=this._createDotDensityTextures(k,
v,r.seed);x.setUniform1iv("u_dotTextures",this._dotSamplers);for(x=0;x<v.length;x++)k.bindTexture(v[x],this._dotSamplers[x])};n._createDotDensityMesh=function(k,x,r){if(p.isNone(this._dotVAO)){var v=new Int16Array(524288);for(let q=0;512>q;q++)for(let y=0;512>y;y++)v[2*(y+512*q)]=y,v[2*(y+512*q)+1]=q;v=l.BufferObject.createVertex(k,e.Usage.STATIC_DRAW,v);this._dotVAO=new c.VertexArrayObject(k,x,r,{geometry:v},null)}return this._dotVAO};n._createDotDensityTextures=function(k,x,r){if(this._dotTextureSize!==
x||this._seed!==r)this._disposeTextures(),this._dotTextureSize=x,this._seed=r;null===this._dotTextures&&(r=new D(r),this._dotTextures=[this._allocDotDensityTexture(k,x,r),this._allocDotDensityTexture(k,x,r)]);return this._dotTextures};n._allocDotDensityTexture=function(k,x,r){const v=new Float32Array(x*x*4);for(let q=0;q<v.length;q++)v[q]=r.getFloat();return new a.Texture(k,{wrapMode:e.TextureWrapMode.REPEAT,pixelFormat:e.PixelFormat.RGBA,dataType:e.PixelType.FLOAT,samplingMode:e.TextureSamplingMode.NEAREST,
width:x,height:x},v)};return g}(t)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushFill":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey ../techniques/utils ../../../../webgl/enums".split(" "),function(m,p,D,B,u,t,h,l){return function(e){function b(){return e.apply(this,arguments)||this}m._inheritsLoose(b,e);var d=b.prototype;d.dispose=function(){};d.getGeometryType=function(){return D.WGLGeometryType.FILL};
d.supportsSymbology=function(a){return a!==D.WGLSymbologyType.DOT_DENSITY};d.drawGeometry=function(a,c,f,g){const {context:n,painter:k,rendererInfo:x,requiredLevel:r,passOptions:v,requestRender:q,allowDelayedRender:y}=a;var A=t.FillMaterialKey.load(f.materialKey),w=h.getTechniqueFromMaterialKey(A.data);const z=p.isSome(v)&&"hittest"===v.type;var C=k.materialManager,E=p.unwrapOr;w=w.programSpec;const F={geometry:[{location:0,name:"a_pos",count:2,type:l.DataType.SHORT},{location:1,name:"a_id",count:3,
type:l.DataType.UNSIGNED_BYTE},{location:2,name:"a_bitset",count:1,type:l.DataType.UNSIGNED_BYTE},{location:3,name:"a_color",count:4,type:l.DataType.UNSIGNED_BYTE,normalized:!0},{location:4,name:"a_aux1",count:4,type:l.DataType.UNSIGNED_SHORT},{location:5,name:"a_aux2",count:4,type:l.DataType.SHORT},{location:6,name:"a_aux3",count:4,type:l.DataType.UNSIGNED_BYTE},{location:7,name:"a_zoomRange",count:2,type:l.DataType.UNSIGNED_SHORT}]};switch(A.symbologyType){case D.WGLSymbologyType.SIMPLE:case D.WGLSymbologyType.OUTLINE_FILL_SIMPLE:F.geometry.splice(7,
1),F.geometry.splice(4,1)}const {shader:G,vertexLayout:H,hittestAttributes:L}=E.call(p,w,{shader:"materials/fill",vertexLayout:F});E=l.PrimitiveType.TRIANGLES;w=B.createProgramDescriptor(A.data,H);z&&(w=this._getTriangleDesc(f.materialKey,w,L),E=l.PrimitiveType.POINTS);const {attributes:K,bufferLayouts:M}=w;g=C.getMaterialProgram(a,A,G,K,g);y&&p.isSome(q)&&!g.compiled?q():(n.useProgram(g),this._setSharedUniforms(g,a,c),g.setUniform2f("u_tileOffset",512*c.key.col,512*c.key.row),A.textureBinding&&(k.textureManager.bindTextures(n,
g,A),g.setUniform1f("u_zoomFactor",1/2**(r-c.key.level))),C=1/a.pixelRatio,g.setUniform1f("u_blur",C),g.setUniform1f("u_antialiasing",C),this._setSizeVVUniforms(A,g,x,c),this._setColorAndOpacityVVUniforms(A,g,x),A=f.target.getVAO(n,M,K,z),C=f.indexCount,f=f.indexFrom*Uint32Array.BYTES_PER_ELEMENT,z&&(C/=3,f/=3),n.bindVAO(A),this._drawFills(a,c,g,E,C,f))};d._drawFills=function(a,c,f,g,n,k){a.context.drawElements(g,n,l.DataType.UNSIGNED_INT,k)};return b}(u)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrush":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ./WGLBrush ../materialKey/MaterialKey ../../../../webgl/enums".split(" "),
function(m,p,D,B,u,t){return function(h){function l(){var b=h.apply(this,arguments)||this;b._computeDesc=new Map;return b}m._inheritsLoose(l,h);var e=l.prototype;e.prepareState=function({context:b},d){d&&d.includes("hittest")?b.setBlendFunctionSeparate(t.BlendFactor.ONE,t.BlendFactor.ONE,t.BlendFactor.ONE,t.BlendFactor.ONE):b.setBlendFunctionSeparate(t.BlendFactor.ONE,t.BlendFactor.ONE_MINUS_SRC_ALPHA,t.BlendFactor.ONE,t.BlendFactor.ONE_MINUS_SRC_ALPHA);b.setBlendingEnabled(!0);b.setColorMask(!0,
!0,!0,!0);b.setStencilWriteMask(0);b.setStencilTestEnabled(!0)};e.draw=function(b,d,a){var c=this.getGeometryType();d.commit(b);c=d.getGeometry(c);p.isNone(c)||(b.timeline.begin(this.name),b.attributeView.bindTextures(b.context),b.context.setStencilFunction(t.CompareFunction.EQUAL,d.stencilRef,255),c.forEachCommand(f=>{const g=u.MaterialKeyBase.load(f.materialKey).symbologyType;this.supportsSymbology(g)&&this.drawGeometry(b,d,f,a)}))};e._setSharedUniforms=function(b,d,a){const {displayLevel:c,pixelRatio:f,
state:g,passOptions:n}=d;p.isSome(n)&&"hittest"===n.type&&(b.setUniform2fv("u_hittestPos",n.position),b.setUniform1f("u_hittestDist",n.distance));b.setUniform1f("u_pixelRatio",f);b.setUniformMatrix3fv("u_tileMat3",a.transforms.tileMat3);b.setUniformMatrix3fv("u_viewMat3",g.viewMat3);b.setUniformMatrix3fv("u_dvsMat3",a.transforms.dvs);b.setUniformMatrix3fv("u_displayViewMat3",g.displayViewMat3);b.setUniform1f("u_currentZoom",Math.round(c*D.MIN_MAX_ZOOM_PRECISION_FACTOR));b.setUniform1i("u_attributeTextureSize",
d.attributeView.size);b.setUniform1i("u_attributeData0",D.TEXTURE_BINDING_ATTRIBUTE_DATA_0);b.setUniform1i("u_attributeData1",D.TEXTURE_BINDING_ATTRIBUTE_DATA_1);b.setUniform1i("u_attributeData2",D.TEXTURE_BINDING_ATTRIBUTE_DATA_2);b.setUniform1i("u_attributeData3",D.TEXTURE_BINDING_ATTRIBUTE_DATA_3);b.setUniform1i("u_attributeData4",D.TEXTURE_BINDING_ATTRIBUTE_DATA_4);b.setUniform1i("u_attributeData5",D.TEXTURE_BINDING_ATTRIBUTE_DATA_5)};e._setSizeVVUniforms=function(b,d,a,c){b.vvSizeMinMaxValue&&
d.setUniform4fv("u_vvSizeMinMaxValue",a.vvSizeMinMaxValue);b.vvSizeScaleStops&&d.setUniform1f("u_vvSizeScaleStopsValue",a.vvSizeScaleStopsValue);b.vvSizeFieldStops&&(c=a.getSizeVVFieldStops(c.key.level),null!=c&&(d.setUniform1fv("u_vvSizeFieldStopsValues",c.values),d.setUniform1fv("u_vvSizeFieldStopsSizes",c.sizes)));b.vvSizeUnitValue&&d.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",a.vvSizeUnitValueToPixelsRatio)};e._setColorAndOpacityVVUniforms=function(b,d,a){b.vvColor&&(d.setUniform1fv("u_vvColorValues",
a.vvColorValues),d.setUniform4fv("u_vvColors",a.vvColors));b.vvOpacity&&(d.setUniform1fv("u_vvOpacityValues",a.vvOpacityValues),d.setUniform1fv("u_vvOpacities",a.vvOpacities))};e._setRotationVVUniforms=function(b,d,a){b.vvRotation&&d.setUniform1f("u_vvRotationType","geographic"===a.vvMaterialParameters.vvRotationType?0:1)};e._getTriangleDesc=function(b,d,a=["a_pos"]){const c=d.bufferLayouts.geometry;a=a.map(n=>c.findIndex(k=>k.name===n));b=`${b}-${a.join("-")}`;var f=this._computeDesc.get(b);if(!f){f=
d.strides;const n=d.strides.geometry,k=new Map(d.attributes);var g=c.map(r=>({...r}));d=Math.max(...d.attributes.values());g={geometry:g};let x=0;for(const r of a)a=c[r],g.geometry.push({count:a.count,name:a.name+"1",divisor:a.divisor,normalized:a.normalized,offset:n+a.offset,stride:n,type:a.type}),g.geometry.push({count:a.count,name:a.name+"2",divisor:a.divisor,normalized:a.normalized,offset:2*n+a.offset,stride:n,type:a.type}),k.set(a.name+"1",d+ ++x),k.set(a.name+"2",d+ ++x);f={bufferLayouts:g,
attributes:k,strides:f};this._computeDesc.set(b,f)}return f};return l}(B)})},"esri/views/2d/engine/webgl/materialKey/MaterialKey":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/Error","../alignmentUtils","../enums"],function(m,p,D,B,u){function t(r){return r===u.WGLSymbologyType.SIMPLE||r===u.WGLSymbologyType.OUTLINE_FILL_SIMPLE}function h(r){return r===u.WGLSymbologyType.OUTLINE_FILL||r===u.WGLSymbologyType.OUTLINE_FILL_SIMPLE}const l=Object.keys(u.WGLSymbologyType).filter(r=>
"number"===typeof u.WGLSymbologyType[r]).reduce((r,v)=>({...r,[v]:u.WGLSymbologyType[v]}),{});let e=function(){function r(q){this._data=0;this._data=q}r.load=function(q){const y=this.shared;y.data=q;return y};var v=r.prototype;v.setBit=function(q,y){q=1<<q;this._data=y?this._data|q:this._data&~q};v.bit=function(q){return(this._data&1<<q)>>q};v.setBits=function(q,y,A){for(let w=y,z=0;w<A;w++,z++)this.setBit(w,0!==(q&1<<z))};v.bits=function(q,y){let A=0;for(let w=q,z=0;w<y;w++,z++)A|=this.bit(w)<<z;
return A};v.hasVV=function(){return!1};v.setVV=function(q,y){};v.getVariation=function(){return{mapAligned:this.mapAligned,pattern:this.pattern,sdf:this.sdf,symbologyType:{value:u.WGLSymbologyType[this.symbologyType],options:l,namespace:"SYMBOLOGY_TYPE"}}};v.getVariationHash=function(){return this._data&~(7&this.textureBinding)};p._createClass(r,[{key:"data",get:function(){return this._data},set:function(q){this._data=q??0}},{key:"geometryType",get:function(){return this.bits(8,11)},set:function(q){this.setBits(q,
8,11)}},{key:"mapAligned",get:function(){return!!this.bit(20)},set:function(q){this.setBit(20,q)}},{key:"sdf",get:function(){return!!this.bit(11)},set:function(q){this.setBit(11,q??!1)}},{key:"pattern",get:function(){return!!this.bit(12)},set:function(q){this.setBit(12,q)}},{key:"textureBinding",get:function(){return this.bits(0,8)},set:function(q){this.setBits(q,0,8)}},{key:"symbologyType",get:function(){return this.bits(21,26)},set:function(q){this.setBits(q,21,26)}},{key:"geometryTypeString",get:function(){switch(this.geometryType){case u.WGLGeometryType.FILL:return"fill";
case u.WGLGeometryType.MARKER:return"marker";case u.WGLGeometryType.LINE:return"line";case u.WGLGeometryType.TEXT:return"text";case u.WGLGeometryType.LABEL:return"label";default:throw new D(`Unable to handle unknown geometryType: ${this.geometryType}`);}}}]);return r}();e.shared=new e(0);const b=r=>function(v){function q(){return v.apply(this,arguments)||this}p._inheritsLoose(q,v);var y=q.prototype;y.hasVV=function(){return v.prototype.hasVV.call(this)||this.vvSizeMinMaxValue||this.vvSizeScaleStops||
this.vvSizeFieldStops||this.vvSizeUnitValue};y.setVV=function(A,w){v.prototype.setVV.call(this,A,w);{var z=this.geometryType;const C=u.WGLVVFlag.SIZE_FIELD_STOPS|u.WGLVVFlag.SIZE_MINMAX_VALUE|u.WGLVVFlag.SIZE_SCALE_STOPS|u.WGLVVFlag.SIZE_UNIT_VALUE,E=(A&(u.WGLVVTarget.FIELD_TARGETS_OUTLINE|u.WGLVVTarget.MINMAX_TARGETS_OUTLINE|u.WGLVVTarget.SCALE_TARGETS_OUTLINE|u.WGLVVTarget.UNIT_TARGETS_OUTLINE))>>>4;w=z===u.WGLGeometryType.LINE&&w.isOutline||z===u.WGLGeometryType.FILL&&h(w.symbologyType)?C&E:C&
~E}A&=w;this.vvSizeMinMaxValue=!!(A&u.WGLVVFlag.SIZE_MINMAX_VALUE);this.vvSizeFieldStops=!!(A&u.WGLVVFlag.SIZE_FIELD_STOPS);this.vvSizeUnitValue=!!(A&u.WGLVVFlag.SIZE_UNIT_VALUE);this.vvSizeScaleStops=!!(A&u.WGLVVFlag.SIZE_SCALE_STOPS)};p._createClass(q,[{key:"vvSizeMinMaxValue",get:function(){return 0!==this.bit(16)},set:function(A){this.setBit(16,A)}},{key:"vvSizeScaleStops",get:function(){return 0!==this.bit(17)},set:function(A){this.setBit(17,A)}},{key:"vvSizeFieldStops",get:function(){return 0!==
this.bit(18)},set:function(A){this.setBit(18,A)}},{key:"vvSizeUnitValue",get:function(){return 0!==this.bit(19)},set:function(A){this.setBit(19,A)}}]);return q}(r),d=r=>function(v){function q(){return v.apply(this,arguments)||this}p._inheritsLoose(q,v);var y=q.prototype;y.hasVV=function(){return v.prototype.hasVV.call(this)||this.vvRotation};y.setVV=function(A,w){v.prototype.setVV.call(this,A,w);this.vvRotation=!w.isOutline&&!!(A&u.WGLVVFlag.ROTATION)};p._createClass(q,[{key:"vvRotation",get:function(){return 0!==
this.bit(15)},set:function(A){this.setBit(15,A)}}]);return q}(r),a=r=>function(v){function q(){return v.apply(this,arguments)||this}p._inheritsLoose(q,v);var y=q.prototype;y.hasVV=function(){return v.prototype.hasVV.call(this)||this.vvColor};y.setVV=function(A,w){v.prototype.setVV.call(this,A,w);this.vvColor=!w.isOutline&&!!(A&u.WGLVVFlag.COLOR)};p._createClass(q,[{key:"vvColor",get:function(){return 0!==this.bit(13)},set:function(A){this.setBit(13,A)}}]);return q}(r),c=r=>function(v){function q(){return v.apply(this,
arguments)||this}p._inheritsLoose(q,v);var y=q.prototype;y.hasVV=function(){return v.prototype.hasVV.call(this)||this.vvOpacity};y.setVV=function(A,w){v.prototype.setVV.call(this,A,w);this.vvOpacity=!w.isOutline&&!!(A&u.WGLVVFlag.OPACITY)};p._createClass(q,[{key:"vvOpacity",get:function(){return 0!==this.bit(14)},set:function(A){this.setBit(14,A)}}]);return q}(r);let f=function(r){function v(){return r.apply(this,arguments)||this}p._inheritsLoose(v,r);v.load=function(q){const y=this.shared;y.data=
q;return y};v.from=function(q){const {symbologyType:y,vvFlags:A}=q,w=this.load(0);w.geometryType=u.WGLGeometryType.FILL;w.symbologyType=y;y!==u.WGLSymbologyType.DOT_DENSITY&&w.setVV(A,q);return w.data};v.prototype.getVariation=function(){return{...r.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return v}(a(c(b(e))));
f.shared=new f(0);let g=function(r){function v(){return r.apply(this,arguments)||this}p._inheritsLoose(v,r);v.load=function(q){const y=this.shared;y.data=q;return y};v.from=function(q){const {symbologyType:y,vvFlags:A}=q,w=this.load(0);w.geometryType=u.WGLGeometryType.MARKER;w.symbologyType=y;y!==u.WGLSymbologyType.HEATMAP&&w.setVV(A,q);return w.data};v.prototype.getVariation=function(){return{...r.prototype.getVariation.call(this),vvColor:this.vvColor,vvRotation:this.vvRotation,vvOpacity:this.vvOpacity,
vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return v}(a(c(d(b(e)))));g.shared=new g(0);let n=function(r){function v(){return r.apply(this,arguments)||this}p._inheritsLoose(v,r);v.load=function(q){const y=this.shared;y.data=q;return y};v.from=function(q){const y=this.load(0);y.geometryType=u.WGLGeometryType.LINE;y.symbologyType=q.symbologyType;y.setVV(q.vvFlags,q);return y.data};v.prototype.getVariation=
function(){return{...r.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return v}(a(c(b(e))));n.shared=new n(0);let k=function(r){function v(){return r.apply(this,arguments)||this}p._inheritsLoose(v,r);v.load=function(q){const y=this.shared;y.data=q;return y};v.from=function(q){const y=this.load(0);y.geometryType=
u.WGLGeometryType.TEXT;y.symbologyType=q.symbologyType;y.setVV(q.vvFlags,q);return y.data};v.prototype.getVariation=function(){return{...r.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvRotation:this.vvRotation,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return v}(a(c(d(b(e)))));k.shared=new k(0);let x=function(r){function v(){return r.apply(this,arguments)||
this}p._inheritsLoose(v,r);v.load=function(q){const y=this.shared;y.data=q;return y};v.from=function(q){const y=this.load(0);y.geometryType=u.WGLGeometryType.LABEL;y.symbologyType=q.symbologyType;y.setVV(q.vvFlags,q);y.mapAligned=B.isMapAligned(q.placement);return y.data};v.prototype.getVariation=function(){return{...r.prototype.getVariation.call(this),vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};
return v}(b(e));x.shared=new x(0);m.FillMaterialKey=f;m.LabelMaterialKey=x;m.LineMaterialKey=n;m.MarkerMaterialKey=g;m.MaterialKeyBase=e;m.TextMaterialKey=k;m.createMaterialKey=function(r,v){switch(r){case u.WGLGeometryType.FILL:return f.from(v);case u.WGLGeometryType.LINE:return n.from(v);case u.WGLGeometryType.MARKER:return g.from(v);case u.WGLGeometryType.TEXT:return k.from(v);case u.WGLGeometryType.LABEL:return x.from(v);default:throw Error(`Unable to createMaterialKey for unknown geometryType ${r}`);
}};m.hasOutlineFillSymbology=function(r){return h(r.symbologyType)};m.hasSimpleSymbology=function(r){return t(r.symbologyType)};m.hydrateMaterialKey=function(r){switch(e.load(r).geometryType){case u.WGLGeometryType.MARKER:return new g(r);case u.WGLGeometryType.FILL:return new f(r);case u.WGLGeometryType.LINE:return new n(r);case u.WGLGeometryType.TEXT:return new k(r);case u.WGLGeometryType.LABEL:return new x(r)}};m.isOutlineFillSymbology=h;m.isSimpleSymbology=t;Object.defineProperty(m,Symbol.toStringTag,
{value:"Module"})})},"esri/views/2d/engine/webgl/alignmentUtils":function(){define(["exports"],function(m){m.HAlign=void 0;(function(p){p[p.Left=-1]="Left";p[p.Center=0]="Center";p[p.Right=1]="Right"})(m.HAlign||(m.HAlign={}));m.VAlign=void 0;(function(p){p[p.Top=1]="Top";p[p.Center=0]="Center";p[p.Bottom=-1]="Bottom";p[p.Baseline=2]="Baseline"})(m.VAlign||(m.VAlign={}));m.getAlignmentFromPlacement=function(p){switch(p){case "above-left":case "esriServerPointLabelPlacementAboveLeft":return[m.HAlign.Right,
m.VAlign.Bottom];case "above-center":case "above-along":case "esriServerPointLabelPlacementAboveCenter":case "esriServerLinePlacementAboveAlong":return[m.HAlign.Center,m.VAlign.Bottom];case "above-right":case "esriServerPointLabelPlacementAboveRight":return[m.HAlign.Left,m.VAlign.Bottom];case "center-left":case "esriServerPointLabelPlacementCenterLeft":return[m.HAlign.Right,m.VAlign.Center];case "center-center":case "center-along":case "esriServerPointLabelPlacementCenterCenter":case "esriServerLinePlacementCenterAlong":return[m.HAlign.Center,
m.VAlign.Center];case "center-right":case "esriServerPointLabelPlacementCenterRight":return[m.HAlign.Left,m.VAlign.Center];case "below-left":case "esriServerPointLabelPlacementBelowLeft":return[m.HAlign.Right,m.VAlign.Top];case "below-center":case "below-along":case "esriServerPointLabelPlacementBelowCenter":case "esriServerLinePlacementBelowAlong":return[m.HAlign.Center,m.VAlign.Top];case "below-right":case "esriServerPointLabelPlacementBelowRight":return[m.HAlign.Left,m.VAlign.Top];case "always-horizontal":case "esriServerPolygonPlacementAlwaysHorizontal":return[m.HAlign.Center,
m.VAlign.Center];default:return console.debug(`Found invalid placement type ${p}`),[m.HAlign.Center,m.VAlign.Center]}};m.getJustification=function(p){switch(p){case "left":return m.HAlign.Left;case "right":return m.HAlign.Right;case "center":return m.HAlign.Center}};m.getXAnchorDirection=function(p){switch(p){case "left":return m.HAlign.Left;case "right":return m.HAlign.Right;case "center":return m.HAlign.Center}};m.getXDirection=function(p){switch(p){case m.HAlign.Right:return-1;case m.HAlign.Center:return 0;
case m.HAlign.Left:return 1;default:return console.debug(`Found invalid horizontal alignment ${p}`),0}};m.getYAnchorDirection=function(p){switch(p){case "top":return m.VAlign.Top;case "middle":return m.VAlign.Center;case "baseline":return m.VAlign.Baseline;case "bottom":return m.VAlign.Bottom}};m.getYDirection=function(p){switch(p){case m.VAlign.Top:return 1;case m.VAlign.Center:return 0;case m.VAlign.Bottom:case m.VAlign.Baseline:return-1;default:return console.debug(`Found invalid vertical alignment ${p}`),
0}};m.isMapAligned=function(p){switch(p){case "above-along":case "below-along":case "center-along":case "esriServerLinePlacementAboveAlong":case "esriServerLinePlacementBelowAlong":case "esriServerLinePlacementCenterAlong":return!0;default:return!1}};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/techniques/utils":function(){define("exports ../../../../../core/Error ../enums ../materialKey/MaterialKey ./Technique ./dotDensity/TechniqueDotDensity ./heatmap/TechniqueHeatmap ./pieChart/TechniquePieChart".split(" "),
function(m,p,D,B,u,t,h,l){m.assertRendererSchema=function(e,b){if(e.type!==b)throw new p("material-view-model:unexpected-renderer-schema",`expected to find renderer schema of type "${b}" but found type "${e.type}"`);};m.getTechniqueFromMaterialKey=function(e){const {geometryType:b,symbologyType:d}=B.MaterialKeyBase.load(e);switch(b){case D.WGLGeometryType.FILL:switch(d){case D.WGLSymbologyType.DOT_DENSITY:return t.DotDensityTechnique}break;case D.WGLGeometryType.MARKER:switch(d){case D.WGLSymbologyType.HEATMAP:return h.HeatmapTechnique;
case D.WGLSymbologyType.PIE_CHART:return l.PieChartTechnique}}return u.Technique};m.getTechniqueFromRenderer=function(e){switch(e?.type){case "dot-density":return t.DotDensityTechnique;case "heatmap":return h.HeatmapTechnique;case "pie-chart":return l.PieChartTechnique;default:return u.Technique}};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/techniques/Technique":function(){define(["exports","../../../../../core/maybe"],function(m,p){let D=function(){function B(){}
B.getStorageSpec=function(u){return null};B.createOrUpdateRendererSchema=function(u,t){return p.isSome(u)&&"default"===u.type?u:{type:"default"}};B.getVariation=function(u){return{}};B.getVariationHash=function(u){return 0};return B}();D.type="default";D.programSpec=null;m.Technique=D;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/techniques/dotDensity/TechniqueDotDensity":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../color ../../definitions ../Technique ../../../../../webgl/enums".split(" "),
function(m,p,D,B,u,t,h){t=function(l){function e(){return l.apply(this,arguments)||this}p._inheritsLoose(e,l);e.getStorageSpec=function({attributes:b}){return{visualVariables:!1,attributes:b??null}};e._createRendererSchema=function(){return{type:"dot-density",colors:new Float32Array(32),dotValue:-1,dotSize:-1,dotScale:-1,dotBlending:!1,backgroundColor:new Float32Array(4),activeDots:new Float32Array(8),seed:-1}};e.createOrUpdateRendererSchema=function(b,d){const {attributes:a,dotValue:c,referenceScale:f,
dotSize:g,dotBlendingEnabled:n,seed:k,backgroundColor:x}=d;b=D.isSome(b)&&"dot-density"===b.type?b:this._createRendererSchema();b.dotValue=c;b.dotSize=g;b.dotScale=f;b.dotBlending=n;b.seed=k;const {colors:r,activeDots:v,backgroundColor:q}=b;for(var y=0;y<u.DOT_DENSITY_MAX_FIELDS;y++)B.writeColor(r,y>=a.length?null:a[y].color,4*y);for(y=0;8>y;y++)v[y]=y<d.attributes.length?1:0;B.writeColor(q,x);return b};e.getVariation=function(b){return{ddDotBlending:b.dotBlending}};e.getVariationHash=function(b){return b.dotBlending?
1:0};return e}(t.Technique);t.type="dot-density";t.programSpec={shader:"materials/fill",vertexLayout:{geometry:[{location:0,name:"a_pos",count:2,type:h.DataType.SHORT},{location:1,name:"a_id",count:3,type:h.DataType.UNSIGNED_BYTE},{location:2,name:"a_bitset",count:1,type:h.DataType.UNSIGNED_BYTE},{location:3,name:"a_inverseArea",count:1,type:h.DataType.FLOAT}]}};m.DotDensityTechnique=t;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/color":function(){define(["exports",
"../../../../core/maybe","./number"],function(m,p,D){m.premultiplyAlpha=function(B,u=0,t=!1){const h=B[u+3];B[u+0]*=h;B[u+1]*=h;B[u+2]*=h;t||(B[u+3]*=255);return B};m.premultiplyAlphaRGBA=function(B){if(!B)return 0;const {r:u,g:t,b:h,a:l}=B;return D.i8888to32(u*l,t*l,h*l,255*l)};m.premultiplyAlphaRGBAArray=function(B){if(!B)return 0;const [u,t,h,l]=B;return D.i8888to32(l/255*u,l/255*t,l/255*h,l)};m.writeColor=function(B,u,t=0){if(p.isNone(u))B[t+0]=0,B[t+1]=0,B[t+2]=0,B[t+3]=0;else{var {r:h,g:l,b:e,
a:b}=u;B[t+0]=h*b/255;B[t+1]=l*b/255;B[t+2]=e*b/255;B[t+3]=b}};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/number":function(){define(["exports"],function(m){function p(u,t,h){return Math.round(Math.max(Math.min(u,h),t))}const D=new Float32Array(1),B=new Uint32Array(D.buffer);m.i16=function(u){return p(u,-32768,32767)};m.i1616to32=function(u,t){return 65535&u|t<<16};m.i32=function(u){return p(u,-2147483648,2147483647)};m.i8=function(u){return p(u,-128,
127)};m.i8816to32=function(u,t,h){return u&255|(t&255)<<8|h<<16};m.i8888to32=function(u,t,h,l){return u&255|(t&255)<<8|(h&255)<<16|l<<24};m.numTo32=function(u){return u|0};m.toFloat32=function(u){B[0]=u;return D[0]};m.toUint32=function(u){D[0]=u;return B[0]};m.u16=function(u){return p(u,0,65535)};m.u32=function(u){return p(u,0,4294967295)};m.u32to4Xu8=function(u){return[u&255,(u&65280)>>>8,(u&16711680)>>>16,(u&4278190080)>>>24]};m.u4u4to8=function(u,t){return 15&u|(15&t)<<4};m.u8=function(u){return p(u,
0,255)};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/techniques/heatmap/TechniqueHeatmap":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../renderers/support/heatmapUtils ../Technique ../../../../../webgl/enums".split(" "),function(m,p,D,B,u,t,h){t=function(l){function e(){return l.apply(this,arguments)||this}p._inheritsLoose(e,l);e.getStorageSpec=
function({field:b,valueExpression:d}){return{visualVariables:!1,attributes:b||d?[{field:b,valueExpression:d}]:null}};e._createRendererSchema=function(){return{type:"heatmap",radius:-1,referenceScale:-1,isFieldActive:0,minDensity:-1,densityRange:-1,kernel:null,gradient:null,gradientHash:"invalid"}};e.createOrUpdateRendererSchema=function(b,d){const {radius:a,minDensity:c,maxDensity:f,referenceScale:g,field:n,valueExpression:k,colorStops:x}=d;d=f-c;const r=n||k?1:0,v=x.map(({color:A,ratio:w})=>`${w}:${A.toString()}`).join();
let q=!0,y;D.isSome(b)&&"heatmap"===b.type?(y=b,q=v!==b.gradientHash):y=this._createRendererSchema();y.radius=B.pt2px(a);y.minDensity=c;y.densityRange=d;y.referenceScale=g;y.isFieldActive=r;q&&(y.gradient=u.generateGradient(x),y.gradientHash=v);return y};return e}(t.Technique);t.type="heatmap";t.programSpec={shader:"materials/icon/heatmapAccumulate",vertexLayout:{geometry:[{location:0,name:"a_pos",count:2,type:h.DataType.SHORT},{location:1,name:"a_vertexOffset",count:2,type:h.DataType.SHORT},{location:4,
name:"a_id",count:4,type:h.DataType.UNSIGNED_BYTE}]}};m.HeatmapTechnique=t;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/techniques/pieChart/TechniquePieChart":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../Color ../../../../../../core/maybe ../../../../../../core/screenUtils ../../color ../../definitions ../Technique ../../../../../webgl/enums".split(" "),function(m,p,D,B,u,t,h,l,e){l=function(b){function d(){return b.apply(this,
arguments)||this}p._inheritsLoose(d,b);d.getStorageSpec=function({attributes:a}){return{visualVariables:!0,attributes:a??null}};d._createRendererSchema=function(){return{type:"pie-chart",colors:new Float32Array(4*h.CHART_MAX_FIELDS),defaultColor:new Float32Array(4),othersColor:new Float32Array(4),outlineColor:new Float32Array(4),holePercentage:0,sectorThreshold:0,outlineWidth:1,numberOfFields:10}};d.createOrUpdateRendererSchema=function(a,c){const {attributes:f,defaultColor:g,holePercentage:n,othersCategory:k,
outline:x}=c;a=B.isSome(a)&&"pie-chart"===a.type?a:this._createRendererSchema();for(c=0;c<h.CHART_MAX_FIELDS;c++){const r=c>=f.length?new D([0,0,0,0]):f[c].color;t.writeColor(a.colors,r,4*c)}t.writeColor(a.defaultColor,g);t.writeColor(a.othersColor,k?.color);t.writeColor(a.outlineColor,x?.color);a.outlineWidth=u.pt2px(x?.width||0);a.holePercentage=n;a.sectorThreshold=k?.threshold||0;a.numberOfFields=f.length;return a};d.getVariation=function(a){return{numberOfFields:a.numberOfFields}};d.getVariationHash=
function(a){return a.numberOfFields};return d}(l.Technique);l.type="pie-chart";l.programSpec={shader:"materials/pie",vertexLayout:{geometry:[{location:0,name:"a_pos",count:2,type:e.DataType.SHORT},{location:1,name:"a_vertexOffset",count:2,type:e.DataType.SHORT},{location:2,name:"a_texCoords",count:2,type:e.DataType.UNSIGNED_SHORT},{location:3,name:"a_bitSetAndDistRatio",count:2,type:e.DataType.UNSIGNED_SHORT},{location:4,name:"a_id",count:4,type:e.DataType.UNSIGNED_BYTE},{location:5,name:"a_color",
count:4,type:e.DataType.UNSIGNED_BYTE,normalized:!0},{location:6,name:"a_outlineColor",count:4,type:e.DataType.UNSIGNED_BYTE,normalized:!0},{location:7,name:"a_sizeAndOutlineWidth",count:4,type:e.DataType.UNSIGNED_BYTE},{location:8,name:"a_zoomRange",count:2,type:e.DataType.UNSIGNED_SHORT}]},hittestAttributes:["a_vertexOffset","a_texCoords"]};m.PieChartTechnique=l;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/brushes/WGLBrushHeatmap":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Logger ../../../../../core/maybe ../enums ../VertexStream ./WGLGeometryBrushMarker ../effects/Effect ../techniques/utils ../../../../webgl/context-util ../../../../webgl/enums ../../../../webgl/FramebufferObject ../../../../webgl/heatmapTextureUtils ../../../../webgl/Renderbuffer ../../../../webgl/Texture".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d,a,c,f){const g=p.getLogger("esri.views.2d.engine.webgl.brushes.WGLBrushHeatmap");p=function(x){function r(){var q=x.apply(this,arguments)||this;q.brushEffect=new k;return q}m._inheritsLoose(r,x);var v=r.prototype;v.supportsSymbology=function(q){return q===B.WGLSymbologyType.HEATMAP};v.dispose=function(){x.prototype.dispose.call(this);this.brushEffect.dispose();this.brushEffect=null};v.prepareState=function(){};v.drawGeometry=function(q,y,A,w){const {defines:z}=this.brushEffect.loadQualityProfile(q.context);
x.prototype.drawGeometry.call(this,q,y,A,w?[...w,...z]:z)};v._drawMarkers=function(q,y,A,w,z,C,E){const {context:F,rendererInfo:G,state:H}=q;({rendererSchema:q}=G);l.assertRendererSchema(q,"heatmap");const {referenceScale:L,radius:K,isFieldActive:M}=q;A.setUniform1f("u_radius",K*(0!==L?L/H.scale:1));E||(A.setUniform1f("u_isFieldActive",M),F.setStencilFunction(b.CompareFunction.GEQUAL,y.stencilRef,255));F.drawElements(w,z,b.DataType.UNSIGNED_INT,C)};return r}(t);const n={vsPath:"heatmap/heatmapResolve",
fsPath:"heatmap/heatmapResolve",attributes:new Map([["a_position",0]])};let k=function(x){function r(){var q=x.apply(this,arguments)||this;q.name=q.constructor.name;return q}m._inheritsLoose(r,x);var v=r.prototype;v.createOptions=function({passOptions:q}){return q};v.dispose=function(){this._prevFBO=null;this._accumulateOutputTexture=D.disposeMaybe(this._accumulateOutputTexture);D.isSome(this._accumulateFramebuffer)&&this._accumulateFramebuffer.detachDepthStencilBuffer();this._accumulateOutputStencilBuffer=
D.disposeMaybe(this._accumulateOutputStencilBuffer);this._accumulateFramebuffer=D.disposeMaybe(this._accumulateFramebuffer);this._resolveGradientTexture=D.disposeMaybe(this._resolveGradientTexture);this._tileQuad=D.disposeMaybe(this._tileQuad)};v.bind=function(q){const {context:y,rendererInfo:A,passOptions:w}=q,{rendererSchema:z}=A;D.isSome(w)&&"hittest"===w.type||"heatmap"!==z.type||(this._prevFBO=y.getBoundFramebufferObject(),this._prevViewport=y.getViewport(),l.assertRendererSchema(z,"heatmap"),
this._loadResources(q),this._updateResources(y,z),y.bindFramebuffer(this._accumulateFramebuffer),y.setViewport(0,0,this._accumulateFramebuffer.width,this._accumulateFramebuffer.height),y.setStencilTestEnabled(!0),y.setBlendingEnabled(!0),y.setBlendFunction(b.BlendFactor.ONE,b.BlendFactor.ONE),y.setClearColor(0,0,0,0),y.clear(b.ClearBufferBit.COLOR_BUFFER_BIT))};v.unbind=function(){this._prevViewport=this._prevFBO=null};v.draw=function(q){const {context:y,painter:A,rendererInfo:w,passOptions:z}=q;
({rendererSchema:q}=w);if(!(D.isSome(z)&&"hittest"===z.type||"heatmap"!==q.type)){var {defines:C}=this.loadQualityProfile(y);C=A.materialManager.getProgram(n,C);y.useProgram(C);y.bindFramebuffer(this._prevFBO);y.setViewport(0,0,this._prevViewport.width,this._prevViewport.height);y.setBlendFunction(b.BlendFactor.ONE,b.BlendFactor.ONE_MINUS_SRC_ALPHA);y.setStencilTestEnabled(!1);var {radius:E,minDensity:F,densityRange:G}=q;y.bindTexture(this._accumulateOutputTexture,8);y.bindTexture(this._resolveGradientTexture,
9);C.setUniform1i("u_texture",8);C.setUniform1i("u_gradient",9);C.setUniform2f("u_densityMinAndInvRange",F,1/G);C.setUniform1f("u_densityNormalization",3/(E*E*Math.PI));this._tileQuad.draw()}};v._loadResources=function({context:q,painter:y}){const {dataType:A,samplingMode:w,pixelFormat:z,internalFormat:C,shadingRate:E,requiresSharedStencilBuffer:F}=this.loadQualityProfile(q),{width:G,height:H}=this._prevViewport,L=G*E,K=H*E;this._accumulateOutputTexture??(this._accumulateOutputTexture=new f.Texture(q,
{target:b.TextureType.TEXTURE_2D,pixelFormat:z,internalFormat:C,dataType:A,samplingMode:w,wrapMode:b.TextureWrapMode.CLAMP_TO_EDGE,width:L,height:K}));F||(this._accumulateOutputStencilBuffer??(this._accumulateOutputStencilBuffer=new c.Renderbuffer(q,{width:L,height:K,internalFormat:b.RenderbufferFormat.DEPTH_STENCIL})));this._accumulateFramebuffer??(this._accumulateFramebuffer=new d.FramebufferObject(q,{},this._accumulateOutputTexture,F?y.getSharedStencilBuffer():this._accumulateOutputStencilBuffer));
this._resolveGradientTexture??(this._resolveGradientTexture=new f.Texture(q,{target:b.TextureType.TEXTURE_2D,pixelFormat:b.PixelFormat.RGBA,dataType:b.PixelType.UNSIGNED_BYTE,samplingMode:b.TextureSamplingMode.LINEAR,wrapMode:b.TextureWrapMode.CLAMP_TO_EDGE}));this._tileQuad??(this._tileQuad=new u(q,[0,0,1,0,0,1,1,1]))};v._updateResources=function(q,y){const {gradientHash:A,gradient:w}=y;this._prevGradientHash!==A&&(this._resolveGradientTexture.resize(w.length/4,1),this._resolveGradientTexture.setData(w),
this._prevGradientHash=A);const {shadingRate:z,requiresSharedStencilBuffer:C}=this.loadQualityProfile(q),{width:E,height:F}=this._prevViewport;y=E*z;const G=F*z,{width:H,height:L}=this._accumulateFramebuffer;if(H!==y||L!==G){const K=this._accumulateFramebuffer.depthStencilAttachment;if(C&&D.isSome(K)){const {width:M,height:U}=K.descriptor;if(M!==y||U!==G)g.errorOnce("Attempted to resize shared stencil buffer! Detaching instead."),this._accumulateFramebuffer.detachDepthStencilBuffer()}this._accumulateFramebuffer.resize(y,
G)}C||q.blitFramebuffer(this._prevFBO,this._accumulateFramebuffer,0,0,this._prevFBO.width,this._prevFBO.height,0,0,this._accumulateFramebuffer.width,this._accumulateFramebuffer.height,b.ClearBufferBit.STENCIL_BUFFER_BIT,b.TextureSamplingMode.NEAREST)};v.loadQualityProfile=function(q){if(D.isNone(this._qualityProfile)){const y=a.loadHeatmapTextureConfiguration(q,g);q=q.type===e.ContextType.WEBGL1;this._qualityProfile={...y,requiresSharedStencilBuffer:q,shadingRate:q?1:.25,defines:y.dataType!==b.PixelType.FLOAT?
["heatmapPrecisionHalfFloat"]:[]}}return this._qualityProfile};return r}(h.Effect);return p})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushMarker":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey ../techniques/utils ../../../../webgl/enums".split(" "),function(m,p,D,B,u,t,h,l){const e={shader:"materials/icon",vertexLayout:{geometry:[{location:0,name:"a_pos",count:2,type:l.DataType.SHORT},
{location:1,name:"a_vertexOffset",count:2,type:l.DataType.SHORT},{location:2,name:"a_texCoords",count:2,type:l.DataType.UNSIGNED_SHORT},{location:3,name:"a_bitSetAndDistRatio",count:2,type:l.DataType.UNSIGNED_SHORT},{location:4,name:"a_id",count:4,type:l.DataType.UNSIGNED_BYTE},{location:5,name:"a_color",count:4,type:l.DataType.UNSIGNED_BYTE,normalized:!0},{location:6,name:"a_outlineColor",count:4,type:l.DataType.UNSIGNED_BYTE,normalized:!0},{location:7,name:"a_sizeAndOutlineWidth",count:4,type:l.DataType.UNSIGNED_BYTE},
{location:8,name:"a_zoomRange",count:2,type:l.DataType.UNSIGNED_SHORT}]},hittestAttributes:["a_vertexOffset","a_texCoords"]};return function(b){function d(){return b.apply(this,arguments)||this}m._inheritsLoose(d,b);var a=d.prototype;a.dispose=function(){};a.getGeometryType=function(){return D.WGLGeometryType.MARKER};a.supportsSymbology=function(c){return c!==D.WGLSymbologyType.HEATMAP&&c!==D.WGLSymbologyType.PIE_CHART};a.drawGeometry=function(c,f,g,n){const {context:k,painter:x,rendererInfo:r,state:v,
passOptions:q,requestRender:y,allowDelayedRender:A}=c;var w=t.MarkerMaterialKey.load(g.materialKey),z=h.getTechniqueFromMaterialKey(w.data);const C=p.isSome(q)&&"hittest"===q.type,{shader:E,vertexLayout:F,hittestAttributes:G}=p.unwrapOr(z.programSpec,e);z=l.PrimitiveType.TRIANGLES;var H=B.createProgramDescriptor(w.data,F);C&&(H=this._getTriangleDesc(g.materialKey,H,G),z=l.PrimitiveType.POINTS);const {attributes:L,bufferLayouts:K}=H;n=x.materialManager.getMaterialProgram(c,w,E,L,n);A&&p.isSome(y)&&
!n.compiled?y():(k.useProgram(n),w.textureBinding&&x.textureManager.bindTextures(k,n,w,!0),this._setSharedUniforms(n,c,f),n.setUniformMatrix3fv("u_displayMat3",w.vvRotation?v.displayViewMat3:v.displayMat3),this._setSizeVVUniforms(w,n,r,f),this._setColorAndOpacityVVUniforms(w,n,r),this._setRotationVVUniforms(w,n,r),w=g.target.getVAO(k,K,L,C),H=g.indexCount,g=g.indexFrom*Uint32Array.BYTES_PER_ELEMENT,C&&(H/=3,g/=3),k.bindVAO(w),this._drawMarkers(c,f,n,z,H,g,C),k.bindVAO(null))};a._drawMarkers=function(c,
f,g,n,k,x,r){c.context.drawElements(n,k,l.DataType.UNSIGNED_INT,x)};return d}(u)})},"esri/views/2d/engine/webgl/effects/Effect":function(){define(["exports"],function(m){let p=function(){function D(){this.name=this.constructor.name}D.prototype.createOptions=function(B,u){return null};return D}();m.Effect=p;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/heatmapTextureUtils":function(){define(["exports","../../core/Error","../../core/maybe","./enums"],function(m,p,
D,B){m.loadHeatmapTextureConfiguration=function(u,t){const {textureFloat:h,colorBufferFloat:l}=u.capabilities,e=h?.textureFloat,b=h?.textureFloatLinear;var d=h?.textureHalfFloat;const a=h?.textureHalfFloatLinear,c=h?.HALF_FLOAT,f=l?.textureFloat;var g=l?.textureHalfFloat;const n=l?.floatBlend;u=D.unwrapOrThrow(u.driverTest).floatBufferBlend.result;if(!e&&!d)throw new p("heatmap:missing-texture-float","HeatmapRenderer requires WebGL2 or the WebGL1 extension OES_texture_float or OES_texture_half_float.");
if(!f&&!g)throw new p("heatmap:missing-color-buffer-float","HeatmapRenderer requires the WebGL extension EXT_color_buffer_float or EXT_color_buffer_half_float or WEBGL_color_buffer_float.");if(!(n&&u||g))throw new p("heatmap:missing-float-blend",`HeatmapRenderer requires the WebGL extension EXT_float_blend or EXT_color_buffer_half_float.${u?"":" This device claims support for EXT_float_blend, but does not actually support it."}`);d=d&&g;g=!!l?.R32F;const k=!!l?.R16F;if(e&&f&&n&&u&&(b||!a))return b||
t.warnOnce("Missing WebGL extension OES_texture_float_linear. Heatmap quality may be reduced."),{dataType:B.PixelType.FLOAT,samplingMode:b?B.TextureSamplingMode.LINEAR:B.TextureSamplingMode.NEAREST,pixelFormat:g?B.PixelFormat.RED:B.PixelFormat.RGBA,internalFormat:g?B.SizedPixelFormat.R32F:B.PixelFormat.RGBA};if(d)return a||t.warnOnce("Missing WebGL extension OES_texture_half_float_linear. Heatmap quality may be reduced."),{dataType:c,samplingMode:a?B.TextureSamplingMode.LINEAR:B.TextureSamplingMode.NEAREST,
pixelFormat:k?B.PixelFormat.RED:B.PixelFormat.RGBA,internalFormat:k?B.SizedPixelFormat.R16F:B.PixelFormat.RGBA};throw new p("heatmap:missing-hardware-support","HeatmapRenderer requires WebGL extensions that allow it to render and blend to float or half float textures.");};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/brushes/WGLBrushInfo":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../chunks/vec4f32 ../DefaultVertexAttributeLayouts ./WGLBrush ../shaders/BackgroundPrograms ../shaders/TileInfoPrograms ../../../../webgl/BufferObject ../../../../webgl/enums ../../../../webgl/ProgramTemplate ../../../../webgl/Texture ../../../../webgl/VertexArrayObject".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d,a){return function(c){function f(){var n=c.apply(this,arguments)||this;n._color=D.fromValues(1,0,0,1);return n}m._inheritsLoose(f,c);var g=f.prototype;g.dispose=function(){this._outlineProgram?.dispose();this._outlineProgram=null;this._tileInfoProgram?.dispose();this._tileInfoProgram=null;this._outlineVertexArrayObject?.dispose();this._outlineVertexArrayObject=null;this._tileInfoVertexArrayObject?.dispose();this._canvas=this._tileInfoVertexArrayObject=null};g.prepareState=
function({context:n}){n.setBlendingEnabled(!0);n.setBlendFunctionSeparate(e.BlendFactor.ONE,e.BlendFactor.ONE_MINUS_SRC_ALPHA,e.BlendFactor.ONE,e.BlendFactor.ONE_MINUS_SRC_ALPHA);n.setColorMask(!0,!0,!0,!0);n.setStencilWriteMask(0);n.setStencilTestEnabled(!1)};g.draw=function(n,k){const {context:x,requestRender:r,allowDelayedRender:v}=n;if(k.isReady)if(this._loadWGLResources(x),!v||!p.isSome(r)||this._outlineProgram.compiled&&this._tileInfoProgram.compiled){x.bindVAO(this._outlineVertexArrayObject);
x.useProgram(this._outlineProgram);this._outlineProgram.setUniformMatrix3fv("u_dvsMat3",k.transforms.dvs);this._outlineProgram.setUniform2f("u_coord_range",k.rangeX,k.rangeY);this._outlineProgram.setUniform1f("u_depth",0);this._outlineProgram.setUniform4fv("u_color",this._color);x.drawArrays(e.PrimitiveType.LINE_STRIP,0,4);if(n=this._getTexture(x,k))x.bindVAO(this._tileInfoVertexArrayObject),x.useProgram(this._tileInfoProgram),x.bindTexture(n,0),this._tileInfoProgram.setUniformMatrix3fv("u_dvsMat3",
k.transforms.dvs),this._tileInfoProgram.setUniform1f("u_depth",0),this._tileInfoProgram.setUniform2f("u_coord_ratio",k.rangeX/k.width,k.rangeY/k.height),this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",n.descriptor.width,n.descriptor.height),x.drawArrays(e.PrimitiveType.TRIANGLE_STRIP,0,4);x.bindVAO()}else r()};g._loadWGLResources=function(n){if(!this._outlineProgram||!this._tileInfoProgram){var k=b.createProgram(n,t.background),x=b.createProgram(n,
h.tileInfo),r=new Int8Array([0,0,1,0,1,1,0,1]);r=l.BufferObject.createVertex(n,e.Usage.STATIC_DRAW,r);r=new a.VertexArrayObject(n,t.background.attributes,B.Pos2b,{geometry:r});var v=new Int8Array([0,0,1,0,0,1,1,1]);v=l.BufferObject.createVertex(n,e.Usage.STATIC_DRAW,v);n=new a.VertexArrayObject(n,h.tileInfo.attributes,B.Pos2b,{geometry:v});this._outlineProgram=k;this._tileInfoProgram=x;this._outlineVertexArrayObject=r;this._tileInfoVertexArrayObject=n}};g._getTexture=function(n,k){if(k.texture&&k.triangleCountReportedInDebug===
k.triangleCount)return k.texture;k.triangleCountReportedInDebug=k.triangleCount;this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id","canvas2d"),this._canvas.setAttribute("width","300"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));const x=k.triangleCount;let r=k.key.id;0<k.triangleCount&&(r+=`, ${x}`);const v=this._canvas,q=v.getContext("2d");q.font="24px sans-serif";q.textAlign="left";q.textBaseline="top";q.clearRect(0,
0,300,32);1E5<x?(q.fillStyle="red",q.fillRect(0,0,300,32),q.fillStyle="black"):(q.clearRect(0,0,300,32),q.fillStyle="blue");q.fillText(r,0,0);k.texture=new d.Texture(n,{target:e.TextureType.TEXTURE_2D,pixelFormat:e.PixelFormat.RGBA,dataType:e.PixelType.UNSIGNED_BYTE,samplingMode:e.TextureSamplingMode.NEAREST,wrapMode:e.TextureWrapMode.CLAMP_TO_EDGE},v);return k.texture};return f}(u)})},"esri/views/2d/engine/webgl/DefaultVertexAttributeLayouts":function(){define(["exports","../../../webgl/enums","../../../webgl/VertexElementDescriptor"],
function(m,p,D){const B={geometry:[new D.VertexElementDescriptor("a_pos",2,p.DataType.BYTE,0,2)]},u={geometry:[new D.VertexElementDescriptor("a_pos",2,p.DataType.BYTE,0,4),new D.VertexElementDescriptor("a_tex",2,p.DataType.BYTE,2,4)]};p={geometry:[new D.VertexElementDescriptor("a_pos",2,p.DataType.UNSIGNED_SHORT,0,4)]};m.Pos2b=B;m.Pos2us=p;m.PosTex2b=u;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/shaders/TileInfoPrograms":function(){define(["exports",
"./sources/resolver"],function(m,p){p={shaders:{vertexShader:p.resolveIncludes("tileInfo/tileInfo.vert"),fragmentShader:p.resolveIncludes("tileInfo/tileInfo.frag")},attributes:new Map([["a_pos",0]])};m.tileInfo=p;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/brushes/WGLBrushPieChart":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../enums","./WGLGeometryBrushMarker","../techniques/utils","../../../../webgl/enums"],function(m,p,D,
B,u){return function(t){function h(){return t.apply(this,arguments)||this}m._inheritsLoose(h,t);var l=h.prototype;l.supportsSymbology=function(e){return e===p.WGLSymbologyType.PIE_CHART};l._drawMarkers=function(e,b,d,a,c,f,g){({context:b}=e);({rendererInfo:e}=e);({rendererSchema:e}=e);B.assertRendererSchema(e,"pie-chart");d.setUniform4fv("u_colors",e.colors);d.setUniform4fv("u_defaultColor",e.defaultColor);d.setUniform4fv("u_othersColor",e.othersColor);d.setUniform4fv("u_outlineColor",e.outlineColor);
d.setUniform1f("u_donutRatio",e.holePercentage);d.setUniform1f("u_sectorThreshold",e.sectorThreshold);d.setUniform1f("u_outlineWidth",e.outlineWidth);b.drawElements(a,c,u.DataType.UNSIGNED_INT,f)};return h}(D)})},"esri/views/2d/engine/webgl/brushes/WGLBrushStencil":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../chunks/vec4f32 ../DefaultVertexAttributeLayouts ./WGLBrush ../shaders/BackgroundPrograms ../../../../webgl/BufferObject ../../../../webgl/enums ../../../../webgl/ProgramTemplate ../../../../webgl/VertexArrayObject".split(" "),
function(m,p,D,B,u,t,h,l,e,b){return function(d){function a(){var f=d.apply(this,arguments)||this;f._color=D.fromValues(1,0,0,1);f._initialized=!1;return f}m._inheritsLoose(a,d);var c=a.prototype;c.dispose=function(){this._solidProgram&&(this._solidProgram.dispose(),this._solidProgram=null);this._solidVertexArrayObject&&(this._solidVertexArrayObject.dispose(),this._solidVertexArrayObject=null)};c.prepareState=function({context:f}){f.setDepthWriteEnabled(!1);f.setDepthTestEnabled(!1);f.setStencilTestEnabled(!0);
f.setBlendingEnabled(!1);f.setColorMask(!1,!1,!1,!1);f.setStencilOp(l.StencilOperation.KEEP,l.StencilOperation.KEEP,l.StencilOperation.REPLACE);f.setStencilWriteMask(255)};c.draw=function(f,g){const {context:n,requestRender:k,allowDelayedRender:x}=f;this._initialized||this._initialize(n);x&&p.isSome(k)&&!this._solidProgram.compiled?k():(n.setStencilFunctionSeparate(l.Face.FRONT_AND_BACK,l.CompareFunction.GREATER,g.stencilRef,255),n.bindVAO(this._solidVertexArrayObject),n.useProgram(this._solidProgram),
this._solidProgram.setUniformMatrix3fv("u_dvsMat3",g.transforms.dvs),this._solidProgram.setUniform2fv("u_coord_range",[g.rangeX,g.rangeY]),this._solidProgram.setUniform1f("u_depth",0),this._solidProgram.setUniform4fv("u_color",this._color),n.drawArrays(l.PrimitiveType.TRIANGLE_STRIP,0,4),n.bindVAO())};c._initialize=function(f){if(this._initialized)return!0;const g=e.createProgram(f,t.background);if(!g)return!1;var n=new Int8Array([0,0,1,0,0,1,1,1]);n=h.BufferObject.createVertex(f,l.Usage.STATIC_DRAW,
n);f=new b.VertexArrayObject(f,t.background.attributes,B.Pos2b,{geometry:n});this._solidProgram=g;this._solidVertexArrayObject=f;return this._initialized=!0};return a}(u)})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLBackground":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../chunks/mat3f32 ../../../../../chunks/vec4f32 ../definitions ../enums ../number ./WGLBrush ../../../../webgl/BufferObject ../../../../webgl/enums ../../../../webgl/VertexArrayObject".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d,a,c){b=function(f){function g(){var k=f.apply(this,arguments)||this;k._color=t.fromValues(1,0,0,1);k._patternMatrix=u.create();k._programOptions={id:!1,pattern:!1};return k}p._inheritsLoose(g,f);var n=g.prototype;n.dispose=function(){this._vao&&(this._vao.dispose(),this._vao=null)};n.drawMany=function(k,x){const {context:r,painter:v,styleLayerUID:q,requestRender:y,allowDelayedRender:A}=k;this._loadWGLResources(k);const w=k.displayLevel;var z=k.styleLayer,C=z.backgroundMaterial;
const E=v.vectorTilesMaterialManager;var F=z.getPaintValue("background-color",w);const G=z.getPaintValue("background-opacity",w),H=z.getPaintValue("background-pattern",w),L=void 0!==H,K=F[3]*G,M=k.spriteMosaic;let U,T;const Z=(window.devicePixelRatio|1)>h.VTL_HIGH_RES_CUTOFF?2:1;k=k.drawPhase===l.WGLDrawPhase.HITTEST;const X=this._programOptions;X.id=k;X.pattern=L;C=E.getMaterialProgram(r,C,X);if(A&&B.isSome(y)&&!C.compiled)y();else{r.bindVAO(this._vao);r.useProgram(C);if(L){F=M.getMosaicItemPosition(H,
!0);if(B.isSome(F)){const {tl:ca,br:P,page:J}=F;U=P[0]-ca[0];T=P[1]-ca[1];F=M.getPageSize(J);B.isSome(F)&&(M.bind(r,a.TextureSamplingMode.LINEAR,J,h.VTL_TEXTURE_BINDING_UNIT_SPRITES),C.setUniform4f("u_tlbr",ca[0],ca[1],P[0],P[1]),C.setUniform2fv("u_mosaicSize",F),C.setUniform1i("u_texture",h.VTL_TEXTURE_BINDING_UNIT_SPRITES))}C.setUniform1f("u_opacity",G)}else this._color[0]=K*F[0],this._color[1]=K*F[1],this._color[2]=K*F[2],this._color[3]=K,C.setUniform4fv("u_color",this._color);C.setUniform1f("u_depth",
z.z||0);k&&(z=e.u32to4Xu8(q+1),C.setUniform4fv("u_id",z));for(const ca of x)C.setUniform1f("u_coord_range",ca.rangeX),C.setUniformMatrix3fv("u_dvsMat3",ca.transforms.dvs),L&&(z=Z*ca.width*Math.max(2**(Math.round(w)-ca.key.level),1),x=z/D.nextPowerOfTwo(U),z/=D.nextPowerOfTwo(T),this._patternMatrix[0]=x,this._patternMatrix[4]=z,C.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix)),r.setStencilFunction(a.CompareFunction.EQUAL,0,255),r.drawArrays(a.PrimitiveType.TRIANGLE_STRIP,0,4)}};n._loadWGLResources=
function(k){if(!this._vao){var {context:x,styleLayer:r}=k;k=r.backgroundMaterial;var v=new Int8Array([0,0,1,0,0,1,1,1]);v=d.BufferObject.createVertex(x,a.Usage.STATIC_DRAW,v);this._vao=new c.VertexArrayObject(x,k.getAttributeLocations(),k.getLayoutInfo(),{geometry:v})}};return g}(b);m.WGLBrushVTLBackground=b;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLCircle":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../vectorTiles/style/StyleDefinition ../enums ../number ./WGLBrush ../../../../webgl/enums".split(" "),
function(m,p,D,B,u,t,h,l){h=function(e){function b(){var a=e.apply(this,arguments)||this;a._programOptions={id:!1};return a}p._inheritsLoose(b,e);var d=b.prototype;d.dispose=function(){};d.drawMany=function(a,c){const {context:f,displayLevel:g,requiredLevel:n,state:k,drawPhase:x,painter:r,spriteMosaic:v,styleLayerUID:q,requestRender:y,allowDelayedRender:A}=a;if(c.some(H=>H.layerData.get(q)?.circleIndexCount??!1)){a=a.styleLayer;var w=a.circleMaterial,z=r.vectorTilesMaterialManager,C=a.getPaintValue("circle-translate",
g),E=a.getPaintValue("circle-translate-anchor",g),F=x===u.WGLDrawPhase.HITTEST,G=this._programOptions;G.id=F;z=z.getMaterialProgram(f,w,G);if(A&&D.isSome(y)&&!z.compiled)y();else{f.useProgram(z);z.setUniformMatrix3fv("u_displayMat3",E===B.TranslateAnchor.VIEWPORT?k.displayMat3:k.displayViewMat3);z.setUniform2fv("u_circleTranslation",C);z.setUniform1f("u_depth",a.z);z.setUniform1f("u_antialiasingWidth",1.2);C=-1;F&&(F=t.u32to4Xu8(q+1),z.setUniform4fv("u_id",F));for(const H of c)H.layerData.has(q)&&
(H.key.level!==C&&(C=H.key.level,w.setDataUniforms(z,g,a,C,v)),c=H.layerData.get(q),c.circleIndexCount&&(c.prepareForRendering(f),F=c.circleVertexArrayObject,D.isNone(F)||(f.bindVAO(F),z.setUniformMatrix3fv("u_dvsMat3",H.transforms.dvs),n!==H.key.level?f.setStencilFunction(l.CompareFunction.EQUAL,H.stencilRef,255):f.setStencilFunction(l.CompareFunction.GREATER,255,255),f.drawElements(l.PrimitiveType.TRIANGLES,c.circleIndexCount,l.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*c.circleIndexStart),
H.triangleCount+=c.circleIndexCount/3)))}}};return b}(h);m.WGLBrushVTLCircle=h;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/style/StyleDefinition":function(){define(["exports","../../../../../symbols/cim/enums"],function(m,p){m.StyleLayerType=void 0;(function(B){B[B.BACKGROUND=0]="BACKGROUND";B[B.FILL=1]="FILL";B[B.LINE=2]="LINE";B[B.SYMBOL=3]="SYMBOL";B[B.CIRCLE=4]="CIRCLE"})(m.StyleLayerType||(m.StyleLayerType={}));m.Visibility=void 0;(function(B){B[B.VISIBLE=
0]="VISIBLE";B[B.NONE=1]="NONE"})(m.Visibility||(m.Visibility={}));m.SymbolPlacement=void 0;(function(B){B[B.POINT=0]="POINT";B[B.LINE=1]="LINE";B[B.LINE_CENTER=2]="LINE_CENTER"})(m.SymbolPlacement||(m.SymbolPlacement={}));m.RotationAlignment=void 0;(function(B){B[B.MAP=0]="MAP";B[B.VIEWPORT=1]="VIEWPORT";B[B.AUTO=2]="AUTO"})(m.RotationAlignment||(m.RotationAlignment={}));m.TextJustification=void 0;(function(B){B[B.AUTO=0]="AUTO";B[B.LEFT=1]="LEFT";B[B.CENTER=2]="CENTER";B[B.RIGHT=3]="RIGHT"})(m.TextJustification||
(m.TextJustification={}));m.SymbolAnchor=void 0;(function(B){B[B.CENTER=0]="CENTER";B[B.LEFT=1]="LEFT";B[B.RIGHT=2]="RIGHT";B[B.TOP=3]="TOP";B[B.BOTTOM=4]="BOTTOM";B[B.TOP_LEFT=5]="TOP_LEFT";B[B.TOP_RIGHT=6]="TOP_RIGHT";B[B.BOTTOM_LEFT=7]="BOTTOM_LEFT";B[B.BOTTOM_RIGHT=8]="BOTTOM_RIGHT"})(m.SymbolAnchor||(m.SymbolAnchor={}));m.TextTransform=void 0;(function(B){B[B.NONE=0]="NONE";B[B.UPPERCASE=1]="UPPERCASE";B[B.LOWERCASE=2]="LOWERCASE"})(m.TextTransform||(m.TextTransform={}));m.TranslateAnchor=void 0;
(function(B){B[B.MAP=0]="MAP";B[B.VIEWPORT=1]="VIEWPORT"})(m.TranslateAnchor||(m.TranslateAnchor={}));m.TextWritingMode=void 0;(function(B){B[B.HORIZONTAL=0]="HORIZONTAL";B[B.VERTICAL=1]="VERTICAL"})(m.TextWritingMode||(m.TextWritingMode={}));let D=function(){};D.backgroundLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:m.Visibility.VISIBLE}};D.fillLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:m.Visibility.VISIBLE}};D.lineLayoutDefinition=
{visibility:{type:"enum",values:["visible","none"],default:m.Visibility.VISIBLE},"line-cap":{type:"enum",values:["butt","round","square"],default:p.CapType.BUTT},"line-join":{type:"enum",values:["bevel","round","miter"],default:p.JoinType.MITER},"line-miter-limit":{type:"number",default:2},"line-round-limit":{type:"number",default:1.05}};D.symbolLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:m.Visibility.VISIBLE},"symbol-avoid-edges":{type:"boolean",default:!1},"symbol-placement":{type:"enum",
values:["point","line","line-center"],default:m.SymbolPlacement.POINT},"symbol-sort-key":{type:"number",default:-1},"symbol-spacing":{type:"number",minimum:1,default:250},"icon-allow-overlap":{type:"boolean",default:!1},"icon-anchor":{type:"enum",values:"center left right top bottom top-left top-right bottom-left bottom-right".split(" "),default:m.SymbolAnchor.CENTER},"icon-ignore-placement":{type:"boolean",default:!1},"icon-image":{type:"string"},"icon-keep-upright":{type:"boolean",default:!1},"icon-offset":{type:"array",
value:"number",length:2,default:[0,0]},"icon-optional":{type:"boolean",default:!1},"icon-padding":{type:"number",minimum:0,default:2},"icon-rotate":{type:"number",default:0},"icon-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:m.RotationAlignment.AUTO},"icon-size":{type:"number",minimum:0,default:1},"text-allow-overlap":{type:"boolean",default:!1},"text-anchor":{type:"enum",values:"center left right top bottom top-left top-right bottom-left bottom-right".split(" "),default:m.SymbolAnchor.CENTER},
"text-field":{type:"string"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"]},"text-ignore-placement":{type:"boolean",default:!1},"text-justify":{type:"enum",values:["auto","left","center","right"],default:m.TextJustification.CENTER},"text-keep-upright":{type:"boolean",default:!0},"text-letter-spacing":{type:"number",default:0},"text-line-height":{type:"number",default:1.2},"text-max-angle":{type:"number",minimum:0,default:45},"text-max-width":{type:"number",
minimum:0,default:10},"text-offset":{type:"array",value:"number",length:2,default:[0,0]},"text-optional":{type:"boolean",default:!1},"text-padding":{type:"number",minimum:0,default:2},"text-rotate":{type:"number",default:0},"text-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:m.RotationAlignment.AUTO},"text-size":{type:"number",minimum:0,default:16},"text-transform":{type:"enum",values:["none","uppercase","lowercase"],default:m.TextTransform.NONE},"text-writing-mode":{type:"array",
value:"enum",values:["horizontal","vertical"],default:[m.TextWritingMode.HORIZONTAL]}};D.circleLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:m.Visibility.VISIBLE}};D.backgroundPaintDefinition={"background-color":{type:"color",default:[0,0,0,1]},"background-opacity":{type:"number",minimum:0,maximum:1,default:1},"background-pattern":{type:"string"}};D.fillPaintDefinition={"fill-antialias":{type:"boolean",default:!0},"fill-color":{type:"color",default:[0,0,0,1]},"fill-opacity":{type:"number",
minimum:0,maximum:1,default:1},"fill-outline-color":{type:"color",default:[0,0,0,0]},"fill-pattern":{type:"string"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0]},"fill-translate-anchor":{type:"enum",values:["map","viewport"],default:m.TranslateAnchor.MAP}};D.linePaintDefinition={"line-blur":{type:"number",minimum:0,default:0},"line-color":{type:"color",default:[0,0,0,1]},"line-dasharray":{type:"array",value:"number",default:[]},"line-gap-width":{type:"number",minimum:0,default:0},
"line-offset":{type:"number",default:0},"line-opacity":{type:"number",minimum:0,maximum:1,default:1},"line-pattern":{type:"string"},"line-translate":{type:"array",value:"number",length:2,default:[0,0]},"line-translate-anchor":{type:"enum",values:["map","viewport"],default:m.TranslateAnchor.MAP},"line-width":{type:"number",minimum:0,default:1}};D.symbolPaintDefinition={"icon-color":{type:"color",default:[0,0,0,1]},"icon-halo-blur":{type:"number",minimum:0,default:0},"icon-halo-color":{type:"color",
default:[0,0,0,0]},"icon-halo-width":{type:"number",minimum:0,default:0},"icon-opacity":{type:"number",minimum:0,maximum:1,default:1},"icon-translate":{type:"array",value:"number",length:2,default:[0,0]},"icon-translate-anchor":{type:"enum",values:["map","viewport"],default:m.TranslateAnchor.MAP},"text-color":{type:"color",default:[0,0,0,1]},"text-halo-blur":{type:"number",minimum:0,default:0},"text-halo-color":{type:"color",default:[0,0,0,0]},"text-halo-width":{type:"number",minimum:0,default:0},
"text-opacity":{type:"number",minimum:0,maximum:1,default:1},"text-translate":{type:"array",value:"number",length:2,default:[0,0]},"text-translate-anchor":{type:"enum",values:["map","viewport"],default:m.TranslateAnchor.MAP}};D.rasterPaintDefinition={"raster-opacity":{type:"number",minimum:0,maximum:1,default:1},"raster-hue-rotate":{type:"number",default:0},"raster-brightness-min":{type:"number",minimum:0,maximum:1,default:0},"raster-brightness-max":{type:"number",minimum:0,maximum:1,default:1},"raster-saturation":{type:"number",
minimum:-1,maximum:1,default:0},"raster-contrast":{type:"number",minimum:-1,maximum:1,default:0},"raster-fade-duration":{type:"number",minimum:0,default:300}};D.circlePaintDefinition={"circle-blur":{type:"number",minimum:0,default:0},"circle-color":{type:"color",default:[0,0,0,1]},"circle-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-radius":{type:"number",minimum:0,default:5},"circle-stroke-color":{type:"color",default:[0,0,0,1]},"circle-stroke-opacity":{type:"number",minimum:0,
maximum:1,default:1},"circle-stroke-width":{type:"number",minimum:0,default:0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0]},"circle-translate-anchor":{type:"enum",values:["map","viewport"],default:m.TranslateAnchor.MAP}};m.StyleDefinition=D;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLFill":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../vectorTiles/style/StyleDefinition ../definitions ../enums ../number ./WGLBrush ../../../../webgl/enums".split(" "),
function(m,p,D,B,u,t,h,l,e){const b=1/65536;l=function(d){function a(){var f=d.apply(this,arguments)||this;f._fillProgramOptions={id:!1,pattern:!1};f._outlineProgramOptions={id:!1};return f}p._inheritsLoose(a,d);var c=a.prototype;c.dispose=function(){};c.drawMany=function(f,g){const {displayLevel:n,drawPhase:k,renderPass:x,spriteMosaic:r,styleLayerUID:v}=f;var q=!1;for(var y of g)if(y.layerData.has(v)){var A=y.layerData.get(v);if(0<A.fillIndexCount||0<A.outlineIndexCount){q=!0;break}}if(q){q=f.styleLayer;
var w=q.getPaintProperty("fill-pattern");A=(y=void 0!==w)&&w.isDataDriven;if(y&&!A){var z=w.getValue(n);z=r.getMosaicItemPosition(z,!0)}w=!y&&q.getPaintValue("fill-antialias",n);var C=!0,E=1;if(!y){var F=q.getPaintProperty("fill-color"),G=q.getPaintProperty("fill-opacity");F?.isDataDriven||G?.isDataDriven||(E=q.getPaintValue("fill-color",n),E=q.getPaintValue("fill-opacity",n)*E[3],1<=E&&(C=!1))}if(!C||"opaque"!==x){var H;k===t.WGLDrawPhase.HITTEST&&(H=h.u32to4Xu8(v+1));F=q.getPaintValue("fill-translate",
n);G=q.getPaintValue("fill-translate-anchor",n);(C||"translucent"!==x)&&this._drawFill(f,v,q,g,F,G,y,z,A,H);z=!q.hasDataDrivenOutlineColor&&q.outlineUsesFillColor&&1>E;w&&"opaque"!==x&&!z&&this._drawOutline(f,v,q,g,F,G,H)}}};c._drawFill=function(f,g,n,k,x,r,v,q,y,A){if(!v||y||!D.isNone(q)){var {context:w,displayLevel:z,state:C,drawPhase:E,painter:F,pixelRatio:G,spriteMosaic:H,requestRender:L,allowDelayedRender:K}=f;f=n.fillMaterial;var M=F.vectorTilesMaterialManager,U=G>u.VTL_HIGH_RES_CUTOFF?2:1,
T=E===t.WGLDrawPhase.HITTEST,Z=this._fillProgramOptions;Z.id=T;Z.pattern=v;M=M.getMaterialProgram(w,f,Z);if(K&&D.isSome(L)&&!M.compiled)L();else{w.useProgram(M);D.isSome(q)&&({page:q}=q,Z=H.getPageSize(q),D.isSome(Z)&&(H.bind(w,e.TextureSamplingMode.LINEAR,q,u.VTL_TEXTURE_BINDING_UNIT_SPRITES),M.setUniform2fv("u_mosaicSize",Z),M.setUniform1i("u_texture",u.VTL_TEXTURE_BINDING_UNIT_SPRITES)));M.setUniformMatrix3fv("u_displayMat3",r===B.TranslateAnchor.VIEWPORT?C.displayMat3:C.displayViewMat3);M.setUniform2fv("u_fillTranslation",
x);M.setUniform1f("u_depth",n.z+b);T&&M.setUniform4fv("u_id",A);x=-1;for(const X of k)if(X.layerData.has(g)&&(X.key.level!==x&&(x=X.key.level,f.setDataUniforms(M,z,n,x,H)),k=X.layerData.get(g),k.fillIndexCount&&(k.prepareForRendering(w),r=k.fillVertexArrayObject,!D.isNone(r)))){w.bindVAO(r);M.setUniformMatrix3fv("u_dvsMat3",X.transforms.dvs);w.setStencilFunction(e.CompareFunction.EQUAL,X.stencilRef,255);v&&M.setUniform1f("u_patternFactor",X.rangeX/(U*X.width*Math.max(2**(Math.round(z)-X.key.level),
1)));if(y){r=k.patternMap;if(!r)continue;for(const [ca,P]of r)r=H.getPageSize(ca),D.isSome(r)&&(H.bind(w,e.TextureSamplingMode.LINEAR,ca,u.VTL_TEXTURE_BINDING_UNIT_SPRITES),M.setUniform2fv("u_mosaicSize",r),M.setUniform1i("u_texture",u.VTL_TEXTURE_BINDING_UNIT_SPRITES),w.drawElements(e.PrimitiveType.TRIANGLES,P[1],e.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*P[0]))}else w.drawElements(e.PrimitiveType.TRIANGLES,k.fillIndexCount,e.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*k.fillIndexStart);
X.triangleCount+=k.fillIndexCount/3}}}};c._drawOutline=function(f,g,n,k,x,r,v){const {context:q,displayLevel:y,state:A,drawPhase:w,painter:z,pixelRatio:C,spriteMosaic:E,requestRender:F,allowDelayedRender:G}=f;f=n.outlineMaterial;var H=z.vectorTilesMaterialManager;const L=.75/C,K=w===t.WGLDrawPhase.HITTEST,M=this._outlineProgramOptions;M.id=K;H=H.getMaterialProgram(q,f,M);if(G&&D.isSome(F)&&!H.compiled)F();else{q.useProgram(H);H.setUniformMatrix3fv("u_displayMat3",r===B.TranslateAnchor.VIEWPORT?A.displayMat3:
A.displayViewMat3);H.setUniform2fv("u_fillTranslation",x);H.setUniform1f("u_depth",n.z+b);H.setUniform1f("u_outline_width",L);K&&H.setUniform4fv("u_id",v);x=-1;for(const U of k)U.layerData.has(g)&&(U.key.level!==x&&(x=U.key.level,f.setDataUniforms(H,y,n,x,E)),k=U.layerData.get(g),k.prepareForRendering(q),k.outlineIndexCount&&(r=k.outlineVertexArrayObject,D.isNone(r)||(q.bindVAO(r),H.setUniformMatrix3fv("u_dvsMat3",U.transforms.dvs),q.setStencilFunction(e.CompareFunction.EQUAL,U.stencilRef,255),q.drawElements(e.PrimitiveType.TRIANGLES,
k.outlineIndexCount,e.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*k.outlineIndexStart),U.triangleCount+=k.outlineIndexCount/3)))}};return a}(l);m.WGLBrushVTLFill=l;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLLine":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../vectorTiles/style/StyleDefinition ../definitions ../enums ../number ./WGLBrush ../../../../webgl/enums".split(" "),
function(m,p,D,B,u,t,h,l,e){l=function(b){function d(){var c=b.apply(this,arguments)||this;c._programOptions={id:!1,pattern:!1,sdf:!1};return c}p._inheritsLoose(d,b);var a=d.prototype;a.dispose=function(){};a.drawMany=function(c,f){const {context:g,displayLevel:n,state:k,drawPhase:x,painter:r,pixelRatio:v,spriteMosaic:q,styleLayerUID:y,requestRender:A,allowDelayedRender:w}=c;if(f.some(X=>X.layerData.get(y)?.lineIndexCount??!1)){c=c.styleLayer;var z=c.lineMaterial,C=r.vectorTilesMaterialManager,E=
c.getPaintValue("line-translate",n),F=c.getPaintValue("line-translate-anchor",n),G=c.getPaintProperty("line-pattern"),H=void 0!==G,L=H&&G.isDataDriven;if(H&&!L){G=G.getValue(n);var K=q.getMosaicItemPosition(G)}var M;G=!1;if(!H){var U=c.getPaintProperty("line-dasharray");G=(M=void 0!==U)&&U.isDataDriven;M&&!G&&(K=U.getValue(n),K=c.getDashKey(K,c.getLayoutValue("line-cap",n)),K=q.getMosaicItemPosition(K))}U=1/v;var T=x===t.WGLDrawPhase.HITTEST,Z=this._programOptions;Z.id=T;Z.pattern=H;Z.sdf=M;M=C.getMaterialProgram(g,
z,Z);if(w&&D.isSome(A)&&!M.compiled)A();else{g.useProgram(M);M.setUniformMatrix3fv("u_displayViewMat3",k.displayViewMat3);M.setUniformMatrix3fv("u_displayMat3",F===B.TranslateAnchor.VIEWPORT?k.displayMat3:k.displayViewMat3);M.setUniform2fv("u_lineTranslation",E);M.setUniform1f("u_depth",c.z);M.setUniform1f("u_antialiasing",U);T&&(E=h.u32to4Xu8(y+1),M.setUniform4fv("u_id",E));K&&D.isSome(K)&&({page:E}=K,F=q.getPageSize(E),D.isSome(F)&&(q.bind(g,e.TextureSamplingMode.LINEAR,E,u.VTL_TEXTURE_BINDING_UNIT_SPRITES),
M.setUniform2fv("u_mosaicSize",F),M.setUniform1i("u_texture",u.VTL_TEXTURE_BINDING_UNIT_SPRITES)));E=-1;for(const X of f)if(X.layerData.has(y)&&(X.key.level!==E&&(E=X.key.level,z.setDataUniforms(M,n,c,E,q)),M.setUniform1f("u_zoomFactor",2**(n-E)/v),f=X.layerData.get(y),f.lineIndexCount&&(f.prepareForRendering(g),F=f.lineVertexArrayObject,!D.isNone(F)))){g.bindVAO(F);M.setUniformMatrix3fv("u_dvsMat3",X.transforms.dvs);g.setStencilFunction(e.CompareFunction.EQUAL,X.stencilRef,255);if(L||G){F=f.patternMap;
if(!F)continue;for(const [ca,P]of F)F=q.getPageSize(ca),D.isSome(F)&&(q.bind(g,e.TextureSamplingMode.LINEAR,ca,u.VTL_TEXTURE_BINDING_UNIT_SPRITES),M.setUniform2fv("u_mosaicSize",F),M.setUniform1i("u_texture",u.VTL_TEXTURE_BINDING_UNIT_SPRITES),g.drawElements(e.PrimitiveType.TRIANGLES,P[1],e.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*P[0]))}else g.drawElements(e.PrimitiveType.TRIANGLES,f.lineIndexCount,e.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*f.lineIndexStart);X.triangleCount+=
f.lineIndexCount/3}}}};return d}(l);m.WGLBrushVTLLine=l;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLSymbol":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../chunks/vec2f32 ../../vectorTiles/decluttering/config ../../vectorTiles/style/StyleDefinition ../definitions ../enums ../GeometryUtils ../number ./WGLBrush ../../../../webgl/enums".split(" "),function(m,p,D,B,u,
t,h,l,e,b,d,a){const c=1/65536;d=function(f){function g(){var k=f.apply(this,arguments)||this;k._iconProgramOptions={id:!1,sdf:!1};k._sdfProgramOptions={id:!1};k._spritesTextureSize=B.create();return k}p._inheritsLoose(g,f);var n=g.prototype;n.dispose=function(){};n.drawMany=function(k,x){const {drawPhase:r,styleLayerUID:v}=k,q=k.styleLayer;let y;r===l.WGLDrawPhase.HITTEST&&(y=b.u32to4Xu8(v+1));this._drawIcons(k,q,x,y);this._drawText(k,q,x,y)};n._drawIcons=function(k,x,r,v){const {context:q,displayLevel:y,
drawPhase:A,painter:w,spriteMosaic:z,state:C,styleLayerUID:E,requestRender:F,allowDelayedRender:G}=k,H=x.iconMaterial;var L=w.vectorTilesMaterialManager,K=!1;for(var M of r)if(M.layerData.has(E)){var U=M.layerData.get(E);if(0<U.iconPerPageElementsMap.size){K=!0;break}}if(K){K=x.getPaintValue("icon-translate",y);M=x.getPaintValue("icon-translate-anchor",y);var T=x.getLayoutValue("icon-rotation-alignment",y);T===t.RotationAlignment.AUTO&&(T=x.getLayoutValue("symbol-placement",y)===t.SymbolPlacement.POINT?
t.RotationAlignment.VIEWPORT:t.RotationAlignment.MAP);var Z=T===t.RotationAlignment.MAP;Z=x.getLayoutValue("icon-keep-upright",y)&&Z;var X=U.isIconSDF;U=A===l.WGLDrawPhase.HITTEST;var ca=this._iconProgramOptions;ca.id=U;ca.sdf=X;L=L.getMaterialProgram(q,H,ca);if(G&&D.isSome(F)&&!L.compiled)F();else{q.useProgram(L);L.setUniformMatrix3fv("u_displayViewMat3",T===t.RotationAlignment.MAP?C.displayViewMat3:C.displayMat3);L.setUniformMatrix3fv("u_displayMat3",M===t.TranslateAnchor.VIEWPORT?C.displayMat3:
C.displayViewMat3);L.setUniform2fv("u_iconTranslation",K);L.setUniform1f("u_depth",x.z);L.setUniform1f("u_mapRotation",e.degToByte(C.rotation));L.setUniform1f("u_keepUpright",Z?1:0);L.setUniform1f("u_level",10*y);L.setUniform1i("u_texture",h.VTL_TEXTURE_BINDING_UNIT_SPRITES);L.setUniform1f("u_fadeDuration",u.FADE_DURATION/1E3);U&&L.setUniform4fv("u_id",v);v=-1;for(const P of r)if(P.layerData.has(E)&&(P.key.level!==v&&(v=P.key.level,H.setDataUniforms(L,y,x,v,z)),U=P.layerData.get(E),0!==U.iconPerPageElementsMap.size&&
(U.prepareForRendering(q),U.updateOpacityInfo(),r=U.iconVertexArrayObject,!D.isNone(r)))){q.bindVAO(r);L.setUniformMatrix3fv("u_dvsMat3",P.transforms.dvs);L.setUniform1f("u_time",(performance.now()-U.lastOpacityUpdate)/1E3);for(const [J,N]of U.iconPerPageElementsMap)this._renderIconRange(k,L,N,J,P)}}}};n._renderIconRange=function(k,x,r,v,q){const {context:y,spriteMosaic:A}=k;this._spritesTextureSize[0]=A.getWidth(v)/4;this._spritesTextureSize[1]=A.getHeight(v)/4;x.setUniform2fv("u_mosaicSize",this._spritesTextureSize);
A.bind(y,a.TextureSamplingMode.LINEAR,v,h.VTL_TEXTURE_BINDING_UNIT_SPRITES);y.setStencilTestEnabled(!0);y.setStencilFunction(a.CompareFunction.GREATER,255,255);y.setStencilWriteMask(0);y.drawElements(a.PrimitiveType.TRIANGLES,r[1],a.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*r[0]);q.triangleCount+=r[1]/3};n._drawText=function(k,x,r,v){const {context:q,displayLevel:y,drawPhase:A,glyphMosaic:w,painter:z,pixelRatio:C,spriteMosaic:E,state:F,styleLayerUID:G,requestRender:H,allowDelayedRender:L}=
k;k=x.textMaterial;const K=z.vectorTilesMaterialManager;var M=!1;for(var U of r)if(U.layerData.has(G)){var T=U.layerData.get(G);if(0<T.glyphPerPageElementsMap.size){M=!0;break}}if(M&&(T=x.getPaintProperty("text-opacity"),!T||T.isDataDriven||0!==T.getValue(y))){T=x.getPaintProperty("text-color");var Z=!T||T.isDataDriven||0<T.getValue(y)[3];T=x.getPaintProperty("text-halo-width");U=x.getPaintProperty("text-halo-color");var X=(!T||T.isDataDriven||0<T.getValue(y))&&(!U||U.isDataDriven||0<U.getValue(y)[3]);
if(Z||X){T=x.getLayoutValue("text-rotation-alignment",y);T===t.RotationAlignment.AUTO&&(T=x.getLayoutValue("symbol-placement",y)===t.SymbolPlacement.POINT?t.RotationAlignment.VIEWPORT:t.RotationAlignment.MAP);U=T===t.RotationAlignment.MAP;U=x.getLayoutValue("text-keep-upright",y)&&U;M=A===l.WGLDrawPhase.HITTEST;var ca=.8*3/C;this._glyphTextureSize||(this._glyphTextureSize=B.fromValues(w.width/4,w.height/4));var P=x.getPaintValue("text-translate",y),J=x.getPaintValue("text-translate-anchor",y),N=this._sdfProgramOptions;
N.id=M;var S=K.getMaterialProgram(q,k,N);if(L&&D.isSome(H)&&!S.compiled)H();else{q.useProgram(S);S.setUniformMatrix3fv("u_displayViewMat3",T===t.RotationAlignment.MAP?F.displayViewMat3:F.displayMat3);S.setUniformMatrix3fv("u_displayMat3",J===t.TranslateAnchor.VIEWPORT?F.displayMat3:F.displayViewMat3);S.setUniform2fv("u_textTranslation",P);S.setUniform1f("u_depth",x.z+c);S.setUniform2fv("u_mosaicSize",this._glyphTextureSize);S.setUniform1f("u_mapRotation",e.degToByte(F.rotation));S.setUniform1f("u_keepUpright",
U?1:0);S.setUniform1f("u_level",10*y);S.setUniform1i("u_texture",h.VTL_TEXTURE_BINDING_UNIT_GLYPHS);S.setUniform1f("u_antialiasingWidth",ca);S.setUniform1f("u_fadeDuration",u.FADE_DURATION/1E3);M&&S.setUniform4fv("u_id",v);v=-1;for(const Q of r)Q.layerData.has(G)&&(Q.key.level!==v&&(v=Q.key.level,k.setDataUniforms(S,y,x,v,E)),T=Q.layerData.get(G),0!==T.glyphPerPageElementsMap.size&&(T.prepareForRendering(q),T.updateOpacityInfo(),r=T.textVertexArrayObject,D.isNone(r)||(q.bindVAO(r),S.setUniformMatrix3fv("u_dvsMat3",
Q.transforms.dvs),q.setStencilTestEnabled(!0),q.setStencilFunction(a.CompareFunction.GREATER,255,255),q.setStencilWriteMask(0),r=(performance.now()-T.lastOpacityUpdate)/1E3,S.setUniform1f("u_time",r),T.glyphPerPageElementsMap.forEach((Y,ba)=>{this._renderGlyphRange(q,Y,ba,w,S,X,Z,Q)}))))}}}};n._renderGlyphRange=function(k,x,r,v,q,y,A,w){v.bind(k,a.TextureSamplingMode.LINEAR,r,h.VTL_TEXTURE_BINDING_UNIT_GLYPHS);y&&(q.setUniform1f("u_halo",1),k.drawElements(a.PrimitiveType.TRIANGLES,x[1],a.DataType.UNSIGNED_INT,
Uint32Array.BYTES_PER_ELEMENT*x[0]),w.triangleCount+=x[1]/3);A&&(q.setUniform1f("u_halo",0),k.drawElements(a.PrimitiveType.TRIANGLES,x[1],a.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*x[0]),w.triangleCount+=x[1]/3)};return g}(d);m.WGLBrushVTLSymbol=d;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/decluttering/config":function(){define(["exports"],function(m){m.COLLISION_GRID_CELL_SIZE=32;m.DECLUTTER_BUDGET=1.5;m.DECLUTTER_TILES=!0;m.FADE_DURATION=
200;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/GeometryUtils":function(){define(["exports"],function(m){function p(t,h){t%=h;return 0<=t?t:t+h}const D=128/Math.PI,B=256/360,u=1/Math.LN2;m.between=function(t,h,l){return t>=h&&t<=l||t>=l&&t<=h};m.degToByte=function(t){return p(t*B,256)};m.interpolate=function(t,h,l){return t*(1-l)+h*l};m.log2=function(t){return Math.log(t)*u};m.positiveMod=p;m.radToByte=function(t){return p(t*D,256)};Object.defineProperty(m,
Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLabel":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey ../../../../webgl/enums".split(" "),function(m,p,D,B,u,t,h){return function(l){function e(){return l.apply(this,arguments)||this}m._inheritsLoose(e,l);var b=e.prototype;b.dispose=function(){};b.getGeometryType=function(){return D.WGLGeometryType.LABEL};
b.supportsSymbology=function(d){return!0};b.drawGeometry=function(d,a,c,f){const {context:g,painter:n,state:k,rendererInfo:x,requestRender:r,allowDelayedRender:v}=d,q=t.LabelMaterialKey.load(c.materialKey),y=q.mapAligned?1:0;if(y||!(1<=Math.abs(a.key.level-Math.round(100*d.displayLevel)/100))){var {bufferLayouts:A,attributes:w}=B.createProgramDescriptor(q.data,{geometry:[{location:0,name:"a_pos",count:2,type:h.DataType.SHORT},{location:1,name:"a_id",count:4,type:h.DataType.UNSIGNED_BYTE},{location:2,
name:"a_color",count:4,type:h.DataType.UNSIGNED_BYTE,normalized:!0},{location:3,name:"a_haloColor",count:4,type:h.DataType.UNSIGNED_BYTE,normalized:!0},{location:4,name:"a_texAndSize",count:4,type:h.DataType.UNSIGNED_BYTE},{location:5,name:"a_refSymbolAndPlacementOffset",count:4,type:h.DataType.UNSIGNED_BYTE},{location:6,name:"a_glyphData",count:4,type:h.DataType.UNSIGNED_BYTE},{location:7,name:"a_vertexOffset",count:2,type:h.DataType.SHORT},{location:8,name:"a_texCoords",count:2,type:h.DataType.UNSIGNED_SHORT}]});
f=n.materialManager.getMaterialProgram(d,q,"materials/label",w,f);if(v&&p.isSome(r)&&!f.compiled)r();else{d.context.setStencilFunction(h.CompareFunction.EQUAL,0,255);g.useProgram(f);this._setSharedUniforms(f,d,a);n.textureManager.bindTextures(g,f,q);var z=1===y?k.displayViewMat3:k.displayMat3;this._setSizeVVUniforms(q,f,x,a);f.setUniform1f("u_mapRotation",Math.floor(k.rotation/360*254));f.setUniform1f("u_mapAligned",y);f.setUniformMatrix3fv("u_displayMat3",z);f.setUniform1f("u_opacity",1);f.setUniform2fv("u_screenSize",
d.state.size);d=c.target.getVAO(g,A,w);a=c.indexFrom*Uint32Array.BYTES_PER_ELEMENT;g.bindVAO(d);f.setUniform1f("u_isHaloPass",0);f.setUniform1f("u_isBackgroundPass",1);g.drawElements(h.PrimitiveType.TRIANGLES,c.indexCount,h.DataType.UNSIGNED_INT,a);f.setUniform1f("u_isHaloPass",1);f.setUniform1f("u_isBackgroundPass",0);g.drawElements(h.PrimitiveType.TRIANGLES,c.indexCount,h.DataType.UNSIGNED_INT,a);f.setUniform1f("u_isHaloPass",0);f.setUniform1f("u_isBackgroundPass",0);g.drawElements(h.PrimitiveType.TRIANGLES,
c.indexCount,h.DataType.UNSIGNED_INT,a);g.setStencilTestEnabled(!0);g.setBlendingEnabled(!0)}}};return e}(u)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLine":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey ../../../../webgl/enums".split(" "),function(m,p,D,B,u,t,h){return function(l){function e(){return l.apply(this,arguments)||this}m._inheritsLoose(e,l);var b=e.prototype;b.dispose=
function(){};b.getGeometryType=function(){return D.WGLGeometryType.LINE};b.supportsSymbology=function(d){return!0};b.drawGeometry=function(d,a,c,f){const {context:g,painter:n,rendererInfo:k,displayLevel:x,passOptions:r,requestRender:v,allowDelayedRender:q}=d,y=t.LineMaterialKey.load(c.materialKey),A=p.isSome(r)&&"hittest"===r.type;var w=B.createProgramDescriptor(y.data,{geometry:[{location:0,name:"a_pos",count:2,type:h.DataType.SHORT},{location:1,name:"a_id",count:4,type:h.DataType.UNSIGNED_BYTE},
{location:2,name:"a_color",count:4,type:h.DataType.UNSIGNED_BYTE,normalized:!0},{location:3,name:"a_offsetAndNormal",count:4,type:h.DataType.BYTE},{location:4,name:"a_accumulatedDistanceAndHalfWidth",count:2,type:h.DataType.UNSIGNED_SHORT},{location:5,name:"a_tlbr",count:4,type:h.DataType.UNSIGNED_SHORT},{location:6,name:"a_segmentDirection",count:4,type:h.DataType.BYTE},{location:7,name:"a_aux",count:2,type:h.DataType.UNSIGNED_SHORT},{location:8,name:"a_zoomRange",count:2,type:h.DataType.UNSIGNED_SHORT}]});
let z=h.PrimitiveType.TRIANGLES;A&&(w=this._getTriangleDesc(c.materialKey,w),z=h.PrimitiveType.POINTS);const {attributes:C,bufferLayouts:E}=w;f=n.materialManager.getMaterialProgram(d,y,"materials/line",C,f);q&&p.isSome(v)&&!f.compiled?v():(w=1/d.pixelRatio,g.useProgram(f),this._setSharedUniforms(f,d,a),y.textureBinding&&n.textureManager.bindTextures(g,f,y),f.setUniform1f("u_zoomFactor",2**(x-a.key.level)),f.setUniform1f("u_blur",0+w),f.setUniform1f("u_antialiasing",w),this._setSizeVVUniforms(y,f,
k,a),this._setColorAndOpacityVVUniforms(y,f,k),g.setFaceCullingEnabled(!1),d=c.target.getVAO(g,E,C,A),a=c.indexCount,c=c.indexFrom*Uint32Array.BYTES_PER_ELEMENT,A&&(a/=3,c/=3),g.bindVAO(d),g.drawElements(z,a,h.DataType.UNSIGNED_INT,c))};return e}(u)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushText":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey ../../../../webgl/enums".split(" "),
function(m,p,D,B,u,t,h){return function(l){function e(){return l.apply(this,arguments)||this}m._inheritsLoose(e,l);var b=e.prototype;b.dispose=function(){};b.getGeometryType=function(){return D.WGLGeometryType.TEXT};b.supportsSymbology=function(d){return!0};b.drawGeometry=function(d,a,c,f){const {context:g,painter:n,rendererInfo:k,state:x,passOptions:r,requestRender:v,allowDelayedRender:q}=d,y=t.TextMaterialKey.load(c.materialKey),A=p.isSome(r)&&"hittest"===r.type,{bufferLayouts:w,attributes:z}=B.createProgramDescriptor(y.data,
{geometry:[{location:0,name:"a_pos",count:2,type:h.DataType.SHORT},{location:1,name:"a_id",count:4,type:h.DataType.UNSIGNED_BYTE},{location:2,name:"a_color",count:4,type:h.DataType.UNSIGNED_BYTE,normalized:!0},{location:3,name:"a_haloColor",count:4,type:h.DataType.UNSIGNED_BYTE,normalized:!0},{location:4,name:"a_texFontSize",count:4,type:h.DataType.UNSIGNED_BYTE},{location:5,name:"a_aux",count:4,type:h.DataType.BYTE},{location:6,name:"a_zoomRange",count:2,type:h.DataType.UNSIGNED_SHORT},{location:7,
name:"a_vertexOffset",count:2,type:h.DataType.SHORT},{location:8,name:"a_texCoords",count:2,type:h.DataType.UNSIGNED_SHORT}]});f=n.materialManager.getMaterialProgram(d,y,"materials/text",z,f);if(q&&p.isSome(v)&&!f.compiled)v();else{g.useProgram(f);var C=h.PrimitiveType.TRIANGLES;A&&(C=h.PrimitiveType.POINTS);this._setSharedUniforms(f,d,a);n.textureManager.bindTextures(g,f,y);f.setUniformMatrix3fv("u_displayMat3",x.displayMat3);f.setUniformMatrix3fv("u_displayViewMat3",x.displayViewMat3);this._setSizeVVUniforms(y,
f,k,a);this._setColorAndOpacityVVUniforms(y,f,k);this._setRotationVVUniforms(y,f,k);d=c.target.getVAO(g,w,z);a=c.indexFrom*Uint32Array.BYTES_PER_ELEMENT;f.setUniform1f("u_isHaloPass",0);f.setUniform1f("u_isBackgroundPass",1);g.bindVAO(d);g.drawElements(C,c.indexCount,h.DataType.UNSIGNED_INT,a);f.setUniform1f("u_isHaloPass",1);f.setUniform1f("u_isBackgroundPass",0);g.drawElements(h.PrimitiveType.TRIANGLES,c.indexCount,h.DataType.UNSIGNED_INT,a);f.setUniform1f("u_isHaloPass",0);f.setUniform1f("u_isBackgroundPass",
0);g.drawElements(C,c.indexCount,h.DataType.UNSIGNED_INT,a)}};return e}(u)})},"esri/views/2d/engine/vectorTiles/shaders/VTLMaterialManager":function(){define(["../enums","./Programs"],function(m,p){return function(){function D(){this._programByKey=new Map}var B=D.prototype;B.dispose=function(){this._programByKey.forEach(u=>u.dispose());this._programByKey.clear()};B.getMaterialProgram=function(u,t,h){const l=t.key<<3|this._getMaterialOptionsValue(t.type,h);if(this._programByKey.has(l))return this._programByKey.get(l);
var e=this._getProgramTemplate(t.type);({shaders:e}=e);const {vertexShader:b,fragmentShader:d}=e(h);h=t.getShaderHeader();e=t.getShaderMain();h=b.replace("#pragma header",h).replace("#pragma main",e);u=u.programCache.acquire(h,d,t.getAttributeLocations());this._programByKey.set(l,u);return u};B._getMaterialOptionsValue=function(u,t){switch(u){case m.ShaderProgramType.BACKGROUND:return(t.pattern?1:0)<<1|(t.id?1:0);case m.ShaderProgramType.FILL:return(t.pattern?1:0)<<1|(t.id?1:0);case m.ShaderProgramType.OUTLINE:return t.id?
1:0;case m.ShaderProgramType.LINE:return(t.sdf?1:0)<<2|(t.pattern?1:0)<<1|(t.id?1:0);case m.ShaderProgramType.ICON:return(t.sdf?1:0)<<1|(t.id?1:0);case m.ShaderProgramType.CIRCLE:return t.id?1:0;case m.ShaderProgramType.TEXT:return t.id?1:0;default:return 0}};B._getProgramTemplate=function(u){switch(u){case m.ShaderProgramType.BACKGROUND:return p.background;case m.ShaderProgramType.CIRCLE:return p.circle;case m.ShaderProgramType.FILL:return p.fill;case m.ShaderProgramType.ICON:return p.icon;case m.ShaderProgramType.LINE:return p.line;
case m.ShaderProgramType.OUTLINE:return p.outline;case m.ShaderProgramType.TEXT:return p.text;default:return null}};return D}()})},"esri/views/2d/engine/vectorTiles/enums":function(){define(["exports"],function(m){m.BucketType=void 0;(function(p){p[p.FILL=1]="FILL";p[p.LINE=2]="LINE";p[p.SYMBOL=3]="SYMBOL";p[p.CIRCLE=4]="CIRCLE"})(m.BucketType||(m.BucketType={}));m.ShaderProgramType=void 0;(function(p){p[p.BACKGROUND=0]="BACKGROUND";p[p.FILL=1]="FILL";p[p.OUTLINE=2]="OUTLINE";p[p.LINE=3]="LINE";p[p.ICON=
4]="ICON";p[p.CIRCLE=5]="CIRCLE";p[p.TEXT=6]="TEXT";p[p.TILEINFO=7]="TILEINFO"})(m.ShaderProgramType||(m.ShaderProgramType={}));m.StyleUpdateType=void 0;(function(p){p[p.PAINTER_CHANGED=0]="PAINTER_CHANGED";p[p.LAYOUT_CHANGED=1]="LAYOUT_CHANGED";p[p.LAYER_CHANGED=2]="LAYER_CHANGED";p[p.LAYER_REMOVED=3]="LAYER_REMOVED";p[p.SPRITES_CHANGED=4]="SPRITES_CHANGED"})(m.StyleUpdateType||(m.StyleUpdateType={}));Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/shaders/Programs":function(){define(["exports",
"./sources/resolver","../../../../webgl/programUtils"],function(m,p,D){m.background={shaders:B=>({vertexShader:D.glslifyDefineMap({ID:B.id,PATTERN:B.pattern})+p.resolveIncludes("background/background.vert"),fragmentShader:D.glslifyDefineMap({ID:B.id,PATTERN:B.pattern})+p.resolveIncludes("background/background.frag")})};m.circle={shaders:B=>({vertexShader:D.glslifyDefineMap({ID:B.id})+p.resolveIncludes("circle/circle.vert"),fragmentShader:D.glslifyDefineMap({ID:B.id})+p.resolveIncludes("circle/circle.frag")})};
m.fill={shaders:B=>({vertexShader:D.glslifyDefineMap({ID:B.id,PATTERN:B.pattern})+p.resolveIncludes("fill/fill.vert"),fragmentShader:D.glslifyDefineMap({ID:B.id,PATTERN:B.pattern})+p.resolveIncludes("fill/fill.frag")})};m.icon={shaders:B=>({vertexShader:D.glslifyDefineMap({ID:B.id,SDF:B.sdf})+p.resolveIncludes("icon/icon.vert"),fragmentShader:D.glslifyDefineMap({ID:B.id,SDF:B.sdf})+p.resolveIncludes("icon/icon.frag")})};m.line={shaders:B=>({vertexShader:D.glslifyDefineMap({ID:B.id,PATTERN:B.pattern,
SDF:B.sdf})+p.resolveIncludes("line/line.vert"),fragmentShader:D.glslifyDefineMap({ID:B.id,PATTERN:B.pattern,SDF:B.sdf})+p.resolveIncludes("line/line.frag")})};m.outline={shaders:B=>({vertexShader:D.glslifyDefineMap({ID:B.id})+p.resolveIncludes("outline/outline.vert"),fragmentShader:D.glslifyDefineMap({ID:B.id})+p.resolveIncludes("outline/outline.frag")})};m.text={shaders:B=>({vertexShader:D.glslifyDefineMap({ID:B.id})+p.resolveIncludes("text/text.vert"),fragmentShader:D.glslifyDefineMap({ID:B.id})+
p.resolveIncludes("text/text.frag")})};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/shaders/sources/resolver":function(){define(["exports","./shaderRepository","../../../../../webgl/ShaderCompiler"],function(m,p,D){const B=new D.ShaderCompiler(function(u){let t=p;u.split("/").forEach(h=>{t&&(t=t[h])});return t});m.resolveIncludes=function(u){return B.resolveIncludes(u)};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/shaders/sources/shaderRepository":function(){define(function(){return{background:{"background.frag":"#ifdef PATTERN\nuniform lowp float u_opacity;\nuniform lowp sampler2D u_texture;\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_tileTextureCoord;\n#else\nuniform lowp vec4 u_color;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main() {\n#ifdef PATTERN\nmediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\nmediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\nlowp vec4 color \x3d texture2D(u_texture, samplePos);\ngl_FragColor \x3d u_opacity * color;\n#else\ngl_FragColor \x3d u_color;\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"background.vert":"precision mediump float;\nattribute vec2 a_pos;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_coord_range;\nuniform mediump float u_depth;\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix;\nvarying mediump vec2 v_tileTextureCoord;\nuniform mediump vec4 u_tlbr;\nuniform mediump vec2 u_mosaicSize;\nvarying mediump vec4 v_tlbr;\n#endif\nvoid main() {\ngl_Position \x3d vec4((u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0)).xy, u_depth, 1.0);\n#ifdef PATTERN\nv_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\nv_tlbr             \x3d u_tlbr / u_mosaicSize.xyxy;\n#endif\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\n}"},
circle:{"circle.frag":"precision lowp float;\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nmediump float dist \x3d length(v_offset);\nmediump float alpha \x3d smoothstep(0.0, -v_blur, dist - 1.0);\nlowp float color_mix_ratio \x3d v_stroke_width \x3c 0.01 ? 0.0 : smoothstep(-v_blur, 0.0, dist - v_radius / (v_radius + v_stroke_width));\ngl_FragColor \x3d alpha * mix(v_color, v_stroke_color, color_mix_ratio);\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"circle.vert":"precision mediump float;\nattribute vec2 a_pos;\n#pragma header\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_circleTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_antialiasingWidth;\nvoid main()\n{\n#pragma main\nv_color \x3d color * opacity;\nv_stroke_color \x3d stroke_color * stroke_opacity;\nv_stroke_width \x3d stroke_width;\nv_radius \x3d radius;\nv_blur \x3d max(blur, u_antialiasingWidth / (radius + stroke_width));\nmediump vec2 offset \x3d vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\nv_offset \x3d offset;\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos * 0.5, 1.0) + u_displayMat3 * vec3((v_radius + v_stroke_width) * offset + u_circleTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
fill:{"fill.frag":"precision lowp float;\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\nvarying mediump vec2 v_tileTextureCoord;\nvarying mediump vec4 v_tlbr;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvec4 mixColors(vec4 color1, vec4 color2) {\nfloat compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\nvec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\nreturn vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef PATTERN\nmediump vec2 normalizedTextureCoord \x3d fract(v_tileTextureCoord);\nmediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\nlowp vec4 color \x3d texture2D(u_texture, samplePos);\ngl_FragColor \x3d v_color[3] * color;\n#else\ngl_FragColor \x3d v_color;\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"fill.vert":"precision mediump float;\nattribute vec2 a_pos;\n#pragma header\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_fillTranslation;\n#ifdef PATTERN\n#include \x3cutil/util.glsl\x3e\nuniform mediump vec2 u_mosaicSize;\nuniform mediump float u_patternFactor;\nvarying mediump vec2 v_tileTextureCoord;\nvarying mediump vec4 v_tlbr;\n#endif\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvoid main()\n{\n#pragma main\nv_color \x3d color * opacity;\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\n#ifdef PATTERN\nfloat patternWidth \x3d nextPOT(tlbr.z - tlbr.x);\nfloat patternHeight \x3d nextPOT(tlbr.w - tlbr.y);\nfloat scaleX \x3d 1.0 / (patternWidth * u_patternFactor);\nfloat scaleY \x3d 1.0 / (patternHeight * u_patternFactor);\nmat3 patterMat \x3d mat3(scaleX, 0.0,    0.0,\n0.0,    -scaleY, 0.0,\n0.0,    0.0,    1.0);\nv_tileTextureCoord \x3d (patterMat * vec3(a_pos, 1.0)).xy;\nv_tlbr             \x3d tlbr / u_mosaicSize.xyxy;\n#endif\nvec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(u_fillTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
icon:{"icon.frag":"precision mediump float;\nuniform lowp sampler2D u_texture;\n#ifdef SDF\nuniform lowp vec4 u_color;\nuniform lowp vec4 u_outlineColor;\n#endif\nvarying mediump vec2 v_tex;\nvarying lowp float v_opacity;\nvarying mediump vec2 v_size;\nvarying lowp vec4 v_color;\n#ifdef SDF\nvarying mediump flaot v_halo_width;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\n#include \x3cutil/encoding.glsl\x3e\nvec4 mixColors(vec4 color1, vec4 color2) {\nfloat compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\nvec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\nreturn vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef SDF\nlowp vec4 fillPixelColor \x3d v_color;\nfloat d \x3d rgba2float(texture2D(u_texture, v_tex)) - 0.5;\nconst float softEdgeRatio \x3d 0.248062016;\nfloat size \x3d max(v_size.x, v_size.y);\nfloat dist \x3d d * softEdgeRatio * size;\nfillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\nif (v_halo_width \x3e 0.25) {\nlowp vec4 outlinePixelColor \x3d u_outlineColor;\nconst float outlineLimitRatio \x3d (16.0 / 86.0);\nfloat clampedOutlineSize \x3d softEdgeRatio * min(v_halo_width, outlineLimitRatio * max(v_size.x, v_size.y));\noutlinePixelColor *\x3d clamp(0.5 - (abs(dist) - clampedOutlineSize), 0.0, 1.0);\ngl_FragColor \x3d v_opacity * mixColors(fillPixelColor, outlinePixelColor);\n}\nelse {\ngl_FragColor \x3d v_opacity * fillPixelColor;\n}\n#else\nlowp vec4 texColor \x3d texture2D(u_texture, v_tex);\ngl_FragColor \x3d v_opacity * texColor;\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"icon.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texAngleRange;\nattribute vec4 a_levelInfo;\nattribute float a_opacityInfo;\n#pragma header\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\n#ifdef SDF\nvarying mediump float v_halo_width;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_iconTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeDuration;\nvarying mediump vec2 v_tex;\nvarying lowp float v_opacity;\nvarying mediump vec2 v_size;\nconst float C_OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\nconst float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float tileCoordRatio \x3d 1.0 / 8.0;\nuniform highp float u_time;\nvoid main()\n{\n#pragma main\nv_color \x3d color;\nv_opacity \x3d opacity;\n#ifdef SDF\nv_halo_width \x3d halo_width;\n#endif\nfloat modded \x3d mod(a_opacityInfo, 128.0);\nfloat targetOpacity \x3d (a_opacityInfo - modded) / 128.0;\nfloat startOpacity \x3d modded / 127.0;\nfloat interpolatedOpacity \x3d clamp(startOpacity + 2.0 * (targetOpacity - 0.5) * u_time / u_fadeDuration, 0.0, 1.0);\nv_opacity *\x3d interpolatedOpacity;\nmediump float a_angle         \x3d a_levelInfo[1];\nmediump float a_minLevel      \x3d a_levelInfo[2];\nmediump float a_maxLevel      \x3d a_levelInfo[3];\nmediump vec2 a_tex            \x3d a_texAngleRange.xy;\nmediump float delta_z \x3d 0.0;\nmediump float rotated \x3d mod(a_angle + u_mapRotation, 256.0);\ndelta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(64.0, rotated) * (1.0 - step(192.0, rotated));\ndelta_z +\x3d 1.0 - step(a_minLevel, u_level);\ndelta_z +\x3d step(a_maxLevel, u_level);\ndelta_z +\x3d step(v_opacity, 0.0);\nvec2 offset \x3d C_OFFSET_PRECISION * a_vertexOffset;\nv_size \x3d abs(offset);\n#ifdef SDF\noffset \x3d (120.0 / 86.0) * offset;\n#endif\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayViewMat3 * vec3(size * offset, 0.0) + u_displayMat3 * vec3(u_iconTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\nv_tex \x3d a_tex.xy / u_mosaicSize;\n}"},
line:{"line.frag":"precision lowp float;\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nvarying mediump float v_lineHalfWidth;\nvarying lowp vec4 v_color;\nvarying mediump float v_blur;\n#if defined (PATTERN) || defined(SDF)\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\nvarying mediump float v_widthRatio;\nuniform sampler2D u_texture;\nuniform mediump float u_antialiasing;\n#endif\n#ifdef SDF\n#include \x3cutil/encoding.glsl\x3e\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nmediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\nlowp float alpha \x3d clamp((v_lineHalfWidth - fragDist) / v_blur, 0.0, 1.0);\n#ifdef PATTERN\nmediump float relativeTexX \x3d fract(v_accumulatedDistance / (v_patternSize.x * v_widthRatio));\nmediump float relativeTexY \x3d 0.5 + v_normal.y * v_lineHalfWidth / (v_patternSize.y * v_widthRatio);\nmediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\nlowp vec4 color \x3d texture2D(u_texture, texCoord);\ngl_FragColor \x3d alpha * v_color[3] * color;\n#elif defined(SDF)\nmediump float relativeTexX \x3d fract((v_accumulatedDistance * 0.5) / (v_patternSize.x * v_widthRatio));\nmediump float relativeTexY \x3d  0.5 + 0.25 * v_normal.y;\nmediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\nmediump float d \x3d rgba2float(texture2D(u_texture, texCoord)) - 0.5;\nfloat dist \x3d d * (v_lineHalfWidth + u_antialiasing / 2.0);\ngl_FragColor \x3d alpha * clamp(0.5 - dist, 0.0, 1.0) * v_color;\n#else\ngl_FragColor \x3d alpha * v_color;\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"line.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec4 a_extrude_offset;\nattribute vec4 a_dir_normal;\nattribute vec2 a_accumulatedDistance;\n#pragma header\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump float u_zoomFactor;\nuniform mediump vec2 u_lineTranslation;\nuniform mediump float u_antialiasing;\nuniform mediump float u_depth;\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nconst float scale \x3d 1.0 / 31.0;\nconst mediump float tileCoordRatio \x3d 8.0;\n#if defined (SDF)\nconst mediump float sdfPatternHalfWidth \x3d 15.5;\n#endif\n#if defined (PATTERN) || defined(SDF)\nuniform mediump vec2 u_mosaicSize;\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\nvarying mediump float v_widthRatio;\n#endif\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvarying mediump float v_lineHalfWidth;\nvarying mediump float v_blur;\nvoid main()\n{\n#pragma main\nv_color \x3d color * opacity;\nv_blur \x3d blur + u_antialiasing;\nv_normal \x3d a_dir_normal.zw * scale;\n#if defined (PATTERN) || defined(SDF)\nv_tlbr          \x3d tlbr / u_mosaicSize.xyxy;\nv_patternSize   \x3d vec2(tlbr.z - tlbr.x, tlbr.y - tlbr.w);\n#if defined (PATTERN)\nv_widthRatio \x3d width / v_patternSize.y;\n#else\nv_widthRatio \x3d width / sdfPatternHalfWidth / 2.0;\n#endif\n#endif\nv_lineHalfWidth \x3d (width + u_antialiasing) * 0.5;\nmediump vec2 dir \x3d a_dir_normal.xy * scale;\nmediump vec2 offset_ \x3d a_extrude_offset.zw * scale * offset;\nmediump vec2 dist \x3d v_lineHalfWidth * scale * a_extrude_offset.xy;\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos + offset_ * tileCoordRatio / u_zoomFactor, 1.0) + u_displayViewMat3 * vec3(dist, 0.0) + u_displayMat3 * vec3(u_lineTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n#if defined (PATTERN) || defined(SDF)\nv_accumulatedDistance \x3d a_accumulatedDistance.x * u_zoomFactor / tileCoordRatio + dot(dir, dist + offset_);\n#endif\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\n}"},
outline:{"outline.frag":"varying lowp vec4 v_color;\nvarying mediump vec2 v_normal;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nlowp float dist \x3d abs(v_normal.y);\nlowp float alpha \x3d smoothstep(1.0, 0.0, dist);\ngl_FragColor \x3d alpha * v_color;\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}","outline.vert":"attribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_xnormal;\n#pragma header\nvarying lowp vec4 v_color;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_fillTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_outline_width;\nvarying lowp vec2 v_normal;\nconst float scale \x3d 1.0 / 15.0;\nvoid main()\n{\n#pragma main\nv_color \x3d color * opacity;\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\nv_normal \x3d a_xnormal;\nmediump vec2 dist \x3d u_outline_width * scale * a_offset;\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(dist + u_fillTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
text:{"text.frag":"uniform lowp sampler2D u_texture;\nvarying lowp vec2 v_tex;\nvarying lowp vec4 v_color;\nvarying mediump float v_edgeWidth;\nvarying mediump float v_edgeDistance;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nlowp float dist \x3d texture2D(u_texture, v_tex).a;\nmediump float alpha \x3d smoothstep(v_edgeDistance - v_edgeWidth, v_edgeDistance + v_edgeWidth, dist);\ngl_FragColor \x3d alpha * v_color;\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"text.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texAngleRange;\nattribute vec4 a_levelInfo;\nattribute float a_opacityInfo;\n#pragma header\nvarying lowp vec4 v_color;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_textTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeDuration;\nvarying lowp vec2 v_tex;\nconst float offsetPrecision \x3d 1.0 / 8.0;\nconst mediump float edgePos \x3d 0.75;\nuniform mediump float u_antialiasingWidth;\nvarying mediump float v_edgeDistance;\nvarying mediump float v_edgeWidth;\nuniform lowp float u_halo;\nconst float sdfFontScale \x3d 1.0 / 24.0;\nconst float sdfPixel \x3d 3.0;\nuniform highp float u_time;\nvoid main()\n{\n#pragma main\nif (u_halo \x3e 0.5)\n{\nv_color \x3d halo_color * opacity;\nhalo_width *\x3d sdfPixel;\nhalo_blur *\x3d sdfPixel;\n}\nelse\n{\nv_color \x3d color * opacity;\nhalo_width \x3d 0.0;\nhalo_blur \x3d 0.0;\n}\nfloat modded \x3d mod(a_opacityInfo, 128.0);\nfloat targetOpacity \x3d (a_opacityInfo - modded) / 128.0;\nfloat startOpacity \x3d modded / 127.0;\nfloat interpolatedOpacity \x3d clamp(startOpacity + 2.0 * (targetOpacity - 0.5) * u_time / u_fadeDuration, 0.0, 1.0);\nv_color *\x3d interpolatedOpacity;\nmediump float a_angle       \x3d a_levelInfo[1];\nmediump float a_minLevel    \x3d a_levelInfo[2];\nmediump float a_maxLevel    \x3d a_levelInfo[3];\nmediump vec2 a_tex          \x3d a_texAngleRange.xy;\nmediump float a_visMinAngle    \x3d a_texAngleRange.z;\nmediump float a_visMaxAngle    \x3d a_texAngleRange.w;\nmediump float delta_z \x3d 0.0;\nmediump float angle \x3d mod(a_angle + u_mapRotation, 256.0);\nif (a_visMinAngle \x3c a_visMaxAngle)\n{\ndelta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * (step(a_visMaxAngle, angle) + (1.0 - step(a_visMinAngle, angle)));\n}\nelse\n{\ndelta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * (step(a_visMaxAngle, angle) * (1.0 - step(a_visMinAngle, angle)));\n}\ndelta_z +\x3d 1.0 - step(a_minLevel, u_level);\ndelta_z +\x3d step(a_maxLevel, u_level);\ndelta_z +\x3d step(v_color[3], 0.0);\nv_tex \x3d a_tex.xy / u_mosaicSize;\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\nv_edgeDistance \x3d edgePos - halo_width / size;\nv_edgeWidth \x3d (u_antialiasingWidth + halo_blur) / size;\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + sdfFontScale * u_displayViewMat3 * vec3(offsetPrecision * size * a_vertexOffset, 0.0) + u_displayMat3 * vec3(u_textTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n}"},
util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n255.0 / (256.0),\n255.0 / (256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n);\nfloat rgba2float(vec4 rgba) {\nreturn dot(rgba, rgba2float_factors);\n}","util.glsl":"float nextPOT(in float x) {\nreturn pow(2.0, ceil(log2(abs(x))));\n}"}}})},"esri/views/2d/engine/webgl/BitBlitRenderer":function(){define("exports ../../../../core/maybe ./DefaultVertexAttributeLayouts ./shaders/BitBlitPrograms ../../../webgl/BufferObject ../../../webgl/enums ../../../webgl/ProgramTemplate ../../../webgl/VertexArrayObject".split(" "),
function(m,p,D,B,u,t,h,l){let e=function(){function b(){this._initialized=!1}var d=b.prototype;d.dispose=function(){this._program=p.disposeMaybe(this._program);this._vertexArrayObject=p.disposeMaybe(this._vertexArrayObject)};d.render=function(a,c,f,g){a&&(this._initialized||this._initialize(a),a.setBlendFunctionSeparate(t.BlendFactor.ONE,t.BlendFactor.ONE_MINUS_SRC_ALPHA,t.BlendFactor.ONE,t.BlendFactor.ONE_MINUS_SRC_ALPHA),a.bindVAO(this._vertexArrayObject),a.useProgram(this._program),c.setSamplingMode(f),
a.bindTexture(c,0),this._program.setUniform1i("u_tex",0),this._program.setUniform1f("u_opacity",g),a.drawArrays(t.PrimitiveType.TRIANGLE_STRIP,0,4),a.bindTexture(null,0),a.bindVAO())};d._initialize=function(a){if(this._initialized)return!0;const c=h.createProgram(a,B.bitBlit);if(!c)return!1;const f=new Int8Array(16);f[0]=-1;f[1]=-1;f[2]=0;f[3]=0;f[4]=1;f[5]=-1;f[6]=1;f[7]=0;f[8]=-1;f[9]=1;f[10]=0;f[11]=1;f[12]=1;f[13]=1;f[14]=1;f[15]=1;a=new l.VertexArrayObject(a,B.bitBlit.attributes,D.PosTex2b,{geometry:u.BufferObject.createVertex(a,
t.Usage.STATIC_DRAW,f)});this._program=c;this._vertexArrayObject=a;return this._initialized=!0};return b}();m.BitBlitRenderer=e;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/shaders/BitBlitPrograms":function(){define(["exports","./sources/resolver"],function(m,p){p={shaders:{vertexShader:p.resolveIncludes("bitBlit/bitBlit.vert"),fragmentShader:p.resolveIncludes("bitBlit/bitBlit.frag")},attributes:new Map([["a_pos",0],["a_tex",1]])};m.bitBlit=p;Object.defineProperty(m,
Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/MaterialManager":function(){define(["../../../../core/maybe","./enums","./shaders/MaterialPrograms"],function(m,p,D){const B=({rendererInfo:t,drawPhase:h},l,e)=>`${l.getVariationHash()}-${(h===p.WGLDrawPhase.HITTEST||h===p.WGLDrawPhase.LABEL_ALPHA?1:0)|(h===p.WGLDrawPhase.HIGHLIGHT?2:0)}-${t.getVariationHash()}-${m.isSome(e)&&e.join(".")}`,u=(t,h,l,e={})=>{e={...e};h={...h.getVariation()};var b={...t.rendererInfo.getVariation()},
d=t.drawPhase;e={...e,...h,...b,highlight:t.drawPhase===p.WGLDrawPhase.HIGHLIGHT,id:d===p.WGLDrawPhase.HITTEST||d===p.WGLDrawPhase.LABEL_ALPHA};if(m.isSome(l))for(const a of l)e[a]=!0;return e};return function(){function t(l){this._rctx=l;this._programByKey=new Map}var h=t.prototype;h.dispose=function(){this._programByKey.forEach(l=>l.dispose());this._programByKey.clear()};h.getProgram=function(l,e=[]){const b=l.vsPath+"."+l.fsPath+JSON.stringify(e);if(this._programByKey.has(b))return this._programByKey.get(b);
e={...e.map(f=>"string"===typeof f?{name:f,value:!0}:f).reduce((f,g)=>({...f,[g.name]:g.value}),{})};const {vsPath:d,fsPath:a,attributes:c}=l;l=D.createProgramTemplate(d,a,c,e);l=this._rctx.programCache.acquire(l.shaders.vertexShader,l.shaders.fragmentShader,l.attributes);if(!l)throw Error("Unable to get program for key: ${key}");this._programByKey.set(b,l);return l};h.getMaterialProgram=function(l,e,b,d,a){const c=B(l,e,a);if(this._programByKey.has(c))return this._programByKey.get(c);l=u(l,e,a,{ignoresSamplerPrecision:l.context.driverTest.ignoresSamplerPrecision.result});
b=D.createProgramTemplate(b,b,d,l);b=this._rctx.programCache.acquire(b.shaders.vertexShader,b.shaders.fragmentShader,b.attributes);if(!b)throw Error("Unable to get program for key: ${key}");this._programByKey.set(c,b);return b};return t}()})},"esri/views/2d/engine/webgl/shaders/MaterialPrograms":function(){define(["exports","./sources/resolver","../../../../webgl/programUtils"],function(m,p,D){m.createProgramTemplate=(B,u,t,h)=>{B+=B.substring(B.lastIndexOf("/"));u+=u.substring(u.lastIndexOf("/"));
const l={};for(const b in h){let d=void 0;var e=b;d=""+e[0].toUpperCase();for(let a=1;a<e.length;a++){const c=e[a];c===c.toUpperCase()?(d+="_",d+=c):d+=c.toUpperCase()}l[d]=h[b]}h=D.glslifyDefineMap(l);return{attributes:t,shaders:{vertexShader:h+p.resolveIncludes(`${B}.vert`),fragmentShader:h+p.resolveIncludes(`${u}.frag`)}}};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/TextureManager":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../config ../../../../request ../../../../core/BidiText ../../../../core/Error ../../../../core/fontUtils ../../../../core/Logger ../../../../core/mathUtils ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/screenUtils ../../../../chunks/vec2 ../../../../chunks/vec2f32 ../../../../symbols/cim/Rasterizer ./definitions ./enums ./GlyphMosaic ./GlyphSource ./SDFConverter ./SpriteMosaic ./Utils ./animatedFormats/AnimatableTextureResource ./animatedFormats/utils ./util/Result ./util/symbolUtils ../../../support/QueueProcessor ../../../webgl/enums".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d,a,c,f,g,n,k,x,r,v,q,y,A,w,z,C,E){function F(K,M){M=Math.round(d.pt2px(M)*window.devicePixelRatio);return Math.min(K,M*(128<=M?2:4))}const G=c.create(),H=h.getLogger("esri.views.2d.engine.webgl.TextureManager");let L=function(){function K(M,U,T){this.mosaicType=M;this.page=U;this.sdf=T}K.fromMosaic=function(M,U){return new K(M,U.page,U.sdf)};return K}();return function(){function K(U,T,Z){this._requestRender=U;this.resourceManager=T;this._allowNonPowerOfTwo=Z;this._invalidFontsMap=
new Map;this._sdfConverter=new r(126);this._bindingInfos=[];this._hashToBindingIndex=new Map;this._ongoingRasterizations=new Map;this._imageRequestQueue=new C.QueueProcessor({concurrency:10,process:function(){var X=m._asyncToGenerator(function*(ca,P){b.throwIfAborted(P);try{return yield D(ca,{responseType:"image",signal:P})}catch(J){if(!b.isAbortError(J))throw new u("mapview-invalid-resource",`Could not fetch requested resource at ${ca}`,J);throw J;}});return function(ca,P){return X.apply(this,arguments)}}()});
this._spriteMosaic=new v(2048,2048,500);this._glyphSource=new x(`${p.fontsUrl}/{fontstack}/{range}.pbf`);this._glyphMosaic=new k(1024,1024,this._glyphSource);this._rasterizer=new f(T)}var M=K.prototype;M.dispose=function(){this._spriteMosaic.dispose();this._glyphMosaic.dispose();this._rasterizer.dispose();this._sdfConverter.dispose();this._sdfConverter=this._glyphMosaic=this._spriteMosaic=null;this._hashToBindingIndex.clear();this._bindingInfos=this._hashToBindingIndex=null;this._ongoingRasterizations.clear();
this._ongoingRasterizations=null;this._imageRequestQueue.clear();this._imageRequestQueue=null};M.rasterizeItem=function(){var U=m._asyncToGenerator(function*(T,Z,X,ca){if(e.isNone(T))return H.error(new u("mapview-null-resource","Unable to rasterize null resource",void 0)),null;switch(T.type){case "text":case "esriTS":return T=yield this._rasterizeText(T,X,ca),T.forEach(P=>this._setTextureBinding(n.MosaicType.GLYPH,P)),{glyphMosaicItems:T};default:if(q.is3D(T))return H.error(new u("mapview-invalid-type",
`MapView does not support symbol type: ${T.type}`,T)),null;T=yield this._rasterizeSpriteSymbol(T,Z,ca);w.ok(T)&&T&&this._setTextureBinding(n.MosaicType.SPRITE,T);return{spriteMosaicItem:T}}});return function(T,Z,X,ca){return U.apply(this,arguments)}}();M.bindTextures=function(U,T,Z,X=!1){if(0!==Z.textureBinding){var ca=this._bindingInfos[Z.textureBinding-1];Z=ca.page;X=X?E.TextureSamplingMode.LINEAR_MIPMAP_LINEAR:E.TextureSamplingMode.LINEAR;switch(ca.mosaicType){case n.MosaicType.SPRITE:ca=this.sprites.getWidth(Z);
const P=this.sprites.getHeight(Z);ca=a.set(G,ca,P);this._spriteMosaic.bind(U,X,Z,g.TEXTURE_BINDING_SPRITE_ATLAS);T.setUniform1i("u_texture",g.TEXTURE_BINDING_SPRITE_ATLAS);T.setUniform2fv("u_mosaicSize",ca);break;case n.MosaicType.GLYPH:ca=a.set(G,this.glyphs.width,this.glyphs.height);this._glyphMosaic.bind(U,X,Z,g.TEXTURE_BINDING_GLYPH_ATLAS);T.setUniform1i("u_texture",g.TEXTURE_BINDING_GLYPH_ATLAS);T.setUniform2fv("u_mosaicSize",ca);break;default:H.error("mapview-texture-manager",`Cannot handle unknown type ${ca.mosaicType}`)}}};
M._hashMosaic=function(U,T){return 1|U<<1|(T.sdf?1:0)<<2|T.page<<3};M._setTextureBinding=function(U,T){const Z=this._hashMosaic(U,T);this._hashToBindingIndex.has(Z)||(U=L.fromMosaic(U,T),this._hashToBindingIndex.set(Z,this._bindingInfos.length+1),this._bindingInfos.push(U));T.textureBinding=this._hashToBindingIndex.get(Z)};M._rasterizeText=function(){var U=m._asyncToGenerator(function*(T,Z,X){let ca,P;ca="cim"in T?T.fontName:t.getFullyQualifiedFontName(T.font);P=T.text;T=this._invalidFontsMap.has(ca);
Z=Z?Z:q.charCodes(B.bidiText(P)[0]);try{return yield this._glyphMosaic.getGlyphItems(T?"arial-unicode-ms-regular":ca,Z,X)}catch(J){return H.error(new u("mapview-invalid-resource",`Couldn't find font ${ca}. Falling back to Arial Unicode MS Regular`,void 0)),this._invalidFontsMap.set(ca,!0),this._glyphMosaic.getGlyphItems("arial-unicode-ms-regular",Z,X)}});return function(T,Z,X){return U.apply(this,arguments)}}();M._rasterizeSpriteSymbol=function(){var U=m._asyncToGenerator(function*(T,Z,X){if(!q.isSimple(T)){Z=
z.keyFromSymbol(T);if(this._spriteMosaic.has(Z))return this._spriteMosaic.getSpriteItem(Z);if(q.isSVGResource(T)||q.isImageResource(T)&&!q.isMarkerPlacementInsidePolygon(T))return this._handleAsyncResource(Z,T,X);if(X=this._rasterizer.rasterizeJSONResource(T,g.PATTERN_FILL_RASTERIZATION_SCALE)){const {size:ca,image:P,sdf:J,simplePattern:N,rasterizationScale:S}=X;return this._addItemToMosaic(Z,ca,{type:"static",data:P},q.shouldRepeat(T),J,N,S)}return new u("TextureManager","unrecognized or null rasterized image")}});
return function(T,Z,X){return U.apply(this,arguments)}}();M._handleAsyncResource=function(){var U=m._asyncToGenerator(function*(T,Z,X){if(this._ongoingRasterizations.has(T))return this._ongoingRasterizations.get(T);Z=q.isSVGResource(Z)?this._handleSVG(Z,T,X):this._handleImage(Z,T,X);this._ongoingRasterizations.set(T,Z);try{yield Z,this._ongoingRasterizations.delete(T)}catch{this._ongoingRasterizations.delete(T)}return Z});return function(T,Z,X){return U.apply(this,arguments)}}();M._handleSVG=function(){var U=
m._asyncToGenerator(function*(T,Z,X){T=yield this._sdfConverter.draw(T.path,X);return this._addItemToMosaic(Z,[126,126],{type:"static",data:new Uint32Array(T.buffer)},!1,!0,!0)});return function(T,Z,X){return U.apply(this,arguments)}}();M._handleGIFOrPNG=function(){var U=m._asyncToGenerator(function*(T,Z,X){var ca=q.getUrl(T);yield this.resourceManager.fetchResource(ca,X);X=this.resourceManager.getResource(ca);if(e.isNone(X))return new u("mapview-invalid-resource",`Could not fetch requested resource at ${ca}.`);
ca=X.width;let P=X.height;if(X instanceof HTMLImageElement){"esriPMS"===T.type&&(ca=Math.round(F(X.width,q.getPMSResourceSize(T))),P=Math.round(ca/X.width*X.height));const {size:J,sdf:N,image:S}=this._rasterizer.rasterizeImageResource(ca,P,X,"cim"in T?T.cim.colorSubstitutions:void 0);return this._addItemToMosaic(Z,J,{type:"static",data:S},q.shouldRepeat(T),N,!1)}this._allowNonPowerOfTwo||(ca=l.nextPowerOfTwo(X.width+2*g.SPRITE_PADDING)-2*g.SPRITE_PADDING,P=l.nextPowerOfTwo(X.height+2*g.SPRITE_PADDING)-
2*g.SPRITE_PADDING);if(ca!==X.width||P!==X.height)X=A.resize(X,ca,P);X=new y.AnimatableTextureResource(X,this._requestRender,T.animatedSymbolProperties||{},T.objectId);return this._addItemToMosaic(Z,[X.width,X.height],{type:"animated",data:X},q.shouldRepeat(T),!1,!1)});return function(T,Z,X){return U.apply(this,arguments)}}();M._handleImage=function(){var U=m._asyncToGenerator(function*(T,Z,X){if(q.isGIF(T)||q.isPNG(T))return this._handleGIFOrPNG(T,Z,X);const ca=q.getUrl(T);try{let P;const J=this.resourceManager.getResource(ca);
if(e.isSome(J)&&J instanceof HTMLImageElement)P=J;else{const {data:aa}=yield this._imageRequestQueue.push(ca,{...X});P=aa}if(q.isSVGImage(ca))if("width"in T&&"height"in T)P.width=d.pt2px(T.width),P.height=d.pt2px(T.height);else if("cim"in T){const aa=T.cim;P.width=d.pt2px(aa.width??aa.scaleX*aa.size);P.height=d.pt2px(aa.size)}if(!P.width||!P.height)return null;let N=P.width,S=P.height;"esriPMS"===T.type&&(N=Math.round(F(P.width,q.getPMSResourceSize(T))),S=Math.round(N/P.width*P.height));const {size:Q,
sdf:Y,image:ba}=this._rasterizer.rasterizeImageResource(N,S,P,"cim"in T?T.cim.colorSubstitutions:void 0);return this._addItemToMosaic(Z,Q,{type:"static",data:ba},q.shouldRepeat(T),Y,!1)}catch(P){if(!b.isAbortError(P))return new u("mapview-invalid-resource",`Could not fetch requested resource at ${ca}. ${P.message}`)}});return function(T,Z,X){return U.apply(this,arguments)}}();M._addItemToMosaic=function(U,T,Z,X,ca,P,J){return this._spriteMosaic.addSpriteItem(U,T,Z,X,ca,P,J)};m._createClass(K,[{key:"sprites",
get:function(){return this._spriteMosaic}},{key:"glyphs",get:function(){return this._glyphMosaic}}]);return K}()})},"esri/core/BidiText":function(){define(["exports","./BidiEngine"],function(m,p){const D=new p;m.bidiText=function(B){if(null==B)return["",!1];if(!D.hasBidiChar(B))return[B,!1];let u;u="rtl"===D.checkContextual(B)?"IDNNN":"ICNNN";return[D.bidiTransform(B,u,"VLYSN"),!0]};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/core/BidiEngine":function(){define(["./bidiEngineTables"],
function(m){function p(y,A,w,z,C){var E=y;void 0===A&&(A=C.defInFormat);void 0===w&&(w=C.defOutFormat);void 0===z&&(z=C.defSwap);if(A!==w){var F=A.substring(0,1),G=w.substring(0,1);var H=A.substring(1,4);var L=w.substring(1,4);"C"===H.charAt(0)&&(H=D(E),H="ltr"===H||"rtl"===H?H.toUpperCase():"L"===A.charAt(2)?"LTR":"RTL",A=F+H);"C"===L.charAt(0)&&(H=D(E),"rtl"===H?L="RTL":"ltr"===H?(E=E.split(""),E.reverse(),H=D(E.join("")),L=H.toUpperCase()):L="L"===w.charAt(2)?"LTR":"RTL",w=G+L)}if(A===w)return y;
G=A.substring(0,1);E=A.substring(1,4);F=w.substring(0,1);L=w.substring(1,4);C.inFormat=A;C.outFormat=w;C.swap=z;if("L"===G&&"VLTR"===w){if("LTR"===E)return C.dir=0,B(y,C);if("RTL"===E)return C.dir=1,B(y,C)}if("V"===G&&"V"===F)return C.dir="RTL"===E?1:0,t(y,C);if("L"===G&&"VRTL"===w)return C.dir="LTR"===E?0:1,y=B(y,C),t(y);if("VLTR"===A&&"LLTR"===w)return C.dir=0,B(y,C);if("V"===G&&"L"===F&&E!==L)return y=t(y),"RTL"===E?p(y,"LLTR","VLTR",z,C):p(y,"LRTL","VRTL",z,C);if("VRTL"===A&&"LRTL"===w)return p(y,
"LRTL","VRTL",z,C);"L"===G&&"L"===F&&(A=C.swap,C.swap=A.substr(0,1)+"N","RTL"===E?(C.dir=1,y=B(y,C),C.swap="N"+A.substr(1,2),C.dir=0,y=B(y,C)):(C.dir=0,y=B(y,C),C.swap="N"+A.substr(1,2),y=p(y,"VLTR","LRTL",C.swap,C)));return y}function D(y){return(y=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(y))?"z">=y[0]?"ltr":"rtl":""}function B(y,A){y=y.split("");const w=[];u(y,w,A);if(0!==A.hiLevel&&A.swap.substr(0,1)!==A.swap.substr(1,2))for(let E=0;E<y.length;E++)if(1===
w[E]){var z=E;b:{let F=void 0;var C=y[E];let G=0,H=m.SwapTable.length-1;for(;G<=H;)if(F=Math.floor((G+H)/2),C<m.SwapTable[F][0])H=F-1;else if(C>m.SwapTable[F][0])G=F+1;else{C=m.SwapTable[F][1];break b}}y[z]=C}e(2,y,w,A);e(1,y,w,A);x=w;return y.join("")}function u(y,A,w){const z=y.length;var C=w.dir?m.impTabRtl:m.impTabLtr,E=0,F=-1;const G=[],H=[];w.hiLevel=w.dir;w.lastArabic=!1;w.hasUbatAl=!1;w.hasUbatB=!1;w.hasUbatS=!1;for(var L=0;L<z;L++){var K=L,M=y[L].charCodeAt(0);const U=m.PrimaryTable[M>>8];
G[K]=U<m.TBBASE?U:m.UnicodeTable[U-m.TBBASE][M&255]}for(K=0;K<z;K++){L=b(y,G,H,K,w);H[K]=L;E=C[E][L];M=E&240;E&=15;L=C[E][5];A[K]=L;if(0<M){if(16===M)for(;F<K;F++)A[F]=1;F=-1}if(C[E][6])-1===F&&(F=K);else if(-1<F){for(;F<K;F++)A[F]=L;F=-1}G[K]===m.UBAT_B&&(A[K]=0);w.hiLevel|=L}if(w.hasUbatS)for(y=0;y<z;y++)if(G[y]===m.UBAT_S)for(A[y]=w.dir,C=y-1;0<=C;C--)if(G[C]===m.UBAT_WS)A[C]=w.dir;else break}function t(y,A){y=y.split("");if(A){const w=[];u(y,w,A);x=w}y.reverse();n.reverse();return y.join("")}
function h(y){for(let A=0;A<m.ArabicAlefBetIntervalsBegine.length;A++)if(y>=m.ArabicAlefBetIntervalsBegine[A]&&y<=m.ArabicAlefBetIntervalsEnd[A])return!0;return!1}function l(y,A,w,z){for(;A*w<z&&a(y[A]);)A+=w;return A*w<z&&h(y[A])?!0:!1}function e(y,A,w,z){if(!(z.hiLevel<y))if(1!==y||1!==z.dir||z.hasUbatB){z=A.length;for(var C=0,E,F,G;C<z;){if(w[C]>=y){for(E=C+1;E<z&&w[E]>=y;)E++;for(F=E-1;C<F;C++,F--)G=A[C],A[C]=A[F],A[F]=G,G=n[C],n[C]=n[F],n[F]=G;C=E}C++}}else A.reverse(),n.reverse()}function b(y,
A,w,z,C){return{UBAT_L:()=>{C.lastArabic=!1;return m.UBAT_L},UBAT_R:()=>{C.lastArabic=!1;return m.UBAT_R},UBAT_ON:()=>m.UBAT_ON,UBAT_AN:()=>m.UBAT_AN,UBAT_EN:()=>C.lastArabic?m.UBAT_AN:m.UBAT_EN,UBAT_AL:()=>{C.lastArabic=!0;C.hasUbatAl=!0;return m.UBAT_R},UBAT_WS:()=>m.UBAT_ON,UBAT_CS:()=>{let E,F;if(1>z||z+1>=A.length||(E=w[z-1])!==m.UBAT_EN&&E!==m.UBAT_AN||(F=A[z+1])!==m.UBAT_EN&&F!==m.UBAT_AN)return m.UBAT_ON;C.lastArabic&&(F=m.UBAT_AN);return F===E?F:m.UBAT_ON},UBAT_ES:()=>(0<z?w[z-1]:m.UBAT_B)===
m.UBAT_EN&&z+1<A.length&&A[z+1]===m.UBAT_EN?m.UBAT_EN:m.UBAT_ON,UBAT_ET:()=>{if(0<z&&w[z-1]===m.UBAT_EN)return m.UBAT_EN;if(C.lastArabic)return m.UBAT_ON;let E=z+1;const F=A.length;for(;E<F&&A[E]===m.UBAT_ET;)E++;return E<F&&A[E]===m.UBAT_EN?m.UBAT_EN:m.UBAT_ON},UBAT_NSM:()=>{if("VLTR"===C.inFormat){for(var E=A.length,F=z+1;F<E&&A[F]===m.UBAT_NSM;)F++;if(F<E&&(E=y[z].charCodeAt[0],F=A[F],(1425<=E&&2303>=E||64286===E)&&(F===m.UBAT_R||F===m.UBAT_AL)))return m.UBAT_R}return 1>z||A[z-1]===m.UBAT_B?m.UBAT_ON:
w[z-1]},UBAT_B:()=>{C.lastArabic=!0;C.hasUbatB=!0;return C.dir},UBAT_S:()=>{C.hasUbatS=!0;return m.UBAT_ON},UBAT_LRE:()=>{C.lastArabic=!1;return m.UBAT_ON},UBAT_RLE:()=>{C.lastArabic=!1;return m.UBAT_ON},UBAT_LRO:()=>{C.lastArabic=!1;return m.UBAT_ON},UBAT_RLO:()=>{C.lastArabic=!1;return m.UBAT_ON},UBAT_PDF:()=>{C.lastArabic=!1;return m.UBAT_ON},UBAT_BN:()=>m.UBAT_ON}[m.TYPES_NAMES[A[z]]]()}function d(y,A){for(let w=0;w<m.BaseForm.length;w++)if(y===m.BaseForm[w])return A[w];return y}function a(y){return"\u064b"<=
y&&"\u0655">=y?!0:!1}function c(y){return"L"===y?"LTR":"R"===y?"RTL":"C"===y?"CLR":"D"===y?"CRL":""}function f(y,A){for(let w=0;w<m.AlefTable.length;w++)if(y===m.AlefTable[w])return A[w];return y}function g(y,A,w,z){for(let C=0;C<y.length;C++)if(y[C]>A||!w&&y[C]===A)y[C]+=z}let n=[],k=[],x=[];const r={dir:0,defInFormat:"LLTR",defoutFormat:"VLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,hasBlockSep:!1,hasSegSep:!1,defOutFormat:""},v=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,
q=/[\u0591-\u06ff\ufb1d-\ufefc]/;return function(){function y(){this.inputFormat="ILYNN";this.outputFormat="VLNNN";this.sourceToTarget=[];this.targetToSource=[];this.levels=[]}var A=y.prototype;A.bidiTransform=function(w,z,C){this.sourceToTarget=[];this.targetToSource=[];if(!w)return"";var E=this.sourceToTarget,F=this.targetToSource,G=w.length;n=[];x=[];for(var H=0;H<G;H++)E[H]=H,F[H]=H,n[H]=H;if(!this.checkParameters(z,C))return w;z=this.inputFormat;C=this.outputFormat;E=w;G=c(z.charAt(1));E=c(C.charAt(1));
H="I"===z.charAt(0)?"L":z.charAt(0);F="I"===C.charAt(0)?"L":C.charAt(0);G=H+G;E=F+E;F=z.charAt(2)+C.charAt(2);r.defInFormat=G;r.defOutFormat=E;r.defSwap=F;w=p(w,G,E,F,r);E=!1;if("R"===C.charAt(1))E=!0;else if("C"===C.charAt(1)||"D"===C.charAt(1))E="rtl"===this.checkContextual(w);F=this.sourceToTarget=n;G=Array(F.length);for(H=0;H<F.length;H++)G[F[H]]=H;k=this.targetToSource=G;if(z.charAt(3)===C.charAt(3))E=w;else if("S"===C.charAt(3))if(z=E,C=!0,0===w.length)E="";else{void 0===z&&(z=!0);void 0===
C&&(C=!0);w=String(w);w=w.split("");G=0;E=1;F=w.length;z||(G=w.length-1,E=-1,F=1);var L=G;G=C;var K=0;H=[];for(var M=0;L*E<F;L+=E)if(h(w[L])||a(w[L])){var U;if(U="\u0644"===w[L])b:{for(var T=w,Z=L+E,X=E,ca=F;Z*X<ca&&a(T[Z]);)Z+=X;U=" ";if(Z*X<ca)for(U=T[Z],T=0;T<m.AlefTable.length;T++)if(m.AlefTable[T]===U){U=!0;break b}U=!1}if(U){w[L]=0===K?f(w[L+E],m.LamAlefInialTableFE):f(w[L+E],m.LamAlefMedialTableFE);L+=E;K=w;U=L;T=E;for(Z=F;U*T<Z&&a(K[U]);)U+=T;U*T<Z&&(K[U]=" ");G&&(H[M]=L,M++);K=0}else{U=w[L];
if(1===K){T=L;if(l(w,L+E,E,F))b:for(Z=w[L],X=0;X<m.BaseForm.length;X++){if(Z===m.BaseForm[X]){Z=m.MedialForm[X];break b}}else Z=d(w[L],m.FinalForm);w[T]=Z}else!0===l(w,L+E,E,F)?w[L]=d(w[L],m.InitialForm):w[L]=d(w[L],m.IsolatedForm);a(U)||(K=1);b:{for(T=0;T<m.StandAlonForm.length;T++)if(m.StandAlonForm[T]===U){U=!0;break b}U=!1}!0===U&&(K=0)}}else K=0;E=H;F="";for(G=0;G<w.length;G++){if(H=C){b:{for(H=0;H<E.length;H++)if(E[H]===G)break b;H=-1}H=-1<H}H?(g(k,G,!z,-1),n.splice(G,1)):F+=w[G]}E=F}else if(z=
w,C=E,w=!0,0===z.length)E="";else for(void 0===w&&(w=!0),void 0===C&&(C=!0),z=String(z),E="",F=z.split(""),G=0;G<z.length;G++)H=!1,"\ufe70"<=F[G]&&"\ufeff">F[G]?(M=z.charCodeAt(G),"\ufef5"<=F[G]&&"\ufefc">=F[G]?(C?(0<G&&w&&" "===F[G-1]?E=E.substring(0,E.length-1)+"\u0644":(E+="\u0644",H=!0),E+=m.AlefTable[(M-65269)/2]):(E+=m.AlefTable[(M-65269)/2],E+="\u0644",G+1<z.length&&w&&" "===F[G+1]?G++:H=!0),H&&(g(k,G,!0,1),n.splice(G,0,n[G]))):E+=m.FETo06Table[M-65136]):E+=F[G];this.sourceToTarget=n;this.targetToSource=
k;this.levels=x;return E};A._inputFormatSetter=function(w){if(!v.test(w))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.inputFormat=w};A._outputFormatSetter=function(w){if(!v.test(w))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=w};A.checkParameters=function(w,z){w?this._inputFormatSetter(w):w=this.inputFormat;z?this._outputFormatSetter(z):z=this.outputFormat;return w===z?!1:!0};A.checkContextual=function(w){w=D(w);if("ltr"!==
w&&"rtl"!==w){try{w=document.dir.toLowerCase()}catch(z){}"ltr"!==w&&"rtl"!==w&&(w="ltr")}return w};A.hasBidiChar=function(w){return q.test(w)};return y}()})},"esri/core/bidiEngineTables":function(){define(["exports"],function(m){m.AlefTable=["\u0622","\u0623","\u0625","\u0627"];m.ArabicAlefBetIntervalsBegine=["\u0621","\u0641"];m.ArabicAlefBetIntervalsEnd=["\u063a","\u064a"];m.BaseForm="\u0627\u0628\u062a\u062b\u062c\u062d\u062e\u062f\u0630\u0631\u0632\u0633\u0634\u0635\u0636\u0637\u0638\u0639\u063a\u0641\u0642\u0643\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u06cc\u0626\u0624".split("");
m.FETo06Table="\u064b\u064b\u064c\u061f\u064d\u061f\u064e\u064e\u064f\u064f\u0650\u0650\u0651\u0651\u0652\u0652\u0621\u0622\u0622\u0623\u0623\u0624\u0624\u0625\u0625\u0626\u0626\u0626\u0626\u0627\u0627\u0628\u0628\u0628\u0628\u0629\u0629\u062a\u062a\u062a\u062a\u062b\u062b\u062b\u062b\u062c\u062c\u062c\u062c\u062d\u062d\u062d\u062d\u062e\u062e\u062e\u062e\u062f\u062f\u0630\u0630\u0631\u0631\u0632\u0632\u0633\u0633\u0633\u0633\u0634\u0634\u0634\u0634\u0635\u0635\u0635\u0635\u0636\u0636\u0636\u0636\u0637\u0637\u0637\u0637\u0638\u0638\u0638\u0638\u0639\u0639\u0639\u0639\u063a\u063a\u063a\u063a\u0641\u0641\u0641\u0641\u0642\u0642\u0642\u0642\u0643\u0643\u0643\u0643\u0644\u0644\u0644\u0644\u0645\u0645\u0645\u0645\u0646\u0646\u0646\u0646\u0647\u0647\u0647\u0647\u0648\u0648\u0649\u0649\u064a\u064a\u064a\u064a\ufef5\ufef6\ufef7\ufef8\ufef9\ufefa\ufefb\ufefc\u061f\u061f\u061f".split("");
m.FinalForm="\ufe8e\ufe90\ufe96\ufe9a\ufe9e\ufea2\ufea6\ufeaa\ufeac\ufeae\ufeb0\ufeb2\ufeb6\ufeba\ufebe\ufec2\ufec6\ufeca\ufece\ufed2\ufed6\ufeda\ufede\ufee2\ufee6\ufeea\ufeee\ufef2\ufe88\ufe84\ufe82\ufe94\ufef0\ufbfd\ufe8a\ufe86\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8a\ufe86".split("");m.InitialForm="\ufe8d\ufe91\ufe97\ufe9b\ufe9f\ufea3\ufea7\ufea9\ufeab\ufead\ufeaf\ufeb3\ufeb7\ufebb\ufebf\ufec3\ufec7\ufecb\ufecf\ufed3\ufed7\ufedb\ufedf\ufee3\ufee7\ufeeb\ufeed\ufef3\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfe\ufe8b\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8b\ufe85".split("");
m.IsolatedForm="\ufe8d\ufe8f\ufe95\ufe99\ufe9d\ufea1\ufea5\ufea9\ufeab\ufead\ufeaf\ufeb1\ufeb5\ufeb9\ufebd\ufec1\ufec5\ufec9\ufecd\ufed1\ufed5\ufed9\ufedd\ufee1\ufee5\ufee9\ufeed\ufef1\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfc\ufe89\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe89\ufe85".split("");m.LamAlefInialTableFE=["\ufef5","\ufef7","\ufef9","\ufefb"];m.LamAlefMedialTableFE=["\ufef6","\ufef8","\ufefa","\ufefc"];m.MedialForm="\ufe8e\ufe92\ufe98\ufe9c\ufea0\ufea4\ufea8\ufeaa\ufeac\ufeae\ufeb0\ufeb4\ufeb8\ufebc\ufec0\ufec4\ufec8\ufecc\ufed0\ufed4\ufed8\ufedc\ufee0\ufee4\ufee8\ufeec\ufeee\ufef4\ufe88\ufe84\ufe82\ufe94\ufef0\ufbff\ufe8c\ufe86\ufe71\ufe72\ufe74\ufe77\ufe79\ufe7b\ufe7d\ufe7f\ufe80\ufe8c\ufe86".split("");
m.PrimaryTable=[100,0,0,0,0,101,102,103,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,104,4,4,4,0,4,0,4,0,4,4,4,0,0,4,4,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,4,4,0,0,4,4,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,
4,4,4,4,4,4,4,4,4,4,0,0,0,105,7,7,106,107];m.StandAlonForm="\u0621\u0622\u0623\u0624\u0625\u0627\u0629\u062f\u0630\u0631\u0632\u0648\u0649".split("");m.SwapTable=[["(",")"],[")","("],["\x3c","\x3e"],["\x3e","\x3c"],["[","]"],["]","["],["{","}"],["}","{"],["\u00ab","\u00bb"],["\u00bb","\u00ab"],["\u2039","\u203a"],["\u203a","\u2039"],["\u207d","\u207e"],["\u207e","\u207d"],["\u208d","\u208e"],["\u208e","\u208d"],["\u2264","\u2265"],["\u2265","\u2264"],["\u2329","\u232a"],["\u232a","\u2329"],["\ufe59",
"\ufe5a"],["\ufe5a","\ufe59"],["\ufe5b","\ufe5c"],["\ufe5c","\ufe5b"],["\ufe5d","\ufe5e"],["\ufe5e","\ufe5d"],["\ufe64","\ufe65"],["\ufe65","\ufe64"]];m.TBBASE=100;m.TYPES_NAMES="UBAT_L UBAT_R UBAT_EN UBAT_AN UBAT_ON UBAT_B UBAT_S UBAT_AL UBAT_WS UBAT_CS UBAT_ES UBAT_ET UBAT_NSM UBAT_LRE UBAT_RLE UBAT_PDF UBAT_LRO UBAT_RLO UBAT_BN".split(" ");m.UBAT_AL=7;m.UBAT_AN=3;m.UBAT_B=5;m.UBAT_BN=18;m.UBAT_CS=9;m.UBAT_EN=2;m.UBAT_ES=10;m.UBAT_ET=11;m.UBAT_L=0;m.UBAT_LRE=13;m.UBAT_LRO=16;m.UBAT_NSM=12;m.UBAT_ON=
4;m.UBAT_PDF=15;m.UBAT_R=1;m.UBAT_RLE=14;m.UBAT_RLO=17;m.UBAT_S=6;m.UBAT_WS=8;m.UnicodeTable=[[18,18,18,18,18,18,18,18,18,6,5,6,8,5,18,18,18,18,18,18,18,18,18,18,18,18,18,18,5,5,5,6,8,4,4,11,11,11,4,4,4,4,4,10,9,10,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,18,18,18,18,18,18,5,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,9,4,11,11,11,11,4,4,4,4,0,
4,4,18,4,4,11,11,2,2,4,0,4,4,4,2,0,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,4,4,4,4,4,4,4,12,12,12,12,12,12,12,12,12,12,12,12,
12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,1,12,1,12,12,1,12,12,1,12,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4],[3,3,3,3,4,4,4,4,7,11,11,7,9,7,4,4,12,12,12,12,12,12,12,12,12,12,12,7,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,3,3,3,3,3,3,3,3,3,3,11,3,3,7,7,7,12,
7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,3,4,12,12,12,12,12,12,7,7,12,12,4,12,12,12,12,7,7,2,2,2,2,2,2,2,2,2,2,7,7,7,7,7,7],[7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,7,7,12,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,4,4,7,7,7,7,7,7,
7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,12,12,12,12,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,12,12,12,12,12,12,12,12,12,1,1,4,4,4,4,1,4,4,4,4,4],[8,8,8,8,8,8,8,8,8,8,8,18,18,18,0,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,5,13,14,15,16,17,9,11,11,11,11,11,4,4,4,4,4,4,4,
4,4,4,4,4,4,4,4,9,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,18,18,18,18,18,4,4,4,4,4,18,18,18,18,18,18,2,0,4,4,2,2,2,2,2,2,10,10,4,4,4,0,2,2,2,2,2,2,2,2,2,2,10,10,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],[0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,
4,4,0,0,0,0,0,4,4,4,4,4,1,12,1,1,1,1,1,1,1,1,1,1,10,1,1,1,1,1,1,1,1,1,1,1,1,1,4,1,1,1,1,1,4,1,4,1,1,4,1,1,4,1,1,1,1,1,1,1,1,1,1,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7],[12,12,12,12,12,12,12,
12,12,12,12,12,12,12,12,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,12,12,12,12,12,12,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,9,4,9,4,4,9,4,4,4,4,4,4,4,4,4,11,4,4,10,10,4,4,4,4,4,11,11,4,4,4,4,4,7,7,7,7,7,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
7,7,7,7,7,7,4,4,18],[4,4,4,11,11,11,4,4,4,4,4,10,9,10,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,4,0,0,0,4,4,4,11,11,4,4,4,11,11,4,4,4,4,4,
4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4]];m.impTabLtr=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]];m.impTabRtl=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]];Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/core/fontUtils":function(){define(["exports","../chunks/_rollupPluginBabelHelpers","../config"],function(m,p,D){function B(){B=p._asyncToGenerator(function*(l){const e=t(l);let b=h.get(e);if(b)return b;
l=new FontFace(l.family,`url('${D.fontsUrl}/woff2/${e}.${"woff2"}') format('${"woff2"}')`);const d=document.fonts;if(d.has(l)&&"loading"===l.status)return l.loaded;b=l.load();h.set(e,b);d.add(l);return b});return B.apply(this,arguments)}function u(l){if(!l)return"arial-unicode-ms";l=l.toLowerCase().split(" ").join("-");switch(l){case "serif":return"noto-serif";case "sans-serif":return"arial-unicode-ms";case "monospace":return"ubuntu-mono";case "fantasy":return"cabin-sketch";case "cursive":return"redressed";
default:return l}}function t(l){a:{if(l.weight)switch(l.weight.toLowerCase()){case "bold":case "bolder":var e="-bold";break a}e=""}a:{if(l.style)switch(l.style.toLowerCase()){case "italic":case "oblique":var b="-italic";break a}b=""}e+=b;return u(l.family)+(0<e.length?e:"-regular")}const h=new Map;m.getFontFamily=u;m.getFullyQualifiedFontName=t;m.loadFont=function(l){return B.apply(this,arguments)};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/Rasterizer":function(){define("../../core/mathUtils ./CIMSymbolHelper ./rasterizingUtils ./Rect ./SDFHelper ./utils".split(" "),
function(m,p,D,B,u,t){return function(){function h(e){this._resourceManager=e;this._rasterizationCanvas=null}var l=h.prototype;l.dispose=function(){this._rasterizationCanvas=null};l.rasterizeJSONResource=function(e,b,d){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));if("simple-fill"===e.type||"esriSFS"===e.type){const [q,y,A]=D.rasterizeSimpleFill(this._rasterizationCanvas,e.style,b);return{size:[y,A],image:new Uint32Array(q.buffer),sdf:!1,simplePattern:!0,
anchorX:0,anchorY:0,rasterizationScale:m.nextPowerOfTwo(Math.ceil(b))}}if("simple-line"===e.type||"esriSLS"===e.type||"line"===e.type&&e.dashTemplate){if("simple-line"===e.type||"esriSLS"===e.type)switch(b=p.slsDashToTemplateArray(e.style,e.cap),e.cap){case "butt":e="Butt";break;case "square":e="Square";break;default:e="Round"}else b=e.dashTemplate,e=e.cim.capStyle;const [q,y,A]=D.rasterizeDash(b,e);return{size:[y,A],image:new Uint32Array(q.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}}let a,
c=null,f=null,g=1;"simple-marker"===e.type||"esriSMS"===e.type||"line-marker"===e.type?(a=p.CIMSymbolHelper.fromSimpleMarker(e),f=u.getSDFInfo(a)):e.cim&&"CIMHatchFill"===e.cim.type?(a=p.CIMSymbolHelper.fromCIMHatchFill(e.cim,b),c=new B(a.frame.xmin,-a.frame.ymax,a.frame.xmax-a.frame.xmin,a.frame.ymax-a.frame.ymin),g=b):e.cim.markerPlacement&&"CIMMarkerPlacementInsidePolygon"===e.cim.markerPlacement.type?(a=p.CIMSymbolHelper.fromCIMInsidePolygon(e.cim),c=new B(a.frame.xmin,-a.frame.ymax,a.frame.xmax-
a.frame.xmin,a.frame.ymax-a.frame.ymin)):(a=e.cim,e.avoidSDFRasterization||(f=u.getSDFInfo(a)));if(f&&!d){const [q,y,A]=u.buildSDF(f);return q?{size:[y,A],image:new Uint32Array(q.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0,rasterizationScale:g}:null}const [n,k,x,r,v]=p.CIMSymbolHelper.rasterize(this._rasterizationCanvas,a,c,this._resourceManager,!d);return n?{size:[k,x],image:new Uint32Array(n.buffer),sdf:!1,simplePattern:!1,anchorX:r,anchorY:v}:null};l.rasterizeImageResource=function(e,b,
d,a){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));this._rasterizationCanvas.width=e;this._rasterizationCanvas.height=b;var c=this._rasterizationCanvas.getContext("2d");d instanceof ImageData?c.putImageData(d,0,0):(d.setAttribute("width",`${e}px`),d.setAttribute("height",`${b}px`),c.drawImage(d,0,0,e,b));d=c.getImageData(0,0,e,b);d=new Uint8Array(d.data);if(a)for(var f of a)if(f&&f.oldColor&&4===f.oldColor.length&&f.newColor&&4===f.newColor.length){const [g,
n,k,x]=f.oldColor,[r,v,q,y]=f.newColor;if(g!==r||n!==v||k!==q||x!==y)for(a=0;a<d.length;a+=4)g===d[a]&&n===d[a+1]&&k===d[a+2]&&x===d[a+3]&&(d[a]=r,d[a+1]=v,d[a+2]=q,d[a+3]=y)}for(a=0;a<d.length;a+=4)f=d[a+3]/255,d[a]*=f,d[a+1]*=f,d[a+2]*=f;c=d;f=e;a=b;if(512<=f||512<=a){c=f/a;1<c?(f=512,a=Math.round(512/c)):(a=512,f=Math.round(512*c));c=new Uint8Array(4*f*a);const g=new Uint8ClampedArray(c.buffer);t.resampleHermite(d,e,b,g,f,a,!1)}return{size:[f,a],image:new Uint32Array(c.buffer),sdf:!1,simplePattern:!1,
anchorX:0,anchorY:0}};return h}()})},"esri/symbols/cim/CIMSymbolHelper":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../Color ../../core/BidiText ../../core/lang ../../core/Logger ../../core/maybe ../../core/RandomLCG ../../core/screenUtils ../../geometry/support/aaBoundingRect ../../geometry/support/boundsUtils ../../support/arcadeOnDemand ./CIMPlacements ./CIMSymbolDrawHelper ./enums ./utils ../../views/2d/arcade/callExpressionWithFeature ../../views/2d/engine/vectorTiles/GeometryUtils ../../views/2d/engine/webgl/definitions ../../views/2d/engine/webgl/mesh/templates/shapingUtils".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d,a,c,f,g,n,k,x,r,v){function q(J,N,S){switch(N.type){case "CIMSymbolReference":return q(J,N.symbol,S);case "CIMPointSymbol":null==S&&(S={x:0,y:0});J.drawSymbol(N,S);break;case "CIMLineSymbol":null==S&&(S={paths:[[[0,0],[10,0]]]});J.drawSymbol(N,S);break;case "CIMPolygonSymbol":null==S&&(S={rings:[[[0,0],[0,10],[10,10],[10,0],[0,0]]]});J.drawSymbol(N,S);break;case "CIMTextSymbol":J.drawSymbol(N,{x:0,y:0});break;case "CIMVectorMarker":S=new c.Placement,J.drawMarker(N,S)}return J.envelope()}
function y(J){if(!J)return 0;switch(J.type){case "CIMMarkerPlacementAlongLineSameSize":return Math.abs(J.offset);case "CIMMarkerPlacementAlongLineRandomSize":return Math.abs(J.offset);case "CIMMarkerPlacementAtExtremities":return Math.abs(J.offset);case "CIMMarkerPlacementAtMeasuredUnits":return Math.abs(J.offset);case "CIMMarkerPlacementAtRatioPositions":return Math.abs(J.offset);case "CIMMarkerPlacementInsidePolygon":return 0;case "CIMMarkerPlacementOnLine":return Math.abs(J.offset);case "CIMMarkerPlacementOnVertices":return Math.abs(J.offset);
case "CIMMarkerPlacementPolygonCenter":return 0;default:return 0}}function A(J){if(!J)return 0;switch(J.type){case "CIMGeometricEffectArrow":return Math.abs(.5*J.width);case "CIMGeometricEffectBuffer":return Math.abs(J.size);case "CIMGeometricEffectExtension":return Math.abs(J.length);case "CIMGeometricEffectJog":return Math.abs(.5*J.length);case "CIMGeometricEffectMove":return Math.max(Math.abs(n.getValue(J.offsetX)),Math.abs(n.getValue(J.offsetY)));case "CIMGeometricEffectOffset":return Math.abs(J.offset);
case "CIMGeometricEffectOffsetTangent":return Math.abs(J.offset);case "CIMGeometricEffectRadial":return Math.abs(J.length);case "CIMGeometricEffectRegularPolygon":return Math.abs(J.radius);case "CIMGeometricEffectRotate":return 0;case "CIMGeometricEffectScale":return 0;case "CIMGeometricEffectTaperedPolygon":return.5*Math.max(Math.abs(J.fromWidth),Math.abs(J.toWidth));case "CIMGeometricEffectWave":return Math.abs(J.amplitude);default:return 0}}function w(J){if(!J)return 0;let N=0;for(const S of J)N+=
A(S);return N}function z(J,N,S){J.effects&&!h.isSome(N.geometryEngine)&&(N.geometryEnginePromise?S.push(N.geometryEnginePromise):n.isGeometryEngineRequired(J.effects)&&(N.geometryEnginePromise=n.importGeometryEngine(),S.push(N.geometryEnginePromise),N.geometryEnginePromise.then(Q=>N.geometryEngine=Q)))}const C=Math.PI,E=C/2,F=96/72,G=Math.PI/180,H=t.getLogger("esri.symbols.cim.CIMSymbolHelper");t=function(){function J(){}var N=J.prototype;N.getSymbolInflateSize=function(S,Q,Y,ba,aa){S||(S=[0,0,0,
0]);return Q?this._getInflateSize(S,Q,Y,ba,aa):S};J.safeSize=function(S){const Q=Math.max(Math.abs(S[0]),Math.abs(S[2]));S=Math.max(Math.abs(S[1]),Math.abs(S[3]));return Math.sqrt(Q*Q+S*S)};N._vectorMarkerBounds=function(S,Q,Y,ba){let aa=!0;const I=b.create();if(Q&&Q.markerGraphics)for(const O of Q.markerGraphics)Q=[0,0,0,0],O.geometry&&(d.getBoundsXY(I,O.geometry),Q[0]=0,Q[1]=0,Q[2]=0,Q[3]=0,this.getSymbolInflateSize(Q,O.symbol,Y,0,ba),I[0]+=Q[0],I[1]+=Q[1],I[2]+=Q[2],I[3]+=Q[3],aa?(S[0]=I[0],S[1]=
I[1],S[2]=I[2],S[3]=I[3],aa=!1):(S[0]=Math.min(S[0],I[0]),S[1]=Math.min(S[1],I[1]),S[2]=Math.max(S[2],I[2]),S[3]=Math.max(S[3],I[3])));return S};N._getInflateSize=function(S,Q,Y,ba,aa){return void 0!==Q.symbolLayers?(S=this._getLayersInflateSize(S,Q.symbolLayers,Y,ba,aa),Q=w(Q.effects),0<Q&&(S[0]-=Q,S[1]-=Q,S[2]+=Q,S[3]+=Q),S):this._getTextInflatedSize(S,Q,aa)};N._getLayersInflateSize=function(S,Q,Y,ba,aa){let I=!0;if(!Q)return S;for(const ea of Q)if(ea){Q=[0,0,0,0];switch(ea.type){case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":var O=
ea,R=O.width;null!=R&&(R=O.capStyle===g.LineCapStyle.Square||O.joinStyle===g.LineJoinStyle.Miter?R/1.4142135623730951:R/2,Q[0]=-R,Q[1]=-R,Q[2]=R,Q[3]=R);break;case "CIMCharacterMarker":case "CIMVectorMarker":case "CIMPictureMarker":O=ea;if("CIMVectorMarker"===ea.type){if(R=ea,Q=this._vectorMarkerBounds(Q,R,Y,aa),R.frame){var V=(R.frame.xmin+R.frame.xmax)/2,W=(R.frame.ymin+R.frame.ymax)/2;Q[0]-=V;Q[1]-=W;Q[2]-=V;Q[3]-=W;null!=R.size&&(R=R.size/(R.frame.ymax-R.frame.ymin),Q[0]*=R,Q[1]*=R,Q[2]*=R,Q[3]*=
R)}}else"CIMPictureMarker"===ea.type?(R=ea,W=Y.getResource(R.url),V=1,h.isSome(W)&&W.height&&(V=W.width/W.height),null!=O.size&&(Q=O.size/2,R=O.size*V*R.scaleX/2,Q=[-R,-Q,R,Q])):null!=O.size&&(Q=O.size/2,Q=[-Q,-Q,Q,Q]);O.anchorPoint&&("Absolute"===O.anchorPointUnits?(R=O.anchorPoint.x,V=O.anchorPoint.y):(R=O.anchorPoint.x*(Q[2]-Q[0]),V=O.anchorPoint.y*(Q[3]-Q[1])),Q[0]-=R,Q[1]-=V,Q[2]-=R,Q[3]-=V);R=n.getValue(O.rotation);O.rotateClockwise&&(R=-R);ba&&(R-=ba);R&&(V=G*R,R=Math.cos(V),V=Math.sin(V),
W=b.create([x.C_INFINITY,x.C_INFINITY,-x.C_INFINITY,-x.C_INFINITY]),b.expandPointInPlace(W,[Q[0]*R-Q[1]*V,Q[0]*V+Q[1]*R]),b.expandPointInPlace(W,[Q[0]*R-Q[3]*V,Q[0]*V+Q[3]*R]),b.expandPointInPlace(W,[Q[2]*R-Q[1]*V,Q[2]*V+Q[1]*R]),b.expandPointInPlace(W,[Q[2]*R-Q[3]*V,Q[2]*V+Q[3]*R]),Q=W);R=n.getValue(O.offsetX);V=n.getValue(O.offsetY);if(ba){var da=G*ba;W=Math.cos(da);da=Math.sin(da);const fa=R*da+V*W;R=R*W-V*da;V=fa}Q[0]+=R;Q[1]+=V;Q[2]+=R;Q[3]+=V;O=y(O.markerPlacement);0<O&&(Q[0]-=O,Q[1]-=O,Q[2]+=
O,Q[3]+=O)}O=w(ea.effects);0<O&&(Q[0]-=O,Q[1]-=O,Q[2]+=O,Q[3]+=O);I?(S[0]=Q[0],S[1]=Q[1],S[2]=Q[2],S[3]=Q[3],I=!1):(S[0]=Math.min(S[0],Q[0]),S[1]=Math.min(S[1],Q[1]),S[2]=Math.max(S[2],Q[2]),S[3]=Math.max(S[3],Q[3]))}return S};N._getTextInflatedSize=function(S,Q,Y){const ba=Q.height??10;S[0]=-ba/2;S[1]=-ba/2;S[2]=ba/2;S[3]=ba/2;if(!Y)return S;Y=Y.get(Q);if(!Y)return S;const {text:aa,mosaicItem:I}=Y;if(!I?.glyphMosaicItems?.length)return S;const {lineGapType:O,lineGap:R}=Q;Y=O?f.lineGapType2LineHeight(O,
R??0,ba):0;const V=B.bidiText(aa)[1],W="CIMBackgroundCallout"===Q.callout?.type;Q=v.shapeGlyphs(I.glyphMosaicItems,V,{scale:ba/r.GLYPH_SIZE,angle:n.getValue(Q.angle),xOffset:n.getValue(Q.offsetX),yOffset:n.getValue(Q.offsetY),hAlign:f.horizontalAlignment2HAlign(Q.horizontalAlignment),vAlign:f.verticalAlignment2VAlign(Q.verticalAlignment),maxLineWidth:512,lineHeight:r.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(Y||1,4)),decoration:Q.font.decoration||"none",isCIM:!0,hasBackground:W}).boundsT;S[0]=
Q.x-Q.halfWidth;S[1]=-Q.y-Q.halfHeight;S[2]=Q.x+Q.halfWidth;S[3]=-Q.y+Q.halfHeight;return S};return J}();let L=function(){function J(){}J.getEnvelope=function(N,S,Q){if(!N)return null;Q=new f.EnvDrawHelper(Q);if(Array.isArray(N)){let Y;for(const ba of N)Y?Y.union(q(Q,ba,S)):Y=q(Q,ba,S);return Y}return q(Q,N,S)};J.getTextureAnchor=function(N,S){N=this.getEnvelope(N,null,S);if(!N)return[0,0,0];S=N.height*F+2;return[-((N.x+.5*N.width)*F)/(N.width*F+2),-((N.y+.5*N.height)*F)/S,S]};J.rasterize=function(N,
S,Q,Y,ba=!0){var aa=Q||this.getEnvelope(S,null,Y);if(!aa)return[null,0,0,0,0];const I=(aa.x+.5*aa.width)*F,O=(aa.y+.5*aa.height)*F;N.width=aa.width*F;N.height=aa.height*F;Q||(N.width+=2,N.height+=2);Q=N.getContext("2d");aa=f.Transformation.createScale(F,-F);aa.translate(.5*N.width-I,.5*N.height+O);Y=new f.CanvasDrawHelper(Q,Y,aa);switch(S.type){case "CIMPointSymbol":Y.drawSymbol(S,{type:"point",x:0,y:0});break;case "CIMVectorMarker":aa=new c.Placement,Y.drawMarker(S,aa)}S=Q.getImageData(0,0,N.width,
N.height);S=new Uint8Array(S.data);if(ba)for(Y=0;Y<S.length;Y+=4)ba=S[Y+3]/255,S[Y]*=ba,S[Y+1]*=ba,S[Y+2]*=ba;return[S,N.width,N.height,-I/N.width,-O/N.height]};J.fromTextSymbol=function(N){const {angle:S,color:Q,font:Y,haloColor:ba,haloSize:aa,horizontalAlignment:I,kerning:O,text:R,verticalAlignment:V,xoffset:W,yoffset:da,backgroundColor:ea,borderLineColor:fa,borderLineSize:ha}=N;let ia,la,ka;if(Y){var ja=Y.family;var ma=Y.style;var na=Y.weight;ia=Y.size;la=Y.decoration}N=!1;R&&(N=B.bidiText(R)[1]);
if(ea||ha)ka={type:"CIMBackgroundCallout",margin:null,backgroundSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",color:X(ea)},{type:"CIMSolidStroke",color:X(fa),width:ha}]},accentBarSymbol:null,gap:null,leaderLineSymbol:null,lineStyle:null};var pa=g.BlockProgression.BTT,oa=g.FontEffects.Normal,qa=g.FontEncoding.Unicode;ja=ja||"Arial";b:{if(na)switch(na.toLowerCase()){case "bold":case "bolder":na="bold";break b}na=""}b:{if(ma)switch(ma.toLowerCase()){case "italic":case "oblique":ma=
"italic";break b}ma=""}na=na&&ma?`${na}-${ma}`:`${na}${ma}`;return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPointUnits:"Relative",dominantSizeAxis3D:"Y",size:10,billboardMode3D:"FaceNearPlane",frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:{type:"CIMTextSymbol",angle:S,blockProgression:pa,depth3D:1,extrapolateBaselines:!0,fontEffects:oa,fontEncoding:qa,fontFamilyName:ja,fontStyleName:na,fontType:g.FontType.Unspecified,
haloSize:aa,height:ia,hinting:g.GlyphHinting.Default,horizontalAlignment:T(I??"center"),kerning:O,letterWidth:100,ligatures:!0,lineGapType:"Multiple",offsetX:n.getValue(W),offsetY:n.getValue(da),strikethrough:"line-through"===la,underline:"underline"===la,symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:X(Q)}]},haloSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:X(ba)}]},shadowColor:[0,0,0,255],shadowOffsetX:1,shadowOffsetY:1,textCase:"Normal",
textDirection:N?g.TextReadingDirection.RTL:g.TextReadingDirection.LTR,verticalAlignment:Z(V??"baseline"),verticalGlyphOrientation:g.VerticalGlyphOrientation.Right,wordSpacing:100,billboardMode3D:g.BillBoardMode.FaceNearPlane,callout:ka},textString:R}],scaleSymbolsProportionally:!0,respectFrame:!0}],scaleX:1,angleAlignment:"Display"}};J.fromPictureFillSymbol=function(N){const {height:S,outline:Q,width:Y,xoffset:ba,xscale:aa,yoffset:I,yscale:O}=N,R=[],V={type:"CIMPolygonSymbol",symbolLayers:R};if(Q){const {cap:da,
join:ea,miterLimit:fa,width:ha}=Q;R.push({type:"CIMSolidStroke",color:X(Q.color),capStyle:M(da),joinStyle:U(ea),miterLimit:fa,width:ha})}let W=N.url;"esriPFS"===N.type&&N.imageData&&(W=N.imageData);N="angle"in N?N.angle??0:0;R.push({type:"CIMPictureFill",invertBackfaceTexture:!1,scaleX:1,textureFilter:g.TextureFilter.Picture,tintColor:null,url:W,height:(S??0)*(O||1),width:(Y??0)*(aa||1),offsetX:n.getValue(ba),offsetY:n.getValue(I),rotation:n.getValue(-N),colorSubstitutions:null});return V};J.fromSimpleFillSymbol=
function(N){const {color:S,style:Q,outline:Y}=N;N=[];const ba={type:"CIMPolygonSymbol",symbolLayers:N};var aa=null;if(Y){const {cap:I,join:O,style:R}=Y;"solid"!==R&&"none"!==R&&"esriSLSSolid"!==R&&"esriSLSNull"!==R&&(aa=[{type:"CIMGeometricEffectDashes",dashTemplate:ca(R,I),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]);N.push({type:"CIMSolidStroke",color:X(Y.color),capStyle:M(I),joinStyle:U(O),miterLimit:Y.miterLimit,width:Y.width,effects:aa})}if(Q&&"solid"!==Q&&"none"!==Q&&"esriSFSSolid"!==
Q&&"esriSFSNull"!==Q){aa={type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",color:X(S),capStyle:g.LineCapStyle.Butt,joinStyle:g.LineJoinStyle.Miter,width:.75}]};let I=0;const O=e.px2pt("vertical"===Q||"horizontal"===Q||"cross"===Q||"esriSFSCross"===Q||"esriSFSVertical"===Q||"esriSFSHorizontal"===Q?8:10);switch(Q){case "vertical":case "esriSFSVertical":I=90;break;case "forward-diagonal":case "esriSFSForwardDiagonal":I=-45;break;case "backward-diagonal":case "esriSFSBackwardDiagonal":I=45;break;
case "cross":case "esriSFSCross":I=0;break;case "diagonal-cross":case "esriSFSDiagonalCross":I=-45}N.push({type:"CIMHatchFill",lineSymbol:aa,offsetX:0,offsetY:0,rotation:I,separation:O});"cross"===Q||"esriSFSCross"===Q?N.push({type:"CIMHatchFill",lineSymbol:u.clone(aa),offsetX:0,offsetY:0,rotation:90,separation:O}):("diagonal-cross"===Q||"esriSFSDiagonalCross"===Q)&&N.push({type:"CIMHatchFill",lineSymbol:u.clone(aa),offsetX:0,offsetY:0,rotation:45,separation:O})}else!Q||"solid"!==Q&&"esriSFSSolid"!==
Q||N.push({type:"CIMSolidFill",enable:!0,color:X(S)});return ba};J.fromSimpleLineSymbol=function(N){const {cap:S,color:Q,join:Y,marker:ba,miterLimit:aa,style:I,width:O}=N;N=null;"solid"!==I&&"none"!==I&&"esriSLSSolid"!==I&&"esriSLSNull"!==I&&(N=[{type:"CIMGeometricEffectDashes",dashTemplate:ca(I,S),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]);const R=[];if(ba){let V;switch(ba.placement){case "begin-end":V=g.ExtremityPlacement.Both;break;case "begin":V=g.ExtremityPlacement.JustBegin;
break;case "end":V=g.ExtremityPlacement.JustEnd;break;default:V=g.ExtremityPlacement.None}const W=J.fromSimpleMarker(ba,O,Q).symbolLayers[0];W.markerPlacement={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:V,offsetAlongLine:0};R.push(W)}"none"!==I&&"esriSLSNull"!==I&&R.push({type:"CIMSolidStroke",color:X(Q),capStyle:M(S),joinStyle:U(Y),miterLimit:aa,width:O,effects:N});return{type:"CIMLineSymbol",symbolLayers:R}};J.fromPictureMarker=function(N){const {angle:S,height:Q,
width:Y,xoffset:ba,yoffset:aa}=N;let I=N.url;"esriPMS"===N.type&&N.imageData&&(I=N.imageData);return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMPictureMarker",invertBackfaceTexture:!1,scaleX:1,textureFilter:g.TextureFilter.Picture,tintColor:null,url:I,size:Q,width:Y,offsetX:n.getValue(ba),offsetY:n.getValue(aa),rotation:n.getValue(-S)}]}};J.fromSimpleMarker=function(N,S,Q){var {style:Y}=N;Q=N.color??Q;if("path"===Y){S=[];"outline"in N&&N.outline&&(Y=N.outline,S.push({type:"CIMSolidStroke",enable:!0,
width:e.pt2px(Math.round(e.px2pt(Y.width))),color:X(Y.color)}));S.push({type:"CIMSolidFill",enable:!0,color:X(Q),path:N.path});const [O,R]=P("square");return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:n.getValue(-N.angle),size:n.getValue(N.size||6),offsetX:n.getValue(N.xoffset),offsetY:n.getValue(N.yoffset),frame:O,markerGraphics:[{type:"CIMMarkerGraphic",geometry:R,symbol:{type:"CIMPolygonSymbol",symbolLayers:S}}]}]}}const [ba,aa]=P(Y);if(aa&&ba){Y=[];if("outline"in
N&&N.outline){var I=N.outline;Y.push({type:"CIMSolidStroke",enable:!0,width:null!=I.width&&.667<I.width?e.pt2px(Math.round(e.px2pt(I.width))):I.width,color:X(I.color)})}else!S||"line-marker"!==N.type||"cross"!==N.style&&"x"!==N.style||Y.push({type:"CIMSolidStroke",enable:!0,width:S,color:X(Q)});Y.push({type:"CIMSolidFill",enable:!0,color:X(Q)});Q={type:"CIMPolygonSymbol",symbolLayers:Y};I={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:n.getValue(-N.angle),size:n.getValue(N.size||
6*S),offsetX:n.getValue(N.xoffset),offsetY:n.getValue(N.yoffset),frame:ba,markerGraphics:[{type:"CIMMarkerGraphic",geometry:aa,symbol:Q}]}]}}return I};J.fromCIMHatchFill=function(N,S){const Q=S*(N.separation??4),Y=Q/2;N=u.clone(N.lineSymbol);N.symbolLayers?.forEach(aa=>{switch(aa.type){case "CIMSolidStroke":null!=aa.width&&(aa.width*=S);aa.effects?.forEach(I=>{"CIMGeometricEffectDashes"===I.type&&(I.dashTemplate=I.dashTemplate.map(O=>O*S))});break;case "CIMVectorMarker":null!=aa.size&&(aa.size*=S),
aa=aa.markerPlacement,null!=aa&&"placementTemplate"in aa&&(aa.placementTemplate=aa.placementTemplate.map(I=>I*S))}});for(var ba=this._getLineSymbolPeriod(N)||4;4>ba;)ba*=2;ba/=2;return{type:"CIMVectorMarker",frame:{xmin:-ba,xmax:ba,ymin:-Y,ymax:Y},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[-ba,0],[ba,0]]]},symbol:N}],size:Q}};J.fetchResources=function(N,S,Q){if(N&&S)switch(N.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(N=N.symbolLayers)for(const Y of N)switch(z(Y,
S,Q),Y.type){case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMCharacterMarker":case "CIMPictureMarker":"url"in Y&&Y.url&&Q.push(S.fetchResource(Y.url,null));break;case "CIMVectorMarker":if(N=Y.markerGraphics)for(const ba of N)ba&&(N=ba.symbol)&&J.fetchResources(N,S,Q)}}};J._getLineSymbolPeriod=function(N){if(N){const S=this._getEffectsRepeat(N.effects);if(S)return S;if(N.symbolLayers)for(const Q of N.symbolLayers)if(Q){if(N=
this._getEffectsRepeat(Q.effects))return N;switch(Q.type){case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":case "CIMObjectMarker3D":case "CIMglTFMarker3D":if(N=this._getPlacementRepeat(Q.markerPlacement))return N}}}return 0};J._getEffectsRepeat=function(N){if(N)for(var S of N)if(S)switch(S.type){case "CIMGeometricEffectDashes":if((N=S.dashTemplate)&&N.length){S=0;for(const Q of N)S+=Q;N.length&1&&(S*=2);return S}break;case "CIMGeometricEffectWave":return S.period;default:H.error(`unsupported geometric effect type ${S.type}`)}return 0};
J._getPlacementRepeat=function(N){if(N)switch(N.type){case "CIMMarkerPlacementAlongLineSameSize":case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineVariableSize":if((N=N.placementTemplate)&&N.length){let S=0;for(const Q of N)S+=+Q;N.length&1&&(S*=2);return S}}return 0};J.fromCIMInsidePolygon=function(N){var S=N.markerPlacement;const Q={...N,markerPlacement:null,anchorPoint:null};N=Math.abs(S.stepX);const Y=Math.abs(S.stepY);var ba=(S.randomness??100)/100;let aa,I;if("Random"===
S.gridType){var O=e.px2pt(r.RANDOM_INSIDE_POLYGON_TEXTURE_SIZE);const R=Math.max(Math.floor(O/N),1),V=Math.max(Math.floor(O/Y),1);O=R*N/2;aa=V*Y/2;I=2*aa;S=new l(S.seed);const W=ba*N/1.5,da=ba*Y/1.5;ba=[];for(let ea=0;ea<R;ea++)for(let fa=0;fa<V;fa++){const ha=ea*N-O+W*(.5-S.getFloat()),ia=fa*Y-aa+da*(.5-S.getFloat());ba.push({x:ha,y:ia});0===ea&&ba.push({x:ha+2*O,y:ia});0===fa&&ba.push({x:ha,y:ia+2*aa})}}else!0===S.shiftOddRows?(O=N/2,aa=Y,I=2*Y,ba=[{x:-O,y:0},{x:O,y:0},{x:0,y:aa},{x:0,y:-aa}]):
(O=N/2,aa=Y/2,I=Y,ba=[{x:-N,y:0},{x:0,y:-Y},{x:-N,y:-Y},{x:0,y:0},{x:N,y:0},{x:0,y:Y},{x:N,y:Y},{x:-N,y:Y},{x:N,y:-Y}]);N=ba.map(R=>({type:"CIMMarkerGraphic",geometry:R,symbol:{type:"CIMPointSymbol",symbolLayers:[Q]}}));return{type:"CIMVectorMarker",frame:{xmin:-O,xmax:O,ymin:-aa,ymax:aa},markerGraphics:N,size:I}};J.getSize=function(N){if(N)switch(N.type){case "CIMTextSymbol":return N.height;case "CIMPointSymbol":var S=0;if(N.symbolLayers)for(var Q of N.symbolLayers)if(Q)switch(Q.type){case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":case "CIMObjectMarker3D":case "CIMglTFMarker3D":N=
Q.size,null!=N&&N>S&&(S=N)}return S;case "CIMLineSymbol":case "CIMPolygonSymbol":Q=0;if(N.symbolLayers)for(S of N.symbolLayers)if(S)switch(S.type){case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":N=S.width;null!=N&&N>Q&&(Q=N);break;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":case "CIMObjectMarker3D":case "CIMglTFMarker3D":S.markerPlacement&&n.isCIMMarkerStrokePlacement(S.markerPlacement)&&(N=S.size,null!=N&&N>Q&&(Q=N))}return Q}};J.getMarkerScaleRatio=
function(N){if(N)switch(N.type){case "CIMVectorMarker":if(!1!==N.scaleSymbolsProportionally&&N.frame&&null!=N.size)return N.size/(N.frame.ymax-N.frame.ymin)}return 1};return J}(),K=function(){function J(){}J.findApplicableOverrides=function(N,S,Q){if(N&&S){if(N.primitiveName){let Y=!1;for(const ba of Q)if(ba.primitiveName===N.primitiveName){Y=!0;break}if(!Y)for(const ba of S)ba.primitiveName===N.primitiveName&&Q.push(ba)}switch(N.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(N.effects)for(const Y of N.effects)J.findApplicableOverrides(Y,
S,Q);if(N.symbolLayers)for(const Y of N.symbolLayers)J.findApplicableOverrides(Y,S,Q);break;case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMSolidFill":case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMVectorMarker":case "CIMCharacterMarker":case "CIMPictureMarker":if(N.effects)for(const Y of N.effects)J.findApplicableOverrides(Y,S,Q);N.markerPlacement&&J.findApplicableOverrides(N.markerPlacement,S,Q);if("CIMVectorMarker"===N.type){if(N.markerGraphics)for(const Y of N.markerGraphics)J.findApplicableOverrides(Y,
S,Q),J.findApplicableOverrides(Y.symbol,S,Q)}else"CIMCharacterMarker"===N.type?J.findApplicableOverrides(N.symbol,S,Q):"CIMHatchFill"===N.type?J.findApplicableOverrides(N.lineSymbol,S,Q):"CIMPictureMarker"===N.type&&J.findApplicableOverrides(N.animatedSymbolProperties,S,Q)}}};J.findEffectOverrides=function(N,S,Q){if(S&&N){var Y=N.length;for(let ba=0;ba<Y;ba++){const aa=N[ba]?.primitiveName;if(aa){let I=!1;for(const O of Q)if(O.primitiveName===aa){I=!0;break}if(!I)for(const O of S)O.primitiveName===
aa&&Q.push(O)}}}};J.resolveSymbolOverrides=function(){var N=p._asyncToGenerator(function*(S,Q,Y,ba,aa,I,O){if(!S||!S.symbol)return null;let {symbol:R,primitiveOverrides:V}=S;S=!!V;if(!S&&!ba)return R;R=u.clone(R);let W=!0;Q||(Q={attributes:{}},W=!1);S&&(W||(V=V.filter(da=>!da.valueExpressionInfo?.expression.includes("$feature"))),O||(V=V.filter(da=>!da.valueExpressionInfo?.expression.includes("$view"))),0<V.length&&(S=n.attributesToFields(Q.attributes),yield J.evaluateOverrides(V,Q,{spatialReference:Y,
fields:S,geometryType:aa},I,O)),J.applyOverrides(R,V));ba&&J.applyDictionaryTextOverrides(R,Q,ba);return R});return function(S,Q,Y,ba,aa,I,O){return N.apply(this,arguments)}}();J.evaluateOverrides=function(){var N=p._asyncToGenerator(function*(S,Q,Y,ba,aa){if(Q){var I;for(const O of S)(S=O.valueExpressionInfo)&&Y&&Y.geometryType&&(I||(I=[]),O.value=void 0,S=a.createRendererExpression(S.expression,Y.spatialReference,Y.fields).then(R=>{O.value=k(R,Q,{$view:aa},Y.geometryType,ba)}),I.push(S));void 0!==
I&&0<I.length&&(yield Promise.all(I))}});return function(S,Q,Y,ba,aa){return N.apply(this,arguments)}}();J.applyDictionaryTextOverrides=function(N,S,Q,Y="Normal"){if(N&&N.type)switch(N.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":case "CIMTextSymbol":var ba=N.symbolLayers;if(!ba)break;for(var aa of ba)aa&&"CIMVectorMarker"===aa.type&&J.applyDictionaryTextOverrides(aa,S,Q,"CIMTextSymbol"===N.type?N.textCase:Y);break;case "CIMVectorMarker":N=N.markerGraphics;if(!N)break;
for(ba of N)ba&&J.applyDictionaryTextOverrides(ba,S,Q);break;case "CIMMarkerGraphic":(aa=N.textString)&&aa.includes("[")&&(Q=n.analyzeTextParts(aa,Q),N.textString=n.assignTextValuesFromFeature(S,Q,Y))}};J.applyOverrides=function(N,S,Q,Y){if(N.primitiveName)for(const aa of S)if(aa.primitiveName===N.primitiveName){var ba=(ba=aa.propertyName)?ba.charAt(0).toLowerCase()+ba.substr(1):ba;Y&&Y.push({cim:N,nocapPropertyName:ba,value:N[ba]});aa.expression&&(aa.value=J.toValue(aa.propertyName,aa.expression));
if(Q){let I=!1;for(const O of Q)O.primitiveName===N.primitiveName&&(I=!0);I||Q.push(aa)}h.isSome(aa.value)&&(N[ba]=aa.value)}switch(N.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(N.effects)for(const aa of N.effects)J.applyOverrides(aa,S,Q,Y);if(N.symbolLayers)for(const aa of N.symbolLayers)J.applyOverrides(aa,S,Q,Y);break;case "CIMSolidStroke":case "CIMSolidFill":case "CIMVectorMarker":if(N.effects)for(const aa of N.effects)J.applyOverrides(aa,S,Q,Y);if("CIMVectorMarker"===
N.type&&N.markerGraphics)for(const aa of N.markerGraphics)J.applyOverrides(aa,S,Q,Y),J.applyOverrides(aa.symbol,S,Q,Y)}};J.restoreOverrides=function(N){for(const S of N)S.cim[S.nocapPropertyName]=S.value};J.buildOverrideKey=function(N){let S="";for(const Q of N)void 0!==Q.value&&(S+=`${Q.primitiveName}${Q.propertyName}${JSON.stringify(Q.value)}`);return S};J.toValue=function(N,S){return"DashTemplate"===N?S.split(" ").map(Q=>Number(Q)):"Color"===N?(N=(new D(S)).toRgba(),N[3]*=255,N):S};return J}();
const M=J=>{if(!J)return g.LineCapStyle.Butt;switch(J){case "butt":return g.LineCapStyle.Butt;case "square":return g.LineCapStyle.Square;case "round":return g.LineCapStyle.Round}},U=J=>{if(!J)return g.LineJoinStyle.Miter;switch(J){case "miter":return g.LineJoinStyle.Miter;case "round":return g.LineJoinStyle.Round;case "bevel":return g.LineJoinStyle.Bevel}},T=J=>{if(h.isNone(J))return"Center";switch(J){case "left":return"Left";case "right":return"Right";case "center":return"Center"}},Z=J=>{if(h.isNone(J))return"Center";
switch(J){case "baseline":return"Baseline";case "top":return"Top";case "middle":return"Center";case "bottom":return"Bottom"}},X=J=>{if(!J)return[0,0,0,0];const {r:N,g:S,b:Q,a:Y}=J;return[N,S,Q,255*Y]},ca=(J,N)=>{N="butt"===N;switch(J){case "dash":case "esriSLSDash":return N?[4,3]:[3,4];case "dash-dot":case "esriSLSDashDot":return N?[4,3,1,3]:[3,4,0,4];case "dot":case "esriSLSDot":return N?[1,3]:[0,4];case "long-dash":case "esriSLSLongDash":return N?[8,3]:[7,4];case "long-dash-dot":case "esriSLSLongDashDot":return N?
[8,3,1,3]:[7,4,0,4];case "long-dash-dot-dot":case "esriSLSDashDotDot":return N?[8,3,1,3,1,3]:[7,4,0,4,0,4];case "short-dash":case "esriSLSShortDash":return N?[4,1]:[3,2];case "short-dash-dot":case "esriSLSShortDashDot":return N?[4,1,1,1]:[3,2,0,2];case "short-dash-dot-dot":case "esriSLSShortDashDotDot":return N?[4,1,1,1,1,1]:[3,2,0,2,0,2];case "short-dot":case "esriSLSShortDot":return N?[1,1]:[0,2];case "solid":case "esriSLSSolid":case "none":return H.error("Unexpected: style does not require rasterization"),
[0,0];default:return H.error(`Tried to rasterize SLS, but found an unexpected style: ${J}!`),[0,0]}},P=J=>{if("circle"===J||"esriSMSCircle"===J){var N=Math.acos(.995);J=Math.ceil(C/N/4);0===J&&(J=1);N=E/J;J*=4;var S=[];S.push([50,0]);for(let Q=1;Q<J;Q++)S.push([50*Math.cos(Q*N),-50*Math.sin(Q*N)]);S.push([50,0]);N={rings:[S]};S={xmin:-50,ymin:-50,xmax:50,ymax:50}}else"cross"===J||"esriSMSCross"===J?(N={rings:[[[0,50],[0,0],[50,0],[50,-0],[0,-0],[0,-50],[-0,-50],[-0,-0],[-50,-0],[-50,0],[-0,0],[-0,
50],[0,50]]]},S={xmin:-50,ymin:-50,xmax:50,ymax:50}):"diamond"===J||"esriSMSDiamond"===J?(N={rings:[[[-50,0],[0,50],[50,0],[0,-50],[-50,0]]]},S={xmin:-50,ymin:-50,xmax:50,ymax:50}):"square"===J||"esriSMSSquare"===J?(N={rings:[[[-50,-50],[-50,50],[50,50],[50,-50],[-50,-50]]]},S={xmin:-50,ymin:-50,xmax:50,ymax:50}):"x"===J||"esriSMSX"===J?(N={rings:[[[0,0],[50,50],[50,50],[0,0],[50,-50],[50,-50],[0,-0],[-50,-50],[-50,-50],[-0,0],[-50,50],[-50,50],[0,0]]]},S={xmin:-50,ymin:-50,xmax:50,ymax:50}):"triangle"===
J||"esriSMSTriangle"===J?(J=2/3*100,S=J-100,N={rings:[[[-57.735026918962575,S],[0,J],[57.735026918962575,S],[-57.735026918962575,S]]]},S={xmin:-57.735026918962575,ymin:S,xmax:57.735026918962575,ymax:J}):"arrow"===J&&(N={rings:[[[-50,50],[50,0],[-50,-50],[-33,-20],[-33,20],[-50,50]]]},S={xmin:-50,ymin:-50,xmax:50,ymax:50});return[S,N]};m.CIMSymbolHelper=L;m.CIMSymbolInflatedSizeHelper=t;m.OverrideHelper=K;m.slsDashToTemplateArray=ca;m.symbolToCIM=function(J){if(!J||!J.type)return null;let N;switch(J.type){case "cim":return J.data;
case "web-style":return J;case "simple-marker":J=L.fromSimpleMarker(J);if(!J)return null;N=J;break;case "picture-marker":N=L.fromPictureMarker(J);break;case "simple-line":N=L.fromSimpleLineSymbol(J);break;case "simple-fill":N=L.fromSimpleFillSymbol(J);break;case "picture-fill":N=L.fromPictureFillSymbol(J);break;case "text":N=L.fromTextSymbol(J)}return{type:"CIMSymbolReference",symbol:N}};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/CIMPlacements":function(){define(["exports"],
function(m){let p=function(){function B(){this.setIdentity()}var u=B.prototype;u.getAngle=function(){if(null==this.rz||0===this.rz&&1!==this.rzCos&&0!==this.rzSin)this.rz=Math.atan2(this.rzSin,this.rzCos);return this.rz};u.setIdentity=function(){this.tz=this.ty=this.tx=0;this.s=1;this.rz=this.ry=this.rx=0;this.rzCos=1;this.rzSin=0};u.setTranslate=function(t,h){this.tx=t;this.ty=h};u.setTranslateZ=function(t){this.tz=t};u.setRotateCS=function(t,h){this.rz=void 0;this.rzCos=t;this.rzSin=h};u.setRotate=
function(t){this.rz=t;this.rzSin=this.rzCos=void 0};u.setRotateY=function(t){this.ry=t};u.setScale=function(t){this.s=t};u.setMeasure=function(t){this.m=t};return B}(),D=function(){function B(){}B.prototype.next=function(){return null};return B}();m.EmptyPlacementCursor=D;m.Placement=p;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/CIMSymbolDrawHelper":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/BidiText ../../core/fontUtils ../../core/lang ../../core/Logger ../../core/maybe ../../core/ObjectPool ../../core/screenUtils ../../geometry/support/aaBoundingRect ../../geometry/support/boundsUtils ../../geometry/support/centroid ../../geometry/support/jsonUtils ./CIMEffects ./CIMImageColorSubstitutionHelper ./CIMOperators ./CIMPlacements ./enums ./imageUtils ./Rect ./TextRasterizer ./utils ../../views/2d/engine/webgl/alignmentUtils ../../views/2d/engine/webgl/definitions ../../views/2d/engine/webgl/mesh/templates/shapingUtils".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d,a,c,f,g,n,k,x,r,v,q,y,A,w,z){function C(X,ca=1){const P=y.fromCIMFontDecoration(X);var J=y.fromCIMFontStyle(X.fontStyleName);const N=B.getFontFamily(X.fontFamilyName),{weight:S,style:Q}=J;J=ca*(X.height||5);const Y=y.fromCIMHorizontalAlignment(X.horizontalAlignment),ba=y.fromCIMVerticalAlignment(X.verticalAlignment),aa=y.getFillColor(X),I=y.getStrokeColor(X.haloSymbol);X=I?ca*(X.haloSize|0):0;return{color:aa,size:J,horizontalAlignment:Y,verticalAlignment:ba,font:{family:N,
style:y.getFontStyle(Q),weight:y.getFontWeight(S),decoration:P},halo:{size:X||0,color:I,style:Q},pixelRatio:1,premultiplyColors:!0}}const E=Math.PI/180,F=t.getLogger("esri.symbols.cim.CIMSymbolDrawHelper");let G=function(){function X(P){this._t=P}X.createIdentity=function(){return new X([1,0,0,0,1,0])};var ca=X.prototype;ca.clone=function(){return new X(this._t.slice())};ca.transform=function(P){const J=this._t;return[J[0]*P[0]+J[1]*P[1]+J[2],J[3]*P[0]+J[4]*P[1]+J[5]]};X.createScale=function(P,J){return new X([P,
0,0,0,J,0])};ca.scale=function(P,J){const N=this._t;N[0]*=P;N[1]*=P;N[2]*=P;N[3]*=J;N[4]*=J;N[5]*=J;return this};ca.scaleRatio=function(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])};X.createTranslate=function(P,J){return new X([0,0,P,0,0,J])};ca.translate=function(P,J){const N=this._t;N[2]+=P;N[5]+=J;return this};X.createRotate=function(P){const J=Math.cos(P);P=Math.sin(P);return new X([J,-P,0,P,J,0])};ca.rotate=function(P){return X.multiply(this,X.createRotate(P),this)};ca.angle=
function(){const P=this._t[0],J=this._t[3],N=Math.sqrt(P*P+J*J);return[P/N,J/N]};X.multiply=function(P,J,N){P=P._t;J=J._t;const S=P[1]*J[0]+P[4]*J[1],Q=P[2]*J[0]+P[5]*J[1]+J[2],Y=P[0]*J[3]+P[3]*J[4],ba=P[1]*J[3]+P[4]*J[4],aa=P[2]*J[3]+P[5]*J[4]+J[5],I=N._t;I[0]=P[0]*J[0]+P[3]*J[1];I[1]=S;I[2]=Q;I[3]=Y;I[4]=ba;I[5]=aa;return N};ca.invert=function(){const P=this._t;let J=P[0]*P[4]-P[1]*P[3];if(0===J)return new X([0,0,0,0,0,0]);J=1/J;return new X([P[4]*J,-P[1]*J,(P[1]*P[5]-P[2]*P[4])*J,-P[3]*J,P[0]*
J,(P[2]*P[3]-P[0]*P[5])*J])};return X}();t=function(){function X(P,J){this._resourceManager=P;this._transfos=[];this._sizeTransfos=[];this._geomUnitsPerPoint=1;this._placementPool=new l(k.Placement,void 0,void 0,100);this._earlyReturn=!1;this._mapRotation=0;this._transfos.push(J||G.createIdentity());this._sizeTransfos.push(J?J.scaleRatio():1)}var ca=X.prototype;ca.setTransform=function(P,J){this._transfos=[P||G.createIdentity()];this._sizeTransfos=[J?J:P?P.scaleRatio():1]};ca.setGeomUnitsPerPoint=
function(P){this._geomUnitsPerPoint=P};ca.transformPt=function(P){return this._transfos[this._transfos.length-1].transform(P)};ca.transformSize=function(P){return P*this._sizeTransfos[this._sizeTransfos.length-1]};ca.reverseTransformPt=function(P){return this._transfos[this._transfos.length-1].invert().transform(P)};ca.reverseTransformSize=function(P){return P/this._sizeTransfos[this._sizeTransfos.length-1]};ca.getTransformAngle=function(){return this._transfos[this._transfos.length-1].angle()};ca.geomUnitsPerPoint=
function(){return this.isEmbedded()?1:this._geomUnitsPerPoint};ca.isEmbedded=function(){return 1<this._transfos.length};ca.back=function(){return this._transfos[this._transfos.length-1]};ca.push=function(P,J){J=J?P.scaleRatio():1;G.multiply(P,this.back(),P);this._transfos.push(P);this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*J)};ca.pop=function(){this._transfos.splice(-1,1);this._sizeTransfos.splice(-1,1)};ca.drawSymbol=function(P,J,N){if(P)switch(P.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":this.drawMultiLayerSymbol(P,
J);break;case "CIMTextSymbol":this.drawTextSymbol(P,J,N)}};ca.drawMultiLayerSymbol=function(P,J){if(P&&J){var N=P.symbolLayers;if(N)if((P=P.effects)&&0<P.length){if(J=this.executeEffects(P,J))for(P=J.next();P;)this.drawSymbolLayers(N,P),P=J.next()}else this.drawSymbolLayers(N,J)}};ca.executeEffects=function(P,J){const N=this._resourceManager.geometryEngine;J=new f.SimpleGeometryCursor(J);for(const S of P)(P=n.getEffectOperator(S))&&(J=P.execute(J,S,this.geomUnitsPerPoint(),null,N));return J};ca.drawSymbolLayers=
function(P,J){let N=P.length;for(;N--;){const Q=P[N];if(Q&&!1!==Q.enable){var S=Q.effects;if(S&&0<S.length){if(S=this.executeEffects(S,J)){let Y=null;for(;(Y=S.next())&&(this.drawSymbolLayer(Q,Y),!this._earlyReturn););}}else this.drawSymbolLayer(Q,J);if(this._earlyReturn)break}}};ca.drawSymbolLayer=function(P,J){switch(P.type){case "CIMSolidFill":this.drawSolidFill(J,P.color);break;case "CIMHatchFill":this.drawHatchFill(J,P);break;case "CIMPictureFill":this.drawPictureFill(J,P);break;case "CIMGradientFill":this.drawGradientFill(J,
P);break;case "CIMSolidStroke":this.drawSolidStroke(J,P.color,P.width,P.capStyle,P.joinStyle,P.miterLimit);break;case "CIMPictureStroke":this.drawPictureStroke(J,P);break;case "CIMGradientStroke":this.drawGradientStroke(J,P);break;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":this.drawMarkerLayer(P,J)}};ca.drawHatchFill=function(P,J){const N=this._buildHatchPolyline(J,P,this.geomUnitsPerPoint());N&&(this.pushClipPath(P),this.drawMultiLayerSymbol(J.lineSymbol,N),this.popClipPath())};
ca.drawPictureFill=function(P,J){};ca.drawGradientFill=function(P,J){};ca.drawPictureStroke=function(P,J){};ca.drawGradientStroke=function(P,J){};ca.drawMarkerLayer=function(P,J){var N=P.markerPlacement;if(N){var S=n.getPlacementOperator(N);if(S){var Q="CIMMarkerPlacementInsidePolygon"===N.type||"CIMMarkerPlacementPolygonCenter"===N.type&&N.clipAtBoundary;Q&&this.pushClipPath(J);if(J=S.execute(J,N,this.geomUnitsPerPoint(),null,this._resourceManager.geometryEngine))for(N=null;(N=J.next())&&(this.drawMarker(P,
N),!this._earlyReturn););Q&&this.popClipPath()}}else{Q=this._placementPool.acquire();if(c.isPoint(J))Q.tx=J.x,Q.ty=J.y,this.drawMarker(P,Q);else if(c.isPolygon(J)){if(J=a.polygonCentroid(J))[Q.tx,Q.ty]=J,this.drawMarker(P,Q)}else for(S of J.points)if(Q.tx=S[0],Q.ty=S[1],this.drawMarker(P,Q),this._earlyReturn)break;this._placementPool.release(Q)}};ca.drawMarker=function(P,J){switch(P.type){case "CIMCharacterMarker":case "CIMPictureMarker":this.drawPictureMarker(P,J);break;case "CIMVectorMarker":this.drawVectorMarker(P,
J)}};ca.drawPictureMarker=function(P,J){if(P){var N=this._resourceManager.getResource(P.url),S=P.size??10;if(!(h.isNone(N)||0>=S)){var Q=N.width;N=N.height;if(Q&&N){N=Q/N;var Y=P.scaleX??1;Q=G.createIdentity();var ba=P.anchorPoint;if(ba){var aa=ba.x;ba=ba.y;"Absolute"!==P.anchorPointUnits&&(aa*=S*N*Y,ba*=S);Q.translate(-aa,-ba)}N=P.rotation??0;P.rotateClockwise&&(N=-N);this._mapRotation&&(N+=this._mapRotation);N&&Q.rotate(N*E);N=P.offsetX??0;Y=P.offsetY??0;if(N||Y){if(this._mapRotation){ba=E*this._mapRotation;
aa=Math.cos(ba);ba=Math.sin(ba);const I=N*ba+Y*aa;N=N*aa-Y*ba;Y=I}Q.translate(N,Y)}N=this.geomUnitsPerPoint();1!==N&&Q.scale(N,N);(N=J.getAngle())&&Q.rotate(N);Q.translate(J.tx,J.ty);this.push(Q,!1);this.drawImage(P,S);this.pop()}}}};ca.drawVectorMarker=function(P,J){if(P){var N=P.markerGraphics;if(N){var S=P.size??10,Q=P.frame,Y=Q?Q.ymax-Q.ymin:0;Y=S&&Y?S/Y:1;S=G.createIdentity();Q&&S.translate(.5*-(Q.xmax+Q.xmin),.5*-(Q.ymax+Q.ymin));var ba=P.anchorPoint;if(ba){var aa=ba.x;ba=ba.y;"Absolute"!==
P.anchorPointUnits?Q&&(aa*=Q.xmax-Q.xmin,ba*=Q.ymax-Q.ymin):(aa/=Y,ba/=Y);S.translate(-aa,-ba)}1!==Y&&S.scale(Y,Y);Q=P.rotation??0;P.rotateClockwise&&(Q=-Q);this._mapRotation&&(Q+=this._mapRotation);Q&&S.rotate(Q*E);Q=P.offsetX??0;Y=P.offsetY??0;if(Q||Y){if(this._mapRotation){ba=E*this._mapRotation;aa=Math.cos(ba);ba=Math.sin(ba);const I=Q*ba+Y*aa;Q=Q*aa-Y*ba;Y=I}S.translate(Q,Y)}Q=this.geomUnitsPerPoint();1!==Q&&S.scale(Q,Q);(Q=J.getAngle())&&S.rotate(Q);S.translate(J.tx,J.ty);this.push(S,P.scaleSymbolsProportionally);
for(const I of N)if(I&&I.symbol&&I.geometry||F.error("Invalid marker graphic",I),this.drawSymbol(I.symbol,I.geometry,I.textString),this._earlyReturn)break;this.pop()}}};ca.drawTextSymbol=function(P,J,N){if(P&&c.isPoint(J)&&!(0>=(P.height??10))){var S=G.createIdentity(),Q=P.angle??0;(Q=-Q)&&S.rotate(Q*E);Q=P.offsetX??0;var Y=P.offsetY??0;(Q||Y)&&S.translate(Q,Y);Q=this.geomUnitsPerPoint();1!==Q&&S.scale(Q,Q);S.translate(J.x,J.y);this.push(S,!1);this.drawText(P,N);this.pop()}};ca._buildHatchPolyline=
function(P,J,N){var S=(void 0!==P.separation?P.separation:4)*N,Q=void 0!==P.rotation?P.rotation:0;if(0===S)return null;0>S&&(S=-S);for(var Y=0,ba=.5*S;Y>ba;)Y-=S;for(;Y<-ba;)Y+=S;Y=b.create();d.getBoundsXY(Y,J);Y[0]-=ba;Y[1]-=ba;Y[2]+=ba;Y[3]+=ba;for(var aa=[[Y[0],Y[1]],[Y[0],Y[3]],[Y[2],Y[3]],[Y[2],Y[1]]];180<Q;)Q-=180;for(;0>Q;)Q+=180;ba=Math.cos(Q*E);var I=Math.sin(Q*E);Q=-S*I;J=S*ba;Y=(void 0!==P.offsetX?P.offsetX*N:0)*I-(void 0!==P.offsetY?P.offsetY*N:0)*ba;let O;var R=P=Number.MAX_VALUE;O=N=
-Number.MAX_VALUE;for(var V of aa){var W=V[0];const da=V[1];aa=ba*W+I*da;W=-I*W+ba*da;R=Math.min(R,aa);P=Math.min(P,W);O=Math.max(O,aa);N=Math.max(N,W)}P=Math.floor(P/S)*S;V=ba*R-I*P-Q*Y/S;R=I*R+ba*P-J*Y/S;aa=ba*O-I*P-Q*Y/S;Y=I*O+ba*P-J*Y/S;S=1+Math.round((N-P)/S);ba=[];for(I=0;I<S;I++)V+=Q,R+=J,aa+=Q,Y+=J,ba.push([[V,R],[aa,Y]]);return{paths:ba}};return X}();let H=function(X){function ca(J,N){J=X.call(this,J,N)||this;J.reset();return J}p._inheritsLoose(ca,X);var P=ca.prototype;P.reset=function(){this._xmin=
this._ymin=Infinity;this._xmax=this._ymax=-Infinity;this._clipCount=0};P.envelope=function(){return new v(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)};P.bounds=function(){return b.fromValues(this._xmin,this._ymin,this._xmax,this._ymax)};P.drawSolidFill=function(J){!J||0<this._clipCount||(c.isPolygon(J)?this._processPath(J.rings,0):c.isPolyline(J)?this._processPath(J.paths,0):c.isExtent(J)?(J=M(J))&&this._processPath(J.rings,0):console.error("drawSolidFill Unexpected geometry type!"))};
P.drawSolidStroke=function(J,N,S){!J||0<this._clipCount||(N=.5*this.transformSize(S??0),c.isPolygon(J)?this._processPath(J.rings,N):c.isPolyline(J)?this._processPath(J.paths,N):c.isExtent(J)?(J=M(J))&&this._processPath(J.rings,N):console.error("drawSolidStroke unexpected geometry type!"))};P.drawMarkerLayer=function(J,N){c.isPolygon(N)&&J.markerPlacement&&("CIMMarkerPlacementInsidePolygon"===J.markerPlacement.type||"CIMMarkerPlacementPolygonCenter"===J.markerPlacement.type&&J.markerPlacement.clipAtBoundary)?
this._processPath(N.rings,0):X.prototype.drawMarkerLayer.call(this,J,N)};P.drawHatchFill=function(J,N){this.drawSolidFill(J)};P.drawPictureFill=function(J,N){this.drawSolidFill(J)};P.drawGradientFill=function(J,N){this.drawSolidFill(J)};P.drawPictureStroke=function(J,N){this.drawSolidStroke(J,null,N.width)};P.drawGradientStroke=function(J,N){this.drawSolidStroke(J,null,N.width)};P.pushClipPath=function(J){this.drawSolidFill(J);this._clipCount++};P.popClipPath=function(){this._clipCount--};P.drawImage=
function(J,N){var {url:S}=J;J=J.scaleX??1;let Q=J*N,Y=N;S=this._resourceManager.getResource(S);!N&&h.isSome(S)&&(Q=J*S.width,Y=S.height);this._merge(this.transformPt([-Q/2,-Y/2]),0);this._merge(this.transformPt([-Q/2,Y/2]),0);this._merge(this.transformPt([Q/2,-Y/2]),0);this._merge(this.transformPt([Q/2,Y/2]),0)};P.drawText=function(J,N){if(N&&0!==N.length){this._textRasterizer||(this._textRasterizer=new q);var S=C(J),[Q,Y]=this._textRasterizer.computeTextSize(N,S);N=0;switch(J.horizontalAlignment){case "Left":N=
Q/2;break;case "Right":N=-Q/2}S=0;switch(J.verticalAlignment){case "Bottom":S=Y/2;break;case "Top":S=-Y/2;break;case "Baseline":S=Y/6}this._merge(this.transformPt([-Q/2+N,-Y/2+S]),0);this._merge(this.transformPt([-Q/2+N,Y/2+S]),0);this._merge(this.transformPt([Q/2+N,-Y/2+S]),0);this._merge(this.transformPt([Q/2+N,Y/2+S]),0)}};P._processPath=function(J,N){if(J)for(const S of J)if(J=S?S.length:0,1<J){this._merge(this.transformPt(S[0]),N);for(let Q=1;Q<J;Q++)this._merge(this.transformPt(S[Q]),N)}};P._merge=
function(J,N){J[0]-N<this._xmin&&(this._xmin=J[0]-N);J[0]+N>this._xmax&&(this._xmax=J[0]+N);J[1]-N<this._ymin&&(this._ymin=J[1]-N);J[1]+N>this._ymax&&(this._ymax=J[1]+N)};return ca}(t),L=function(X){function ca(){var J=X.apply(this,arguments)||this;J._searchPoint=[0,0];J._searchDistPoint=0;J._textInfo=null;return J}p._inheritsLoose(ca,X);var P=ca.prototype;P.hitTest=function(J,N,S,Q,Y,ba){ba*=e.pt2px(1);this.setTransform();this.setGeomUnitsPerPoint(ba);this._searchPoint=[(J[0]+J[2])/2,(J[1]+J[3])/
2];this._searchDistPoint=(J[2]-J[0])/2/ba;this._textInfo=Q;this._mapRotation=N&&("CIMPointSymbol"===N.type&&"Map"!==N.angleAlignment||"CIMTextSymbol"===N.type)?Y:0;this._earlyReturn=!1;this.drawSymbol(N,S);return this._earlyReturn};P.drawSolidFill=function(J,N){this._hitTestFill(J)};P.drawHatchFill=function(J,N){this._hitTestFill(J)};P.drawPictureFill=function(J,N){this._hitTestFill(J)};P.drawGradientFill=function(J,N){this._hitTestFill(J)};P.drawSolidStroke=function(J,N,S,Q,Y,ba){this._hitTestStroke(J,
S)};P.drawPictureStroke=function(J,N){this._hitTestStroke(J,N.width)};P.drawGradientStroke=function(J,N){this._hitTestStroke(J,N.width)};P.drawMarkerLayer=function(J,N){J.markerPlacement&&("CIMMarkerPlacementInsidePolygon"===J.markerPlacement.type||"CIMMarkerPlacementPolygonCenter"===J.markerPlacement.type&&J.markerPlacement.clipAtBoundary)?this._hitTestFill(N):X.prototype.drawMarkerLayer.call(this,J,N)};P.pushClipPath=function(J){};P.popClipPath=function(){};P.drawImage=function(J,N){var {url:S}=
J;J=J.scaleX??1;S=this._resourceManager.getResource(S);if(!h.isNone(S)&&0!==S.height&&0!==N){N*=this.geomUnitsPerPoint();J=S.width/S.height*J*N;S=this.reverseTransformPt(this._searchPoint);var Q=this._searchDistPoint;Math.abs(S[0])<J/2+Q&&Math.abs(S[1])<N/2+Q&&(this._earlyReturn=!0)}};P.drawText=function(J,N){if(N=this._textInfo)if(N=N.get(J)){var {text:S,mosaicItem:Q}=N;if(Q?.glyphMosaicItems?.length){N=J.height??10;var {lineGapType:Y,lineGap:ba}=J,aa=Y?Z(Y,ba??0,N):0,I=D.bidiText(S)[1],O="CIMBackgroundCallout"===
J.callout?.type;J=z.shapeGlyphs(Q.glyphMosaicItems,I,{scale:N/w.GLYPH_SIZE,angle:0,xOffset:0,yOffset:0,hAlign:U(J.horizontalAlignment),vAlign:T(J.verticalAlignment),maxLineWidth:512,lineHeight:w.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(aa||1,4)),decoration:J.font.decoration||"none",isCIM:!0,hasBackground:O});aa=this.reverseTransformPt(this._searchPoint);N=aa[0];aa=aa[1];for(const R of J.glyphs)if(N>R.xTopLeft&&N<R.xBottomRight&&aa>-R.yBottomRight&&aa<-R.yTopLeft){this._earlyReturn=!0;break}}}};
P._hitTestFill=function(J){let N=null;if(c.isExtent(J))N=[[[J.xmin,J.ymin],[J.xmin,J.ymax],[J.xmax,J.ymax],[J.xmax,J.ymin],[J.xmin,J.ymin]]];else if(c.isPolygon(J))N=J.rings;else if(c.isPolyline(J))N=J.paths;else return;J=this.reverseTransformPt(this._searchPoint);this._pointInPolygon(J,N)&&(this._earlyReturn=!0);if(!this._earlyReturn){const S=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(J,N,S)&&(this._earlyReturn=!0)}};P._hitTestStroke=function(J,N){let S=
null;if(c.isExtent(J))S=[[[J.xmin,J.ymin],[J.xmin,J.ymax],[J.xmax,J.ymax],[J.xmax,J.ymin],[J.xmin,J.ymin]]];else if(c.isPolygon(J))S=J.rings;else if(c.isPolyline(J))S=J.paths;else return;J=this.reverseTransformPt(this._searchPoint);N=(N??0)*this.geomUnitsPerPoint();const Q=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(J,S,N/2+Q)&&(this._earlyReturn=!0)};P._pointInPolygon=function(J,N){let S=0;for(const Q of N){N=Q.length;for(let Y=1;Y<N;Y++){const ba=Q[Y-
1],aa=Q[Y];ba[1]>J[1]!==aa[1]>J[1]&&(0<(aa[0]-ba[0])*(J[1]-ba[1])-(aa[1]-ba[1])*(J[0]-ba[0])?S++:S--)}}return 0!==S};P._nearLine=function(J,N,S){for(const Y of N){N=Y.length;for(let ba=1;ba<N;ba++){var Q=Y[ba-1];const aa=Y[ba];let I=(aa[0]-Q[0])*(aa[0]-Q[0])+(aa[1]-Q[1])*(aa[1]-Q[1]);if(0!==I&&(I=Math.sqrt(I),Math.abs(((aa[0]-Q[0])*(J[1]-Q[1])-(aa[1]-Q[1])*(J[0]-Q[0]))/I)<S&&(Q=((aa[0]-Q[0])*(J[0]-Q[0])+(aa[1]-Q[1])*(J[1]-Q[1]))/I,Q>-S&&Q<I+S)))return!0}}return!1};return ca}(t),K=function(X){function ca(J,
N,S,Q){N=X.call(this,N,S)||this;N._applyAdditionalRenderProps=Q;N._colorSubstitutionHelper=new g;N._ctx=J;return N}p._inheritsLoose(ca,X);var P=ca.prototype;P.drawSolidFill=function(J,N){if(J){if(c.isPolygon(J))this._buildPath(J.rings,!0);else if(c.isPolyline(J))this._buildPath(J.paths,!0);else if(c.isExtent(J))this._buildPath(M(J).rings,!0);else if(c.isMultipoint(J))console.log("CanvasDrawHelper.drawSolidFill - No implementation!");else return;J=this._ctx;J.fillStyle="string"===typeof N?N:"rgba("+
Math.round(N[0])+","+Math.round(N[1])+","+Math.round(N[2])+","+(N[3]??255)/255+")";J.fill("evenodd")}};P.drawSolidStroke=function(J,N,S,Q,Y,ba){if(J&&N&&0!==S){if(c.isPolygon(J))this._buildPath(J.rings,!0);else if(c.isPolyline(J))this._buildPath(J.paths,!1);else if(c.isExtent(J))this._buildPath(M(J).rings,!0);else{console.log("CanvasDrawHelper.drawSolidStroke isn't implemented!");return}J=this._ctx;J.strokeStyle="string"===typeof N?N:"rgba("+Math.round(N[0])+","+Math.round(N[1])+","+Math.round(N[2])+
","+(N[3]??255)/255+")";J.lineWidth=Math.max(this.transformSize(S),.5);this._setCapStyle(Q);this._setJoinStyle(Y);J.miterLimit=ba;J.stroke()}};P.pushClipPath=function(J){this._ctx.save();if(c.isPolygon(J))this._buildPath(J.rings,!0);else if(c.isPolyline(J))this._buildPath(J.paths,!0);else if(c.isExtent(J))this._buildPath(M(J).rings,!0);else return;this._ctx.clip("evenodd")};P.popClipPath=function(){this._ctx.restore()};P.drawImage=function(J,N){const {colorSubstitutions:S,url:Q,tintColor:Y}=J;J=J.scaleX??
1;var ba=this._resourceManager.getResource(Q);if(!h.isNone(ba)){var aa=ba.width/ba.height*N,I=N;N||(aa=ba.width,I=ba.height);var O=y.isSVGImage(Q)||"src"in ba&&y.isSVGImage(ba.src);N="getFrame"in ba?r.getFirstFrame(ba):ba;S&&(N=this._colorSubstitutionHelper.applyColorSubstituition(N,S));this._applyAdditionalRenderProps&&!O&&Y&&(N=this._colorSubstitutionHelper.tintImageData(N,Y));ba=this.transformPt([0,0]);var [R,V]=this.getTransformAngle();O=this.transformSize(1);var W=this._ctx;W.save();W.setTransform({m11:J*
O*R,m12:J*O*V,m21:-O*V,m22:O*R,m41:ba[0],m42:ba[1]});W.drawImage(N,-aa/2,-I/2,aa,I);W.restore()}};P.drawText=function(J,N){if(N&&0!==N.length&&(this._textRasterizer||(this._textRasterizer=new q),J=C(J),J.size*=this.transformSize(e.px2pt(1)),N=this._textRasterizer.rasterizeText(N,J))){var {size:S,anchorX:Q,anchorY:Y,canvas:ba}=N;N=S[0]*(Q+.5);J=S[1]*(Y-.5);var aa=this._ctx,I=this.transformPt([0,0]),[O,R]=this.getTransformAngle();aa.save();aa.setTransform({m11:1*O,m12:1*R,m21:-1*R,m22:1*O,m41:I[0]-
1*N,m42:I[1]+1*J});aa.drawImage(ba,0,0);aa.restore()}};P.drawPictureFill=function(J,N){if(J){var {colorSubstitutions:S,height:Q,offsetX:Y,offsetY:ba,rotation:aa,scaleX:I,tintColor:O,url:R}=N;N=this._resourceManager.getResource(R);if(!h.isNone(N)){if(c.isPolygon(J))this._buildPath(J.rings,!0);else if(c.isPolyline(J))this._buildPath(J.paths,!0);else if(c.isExtent(J))this._buildPath(M(J).rings,!0);else if(c.isMultipoint(J))console.log("CanvasDrawHelper.drawPictureFill - No implementation!");else return;
J=this._ctx;var V=y.isSVGImage(R)||"src"in N&&y.isSVGImage(N.src),W="getFrame"in N?r.getFirstFrame(N):N;S&&(W=this._colorSubstitutionHelper.applyColorSubstituition(W,S));if(this._applyAdditionalRenderProps){if(V||O&&(W=this._colorSubstitutionHelper.tintImageData(W,O)),V=J.createPattern(W,"repeat"),W=this.transformSize(1),aa||(aa=0),Y=Y?W*Y:0,ba=ba?W*ba:0,Q&&(Q*=W),W=Q?Q/N.height:1,N=I&&Q?I*Q/N.width:1,0!==aa||1!==W||1!==N||0!==Y||0!==ba){const da=new DOMMatrix;da.rotateSelf(0,0,-aa).translateSelf(Y,
ba).scaleSelf(N,W,1);V.setTransform(da)}}else V=J.createPattern(W,"repeat");J.save();J.fillStyle=V;J.fill("evenodd");J.restore()}}};P.drawPictureStroke=function(J,N){if(J){var {colorSubstitutions:S,capStyle:Q,joinStyle:Y,miterLimit:ba,tintColor:aa,url:I,width:O}=N;N=this._resourceManager.getResource(I);if(!h.isNone(N)){if(c.isPolygon(J))var R=J.rings;else if(c.isPolyline(J))R=J.paths;else if(c.isExtent(J))R=M(J).rings;else{c.isMultipoint(J)&&console.log("CanvasDrawHelper.drawPictureStroke - No implementation!");
return}O||(O=N.width);J=y.isSVGImage(I)||"src"in N&&y.isSVGImage(N.src);var V="getFrame"in N?r.getFirstFrame(N):N;S&&(V=this._colorSubstitutionHelper.applyColorSubstituition(V,S));this._applyAdditionalRenderProps&&(J||aa&&(V=this._colorSubstitutionHelper.tintImageData(V,aa)));N=Math.max(this.transformSize(e.pt2px(O)),.5);J=N/V.width;var W=this._ctx;V=W.createPattern(V,"repeat-y");W.save();this._setCapStyle(Q);this._setJoinStyle(Y);void 0!==ba&&(W.miterLimit=ba);W.lineWidth=N;var da;for(let la of R){la=
u.clone(la);var ea=da=void 0,fa=void 0;let ka=ea=void 0;R=la;for(var ha=R[0],ia=1;ia<R.length;)ka=R[ia][0]-ha[0],ea=R[ia][1]-ha[1],ea=0!==ka?ea/ka:Math.PI/2,void 0!==fa&&1E-4>=ea-fa?(R.splice(ia-1,1),ha=da):(da=ha,ha=R[ia],ia++),fa=ea;if(la&&!(1>=la.length))for(R=this.transformPt(la[0]),fa=1;fa<la.length;fa++)da=this.transformPt(la[fa]),ha=180/Math.PI*Math.atan2(da[1]-R[1],da[0]-R[0]),ia=new DOMMatrix,ia.translateSelf(0,R[1]-N/2).scaleSelf(J,J,1).rotateSelf(0,0,90-ha),V.setTransform(ia),W.strokeStyle=
V,W.beginPath(),W.moveTo(R[0],R[1]),W.lineTo(da[0],da[1]),W.stroke(),R=da}W.restore()}}};P._buildPath=function(J,N){const S=this._ctx;S.beginPath();if(J)for(const Q of J)if(J=Q?Q.length:0,1<J){let Y=this.transformPt(Q[0]);S.moveTo(Y[0],Y[1]);for(let ba=1;ba<J;ba++)Y=this.transformPt(Q[ba]),S.lineTo(Y[0],Y[1]);N&&S.closePath()}};P._setCapStyle=function(J){switch(J){case x.LineCapStyle.Butt:this._ctx.lineCap="butt";break;case x.LineCapStyle.Round:this._ctx.lineCap="round";break;case x.LineCapStyle.Square:this._ctx.lineCap=
"square"}};P._setJoinStyle=function(J){switch(J){case x.LineJoinStyle.Bevel:this._ctx.lineJoin="bevel";break;case x.LineJoinStyle.Round:this._ctx.lineJoin="round";break;case x.LineJoinStyle.Miter:this._ctx.lineJoin="miter"}};return ca}(t);const M=X=>X?{spatialReference:X.spatialReference,rings:[[[X.xmin,X.ymin],[X.xmin,X.ymax],[X.xmax,X.ymax],[X.xmax,X.ymin],[X.xmin,X.ymin]]]}:null,U=X=>{switch(X){case "Left":return A.HAlign.Left;case "Right":return A.HAlign.Right;case "Center":return A.HAlign.Center;
case "Justify":return F.warnOnce("Horizontal alignment 'justify' is not implemented. Falling back to 'center'."),A.HAlign.Center}},T=X=>{switch(X){case "Top":return A.VAlign.Top;case "Center":return A.VAlign.Center;case "Bottom":return A.VAlign.Bottom;case "Baseline":return A.VAlign.Baseline}},Z=(X,ca,P)=>{switch(X){case "ExtraLeading":return 1+ca/P;case "Multiple":return ca;case "Exact":return ca/P}};m.CIMSymbolDrawHelper=t;m.C_DEG_TO_RAD=E;m.CanvasDrawHelper=K;m.EnvDrawHelper=H;m.HittestDrawHelper=
L;m.Transformation=G;m.horizontalAlignment2HAlign=U;m.lineGapType2LineHeight=Z;m.verticalAlignment2VAlign=T;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/CIMEffects":function(){define(["exports","../../core/lang","../../geometry/support/TileClipper"],function(m,p,D){let B,u=function(){function t(h){this._geometry=h}t.prototype.next=function(){const h=this._geometry;this._geometry=null;return h};return t}();m.SimpleGeometryCursor=u;m.clipPolygonToTileExtent=function(t,
h){B||(B=new D.TileClipper(0,0,0,1));B.reset(D.GeometryType.Polygon);B.setPixelMargin(h+1);B.setExtent(512);for(var l of t.rings)if(l&&!(3>l.length)){t=l[0][0];h=-l[0][1];B.moveTo(t,h);for(let e=1;e<l.length;e++)t=l[e][0],h=-l[e][1],B.lineTo(t,h);B.close()}if(t=B.result(!1)){l=[];for(const e of t){t=[];l.push(t);for(const b of e)t.push([b.x,-b.y])}return{rings:l}}return{rings:[]}};m.clipPolylineToTileExtent=function(t,h){B||(B=new D.TileClipper(0,0,0,1));B.reset(D.GeometryType.LineString);B.setPixelMargin(h+
1);B.setExtent(512);for(var l of t.paths)if(l&&!(2>l.length)){t=l[0][0];h=-l[0][1];B.moveTo(t,h);for(let e=1;e<l.length;e++)t=l[e][0],h=-l[e][1],B.lineTo(t,h)}if(t=B.result(!1)){l=[];for(const e of t){t=[];l.push(t);for(const b of e)t.push([b.x,-b.y])}return{paths:l}}return{paths:[]}};m.clone=function(t){return p.clone(t)};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/TileClipper":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers"],function(m,
p){m.GeometryType=void 0;(function(b){b[b.Unknown=0]="Unknown";b[b.Point=1]="Point";b[b.LineString=2]="LineString";b[b.Polygon=3]="Polygon"})(m.GeometryType||(m.GeometryType={}));let D=function(){function b(a,c){this.x=a;this.y=c}var d=b.prototype;d.clone=function(){return new b(this.x,this.y)};d.equals=function(a,c){return a===this.x&&c===this.y};d.isEqual=function(a){return a.x===this.x&&a.y===this.y};d.setCoords=function(a,c){this.x=a;this.y=c};d.normalize=function(){var a=this.x;const c=this.y;
a=Math.sqrt(a*a+c*c);this.x/=a;this.y/=a};d.rightPerpendicular=function(){const a=this.x;this.x=this.y;this.y=-a};d.move=function(a,c){this.x+=a;this.y+=c};d.assign=function(a){this.x=a.x;this.y=a.y};d.assignAdd=function(a,c){this.x=a.x+c.x;this.y=a.y+c.y};d.assignSub=function(a,c){this.x=a.x-c.x;this.y=a.y-c.y};d.rotate=function(a,c){const f=this.x,g=this.y;this.x=f*a-g*c;this.y=f*c+g*a};d.scale=function(a){this.x*=a;this.y*=a};d.length=function(){const a=this.x,c=this.y;return Math.sqrt(a*a+c*c)};
b.distance=function(a,c){const f=c.x-a.x;a=c.y-a.y;return Math.sqrt(f*f+a*a)};b.add=function(a,c){return new b(a.x+c.x,a.y+c.y)};b.sub=function(a,c){return new b(a.x-c.x,a.y-c.y)};return b}(),B=function(b,d,a){this.ratio=b;this.x=d;this.y=a},u=function(){function b(a,c,f,g=8,n=8){this._lines=[];this._starts=[];this.validateTessellation=!0;this._pixelRatio=g;this._pixelMargin=n;this._tileSize=512*g;this._dz=a;this._yPos=c;this._xPos=f}var d=b.prototype;d.setPixelMargin=function(a){a!==this._pixelMargin&&
(this._pixelMargin=a,this.setExtent(this._extent))};d.setExtent=function(a){this._extent=a;this._finalRatio=this._tileSize/a*(1<<this._dz);let c=this._pixelRatio*this._pixelMargin;c/=this._finalRatio;a>>=this._dz;c>a&&(c=a);this._margin=c;this._xmin=a*this._xPos-c;this._ymin=a*this._yPos-c;this._xmax=this._xmin+a+2*c;this._ymax=this._ymin+a+2*c};d.reset=function(a){this._type=a;this._lines=[];this._starts=[];this._line=null;this._start=0};d.moveTo=function(a,c){this._pushLine();this._prevIsIn=this._isIn(a,
c);this._moveTo(a,c,this._prevIsIn);this._prevPt=new D(a,c);this._firstPt=new D(a,c);this._dist=0};d.lineTo=function(a,c){const f=this._isIn(a,c),g=new D(a,c),n=D.distance(this._prevPt,g);if(f)if(this._prevIsIn)this._lineTo(a,c,!0);else{var k=this._prevPt;var x=g;a=this._intersect(x,k);this._start=this._dist+n*(1-this._r);this._lineTo(a.x,a.y,!0);this._lineTo(x.x,x.y,!0)}else if(this._prevIsIn)x=this._prevPt,k=g,a=this._intersect(x,k),this._lineTo(a.x,a.y,!0),this._lineTo(k.x,k.y,!1);else{const v=
this._prevPt;if(!(v.x<=this._xmin&&g.x<=this._xmin||v.x>=this._xmax&&g.x>=this._xmax||v.y<=this._ymin&&g.y<=this._ymin||v.y>=this._ymax&&g.y>=this._ymax)){a=[];if(v.x<this._xmin&&g.x>this._xmin||v.x>this._xmin&&g.x<this._xmin){c=(this._xmin-v.x)/(g.x-v.x);var r=v.y+c*(g.y-v.y);r<=this._ymin?x=!1:r>=this._ymax?x=!0:a.push(new B(c,this._xmin,r))}if(v.x<this._xmax&&g.x>this._xmax||v.x>this._xmax&&g.x<this._xmax)c=(this._xmax-v.x)/(g.x-v.x),r=v.y+c*(g.y-v.y),r<=this._ymin?x=!1:r>=this._ymax?x=!0:a.push(new B(c,
this._xmax,r));if(v.y<this._ymin&&g.y>this._ymin||v.y>this._ymin&&g.y<this._ymin)c=(this._ymin-v.y)/(g.y-v.y),r=v.x+c*(g.x-v.x),r<=this._xmin?k=!1:r>=this._xmax?k=!0:a.push(new B(c,r,this._ymin));if(v.y<this._ymax&&g.y>this._ymax||v.y>this._ymax&&g.y<this._ymax)c=(this._ymax-v.y)/(g.y-v.y),r=v.x+c*(g.x-v.x),r<=this._xmin?k=!1:r>=this._xmax?k=!0:a.push(new B(c,r,this._ymax));if(0===a.length)k?x?this._lineTo(this._xmax,this._ymax,!0):this._lineTo(this._xmax,this._ymin,!0):x?this._lineTo(this._xmin,
this._ymax,!0):this._lineTo(this._xmin,this._ymin,!0);else if(1<a.length&&a[0].ratio>a[1].ratio)this._start=this._dist+n*a[1].ratio,this._lineTo(a[1].x,a[1].y,!0),this._lineTo(a[0].x,a[0].y,!0);else for(this._start=this._dist+n*a[0].ratio,k=0;k<a.length;k++)this._lineTo(a[k].x,a[k].y,!0)}this._lineTo(g.x,g.y,!1)}this._dist+=n;this._prevIsIn=f;this._prevPt=g};d.close=function(){if(2<this._line.length){var a=this._firstPt,c=this._prevPt;a.x===c.x&&a.y===c.y||this.lineTo(a.x,a.y);a=this._line;for(c=
a.length;4<=c;)if(a[0].x===a[1].x&&a[0].x===a[c-2].x||a[0].y===a[1].y&&a[0].y===a[c-2].y)a.pop(),a[0].x=a[c-2].x,a[0].y=a[c-2].y,--c;else break}};d.result=function(a=!0){this._pushLine();if(0===this._lines.length)return null;this._type===m.GeometryType.Polygon&&a&&l.simplify(this._tileSize,this._margin*this._finalRatio,this._lines);return this._lines};d.resultWithStarts=function(){if(this._type!==m.GeometryType.LineString)throw Error("Only valid for lines");this._pushLine();const a=this._lines,c=
a.length;if(0===c)return null;const f=[];for(let g=0;g<c;g++)f.push({line:a[g],start:this._starts[g]||0});return f};d._isIn=function(a,c){return a>=this._xmin&&a<=this._xmax&&c>=this._ymin&&c<=this._ymax};d._intersect=function(a,c){let f,g,n;if(c.x>=this._xmin&&c.x<=this._xmax)g=c.y<=this._ymin?this._ymin:this._ymax,n=(g-a.y)/(c.y-a.y),f=a.x+n*(c.x-a.x);else if(c.y>=this._ymin&&c.y<=this._ymax)f=c.x<=this._xmin?this._xmin:this._xmax,n=(f-a.x)/(c.x-a.x),g=a.y+n*(c.y-a.y);else{g=c.y<=this._ymin?this._ymin:
this._ymax;f=c.x<=this._xmin?this._xmin:this._xmax;const k=(f-a.x)/(c.x-a.x),x=(g-a.y)/(c.y-a.y);k<x?(n=k,g=a.y+k*(c.y-a.y)):(n=x,f=a.x+x*(c.x-a.x))}this._r=n;return new D(f,g)};d._pushLine=function(){this._line&&(this._type===m.GeometryType.Point?0<this._line.length&&(this._lines.push(this._line),this._starts.push(this._start)):this._type===m.GeometryType.LineString?1<this._line.length&&(this._lines.push(this._line),this._starts.push(this._start)):this._type===m.GeometryType.Polygon&&3<this._line.length&&
(this._lines.push(this._line),this._starts.push(this._start)));this._line=[];this._start=0};d._moveTo=function(a,c,f){this._type!==m.GeometryType.Polygon?f&&(a=Math.round((a-(this._xmin+this._margin))*this._finalRatio),c=Math.round((c-(this._ymin+this._margin))*this._finalRatio),this._line.push(new D(a,c))):(f||(a<this._xmin&&(a=this._xmin),a>this._xmax&&(a=this._xmax),c<this._ymin&&(c=this._ymin),c>this._ymax&&(c=this._ymax)),a=Math.round((a-(this._xmin+this._margin))*this._finalRatio),c=Math.round((c-
(this._ymin+this._margin))*this._finalRatio),this._line.push(new D(a,c)),this._isV=this._isH=!1)};d._lineTo=function(a,c,f){if(this._type!==m.GeometryType.Polygon)if(f){a=Math.round((a-(this._xmin+this._margin))*this._finalRatio);c=Math.round((c-(this._ymin+this._margin))*this._finalRatio);if(0<this._line.length&&(f=this._line[this._line.length-1],f.equals(a,c)))return;this._line.push(new D(a,c))}else this._line&&0<this._line.length&&this._pushLine();else if(f||(a<this._xmin&&(a=this._xmin),a>this._xmax&&
(a=this._xmax),c<this._ymin&&(c=this._ymin),c>this._ymax&&(c=this._ymax)),a=Math.round((a-(this._xmin+this._margin))*this._finalRatio),c=Math.round((c-(this._ymin+this._margin))*this._finalRatio),this._line&&0<this._line.length){f=this._line[this._line.length-1];const g=f.x===a,n=f.y===c;g&&n||(this._isH&&g?(f.x=a,f.y=c,f=this._line[this._line.length-2],f.x===a&&f.y===c?(this._line.pop(),1>=this._line.length?this._isV=this._isH=!1:(f=this._line[this._line.length-2],this._isH=f.x===a,this._isV=f.y===
c)):(this._isH=f.x===a,this._isV=f.y===c)):this._isV&&n?(f.x=a,f.y=c,f=this._line[this._line.length-2],f.x===a&&f.y===c?(this._line.pop(),1>=this._line.length?this._isV=this._isH=!1:(f=this._line[this._line.length-2],this._isH=f.x===a,this._isV=f.y===c)):(this._isH=f.x===a,this._isV=f.y===c)):(this._line.push(new D(a,c)),this._isH=g,this._isV=n))}else this._line.push(new D(a,c))};return b}(),t=function(){function b(){}var d=b.prototype;d.setExtent=function(a){this._ratio=4096===a?1:4096/a};d.reset=
function(a){this._lines=[];this._line=null};d.moveTo=function(a,c){this._line&&this._lines.push(this._line);this._line=[];const f=this._ratio;this._line.push(new D(a*f,c*f))};d.lineTo=function(a,c){const f=this._ratio;this._line.push(new D(a*f,c*f))};d.close=function(){const a=this._line;a&&!a[0].isEqual(a[a.length-1])&&a.push(a[0])};d.result=function(){this._line&&this._lines.push(this._line);return 0===this._lines.length?null:this._lines};p._createClass(b,[{key:"validateTessellation",get:function(){return 1>
this._ratio}}]);return b}();var h;(function(b){b[b.sideLeft=0]="sideLeft";b[b.sideRight=1]="sideRight";b[b.sideTop=2]="sideTop";b[b.sideBottom=3]="sideBottom"})(h||(h={}));let l=function(){function b(){}b.simplify=function(d,a,c){if(c){var f=-a,g=d+a,n=-a,k=d+a;d=[];a=[];var x=c.length;for(let r=0;r<x;++r){const v=c[r];if(!v||2>v.length)continue;let q=v[0],y;const A=v.length;for(let w=1;w<A;++w)y=v[w],q.x===y.x&&(q.x<=f&&(q.y>y.y?(d.push(r),d.push(w),d.push(h.sideLeft),d.push(-1)):(a.push(r),a.push(w),
a.push(h.sideLeft),a.push(-1))),q.x>=g&&(q.y<y.y?(d.push(r),d.push(w),d.push(h.sideRight),d.push(-1)):(a.push(r),a.push(w),a.push(h.sideRight),a.push(-1)))),q.y===y.y&&(q.y<=n&&(q.x<y.x?(d.push(r),d.push(w),d.push(h.sideTop),d.push(-1)):(a.push(r),a.push(w),a.push(h.sideTop),a.push(-1))),q.y>=k&&(q.x>y.x?(d.push(r),d.push(w),d.push(h.sideBottom),d.push(-1)):(a.push(r),a.push(w),a.push(h.sideBottom),a.push(-1)))),q=y}0!==d.length&&0!==a.length&&(b.fillParent(c,a,d),b.fillParent(c,d,a),f=[],b.calcDeltas(f,
a,d),b.calcDeltas(f,d,a),b.addDeltas(f,c))}};b.fillParent=function(d,a,c){const f=c.length,g=a.length;for(let v=0;v<g;v+=4){var n=a[v],k=a[v+1];const q=a[v+2],y=d[n][k-1];n=d[n][k];k=8092;let A=-1;for(let w=0;w<f;w+=4){if(c[w+2]!==q)continue;var x=c[w];const z=c[w+1];var r=d[x][z-1];x=d[x][z];switch(q){case h.sideLeft:case h.sideRight:e(y.y,r.y,x.y)&&e(n.y,r.y,x.y)&&(r=Math.abs(x.y-r.y),r<k&&(k=r,A=w));break;case h.sideTop:case h.sideBottom:e(y.x,r.x,x.x)&&e(n.x,r.x,x.x)&&(r=Math.abs(x.x-r.x),r<k&&
(k=r,A=w))}}a[v+3]=A}};b.calcDeltas=function(d,a,c){const f=a.length;for(let g=0;g<f;g+=4){const n=b.calcDelta(g,a,c,[]);d.push(a[g]);d.push(a[g+1]);d.push(a[g+2]);d.push(n)}};b.calcDelta=function(d,a,c,f){d=a[d+3];if(-1===d)return 0;const g=f.length;if(1<g&&f[g-2]===d)return 0;f.push(d);return b.calcDelta(d,c,a,f)+1};b.addDeltas=function(d,a){const c=d.length;let f=0;for(var g=0;g<c;g+=4){var n=d[g+3];n>f&&(f=n)}for(g=0;g<c;g+=4){n=a[d[g]];const k=d[g+1],x=f-d[g+3];switch(d[g+2]){case h.sideLeft:n[k-
1].x-=x;n[k].x-=x;1===k&&(n[n.length-1].x-=x);k===n.length-1&&(n[0].x-=x);break;case h.sideRight:n[k-1].x+=x;n[k].x+=x;1===k&&(n[n.length-1].x+=x);k===n.length-1&&(n[0].x+=x);break;case h.sideTop:n[k-1].y-=x;n[k].y-=x;1===k&&(n[n.length-1].y-=x);k===n.length-1&&(n[0].y-=x);break;case h.sideBottom:n[k-1].y+=x,n[k].y+=x,1===k&&(n[n.length-1].y+=x),k===n.length-1&&(n[0].y+=x)}}};return b}();const e=(b,d,a)=>b>=d&&b<=a||b>=a&&b<=d;m.Point=D;m.SimpleBuilder=t;m.TileClipper=u;Object.defineProperty(m,Symbol.toStringTag,
{value:"Module"})})},"esri/symbols/cim/CIMImageColorSubstitutionHelper":function(){define(function(){return function(){function m(){}var p=m.prototype;p.applyColorSubstituition=function(D,B){if(!B)return D;this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));const {width:u,height:t}=D,h=this._rasterizationCanvas,l=h.getContext("2d");D!==h&&(h.width=u,h.height=t,l.drawImage(D,0,0,u,t));D=l.getImageData(0,0,u,t).data;if(B)for(var e of B)if(e&&e.oldColor&&4===e.oldColor.length&&
e.newColor&&4===e.newColor.length){const [b,d,a,c]=e.oldColor,[f,g,n,k]=e.newColor;if(b!==f||d!==g||a!==n||c!==k)for(B=0;B<D.length;B+=4)b===D[B]&&d===D[B+1]&&a===D[B+2]&&c===D[B+3]&&(D[B]=f,D[B+1]=g,D[B+2]=n,D[B+3]=k)}e=new ImageData(D,u,t);l.putImageData(e,0,0);return h};p.tintImageData=function(D,B){if(!B||4>B.length)return D;this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));const {width:u,height:t}=D,h=this._rasterizationCanvas,l=h.getContext("2d");D!==h&&
(h.width=u,h.height=t,l.drawImage(D,0,0,u,t));D=l.getImageData(0,0,u,t);D=new Uint8Array(D.data);B=[B[0]/255,B[1]/255,B[2]/255,B[3]/255];for(let e=0;e<D.length;e+=4)D[e+0]*=B[0],D[e+1]*=B[1],D[e+2]*=B[2],D[e+3]*=B[3];B=new ImageData(new Uint8ClampedArray(D.buffer),u,t);l.putImageData(B,0,0);return h};return m}()})},"esri/symbols/cim/CIMOperators":function(){define("exports ./effects/EffectAddControlPoints ./effects/EffectArrow ./effects/EffectBuffer ./effects/EffectControlMeasureLine ./effects/EffectCut ./effects/EffectDashes ./effects/EffectDonut ./effects/EffectJog ./effects/EffectMove ./effects/EffectOffset ./effects/EffectReverse ./effects/EffectRotate ./effects/EffectScale ./effects/EffectWave ./placements/PlacementAlongLineSameSize ./placements/PlacementAtExtremities ./placements/PlacementAtRatioPositions ./placements/PlacementInsidePolygon ./placements/PlacementOnLine ./placements/PlacementOnVertices ./placements/PlacementPolygonCenter".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d,a,c,f,g,n,k,x,r,v,q,y){m.getEffectOperator=function(A){if(!A)return null;switch(A.type){case "CIMGeometricEffectAddControlPoints":return p.EffectAddControlPoints.local();case "CIMGeometricEffectArrow":return D.EffectArrow.local();case "CIMGeometricEffectBuffer":return B.EffectBuffer.local();case "CIMGeometricEffectControlMeasureLine":return u.EffectControlMeasureLine.local();case "CIMGeometricEffectCut":return t.EffectCut.local();case "CIMGeometricEffectDashes":return h.EffectDashes.local();
case "CIMGeometricEffectDonut":return l.EffectDonut.local();case "CIMGeometricEffectJog":return e.EffectJog.local();case "CIMGeometricEffectMove":return b.EffectMove.local();case "CIMGeometricEffectOffset":return d.EffectOffset.local();case "CIMGeometricEffectReverse":return a.EffectReverse.local();case "CIMGeometricEffectRotate":return c.EffectRotate.local();case "CIMGeometricEffectScale":return f.EffectScale.local();case "CIMGeometricEffectWave":return g.EffectWave.local()}return null};m.getPlacementOperator=
function(A){if(!A)return null;switch(A.type){case "CIMMarkerPlacementAlongLineSameSize":return n.PlacementAlongLineSameSize.local();case "CIMMarkerPlacementAtExtremities":return k.PlacementAtExtremities.local();case "CIMMarkerPlacementAtRatioPositions":return x.PlacementAtRatioPositions.local();case "CIMMarkerPlacementInsidePolygon":return r.PlacementInsidePolygon.local();case "CIMMarkerPlacementOnLine":return v.PlacementOnLine.local();case "CIMMarkerPlacementOnVertices":return q.PlacementOnVertices.local();
case "CIMMarkerPlacementPolygonCenter":return y.PlacementPolygonCenter.local()}return null};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectAddControlPoints":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(m,p,D,B){let u=function(){function h(){}h.local=function(){null===h.instance&&(h.instance=new h);return h.instance};h.prototype.execute=function(l,e,b,d,a){return new t(l,e,b)};return h}();
u.instance=null;let t=function(){function h(e,b,d){this._inputGeometries=e;this._angleTolerance=void 0!==b.angleTolerance?b.angleTolerance:120;this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI)}var l=h.prototype;l.next=function(){for(var e=this._inputGeometries.next();e;){if(D.isPolygon(e))return this._isClosed=!0,e=p.clone(e),this._processMultipath(e.rings),e;if(D.isPolyline(e))return this._isClosed=!1,e=p.clone(e),this._processMultipath(e.paths),e;if(D.isExtent(e)){if(this._maxCosAngle)return e;
this._isClosed=!0;e=[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]];this._processPath(e);return{rings:[e]}}e=this._inputGeometries.next()}return null};l._processMultipath=function(e){if(e)for(const b of e)this._processPath(b)};l._processPath=function(e){if(e){let b=e.length,d=e[0],a,c,f,g,n,k;this._isClosed&&++b;for(let x=1;x<b;++x){let r;r=this._isClosed&&x===b-1?e[0]:e[x];const v=r[0]-d[0],q=r[1]-d[1],y=Math.sqrt(v*v+q*q);1<x&&0<y&&0<f&&(a*v+c*q)/y/f<=this._maxCosAngle&&
B.setId(d,1);1===x&&(g=v,n=q,k=y);0<y&&(d=r,a=v,c=q,f=y)}this._isClosed&&0<f&&0<k&&(a*g+c*n)/k/f<=this._maxCosAngle&&B.setId(e[0],1)}};return h}();m.EffectAddControlPoints=u;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/CIMCursor":function(){define(["exports","../../core/lang","../../geometry/support/jsonUtils","./CIMPlacements"],function(m,p,D,B){function u(k){k&&(D.isPoint(k)?k.y=-k.y:D.isPolygon(k)?h(k.rings):D.isPolyline(k)?h(k.paths):D.isMultipoint(k)&&t(k.points))}
function t(k){if(k){const x=k.length;for(let r=0;r<x;r++)k[r][1]=-k[r][1]}}function h(k){if(k)for(const x of k)t(x)}function l(k){if(k){var x=k.length;for(--x;0<x;--x)k[x][0]-=k[x-1][0],k[x][1]-=k[x-1][1]}}function e(k){if(k)for(const x of k)l(x)}function b(k){if(k){const x=k.length;for(let r=1;r<x;++r)k[r][0]+=k[r-1][0],k[r][1]+=k[r-1][1]}}function d(k){if(k)for(const x of k)b(x)}function a(k){k&&(D.isPolygon(k)?d(k.rings):D.isPolyline(k)?d(k.paths):D.isMultipoint(k)&&b(k.points),u(k))}function c(k){k&&
k.reverse()}function f(k){return{rings:[[[k.xmin,k.ymin],[k.xmin,k.ymax],[k.xmax,k.ymax],[k.xmax,k.ymin],[k.xmin,k.ymin]]]}}let g=function(){function k(x,r,v,q=0){this.isClosed=!1;this.multiPath=null;this.acceptPolygon=r;this.acceptPolyline=v;this.geomUnitsPerPoint=q;this.pathIndex=this.pathCount=-1;this.iteratePath=!1;x&&(D.isPolygon(x)?r&&(this.multiPath=x.rings,this.isClosed=!0):D.isPolyline(x)?v&&(this.multiPath=x.paths,this.isClosed=!1):D.isExtent(x)&&r&&(this.multiPath=f(x).rings,this.isClosed=
!0),this.multiPath&&(this.pathCount=this.multiPath.length));this.internalPlacement=new B.Placement}k.prototype.next=function(){if(!this.multiPath)return null;for(;this.iteratePath||this.pathIndex<this.pathCount-1;){this.iteratePath||this.pathIndex++;const x=this.processPath(this.multiPath[this.pathIndex]);if(x)return x}this.pathIndex=this.pathCount=-1;return this.multiPath=null};return k}(),n=function(){function k(x,r,v,q=0){this.isClosed=!1;this.multiPath=null;this.inputGeometries=x;this.acceptPolygon=
r;this.acceptPolyline=v;this.geomUnitsPerPoint=q;this.pathIndex=this.pathCount=-1;this.iteratePath=!1}k.prototype.next=function(){for(;;){if(!this.multiPath){for(var x=this.inputGeometries.next();x;)if(D.isPolygon(x)?this.acceptPolygon&&(this.multiPath=x.rings,this.isClosed=!0):D.isPolyline(x)?this.acceptPolyline&&(this.multiPath=x.paths,this.isClosed=!1):D.isExtent(x)&&this.acceptPolygon&&(this.multiPath=f(x).rings,this.isClosed=!0),this.multiPath){this.pathCount=this.multiPath.length;this.pathIndex=
-1;break}else x=this.inputGeometries.next();if(!this.multiPath)return null}for(;this.iteratePath||this.pathIndex<this.pathCount-1;)if(this.iteratePath||this.pathIndex++,x=this.processPath(this.multiPath[this.pathIndex]))return x;this.pathIndex=this.pathCount=-1;this.multiPath=null}};return k}();m.PathGeometryCursor=n;m.PathTransformationCursor=g;m.cloneAndDecodeGeometry=function(k){k=p.clone(k);a(k);return k};m.deltaDecodeGeometry=a;m.deltaEncodeGeometry=function(k){k&&(u(k),D.isPolygon(k)?e(k.rings):
D.isPolyline(k)?e(k.paths):D.isMultipoint(k)&&l(k.points))};m.getCoord2D=function(k,x,r){return[k[0]+(x[0]-k[0])*r,k[1]+(x[1]-k[1])*r]};m.getId=function(k){return k[4]};m.isClosedPath=function(k){return k&&0!==k.length?k[0][0]===k[k.length-1][0]&&k[0][1]===k[k.length-1][1]:!1};m.reverseMultipath=function(k){if(k)for(const x of k)c(x)};m.reversePath=c;m.setId=function(k,x){k[4]=x};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectArrow":function(){define(["exports",
"../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper","../enums"],function(m,p,D,B,u){const t=u.GeometricEffectArrowType.OpenEnded;let h=function(){function e(){}e.local=function(){null===e.instance&&(e.instance=new e);return e.instance};e.prototype.execute=function(b,d,a,c,f){return new l(b,d,a)};return e}();h.instance=null;let l=function(e){function b(a,c,f){a=e.call(this,a,!1,!0)||this;a._curveHelper=new B.CurveHelper;a._width=(void 0!==c.width?c.width:5)*f;a._arrowType=void 0!==
c.geometricEffectArrowType?c.geometricEffectArrowType:void 0!==c.arrowType?c.arrowType:t;a._offsetFlattenError=B.PIXEL_TOLERANCE*f;return a}p._inheritsLoose(b,e);var d=b.prototype;d.processPath=function(a){switch(this._arrowType){default:return this._constructSimpleArrow(a,!0);case u.GeometricEffectArrowType.Block:return this._constructSimpleArrow(a,!1);case u.GeometricEffectArrowType.Crossed:return this._constructCrossedArrow(a)}};d._constructSimpleArrow=function(a,c){var f=this._curveHelper.calculatePathLength(a),
g=this._width;f<2*g&&(g=f/2);f=this._curveHelper.getSubCurve(a,0,f-g);if(!f)return null;var n=g/2;if(this._curveHelper.isEmpty(f,!1))return null;g=this._constructOffset(f,-n);if(!g)return null;f=this._constructOffset(f,n);if(!f)return null;const k=this._constructArrowBasePoint(g,-n/2);if(!k)return null;n=this._constructArrowBasePoint(f,n/2);if(!n)return null;a=a[a.length-1];c||(this._makeControlPoint(f,!0),this._makeControlPoint(g,!0));const x=new B.PathHelper;x.addPath(f,!0);x.lineTo(n);this._makeControlPoint(x.path());
x.lineTo(a);this._makeControlPoint(x.path());x.lineTo(k);this._makeControlPoint(x.path());x.addPath(g,!1);return c?{paths:[x.path()]}:(x.close(),{rings:[x.path()]})};d._constructCrossedArrow=function(a){var c=this._curveHelper.calculatePathLength(a),f=this._width;c<3.732050807568877*f&&(f=c/3.732050807568877);var g=this._curveHelper.getSubCurve(a,0,c-2.732050807568877*f);if(!g)return null;var n=f/2;if(this._curveHelper.isEmpty(g,!1))return null;const k=this._constructOffset(g,n);if(!k)return null;
g=this._constructOffset(g,-n);if(!g)return null;c=this._curveHelper.getSubCurve(a,0,c-f);if(!c||this._curveHelper.isEmpty(c,!1))return null;f=this._constructOffset(c,n);if(!f)return null;var x=this._constructOffset(c,-n);if(!x)return null;c=f[f.length-1];f=this._constructArrowBasePoint(f,n/2);if(!f)return null;const r=x[x.length-1];n=this._constructArrowBasePoint(x,-n/2);if(!n)return null;a=a[a.length-1];this._makeControlPoint(k,!1);this._makeControlPoint(g,!1);x=new B.PathHelper;x.addPath(k,!0);
this._makeControlPoint(x.path());x.lineTo(r);x.lineTo(n);this._makeControlPoint(x.path());x.lineTo(a);this._makeControlPoint(x.path());x.lineTo(f);this._makeControlPoint(x.path());x.lineTo(c);this._makeControlPoint(x.path());x.addPath(g,!1);return{paths:[x.path()]}};d._constructOffset=function(a,c){return this._curveHelper.offset(a,c,u.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError)};d._constructArrowBasePoint=function(a,c){if(!a||2>a.length)return null;var f=a[a.length-2];a=a[a.length-
1];f=[a[0]-f[0],a[1]-f[1]];this._curveHelper.normalize(f);return[a[0]+f[1]*c,a[1]-f[0]*c]};d._makeControlPoint=function(a,c=!1){c?D.setId(a[0],1):D.setId(a[a.length-1],1)};return b}(D.PathGeometryCursor);m.EffectArrow=h;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/CurveHelper":function(){define(["exports","./enums"],function(m,p){let D=function(){function u(){this._path=[]}var t=u.prototype;t.path=function(){return this._path};t.addPath=function(h,l){l||h.reverse();
Array.prototype.push.apply(this._path,h);l||h.reverse()};u.mergePath=function(h,l){l&&Array.prototype.push.apply(h,l)};t.startPath=function(h){this._path.push(h)};t.lineTo=function(h){this._path.push(h)};t.close=function(){const h=this._path;1<h.length&&(h[0][0]!==h[h.length-1][0]||h[0][1]!==h[h.length-1][1])&&h.push([h[0][0],h[0][1]])};return u}(),B=function(){function u(h,l){}var t=u.prototype;t.normalize=function(h){const l=Math.sqrt(h[0]*h[0]+h[1]*h[1]);0!==l&&(h[0]/=l,h[1]/=l)};t.calculateLength=
function(h,l){const e=l[0]-h[0];h=l[1]-h[1];return Math.sqrt(e*e+h*h)};t.calculateSegLength=function(h,l){return this.calculateLength(h[l],h[l+1])};t.calculatePathLength=function(h){let l=0;const e=h?h.length:0;for(let b=0;b<e-1;++b)l+=this.calculateSegLength(h,b);return l};t.calculatePathArea=function(h){let l=0;const e=h?h.length:0;for(let b=0;b<e-1;++b)l+=(h[b+1][0]-h[b][0])*(h[b+1][1]+h[b][1]);return l/2};t.getCoord2D=function(h,l,e){return[h[0]+(l[0]-h[0])*e,h[1]+(l[1]-h[1])*e]};t.getSegCoord2D=
function(h,l,e){return this.getCoord2D(h[l],h[l+1],e)};t.getAngle=function(h,l,e){return Math.atan2(l[1]-h[1],l[0]-h[0])};t.getSegAngle=function(h,l,e){return this.getAngle(h[l],h[l+1],e)};t.getAngleCS=function(h,l,e){e=l[0]-h[0];h=l[1]-h[1];l=Math.sqrt(e*e+h*h);return 0<l?[e/l,h/l]:[1,0]};t.getSegAngleCS=function(h,l,e){return this.getAngleCS(h[l],h[l+1],e)};t.cut=function(h,l,e,b){e=0>=e?h[l]:this.getSegCoord2D(h,l,e);h=1<=b?h[l+1]:this.getSegCoord2D(h,l,b);return[e,h]};t.addSegment=function(h,
l,e){e&&h.push(l[0]);h.push(l[1])};t.getSubCurve=function(h,l,e){const b=[];return this.appendSubCurve(b,h,l,e)?b:null};t.appendSubCurve=function(h,l,e,b){const d=l?l.length-1:0;let a=0,c=!0,f=0;for(;f<d;){const n=this.calculateSegLength(l,f);if(0!==n){if(c){if(a+n>e){var g=(e-a)/n;let k=1,x=!1;a+n>=b&&(k=(b-a)/n,x=!0);(g=this.cut(l,f,g,k))&&this.addSegment(h,g,c);if(x)break;c=!1}}else{if(a+n>b){(l=this.cut(l,f,0,(b-a)/n))&&this.addSegment(h,l,c);break}this.addSegment(h,[l[f],l[f+1]],c)}a+=n}++f}return!0};
t.getCIMPointAlong=function(h,l){const e=h?h.length-1:0;let b=0,d=-1;for(;d<e;){++d;const a=this.calculateSegLength(h,d);if(0!==a){if(b+a>l)return this.getCoord2D(h[d],h[d+1],(l-b)/a);b+=a}}return null};t.isEmpty=function(h,l){if(!h||1>=h.length)return!0;const e=h?h.length-1:0;let b=-1;for(;b<e;)if(++b,h[b+1][0]!==h[b][0]||h[b+1][1]!==h[b][1]||l&&h[b+1][2]!==h[b][2])return!1;return!0};t.offset=function(h,l,e,b,d){if(!h||2>h.length)return null;var a=0,c=h[a++];for(d=a;a<h.length;){var f=h[a];if(f[0]!==
c[0]||f[1]!==c[1])a!==d&&(h[d]=h[a]),c=h[d++];a++}(a=h[0][0]===h[d-1][0]&&h[0][1]===h[d-1][1])&&--d;if(d<(a?3:2))return null;f=[];c=a?h[d-1]:null;let g=h[0];for(let v=0;v<d;v++){const q=v===d-1?a?h[0]:null:h[v+1];if(c)if(q){var n=[q[0]-g[0],q[1]-g[1]];this.normalize(n);var k=[g[0]-c[0],g[1]-c[1]];this.normalize(k);var x=k[0]*n[1]-k[1]*n[0],r=k[0]*n[0]+k[1]*n[1];if(0===x&&1===r){g=q;continue}if(0<=x===0>=l)1>r&&(n=[n[0]-k[0],n[1]-k[1]],this.normalize(n),k=Math.sqrt((1+r)/2),k>1/b&&(k=-Math.abs(l)/
k,f.push([g[0]-n[0]*k,g[1]-n[1]*k])));else switch(e){case p.GeometricEffectOffsetMethod.Mitered:if(c=Math.sqrt((1+r)/2),0<c&&1/c<b){n=[n[0]-k[0],n[1]-k[1]];this.normalize(n);k=Math.abs(l)/c;f.push([g[0]-n[0]*k,g[1]-n[1]*k]);break}case p.GeometricEffectOffsetMethod.Bevelled:f.push([g[0]+k[1]*l,g[1]-k[0]*l]);f.push([g[0]+n[1]*l,g[1]-n[0]*l]);break;case p.GeometricEffectOffsetMethod.Rounded:if(1>r){f.push([g[0]+k[1]*l,g[1]-k[0]*l]);c=Math.floor(2.5*(1-r));if(0<c){x=r=1/c;for(let y=1;y<c;y++,x+=r){const A=
[k[1]*(1-x)+n[1]*x,-k[0]*(1-x)-n[0]*x];this.normalize(A);f.push([g[0]+A[0]*l,g[1]+A[1]*l])}}f.push([g[0]+n[1]*l,g[1]-n[0]*l])}break;default:0>x?(f.push([g[0]+(k[1]+k[0])*l,g[1]+(k[1]-k[0])*l]),f.push([g[0]+(n[1]-n[0])*l,g[1]-(n[0]+n[1])*l])):(c=Math.sqrt((1+Math.abs(r))/2),n=[n[0]-k[0],n[1]-k[1]],this.normalize(n),k=l/c,f.push([g[0]-n[0]*k,g[1]-n[1]*k]))}}else n=[g[0]-c[0],g[1]-c[1]],this.normalize(n),f.push([g[0]+n[1]*l,g[1]-n[0]*l]);else n=[q[0]-g[0],q[1]-g[1]],this.normalize(n),f.push([g[0]+n[1]*
l,g[1]-n[0]*l]);c=g;g=q}if(f.length<(a?3:2))return null;a&&f.push([f[0][0],f[0][1]]);return f};return u}();m.CurveHelper=B;m.PIXEL_TOLERANCE=.03;m.PathHelper=D;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectBuffer":function(){define("exports ../../../geometry ../../../core/maybe ../../../geometry/support/jsonUtils ../CIMEffects ../CurveHelper ../enums ../../../geometry/SpatialReference".split(" "),function(m,p,D,B,u,t,h,l){p=function(){function b(){}
b.local=function(){null===b.instance&&(b.instance=new b);return b.instance};b.prototype.execute=function(d,a,c,f,g){return new e(d,a,c,f,g)};return b}();p.instance=null;let e=function(){function b(d,a,c,f,g){this._inputGeometries=d;this._tileKey=f;this._geometryEngine=g;this._curveHelper=new t.CurveHelper;this._size=(void 0!==a.size?a.size:1)*c;this._offsetFlattenError=t.PIXEL_TOLERANCE*c}b.prototype.next=function(){let d;for(;d=this._inputGeometries.next();){if(0===this._size)return d;if(B.isExtent(d))if(0<
this._size){var a=this._curveHelper.offset([[d.xmin,d.ymin],[d.xmin,d.ymax],[d.xmax,d.ymax],[d.xmax,d.ymin],[d.xmin,d.ymin]],this._size,h.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError);if(a)return{rings:[a]}}else if(0>this._size&&0<Math.min(d.xmax-d.xmin,d.ymax-d.ymin)+2*this._size)return{xmin:d.xmin-this._size,xmax:d.xmax+this._size,ymin:d.ymin-this._size,ymax:d.ymax+this._size};a=this._geometryEngine;if(D.isNone(a))break;let c=d;if(B.isPolygon(d)&&this._tileKey&&(c=u.clipPolygonToTileExtent(d,
Math.abs(this._size)+1),!c||!c.rings||0===c.rings.length))continue;if(B.isPolyline(d)&&this._tileKey&&(c=u.clipPolylineToTileExtent(d,Math.abs(this._size)+1),!c||!c.paths||0===c.paths.length))continue;return a.buffer(l.WebMercator,c,this._size,1)}return null};return b}();m.EffectBuffer=p;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectControlMeasureLine":function(){define(["exports","../../../geometry/support/jsonUtils","../CIMCursor","../enums"],function(m,
p,D,B){let u=function(){function h(){}h.local=function(){null===h.instance&&(h.instance=new h);return h.instance};h.prototype.execute=function(l,e,b,d,a){return new t(l,e,b)};return h}();u.instance=null;let t=function(){function h(e,b,d){this._defaultPointSize=20;this._inputGeometries=e;this._geomUnitsPerPoint=d;this._rule=b.rule??B.GeometricEffectControlMeasureLineRule.FullGeometry;this._defaultSize=this._defaultPointSize*d}var l=h.prototype;l.next=function(){let e;for(;e=this._inputGeometries.next();){let b;
p.isPoint(e)?b=this._processGeom([[[e.x,e.y]]]):p.isMultipoint(e)?b=this._processGeom([e.points]):p.isPolyline(e)?b=this._processGeom(e.paths):p.isPolygon(e)&&(b=this._processGeom(e.rings));if(b&&b.length)return{paths:b}}return null};l._clone=function(e){return[e[0],e[1]]};l._mid=function(e,b){return[(e[0]+b[0])/2,(e[1]+b[1])/2]};l._mix=function(e,b,d,a){return[e[0]*b+d[0]*a,e[1]*b+d[1]*a]};l._add=function(e,b){return[e[0]+b[0],e[1]+b[1]]};l._add2=function(e,b,d){return[e[0]+b,e[1]+d]};l._sub=function(e,
b){return[e[0]-b[0],e[1]-b[1]]};l._dist=function(e,b){return Math.sqrt((e[0]-b[0])*(e[0]-b[0])+(e[1]-b[1])*(e[1]-b[1]))};l._norm=function(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])};l._normalize=function(e,b=1){b/=this._norm(e);e[0]*=b;e[1]*=b};l._leftPerpendicular=function(e){const b=e[0];e[0]=-e[1];e[1]=b};l._leftPerp=function(e){return[-e[1],e[0]]};l._rightPerpendicular=function(e){const b=-e[0];e[0]=e[1];e[1]=b};l._rightPerp=function(e){return[e[1],-e[0]]};l._dotProduct=function(e,b){return e[0]*
b[0]+e[1]*b[1]};l._crossProduct=function(e,b){return e[0]*b[1]-e[1]*b[0]};l._rotateDirect=function(e,b,d){const a=e[0]*d+e[1]*b;e[0]=e[0]*b-e[1]*d;e[1]=a};l._makeCtrlPt=function(e){e=[e[0],e[1]];D.setId(e,1);return e};l._addAngledTicks=function(e,b,d,a){const c=this._sub(d,b);this._normalize(c);var f=this._crossProduct(c,this._sub(a,b));a=0<f?this._rightPerp(c):this._leftPerp(c);f=Math.abs(f)/2;const g=[];g.push([b[0]+(a[0]-c[0])*f,b[1]+(a[1]-c[1])*f]);g.push(b);g.push(d);g.push([d[0]+(a[0]+c[0])*
f,d[1]+(a[1]+c[1])*f]);e.push(g)};l._addBezier2=function(e,b,d,a,c){if(0===c--)e.push(a);else{var f=this._mid(b,d);d=this._mid(d,a);var g=this._mid(f,d);this._addBezier2(e,b,f,g,c);this._addBezier2(e,g,d,a,c)}};l._addBezier3=function(e,b,d,a,c,f){if(0===f--)e.push(c);else{var g=this._mid(b,d),n=this._mid(d,a);a=this._mid(a,c);d=this._mid(g,n);n=this._mid(n,a);var k=this._mid(d,n);this._addBezier3(e,b,g,d,k,f);this._addBezier3(e,k,n,a,c,f)}};l._add90DegArc=function(e,b,d,a,c){a=c??0<this._crossProduct(this._sub(d,
b),this._sub(a,b));c=this._mid(b,d);const f=this._sub(c,b);a?this._leftPerpendicular(f):this._rightPerpendicular(f);c[0]+=f[0];c[1]+=f[1];this._addBezier3(e,b,this._mix(b,.33333,c,.66667),this._mix(d,.33333,c,.66667),d,4)};l._addArrow=function(e,b,d){var a=b[0],c=b[1],f=b[b.length-1],g=this._sub(a,c);this._normalize(g);const n=this._crossProduct(g,this._sub(f,c));c=.5*n;var k=this._leftPerp(g);const x=[f[0]-k[0]*n,f[1]-k[1]*n];var r=b.length-1;f=[];f.push(d?[-k[0],-k[1]]:k);var v=[-g[0],-g[1]];for(d=
1;d<r-1;d++){g=this._sub(b[d+1],b[d]);this._normalize(g);var q=this._dotProduct(g,v);k=this._crossProduct(g,v);q=Math.sqrt((1+q)/2);v=this._sub(g,v);this._normalize(v);v[0]/=q;v[1]/=q;f.push(0>k?[-v[0],-v[1]]:v);v=g}f.push(this._rightPerp(v));for(r=f.length-1;0<r;r--)e.push([b[r][0]+f[r][0]*c,b[r][1]+f[r][1]*c]);e.push([x[0]+f[0][0]*c,x[1]+f[0][1]*c]);e.push([x[0]+f[0][0]*n,x[1]+f[0][1]*n]);e.push(a);e.push([x[0]-f[0][0]*n,x[1]-f[0][1]*n]);e.push([x[0]-f[0][0]*c,x[1]-f[0][1]*c]);for(a=1;a<f.length;a++)e.push([b[a][0]-
f[a][0]*c,b[a][1]-f[a][1]*c])};l._cp2=function(e,b,d){return 2<=e.length?e[1]:this._add2(e[0],b*this._defaultSize,d*this._defaultSize)};l._cp3=function(e,b,d,a){if(3<=e.length)return e[2];d=this._mix(e[0],1-d,b,d);e=this._sub(b,e[0]);this._normalize(e);this._rightPerpendicular(e);return[d[0]+e[0]*a*this._defaultSize,d[1]+e[1]*a*this._defaultSize]};l._arrowPath=function(e){if(2<e.length)return e;const b=e[0];e=this._cp2(e,-4,0);const d=this._sub(b,e);this._normalize(d);const a=this._rightPerp(d);return[b,
e,[b[0]+(a[0]-d[0])*this._defaultSize,b[1]+(a[1]-d[1])*this._defaultSize]]};l._arrowLastSeg=function(e){var b=e[0];const d=this._cp2(e,-4,0);if(3<=e.length)b=e[e.length-1];else{e=this._sub(b,d);this._normalize(e);const a=this._rightPerp(e);b=[b[0]+(a[0]-e[0])*this._defaultSize,b[1]+(a[1]-e[1])*this._defaultSize]}return[d,b]};l._processGeom=function(e){if(!e)return null;const b=[];for(const d of e){if(!d||0===d.length)continue;const a=d.length;let c=d[0];switch(this._rule){case B.GeometricEffectControlMeasureLineRule.PerpendicularFromFirstSegment:const f=
this._cp2(d,0,-1),g=this._cp3(d,f,.5,4),n=[];n.push(g);n.push(this._mid(c,f));b.push(n);break;case B.GeometricEffectControlMeasureLineRule.ReversedFirstSegment:const k=this._cp2(d,0,-1);b.push([k,c]);break;case B.GeometricEffectControlMeasureLineRule.PerpendicularToSecondSegment:const x=this._cp2(d,-4,1),r=this._cp3(d,x,.882353,-1.94),v=[];v.push(this._mid(x,r));v.push(c);b.push(v);break;case B.GeometricEffectControlMeasureLineRule.SecondSegmentWithTicks:const q=this._cp2(d,-4,1),y=this._cp3(d,q,
.882353,-1.94),A=this._sub(y,q);let w;w=0<this._crossProduct(A,this._sub(c,q))?this._rightPerp(w):this._leftPerp(A);const z=[];z.push([q[0]+(w[0]-A[0])/3,q[1]+(w[1]-A[1])/3]);z.push(q);z.push(y);z.push([y[0]+(w[0]+A[0])/3,y[1]+(w[1]+A[1])/3]);b.push(z);break;case B.GeometricEffectControlMeasureLineRule.DoublePerpendicular:const C=this._cp2(d,0,-1),E=this._cp3(d,C,.5,3),F=this._mid(c,C),G=this._sub(F,E);this._normalize(G);const H=this._crossProduct(G,this._sub(c,E));this._leftPerpendicular(G);const L=
[];L.push(c);L.push([E[0]+G[0]*H,E[1]+G[1]*H]);b.push(L);const K=[];K.push([E[0]-G[0]*H,E[1]-G[1]*H]);K.push(C);b.push(K);break;case B.GeometricEffectControlMeasureLineRule.OppositeToFirstSegment:const M=this._cp2(d,0,-1),U=this._cp3(d,M,.5,3),T=this._mid(c,M),Z=this._sub(T,U);this._normalize(Z);const X=this._crossProduct(Z,this._sub(c,U));this._leftPerpendicular(Z);const ca=[];ca.push([U[0]+Z[0]*X,U[1]+Z[1]*X]);ca.push([U[0]-Z[0]*X,U[1]-Z[1]*X]);b.push(ca);break;case B.GeometricEffectControlMeasureLineRule.TriplePerpendicular:const P=
this._cp2(d,0,-1),J=this._cp3(d,P,.5,4),N=this._mid(c,P),S=this._sub(N,J);this._normalize(S);const Q=this._crossProduct(S,this._sub(c,J));this._leftPerpendicular(S);const Y=[];Y.push([J[0]+S[0]*Q*.8,J[1]+S[1]*Q*.8]);Y.push([N[0]+.8*(c[0]-N[0]),N[1]+.8*(c[1]-N[1])]);b.push(Y);b.push([J,N]);const ba=[];ba.push([J[0]-S[0]*Q*.8,J[1]-S[1]*Q*.8]);ba.push([N[0]+.8*(P[0]-N[0]),N[1]+.8*(P[1]-N[1])]);b.push(ba);break;case B.GeometricEffectControlMeasureLineRule.HalfCircleFirstSegment:const aa=this._cp2(d,0,
-1),I=this._cp3(d,aa,.5,4),O=this._mid(c,aa);let R=this._sub(aa,c);const V=Math.cos(Math.PI/18),W=Math.sin(Math.PI/18),da=Math.sqrt((1+V)/2),ea=Math.sqrt((1-V)/2),fa=[];let ha;0<this._crossProduct(R,this._sub(I,c))?(fa.push(c),R=this._sub(c,O),ha=aa):(fa.push(aa),R=this._sub(aa,O),ha=c);this._rotateDirect(R,da,ea);R[0]/=da;R[1]/=da;for(let sa=1;18>=sa;sa++)fa.push(this._add(O,R)),this._rotateDirect(R,V,W);fa.push(ha);b.push(fa);break;case B.GeometricEffectControlMeasureLineRule.HalfCircleSecondSegment:const ia=
this._cp2(d,0,-1),la=this._cp3(d,ia,1,-1);let ka=this._sub(c,ia);this._normalize(ka);const ja=this._crossProduct(ka,this._sub(la,ia))/2;this._leftPerpendicular(ka);const ma=[ia[0]+ka[0]*ja,ia[1]+ka[1]*ja];ka=this._sub(ia,ma);const na=Math.cos(Math.PI/18);let pa=Math.sin(Math.PI/18);0<ja&&(pa=-pa);const oa=[ia];for(let sa=1;18>=sa;sa++)this._rotateDirect(ka,na,pa),oa.push(this._add(ma,ka));b.push(oa);break;case B.GeometricEffectControlMeasureLineRule.HalfCircleExtended:const qa=this._cp2(d,0,-2),ta=
this._cp3(d,qa,1,-1);let ra;if(4<=a)ra=d[3];else{const sa=this._sub(c,qa);ra=this._add(ta,sa)}const xa=this._dist(qa,ta)/2/.75,Fa=this._sub(qa,c);this._normalize(Fa,xa);const ya=this._sub(ta,ra);this._normalize(ya,xa);b.push([ra,ta]);const ua=[this._clone(ta)];this._addBezier3(ua,ta,this._add(ta,ya),this._add(qa,Fa),qa,4);ua.push(c);b.push(ua);break;case B.GeometricEffectControlMeasureLineRule.OpenCircle:const va=this._cp2(d,-2,0),za=this._sub(va,c),Ja=Math.cos(Math.PI/18),Qa=-Math.sin(Math.PI/18),
Ca=[va];for(let sa=1;33>=sa;sa++)this._rotateDirect(za,Ja,Qa),Ca.push(this._add(c,za));b.push(Ca);break;case B.GeometricEffectControlMeasureLineRule.CoverageEdgesWithTicks:const Ba=this._cp2(d,0,-1);let wa;if(3<=a)wa=d[2];else{const sa=this._sub(Ba,c),Aa=this._leftPerp(sa);wa=[c[0]+Aa[0]-.25*sa[0],c[1]+Aa[1]-.25*sa[1]]}let Ha;if(4<=a)Ha=d[3];else{const sa=this._mid(c,Ba),Aa=this._sub(c,Ba);this._normalize(Aa);this._leftPerpendicular(Aa);const Ia=this._crossProduct(Aa,this._sub(wa,sa));this._rightPerpendicular(Aa);
Ha=[wa[0]+Aa[0]*Ia*2,wa[1]+Aa[1]*Ia*2]}const Ga=this._sub(Ba,c);let Da,Ka;Da=0<this._crossProduct(Ga,this._sub(wa,c))?this._rightPerp(Ga):this._leftPerp(Ga);Ka=[];Ka.push(wa);Ka.push(c);Ka.push([c[0]+(Da[0]-Ga[0])/3,c[1]+(Da[1]-Ga[1])/3]);b.push(Ka);Da=0<this._crossProduct(Ga,this._sub(Ha,Ba))?this._rightPerp(Da):this._leftPerp(Ga);Ka=[];Ka.push([Ba[0]+(Da[0]+Ga[0])/3,Ba[1]+(Da[1]+Ga[1])/3]);Ka.push(Ba);Ka.push(Ha);b.push(Ka);break;case B.GeometricEffectControlMeasureLineRule.GapExtentWithDoubleTicks:const Ma=
this._cp2(d,0,2),Sb=this._cp3(d,Ma,0,1);let Ab;if(4<=a)Ab=d[3];else{const sa=this._sub(Ma,c);Ab=this._add(Sb,sa)}this._addAngledTicks(b,c,Ma,this._mid(Sb,Ab));this._addAngledTicks(b,Sb,Ab,this._mid(c,Ma));break;case B.GeometricEffectControlMeasureLineRule.GapExtentMidline:const Tb=this._cp2(d,2,0),pc=this._cp3(d,Tb,0,1);let Ub;if(4<=a)Ub=d[3];else{const sa=this._sub(Tb,c);Ub=this._add(pc,sa)}const Vb=[];Vb.push(this._mid(c,pc));Vb.push(this._mid(Tb,Ub));b.push(Vb);break;case B.GeometricEffectControlMeasureLineRule.Chevron:const qc=
this._cp2(d,-1,-1);let Wb;if(3<=a)Wb=d[2];else{const sa=this._sub(qc,c);this._leftPerpendicular(sa);Wb=this._add(c,sa)}b.push([qc,this._makeCtrlPt(c),Wb]);break;case B.GeometricEffectControlMeasureLineRule.PerpendicularWithArc:const hb=this._cp2(d,0,-2),rc=this._cp3(d,hb,.5,-1);let Ea=this._sub(hb,c);const ib=this._norm(Ea);Ea[0]/=ib;Ea[1]/=ib;const $a=this._crossProduct(Ea,this._sub(rc,c));let jb=this._dotProduct(Ea,this._sub(rc,c));jb<.05*ib?jb=.05*ib:jb>.95*ib&&(jb=.95*ib);const Bb=[c[0]+Ea[0]*
jb,c[1]+Ea[1]*jb];this._leftPerpendicular(Ea);let kb=[];kb.push([Bb[0]-Ea[0]*$a,Bb[1]-Ea[1]*$a]);kb.push([Bb[0]+Ea[0]*$a,Bb[1]+Ea[1]*$a]);b.push(kb);const sc=[hb[0]+Ea[0]*$a,hb[1]+Ea[1]*$a];Ea=this._sub(hb,sc);const Rc=Math.cos(Math.PI/18);let Xb=Math.sin(Math.PI/18);0>$a&&(Xb=-Xb);kb=[c,hb];for(let sa=1;9>=sa;sa++)this._rotateDirect(Ea,Rc,Xb),kb.push(this._add(sc,Ea));b.push(kb);break;case B.GeometricEffectControlMeasureLineRule.ClosedHalfCircle:const Yb=this._cp2(d,2,0),tc=this._mid(c,Yb),uc=this._sub(Yb,
tc),Sc=Math.cos(Math.PI/18),Tc=Math.sin(Math.PI/18),vc=[c,Yb];for(let sa=1;18>=sa;sa++)this._rotateDirect(uc,Sc,Tc),vc.push(this._add(tc,uc));b.push(vc);break;case B.GeometricEffectControlMeasureLineRule.TripleParallelExtended:const ab=this._cp2(d,0,-2),Zb=this._cp3(d,ab,1,-2),bb=this._mid(c,ab),Pa=this._sub(Zb,ab);this._normalize(Pa);const wc=Math.abs(this._crossProduct(Pa,this._sub(bb,ab)))/2,lb=this._dist(ab,Zb),xc=[ab,c];xc.push([c[0]+Pa[0]*lb*.5,c[1]+Pa[1]*lb*.5]);b.push(xc);const mb=[];mb.push([bb[0]-
Pa[0]*wc,bb[1]-Pa[1]*wc]);mb.push([bb[0]+Pa[0]*lb*.375,bb[1]+Pa[1]*lb*.375]);D.setId(mb[mb.length-1],1);mb.push([bb[0]+Pa[0]*lb*.75,bb[1]+Pa[1]*lb*.75]);b.push(mb);b.push([ab,Zb]);break;case B.GeometricEffectControlMeasureLineRule.ParallelWithTicks:const qb=this._cp2(d,3,0),$b=this._cp3(d,qb,.5,-1),rb=this._sub($b,qb);this._normalize(rb);const yc=this._crossProduct(rb,this._sub($b,c));this._leftPerpendicular(rb);this._addAngledTicks(b,c,qb,$b);this._addAngledTicks(b,this._mix(c,1,rb,yc),this._mix(qb,
1,rb,yc),this._mid(c,qb));break;case B.GeometricEffectControlMeasureLineRule.Parallel:const sb=this._cp2(d,3,0),Uc=this._cp3(d,sb,.5,-1),ac=this._sub(sb,c);this._normalize(ac);const Cb=this._leftPerp(ac),Db=this._crossProduct(ac,this._sub(Uc,c));let tb=[c,sb];b.push(tb);tb=[];tb.push([c[0]+Cb[0]*Db,c[1]+Cb[1]*Db]);tb.push([sb[0]+Cb[0]*Db,sb[1]+Cb[1]*Db]);b.push(tb);break;case B.GeometricEffectControlMeasureLineRule.PerpendicularToFirstSegment:const bc=this._cp2(d,3,0),Vc=this._cp3(d,bc,.5,-1),Eb=
this._mid(c,bc),cb=this._sub(bc,c);this._normalize(cb);const Fb=this._crossProduct(cb,this._sub(Vc,c));this._leftPerpendicular(cb);const cc=[];cc.push([Eb[0]-cb[0]*Fb*.25,Eb[1]-cb[1]*Fb*.25]);cc.push([Eb[0]+cb[0]*Fb*1.25,Eb[1]+cb[1]*Fb*1.25]);b.push(cc);break;case B.GeometricEffectControlMeasureLineRule.ParallelOffset:const nb=this._cp2(d,3,0),Wc=this._cp3(d,nb,.5,-1),Na=this._sub(nb,c);this._normalize(Na);const Ta=this._crossProduct(Na,this._sub(Wc,c));this._leftPerpendicular(Na);const dc=[];dc.push([c[0]-
Na[0]*Ta,c[1]-Na[1]*Ta]);dc.push([nb[0]-Na[0]*Ta,nb[1]-Na[1]*Ta]);b.push(dc);const ec=[];ec.push([c[0]+Na[0]*Ta,c[1]+Na[1]*Ta]);ec.push([nb[0]+Na[0]*Ta,nb[1]+Na[1]*Ta]);b.push(ec);break;case B.GeometricEffectControlMeasureLineRule.OffsetOpposite:const Gb=this._cp2(d,3,0),Xc=this._cp3(d,Gb,.5,-1),db=this._sub(Gb,c);this._normalize(db);const Hb=this._crossProduct(db,this._sub(Xc,c));this._leftPerpendicular(db);const fc=[];fc.push([c[0]-db[0]*Hb,c[1]-db[1]*Hb]);fc.push([Gb[0]-db[0]*Hb,Gb[1]-db[1]*Hb]);
b.push(fc);break;case B.GeometricEffectControlMeasureLineRule.OffsetSame:const Ib=this._cp2(d,3,0),Yc=this._cp3(d,Ib,.5,-1),eb=this._sub(Ib,c);this._normalize(eb);const Jb=this._crossProduct(eb,this._sub(Yc,c));this._leftPerpendicular(eb);const gc=[];gc.push([c[0]+eb[0]*Jb,c[1]+eb[1]*Jb]);gc.push([Ib[0]+eb[0]*Jb,Ib[1]+eb[1]*Jb]);b.push(gc);break;case B.GeometricEffectControlMeasureLineRule.CircleWithArc:let Ua=this._cp2(d,3,0);const hc=this._cp3(d,Ua,.5,-1);let ob,Kb;if(4<=a)ob=d[3],Kb=0<this._crossProduct(this._sub(ob,
Ua),this._sub(hc,Ua));else{ob=Ua;Kb=0<this._crossProduct(this._sub(ob,c),this._sub(hc,c));const sa=24*this._geomUnitsPerPoint,Aa=this._sub(ob,c);this._normalize(Aa,sa);const Ia=Math.sqrt(2)/2;this._rotateDirect(Aa,Ia,Kb?Ia:-Ia);Ua=this._add(c,Aa)}const zc=this._sub(Ua,c),Zc=Math.cos(Math.PI/18),$c=Math.sin(Math.PI/18),ub=[Ua];for(let sa=1;36>=sa;sa++)this._rotateDirect(zc,Zc,$c),ub.push(this._add(c,zc));this._add90DegArc(ub,Ua,ob,hc,Kb);D.setId(ub[ub.length-8],1);b.push(ub);break;case B.GeometricEffectControlMeasureLineRule.DoubleJog:let Va=
this._cp2(d,-3,1),Wa;Wa=3<=a?d[2]:this._add(c,this._sub(c,Va));let Ra;if(4<=a)Ra=d[3];else{const sa=c;c=Va;Ra=Wa;const Aa=this._dist(c,sa),Ia=this._dist(Ra,sa);let Xa=30*this._geomUnitsPerPoint;.5*Aa<Xa&&(Xa=.5*Aa);.5*Ia<Xa&&(Xa=.5*Ia);Va=this._mix(c,Xa/Aa,sa,(Aa-Xa)/Aa);Wa=this._mix(Ra,Xa/Ia,sa,(Ia-Xa)/Ia)}const Ac=this._mid(c,Va),Bc=this._mid(Ra,Wa),ad=this._dist(c,Va),bd=this._dist(Wa,Ra);let Lb=Math.min(ad,bd)/8;Lb=Math.min(Lb,24*this._geomUnitsPerPoint);const Ya=Math.cos(Math.PI/4);let La=this._sub(c,
Va);this._normalize(La,Lb);0<this._crossProduct(La,this._sub(Ra,Va))?this._rotateDirect(La,Ya,-Ya):this._rotateDirect(La,Ya,Ya);let Oa=[];Oa.push(Va);Oa.push(this._add(Ac,La));Oa.push(this._sub(Ac,La));Oa.push(c);b.push(Oa);La=this._sub(Ra,Wa);this._normalize(La,Lb);0>this._crossProduct(La,this._sub(c,Wa))?this._rotateDirect(La,Ya,Ya):this._rotateDirect(La,Ya,-Ya);Oa=[];Oa.push(Wa);Oa.push(this._add(Bc,La));Oa.push(this._sub(Bc,La));Oa.push(Ra);b.push(Oa);break;case B.GeometricEffectControlMeasureLineRule.PerpendicularOffset:const Mb=
this._cp2(d,-4,1),Cc=this._cp3(d,Mb,.882353,-1.94),vb=this._sub(Cc,Mb);0<this._crossProduct(vb,this._sub(c,Mb))?this._rightPerpendicular(vb):this._leftPerpendicular(vb);const cd=[vb[0]/8,vb[1]/8],dd=this._sub(this._mid(Mb,Cc),cd);b.push([dd,c]);break;case B.GeometricEffectControlMeasureLineRule.LineExcludingLastSegment:const Dc=this._arrowPath(d),Ec=[];let Fc=Dc.length-2;for(;Fc--;)Ec.push(Dc[Fc]);b.push(Ec);break;case B.GeometricEffectControlMeasureLineRule.MultivertexArrow:const ed=this._arrowPath(d),
Gc=[];this._addArrow(Gc,ed,!1);b.push(Gc);break;case B.GeometricEffectControlMeasureLineRule.CrossedArrow:const fd=this._arrowPath(d),Hc=[];this._addArrow(Hc,fd,!0);b.push(Hc);break;case B.GeometricEffectControlMeasureLineRule.ChevronArrow:const [Ic,wb]=this._arrowLastSeg(d),Nb=10*this._geomUnitsPerPoint,fb=this._sub(c,Ic);this._normalize(fb);const Jc=this._crossProduct(fb,this._sub(wb,Ic)),Kc=this._leftPerp(fb),Lc=[wb[0]-Kc[0]*Jc*2,wb[1]-Kc[1]*Jc*2],Ob=[];Ob.push([wb[0]+fb[0]*Nb,wb[1]+fb[1]*Nb]);
Ob.push(c);Ob.push([Lc[0]+fb[0]*Nb,Lc[1]+fb[1]*Nb]);b.push(Ob);break;case B.GeometricEffectControlMeasureLineRule.ChevronArrowOffset:const [Mc,ic]=this._arrowLastSeg(d),Sa=this._sub(c,Mc);this._normalize(Sa);const pb=this._crossProduct(Sa,this._sub(ic,Mc));this._leftPerpendicular(Sa);const xb=[ic[0]-Sa[0]*pb,ic[1]-Sa[1]*pb],Pb=[];Pb.push([xb[0]+Sa[0]*pb*.5,xb[1]+Sa[1]*pb*.5]);Pb.push(this._mid(xb,c));Pb.push([xb[0]-Sa[0]*pb*.5,xb[1]-Sa[1]*pb*.5]);b.push(Pb);break;case B.GeometricEffectControlMeasureLineRule.PartialFirstSegment:const [jc,
kc]=this._arrowLastSeg(d),yb=this._sub(c,jc);this._normalize(yb);const Nc=this._crossProduct(yb,this._sub(kc,jc));this._leftPerpendicular(yb);b.push([jc,[kc[0]-yb[0]*Nc,kc[1]-yb[1]*Nc]]);break;case B.GeometricEffectControlMeasureLineRule.Arch:const lc=this._cp2(d,0,-1),Qb=this._cp3(d,lc,.5,1),Oc=this._sub(c,lc),gd=this._mix(Qb,1,Oc,.55),hd=this._mix(Qb,1,Oc,-.55),mc=[c];this._addBezier2(mc,c,gd,Qb,4);this._addBezier2(mc,Qb,hd,lc,4);b.push(mc);break;case B.GeometricEffectControlMeasureLineRule.CurvedParallelTicks:const Za=
this._cp2(d,-4,1),zb=this._cp3(d,Za,.882353,-1.94),gb=this._sub(zb,Za);0<this._crossProduct(gb,this._sub(c,Za))?this._rightPerpendicular(gb):this._leftPerpendicular(gb);const nc=[gb[0]/8,gb[1]/8],Pc=this._sub(this._mid(Za,zb),nc),id=this._sub(this._mix(Za,.75,zb,.25),nc),jd=this._sub(this._mix(Za,.25,zb,.75),nc),Rb=[Za];this._addBezier2(Rb,Za,id,Pc,3);this._addBezier2(Rb,Pc,jd,zb,3);b.push(Rb);for(let sa=0;8>sa;sa++){const Aa=Rb[2*sa+1],Ia=[this._clone(Aa)];Ia.push(this._add(Aa,[gb[0]/4,gb[1]/4]));
b.push(Ia)}break;case B.GeometricEffectControlMeasureLineRule.Arc90Degrees:const oc=this._cp2(d,0,-1),kd=this._cp3(d,oc,.5,1),Qc=[oc];this._add90DegArc(Qc,oc,c,kd);b.push(Qc);break;default:b.push(d)}}return b};return h}();m.EffectControlMeasureLine=u;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectCut":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(m,p,D,B){let u=function(){function h(){}
h.local=function(){null===h.instance&&(h.instance=new h);return h.instance};h.prototype.execute=function(l,e,b,d,a){return new t(l,e,b)};return h}();u.instance=null;let t=function(h){function l(e,b,d){e=h.call(this,e,!0,!0)||this;e._curveHelper=new B.CurveHelper;e._beginCut=(void 0!==b.beginCut?b.beginCut:1)*d;e._endCut=(void 0!==b.endCut?b.endCut:1)*d;e._middleCut=(void 0!==b.middleCut?b.middleCut:0)*d;e._invert=void 0!==b.invert?b.invert:!1;0>e._beginCut&&(e._beginCut=0);0>e._endCut&&(e._endCut=
0);0>e._middleCut&&(e._middleCut=0);return e}p._inheritsLoose(l,h);l.prototype.processPath=function(e){var b=this._beginCut;const d=this._endCut,a=this._middleCut,c=this._curveHelper.calculatePathLength(e),f=[];if(!this._invert)0===b&&0===d&&0===a?f.push(e):b+d+a>=c||(0===a?(e=this._curveHelper.getSubCurve(e,b,c-d))&&f.push(e):((b=this._curveHelper.getSubCurve(e,b,.5*(c-a)))&&f.push(b),(b=this._curveHelper.getSubCurve(e,.5*(c+a),c-d))&&f.push(b)));else if(0!==b||0!==d||0!==a)b+d+a>=c?f.push(e):((b=
this._curveHelper.getSubCurve(e,0,b))&&f.push(b),(b=this._curveHelper.getSubCurve(e,.5*(c-a),.5*(c+a)))&&f.push(b),(b=this._curveHelper.getSubCurve(e,c-d,d))&&f.push(b));return 0===f.length?null:{paths:f}};return l}(D.PathGeometryCursor);m.EffectCut=u;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectDashes":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../CIMCursor ../CurveHelper ../enums ../GeometryWalker".split(" "),function(m,
p,D,B,u,t){let h=function(){function e(){}e.local=function(){null===e.instance&&(e.instance=new e);return e.instance};e.prototype.execute=function(b,d,a,c,f){return new l(b,d,a)};return e}();h.instance=null;let l=function(e){function b(d,a,c){d=e.call(this,d,!0,!0)||this;d._firstCurve=null;d._walker=new t.GeometryWalker;d._walker.updateTolerance(c);d._endings=a.lineDashEnding;d._customDashPos=-(a.offsetAlongLine??0)*c;d._offsetAtEnd=(a.customEndingOffset??0)*c;d._pattern=new t.DashPattern;d._pattern.init(a.dashTemplate,
!0);d._pattern.scale(c);return d}p._inheritsLoose(b,e);b.prototype.processPath=function(d){if(0===this._pattern.length())return this.iteratePath=!1,{paths:[d]};if(!this.iteratePath){var a=!0;switch(this._endings){default:this._pattern.extPtGap=0;break;case u.LineDashEnding.FullPattern:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.firstValue());break;case u.LineDashEnding.FullGap:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.lastValue());break;case u.LineDashEnding.NoConstraint:this.isClosed||
(a=!1);break;case u.LineDashEnding.Custom:this.isClosed||(this._pattern.extPtGap=.5*this._offsetAtEnd)}var c=this._walker.calculatePathLength(d);if(this._pattern.isEmpty()||c<.1*this._pattern.length()||!this._walker.init(d,this._pattern,a))return{paths:[d]}}if(this.iteratePath)d=this._pattern.nextValue();else{switch(this._endings){default:a=.5*this._pattern.firstValue();break;case u.LineDashEnding.HalfGap:a=.5*-this._pattern.lastValue();break;case u.LineDashEnding.FullGap:a=-this._pattern.lastValue();
break;case u.LineDashEnding.FullPattern:a=0;break;case u.LineDashEnding.NoConstraint:case u.LineDashEnding.Custom:a=-this._customDashPos}d=a/this._pattern.length();d-=Math.floor(d);a=d*this._pattern.length();this._pattern.reset();d=this._pattern.nextValue();for(c=!1;a>=d;)a-=d,d=this._pattern.nextValue(),c=!c;d-=a;c?(this._walker.nextPosition(d),d=this._pattern.nextValue()):this.isClosed&&(this._firstCurve=this._walker.nextCurve(d),d=this._pattern.nextValue(),this._walker.nextPosition(d),d=this._pattern.nextValue())}(a=
this._walker.nextCurve(d))?this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(this._firstCurve.splice(0,1),B.PathHelper.mergePath(a,this._firstCurve),this._firstCurve=null)):(d=this._pattern.nextValue(),!this._walker.nextPosition(d)||this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(a=this._firstCurve,this._firstCurve=null)):this.iteratePath=!0):(this.iteratePath=!1,a=this._firstCurve,this._firstCurve=null);return{paths:[a]}};return b}(D.PathGeometryCursor);m.EffectDashes=
h;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/GeometryWalker":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","./CIMCursor","./CurveHelper"],function(m,p,D,B){let u=function(){function l(){this._values=[];this._currentValue=this._length=this.ctrlPtGap=this.extPtGap=0}var e=l.prototype;e.isEmpty=function(){return 0===this._values.length};e.size=function(){return this._values.length};e.init=function(b,d,a=!0){this._setEmpty();if(!b||0===b.length)return!1;
for(let c=0;c<b.length;c++){let f=Math.abs(b[c]);a&&1E-7>f&&(f=1E-7);this._values.push(f);this._length+=f}d&&b.length&1&&(this._length*=2);if(0===this._length)return!1;this.ctrlPtGap=this.extPtGap=0;this._currentValue=-1;return!0};e.scale=function(b){const d=this._values?this._values.length:0;for(let a=0;a<d;++a)this._values[a]*=b;this._length*=b;this.extPtGap*=b;this.ctrlPtGap*=b};e.addValue=function(b){this._length+=b;this._values.push(b)};e.firstValue=function(){return this._values[0]};e.lastValue=
function(){return this._values[this._values.length-1]};e.nextValue=function(){this._currentValue++;this._currentValue===this._values.length&&(this._currentValue=0);return this._values[this._currentValue]};e.reset=function(){this._currentValue=-1};e.length=function(){return this._length};e._setEmpty=function(){this.extPtGap=this.ctrlPtGap=this._length=0;this._currentValue=-1;this._values.length=0};return l}();m.EndType=void 0;(function(l){l[l.FAIL=0]="FAIL";l[l.END=1]="END";l[l.CONTINUE=2]="CONTINUE"})(m.EndType||
(m.EndType={}));let t=function(){function l(){this.reset()}var e=l.prototype;e.reset=function(){this.segment=-1;this.abscissa=this.segmentLength=0;this.isPartEnd=this.isPathEnd=!1};e.isValid=function(){return-1!==this.segment};e.copyTo=function(b){b.segment=this.segment;b.segmentLength=this.segmentLength;b.abscissa=this.abscissa;b.isPathEnd=this.isPathEnd;b.isPartEnd=this.isPartEnd};return l}(),h=function(l){function e(d=0,a=!1){d=l.call(this,d,a)||this;d._tolerance=B.PIXEL_TOLERANCE;d._currentPosition=
new t;return d}p._inheritsLoose(e,l);var b=e.prototype;b.updateTolerance=function(d){this._tolerance=B.PIXEL_TOLERANCE*d};b.init=function(d,a,c=!0){c?(this._patternLength=a.length(),this._partExtPtGap=a.extPtGap,this._partCtrlPtGap=a.ctrlPtGap):this._partCtrlPtGap=this._partExtPtGap=this._patternLength=0;this._currentPosition.reset();this._partSegCount=0;this._path=d;this._seg=-1;return this._setPosAtNextPart()};b.curPositionIsValid=function(){return this._currentPosition.isValid()};b.nextPosition=
function(d,a=m.EndType.FAIL){const c=new t;if(!this._nextPosition(d,c,null,a))return!1;c.copyTo(this._currentPosition);return!0};b.curPointAndAngle=function(d){d.pt=this._getPoint(this._currentPosition);const [a,c]=this._getAngle(this._currentPosition);d.ca=a;d.sa=c};b.nextPointAndAngle=function(d,a,c=m.EndType.FAIL){const f=new t;if(!this._nextPosition(d,f,null,c))return!1;f.copyTo(this._currentPosition);a.pt=this._getPoint(f);const [g,n]=this._getAngle(f);a.ca=g;a.sa=n;return!0};b.nextCurve=function(d){if(0===
d)return null;const a=[],c=new t;if(!this._nextPosition(d,c,a,m.EndType.END))return null;c.copyTo(this._currentPosition);return a};b.isPathEnd=function(){return this._currentPosition.isPathEnd};b.getPathEnd=function(){if(-1===this._currentPosition.segment)throw Error("missing segment");return this._path[this._currentPosition.segment+1]};b._nextPosition=function(d,a,c,f){if(this._currentPosition.isPathEnd)return!1;var g=this._currentPosition.abscissa;0<this._currentPosition.segmentLength&&(g/=this._currentPosition.segmentLength);
for(this._currentPosition.copyTo(a);a.abscissa+d*this._partLengthRatio>a.segmentLength+this._tolerance;)if(c&&(0===c.length&&(0===g?(g=this._path[a.segment],c.push([g[0],g[1]])):c.push(this.getSegCoord2D(this._path,a.segment,g))),g=this._path[a.segment+1],c.push([g[0],g[1]])),g=0,d-=(a.segmentLength-a.abscissa)/this._partLengthRatio,this._partSegCount)a.segment=this._nextSegment(),a.segmentLength=this.calculateSegLength(this._path,a.segment),a.abscissa=0,this._partSegCount--;else{if(!this._setPosAtNextPart()){if(f===
m.EndType.FAIL)return!1;a.segmentLength=this.calculateSegLength(this._path,a.segment);a.isPartEnd=!0;f===m.EndType.END?(a.abscissa=a.segmentLength,a.isPathEnd=!0):a.abscissa=a.segmentLength+d;return!0}this._currentPosition.copyTo(a)}a.abscissa+=d*this._partLengthRatio;c&&(0===c.length&&(0===g?(d=this._path[a.segment],c.push([d[0],d[1]])):c.push(this.getSegCoord2D(this._path,a.segment,g))),d=a.abscissa/a.segmentLength,1===d?(d=this._path[a.segment+1],c.push([d[0],d[1]])):c.push(this.getSegCoord2D(this._path,
a.segment,d)));!this._partSegCount&&Math.abs(a.abscissa-a.segmentLength)<this._tolerance&&(a.isPathEnd=this._partIsLast,a.isPartEnd=!0);return!0};b._getPoint=function(d){if(-1===d.segment)throw Error("missing segment");return this.getSegCoord2D(this._path,d.segment,0>=d.segmentLength?0:d.abscissa/d.segmentLength)};b._getAngle=function(d){if(-1===d.segment)throw Error("missing segment");return this.getSegAngleCS(this._path,d.segment,0>=d.segmentLength?0:d.abscissa/d.segmentLength)};b._setPosAtNextPart=
function(){for(;this._partSegCount;)this._hasNextSegment()&&this._nextSegment(),this._partSegCount--;if(!this._hasNextSegment())return!1;this._partLength=0;this._partIsLast=!0;for(this._partSegCount=0;this._hasNextSegment();)if(this._partLength+=this.calculateSegLength(this._path,this._nextSegment()),this._partSegCount++,1===D.getId(this._path[this._getEndPointIndex()])){this._partIsLast=!this._hasNextSegment();break}for(var d=this._partSegCount;d;)this._previousSegment(),--d;this._currentPosition.segment=
this._nextSegment();this._currentPosition.segmentLength=this.calculateSegLength(this._path,this._currentPosition.segment);this._currentPosition.abscissa=0;this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1;--this._partSegCount;d=this._getStartPointIndex();this._ctrlPtBegin=1===D.getId(this._path[d]);d=d+this._partSegCount+1;d>=this._path.length&&(d=0);this._ctrlPtEnd=1===D.getId(this._path[d]);if(0<this._patternLength){d=this._ctrlPtBegin?this._partCtrlPtGap:this._partExtPtGap;const a=
this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap;let c=Math.round((this._partLength-(d+a))/this._patternLength);0>=c&&(c=0<d+a?0:1);this._partLengthRatio=this._partLength/(d+a+c*this._patternLength);.01>this._partLengthRatio&&(this._partLengthRatio=1)}else this._partLengthRatio=1;return!0};b._hasNextSegment=function(){return this._seg<this._path.length-2};b._previousSegment=function(){return--this._seg};b._nextSegment=function(){return++this._seg};b._getStartPointIndex=function(){return this._seg};
b._getEndPointIndex=function(){return this._seg+1};return e}(B.CurveHelper);m.DashPattern=u;m.GeometryWalker=h;m.Pos=function(){this.pt=null;this.sa=this.ca=0};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectDonut":function(){define("exports ../../../geometry ../../../core/maybe ../../../geometry/support/jsonUtils ../CIMEffects ../enums ../../../geometry/SpatialReference".split(" "),function(m,p,D,B,u,t,h){p=function(){function e(){}e.local=function(){null===
e.instance&&(e.instance=new e);return e.instance};e.prototype.execute=function(b,d,a,c,f){return new l(b,d,a,c,f)};return e}();p.instance=null;let l=function(){function e(b,d,a,c,f){this._inputGeometries=b;this._tileKey=c;this._geometryEngine=f;this._width=(void 0!==d.width?d.width:2)*a;this._option=d.option}e.prototype.next=function(){let b;for(;b=this._inputGeometries.next();){if(B.isExtent(b)&&0<this._width){if(0>Math.min(b.xmax-b.xmin,b.ymax-b.ymin)-2*this._width)return b;var d=[];d.push([[b.xmin,
b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]]);d.push([[b.xmin+this._width,b.ymin+this._width],[b.xmax-this._width,b.ymin+this._width],[b.xmax-this._width,b.ymax-this._width],[b.xmin+this._width,b.ymax-this._width],[b.xmin+this._width,b.ymin+this._width]]);return{rings:d}}if(B.isPolygon(b)){d=null;var a=this._geometryEngine;let c=b;if(this._tileKey&&(c=u.clipPolygonToTileExtent(b,Math.abs(this._width)+1),!c||!c.rings||0===c.rings.length))continue;D.isSome(a)&&(d=a.buffer(h.WebMercator,
c,-this._width,1));if(0<this._width){a=[];for(const f of b.rings)f&&a.push(f);if(d)for(const f of d.rings)f&&a.push(f.reverse());if(a.length)return{rings:a}}}}return null};return e}();m.EffectDonut=p;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectJog":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(m,p,D,B){let u=function(){function h(){}h.local=function(){null===h.instance&&(h.instance=
new h);return h.instance};h.prototype.execute=function(l,e,b,d,a){return new t(l,e,b)};return h}();u.instance=null;let t=function(h){function l(e,b,d){e=h.call(this,e,!1,!0)||this;e._curveHelper=new B.CurveHelper;e._length=(void 0!==b.length?b.length:20)*d;e._angle=void 0!==b.angle?b.angle:225;e._position=void 0!==b.position?b.position:50;0>e._length&&(e._length=-e._length);20>e._position&&(e._position=20);80<e._position&&(e._position=80);e._mirror=!1;return e}p._inheritsLoose(l,h);l.prototype.processPath=
function(e){if(this._curveHelper.isEmpty(e,!1))return null;const b=e[0];e=e[e.length-1];this._curveHelper.normalize([e[0]-b[0],e[1]-b[1]]);const d=[b[0]+(e[0]-b[0])*this._position/100,b[1]+(e[1]-b[1])*this._position/100],a=Math.cos((90-this._angle)/180*Math.PI);let c=Math.sin((90-this._angle)/180*Math.PI);this._mirror&&(c=-c);this._mirror=!this._mirror;return{paths:[[b,[d[0]-this._length/2*a,d[1]-this._length/2*c],[d[0]+this._length/2*a,d[1]+this._length/2*c],e]]}};return l}(D.PathGeometryCursor);
m.EffectJog=u;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectMove":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils"],function(m,p,D){let B=function(){function t(){}t.local=function(){null===t.instance&&(t.instance=new t);return t.instance};t.prototype.execute=function(h,l,e,b,d){return new u(h,l,e)};return t}();B.instance=null;let u=function(){function t(l,e,b){this._inputGeometries=l;this._offsetX=void 0!==e.offsetX?
e.offsetX*b:0;this._offsetY=void 0!==e.offsetY?-e.offsetY*b:0}var h=t.prototype;h.next=function(){for(var l=this._inputGeometries.next();l;){if(D.isExtent(l))return{xmin:l.xmin+this._offsetX,xmax:l.xmax+this._offsetX,ymin:l.ymin+this._offsetY,ymax:l.ymax+this._offsetY};if(D.isPolygon(l))return l=p.clone(l),this._moveMultipath(l.rings,this._offsetX,this._offsetY),l;if(D.isPolyline(l))return l=p.clone(l),this._moveMultipath(l.paths,this._offsetX,this._offsetY),l;if(D.isMultipoint(l))return l=p.clone(l),
this._movePath(l.points,this._offsetX,this._offsetY),l;if(D.isPoint(l))return{x:l.x+this._offsetX,y:l.y+this._offsetY};l=this._inputGeometries.next()}return null};h._moveMultipath=function(l,e,b){if(l)for(const d of l)this._movePath(d,e,b)};h._movePath=function(l,e,b){if(l)for(const d of l)d[0]+=e,d[1]+=b};return t}();m.EffectMove=B;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectOffset":function(){define("exports ../../../geometry ../../../core/maybe ../../../geometry/support/jsonUtils ../CIMEffects ../CurveHelper ../enums ../../../geometry/SpatialReference".split(" "),
function(m,p,D,B,u,t,h,l){p=function(){function b(){}b.local=function(){null===b.instance&&(b.instance=new b);return b.instance};b.prototype.execute=function(d,a,c,f,g){return new e(d,a,c,f,g)};return b}();p.instance=null;let e=function(){function b(d,a,c,f,g){this._inputGeometries=d;this._tileKey=f;this._geometryEngine=g;this._curveHelper=new t.CurveHelper;this._offset=(a.offset??1)*c;this._method=a.method;this._option=a.option;this._offsetFlattenError=t.PIXEL_TOLERANCE*c}b.prototype.next=function(){for(var d;d=
this._inputGeometries.next();){if(0===this._offset)return d;if(B.isExtent(d)){if(this._method===h.GeometricEffectOffsetMethod.Rounded&&0<this._offset)return(d=this._curveHelper.offset([[d.xmin,d.ymin],[d.xmin,d.ymax],[d.xmax,d.ymax],[d.xmax,d.ymin],[d.xmin,d.ymin]],-this._offset,this._method,4,this._offsetFlattenError))?{rings:[d]}:null;if(0<Math.min(d.xmax-d.xmin,d.ymax-d.ymin)+2*this._offset)return{xmin:d.xmin-this._offset,xmax:d.xmax+this._offset,ymin:d.ymin-this._offset,ymax:d.ymax+this._offset}}const a=
this._geometryEngine;if(D.isNone(a))break;let c=d;if(B.isPolygon(d)){if(this._tileKey&&(c=u.clipPolygonToTileExtent(d,Math.abs(this._offset)+1),!c||!c.rings||0===c.rings.length))continue}else if(B.isPolyline(d)&&this._tileKey&&(c=u.clipPolylineToTileExtent(d,Math.abs(this._offset)+1),!c||!c.paths||0===c.paths.length))continue;return a.offset(l.WebMercator,c,-this._offset,1,this._method,4,this._offsetFlattenError)}return null};return b}();m.EffectOffset=p;Object.defineProperty(m,Symbol.toStringTag,
{value:"Module"})})},"esri/symbols/cim/effects/EffectReverse":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(m,p,D,B){let u=function(){function h(){}h.local=function(){null===h.instance&&(h.instance=new h);return h.instance};h.prototype.execute=function(l,e,b,d,a){return new t(l,e,b)};return h}();u.instance=null;let t=function(){function h(l,e,b){this._inputGeometries=l;this._reverse=void 0!==e.reverse?e.reverse:!0}h.prototype.next=
function(){for(var l=this._inputGeometries.next();l;){if(!this._reverse)return l;if(D.isPolyline(l))return l=p.clone(l),B.reverseMultipath(l.paths),l;l=this._inputGeometries.next()}return null};return h}();m.EffectReverse=u;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectRotate":function(){define(["exports","../../../core/lang","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../../../geometry/support/jsonUtils"],function(m,
p,D,B,u){let t=function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(e,b,d,a,c){return new h(e,b,d)};return l}();t.instance=null;let h=function(){function l(b,d,a){this._inputGeometries=b;this._rotateAngle=void 0!==d.angle?d.angle*Math.PI/180:0}var e=l.prototype;e.next=function(){for(var b=this._inputGeometries.next();b;){if(0===this._rotateAngle)return b;var d=D.create();B.getBoundsXY(d,b);const a=(d[2]+d[0])/2;d=(d[3]+d[1])/
2;if(u.isExtent(b))return b={rings:[[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]]]},this._rotateMultipath(b.rings,a,d),b;if(u.isPolygon(b))return b=p.clone(b),this._rotateMultipath(b.rings,a,d),b;if(u.isPolyline(b))return b=p.clone(b),this._rotateMultipath(b.paths,a,d),b;if(u.isMultipoint(b))return b=p.clone(b),this._rotatePath(b.points,a,d),b;if(u.isPoint(b))return b;b=this._inputGeometries.next()}return null};e._rotateMultipath=function(b,d,a){if(b)for(const c of b)this._rotatePath(c,
d,a)};e._rotatePath=function(b,d,a){if(b){const c=Math.cos(this._rotateAngle),f=Math.sin(this._rotateAngle);for(const g of b){b=g[0]-d;const n=g[1]-a;g[0]=d+b*c-n*f;g[1]=a+b*f+n*c}}};return l}();m.EffectRotate=t;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectScale":function(){define(["exports","../../../core/lang","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../../../geometry/support/jsonUtils"],function(m,p,D,
B,u){let t=function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(e,b,d,a,c){return new h(e,b,d)};return l}();t.instance=null;let h=function(){function l(b,d,a){this._inputGeometries=b;this._xFactor=void 0!==d.xScaleFactor?d.xScaleFactor:1.15;this._yFactor=void 0!==d.yScaleFactor?d.yScaleFactor:1.15}var e=l.prototype;e.next=function(){for(var b=this._inputGeometries.next();b;){if(1===this._xFactor&&1===this._yFactor)return b;
var d=D.create();B.getBoundsXY(d,b);const a=(d[2]+d[0])/2;d=(d[3]+d[1])/2;if(u.isExtent(b))return b={rings:[[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]]]},this._scaleMultipath(b.rings,a,d),b;if(u.isPolygon(b))return b=p.clone(b),this._scaleMultipath(b.rings,a,d),b;if(u.isPolyline(b))return b=p.clone(b),this._scaleMultipath(b.paths,a,d),b;if(u.isMultipoint(b))return b=p.clone(b),this._scalePath(b.points,a,d),b;if(u.isPoint(b))return b;b=this._inputGeometries.next()}return null};
e._scaleMultipath=function(b,d,a){if(b)for(const c of b)this._scalePath(c,d,a)};e._scalePath=function(b,d,a){if(b)for(const c of b)b=(c[1]-a)*this._yFactor,c[0]=d+(c[0]-d)*this._xFactor,c[1]=a+b};return l}();m.EffectScale=t;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectWave":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../enums","../GeometryWalker"],function(m,p,D,B,u){let t=function(){function l(){}l.local=
function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(e,b,d,a,c){return new h(e,b,d)};return l}();t.instance=null;let h=function(){function l(b,d,a){this._inputGeometries=b;this._height=(void 0!==d.amplitude?d.amplitude:2)*a;this._period=(void 0!==d.period?d.period:3)*a;this._style=d.waveform;0>=this._height&&(this._height=Math.abs(this._height));0>=this._period&&(this._period=Math.abs(this._period));this._pattern=new u.DashPattern;this._pattern.addValue(this._period);
this._pattern.addValue(this._period);this._walker=new u.GeometryWalker;this._walker.updateTolerance(a)}var e=l.prototype;e.next=function(){for(var b=this._inputGeometries.next();b;){if(0===this._height||0===this._period)return b;if(p.isPolyline(b)){const d=this._processGeom(b.paths);if(d.length)return{paths:d}}if(p.isPolygon(b)&&(b=this._processGeom(b.rings),b.length))return{rings:b};b=this._inputGeometries.next()}return null};e._processGeom=function(b){const d=[];for(const a of b)if(this._walker.init(a,
this._pattern))switch(this._style){default:d.push(this._constructCurve(a,!1));break;case B.GeometricEffectWaveform.Square:d.push(this._constructSquare(a));break;case B.GeometricEffectWaveform.Triangle:d.push(this._constructTriangle(a));break;case B.GeometricEffectWaveform.Random:d.push(this._constructCurve(a,!0))}else d.push(a);return d};e._constructCurve=function(b,d){const a=new D.PathHelper;var c=this._walker.calculatePathLength(b),f=Math.round(c/this._period);0===f&&(f=1);const g=this._period/
16,n=1/(16*f+1);c=2*Math.PI*c/(c/f);f=2*Math.PI*Math.random();const k=2*Math.PI*Math.random(),x=2*Math.PI*Math.random(),r=.75-Math.random()/2,v=.75-Math.random()/2,q=new u.Pos;this._walker.curPointAndAngle(q);a.startPath(q.pt);let y=0;for(;;)if(this._walker.nextPointAndAngle(g,q)){const A=y;y+=n;let w;if(d){const z=this._height/2*(1+.3*Math.sin(r*c*A+f));w=z*Math.sin(c*A+k);w+=z*Math.sin(v*c*A+x);w/=2}else w=.5*this._height*Math.sin(.5*c*A);a.lineTo([q.pt[0]-w*q.sa,q.pt[1]+w*q.ca])}else{a.lineTo(b[b.length-
1]);break}return a.path()};e._constructSquare=function(b){const d=new D.PathHelper;b=this._walker.calculatePathLength(b);Math.round(b/this._period);for(b=!0;;){let a=!1;if(this._walker.curPositionIsValid()){const c=new u.Pos;this._walker.curPointAndAngle(c);const f=new u.Pos;if(this._walker.nextPointAndAngle(this._period,f)){const g=new u.Pos;this._walker.nextPointAndAngle(this._period,g)&&(b?(d.startPath(c.pt),b=!1):d.lineTo(c.pt),d.lineTo([c.pt[0]-this._height/2*c.sa,c.pt[1]+this._height/2*c.ca]),
d.lineTo([f.pt[0]-this._height/2*f.sa,f.pt[1]+this._height/2*f.ca]),d.lineTo([f.pt[0]+this._height/2*f.sa,f.pt[1]-this._height/2*f.ca]),d.lineTo([g.pt[0]+this._height/2*g.sa,g.pt[1]-this._height/2*g.ca]),a=!0)}}if(!a){d.lineTo(this._walker.getPathEnd());break}}return d.path()};e._constructTriangle=function(b){const d=new D.PathHelper;b=this._walker.calculatePathLength(b);Math.round(b/this._period);for(b=!0;;){let a=!1;if(this._walker.curPositionIsValid()){const c=new u.Pos;this._walker.curPointAndAngle(c);
const f=new u.Pos;if(this._walker.nextPointAndAngle(this._period/2,f)){const g=new u.Pos;this._walker.nextPointAndAngle(this._period,g)&&(this._walker.nextPosition(this._period/2)&&(b?(d.startPath(c.pt),b=!1):d.lineTo(c.pt),d.lineTo([f.pt[0]-this._height/2*f.sa,f.pt[1]+this._height/2*f.ca]),d.lineTo([g.pt[0]+this._height/2*g.sa,g.pt[1]-this._height/2*g.ca])),a=!0)}}if(!a){d.lineTo(this._walker.getPathEnd());break}}return d.path()};return l}();m.EffectWave=t;Object.defineProperty(m,Symbol.toStringTag,
{value:"Module"})})},"esri/symbols/cim/placements/PlacementAlongLineSameSize":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../enums","../GeometryWalker"],function(m,p,D,B,u){let t=function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(e,b,d,a,c){return new h(e,b,d)};return l}();t.instance=null;let h=function(l){function e(d,a,c){d=l.call(this,d,!0,!0)||this;d._geometryWalker=new u.GeometryWalker;
d._geometryWalker.updateTolerance(c);d._angleToLine=a.angleToLine??!0;d._offset=(a.offset?a.offset:0)*c;d._originalEndings=a.endings;d._offsetAtEnd=(a.customEndingOffset?a.customEndingOffset:0)*c;d._position=-(a.offsetAlongLine?a.offsetAlongLine:0)*c;d._pattern=new u.DashPattern;d._pattern.init(a.placementTemplate,!1);d._pattern.scale(c);d._endings=d._originalEndings;return d}p._inheritsLoose(e,l);var b=e.prototype;b.processPath=function(d){if(this._pattern.isEmpty())return null;if(this.iteratePath)var a=
this._pattern.nextValue();else{this._endings=this._originalEndings===B.PlacementEndings.WithFullGap&&this.isClosed?B.PlacementEndings.WithMarkers:this._originalEndings;this._pattern.extPtGap=0;let c=!0;switch(this._endings){case B.PlacementEndings.NoConstraint:a=-this._position;a=this._adjustPosition(a);c=!1;break;default:a=-this._pattern.lastValue()/2;break;case B.PlacementEndings.WithFullGap:a=-this._pattern.lastValue();this._pattern.extPtGap=this._pattern.lastValue();break;case B.PlacementEndings.WithMarkers:a=
0;break;case B.PlacementEndings.Custom:a=-this._position,a=this._adjustPosition(a),this._pattern.extPtGap=.5*this._offsetAtEnd}if(!this._geometryWalker.init(d,this._pattern,c))return null;this._pattern.reset();for(d=0;a>d;)a-=d,d=this._pattern.nextValue();a=d-a;this.iteratePath=!0}d=new u.Pos;if(!this._geometryWalker.nextPointAndAngle(a,d)||this._endings===B.PlacementEndings.WithFullGap&&this._geometryWalker.isPathEnd())return this.iteratePath=!1,null;if(this._endings===B.PlacementEndings.WithMarkers&&
this._geometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed))return null;this.internalPlacement.setTranslate(d.pt[0]-this._offset*d.sa,d.pt[1]+this._offset*d.ca);this._angleToLine&&this.internalPlacement.setRotateCS(d.ca,d.sa);return this.internalPlacement};b._adjustPosition=function(d){d/=this._pattern.length();d-=Math.floor(d);return d*this._pattern.length()};return e}(D.PathTransformationCursor);m.PlacementAlongLineSameSize=t;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},
"esri/symbols/cim/placements/PlacementAtExtremities":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper","../enums"],function(m,p,D,B,u){let t=function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(e,b,d,a,c){return new h(e,b,d)};return l}();t.instance=null;let h=function(l){function e(d,a,c){d=l.call(this,d,!1,!0)||this;d._curveHelper=new B.CurveHelper;d._angleToLine=void 0!==
a.angleToLine?a.angleToLine:!0;d._offset=void 0!==a.offset?a.offset*c:0;d._type=a.extremityPlacement;d._position=void 0!==a.offsetAlongLine?a.offsetAlongLine*c:0;d._beginProcessed=!1;return d}p._inheritsLoose(e,l);var b=e.prototype;b.processPath=function(d){let a;switch(this._type){default:this._beginProcessed?(a=this._atExtremities(d,this._position,!1),this.iteratePath=this._beginProcessed=!1):(a=this._atExtremities(d,this._position,!0),this.iteratePath=this._beginProcessed=!0);break;case u.ExtremityPlacement.JustBegin:a=
this._atExtremities(d,this._position,!0);break;case u.ExtremityPlacement.JustEnd:a=this._atExtremities(d,this._position,!1);case u.ExtremityPlacement.None:}return a};b._atExtremities=function(d,a,c){var f=d.length;if(2>f)return null;var g=c?1:f-2;const n=c?f:-1,k=c?1:-1;let x=0;c=c?d[0]:d[f-1];for(f=g;f!==n;f+=k){g=c;c=d[f];const r=this._curveHelper.calculateLength(g,c);if(x+r>a){d=(a-x)/r;const [v,q]=this._curveHelper.getAngleCS(g,c,d);d=D.getCoord2D(g,c,d);this.internalPlacement.setTranslate(d[0]-
this._offset*q,d[1]+this._offset*v);this._angleToLine&&this.internalPlacement.setRotateCS(-v,-q);return this.internalPlacement}x+=r}return null};return e}(D.PathTransformationCursor);m.PlacementAtExtremities=t;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/placements/PlacementAtRatioPositions":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../GeometryWalker"],function(m,p,D,B){let u=function(){function h(){}h.local=function(){null===
h.instance&&(h.instance=new h);return h.instance};h.prototype.execute=function(l,e,b,d,a){return new t(l,e,b)};return h}();u.instance=null;let t=function(h){function l(e,b,d){e=h.call(this,e,!0,!0)||this;e._walker=new B.GeometryWalker;e._walker.updateTolerance(d);e._angleToLine=void 0!==b.angleToLine?b.angleToLine:!0;e._offset=void 0!==b.offset?b.offset*d:0;e._beginGap=void 0!==b.beginPosition?b.beginPosition*d:0;e._endGap=void 0!==b.endPosition?b.endPosition*d:0;e._flipFirst=void 0!==b.flipFirst?
b.flipFirst:!0;e._pattern=new B.DashPattern;e._pattern.init(b.positionArray,!1,!1);e._subPathLen=0;e._posCount=e._pattern.size();e._isFirst=!0;e._prevPos=0;return e}p._inheritsLoose(l,h);l.prototype.processPath=function(e){if(this._pattern.isEmpty())return null;if(this.iteratePath){e=this._pattern.nextValue()*this._subPathLen;var b=this._beginGap+e;e=b-this._prevPos;this._prevPos=b}else{this._posCount=this._pattern.size();this._isFirst=!0;this._prevPos=0;this._subPathLen=this._walker.calculatePathLength(e)-
this._beginGap-this._endGap;if(0>this._subPathLen)return this.iteratePath=!1,null;if(!this._walker.init(e,this._pattern,!1))return null;this._pattern.reset();e=this._pattern.nextValue()*this._subPathLen;b=this._beginGap+e;e=b-this._prevPos;this._prevPos=b;this.iteratePath=!0}b=new B.Pos;if(!this._walker.nextPointAndAngle(e,b,B.EndType.END))return this.iteratePath=!1,null;this.internalPlacement.setTranslate(b.pt[0]-this._offset*b.sa,b.pt[1]+this._offset*b.ca);e=this._isFirst&&this._flipFirst;let d;
this._angleToLine?(d=b.ca,b=b.sa):(d=1,b=0);e&&(d=-d,b=-b);this.internalPlacement.setRotateCS(d,b);this._isFirst=!1;this._posCount--;0===this._posCount&&(this.iteratePath=!1);return this.internalPlacement};return l}(D.PathTransformationCursor);m.PlacementAtRatioPositions=u;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/placements/PlacementInsidePolygon":function(){define(["exports","../../../core/maybe","../../../core/RandomLCG","../CIMPlacements","../enums"],function(m,
p,D,B,u){function t(e,b,d,a){let c=a.get(e);c||(c=[],a.set(e,c));c.push([b,d])}let h=function(){function e(){}e.local=function(){null===e.instance&&(e.instance=new e);return e.instance};e.prototype.execute=function(b,d,a,c,f){return new l(b,d,a,c,f)};return e}();h.instance=null;let l=function(){function e(d,a,c,f,g){this._currentY=this._currentX=this._yMax=this._yMin=this._xMax=this._xMin=0;this._accelerationMap=null;this._testInsidePolygon=!1;this._verticalSubdivision=!0;this._stepX=Math.abs(a.stepX??
16)*c;this._stepY=Math.abs(a.stepY??16)*c;if(0!==this._stepX&&0!==this._stepY&&d&&void 0!==d.rings&&d.rings){this._gridType=a.gridType??u.PlacementGridType.Fixed;if(this._gridType===u.PlacementGridType.Random)this._randomLCG=new D(1*(a.seed??13)),this._randomness=(a.randomness??100)/100,this._gridAngle=0,this._shiftOddRows=!1,this._cosAngle=1,this._offsetY=this._offsetX=this._sinAngle=0,this._buildRandomValues();else{this._randomness=0;this._gridAngle=a.gridAngle??0;this._shiftOddRows=a.shiftOddRows??
!1;this._offsetX=(a.offsetX??0)*c;this._offsetY=(a.offsetY??0)*c;this._cosAngle=Math.cos(this._gridAngle/180*Math.PI);this._sinAngle=-Math.sin(this._gridAngle/180*Math.PI);if(this._stepX)if(0>this._offsetX)for(;this._offsetX<-.5*this._stepX;)this._offsetX+=this._stepX;else for(;this._offsetX>=.5*this._stepX;)this._offsetX-=this._stepX;if(this._stepY)if(0>this._offsetY)for(;this._offsetY<-.5*this._stepY;)this._offsetY+=this._stepY;else for(;this._offsetY>=.5*this._stepY;)this._offsetY-=this._stepY}this._graphicOriginY=
this._graphicOriginX=0;if(null!=f){const [,n,k]=f.split("/");a=parseFloat(n);this._graphicOriginX=512*-parseFloat(k);this._graphicOriginY=512*a;this._testInsidePolygon=!0}this._internalPlacement=new B.Placement;this._calculateMinMax(d);this._geometry=d}}var b=e.prototype;b.next=function(){return this._geometry?this._nextInside():null};b._buildRandomValues=function(){if(!e._randValues){e._randValues=[];for(let d=0;24>d;d++)for(let a=0;24>a;a++)e._randValues.push(this._randomLCG.getFloat()),e._randValues.push(this._randomLCG.getFloat())}};
b._calculateMinMax=function(d){this._yMax=this._yMin=this._xMax=this._xMin=0;let a;let c,f,g,n,k,x,r,v;c=f=r=k=Number.MAX_VALUE;g=n=v=x=-Number.MAX_VALUE;var q=1!==this._cosAngle;let y=0;for(var A of d.rings){var w=A?A.length:0;for(var z=0;z<w;z++){var C=A[z][0];var E=A[z][1];var F=C-this._graphicOriginX-this._offsetX;a=E-this._graphicOriginY-this._offsetY;if(q){var G=this._cosAngle*F-this._sinAngle*a;F=this._sinAngle*F+this._cosAngle*a}else G=F,F=a;c=Math.min(c,G);g=Math.max(g,G);f=Math.min(f,F);
n=Math.max(n,F);k=Math.min(k,E);x=Math.max(x,E);r=Math.min(r,C);v=Math.max(v,C);y++}}k=k!==Number.MAX_VALUE?k:-512-this._stepY;x=x!==-Number.MAX_VALUE?x:this._stepY;r=r!==Number.MAX_VALUE?r:-this._stepX;v=v!==-Number.MAX_VALUE?v:512+this._stepX;G=x-k;E=v-r;this._polygonMin=(this._verticalSubdivision=G>=E)?k:r;if(this._testInsidePolygon){C=0-this._graphicOriginX-this._offsetX-this._stepX;A=512-this._graphicOriginX-this._offsetX+this._stepX;w=-512-this._graphicOriginY-this._offsetY-this._stepY;z=0-
this._graphicOriginY-this._offsetY+this._stepY;if(q){q=[[C,w],[C,z],[A,w],[A,z]];C=w=Number.MAX_VALUE;A=z=-Number.MAX_VALUE;for(const H of q)q=this._cosAngle*H[0]-this._sinAngle*H[1],F=this._sinAngle*H[0]+this._cosAngle*H[1],C=Math.min(C,q),A=Math.max(A,q),w=Math.min(w,F),z=Math.max(z,F)}c=c!==Number.MAX_VALUE?Math.max(c,C):C;f=f!==Number.MAX_VALUE?Math.max(f,w):w;g=g!==-Number.MAX_VALUE?Math.min(g,A):A;n=n!==-Number.MAX_VALUE?Math.min(n,z):z}this._xMin=Math.round(c/this._stepX);this._xMax=Math.round(g/
this._stepX);this._yMin=Math.round(f/this._stepY);this._yMax=Math.round(n/this._stepY);this._currentX=this._xMax+1;this._currentY=this._yMin-1;this._testInsidePolygon&&12<y&&(25<G||25<E)&&this._buildAccelerationMap(d,r,v,k,x)};b._buildAccelerationMap=function(d,a,c,f,g){({rings:d}=d);const n=new Map,k=this._verticalSubdivision;c=k?g-f:c-a;g=Math.ceil(c/10);if(!(1>=g)){c=Math.floor(c/g);g++;this._delta=c;if(k){g=-512-this._stepY;var x=this._stepY}else g=-this._stepX,x=512+this._stepX,f=a;for(let A=
0;A<d.length;A++)if(a=d[A],!(2>a.length))for(let w=1;w<a.length;w++){var r=a[w-1];var v=a[w];if(k){if(r[1]===v[1]||r[1]<g&&v[1]<g||r[1]>x&&v[1]>x)continue;var q=Math.min(r[1],v[1]);r=Math.max(r[1],v[1])}else{if(r[0]===v[0]||r[0]<g&&v[0]<g||r[0]>x&&v[0]>x)continue;q=Math.min(r[0],v[0]);r=Math.max(r[0],v[0])}for(;q<r;){var y=Math.floor((q-f)/c);t(y,A,w,n);q+=c}q=Math.floor((r-f)/c);q>y&&t(q,A,w,n)}this._accelerationMap=n}};b._nextInside=function(){for(;;){if(this._currentX>this._xMax){this._currentY++;
if(this._currentY>this._yMax)return null;this._currentX=this._xMin;this._shiftOddRows&&this._currentY%2&&this._currentX--}var d=this._currentX*this._stepX+this._offsetX;this._shiftOddRows&&this._currentY%2&&(d+=.5*this._stepX);const a=this._currentY*this._stepY+this._offsetY;this._currentX++;let c;if(this._gridType===u.PlacementGridType.Random){const f=(this._currentX%24+24)%24,g=(this._currentY%24+24)%24;c=this._graphicOriginX+d+this._stepX*this._randomness*(.5-e._randValues[24*g+f])*2/3;d=this._graphicOriginY+
a+this._stepY*this._randomness*(.5-e._randValues[24*g+f+1])*2/3}else c=this._graphicOriginX+this._cosAngle*d+this._sinAngle*a,d=this._graphicOriginY-this._sinAngle*d+this._cosAngle*a;if(!this._testInsidePolygon||this._isInsidePolygon(c,d,this._geometry))return this._internalPlacement.setTranslate(c,d),this._internalPlacement}};b._isInsidePolygon=function(d,a,c){var {rings:f}=c;if(p.isNone(this._accelerationMap)){var {rings:g}=c;f=0;for(var n of g){g=n.length;for(var k=1;k<g;++k){c=n[k-1];var x=n[k];
c[1]>a!==x[1]>a&&(0<(x[0]-c[0])*(a-c[1])-(x[1]-c[1])*(d-c[0])?f++:f--)}}return 0!==f}n=this._verticalSubdivision;x=this._accelerationMap.get(Math.floor(((n?a:d)-this._polygonMin)/this._delta));if(!x)return!1;c=0;for(g of x){x=g[0];const r=f[x];k=g[1];x=r[k-1];k=r[k];if(n){if(x[1]>a===k[1]>a)continue;x=(k[0]-x[0])*(a-x[1])-(k[1]-x[1])*(d-x[0])}else{if(x[0]>d===k[0]>d)continue;x=(k[1]-x[1])*(d-x[0])-(k[0]-x[0])*(a-x[1])}0<x?c++:c--}return 0!==c};return e}();m.PlacementInsidePolygon=h;Object.defineProperty(m,
Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/placements/PlacementOnLine":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper","../enums"],function(m,p,D,B,u){let t=function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(e,b,d,a,c){return new h(e,b,d)};return l}();t.instance=null;let h=function(l){function e(d,a,c){d=l.call(this,d,!0,!0)||this;d._curveHelper=new B.CurveHelper;
d._angleToLine=void 0!==a.angleToLine?a.angleToLine:!0;d._offset=void 0!==a.offset?a.offset*c:0;d._relativeTo=a.relativeTo;d._position=void 0!==a.startPointOffset?a.startPointOffset*c:0;d._epsilon=.001*c;return d}p._inheritsLoose(e,l);var b=e.prototype;b.processPath=function(d){var a=this._position;if(this._relativeTo===u.PlacementOnLineRelativeTo.SegmentMidpoint){this.iteratePath||(this._segmentCount=d.length,this._curSegment=1,this.iteratePath=!0);for(;this._curSegment<this._segmentCount;){var c=
this._curSegment;this._curSegment++;a=d[c-1];c=d[c];const f=this._curveHelper.calculateLength(a,c);if(f<this._epsilon)continue;d=.5+this._position/f;const [g,n]=this._curveHelper.getAngleCS(a,c,d);d=D.getCoord2D(a,c,d);this.internalPlacement.setTranslate(d[0]-this._offset*n,d[1]+this._offset*g);this._angleToLine&&this.internalPlacement.setRotateCS(g,n);return this.internalPlacement}this.iteratePath=!1;return null}this._relativeTo===u.PlacementOnLineRelativeTo.LineEnd&&D.reversePath(d);a=this.onLine(d,
a);this._relativeTo===u.PlacementOnLineRelativeTo.LineEnd&&D.reversePath(d);return a};b.onLine=function(d,a){let c,f=!1;switch(this._relativeTo){default:c=this._curveHelper.calculatePathLength(d)/2+a;break;case u.PlacementOnLineRelativeTo.LineBeginning:c=a;break;case u.PlacementOnLineRelativeTo.LineEnd:c=a,f=!0}const g=d.length;let n=0,k=d[0];for(let x=1;x<g;++x){a=k;k=d[x];const r=this._curveHelper.calculateLength(a,k);if(n+r>c){d=(c-n)/r;const [v,q]=this._curveHelper.getAngleCS(a,k,d);d=D.getCoord2D(a,
k,d);a=f?-this._offset:this._offset;this.internalPlacement.setTranslate(d[0]-a*q,d[1]+a*v);this._angleToLine&&(f?this.internalPlacement.setRotateCS(-v,-q):this.internalPlacement.setRotateCS(v,q));return this.internalPlacement}n+=r}return null};return e}(D.PathTransformationCursor);m.PlacementOnLine=t;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/placements/PlacementOnVertices":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor",
"../CurveHelper"],function(m,p,D,B){function u(l,e){const b=Math.PI;for(;Math.abs(e-l)>b+2E-15;)e=e-l>b?e-2*b:e+2*b;return(l+e)/2}let t=function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(e,b,d,a,c){return new h(e,b,d)};return l}();t.instance=null;let h=function(l){function e(d,a,c){d=l.call(this,d,!0,!0)||this;d._curveHelper=new B.CurveHelper;d._angleToLine=void 0!==a.angleToLine?a.angleToLine:!0;d._offset=void 0!==a.offset?
a.offset*c:0;d._endPoints=void 0!==a.placeOnEndPoints?a.placeOnEndPoints:!0;d._controlPoints=void 0!==a.placeOnControlPoints?a.placeOnControlPoints:!0;d._regularVertices=void 0!==a.placeOnRegularVertices?a.placeOnRegularVertices:!0;d._tags=[];d._tagIterator=0;return d}p._inheritsLoose(e,l);var b=e.prototype;b.processPath=function(d){this.iteratePath||(this._preparePath(d),this.iteratePath=!0);if(this._tagIterator>=this._tags.length)return this._tagIterator=this._tags.length=0,this.iteratePath=!1,
null;d=this._tags[this._tagIterator];this._angleToLine&&this.internalPlacement.setRotate(d[2]);let a=d[0],c=d[1];if(0!==this._offset){const f=Math.cos(d[2]);a-=this._offset*Math.sin(d[2]);c+=this._offset*f}this.internalPlacement.setTranslate(a,c);this._tagIterator++;return this.internalPlacement};b._preparePath=function(d){this._tagIterator=this._tags.length=0;const a=D.isClosedPath(d),c=d.length-1;let f=0,g=0,n=0,k=0,x=0,r,v;for(;f<c;){f++;r=d[f-1];v=d[f];const q=D.getId(r),y=D.getId(v);if(this._angleToLine||
0!==this._offset)k=this._curveHelper.getAngle(r,v,0);1===f?a?(g=k,n=q):(this._endPoints||this._controlPoints&&1===q)&&this._tags.push([r[0],r[1],k]):1===q?this._controlPoints&&this._tags.push([r[0],r[1],u(x,k)]):this._regularVertices&&this._tags.push([r[0],r[1],u(x,k)]);if(this._angleToLine||0!==this._offset)x=this._curveHelper.getAngle(r,v,1);f===c&&(a?1===y||1===n?this._controlPoints&&this._tags.push([v[0],v[1],u(x,g)]):this._regularVertices&&this._tags.push([v[0],v[1],u(x,g)]):(this._endPoints||
this._controlPoints&&1===y)&&this._tags.push([v[0],v[1],x]))}this._tagIterator=0};return e}(D.PathTransformationCursor);m.PlacementOnVertices=t;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/placements/PlacementPolygonCenter":function(){define("exports ../../../core/has ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/centroid ../../../geometry/support/labelPoint ../CIMPlacements ../enums".split(" "),function(m,
p,D,B,u,t,h,l){let e=function(){function d(){}d.local=function(){null===d.instance&&(d.instance=new d);return d.instance};d.prototype.execute=function(a,c,f,g,n){return new b(a,c,f)};return d}();e.instance=null;let b=function(){function d(c,f,g){this._geometry=c;this._offsetX=void 0!==f.offsetX?f.offsetX*g:0;this._offsetY=void 0!==f.offsetY?f.offsetY*g:0;this._method=void 0!==f.method?f.method:l.PlacementPolygonCenterMethod.OnPolygon;this._internalPlacement=new h.Placement}var a=d.prototype;a.next=
function(){const c=this._geometry;this._geometry=null;return c&&void 0!==c.rings?this._polygonCenter(c):null};a._polygonCenter=function(c){let f=!1;switch(this._method){case l.PlacementPolygonCenterMethod.CenterOfMass:if(c=u.weightedAreaCentroid(c))this._internalPlacement.setTranslate(c[0]+this._offsetX,c[1]+this._offsetY),f=!0;break;case l.PlacementPolygonCenterMethod.BoundingBoxCenter:const g=D.create();B.getBoundsXY(g,c);g&&(this._internalPlacement.setTranslate((g[2]+g[0])/2+this._offsetX,(g[3]+
g[1])/2+this._offsetY),f=!0);break;default:c=p("polylabel-placement-enabled")?t.getPolylabelPoint(c):t.getLabelPoint(c),null!==c&&(this._internalPlacement.setTranslate(c[0]+this._offsetX,c[1]+this._offsetY),f=!0)}return f?this._internalPlacement:null};return d}();m.PlacementPolygonCenter=e;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/labelPoint":function(){define("exports ../../core/maybe ../../core/PriorityQueue ./aaBoundingRect ./boundsUtils ./centroid ./coordsUtils ./intersectsBase".split(" "),
function(m,p,D,B,u,t,h,l){function e(n,k){var {rings:x}=k;k=0;for(const r of x){x=r.length;for(let v=1;v<x;++v){const q=r[v-1],y=r[v];q[1]>n[1]!==y[1]>n[1]&&(0<(y[0]-q[0])*(n[1]-q[1])-(y[1]-q[1])*(n[0]-q[0])?k++:k--)}}return 0!==k}function b(n,k,x){if(x&&e(n,k))return{coord:n,distance:0};x=Infinity;let r=0,v=0;const q=[0,0];({rings:k}=k);for(const y of k)if(!(2>y.length))for(k=0;k<y.length-1;k++){h.projectPointOnLine(q,n,y,k);const A=c(n,q);A<x&&(x=A,r=q[0],v=q[1])}return{coord:[r,v],distance:Math.sqrt(x)}}
function d(n,k,x,r){x=[k,0];let v=Infinity,q=Infinity,y=!1,A=!1;k=[[k,r[1]-1],[k,r[3]+1]];r=[0,0];const w=[0,0],z=[0,0],C=[[0,0],[0,0]],E=B.create();({rings:n}=n);for(const L of n)if(!(2>L.length))for(n=1;n<L.length;n++){C[0][0]=L[n-1][0];C[0][1]=L[n-1][1];C[1][0]=L[n][0];C[1][1]=L[n][1];a:{var F=E;var G=C;if(2>G.length){F=null;break a}F||(F=B.create());const [K,M]=G[0],[U,T]=G[1];F[0]=Math.min(K,U);F[1]=Math.min(M,T);F[2]=Math.max(K,U);F[3]=Math.max(M,T)}if(null!==F){w[0]=k[0][0];w[1]=k[0][1];z[0]=
k[1][0];z[1]=k[1][1];a:{F=E;G=w;var H=z;let K=a(G,F),M=a(H,F);const U=F[0],T=F[1],Z=F[2],X=F[3];if(K&M){F=0;break a}if(!(K|M)){F=4;break a}const ca=(K?1:0)|(M?2:0);do{const P=H[0]-G[0],J=H[1]-G[1];if(P>J)K&3?(K&1?(G[1]+=J*(U-G[0])/P,G[0]=U):(G[1]+=J*(Z-G[0])/P,G[0]=Z),K=a(G,F)):M&3?(M&1?(H[1]+=J*(U-H[0])/P,H[0]=U):(H[1]+=J*(Z-H[0])/P,H[0]=Z),M=a(H,F)):K?(K&4?(G[0]+=P*(T-G[1])/J,G[1]=T):(G[0]+=P*(X-G[1])/J,G[1]=X),K=a(G,F)):(M&4?(H[0]+=P*(T-H[1])/J,H[1]=T):(H[0]+=P*(X-H[1])/J,H[1]=X),M=a(H,F));else if(K&
12?(K&4?(G[0]+=P*(T-G[1])/J,G[1]=T):(G[0]+=P*(X-G[1])/J,G[1]=X),K=a(G,F)):M&12?(M&4?(H[0]+=P*(T-H[1])/J,H[1]=T):(H[0]+=P*(X-H[1])/J,H[1]=X),M=a(H,F)):K?(K&1?(G[1]+=J*(U-G[0])/P,G[0]=U):(G[1]+=J*(Z-G[0])/P,G[0]=Z),K=a(G,F)):(M&1?(H[1]+=J*(U-H[0])/P,H[0]=U):(H[1]+=J*(Z-H[0])/P,H[0]=Z),M=a(H,F)),K&M){F=0;break a}}while(K|M);F=ca}0!==F&&l.segmentIntersects(k[0],k[1],C[0],C[1],r)&&(F=r[1],v>q?F<v&&(v=F,y=!0):F<q&&(q=F,A=!0))}}y&&A?x[1]=(v+q)/2:x[0]=x[1]=NaN;return x}function a(n,k){return(n[0]<k[0]?1:
0)|(n[0]>k[2]?1:0)<<1|(n[1]<k[1]?1:0)<<2|(n[1]>k[3]?1:0)<<3}function c(n,k){return(n[0]-k[0])*(n[0]-k[0])+(n[1]-k[1])*(n[1]-k[1])}function f(n,k){if(n<k)return-1;if(n>k)return 1;if(n===k)return 0;n=isNaN(n);k=isNaN(k);return n<k?-1:n>k?1:0}let g=function(n,k,x,r){this.x=n;this.y=k;this.cellSize=x;this.distancefromCellCenter=h.distanceFromPointToPolygon(n,k,r);this.maxDistanceToPolygon=this.distancefromCellCenter+this.cellSize*Math.SQRT2};m.getLabelPoint=function(n){var {rings:k}=n;if(!k||0===k.length)return null;
var x=u.getBoundsXY(B.create(),n);if(!x)return null;var r=8.8818E-14*(Math.abs(x[0])+Math.abs(x[2])+Math.abs(x[1])+Math.abs(x[3])+1),v=0,q=0;for(var y=0;y<k.length;y++){var A=h.getRingArea(k[y]);A>q&&(q=A,v=y)}if(Math.abs(q)<=2*r*r)return q=u.getPointsBounds(B.create(),k[v]),[(q[0]+q[2])/2,(q[1]+q[3])/2];var w=t.ringCentroid(k[v],!1,B.create());if(null===w)return null;if(1===k.length&&4>k[0].length)return w;q=[[NaN,NaN],[NaN,NaN],[NaN,NaN],[NaN,NaN]];y=[NaN,NaN,NaN,NaN];A=[NaN,NaN,NaN,NaN];var z=
!1,C=b(w,n,!0);0===C.distance&&(z=!0,q[0][0]=w[0],q[0][1]=w[1],C=b(w,n,!1));y[0]=C.distance;A[0]=0;var E=[NaN,NaN],F=!1;let G=.25,H=-1;k=u.getPointsBounds(B.create(),k[v]);v=NaN;do if(v=NaN,C=k[0],q[1]=d(n,C+(k[2]-C)*G,r,x),isNaN(q[1][0])||isNaN(q[1][1])||(C=b(q[1],n,!1),v=C.distance),!isNaN(v)&&v>r&&e(q[1],n))F=!0,y[1]=v,A[1]=c(q[1],w);else if(!isNaN(v)&&v>H&&(H=v,E[0]=q[1][0],E[1]=q[1][1]),G-=.01,.1>G)if(0<=H)F=!0,y[1]=H,q[1][0]=E[0],q[1][1]=E[1],A[1]=c(q[1],w);else break;while(!F);F=!1;G=.5;H=
-1;let L=.01,K=1;do if(v=NaN,C=k[0],q[2]=d(n,C+(k[2]-C)*G,r,x),isNaN(q[2][0])||isNaN(q[2][1])||(C=b(q[2],n,!1),v=C.distance),!isNaN(v)&&v>r&&e(q[2],n))F=!0,y[2]=v,A[2]=c(q[2],w);else if(!isNaN(v)&&v>H)H=v,E[0]=q[2][0],E[1]=q[2][1];else if(v>H&&(H=v,E[0]=q[2][0],E[1]=q[2][1]),G=.5+L*K,L+=.01,K*=-1,.3>G||.7<G)if(0<=H)F=!0,y[2]=H,q[2][0]=E[0],q[2][1]=E[1],A[2]=c(q[2],w);else break;while(!F);F=!1;G=.75;H=-1;do if(v=NaN,C=k[0],q[3]=d(n,C+(k[2]-C)*G,r,x),isNaN(q[3][0])||isNaN(q[3][1])||(C=b(q[3],n,!1),
v=C.distance),!isNaN(v)&&v>r&&e(q[3],n))F=!0,y[3]=v,A[3]=c(q[3],w);else if(v>H&&(H=v,E[0]=q[3][0],E[1]=q[3][1]),G+=.01,.9<G)if(0<=H)F=!0,y[3]=H,q[3][0]=E[0],q[3][1]=E[1],A[3]=c(q[3],w);else break;while(!F);n=[0,1,2,3];x=z?0:1;for(z=x;4>z;z++)for(w=x;3>w;w++)E=A[w],F=A[w+1],0<f(E,F)&&(r=n[w],n[w]=n[w+1],n[w+1]=r,A[w]=F,A[w+1]=E);A=x;for(z=r=0;4>x;x++){switch(x){case 0:z=2*y[n[x]];break;case 1:z=1.66666666*y[n[x]];break;case 2:z=1.33333333*y[n[x]];break;case 3:z=y[n[x]]}z>r&&(r=z,A=n[x])}return q[A]};
m.getPolylabelPoint=function(n){if(!n||!n.rings||0===n.rings.length)return null;var k=u.getPointsBounds(B.create(),n.rings[0]);if(!k)return null;var x=k[2]-k[0],r=k[3]-k[1];if(0===x||0===r)return[k[0]+x/2,k[1]+r/2];const v=Math.max(Math.min(x,r)/100,1),q=new D((w,z)=>z.maxDistanceToPolygon-w.maxDistanceToPolygon);r=Math.min(x,r);x=r/2;let y=0,A=0;for(y=k[0];y<k[2];y+=r)for(A=k[1];A<k[3];A+=r)q.enqueue(new g(y+x,A+x,x,n));k=t.ringsCentroid(n.rings,!1);if(null===k)return null;for(k=new g(k[0],k[1],
0,n);0<q.size;)r=p.unwrap(q.dequeue()),r.distancefromCellCenter>k.distancefromCellCenter&&(k=r),r.maxDistanceToPolygon-k.distancefromCellCenter<=v||(x=r.cellSize/2,q.enqueue(new g(r.x-x,r.y-x,x,n)),q.enqueue(new g(r.x+x,r.y-x,x,n)),q.enqueue(new g(r.x-x,r.y+x,x,n)),q.enqueue(new g(r.x+x,r.y+x,x,n)));return[k.x,k.y]};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/core/PriorityQueue":function(){define(["../chunks/_rollupPluginBabelHelpers"],function(m){const p=(D,B)=>D<B?-1:D>
B?1:0;return function(){function D(u=p){this._data=[];this._compare=u}var B=D.prototype;B.enqueue=function(u){if(null!=u){var {_data:t,_compare:h}=this;t.push(u);u=t.length-1>>>0;for(var l=t[u];0<u;){const e=u-1>>1,b=t[e];if(0>=h(b,l))t[e]=l,t[u]=b,u=e;else break}}};B.dequeue=function(){const {_data:u,_compare:t}=this,h=u[0];var l=u.pop();if(0===u.length)return h;u[0]=l;l=0;const e=u.length,b=u[0];let d;let a=null;for(;;){var c=2*l+1;const f=2*l+2;a=null;c<e&&(d=u[c],0<t(d,b)&&(a=c));f<e&&(c=u[f],
null===a&&0>=t(c,b)||null!==a&&0>=t(c,d))&&(a=f);if(null===a)break;u[l]=u[a];u[a]=b;l=a}return h};m._createClass(D,[{key:"size",get:function(){return this._data.length}}]);return D}()})},"esri/symbols/cim/imageUtils":function(){define(["exports"],function(m){m.getFirstFrame=function(p){const D=p.getFrame(0);if(D instanceof HTMLImageElement||D instanceof HTMLCanvasElement)return D;const B=document.createElement("canvas");B.width=p.width;B.height=p.height;p=B.getContext("2d");D instanceof ImageData?
p.putImageData(D,0,0):p.drawImage(D,0,0);return B};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/Rect":function(){define(["../../chunks/_rollupPluginBabelHelpers"],function(m){return function(){function p(D=0,B=0,u=0,t=0){this.x=D;this.y=B;this.width=u;this.height=t}p.prototype.union=function(D){this.x=Math.min(this.x,D.x);this.y=Math.min(this.y,D.y);this.width=Math.max(this.width,D.width);this.height=Math.max(this.height,D.height)};m._createClass(p,[{key:"isEmpty",
get:function(){return 0>=this.width||0>=this.height}}]);return p}()})},"esri/symbols/cim/TextRasterizer":function(){define(["../../core/screenUtils"],function(m){return function(){function p(B){B&&(this._textRasterizationCanvas=B)}var D=p.prototype;D.rasterizeText=function(B,u){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const t=this._textRasterizationCanvas;var h=t.getContext("2d");this._setFontProperties(h,u);this._parameters=u;this._textLines=
B.split(/\r?\n/);this._lineHeight=this._computeLineHeight();B=this._computeTextWidth(h,u);const {decoration:l,weight:e}=u.font;this._lineThroughWidthOffset=l&&"line-through"===l?.1*this._lineHeight:0;var b=this._lineHeight*this._textLines.length;t.width=B+2*this._lineThroughWidthOffset;t.height=b;this._renderedLineHeight=Math.round(this._lineHeight*u.pixelRatio);this._renderedHaloSize=u.halo.size*u.pixelRatio;this._renderedWidth=B*u.pixelRatio;this._renderedHeight=b*u.pixelRatio;this._lineThroughWidthOffset*=
u.pixelRatio;B=u.halo&&u.halo.color?u.halo.color:[0,0,0,0];b=u.color??[0,0,0,0];this._fillStyle=`rgba(${b.slice(0,3).toString()},${b[3]})`;this._haloStyle=`rgb(${B.slice(0,3).toString()})`;B=this._renderedLineHeight;b=this._renderedHaloSize;h.save();h.clearRect(0,0,t.width,t.height);this._setFontProperties(h,u);var d=h.textAlign,a=this._renderedWidth;d=("center"===d?.5*a:"right"===d?a:0)+b;a=0<b;let c=this._lineThroughWidthOffset,f=0;a&&this._renderHalo(h,d,b,c,f,u);f+=b;c+=d;for(var g of this._textLines)a&&
(h.globalCompositeOperation="destination-out",h.fillStyle="rgb(0, 0, 0)",h.fillText(g,c,f),h.globalCompositeOperation="source-over"),h.fillStyle=this._fillStyle,h.fillText(g,c,f),l&&"none"!==l&&this._renderDecoration(h,c,f,l,e),f+=B;h.restore();g=this._renderedWidth+2*this._lineThroughWidthOffset;B=this._renderedHeight;h=h.getImageData(0,0,g,B);h=new Uint8Array(h.data);if(u.premultiplyColors)for(d=0;d<h.length;d+=4)b=h[d+3]/255,h[d]*=b,h[d+1]*=b,h[d+2]*=b;switch(u.horizontalAlignment){case "left":b=
-.5;break;case "right":b=.5;break;default:b=0}switch(u.verticalAlignment){case "bottom":u=-.5;break;case "top":u=.5;break;default:u=0}return{size:[g,B],image:new Uint32Array(h.buffer),sdf:!1,simplePattern:!1,anchorX:b,anchorY:u,canvas:t}};D._renderHalo=function(B,u,t,h,l,e){const b=this._renderedWidth,d=this._renderedHeight;this._haloRasterizationCanvas||(this._haloRasterizationCanvas=document.createElement("canvas"));this._haloRasterizationCanvas.width=b;this._haloRasterizationCanvas.height=d;const a=
this._haloRasterizationCanvas,c=a.getContext("2d");c.clearRect(0,0,b,d);this._setFontProperties(c,e);const {decoration:f,weight:g}=e.font;c.fillStyle=this._haloStyle;c.strokeStyle=this._haloStyle;c.lineJoin="round";this._renderHaloNative(c,u,t,f,g);B.globalAlpha=this._parameters.halo.color[3];B.drawImage(a,0,0,b,d,h,l,b,d);B.globalAlpha=1};D._renderHaloNative=function(B,u,t,h,l){const e=this._renderedLineHeight,b=this._renderedHaloSize;for(const d of this._textLines){const a=2*b;for(let c=0;5>c;c++){const f=
(.6+.1*c)*a;B.lineWidth=f;B.strokeText(d,u,t);h&&"none"!==h&&this._renderDecoration(B,u,t,h,l,f)}t+=e}};D._setFontProperties=function(B,u){var t=u.font;t=`${t.style} ${t.weight} ${m.pt2px(Math.max(u.size,.5)*u.pixelRatio).toFixed(1)}px ${t.family}, sans-serif`;B.font=t;B.textBaseline="top";switch(u.horizontalAlignment){case "left":u="left";break;case "right":u="right";break;case "center":u="center";break;default:u="left"}B.textAlign=u};D.computeTextSize=function(B,u){this._textRasterizationCanvas||
(this._textRasterizationCanvas=document.createElement("canvas"));const t=this._textRasterizationCanvas;var h=t.getContext("2d");this._setFontProperties(h,u);this._parameters=u;this._textLines=B.split(/\r?\n/);this._lineHeight=this._computeLineHeight();B=this._computeTextWidth(h,u);h=this._lineHeight*this._textLines.length;t.width=B;t.height=h;return[B*u.pixelRatio,h*u.pixelRatio]};D._computeTextWidth=function(B,u){let t=0;for(const h of this._textLines)t=Math.max(t,B.measureText(h).width);u=u.font;
if("italic"===u.style||"oblique"===u.style||"string"===typeof u.weight&&("bold"===u.weight||"bolder"===u.weight)||"number"===typeof u.weight&&600<u.weight)t+=.3*B.measureText("w").width;t+=2*this._parameters.halo.size;return Math.round(t)};D._computeLineHeight=function(){let B=1.275*this._parameters.size;const u=this._parameters.font.decoration;u&&"underline"===u&&(B*=1.3);return Math.round(B+2*this._parameters.halo.size)};D._renderDecoration=function(B,u,t,h,l,e){const b=.9*this._lineHeight;switch(B.textAlign){case "center":u-=
this._renderedWidth/2;break;case "right":u-=this._renderedWidth}const d=B.textBaseline;if("underline"===h)switch(d){case "top":t+=b;break;case "middle":t+=b/2}else if("line-through"===h)switch(d){case "top":t+=b/1.5;break;case "middle":t+=b/3}h=e?1.5*e:Math.ceil(b*("bold"===l?.06:"bolder"===l?.09:.04));B.save();B.beginPath();B.strokeStyle=B.fillStyle;B.lineWidth=h;B.moveTo(u-this._lineThroughWidthOffset,t);B.lineTo(u+this._renderedWidth+2*this._lineThroughWidthOffset,t);B.stroke();B.restore()};return p}()})},
"esri/views/2d/engine/webgl/mesh/templates/shapingUtils":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2 ../../../../../../chunks/vec2f32 ../../alignmentUtils ../../number ../../Rect ../../collisions/BoundingBox".split(" "),function(m,p,D,B,u,t,h,l,e,b,d){function a(k,x){k.forEach(r=>t.transformMat2d(r,r,x));return{upperLeft:e.i1616to32(8*
k[0][0],8*k[0][1]),upperRight:e.i1616to32(8*k[1][0],8*k[1][1]),lowerLeft:e.i1616to32(8*k[2][0],8*k[2][1]),lowerRight:e.i1616to32(8*k[3][0],8*k[3][1])}}const c=Math.PI/180;let f=function(){function k(r,v,q,y){this._rotationT=u.create();this.minZoom=this._yBounds=this._xBounds=0;this.maxZoom=255;this._bounds=null;const A=q.rect,w=new Float32Array(8);r*=y;v*=y;const z=q.code?A.width*y:q.metrics.width,C=q.code?A.height*y:q.metrics.height;this.width=z;this.height=C;w[0]=r;w[1]=v;w[2]=r+z;w[3]=v;w[4]=r;
w[5]=v+C;w[6]=r+z;w[7]=v+C;this._data=w;this._setTextureCoords(A);this._scale=y;this._mosaic=q;this.x=r;this.y=v;this.maxOffset=Math.max(r+z,v+C)}var x=k.prototype;x.setTransform=function(r){this._transform=r;this._offsets=null};x._setOffsets=function(r){this._offsets||(this._offsets={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0});const v=this._offsets,q=new Float32Array(8),y=B.multiply(u.create(),this._rotationT,this._transform);u.transformMany(q,r,y);v.upperLeft=e.i1616to32(8*q[0],8*q[1]);
v.upperRight=e.i1616to32(8*q[2],8*q[3]);v.lowerLeft=e.i1616to32(8*q[4],8*q[5]);v.lowerRight=e.i1616to32(8*q[6],8*q[7])};x._setTextureCoords=function({x:r,y:v,width:q,height:y}){this._texcoords={upperLeft:e.i1616to32(r,v),upperRight:e.i1616to32(r+q,v),lowerLeft:e.i1616to32(r,v+y),lowerRight:e.i1616to32(r+q,v+y)}};p._createClass(k,[{key:"mosaic",get:function(){return this._mosaic}},{key:"angle",get:function(){return this._angle},set:function(r){this._angle=r;B.fromRotation(this._rotationT,-r);this._setOffsets(this._data)}},
{key:"xTopLeft",get:function(){return this._data[0]}},{key:"yTopLeft",get:function(){return this._data[1]}},{key:"xBottomRight",get:function(){return this._data[6]}},{key:"yBottomRight",get:function(){return this._data[7]}},{key:"texcoords",get:function(){return this._texcoords}},{key:"textureBinding",get:function(){return this._mosaic.textureBinding}},{key:"offsets",get:function(){this._offsets||this._setOffsets(this._data);return this._offsets}},{key:"char",get:function(){return String.fromCharCode(this._mosaic.code)}},
{key:"code",get:function(){return this._mosaic.code}},{key:"bounds",get:function(){if(!this._bounds){const {height:A,width:w}=this._mosaic.metrics;var r=w*this._scale,v=Math.abs(A)*this._scale,q=new Float32Array(8);q[0]=this.x;q[1]=this.y;q[2]=this.x+r;q[3]=this.y;q[4]=this.x;q[5]=this.y+v;q[6]=this.x+r;q[7]=this.y+v;r=B.multiply(u.create(),this._rotationT,this._transform);u.transformMany(q,q,r);v=r=Infinity;let z=0;var y=0;for(let C=0;4>C;C++){const E=q[2*C],F=q[2*C+1];r=Math.min(r,E);v=Math.min(v,
F);z=Math.max(z,E);y=Math.max(y,F)}q=z-r;y-=v;this._bounds=new d(r+q/2,v+y/2,q,y)}return this._bounds}}]);return k}(),g=function(){function k(r,v,q){this._rotation=0;this._decorate(r,v,q);this.glyphs=r;this.bounds=this._createBounds(r);this.isMultiline=1<v.length;this._hasRotation=0!==q.angle;this._transform=this._createGlyphTransform(this.bounds,q);if((this._borderLineSize=q.borderLineSize)||q.hasBackground)[this.bounds,this.background]=this.shapeBackground(this._transform);for(const y of r)y.setTransform(this._transform)}
var x=k.prototype;x.setRotation=function(r){if(0!==r||0!==this._rotation){this._rotation=r;var v=this._transform;r=B.fromRotation(u.create(),r);B.multiply(v,r,v);for(const q of this.glyphs)q.setTransform(this._transform)}};x._decorate=function(r,v,q){if(q.decoration&&"none"!==q.decoration&&r.length){var y=q.scale;q="underline"===q.decoration?30:20;var A=r[0].textureBinding;for(const E of v){const F=E.startX*y,G=E.startY*y;v=r;var w=v.push;var z=(E.width+E.glyphWidthEnd)*y;var C=A;z={code:0,page:0,
sdf:!0,rect:new b(0,0,11,8),textureBinding:C,metrics:{advance:0,height:4,width:z,left:0,top:0}};w.call(v,new f(F,G+q*y,z,1))}}};x.shapeBackground=function(r){const v=(1.5+D.pt2px(this._borderLineSize||0))/2;var q=this._borderLineSize?v:0;const {xmin:y,ymin:A,xmax:w,ymax:z,x:C,y:E,width:F,height:G}=this.bounds,H=[y-8,A-8],L=[w+8,A-8],K=[y-8,z+8],M=[w+8,z+8],U=a([[H[0]-v,H[1]-v],[L[0]+v,L[1]-v],[H[0]+q,H[1]+q],[L[0]-q,L[1]+q]],r),T=a([[K[0]+q,K[1]-q],[M[0]-q,M[1]-q],[K[0]-v,K[1]+v],[M[0]+v,M[1]+v]],
r),Z=a([[H[0]-v,H[1]-v],[H[0]+q,H[1]+q],[K[0]-v,K[1]+v],[K[0]+q,K[1]-q]],r);q=a([[L[0]-q,L[1]+q],[L[0]+v,L[1]-v],[M[0]-q,M[1]-q],[M[0]+v,M[1]+v]],r);r={main:a([H,L,K,M],r),top:U,bot:T,left:Z,right:q};return[new d(C,E,F+2*v,G+2*v),r]};x._createBounds=function(r){let v=Infinity,q=Infinity,y=0;var A=0;for(const w of r)v=Math.min(v,w.xTopLeft),q=Math.min(q,w.yTopLeft),y=Math.max(y,w.xBottomRight),A=Math.max(A,w.yBottomRight);r=y-v;A-=q;return new d(v+r/2,q+A/2,r,A)};x._createGlyphTransform=function(r,
v){const q=c*v.angle,y=u.create(),A=h.create();B.translate(y,y,t.set(A,v.xOffset,-v.yOffset));v.isCIM?B.rotate(y,y,q):(B.translate(y,y,t.set(A,r.x,r.y)),B.rotate(y,y,q),B.translate(y,y,t.set(A,-r.x,-r.y)));return y};p._createClass(k,[{key:"boundsT",get:function(){var r=this.bounds;const v=t.set(h.create(),r.x,r.y);t.transformMat2d(v,v,this._transform);return this._hasRotation?(r=Math.max(r.width,r.height),new d(v[0],v[1],r,r)):new d(v[0],v[1],r.width,r.height)}}]);return k}(),n=function(k,x,r,v,q,
y){this.startY=this.startX=this.glyphWidthEnd=0;this.start=Math.max(0,Math.min(x,r));this.end=Math.max(0,Math.max(x,r));this.end<k.length&&(this.glyphWidthEnd=k[this.end].metrics.width);this.width=v;this.yMin=q;this.yMax=y};m.ShapedGlyph=f;m.ShapingInfo=g;m.shapeGlyphs=function(k,x,r){const v=r.scale,q=[],y=[];var A=1/r.scale*r.maxLineWidth;var w=x?k.length-1:0,z=x?-1:k.length;x=x?-1:1;var C=w,E=0,F=0;let G=C,H=G,L=0,K=Infinity,M=0;for(;C!==z;){const {code:X,metrics:ca}=k[C];var U=Math.abs(ca.top);
10!==X&&32!==X&&(K=Math.min(K,U),M=Math.max(M,U+ca.height));10===X?(C!==w&&(y.push(new n(k,G,C-x,E,K,M)),K=Infinity,M=0),E=0,G=C+x,H=C+x,F=0):32===X?(H=C+x,F=0,L=ca.advance,E+=ca.advance):(E>A&&(H!==G?(U=H-2*x,E-=L,y.push(new n(k,G,U,E-F,K,M)),K=Infinity,M=0,G=H,E=F):(y.push(new n(k,G,C-x,E,K,M)),K=Infinity,M=0,H=G=C,E=0)),E+=ca.advance,F+=ca.advance);C+=x}A=new n(k,G,C-x,E,K,M);0<=A.start&&A.end<k.length&&y.push(A);for(A=0;A<y.length;A++);w=y[0].yMin;A=y[y.length-1].yMax+r.lineHeight*(y.length-1)+
("underline"===r.decoration?4:0)-w;const {vAlign:T,hAlign:Z}=r;z=T===l.VAlign.Baseline?1:0;A=(1-z)*-w+A/2*(z?0:T-1)+-26*(z?1:0);for(w=0;w<y.length;w++){const {start:X,end:ca,width:P}=y[w];z=P/2*(Z+1)*-1-3;x=w*r.lineHeight+A-3;y[w].startX=z;y[w].startY=x;for(C=X;C<=ca;C++)E=k[C],10!==E.code&&(F=new f(z+E.metrics.left,x-E.metrics.top,E,v),z+=E.metrics.advance,q.push(F))}return new g(q,y,r)};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/Rect":function(){define(["../../../../chunks/_rollupPluginBabelHelpers"],
function(m){return function(){function p(D=0,B=0,u=0,t=0){this.x=D;this.y=B;this.width=u;this.height=t}p.prototype.union=function(D){this.x=Math.min(this.x,D.x);this.y=Math.min(this.y,D.y);this.width=Math.max(this.width,D.width);this.height=Math.max(this.height,D.height)};m._createClass(p,[{key:"isEmpty",get:function(){return 0>=this.width||0>=this.height}}]);return p}()})},"esri/views/2d/engine/webgl/collisions/BoundingBox":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../../../../../chunks/vec2f32"],
function(m,p){return function(){function D(u,t,h,l){this.center=p.fromValues(u,t);this.centerT=p.create();this.halfWidth=h/2;this.halfHeight=l/2;this.width=h;this.height=l}var B=D.prototype;B.clone=function(){return new D(this.x,this.y,this.width,this.height)};B.serialize=function(u){u.writeF32(this.center[0]);u.writeF32(this.center[1]);u.push(this.width);u.push(this.height);return u};B.findCollisionDelta=function(u,t=4){return Math.log2(Math.min((u.halfWidth+this.halfWidth+t)/Math.abs(u.centerT[0]-
this.centerT[0]),(u.halfHeight+this.halfHeight+t)/Math.abs(u.centerT[1]-this.centerT[1])))};B.extend=function(u){const t=Math.min(this.xmin,u.xmin),h=Math.min(this.ymin,u.ymin),l=Math.max(this.xmax,u.xmax)-t;u=Math.max(this.ymax,u.ymax)-h;this.width=l;this.height=u;this.halfWidth=l/2;this.halfHeight=u/2;this.x=t+l/2;this.y=h+u/2};D.deserialize=function(u){const t=u.readF32(),h=u.readF32(),l=u.readInt32();u=u.readInt32();return new D(t,h,l,u)};m._createClass(D,[{key:"x",get:function(){return this.center[0]},
set:function(u){this.center[0]=u}},{key:"y",get:function(){return this.center[1]},set:function(u){this.center[1]=u}},{key:"blX",get:function(){return this.center[0]+this.halfWidth}},{key:"blY",get:function(){return this.center[1]+this.halfHeight}},{key:"trX",get:function(){return this.center[0]-this.halfWidth}},{key:"trY",get:function(){return this.center[1]-this.halfHeight}},{key:"xmin",get:function(){return this.x-this.halfWidth}},{key:"xmax",get:function(){return this.x+this.halfWidth}},{key:"ymin",
get:function(){return this.y-this.halfHeight}},{key:"ymax",get:function(){return this.y+this.halfHeight}}]);return D}()})},"esri/views/2d/arcade/callExpressionWithFeature":function(){define(["../../../core/Error","../../../core/Logger","../../../core/maybe","../../../geometry/support/quantizationUtils"],function(m,p,D,B){function u(h){const l={};switch(h){case "esriGeometryPoint":return(e,b,d,a)=>B.unquantizePoint(b,l,e,d,a);case "esriGeometryPolygon":return(e,b,d,a)=>B.unquantizePolygon(b,l,e,d,
a);case "esriGeometryPolyline":return(e,b,d,a)=>B.unquantizePolyline(b,l,e,d,a);case "esriGeometryMultipoint":return(e,b,d,a)=>B.unquantizeMultipoint(b,l,e,d,a);default:return p.getLogger("esri.views.2d.support.arcadeOnDemand").error(new m("mapview-arcade",`Unable to handle geometryType: ${h}`)),e=>e}}const t=new Map;return function(h,l,e,b,d){if(D.isNone(h))return null;if(h.referencesGeometry()&&d){const {transform:a,hasZ:c,hasM:f}=d;t.has(b)||t.set(b,u(b));b=t.get(b)(l.geometry,a,c,f);l={...l,geometry:b}}l=
h.repurposeFeature(l);try{return h.evaluate({...e,$feature:l})}catch(a){return p.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",a),null}}})},"esri/geometry/support/quantizationUtils":function(){define(["exports","../../core/maybe","./jsonUtils"],function(m,p,D){function B({scale:E,translate:F},G){return Math.round((G-F[0])/E[0])}function u({scale:E,translate:F},G){return Math.round((F[1]-G)/E[1])}function t(E,F,G){const H=[];let L,K,M,U;for(let T=0;T<G.length;T++){const Z=
G[T];if(0<T){if(M=B(E,Z[0]),U=u(E,Z[1]),M!==L||U!==K)H.push(F(Z,M-L,U-K)),L=M,K=U}else L=B(E,Z[0]),K=u(E,Z[1]),H.push(F(Z,L,K))}return 0<H.length?H:null}function h(E,F,G,H){return t(E,G?H?C:z:H?z:w,F)}function l(E,F,G,H){const L=[];G=G?H?C:z:H?z:w;for(H=0;H<F.length;H++){const K=t(E,G,F[H]);K&&3<=K.length&&L.push(K)}return L.length?L:null}function e(E,F,G,H){const L=[];G=G?H?C:z:H?z:w;for(H=0;H<F.length;H++){const K=t(E,G,F[H]);K&&2<=K.length&&L.push(K)}return L.length?L:null}function b({scale:E,
translate:F},G){return G*E[0]+F[0]}function d({scale:E,translate:F},G){return F[1]-G*E[1]}function a(E,F,G){const H=Array(G.length);if(!G.length)return H;const [L,K]=E.scale;let M=b(E,G[0][0]);E=d(E,G[0][1]);H[0]=F(G[0],M,E);for(let U=1;U<G.length;U++){const T=G[U];M+=T[0]*L;E-=T[1]*K;H[U]=F(T,M,E)}return H}function c(E,F,G){const H=Array(G.length);for(let L=0;L<G.length;L++)H[L]=a(E,F,G[L]);return H}function f(E,F,G,H){return a(E,G?H?C:z:H?z:w,F)}function g(E,F,G,H){return c(E,G?H?C:z:H?z:w,F)}function n(E,
F,G,H){return c(E,G?H?C:z:H?z:w,F)}function k(E,F,G){let [H,L]=G[0],K=Math.min(H,F[0]),M=Math.min(L,F[1]),U=Math.max(H,F[2]);F=Math.max(L,F[3]);for(let T=1;T<G.length;T++){const [Z,X]=G[T];H+=Z;L+=X;0>Z&&(K=Math.min(K,H));0<Z&&(U=Math.max(U,H));0>X?M=Math.min(M,L):0<X&&(F=Math.max(F,L))}E[0]=K;E[1]=M;E[2]=U;E[3]=F;return E}function x(E,F){if(!F.length)return null;E[0]=E[1]=Number.POSITIVE_INFINITY;E[2]=E[3]=Number.NEGATIVE_INFINITY;for(let G=0;G<F.length;G++)k(E,E,F[G]);return E}function r(E,F,G,
H,L){F.xmin=B(E,G.xmin);F.ymin=u(E,G.ymin);F.xmax=B(E,G.xmax);F.ymax=u(E,G.ymax);F!==G&&(H&&(F.zmin=G.zmin,F.zmax=G.zmax),L&&(F.mmin=G.mmin,F.mmax=G.mmax));return F}function v(E,F,G,H,L){F.points=h(E,G.points,H,L)??[];return F}function q(E,F,G,H,L){F.x=B(E,G.x);F.y=u(E,G.y);F!==G&&(H&&(F.z=G.z),L&&(F.m=G.m));return F}function y(E,F,G,H,L){E=l(E,G.rings,H,L);if(!E)return null;F.rings=E;return F}function A(E,F,G,H,L){E=e(E,G.paths,H,L);if(!E)return null;F.paths=E;return F}const w=(E,F,G)=>[F,G],z=(E,
F,G)=>[F,G,E[2]],C=(E,F,G)=>[F,G,E[2],E[3]];m.equals=function(E,F){if(E===F||null==E&&null==F)return!0;if(null==E||null==F)return!1;let G,H,L,K;E&&"upperLeft"===E.originPosition?(G=E.translate[0],H=E.translate[1],E=E.scale[0]):(G=p.isSome(E.extent)?E.extent.xmin:0,H=p.isSome(E.extent)?E.extent.ymax:0,E=E.tolerance);F&&"upperLeft"===F.originPosition?(L=F.translate[0],K=F.translate[1],F=F.scale[0]):(L=p.isSome(F.extent)?F.extent.xmin:0,K=p.isSome(F.extent)?F.extent.ymax:0,F=F.tolerance);return G===
L&&H===K&&E===F};m.getQuantizedBoundsCoordsArray=k;m.getQuantizedBoundsCoordsArrayArray=x;m.getQuantizedBoundsPaths=function(E){return x([0,0,0,0],E)};m.getQuantizedBoundsPoints=function(E){const F=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return k(F,F,E)};m.getQuantizedBoundsRings=function(E){return x([0,0,0,0],E)};m.quantizeBounds=function(E,F,G){F[0]=B(E,G[0]);F[3]=u(E,G[1]);F[2]=B(E,G[2]);F[1]=u(E,G[3]);return F};m.quantizeExtent=r;m.quantizeGeometry=
function(E,F){return E&&F?D.isPoint(F)?q(E,{},F,!1,!1):D.isPolyline(F)?A(E,{},F,!1,!1):D.isPolygon(F)?y(E,{},F,!1,!1):D.isMultipoint(F)?v(E,{},F,!1,!1):D.isExtent(F)?r(E,{},F,!1,!1):null:null};m.quantizeMultipoint=v;m.quantizePaths=e;m.quantizePoint=q;m.quantizePoints=h;m.quantizePolygon=y;m.quantizePolyline=A;m.quantizeRings=l;m.quantizeX=B;m.quantizeY=u;m.toQuantizationTransform=function(E){return E?{originPosition:"upper-left"===E.originPosition?"upperLeft":"lower-left"===E.originPosition?"lowerLeft":
E.originPosition,scale:E.tolerance?[E.tolerance,E.tolerance]:[1,1],translate:p.isSome(E.extent)?[E.extent.xmin,E.extent.ymax]:[0,0]}:null};m.unquantizeBounds=function(E,F,G){return G?(F[0]=b(E,G[0]),F[1]=d(E,G[3]),F[2]=b(E,G[2]),F[3]=d(E,G[1]),F):[b(E,F[0]),d(E,F[3]),b(E,F[2]),d(E,F[1])]};m.unquantizeCoordsArray=a;m.unquantizeCoordsArrayArray=c;m.unquantizeExtent=function(E,F,G,H,L){F.xmin=b(E,G.xmin);F.ymin=d(E,G.ymin);F.xmax=b(E,G.xmax);F.ymax=d(E,G.ymax);F!==G&&(H&&(F.zmin=G.zmin,F.zmax=G.zmax),
L&&(F.mmin=G.mmin,F.mmax=G.mmax));return F};m.unquantizeMultipoint=function(E,F,G,H,L){p.isSome(G)&&(F.points=f(E,G.points,H,L));return F};m.unquantizePaths=g;m.unquantizePoint=function(E,F,G,H,L){if(p.isNone(G))return F;F.x=b(E,G.x);F.y=d(E,G.y);F!==G&&(H&&(F.z=G.z),L&&(F.m=G.m));return F};m.unquantizePoints=f;m.unquantizePolygon=function(E,F,G,H,L){p.isSome(G)&&(F.rings=n(E,G.rings,H,L));return F};m.unquantizePolyline=function(E,F,G,H,L){p.isSome(G)&&(F.paths=g(E,G.paths,H,L));return F};m.unquantizeRings=
n;m.unquantizeX=b;m.unquantizeY=d;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/GeometryUtils":function(){define(["exports"],function(m){function p(l,e){l%=e;return 0<=l?l:l+e}const D=Number.POSITIVE_INFINITY,B=Math.PI,u=128/B,t=256/360,h=1/Math.LN2;m.C_2PI=2*B;m.C_DEG_TO_256=t;m.C_DEG_TO_RAD=B/180;m.C_INFINITY=D;m.C_PI=B;m.C_RAD_TO_256=u;m.between=function(l,e,b){return l>=e&&l<=b||l>=b&&l<=e};m.degToByte=function(l){return p(l*t,256)};m.interpolate=
function(l,e,b){return l*(1-b)+e*b};m.log2=function(l){return Math.log(l)*h};m.positiveMod=p;m.radToByte=function(l){return p(l*u,256)};m.sqr=function(l){return l*l};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/rasterizingUtils":function(){define(["exports","../../core/floatRGBA","../../core/mathUtils"],function(m,p,D){m.rasterizeDash=function(B,u){var t="Butt"===u,h="Square"===u;u=!t&&!h;1===B.length%2&&(B=[...B,...B]);var l=0;for(var e of B)l+=e;e=Math.round(15.5*
l);l=new Float32Array(31*e);let b=0,d=0,a=.5,c=!0;for(var f of B){b=d;for(d+=15.5*f;a<=d;){for(B=.5;31>B;){const g=u?(B-15.5)*(B-15.5):Math.abs(B-15.5);l[(B-.5)*e+a-.5]=c?t?Math.max(Math.max(b+7.75-a,g),Math.max(a-d+7.75,g)):g:u?Math.min((a-b)*(a-b)+g,(a-d)*(a-d)+g):h?Math.min(Math.max(a-b,g),Math.max(d-a,g)):Math.min(Math.max(a-b+7.75,g),Math.max(d+7.75-a,g));B++}a++}c=!c}t=l.length;f=new Uint8Array(4*t);for(h=0;h<t;++h)p.packFloatRGBA((u?Math.sqrt(l[h]):l[h])/15.5,f,4*h);return[f,e,31]};m.rasterizeSimpleFill=
function(B,u,t){t=D.nextPowerOfTwo(Math.ceil(t));var h="vertical"===u||"horizontal"===u||"cross"===u||"esriSFSCross"===u||"esriSFSVertical"===u||"esriSFSHorizontal"===u?8*t:16*t;const l=2*t;B.width=h;B.height=h;const e=B.getContext("2d");e.strokeStyle="#FFFFFF";e.lineWidth=t;e.beginPath();if("vertical"===u||"cross"===u||"esriSFSCross"===u||"esriSFSVertical"===u)e.moveTo(h/2,-l),e.lineTo(h/2,h+l);if("horizontal"===u||"cross"===u||"esriSFSCross"===u||"esriSFSHorizontal"===u)e.moveTo(-l,h/2),e.lineTo(h+
l,h/2);if("forward-diagonal"===u||"diagonal-cross"===u||"esriSFSDiagonalCross"===u||"esriSFSForwardDiagonal"===u)e.moveTo(-l,-l),e.lineTo(h+l,h+l),e.moveTo(h-l,-l),e.lineTo(h+l,l),e.moveTo(-l,h-l),e.lineTo(l,h+l);if("backward-diagonal"===u||"diagonal-cross"===u||"esriSFSBackwardDiagonal"===u||"esriSFSDiagonalCross"===u)e.moveTo(h+l,-l),e.lineTo(-l,h+l),e.moveTo(l,-l),e.lineTo(-l,l),e.moveTo(h+l,h-l),e.lineTo(h-l,h+l);e.stroke();u=e.getImageData(0,0,B.width,B.height);u=new Uint8Array(u.data);for(h=
0;h<u.length;h+=4)t=u[h+3]/255,u[h]*=t,u[h+1]*=t,u[h+2]*=t;return[u,B.width,B.height]};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/core/floatRGBA":function(){define(["exports","./mathUtils"],function(m,p){function D(h,l=0){let e=0;for(let b=0;4>b;b++)e+=h[l+b]*u[b];return e}const B=[1,256,65536,16777216],u=[1/256,1/65536,1/16777216,1/4294967296],t=D(new Uint8ClampedArray([255,255,255,255]));m.packFloatRGBA=function(h,l,e=0){h=p.clamp(h,0,t);for(let a=0;4>a;a++){var b=Math,
d=h*B[a];l[e+a]=b.floor.call(b,256*(d-Math.floor(d)))}};m.unpackFloatRGBA=D;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/SDFHelper":function(){define(["exports","../../core/floatRGBA","../../geometry/support/jsonUtils","./Rect"],function(m,p,D,B){function u(h){if(!h)return null;switch(h.type){case "CIMPointSymbol":h=h.symbolLayers;if(!h||1!==h.length)break;return u(h[0]);case "CIMVectorMarker":h=h.markerGraphics;if(!h||1!==h.length)break;var l=h[0];if(!l)break;
h=l.geometry;if(!h)break;l=l.symbol;if(!l||"CIMPolygonSymbol"!==l.type&&"CIMLineSymbol"!==l.type||l.symbolLayers?.some(e=>!!e.effects))break;return{geom:h,asFill:"CIMPolygonSymbol"===l.type};case "sdf":return{geom:h.geom,asFill:h.asFill}}return null}function t(h){let l=Infinity,e=-Infinity,b=Infinity,d=-Infinity;for(const a of h)for(const c of a)c[0]<l&&(l=c[0]),c[0]>e&&(e=c[0]),c[1]<b&&(b=c[1]),c[1]>d&&(d=c[1]);return[l,b,e,d]}m.buildSDF=function(h){var l=h.geom;var e=l?l.rings?l.rings:l.paths?l.paths:
void 0!==l.xmin&&void 0!==l.ymin&&void 0!==l.xmax&&void 0!==l.ymax?[[[l.xmin,l.ymin],[l.xmin,l.ymax],[l.xmax,l.ymax],[l.xmax,l.ymin],[l.xmin,l.ymin]]]:null:null;l=Infinity;var b=-Infinity;var d=Infinity,a=-Infinity;for(var c of e)for(var f of c)f[0]<l&&(l=f[0]),f[0]>b&&(b=f[0]),f[1]<d&&(d=f[1]),f[1]>a&&(a=f[1]);b=new B(l,d,b-l,a-d);d=64/Math.max(b.width,b.height);c=Math.round(b.width*d)+62;f=Math.round(b.height*d)+62;l=[];for(var g of e)if(g&&1<g.length){e=[];for(var n of g){let [C,E]=n;C-=b.x;E-=
b.y;C*=d;E*=d;C+=30.5;E+=30.5;h.asFill?e.push([C,E]):e.push([Math.round(C),Math.round(E)])}h.asFill&&(a=e.length-1,e[0][0]===e[a][0]&&e[0][1]===e[a][1]||e.push(e[0]));l.push(e)}n=c*f;g=Array(n);for(e=0;e<n;++e)g[e]=962;for(var k of l)for(e=k.length,b=1;b<e;++b){d=k[b-1];a=k[b];var x=void 0,r=void 0;d[0]<a[0]?(x=d[0],r=a[0]):(x=a[0],r=d[0]);var v=void 0,q=void 0;d[1]<a[1]?(v=d[1],q=a[1]):(v=a[1],q=d[1]);var y=Math.floor(x)-31;r=Math.floor(r)+31;v=Math.floor(v)-31;q=Math.floor(q)+31;0>y&&(y=0);r>c&&
(r=c);0>v&&(v=0);q>f&&(q=f);x=a[0]-d[0];const C=a[1]-d[1],E=x*x+C*C;for(;y<r;y++)for(let F=v;F<q;F++){var A=(y-d[0])*x+(F-d[1])*C,w=void 0;0>A?(w=d[0],A=d[1]):A>E?(w=a[0],A=a[1]):(A/=E,w=d[0]+A*x,A=d[1]+A*C);w=(y-w)*(y-w)+(F-A)*(F-A);A=(f-F-1)*c+y;w<g[A]&&(g[A]=w)}}for(k=0;k<n;++k)g[k]=Math.sqrt(g[k]);if(h.asFill)for(var z of l)for(h=z.length,k=1;k<h;++k)for(l=z[k-1],n=z[k],l[0]<n[0]?(e=l[0],b=n[0]):(e=n[0],b=l[0]),l[1]<n[1]?(a=l[1],d=n[1]):(a=n[1],d=l[1]),e=Math.floor(e),b=Math.floor(b)+1,a=Math.floor(a),
d=Math.floor(d)+1,31>e&&(e=31),b>c-31&&(b=c-31),31>a&&(a=31),d>f-31&&(d=f-31);a<d;++a)if(l[1]>a!==n[1]>a){r=(f-a-1)*c;for(v=e;v<b;++v)v<(n[0]-l[0])*(a-l[1])/(n[1]-l[1])+l[0]&&(g[r+v]=-g[r+v]);for(v=31;v<e;++v)g[r+v]=-g[r+v]}z=g.length;h=new Uint8Array(4*z);for(k=0;k<z;++k)p.packFloatRGBA(.5-g[k]/62,h,4*k);return[h,c,f]};m.getExtent=function(h){return h?h.rings?t(h.rings):h.paths?t(h.paths):D.isExtent(h)?[h.xmin,h.ymin,h.xmax,h.ymax]:null:null};m.getSDFInfo=u;m.getSDFMetrics=function(h,l,e,b,d){const [a,
c,f,g]=h;if(f<a||g<c)return[0,0,0];var n=f-a,k=g-c;h=64/Math.max(n,k);const x=Math.round(n*h),r=Math.round(k*h)+62;k=1;l&&(k=r/h/(l.ymax-l.ymin));let v=0,q=0;n=1;b&&(d?l&&e&&0<l.ymax-l.ymin&&(n=(l.xmax-l.xmin)/(l.ymax-l.ymin),v=b.x/(e*n),q=b.y/e):(v=b.x,q=b.y));l&&(v=.5*(l.xmax+l.xmin)+v*(l.xmax-l.xmin),q=.5*(l.ymax+l.ymin)+q*(l.ymax-l.ymin));v=(v-a)*h+31;q=(q-c)*h+31;l=v/(x+62)-.5;b=q/r-.5;d&&e&&(l*=e*n,b*=e);return[k,l,b]};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/GlyphMosaic":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/promiseUtils ./Rect ./RectangleBinPack ../../../webgl/enums ../../../webgl/Texture".split(" "),
function(m,p,D,B,u,t,h){function l(b){const d=new Set;for(const a of b)d.add(Math.floor(a/256));return d}function e(b,d,a){b.has(d)||b.set(d,a().then(()=>{b.delete(d)}).catch(c=>{b.delete(d);D.throwIfNotAbortError(c)}));return b.get(d)}return function(){function b(a,c,f){this.height=this.width=0;this._dirties=[];this._glyphData=[];this._currentPage=0;this._glyphCache={};this._textures=[];this._rangePromises=new Map;this.width=a;this.height=c;this._glyphSource=f;this._binPack=new u(a-4,c-4);this._glyphData.push(new Uint8Array(a*
c));this._dirties.push(!0);this._textures.push(null);this._initDecorationGlyph()}var d=b.prototype;d.dispose=function(){this._binPack=null;for(const a of this._textures)a&&a.dispose();this._textures.length=0;this._glyphData.length=0};d._initDecorationGlyph=function(){var a=[117,149,181,207,207,181,149,117];const c=[];for(let f=0;f<a.length;f++){const g=a[f];for(let n=0;11>n;n++)c.push(g)}a={metrics:{width:5,height:2,left:0,top:0,advance:0},bitmap:new Uint8Array(c)};this._recordGlyph(a)};d.getGlyphItems=
function(){var a=m._asyncToGenerator(function*(c,f,g){const n=this._getGlyphCache(c);yield this._fetchRanges(c,f,g);return f.map(k=>this._getMosaicItem(n,c,k))});return function(c,f,g){return a.apply(this,arguments)}}();d.bind=function(a,c,f,g){const n=this._getTexture(a,f);n.setSamplingMode(c);this._dirties[f]&&(n.setData(this._glyphData[f]),this._dirties[f]=!1);a.bindTexture(n,g)};d._getGlyphCache=function(a){this._glyphCache[a]||(this._glyphCache[a]={});return this._glyphCache[a]};d._getTexture=
function(a,c){this._textures[c]||(this._textures[c]=new h.Texture(a,{pixelFormat:t.PixelFormat.ALPHA,dataType:t.PixelType.UNSIGNED_BYTE,width:this.width,height:this.height},new Uint8Array(this.width*this.height)));return this._textures[c]};d._invalidate=function(){this._dirties[this._currentPage]=!0};d._fetchRanges=function(){var a=m._asyncToGenerator(function*(c,f,g){const n=[];l(f).forEach(k=>{n.push(this._fetchRange(c,k,g))});yield Promise.all(n)});return function(c,f,g){return a.apply(this,arguments)}}();
d._fetchRange=function(){var a=m._asyncToGenerator(function*(c,f,g){if(!(256<f))return e(this._rangePromises,c+f,()=>this._glyphSource.getRange(c,f,g))});return function(c,f,g){return a.apply(this,arguments)}}();d._getMosaicItem=function(a,c,f){if(!a[f]){c=this._glyphSource.getGlyph(c,f);if(!c||!c.metrics)return{rect:new B(0,0,0,0),page:0,metrics:{left:0,width:0,height:0,advance:0,top:0},code:f,sdf:!0};const g=this._recordGlyph(c);a[f]={rect:g,page:this._currentPage,metrics:c.metrics,code:f,sdf:!0};
this._invalidate()}return a[f]};d._recordGlyph=function(a){var c=a.metrics;if(0===c.width)c=new B(0,0,0,0);else{const f=c.width+6,g=c.height+6;c=this._binPack.allocate(f,g);c.isEmpty&&(this._dirties[this._currentPage]||(this._glyphData[this._currentPage]=null),this._currentPage=this._glyphData.length,this._glyphData.push(new Uint8Array(this.width*this.height)),this._dirties.push(!0),this._textures.push(null),this._initDecorationGlyph(),this._binPack=new u(this.width-4,this.height-4),c=this._binPack.allocate(f,
g));const n=this._glyphData[this._currentPage];a=a.bitmap;let k,x;if(a)for(let r=0;r<g;r++){k=f*r;x=this.width*(c.y+r)+c.x;for(let v=0;v<f;v++)n[x+v]=a[k+v]}p("esri-glyph-debug")&&this._showDebugPage(n)}return c};d._showDebugPage=function(a){const c=document.createElement("canvas"),f=c.getContext("2d"),g=new ImageData(this.width,this.height),n=g.data;c.width=this.width;c.height=this.height;c.style.border="1px solid black";for(let k=0;k<a.length;++k)n[4*k]=a[k],n[4*k+1]=0,n[4*k+2]=0,n[4*k+3]=255;f.putImageData(g,
0,0);document.body.appendChild(c)};return b}()})},"esri/views/2d/engine/webgl/RectangleBinPack":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","./Rect"],function(m,p){return function(){function D(u,t){this._height=this._width=0;this._free=[];this._width=u;this._height=t;this._free.push(new p(0,0,u,t))}var B=D.prototype;B.allocate=function(u,t){if(u>this._width||t>this._height)return new p;let h=null,l=-1;for(let e=0;e<this._free.length;++e){const b=this._free[e];u<=b.width&&t<=
b.height&&(null===h||b.y<=h.y&&b.x<=h.x)&&(h=b,l=e)}if(null===h)return new p;this._free.splice(l,1);h.width<h.height?(h.width>u&&this._free.push(new p(h.x+u,h.y,h.width-u,t)),h.height>t&&this._free.push(new p(h.x,h.y+t,h.width,h.height-t))):(h.width>u&&this._free.push(new p(h.x+u,h.y,h.width-u,h.height)),h.height>t&&this._free.push(new p(h.x,h.y+t,u,h.height-t)));return new p(h.x,h.y,u,t)};B.release=function(u){for(let t=0;t<this._free.length;++t){const h=this._free[t];if(h.y===u.y&&h.height===u.height&&
h.x+h.width===u.x)h.width+=u.width;else if(h.x===u.x&&h.width===u.width&&h.y+h.height===u.y)h.height+=u.height;else if(u.y===h.y&&u.height===h.height&&u.x+u.width===h.x)h.x=u.x,h.width+=u.width;else if(u.x===h.x&&u.width===h.width&&u.y+u.height===h.y)h.y=u.y,h.height+=u.height;else continue;this._free.splice(t,1);this.release(u)}this._free.push(u)};m._createClass(D,[{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}}]);return D}()})},"esri/views/2d/engine/webgl/GlyphSource":function(){define(["../../../../request",
"../../../../core/pbf"],function(m,p){let D=function(){function u(h){this._metrics=[];for(this._bitmaps=[];h.next();)switch(h.tag()){case 1:const l=h.getMessage();for(;l.next();)switch(l.tag()){case 3:const e=l.getMessage();let b,d,a,c,f,g,n;for(;e.next();)switch(e.tag()){case 1:b=e.getUInt32();break;case 2:d=e.getBytes();break;case 3:a=e.getUInt32();break;case 4:c=e.getUInt32();break;case 5:f=e.getSInt32();break;case 6:g=e.getSInt32();break;case 7:n=e.getUInt32();break;default:e.skip()}e.release();
b&&(this._metrics[b]={width:a,height:c,left:f,top:g,advance:n},this._bitmaps[b]=d);break;default:l.skip()}l.release();break;default:h.skip()}}var t=u.prototype;t.getMetrics=function(h){return this._metrics[h]};t.getBitmap=function(h){return this._bitmaps[h]};return u}(),B=function(){function u(){this._ranges=[]}var t=u.prototype;t.getRange=function(h){return this._ranges[h]};t.addRange=function(h,l){this._ranges[h]=l};return u}();return function(){function u(h){this._glyphInfo={};this._baseURL=h}
var t=u.prototype;t.getRange=function(h,l,e){const b=this._getFontStack(h);if(b.getRange(l))return Promise.resolve();const d=256*l,a=d+255;h=this._baseURL.replace("{fontstack}",h).replace("{range}",d+"-"+a);return m(h,{responseType:"array-buffer",...e}).then(c=>{b.addRange(l,new D(new p(new Uint8Array(c.data),new DataView(c.data))))})};t.getGlyph=function(h,l){if(h=this._getFontStack(h)){var e=Math.floor(l/256);if(!(256<e)&&(h=h.getRange(e)))return{metrics:h.getMetrics(l),bitmap:h.getBitmap(l)}}};
t._getFontStack=function(h){let l=this._glyphInfo[h];l||(l=this._glyphInfo[h]=new B);return l};return u}()})},"esri/views/2d/engine/webgl/SDFConverter":function(){define(["../../../../core/floatRGBA","../../../../core/promiseUtils"],function(m,p){return function(){function D(u){this._svg=null;this.size=u;const t=document.createElement("canvas");t.width=t.height=u;this._context=t.getContext("2d");this._gridOuter=new Float64Array(u*u);this._gridInner=new Float64Array(u*u);this._f=new Float64Array(u);
this._d=new Float64Array(u);this._z=new Float64Array(u+1);this._v=new Int16Array(u)}var B=D.prototype;B.dispose=function(){this._context=this._gridOuter=this._gridInner=this._f=this._d=this._z=this._v=null;this._svg&&(document.body.removeChild(this._svg),this._svg=null)};B.draw=function(u,t,h=31){this._initSVG();const l=this.createSVGString(u);return new Promise((e,b)=>{const d=new Image;d.src="data:image/svg+xml; charset\x3dutf8, "+encodeURIComponent(l);d.onload=()=>{d.onload=null;this._context.clearRect(0,
0,this.size,this.size);this._context.drawImage(d,0,0,this.size,this.size);var c=this._context.getImageData(0,0,this.size,this.size);const f=new Uint8Array(this.size*this.size*4);for(let g=0;g<this.size*this.size;g++){const n=c.data[4*g+3]/255;this._gridOuter[g]=1===n?0:0===n?1E20:Math.max(0,.5-n)**2;this._gridInner[g]=1===n?1E20:0===n?0:Math.max(0,n-.5)**2}this._edt(this._gridOuter,this.size,this.size);this._edt(this._gridInner,this.size,this.size);for(c=0;c<this.size*this.size;c++)m.packFloatRGBA(.5-
(this._gridOuter[c]-this._gridInner[c])/(2*h),f,4*c);e(f)};const a=t&&t.signal;if(a)p.onAbort(a,()=>b(p.createAbortError()))})};B._initSVG=function(){if(!this._svg){const u=document.createElementNS("http://www.w3.org/2000/svg","svg");u.setAttribute("style","position: absolute;");u.setAttribute("width","0");u.setAttribute("height","0");u.setAttribute("aria-hidden","true");u.setAttribute("role","presentation");document.body.appendChild(u);this._svg=u}return this._svg};B.createSVGString=function(u){const t=
this._initSVG(),h=document.createElementNS("http://www.w3.org/2000/svg","path");h.setAttribute("d",u);t.appendChild(h);u=h.getBBox();var l=u.width/u.height;const e=this.size/2;let b,d,a;1<l?(d=b=e/u.width,a=this.size/4,l=e-1/l*e/2):(b=d=e/u.height,a=e-e*l/2,l=this.size/4);h.setAttribute("style",`transform: matrix(${b}, 0, 0, ${d}, ${-u.x*b+a}, ${-u.y*d+l})`);u=`<svg style="fill:red;" height="${this.size}" width="${this.size}" xmlns="http://www.w3.org/2000/svg">${t.innerHTML}</svg>`;t.removeChild(h);
return u};B._edt=function(u,t,h){const l=this._f,e=this._d,b=this._v,d=this._z;for(var a=0;a<t;a++){for(var c=0;c<h;c++)l[c]=u[c*t+a];this._edt1d(l,e,b,d,h);for(c=0;c<h;c++)u[c*t+a]=e[c]}for(a=0;a<h;a++){for(c=0;c<t;c++)l[c]=u[a*t+c];this._edt1d(l,e,b,d,t);for(c=0;c<t;c++)u[a*t+c]=Math.sqrt(e[c])}};B._edt1d=function(u,t,h,l,e){h[0]=0;l[0]=-1E20;l[1]=1E20;for(let b=1,d=0;b<e;b++){let a=(u[b]+b*b-(u[h[d]]+h[d]*h[d]))/(2*b-2*h[d]);for(;a<=l[d];)d--,a=(u[b]+b*b-(u[h[d]]+h[d]*h[d]))/(2*b-2*h[d]);d++;h[d]=
b;l[d]=a;l[d+1]=1E20}for(let b=0,d=0;b<e;b++){for(;l[d+1]<b;)d++;t[b]=(b-h[d])*(b-h[d])+u[h[d]]}};return D}()})},"esri/views/2d/engine/webgl/SpriteMosaic":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Error ./definitions ./GeometryUtils ./Rect ./RectangleBinPack ../../../webgl/enums ../../../webgl/Texture".split(" "),function(m,p,D,B,u,t,h,l){function e(b){return b&&"static"===b.type}return function(){function b(a,c,f=0){this._mosaicPages=[];this._pageHeight=this._pageWidth=
this._currentPage=this._maxItemSize=0;this._mosaicRects=new Map;this._spriteCopyQueue=[];this.pixelRatio=1;(0>=a||0>=c)&&console.error("Sprites mosaic defaultWidth and defaultHeight must be greater than zero!");this._pageWidth=a;this._pageHeight=c;0<f&&(this._maxItemSize=f);this.pixelRatio=window.devicePixelRatio||1;this._binPack=new t(this._pageWidth,this._pageHeight);this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(Math.floor(this._pageWidth)*Math.floor(this._pageHeight))},
size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0})}var d=b.prototype;d.getWidth=function(a){return a>=this._mosaicPages.length?-1:this._mosaicPages[a].size[0]};d.getHeight=function(a){return a>=this._mosaicPages.length?-1:this._mosaicPages[a].size[1]};d.getPageTexture=function(a){return a<this._mosaicPages.length?this._mosaicPages[a].texture:null};d.has=function(a){return this._mosaicRects.has(a)};d.getSpriteItem=function(a){return this._mosaicRects.get(a)};d.addSpriteItem=function(a,
c,f,g,n,k,x=1){if(this._mosaicRects.has(a))return this._mosaicRects.get(a);let r,v,q;e(f)?[r,v,q]=this._allocateImage(c[0],c[1]):(r=new u(0,0,c[0],c[1]),v=this._mosaicPages.length,this._mosaicPages.push({mosaicsData:f,size:[c[0]+2*D.SPRITE_PADDING,c[1]+2*D.SPRITE_PADDING],dirty:!0,texture:void 0}));if(0>=r.width||0>=r.height)return null;k={rect:r,width:c[0],height:c[1],sdf:n,simplePattern:k,pixelRatio:x,page:v};this._mosaicRects.set(a,k);e(f)&&this._copy({rect:r,spriteSize:c,spriteData:f.data,page:v,
pageSize:q,repeat:g,sdf:n});return k};d.hasItemsToProcess=function(){return 0!==this._spriteCopyQueue.length};d.processNextItem=function(){const a=this._spriteCopyQueue.pop();a&&this._copy(a)};d.getSpriteItems=function(a){const c={};for(const f of a)c[f]=this.getSpriteItem(f);return c};d.getMosaicItemPosition=function(a){const c=(a=this.getSpriteItem(a))&&a.rect;if(!c)return null;c.width=a.width;c.height=a.height;const f=D.SPRITE_PADDING,g=this._mosaicPages[a.page];return{size:[a.width,a.height],
tl:[(c.x+f)/g[0],(c.y+f)/g[1]],br:[(c.x+f+a.width)/g[0],(c.y+f+a.height)/g[1]],page:a.page}};d.bind=function(a,c,f=0,g=0){f=this._mosaicPages[f];const n=f.mosaicsData;var k=f.texture;k||(k=f.size,k=new l.Texture(a,{pixelFormat:h.PixelFormat.RGBA,dataType:h.PixelType.UNSIGNED_BYTE,width:k[0],height:k[1]},null),f.texture=k);k.setSamplingMode(c);e(n)?(a.bindTexture(k,g),f.dirty&&(k.setData(new Uint8Array(n.data.buffer)),k.generateMipmap())):(n.data.bindFrame(a,k,g),k.generateMipmap());f.dirty=!1};b._copyBits=
function(a,c,f,g,n,k,x,r,v,q,y){let A=g*c+f;x=r*k+x;if(y)for(x-=k,y=-1;y<=q;y++,A=((y+q)%q+g)*c+f,x+=k)for(r=-1;r<=v;r++)n[x+r]=a[A+(r+v)%v];else for(f=0;f<q;f++){for(g=0;g<v;g++)n[x+g]=a[A+g];A+=c;x+=k}};d._copy=function(a){if(!(a.page>=this._mosaicPages.length)){var c=this._mosaicPages[a.page],f=c.mosaicsData;if(!e(c.mosaicsData))throw new p("mapview-invalid-resource","unsuitable data type!");var g=a.spriteData;(f=f.data)&&g||console.error("Source or target images are uninitialized!");b._copyBits(g,
a.spriteSize[0],0,0,f,a.pageSize[0],a.rect.x+D.SPRITE_PADDING,a.rect.y+D.SPRITE_PADDING,a.spriteSize[0],a.spriteSize[1],a.repeat);c.dirty=!0}};d._allocateImage=function(a,c){a+=2*D.SPRITE_PADDING;c+=2*D.SPRITE_PADDING;var f=Math.max(a,c);if(this._maxItemSize&&this._maxItemSize<f){f=2**Math.ceil(B.log2(a));const g=2**Math.ceil(B.log2(c));a=new u(0,0,a,c);this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(f*g)},size:[f,g],dirty:!0,texture:void 0});return[a,this._mosaicPages.length-
1,[f,g]]}f=this._binPack.allocate(a,c);return 0>=f.width?(f=this._mosaicPages[this._currentPage],!f.dirty&&e(f.mosaicsData)&&(f.mosaicsData.data=null),this._currentPage=this._mosaicPages.length,this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(this._pageWidth*this._pageHeight)},size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0}),this._binPack=new t(this._pageWidth,this._pageHeight),this._allocateImage(a,c)):[f,this._currentPage,[this._pageWidth,this._pageHeight]]};
d.dispose=function(){this._binPack=null;for(const c of this._mosaicPages){var a=c.texture;a&&a.dispose();a=c.mosaicsData;e(a)||a.data.destroy()}this._mosaicPages=null;this._mosaicRects.clear()};m._createClass(b,[{key:"itemCount",get:function(){return this._mosaicRects.size}}]);return b}()})},"esri/views/2d/engine/webgl/animatedFormats/AnimatableTextureResource":function(){define(["exports","../../../../../core/maybe","../definitions","./utils"],function(m,p,D,B){let u=function(){function t(l,e,b,
d){this._animation=l;this._frameData=null;this.frameCount=this._animation.frameDurations.length;this.width=this._animation.width;this.height=this._animation.height;this._playHandle=B.play(this._animation,b,d,a=>{this._frameData=a;e.requestRender()})}var h=t.prototype;h.destroy=function(){this._playHandle.remove()};h.bindFrame=function(l,e,b){l.bindTexture(e,b);p.isNone(this._frameData)||(e.updateData(0,D.SPRITE_PADDING,D.SPRITE_PADDING,this._frameData.width,this._frameData.height,this._frameData),
this._frameData=null)};return t}();m.AnimatableTextureResource=u;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/animatedFormats/utils":function(){define(["exports","../../../../../core/time","../../../../../geometry/support/meshUtils/exporters/gltf/imageutils","../../../../../symbols/cim/enums","../grouping"],function(m,p,D,B,u){function t(g){return p.Milliseconds(g.frameDurations.reduce((n,k)=>n+k,0))}function h(g){const {width:n,height:k}=g;return{frameDurations:g.frameDurations.reverse(),
getFrame:x=>g.getFrame(g.frameDurations.length-1-x),width:n,height:k}}function l(g,n){const {width:k,height:x,getFrame:r}=g,v=t(g),q=n/v;return{frameDurations:g.frameDurations.map(y=>p.Milliseconds(y*q)),getFrame:r,width:k,height:x}}function e(g,n){const {width:k,height:x,getFrame:r}=g;g=g.frameDurations.slice();const v=g.shift();g.unshift(p.Milliseconds(v+n));return{frameDurations:g,getFrame:r,width:k,height:x}}function b(g,n){const {width:k,height:x,getFrame:r}=g;g=g.frameDurations.slice();const v=
g.pop();g.push(p.Milliseconds(v+n));return{frameDurations:g,getFrame:r,width:k,height:x}}function d(g,n,k,x){let {repeatType:r}=n;null==r&&(r=B.AnimatedSymbolRepeatType.Loop);!0===n.reverseAnimation&&(g=h(g));null!=n.duration&&(g=l(g,p.Milliseconds(1E3*n.duration)));if(null!=n.repeatDelay){const v=1E3*n.repeatDelay;r===B.AnimatedSymbolRepeatType.Loop?g=b(g,p.Milliseconds(v)):r===B.AnimatedSymbolRepeatType.Oscillate&&(g=e(b(g,p.Milliseconds(v/2)),p.Milliseconds(v/2)))}null!=n.startTimeOffset?n=p.Milliseconds(1E3*
n.startTimeOffset):null!=n.randomizeStartTime?(k=u.getMaterialGroup(k),n=u.getRandomValue(k,null!=n.randomizeStartSeed?n.randomizeStartSeed:82749913),n=p.Milliseconds(n*t(g))):n=p.Milliseconds(0);return new a(g,n,r,x)}let a=function(){function g(n,k,x,r){this._animation=n;this._repeatType=x;this._onFrameData=r;this._direction=1;this._currentFrame=0;this.timeToFrame=this._animation.frameDurations[this._currentFrame];for(n=0;k>n;)n+=this.timeToFrame,this.nextFrame();k=this._animation.getFrame(this._currentFrame);
this._onFrameData(k)}g.prototype.nextFrame=function(){this._currentFrame+=this._direction;if(0<this._direction){if(this._currentFrame===this._animation.frameDurations.length)switch(this._repeatType){case B.AnimatedSymbolRepeatType.None:this._currentFrame-=this._direction;break;case B.AnimatedSymbolRepeatType.Loop:this._currentFrame=0;break;case B.AnimatedSymbolRepeatType.Oscillate:this._currentFrame-=this._direction,this._direction=-1}}else if(-1===this._currentFrame)switch(this._repeatType){case B.AnimatedSymbolRepeatType.None:this._currentFrame-=
this._direction;break;case B.AnimatedSymbolRepeatType.Loop:this._currentFrame=this._animation.frameDurations.length-1;break;case B.AnimatedSymbolRepeatType.Oscillate:this._currentFrame-=this._direction,this._direction=1}this.timeToFrame=this._animation.frameDurations[this._currentFrame];const n=this._animation.getFrame(this._currentFrame);this._onFrameData(n)};return g}();const c=document.createElement("canvas"),f=c.getContext("2d");m.Player=a;m.adjustDuration=l;m.appendDelay=b;m.createPlayer=d;m.getDuration=
t;m.play=function(g,n,k,x){function r(){A=v?setTimeout(()=>{q.nextFrame();y=q.timeToFrame;r()},y):void 0}const v=null!=n.playAnimation?n.playAnimation:!0,q=d(g,n,k,x);let y=q.timeToFrame,A;r();return{remove:()=>{v&&clearTimeout(A)}}};m.prependDelay=e;m.resize=function(g,n,k){c.width=n;c.height=k;const x=[],r=g.frameDurations.length;for(let v=0;v<r;v++){const q=g.getFrame(v);f.clearRect(0,0,n,k);q instanceof ImageData?f.drawImage(D.imageTypeToCanvas(q),0,0,n,k):f.drawImage(q,0,0,n,k);x.push(f.getImageData(0,
0,n,k))}return{width:n,height:k,frameDurations:g.frameDurations,getFrame:v=>x[v]}};m.reverse=h;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/grouping":function(){define(["exports","../../../../core/string"],function(m,p){function D(B,u){if("string"===typeof B)B=p.numericHash(B+`-seed(${u})`);else{let t=12;B^=u;do B=107*(B>>8^B)+t|0;while(0!==--t)}return(1+B/-2147483648)/2}m.getMaterialGroup=function(B){return Math.floor(10*D(B,53290320))};m.getRandomValue=
D;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/util/Result":function(){define(["exports","../../../../../core/Error"],function(m,p){m.ok=function(D,B){return D&&"name"in D?(B&&B.error(new p(D.name,D.message,D.details)),!1):!0};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/util/symbolUtils":function(){define(["exports"],function(m){m.keyFromSymbol=function(p){switch(p.type){case "esriSMS":return`${p.style}.${p.path}`;
case "esriSLS":return`${p.style}.${p.cap}`;case "esriSFS":return`${p.style}`;case "esriPFS":case "esriPMS":return p.imageData?`${p.imageData}${p.width}${p.height}`:`${p.url}${p.width}${p.height}`;default:return"mosaicHash"in p?p.mosaicHash:JSON.stringify(p)}};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/TextureUploadManager":function(){define(["exports","../../../../core/maybe","../../../../core/promiseUtils","./definitions","../../../webgl/context-util"],
function(m,p,D,B,u){let t=function(){function h(e,b){this._queue=[];this._context=e;this._refreshable=b}var l=h.prototype;l.destroy=function(){this._queue=[]};l.enqueueTextureUpdate=function(e,b){const d=D.createResolver(),a=B.TEXTURE_UPLOAD_MANAGER_CHUNK_SIZE,c=Math.ceil(e.height/a);D.throwIfAborted(b);if(this._context.type===u.ContextType.WEBGL1)this._queue.push({type:"no-chunk",request:e,resolver:d,options:b});else for(let f=0;f<c;f++){const g=f===c-1;this._queue.push({type:"chunk",request:e,resolver:d,
chunk:f,chunkOffset:f*a,destHeight:g?e.height-a*f:a,chunkIsLast:g,options:b})}D.onAbortOrThrow(b,f=>d.reject(f));return d.promise};l.upload=function(){let e=0;for(;this._queue.length;){var b=performance.now();const d=this._queue.shift();if(d&&(!p.isSome(d.options.signal)||!d.options.signal.aborted)){switch(d.type){case "chunk":this._uploadChunk(d);break;case "no-chunk":this._uploadNoChunk(d)}b=performance.now()-b;e+=b;if(e+b>=B.TEXTURE_UPLOAD_MANAGER_BUDGET)break}}this._queue.length&&this._refreshable.requestRender()};
l._uploadChunk=function(e){const {request:b,resolver:d,chunkOffset:a,chunkIsLast:c,destHeight:f}=e,{data:g,texture:n,width:k}=b;p.isSome(g)&&(n.updateData(0,0,a,k,f,g,a),c&&d.resolve())};l._uploadNoChunk=function(e){const {request:b,resolver:d}=e,{data:a,texture:c}=b;c.setData(a);d.resolve()};return h}();m.TextureUploadManager=t;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/WorldExtentClipRenderer":function(){define("exports ../../../../core/maybe ../../../../chunks/common ../../../../chunks/mat3 ../../../../chunks/mat3f32 ../../../../chunks/vec2f64 ../../../../chunks/vec3 ../../../../chunks/vec3f64 ./VertexStream ./shaders/StencilPrograms ../../../webgl/enums ../../../webgl/ProgramTemplate".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d,a){const c=t.fromValues(-.5,-.5);t=function(){function f(){this._centerNdc=l.create();this._pxToNdc=l.create();this._worldDimensionsPx=l.create();this._mat3=u.create();this._initialized=!1}var g=f.prototype;g.dispose=function(){this._program=p.disposeMaybe(this._program);this._quad=p.disposeMaybe(this._quad)};g.render=function(n,k){const {context:x}=n;if(!this._updateGeometry(n,k))return!1;this._initialized||this._initialize(x);x.setDepthWriteEnabled(!1);x.setDepthTestEnabled(!1);
x.setColorMask(!1,!1,!1,!1);x.setBlendingEnabled(!1);x.setStencilOp(d.StencilOperation.KEEP,d.StencilOperation.KEEP,d.StencilOperation.REPLACE);x.setStencilFunction(d.CompareFunction.ALWAYS,1,255);x.setStencilTestEnabled(!0);x.useProgram(this._program);this._program.setUniformMatrix3fv("u_worldExtent",this._mat3);this._quad.draw();this._quad.unbind();return!0};g._initialize=function(n){if(!this._initialized){var k=a.createProgram(n,b.stencil);k&&(this._program=k,this._quad=new e(n,[0,0,1,0,0,1,1,
1]),this._initialized=!0)}};g._updateGeometry=function(n,k){const {state:x,pixelRatio:r}=n,{size:v,rotation:q}=x,y=Math.round(v[0]*r),A=Math.round(v[1]*r);if(!x.spatialReference.isWrappable)return!1;n=D.toRadian(q);const w=Math.abs(Math.cos(n)),z=Math.abs(Math.sin(n)),C=Math.round(x.worldScreenWidth);if(Math.round(y*w+A*z)<=C)return!1;const E=(k.left-k.right)*r/y;k=(k.bottom-k.top)*r/A;h.set(this._worldDimensionsPx,C*r,y*z+A*w,1);h.set(this._pxToNdc,2/y,-2/A,1);h.set(this._centerNdc,E,k,1);k=this._mat3;
B.fromTranslation(k,this._centerNdc);B.scale(k,k,this._pxToNdc);0!==q&&B.rotate(k,k,n);B.scale(k,k,this._worldDimensionsPx);B.translate(k,k,c);return!0};return f}();m.WorldExtentClipRenderer=t;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/shaders/StencilPrograms":function(){define(["exports","./sources/resolver"],function(m,p){p={shaders:{vertexShader:p.resolveIncludes("stencil/stencil.vert"),fragmentShader:p.resolveIncludes("stencil/stencil.frag")},attributes:new Map([["a_pos",
0]])};m.stencil=p;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/effects/AnimationEffect":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ../VertexStream ./Effect".split(" "),function(m,p,D,B,u,t){t=function(h){function l(){var b=h.apply(this,arguments)||this;b.defines=[];b._desc={vsPath:"fx/integrate",fsPath:"fx/integrate",attributes:new Map([["a_position",0]])};return b}p._inheritsLoose(l,
h);var e=l.prototype;e.dispose=function(){this._quad&&this._quad.dispose()};e.bind=function(){};e.unbind=function(){};e.draw=function(b,d){if(d?.size){var {context:a,renderingOptions:c}=b;this._quad||(this._quad=new u(a,[0,0,1,0,0,1,1,1]));var f=a.getBoundFramebufferObject(),{x:g,y:n,width:k,height:x}=a.getViewport();d.bindTextures(a);var r=d.getBlock(B.ATTRIBUTE_DATA_ANIMATION);if(!D.isNone(r)){var v=r.getFBO(a);r=r.getFBO(a,1);a.setViewport(0,0,d.size,d.size);this._computeDelta(b,r,c.labelsAnimationTime);
this._updateAnimationState(b,r,v);a.bindFramebuffer(f);a.setViewport(g,n,k,x)}}};e._computeDelta=function(b,d,a){const {context:c,painter:f,displayLevel:g}=b,n=f.materialManager.getProgram(this._desc,["delta"]);c.bindFramebuffer(d);c.setClearColor(0,0,0,0);c.clear(c.gl.COLOR_BUFFER_BIT);c.useProgram(n);n.setUniform1i("u_maskTexture",B.TEXTURE_BINDING_ATTRIBUTE_DATA_0);n.setUniform1i("u_sourceTexture",B.TEXTURE_BINDING_ATTRIBUTE_DATA_1);n.setUniform1f("u_timeDelta",b.deltaTime);n.setUniform1f("u_animationTime",
a);n.setUniform1f("u_zoomLevel",Math.round(10*g));this._quad.draw()};e._updateAnimationState=function(b,d,a){const {context:c,painter:f}=b;b=f.materialManager.getProgram(this._desc,["update"]);c.bindTexture(d.colorTexture,1);c.useProgram(b);b.setUniform1i("u_sourceTexture",1);c.bindFramebuffer(a);c.setClearColor(0,0,0,0);c.clear(c.gl.COLOR_BUFFER_BIT);this._quad.draw()};return l}(t.Effect);m.AnimationEffect=t;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/effects/BlendEffect":function(){define("exports ../../../../../core/Error ../../../../../core/Logger ../../../../../core/maybe ../enums ../VertexStream ../shaders/BlendPrograms ../../../../webgl/enums ../../../../webgl/Texture".split(" "),
function(m,p,D,B,u,t,h,l,e){const b=D.getLogger("esri.views.2d.engine.webgl.effects.blendEffects.BlendEffect");D=function(){function d(){this._size=[0,0]}var a=d.prototype;a.dispose=function(c){this._backBufferTexture=B.disposeMaybe(this._backBufferTexture);this._quad=B.disposeMaybe(this._quad)};a.draw=function(c,f,g,n,k){const {context:x,drawPhase:r}=c;this._setupShader(x);n&&"normal"!==n&&r!==u.WGLDrawPhase.LABEL?this._drawBlended(c,f,g,n,k):(c=h.createProgramTemplate("normal"),(c=x.programCache.acquire(c.shaders.vertexShader,
c.shaders.fragmentShader,c.attributes))?(x.useProgram(c),f.setSamplingMode(g),x.bindTexture(f,0),c.setUniform1i("u_layerTexture",0),c.setUniform1f("u_opacity",k),x.setBlendingEnabled(!0),x.setBlendFunction(l.BlendFactor.ONE,l.BlendFactor.ONE_MINUS_SRC_ALPHA),f=this._quad,f.draw(),f.unbind(),c.dispose()):b.error(new p("mapview-BlendEffect",'Error creating shader program for blend mode "normal"')))};a._drawBlended=function(c,f,g,n,k){const {context:x,state:r,pixelRatio:v,inFadeTransition:q}=c;var {size:y}=
r,A=x.getBoundFramebufferObject();let w;B.isSome(A)?(y=A.descriptor,w=y.width,y=y.height):(w=Math.round(v*y[0]),y=Math.round(v*y[1]));this._createOrResizeTexture(c,w,y);c=this._backBufferTexture;A.copyToTexture(0,0,w,y,0,0,c);x.setStencilTestEnabled(!1);x.setStencilWriteMask(0);x.setBlendingEnabled(!0);x.setDepthTestEnabled(!1);x.setDepthWriteEnabled(!1);A=h.createProgramTemplate(n);(A=x.programCache.acquire(A.shaders.vertexShader,A.shaders.fragmentShader,A.attributes))?(x.useProgram(A),c.setSamplingMode(g),
x.bindTexture(c,0),A.setUniform1i("u_backbufferTexture",0),f.setSamplingMode(g),x.bindTexture(f,1),A.setUniform1i("u_layerTexture",1),A.setUniform1f("u_opacity",k),A.setUniform1f("u_inFadeOpacity",q?1:0),x.setBlendFunction(l.BlendFactor.ONE,l.BlendFactor.ZERO),f=this._quad,f.draw(),f.unbind(),A.dispose(),x.setBlendFunction(l.BlendFactor.ONE,l.BlendFactor.ONE_MINUS_SRC_ALPHA)):b.error(new p("mapview-BlendEffect",`Error creating shader program for blend mode ${n}`))};a._setupShader=function(c){this._quad||
(this._quad=new t(c,[-1,-1,1,-1,-1,1,1,1]))};a._createOrResizeTexture=function(c,f,g){({context:c}=c);if(null===this._backBufferTexture||f!==this._size[0]||g!==this._size[1])this._backBufferTexture?this._backBufferTexture.resize(f,g):this._backBufferTexture=new e.Texture(c,{target:l.TextureType.TEXTURE_2D,pixelFormat:l.PixelFormat.RGBA,internalFormat:l.PixelFormat.RGBA,dataType:l.PixelType.UNSIGNED_BYTE,wrapMode:l.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:l.TextureSamplingMode.LINEAR,flipped:!1,
width:f,height:g}),this._size[0]=f,this._size[1]=g};return d}();m.BlendEffect=D;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/shaders/BlendPrograms":function(){define(["exports","./sources/resolver"],function(m,p){m.createProgramTemplate=function(D){return{attributes:new Map([["a_pos",0],["a_tex",1]]),shaders:{vertexShader:`#define ${D.replace("-","_").toUpperCase()}\n`+p.resolveIncludes("blend/blend.vert"),fragmentShader:`#define ${D.replace("-","_").toUpperCase()}\n`+
p.resolveIncludes("blend/blend.frag")}}};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/effects/FeatureEffect":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","./Effect","../../../../webgl/enums"],function(m,p,D,B){D=function(u){function t(l){var e=u.call(this)||this;e.name=e.constructor.name;e.defines=[l];return e}p._inheritsLoose(t,u);var h=t.prototype;h.dispose=function(){};h.bind=function({context:l,painter:e}){this._prev=
l.getBoundFramebufferObject();const {width:b,height:d}=l.getViewport();e=e.getFbos(b,d).effect0;l.bindFramebuffer(e);l.setColorMask(!0,!0,!0,!0);l.setClearColor(0,0,0,0);l.clear(l.gl.COLOR_BUFFER_BIT)};h.unbind=function(){};h.draw=function(l,e){const {context:b,painter:d}=l;e=d.getPostProcessingEffects(e);const a=b.getBoundFramebufferObject();for(const {postProcessingEffect:c,effect:f}of e)c.draw(l,a,f);b.bindFramebuffer(this._prev);b.setStencilTestEnabled(!1);d.blitTexture(b,a.colorTexture,B.TextureSamplingMode.NEAREST);
b.setStencilTestEnabled(!0)};return t}(D.Effect);m.FeatureEffect=D;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/effects/HighlightEffect":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../BitBlitRenderer ./Effect ./highlight/HighlightRenderer ./highlight/HighlightSurfaces ../../../../webgl/enums".split(" "),function(m,p,D,B,u,t,h){return function(l){function e(){var d=l.apply(this,arguments)||this;d.defines=
["highlight"];d._hlRenderer=new u;d._width=void 0;d._height=void 0;d._boundFBO=null;d._hlSurfaces=new t;d._adjustedWidth=void 0;d._adjustedHeight=void 0;d._blitRenderer=new D.BitBlitRenderer;return d}m._inheritsLoose(e,l);var b=e.prototype;b.dispose=function(){this._hlSurfaces?.dispose();this._hlRenderer?.dispose();this._boundFBO=null};b.bind=function(d){const {context:a,painter:c}=d,{width:f,height:g}=a.getViewport(),n=c.getFbos(f,g).effect0;this.setup(d,f,g);a.bindFramebuffer(n);a.setColorMask(!0,
!0,!0,!0);a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT)};b.unbind=function(){};b.setup=function({context:d},a,c){this._width=a;this._height=c;const f=a%4,g=c%4;a+=2>f?-f:4-f;c+=2>g?-g:4-g;this._adjustedWidth=a;this._adjustedHeight=c;this._boundFBO=d.getBoundFramebufferObject();a=Math.round(1*a);c=Math.round(1*c);this._hlRenderer.setup(d,a,c);this._hlSurfaces.setup(d,a,c)};b.draw=function(d){const {context:a,highlightGradient:c}=d;c&&(d=a.getBoundFramebufferObject(),a.setViewport(0,0,1*this._adjustedWidth,
1*this._adjustedHeight),a.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo),a.setStencilTestEnabled(!1),a.setClearColor(0,0,0,0),a.clear(a.gl.COLOR_BUFFER_BIT),this._blitRenderer.render(a,d.colorTexture,h.TextureSamplingMode.NEAREST,1),a.setStencilTestEnabled(!1),a.setBlendingEnabled(!1),a.setColorMask(!1,!1,!1,!0),a.bindFramebuffer(this._hlSurfaces.sharedBlur2Fbo),a.setClearColor(0,0,0,0),a.clear(a.gl.COLOR_BUFFER_BIT),this._hlRenderer.preBlur(a,this._hlSurfaces.sharedBlur1Tex),a.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo),
a.setClearColor(0,0,0,0),a.clear(a.gl.COLOR_BUFFER_BIT),this._hlRenderer.finalBlur(a,this._hlSurfaces.sharedBlur2Tex),a.bindFramebuffer(this._boundFBO),a.setBlendingEnabled(!0),a.setColorMask(!0,!0,!0,!0),a.setViewport(0,0,this._width,this._height),this._hlRenderer.renderHighlight(a,this._hlSurfaces.sharedBlur1Tex,c),this._boundFBO=null)};return e}(B.Effect)})},"esri/views/2d/engine/webgl/effects/highlight/HighlightRenderer":function(){define("../../definitions ./parameters ../../shaders/HighlightPrograms ../../../../../webgl/BufferObject ../../../../../webgl/enums ../../../../../webgl/ProgramTemplate ../../../../../webgl/VertexArrayObject ../../../../../webgl/VertexElementDescriptor".split(" "),
function(m,p,D,B,u,t,h,l){return function(){function e(){this._height=this._width=void 0;this._resources=null}var b=e.prototype;b.dispose=function(){this._resources&&(this._resources.quadGeometry.dispose(),this._resources.quadVAO.dispose(),this._resources.highlightProgram.dispose(),this._resources.blurProgram.dispose(),this._resources=null)};b.preBlur=function(d,a){d.bindTexture(a,m.TEXTURE_BINDING_HIGHLIGHT_0);d.useProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",
[1,0,1/this._width,0]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",p.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);d.bindVAO(this._resources.quadVAO);d.drawArrays(u.PrimitiveType.TRIANGLE_STRIP,0,4);d.bindVAO()};b.finalBlur=function(d,a){d.bindTexture(a,m.TEXTURE_BINDING_HIGHLIGHT_0);d.useProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",[0,1,0,1/this._height]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",p.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);
d.bindVAO(this._resources.quadVAO);d.drawArrays(u.PrimitiveType.TRIANGLE_STRIP,0,4);d.bindVAO()};b.renderHighlight=function(d,a,c){d.bindTexture(a,m.TEXTURE_BINDING_HIGHLIGHT_0);d.useProgram(this._resources.highlightProgram);c.applyHighlightOptions(d,this._resources.highlightProgram);d.bindVAO(this._resources.quadVAO);d.setBlendingEnabled(!0);d.setBlendFunction(u.BlendFactor.ONE,u.BlendFactor.ONE_MINUS_SRC_ALPHA);d.drawArrays(u.PrimitiveType.TRIANGLE_STRIP,0,4);d.bindVAO()};b._initialize=function(d,
a,c){this._width=a;this._height=c;a=B.BufferObject.createVertex(d,u.Usage.STATIC_DRAW,(new Int8Array([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1])).buffer);c=new h.VertexArrayObject(d,new Map([["a_position",0],["a_texcoord",1]]),{geometry:[new l.VertexElementDescriptor("a_position",2,u.DataType.BYTE,0,4),new l.VertexElementDescriptor("a_texcoord",2,u.DataType.UNSIGNED_BYTE,2,4)]},{geometry:a});const f=t.createProgram(d,D.highlight),g=t.createProgram(d,D.blur);d.useProgram(f);f.setUniform1i("u_texture",m.TEXTURE_BINDING_HIGHLIGHT_0);
f.setUniform1i("u_shade",m.TEXTURE_BINDING_HIGHLIGHT_1);f.setUniform1f("u_sigma",p.SIGMA);d.useProgram(g);g.setUniform1i("u_texture",m.TEXTURE_BINDING_HIGHLIGHT_0);g.setUniform1f("u_sigma",p.SIGMA);this._resources={quadGeometry:a,quadVAO:c,highlightProgram:f,blurProgram:g}};b.setup=function(d,a,c){this._resources?(this._width=a,this._height=c):this._initialize(d,a,c)};return e}()})},"esri/views/2d/engine/webgl/shaders/HighlightPrograms":function(){define(["exports","./sources/resolver"],function(m,
p){const D={shaders:{vertexShader:p.resolveIncludes("highlight/textured.vert"),fragmentShader:p.resolveIncludes("highlight/highlight.frag")},attributes:new Map([["a_position",0],["a_texcoord",1]])};p={shaders:{vertexShader:p.resolveIncludes("highlight/textured.vert"),fragmentShader:p.resolveIncludes("highlight/blur.frag")},attributes:new Map([["a_position",0],["a_texcoord",1]])};m.blur=p;m.highlight=D;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/effects/highlight/HighlightSurfaces":function(){define(["../../../../../../chunks/_rollupPluginBabelHelpers",
"../../../../../../core/maybe","../../../../../webgl/enums","../../../../../webgl/FramebufferObject","../../../../../webgl/Texture"],function(m,p,D,B,u){function t(h,l,e){l=new u.Texture(h,{target:D.TextureType.TEXTURE_2D,pixelFormat:D.PixelFormat.RGBA,dataType:D.PixelType.UNSIGNED_BYTE,wrapMode:D.TextureWrapMode.CLAMP_TO_EDGE,width:l,height:e,samplingMode:D.TextureSamplingMode.LINEAR});h=new B.FramebufferObject(h,{colorTarget:D.TargetType.TEXTURE,depthStencilTarget:D.DepthStencilTargetType.STENCIL_RENDER_BUFFER},
l);return[l,h]}return function(){function h(){this._height=this._width=void 0;this._resources=null}var l=h.prototype;l.dispose=function(){this._resources&&(this._resources.sharedBlur1Tex.dispose(),this._resources.sharedBlur1Fbo.dispose(),this._resources.sharedBlur2Tex.dispose(),this._resources.sharedBlur2Fbo.dispose(),this._resources=p.nullifyNonNullableForDispose(this._resources))};l._initialize=function(e,b,d){this._width=b;this._height=d;const [a,c]=t(e,b,d),[f,g]=t(e,b,d);this._resources={sharedBlur1Tex:a,
sharedBlur1Fbo:c,sharedBlur2Tex:f,sharedBlur2Fbo:g}};l.setup=function(e,b,d){!this._resources||this._width===b&&this._height===d||this.dispose();this._resources||this._initialize(e,b,d)};m._createClass(h,[{key:"sharedBlur1Tex",get:function(){return this._resources.sharedBlur1Tex}},{key:"sharedBlur1Fbo",get:function(){return this._resources.sharedBlur1Fbo}},{key:"sharedBlur2Tex",get:function(){return this._resources.sharedBlur2Tex}},{key:"sharedBlur2Fbo",get:function(){return this._resources.sharedBlur2Fbo}}]);
return h}()})},"esri/views/2d/engine/webgl/effects/HittestEffect":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ./Effect ../../../../webgl/enums".split(" "),function(m,p,D,B,u,t){u=function(h){function l(){var b=h.apply(this,arguments)||this;b.name=b.constructor.name;b.defines=["hittest"];return b}p._inheritsLoose(l,h);var e=l.prototype;e.dispose=function(){D.isSome(this._fbo)&&this._fbo.dispose()};e.createOptions=function({pixelRatio:b},
d,a=B.HITTEST_RADIUS){if(!d.length)return null;d=d.shift();const c=d.x,f=d.y;this._outstanding=d;return{type:"hittest",distance:a*b,position:[c,f]}};e.bind=function(b){const {context:d,attributeView:a}=b;a.size&&(b=a.getBlock(B.ATTRIBUTE_DATA_GPGPU),D.isNone(b)||(b=b.getFBO(d),d.setViewport(0,0,a.size,a.size),d.bindFramebuffer(b),d.setColorMask(!0,!0,!0,!0),d.setClearColor(0,0,0,0),d.clear(d.gl.COLOR_BUFFER_BIT|d.gl.DEPTH_BUFFER_BIT)))};e.unbind=function(b){};e.draw=function(b){if(!D.isNone(this._outstanding)){var d=
this._outstanding;this._outstanding=null;this._resolve(b,d.resolvers)}};e._resolve=function(){var b=p._asyncToGenerator(function*(d,a){const {context:c,attributeView:f}=d;d=f.getBlock(B.ATTRIBUTE_DATA_GPGPU);if(D.isNone(d))a.forEach(k=>k.resolve([]));else{var g=d.getFBO(c);d=new Uint8Array(g.width*g.height*4);try{yield g.readPixelsAsync(0,0,g.width,g.height,t.PixelFormat.RGBA,t.PixelType.UNSIGNED_BYTE,d)}catch(k){a.forEach(x=>x.resolve([]));return}g=[];for(let k=0;k<d.length;k+=4){const x=d[k+3];
d[k]&&g.push({id:k/4,directHits:x})}g.sort((k,x)=>x.directHits===k.directHits?x.id-k.id:x.directHits-k.directHits);var n=g.map(k=>k.id);a.forEach(k=>k.resolve(n))}});return function(d,a){return b.apply(this,arguments)}}();return l}(u.Effect);m.HittestEffect=u;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/effects/HittestEffectVTL":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ./Effect ../../../../webgl/enums".split(" "),
function(m,p,D,B,u,t){u=function(h){function l(){var b=h.apply(this,arguments)||this;b.name=b.constructor.name;b.defines=["id"];b._lastSize=0;b._boundFBO=null;return b}p._inheritsLoose(l,h);var e=l.prototype;e.dispose=function(){D.isSome(this._fbo)&&this._fbo.dispose()};e.bind=function({context:b,painter:d}){const {width:a,height:c}=b.getViewport();this._boundFBO=b.getBoundFramebufferObject();d=d.getFbos(a,c).effect0;b.bindFramebuffer(d);b.setColorMask(!0,!0,!0,!0);b.setClearColor(0,0,0,0);b.clear(b.gl.COLOR_BUFFER_BIT)};
e.unbind=function({context:b}){b.bindFramebuffer(this._boundFBO);this._boundFBO=null};e.draw=function(b,d,a=2*B.HITTEST_RADIUS){this._resolve(b,d,a)};e._resolve=function(){var b=p._asyncToGenerator(function*({context:d,state:a,pixelRatio:c},f,g){var n=this;const k=d.getBoundFramebufferObject(),x=a.size[1]*c,r=Math.round(g*c),v=r/2,q=r/2;this._ensureBuffer(r);f.forEach(function(){var y=p._asyncToGenerator(function*(A,w){var z=new Map;yield k.readPixelsAsync(Math.floor(w.x*c-r/2),Math.floor(x-w.y*c-
r/2),r,r,t.PixelFormat.RGBA,t.PixelType.UNSIGNED_BYTE,n._buf);for(let F=0;F<n._buf32.length;F++){const G=n._buf32[F];if(4294967295!==G&&0!==G){var C=F%r,E=r-Math.floor(F/r);C=(v-C)*(v-C)+(q-E)*(q-E);E=z.has(G)?z.get(G):4294967295;z.set(G,Math.min(C,E))}}z=Array.from(z).sort((F,G)=>F[1]-G[1]).map(F=>F[0]);A.resolve(z);f.delete(w)});return function(A,w){return y.apply(this,arguments)}}())});return function(d,a,c){return b.apply(this,arguments)}}();e._ensureBuffer=function(b){this._lastSize!==b&&(this._lastSize=
b,this._buf=new Uint8Array(4*b*b),this._buf32=new Uint32Array(this._buf.buffer))};return l}(u.Effect);m.HittestEffectVTL=u;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/effects/post-processing/EffectManager":function(){define("exports ./Bloom ./Blur ./Colorize ./DropShadow ./Opacity".split(" "),function(m,p,D,B,u,t){const h={colorize:()=>new B.Colorize,blur:()=>new D.Blur,bloom:()=>new p.Bloom,opacity:()=>new t.Opacity,"drop-shadow":()=>new u.DropShadow};
let l=function(){function e(){this._effectMap=new Map}var b=e.prototype;b.dispose=function(){this._effectMap.forEach(d=>d.dispose());this._effectMap.clear()};b.getPostProcessingEffects=function(d){if(!d||0===d.length)return[];const a=[];for(const c of d){a:switch(d=c.type,d){case "bloom":case "blur":case "opacity":case "drop-shadow":break a;default:d="colorize"}let f=this._effectMap.get(d);f||(f=h[d](),this._effectMap.set(d,f));a.push({postProcessingEffect:f,effect:c})}return a};return e}();m.EffectManager=
l;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/effects/post-processing/Bloom":function(){define(["exports","../../../../../../core/maybe","../../VertexStream","../../../../../webgl/enums","../../../../../webgl/FramebufferObject"],function(m,p,D,B,u){const t=[1,0],h=[0,1],l=[1,.8,.6,.4,.2],e=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];let b=function(){function d(){this._compositeFBO=this._intensityFBO=null;this._mipsFBOs=Array(5);this._nMips=5;this._kernelSizeArray=
[3,5,7,9,11];this._size=[0,0];this._programDesc={luminosityHighPass:{vsPath:"post-processing/pp",fsPath:"post-processing/bloom/luminosityHighPass",attributes:new Map([["a_position",0]])},gaussianBlur:{vsPath:"post-processing/pp",fsPath:"post-processing/bloom/gaussianBlur",attributes:new Map([["a_position",0]])},composite:{vsPath:"post-processing/pp",fsPath:"post-processing/bloom/composite",attributes:new Map([["a_position",0]])},blit:{vsPath:"post-processing/pp",fsPath:"post-processing/blit",attributes:new Map([["a_position",
0]])}}}var a=d.prototype;a.dispose=function(){this._quad=p.disposeMaybe(this._quad);this._intensityFBO=p.disposeMaybe(this._intensityFBO);this._compositeFBO=p.disposeMaybe(this._compositeFBO);if(this._mipsFBOs){for(let c=0;c<this._nMips;c++)this._mipsFBOs[c]&&(this._mipsFBOs[c].horizontal.dispose(),this._mipsFBOs[c].vertical.dispose());this._mipsFBOs=null}};a.draw=function(c,f,g){const {width:n,height:k}=f,{context:x,painter:r}=c,{materialManager:v}=r;var q=x.gl;const y=this._programDesc,{strength:A,
radius:w,threshold:z}=g;this._quad||(this._quad=new D(x,[-1,-1,1,-1,-1,1,1,1]));this._createOrResizeResources(c,n,k);x.setStencilTestEnabled(!1);x.setBlendingEnabled(!0);x.setBlendFunction(B.BlendFactor.ONE,B.BlendFactor.ONE_MINUS_SRC_ALPHA);x.setStencilWriteMask(0);c=this._quad;c.bind();x.bindFramebuffer(this._intensityFBO);g=v.getProgram(y.luminosityHighPass);x.useProgram(g);x.bindTexture(f.colorTexture,0);g.setUniform1i("u_texture",0);g.setUniform3fv("u_defaultColor",[0,0,0]);g.setUniform1f("u_defaultOpacity",
0);g.setUniform1f("u_luminosityThreshold",z);g.setUniform1f("u_smoothWidth",.01);g=[Math.round(n/2),Math.round(k/2)];x.setViewport(0,0,g[0],g[1]);x.setClearColor(0,0,0,0);x.clear(q.COLOR_BUFFER_BIT);c.draw();x.setBlendingEnabled(!1);q=this._intensityFBO.colorTexture;for(let C=0;C<this._nMips;C++){const E=v.getProgram(y.gaussianBlur,[{name:"radius",value:this._kernelSizeArray[C]}]);x.useProgram(E);x.bindTexture(q,C+1);E.setUniform1i("u_colorTexture",C+1);E.setUniform2fv("u_texSize",g);E.setUniform2fv("u_direction",
t);x.setViewport(0,0,g[0],g[1]);const F=this._mipsFBOs[C];x.bindFramebuffer(F.horizontal);c.draw();q=F.horizontal.colorTexture;x.bindFramebuffer(F.vertical);x.bindTexture(q,C+1);E.setUniform2fv("u_direction",h);c.draw();q=F.vertical.colorTexture;g[0]=Math.round(g[0]/2);g[1]=Math.round(g[1]/2)}x.setViewport(0,0,n,k);g=v.getProgram(y.composite,[{name:"nummips",value:5}]);x.bindFramebuffer(this._compositeFBO);x.useProgram(g);g.setUniform1f("u_bloomStrength",A);g.setUniform1f("u_bloomRadius",w);g.setUniform1fv("u_bloomFactors",
l);g.setUniform3fv("u_bloomTintColors",e);x.bindTexture(this._mipsFBOs[0].vertical.colorTexture,1);g.setUniform1i("u_blurTexture1",1);x.bindTexture(this._mipsFBOs[1].vertical.colorTexture,2);g.setUniform1i("u_blurTexture2",2);x.bindTexture(this._mipsFBOs[2].vertical.colorTexture,3);g.setUniform1i("u_blurTexture3",3);x.bindTexture(this._mipsFBOs[3].vertical.colorTexture,4);g.setUniform1i("u_blurTexture4",4);x.bindTexture(this._mipsFBOs[4].vertical.colorTexture,5);g.setUniform1i("u_blurTexture5",5);
c.draw();x.bindFramebuffer(f);x.setBlendingEnabled(!0);f=v.getProgram(y.blit);x.useProgram(f);x.bindTexture(this._compositeFBO.colorTexture,6);f.setUniform1i("u_texture",6);x.setBlendFunction(B.BlendFactor.ONE,B.BlendFactor.ONE);c.draw();c.unbind();x.setBlendFunction(B.BlendFactor.ONE,B.BlendFactor.ONE_MINUS_SRC_ALPHA);x.setStencilTestEnabled(!0)};a._createOrResizeResources=function(c,f,g){({context:c}=c);if(!this._compositeFBO||this._size[0]!==f||this._size[1]!==g){this._size[0]=f;this._size[1]=
g;var n=[Math.round(f/2),Math.round(g/2)];this._compositeFBO?this._compositeFBO.resize(f,g):this._compositeFBO=new u.FramebufferObject(c,{colorTarget:B.TargetType.TEXTURE,depthStencilTarget:B.DepthStencilTargetType.NONE,width:f,height:g});this._intensityFBO?this._intensityFBO.resize(n[0],n[1]):this._intensityFBO=new u.FramebufferObject(c,{colorTarget:B.TargetType.TEXTURE,depthStencilTarget:B.DepthStencilTargetType.NONE,width:n[0],height:n[1]},{target:B.TextureType.TEXTURE_2D,pixelFormat:B.PixelFormat.RGBA,
internalFormat:B.PixelFormat.RGBA,dataType:B.PixelType.UNSIGNED_BYTE,wrapMode:B.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:B.TextureSamplingMode.LINEAR,flipped:!1,width:n[0],height:n[1]});for(f=0;f<this._nMips;f++)this._mipsFBOs[f]?(this._mipsFBOs[f].horizontal.resize(n[0],n[1]),this._mipsFBOs[f].vertical.resize(n[0],n[1])):this._mipsFBOs[f]={horizontal:new u.FramebufferObject(c,{colorTarget:B.TargetType.TEXTURE,depthStencilTarget:B.DepthStencilTargetType.NONE,width:n[0],height:n[1]},{target:B.TextureType.TEXTURE_2D,
pixelFormat:B.PixelFormat.RGBA,internalFormat:B.PixelFormat.RGBA,dataType:B.PixelType.UNSIGNED_BYTE,wrapMode:B.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:B.TextureSamplingMode.LINEAR,flipped:!1,width:n[0],height:n[1]}),vertical:new u.FramebufferObject(c,{colorTarget:B.TargetType.TEXTURE,depthStencilTarget:B.DepthStencilTargetType.NONE,width:n[0],height:n[1]},{target:B.TextureType.TEXTURE_2D,pixelFormat:B.PixelFormat.RGBA,internalFormat:B.PixelFormat.RGBA,dataType:B.PixelType.UNSIGNED_BYTE,wrapMode:B.TextureWrapMode.CLAMP_TO_EDGE,
samplingMode:B.TextureSamplingMode.LINEAR,flipped:!1,width:n[0],height:n[1]})},n[0]=Math.round(n[0]/2),n[1]=Math.round(n[1]/2)}};return d}();m.Bloom=b;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/effects/post-processing/Blur":function(){define(["exports","../../VertexStream","../../../../../webgl/enums","../../../../../webgl/FramebufferObject"],function(m,p,D,B){const u=[1,0],t=[0,1];let h=function(){function l(){this._blurFBO=null;this._size=[0,0];this._programDesc=
{gaussianBlur:{vsPath:"post-processing/pp",fsPath:"post-processing/blur/gaussianBlur",attributes:new Map([["a_position",0]])},radialBlur:{vsPath:"post-processing/pp",fsPath:"post-processing/blur/radial-blur",attributes:new Map([["a_position",0]])},blit:{vsPath:"post-processing/pp",fsPath:"post-processing/blit",attributes:new Map([["a_position",0]])}}}var e=l.prototype;e.dispose=function(){this._blurFBO&&(this._blurFBO.dispose(),this._blurFBO=null)};e.draw=function(b,d,a){const {context:c}=b,{type:f,
radius:g}=a;0!==g&&(this._createOrResizeResources(b),this._quad||(this._quad=new p(c,[-1,-1,1,-1,-1,1,1,1])),a=this._quad,a.bind(),"blur"===f?this._gaussianBlur(b,d,g):this._radialBlur(b,d),a.unbind())};e._gaussianBlur=function(b,d,a){const {context:c,state:f,painter:g,pixelRatio:n}=b;var {size:k}=f,{materialManager:x}=g;b=this._quad;k=[Math.round(n*k[0]),Math.round(n*k[1])];const r=this._blurFBO;x=x.getProgram(this._programDesc.gaussianBlur,[{name:"radius",value:Math.ceil(a)}]);c.useProgram(x);c.setBlendingEnabled(!1);
c.bindFramebuffer(r);c.bindTexture(d.colorTexture,4);x.setUniform1i("u_colorTexture",4);x.setUniform2fv("u_texSize",k);x.setUniform2fv("u_direction",u);x.setUniform1f("u_sigma",a);b.draw();c.bindFramebuffer(d);c.setStencilWriteMask(0);c.setStencilTestEnabled(!1);c.setDepthWriteEnabled(!1);c.setDepthTestEnabled(!1);c.bindTexture(r?.colorTexture,5);x.setUniform1i("u_colorTexture",5);x.setUniform2fv("u_direction",t);b.draw();c.setBlendingEnabled(!0);c.setBlendFunction(D.BlendFactor.ONE,D.BlendFactor.ONE_MINUS_SRC_ALPHA);
c.setStencilTestEnabled(!0)};e._radialBlur=function(b,d){const {context:a,painter:c}=b,{materialManager:f}=c,g=this._programDesc;b=this._quad;const n=this._blurFBO;a.bindFramebuffer(n);const k=f.getProgram(g.radialBlur);a.useProgram(k);a.setBlendingEnabled(!1);a.bindTexture(d.colorTexture,4);k.setUniform1i("u_colorTexture",4);b.draw();a.bindFramebuffer(d);a.setStencilWriteMask(0);a.setStencilTestEnabled(!1);a.setDepthWriteEnabled(!1);a.setDepthTestEnabled(!1);a.setBlendingEnabled(!0);d=f.getProgram(g.blit);
a.useProgram(d);a.bindTexture(n?.colorTexture,5);d.setUniform1i("u_texture",5);a.setBlendFunction(D.BlendFactor.ONE,D.BlendFactor.ONE_MINUS_SRC_ALPHA);b.draw()};e._createOrResizeResources=function(b){const {context:d,state:a,pixelRatio:c}=b;var {size:f}=a;b=Math.round(c*f[0]);f=Math.round(c*f[1]);this._blurFBO&&this._size[0]===b&&this._size[1]===f||(this._size[0]=b,this._size[1]=f,this._blurFBO?this._blurFBO.resize(b,f):this._blurFBO=new B.FramebufferObject(d,{colorTarget:D.TargetType.TEXTURE,depthStencilTarget:D.DepthStencilTargetType.NONE,
width:b,height:f},{target:D.TextureType.TEXTURE_2D,pixelFormat:D.PixelFormat.RGBA,internalFormat:D.PixelFormat.RGBA,dataType:D.PixelType.UNSIGNED_BYTE,wrapMode:D.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:D.TextureSamplingMode.LINEAR,flipped:!1,width:b,height:f}))};return l}();m.Blur=h;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/effects/post-processing/Colorize":function(){define(["exports","../../../../../../core/maybe","../../VertexStream","../../../../../webgl/enums",
"../../../../../webgl/Texture"],function(m,p,D,B,u){let t=function(){function h(){this._layerFBOTexture=null;this._size=[0,0];this._programDesc={vsPath:"post-processing/pp",fsPath:"post-processing/filterEffect",attributes:new Map([["a_position",0]])}}var l=h.prototype;l.dispose=function(){this._layerFBOTexture=p.disposeMaybe(this._layerFBOTexture)};l.draw=function(e,b,d){const {width:a,height:c}=b;this._createOrResizeResources(e,a,c);const {context:f,painter:g}=e,{materialManager:n}=g,k=this._programDesc;
e=this._quad;d=d.colorMatrix;e.bind();const x=this._layerFBOTexture;f.bindFramebuffer(b);b.copyToTexture(0,0,a,c,0,0,x);f.setBlendingEnabled(!1);f.setStencilTestEnabled(!1);b=n.getProgram(k);f.useProgram(b);f.bindTexture(x,2);b.setUniformMatrix4fv("u_coefficients",d);b.setUniform1i("u_colorTexture",2);e.draw();f.setBlendingEnabled(!0);f.setBlendFunction(B.BlendFactor.ONE,B.BlendFactor.ONE_MINUS_SRC_ALPHA);f.setStencilTestEnabled(!0);e.unbind()};l._createOrResizeResources=function(e,b,d){({context:e}=
e);this._layerFBOTexture&&this._size[0]===b&&this._size[1]===d||(this._size[0]=b,this._size[1]=d,this._layerFBOTexture?this._layerFBOTexture.resize(b,d):this._layerFBOTexture=new u.Texture(e,{target:B.TextureType.TEXTURE_2D,pixelFormat:B.PixelFormat.RGBA,internalFormat:B.PixelFormat.RGBA,dataType:B.PixelType.UNSIGNED_BYTE,wrapMode:B.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:B.TextureSamplingMode.LINEAR,flipped:!1,width:b,height:d}),this._quad||(this._quad=new D(e,[-1,-1,1,-1,-1,1,1,1])))};return h}();
m.Colorize=t;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/effects/post-processing/DropShadow":function(){define("exports ../../../../../../core/maybe ../../../../../../core/screenUtils ../../VertexStream ../../../../../webgl/enums ../../../../../webgl/FramebufferObject ../../../../../webgl/Texture".split(" "),function(m,p,D,B,u,t,h){const l=[1,0],e=[0,1];let b=function(){function d(){this._verticalBlurFBO=this._horizontalBlurFBO=this._layerFBOTexture=
null;this._size=[0,0];this._quad=null;this._programDesc={blur:{vsPath:"post-processing/pp",fsPath:"post-processing/blur/gaussianBlur",attributes:new Map([["a_position",0]])},composite:{vsPath:"post-processing/pp",fsPath:"post-processing/drop-shadow/composite",attributes:new Map([["a_position",0]])},blit:{vsPath:"post-processing/pp",fsPath:"post-processing/blit",attributes:new Map([["a_position",0]])}}}var a=d.prototype;a.dispose=function(){this._layerFBOTexture=p.disposeMaybe(this._layerFBOTexture);
this._horizontalBlurFBO=p.disposeMaybe(this._horizontalBlurFBO);this._verticalBlurFBO=p.disposeMaybe(this._verticalBlurFBO)};a.draw=function(c,f,g){const {context:n,state:k,painter:x}=c,{materialManager:r}=x,v=this._programDesc,q=f.width,y=f.height,A=[Math.round(q),Math.round(y)],{blurRadius:w,offsetX:z,offsetY:C,color:E}=g;g=[D.pt2px(z),D.pt2px(C)];this._createOrResizeResources(c,q,y,A);const F=this._horizontalBlurFBO;c=this._verticalBlurFBO;n.setStencilWriteMask(0);n.setStencilTestEnabled(!1);n.setDepthWriteEnabled(!1);
n.setDepthTestEnabled(!1);const G=this._layerFBOTexture;f.copyToTexture(0,0,q,y,0,0,G);this._quad||(this._quad=new B(n,[-1,-1,1,-1,-1,1,1,1]));n.setViewport(0,0,A[0],A[1]);const H=this._quad;H.bind();n.setBlendingEnabled(!1);const L=r.getProgram(v.blur,[{name:"radius",value:Math.ceil(w)}]);n.useProgram(L);n.bindFramebuffer(F);n.bindTexture(f.colorTexture,4);L.setUniform1i("u_colorTexture",4);L.setUniform2fv("u_texSize",A);L.setUniform2fv("u_direction",l);L.setUniform1f("u_sigma",w);H.draw();n.bindFramebuffer(c);
n.bindTexture(F?.colorTexture,5);L.setUniform1i("u_colorTexture",5);L.setUniform2fv("u_direction",e);H.draw();n.bindFramebuffer(f);n.setViewport(0,0,q,y);f=r.getProgram(v.composite);n.useProgram(f);n.bindTexture(c?.colorTexture,2);f.setUniform1i("u_blurTexture",2);n.bindTexture(G,3);f.setUniform1i("u_layerFBOTexture",3);f.setUniform4fv("u_shadowColor",[E[0]/255*E[3],E[1]/255*E[3],E[2]/255*E[3],E[3]]);f.setUniformMatrix3fv("u_displayViewMat3",k.displayMat3);f.setUniform2fv("u_shadowOffset",g);H.draw();
n.setBlendingEnabled(!0);n.setStencilTestEnabled(!0);n.setBlendFunction(u.BlendFactor.ONE,u.BlendFactor.ONE_MINUS_SRC_ALPHA);H.unbind()};a._createOrResizeResources=function(c,f,g,n){({context:c}=c);this._horizontalBlurFBO&&this._size[0]===f&&this._size[1]===g||(this._size[0]=f,this._size[1]=g,this._horizontalBlurFBO?this._horizontalBlurFBO.resize(n[0],n[1]):this._horizontalBlurFBO=new t.FramebufferObject(c,{colorTarget:u.TargetType.TEXTURE,depthStencilTarget:u.DepthStencilTargetType.NONE,width:n[0],
height:n[1]},{target:u.TextureType.TEXTURE_2D,pixelFormat:u.PixelFormat.RGBA,internalFormat:u.PixelFormat.RGBA,dataType:u.PixelType.UNSIGNED_BYTE,wrapMode:u.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:u.TextureSamplingMode.LINEAR,flipped:!1,width:n[0],height:n[1]}),this._verticalBlurFBO?this._verticalBlurFBO.resize(n[0],n[1]):this._verticalBlurFBO=new t.FramebufferObject(c,{colorTarget:u.TargetType.TEXTURE,depthStencilTarget:u.DepthStencilTargetType.NONE,width:n[0],height:n[1]},{target:u.TextureType.TEXTURE_2D,
pixelFormat:u.PixelFormat.RGBA,internalFormat:u.PixelFormat.RGBA,dataType:u.PixelType.UNSIGNED_BYTE,wrapMode:u.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:u.TextureSamplingMode.LINEAR,flipped:!1,width:n[0],height:n[1]}),this._layerFBOTexture?this._layerFBOTexture.resize(f,g):this._layerFBOTexture=new h.Texture(c,{target:u.TextureType.TEXTURE_2D,pixelFormat:u.PixelFormat.RGBA,internalFormat:u.PixelFormat.RGBA,dataType:u.PixelType.UNSIGNED_BYTE,wrapMode:u.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:u.TextureSamplingMode.LINEAR,
flipped:!1,width:f,height:g}))};return d}();m.DropShadow=b;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/effects/post-processing/Opacity":function(){define(["exports","../../../../../../core/maybe","../../../../../webgl/enums","../../../../../webgl/Texture"],function(m,p,D,B){let u=function(){function t(){this._size=[0,0];this._layerFBOTexture=null}var h=t.prototype;h.dispose=function(){this._layerFBOTexture=p.disposeMaybe(this._layerFBOTexture)};h.draw=
function(l,e,b){const {width:d,height:a}=e;this._createOrResizeResources(l,d,a);const {context:c,painter:f}=l;({amount:l}=b);b=c.gl;const g=this._layerFBOTexture;c.bindFramebuffer(e);e.copyToTexture(0,0,d,a,0,0,g);c.setBlendingEnabled(!0);c.setStencilTestEnabled(!1);c.setDepthTestEnabled(!1);c.setClearColor(0,0,0,0);c.clear(b.COLOR_BUFFER_BIT);f.blitTexture(c,g,D.TextureSamplingMode.NEAREST,l)};h._createOrResizeResources=function(l,e,b){({context:l}=l);this._layerFBOTexture&&this._size[0]===e&&this._size[1]===
b||(this._size[0]=e,this._size[1]=b,this._layerFBOTexture?this._layerFBOTexture.resize(e,b):this._layerFBOTexture=new B.Texture(l,{target:D.TextureType.TEXTURE_2D,pixelFormat:D.PixelFormat.RGBA,internalFormat:D.PixelFormat.RGBA,dataType:D.PixelType.UNSIGNED_BYTE,wrapMode:D.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:D.TextureSamplingMode.NEAREST,flipped:!1,width:e,height:b}))};return t}();m.Opacity=u;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/painter/RenderPass":function(){define(["../../../../../core/arrayUtils",
"../../../../../core/maybe","../enums"],function(m,p,D){return function(){function B(t,h){this.brushes=t;this.name=h.name;this.drawPhase=h.drawPhase||D.WGLDrawPhase.MAP;this._targetFn=h.target;this.effects=h.effects||[];this.enableDefaultDraw=h.enableDefaultDraw??(()=>!0)}var u=B.prototype;u.render=function(t){const {context:h,profiler:l}=t,e=this._targetFn();var b=this.drawPhase&t.drawPhase;l.recordPassStart(this.name);if(b){this.enableDefaultDraw()&&this._doRender(t,e);l.recordPassEnd();for(const d of this.effects){if(!d.enable())continue;
b=d.apply;const a=d.args&&d.args(),c=h.getViewport(),f=h.getBoundFramebufferObject(),g=t.passOptions;this._bindEffect(t,b,a);this._doRender(t,e,b.defines);this._drawAndUnbindEffect(t,b,c,f,g,a)}}};u._doRender=function(t,h,l){if(!p.isNone(h)){var {profiler:e,context:b}=t;for(const d of this.brushes){e.recordBrushStart(d.name);if(p.isSome(d.brushEffect)){const a=b.getViewport(),c=b.getBoundFramebufferObject(),f=t.passOptions;this._bindEffect(t,d.brushEffect);this._drawWithBrush(d,t,h,l);this._drawAndUnbindEffect(t,
d.brushEffect,a,c,f)}else this._drawWithBrush(d,t,h,l);e.recordBrushEnd()}}};u._drawWithBrush=function(t,h,l,e){m.isArrayLike(l)?(t.prepareState(h,e),t.drawMany(h,l,e)):l.visible&&(t.prepareState(h,e),t.draw(h,l,e))};u._bindEffect=function(t,h,l){const {profiler:e}=t;e.recordPassStart(this.name+"."+h.name);h.bind(t,l);h=h.createOptions(t,l);t.passOptions=h};u._drawAndUnbindEffect=function(t,h,l,e,b,d){const {profiler:a,context:c}=t;t.passOptions=b;a.recordBrushStart(h.name);h.draw(t,d);h.unbind(t,
d);c.bindFramebuffer(e);const {x:f,y:g,width:n,height:k}=l;c.setViewport(f,g,n,k);a.recordBrushEnd();a.recordPassEnd()};return B}()})},"esri/views/2d/engine/webgl/Profiler":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/CircularArray ../../../../core/Evented ../../../../core/has ../../../../core/maybe ../../../webgl/capabilities/DisjointTimerQuery".split(" "),function(m,p,D,B,u,t,h){const l=u("esri-2d-profiler");u=function(){function e(d,a){this._events=new B;
this._entries=new Map;this._timings=new D(10);this._currentSummary=this._currentBrush=this._currentPass=this._currentContainer=null;if(l){this._ext=h.createDisjointTimerQuery(d.gl,{});this._debugOutput=a;var c=d.gl;if(this.enableCommandLogging)for(const f in c)if("function"===typeof c[f]){const g=c[f],n=f.includes("draw");c[f]=(...k)=>{this._events.emit("command",{container:this._currentContainer,pass:this._currentPass,brush:this._currentBrush,method:f,args:k,isDrawCommand:n});this._currentSummary&&
(this._currentSummary.commands++,n&&this._currentSummary.drawCommands++);return g.apply(c,k)}}}}var b=e.prototype;b.recordContainerStart=function(d){l&&(this._currentContainer=d)};b.recordContainerEnd=function(){l&&(this._currentContainer=null)};b.recordPassStart=function(d){l&&(this._currentPass=d,this._initSummary())};b.recordPassEnd=function(){l&&(this._currentPass=null,this._emitSummary())};b.recordBrushStart=function(d){l&&(this._currentBrush=d)};b.recordBrushEnd=function(){l&&(this._currentBrush=
null)};b.recordStart=function(d){if(l&&t.isSome(this._ext)){if(this._entries.has(d)){const n=this._entries.get(d);var a=this._ext.resultAvailable(n.query),c=this._ext.disjoint();if(a&&!c){a=this._ext.getResult(n.query)/1E6;c=0;if(t.isSome(this._timings.enqueue(a))){c=this._timings.entries;const k=c.length;let x=0;for(var f of c)x+=f;c=x/k}f=a.toFixed(2);a=c?c.toFixed(2):"--";this.enableCommandLogging?(console.groupCollapsed(`Frame report for ${d}, ${f} ms (${a} last 10 avg)\n${n.commandsLen} Commands (${n.drawCommands} draw)`),
console.log("RenderPass breakdown: "),console.table(n.summaries),console.log("Commands: ",n.commands),console.groupEnd()):console.log(`Frame report for ${d}, ${f} ms (${a} last 10 avg)`);this._debugOutput.innerHTML=`${f} (${a})`}for(const k of n.handles)k.remove();this._ext.deleteQuery(n.query);this._entries.delete(d)}const g={name:d,query:this._ext.createQuery(),commands:[],commandsLen:0,drawCommands:0,summaries:[],handles:[]};this.enableCommandLogging&&(g.handles.push(this._events.on("command",
n=>{g.commandsLen++;g.commands.push(n);n.isDrawCommand&&g.drawCommands++})),g.handles.push(this._events.on("summary",n=>{g.summaries.push(n)})));this._ext.beginTimeElapsed(g.query);this._entries.set(d,g)}};b.recordEnd=function(d){l&&t.isSome(this._ext)&&this._entries.has(d)&&this._ext.endTimeElapsed()};b._initSummary=function(){this.enableCommandLogging&&(this._currentSummary={container:this._currentContainer,pass:this._currentPass,drawCommands:0,commands:0})};b._emitSummary=function(){this.enableCommandLogging&&
this._currentSummary&&this._events.emit("summary",this._currentSummary)};p._createClass(e,[{key:"enableCommandLogging",get:function(){return!("object"===typeof l&&l.disableCommands)}}]);return e}();m.Profiler=u;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/core/CircularArray":function(){define(["../chunks/_rollupPluginBabelHelpers","./maybe"],function(m,p){return function(){function D(u){this._start=this.size=0;this.maxSize=u;this._buffer=Array(u)}var B=D.prototype;B.enqueue=
function(u){if(this.size===this.maxSize){const t=this._buffer[this._start];this._buffer[this._start]=u;this._start=(this._start+1)%this.maxSize;return t}this._buffer[(this._start+this.size++)%this.maxSize]=u;return null};B.dequeue=function(){if(0===this.size)return null;const u=this._buffer[this._start];this._buffer[this._start]=null;this.size--;this._start=(this._start+1)%this.maxSize;return u};B.peek=function(){return 0===this.size?null:this._buffer[this._start]};B.find=function(u){if(0===this.size)return null;
for(const t of this._buffer)if(p.isSome(t)&&u(t))return t;return null};B.clear=function(u){let t=this.dequeue();for(;p.isSome(t);)u&&u(t),t=this.dequeue()};m._createClass(D,[{key:"entries",get:function(){return this._buffer}}]);return D}()})},"esri/views/webgl/capabilities/DisjointTimerQuery":function(){define(["exports","./isWebGL2Context"],function(m,p){let D=function(B,u,t,h,l,e,b,d,a){this.createQuery=B;this.deleteQuery=u;this.resultAvailable=t;this.getResult=h;this.disjoint=l;this.beginTimeElapsed=
e;this.endTimeElapsed=b;this.createTimestamp=d;this.timestampBits=a};m.hasRunningElapsedTimer=!1;m.DisjointTimerQuery=D;m.createDisjointTimerQuery=function(B,u){if(u.disjointTimerQuery)return null;let t=B.getExtension("EXT_disjoint_timer_query_webgl2");return t&&p(B)?new D(()=>B.createQuery(),h=>{B.deleteQuery(h);m.hasRunningElapsedTimer=!1},h=>B.getQueryParameter(h,B.QUERY_RESULT_AVAILABLE),h=>B.getQueryParameter(h,B.QUERY_RESULT),()=>B.getParameter(t.GPU_DISJOINT_EXT),h=>{m.hasRunningElapsedTimer||
(m.hasRunningElapsedTimer=!0,B.beginQuery(t.TIME_ELAPSED_EXT,h))},()=>{B.endQuery(t.TIME_ELAPSED_EXT);m.hasRunningElapsedTimer=!1},h=>t.queryCounterEXT(h,t.TIMESTAMP_EXT),()=>B.getQuery(t.TIMESTAMP_EXT,t.QUERY_COUNTER_BITS_EXT)):(t=B.getExtension("EXT_disjoint_timer_query"))?new D(()=>t.createQueryEXT(),h=>{t.deleteQueryEXT(h);m.hasRunningElapsedTimer=!1},h=>t.getQueryObjectEXT(h,t.QUERY_RESULT_AVAILABLE_EXT),h=>t.getQueryObjectEXT(h,t.QUERY_RESULT_EXT),()=>B.getParameter(t.GPU_DISJOINT_EXT),h=>{m.hasRunningElapsedTimer||
(m.hasRunningElapsedTimer=!0,t.beginQueryEXT(t.TIME_ELAPSED_EXT,h))},()=>{t.endQueryEXT(t.TIME_ELAPSED_EXT);m.hasRunningElapsedTimer=!1},h=>t.queryCounterEXT(h,t.TIMESTAMP_EXT),()=>t.getQueryEXT(t.TIMESTAMP_EXT,t.QUERY_COUNTER_BITS_EXT)):null};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/capabilities/isWebGL2Context":function(){define(function(){return function(m){return window.WebGL2RenderingContext&&m instanceof window.WebGL2RenderingContext}})},"esri/views/webgl/RenderingContext":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/maybe ../../core/promiseUtils ../../core/time ./checkWebGLError ./context-util ./ContextState ./enums ./InstanceCounter ./ProgramCache ./renderState ./Texture ./Util ./WebGLDriverTest ./capabilities/Capabilities ./capabilities/isWebGL2Context".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d,a,c,f,g,n,k){function x(q,y,A,w){y?w!==y&&q.bindBuffer(A,y.glName):q.bindBuffer(A,null);return y}function r(q,y){switch(q){case e.PrimitiveType.POINTS:return 2*y;case e.PrimitiveType.TRIANGLES:return y/3;case e.PrimitiveType.TRIANGLE_STRIP:return y-2;case e.PrimitiveType.TRIANGLE_FAN:return y-2;default:return 0}}let v=function(){function q(A,w){this.gl=A;this.instanceCounter=new b.InstanceCounter;this.programCache=new d.ProgramCache(this);this._state=new l.ContextState;
this._numOfTriangles=this._numOfDrawCalls=0;this.type=k(A)?h.ContextType.WEBGL2:h.ContextType.WEBGL1;this._loadExtensions();this.configure(w)}var y=q.prototype;y.configure=function(A){this._capabilities=new n.Capabilities(this.gl,A);this._parameters=this._loadParameters(A);A=this.gl.getParameter(this.gl.VIEWPORT);this._state=new l.ContextState;this._state.viewport={x:A[0],y:A[1],width:A[2],height:A[3]};this._stateTracker=new a.StateTracker({setBlending:w=>{w?(this.setBlendingEnabled(!0),this.setBlendEquationSeparate(w.opRgb,
w.opAlpha),this.setBlendFunctionSeparate(w.srcRgb,w.dstRgb,w.srcAlpha,w.dstAlpha),w=w.color,this.setBlendColor(w.r,w.g,w.b,w.a)):this.setBlendingEnabled(!1)},setCulling:w=>{w?(this.setFaceCullingEnabled(!0),this.setCullFace(w.face),this.setFrontFace(w.mode)):this.setFaceCullingEnabled(!1)},setPolygonOffset:w=>{w?(this.setPolygonOffsetFillEnabled(!0),this.setPolygonOffset(w.factor,w.units)):this.setPolygonOffsetFillEnabled(!1)},setDepthTest:w=>{w?(this.setDepthTestEnabled(!0),this.setDepthFunction(w.func)):
this.setDepthTestEnabled(!1)},setStencilTest:w=>{if(w){this.setStencilTestEnabled(!0);const z=w.function;this.setStencilFunction(z.func,z.ref,z.mask);w=w.operation;this.setStencilOp(w.fail,w.zFail,w.zPass)}else this.setStencilTestEnabled(!1)},setDepthWrite:w=>{w?(this.setDepthWriteEnabled(!0),this.setDepthRange(w.zNear,w.zFar)):this.setDepthWriteEnabled(!1)},setColorWrite:w=>{w?this.setColorMask(w.r,w.g,w.b,w.a):this.setColorMask(!1,!1,!1,!1)},setStencilWrite:w=>{w?this.setStencilWriteMask(w.mask):
this.setStencilWriteMask(0)}});this.enforceState();D.disposeMaybe(this._driverTest);this._driverTest=new g.WebGLDriverTest(this)};y.dispose=function(){D.disposeMaybe(this._driverTest);this.programCache.dispose();this.bindVAO(null);this.unbindBuffer(e.BufferType.ARRAY_BUFFER);this.unbindBuffer(e.BufferType.ELEMENT_ARRAY_BUFFER);this.type===h.ContextType.WEBGL2&&(this.unbindBuffer(e.BufferType.UNIFORM_BUFFER),this._state.uniformBufferBindingPoints.length=0,this.unbindBuffer(e.BufferType.PIXEL_PACK_BUFFER),
this.unbindBuffer(e.BufferType.PIXEL_UNPACK_BUFFER),this.unbindBuffer(e.BufferType.COPY_READ_BUFFER),this.unbindBuffer(e.BufferType.COPY_WRITE_BUFFER));this._state.textureUnitMap.length=0;t.webglDebugEnabled()&&console.log(this.instanceCounter.resourceInformation)};y.setPipelineState=function(A){this._stateTracker.setPipeline(A)};y.setBlendingEnabled=function(A){this._state.blend!==A&&(!0===A?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND),this._state.blend=A,this._stateTracker.invalidateBlending())};
y.externalProgramUpdate=function(){this._state.program?.stop();this._state.program=null};y.externalTextureUnitUpdate=function(A,w){for(let z=0;z<A.length;++z)this._state.textureUnitMap[A[z]]=null;0<=w&&(this._state.activeTexture=w)};y.externalVertexArrayObjectUpdate=function(){const A=this.capabilities.vao;A&&(A.bindVertexArray(null),this._state.vertexArrayObject=null);this._state.vertexBuffer=null;this._state.indexBuffer=null};y.externalVertexBufferUpdate=function(){this._state.vertexBuffer=null};
y.externalIndexBufferUpdate=function(){this._state.indexBuffer=null};y.setBlendColor=function(A,w,z,C){if(A!==this._state.blendColor.r||w!==this._state.blendColor.g||z!==this._state.blendColor.b||C!==this._state.blendColor.a)this.gl.blendColor(A,w,z,C),this._state.blendColor.r=A,this._state.blendColor.g=w,this._state.blendColor.b=z,this._state.blendColor.a=C,this._stateTracker.invalidateBlending()};y.setBlendFunction=function(A,w){if(A!==this._state.blendFunction.srcRGB||w!==this._state.blendFunction.dstRGB)this.gl.blendFunc(A,
w),this._state.blendFunction.srcRGB=A,this._state.blendFunction.srcAlpha=A,this._state.blendFunction.dstRGB=w,this._state.blendFunction.dstAlpha=w,this._stateTracker.invalidateBlending()};y.setBlendFunctionSeparate=function(A,w,z,C){if(this._state.blendFunction.srcRGB!==A||this._state.blendFunction.srcAlpha!==z||this._state.blendFunction.dstRGB!==w||this._state.blendFunction.dstAlpha!==C)this.gl.blendFuncSeparate(A,w,z,C),this._state.blendFunction.srcRGB=A,this._state.blendFunction.srcAlpha=z,this._state.blendFunction.dstRGB=
w,this._state.blendFunction.dstAlpha=C,this._stateTracker.invalidateBlending()};y.setBlendEquation=function(A){this._state.blendEquation.mode!==A&&(this.gl.blendEquation(A),this._state.blendEquation.mode=A,this._state.blendEquation.modeAlpha=A,this._stateTracker.invalidateBlending())};y.setBlendEquationSeparate=function(A,w){if(this._state.blendEquation.mode!==A||this._state.blendEquation.modeAlpha!==w)this.gl.blendEquationSeparate(A,w),this._state.blendEquation.mode=A,this._state.blendEquation.modeAlpha=
w,this._stateTracker.invalidateBlending()};y.setColorMask=function(A,w,z,C){if(this._state.colorMask.r!==A||this._state.colorMask.g!==w||this._state.colorMask.b!==z||this._state.colorMask.a!==C)this.gl.colorMask(A,w,z,C),this._state.colorMask.r=A,this._state.colorMask.g=w,this._state.colorMask.b=z,this._state.colorMask.a=C,this._stateTracker.invalidateColorWrite()};y.setClearColor=function(A,w,z,C){if(this._state.clearColor.r!==A||this._state.clearColor.g!==w||this._state.clearColor.b!==z||this._state.clearColor.a!==
C)this.gl.clearColor(A,w,z,C),this._state.clearColor.r=A,this._state.clearColor.g=w,this._state.clearColor.b=z,this._state.clearColor.a=C};y.setFaceCullingEnabled=function(A){this._state.faceCulling!==A&&(!0===A?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this._state.faceCulling=A,this._stateTracker.invalidateCulling())};y.setPolygonOffsetFillEnabled=function(A){this._state.polygonOffsetFill!==A&&(!0===A?this.gl.enable(this.gl.POLYGON_OFFSET_FILL):this.gl.disable(this.gl.POLYGON_OFFSET_FILL),
this._state.polygonOffsetFill=A,this._stateTracker.invalidatePolygonOffset())};y.setPolygonOffset=function(A,w){if(this._state.polygonOffset[0]!==A||this._state.polygonOffset[1]!==w)this._state.polygonOffset[0]=A,this._state.polygonOffset[1]=w,this.gl.polygonOffset(A,w),this._stateTracker.invalidatePolygonOffset()};y.setCullFace=function(A){this._state.cullFace!==A&&(this.gl.cullFace(A),this._state.cullFace=A,this._stateTracker.invalidateCulling())};y.setFrontFace=function(A){this._state.frontFace!==
A&&(this.gl.frontFace(A),this._state.frontFace=A,this._stateTracker.invalidateCulling())};y.setScissorTestEnabled=function(A){this._state.scissorTest!==A&&(!0===A?this.gl.enable(this.gl.SCISSOR_TEST):this.gl.disable(this.gl.SCISSOR_TEST),this._state.scissorTest=A)};y.setScissorRect=function(A,w,z,C){if(this._state.scissorRect.x!==A||this._state.scissorRect.y!==w||this._state.scissorRect.width!==z||this._state.scissorRect.height!==C)this.gl.scissor(A,w,z,C),this._state.scissorRect.x=A,this._state.scissorRect.y=
w,this._state.scissorRect.width=z,this._state.scissorRect.height=C};y.setDepthTestEnabled=function(A){this._state.depthTest!==A&&(!0===A?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST),this._state.depthTest=A,this._stateTracker.invalidateDepthTest())};y.setClearDepth=function(A){this._state.clearDepth!==A&&(this.gl.clearDepth(A),this._state.clearDepth=A)};y.setDepthFunction=function(A){this._state.depthFunction!==A&&(this.gl.depthFunc(A),this._state.depthFunction=A,this._stateTracker.invalidateDepthTest())};
y.setDepthWriteEnabled=function(A){this._state.depthWrite!==A&&(this.gl.depthMask(A),this._state.depthWrite=A,this._stateTracker.invalidateDepthWrite())};y.setDepthRange=function(A,w){if(this._state.depthRange.zNear!==A||this._state.depthRange.zFar!==w)this.gl.depthRange(A,w),this._state.depthRange.zNear=A,this._state.depthRange.zFar=w,this._stateTracker.invalidateDepthWrite()};y.setStencilTestEnabled=function(A){this._state.stencilTest!==A&&(!0===A?this.gl.enable(this.gl.STENCIL_TEST):this.gl.disable(this.gl.STENCIL_TEST),
this._state.stencilTest=A,this._stateTracker.invalidateStencilTest())};y.setClearStencil=function(A){A!==this._state.clearStencil&&(this.gl.clearStencil(A),this._state.clearStencil=A)};y.setStencilFunction=function(A,w,z){if(this._state.stencilFunction.func!==A||this._state.stencilFunction.ref!==w||this._state.stencilFunction.mask!==z)this.gl.stencilFunc(A,w,z),this._state.stencilFunction.face=e.Face.FRONT_AND_BACK,this._state.stencilFunction.func=A,this._state.stencilFunction.ref=w,this._state.stencilFunction.mask=
z,this._stateTracker.invalidateStencilTest()};y.setStencilFunctionSeparate=function(A,w,z,C){if(this._state.stencilFunction.face!==A||this._state.stencilFunction.func!==w||this._state.stencilFunction.ref!==z||this._state.stencilFunction.mask!==C)this.gl.stencilFuncSeparate(A,w,z,C),this._state.stencilFunction.face=A,this._state.stencilFunction.func=w,this._state.stencilFunction.ref=z,this._state.stencilFunction.mask=C,this._stateTracker.invalidateStencilTest()};y.setStencilWriteMask=function(A){this._state.stencilWriteMask!==
A&&(this.gl.stencilMask(A),this._state.stencilWriteMask=A,this._stateTracker.invalidateStencilWrite())};y.setStencilOp=function(A,w,z){if(this._state.stencilOperation.face!==e.Face.FRONT_AND_BACK||this._state.stencilOperation.fail!==A||this._state.stencilOperation.zFail!==w||this._state.stencilOperation.zPass!==z)this.gl.stencilOp(A,w,z),this._state.stencilOperation.face=e.Face.FRONT_AND_BACK,this._state.stencilOperation.fail=A,this._state.stencilOperation.zFail=w,this._state.stencilOperation.zPass=
z,this._stateTracker.invalidateStencilTest()};y.setStencilOpSeparate=function(A,w,z,C){if(this._state.stencilOperation.face!==A||this._state.stencilOperation.fail!==w||this._state.stencilOperation.zFail!==z||this._state.stencilOperation.zPass!==C)this.gl.stencilOpSeparate(A,w,z,C),this._state.stencilOperation.face=A,this._state.stencilOperation.fail=w,this._state.stencilOperation.zFail=z,this._state.stencilOperation.zPass=C,this._stateTracker.invalidateStencilTest()};y.setActiveTexture=function(A,
w=!1){const z=this._state.activeTexture;0<=A&&(w||A!==this._state.activeTexture)&&(this.gl.activeTexture(e.BASE_TEXTURE_UNIT+A),this._state.activeTexture=A);return z};y.clear=function(A){A&&this.gl.clear(A)};y.clearSafe=function(A,w=255){A&&(A&e.ClearBufferBit.COLOR_BUFFER_BIT&&this.setColorMask(!0,!0,!0,!0),A&e.ClearBufferBit.DEPTH_BUFFER_BIT&&this.setDepthWriteEnabled(!0),A&e.ClearBufferBit.STENCIL_BUFFER_BIT&&this.setStencilWriteMask(w),this.gl.clear(A))};y.drawArrays=function(A,w,z){t.webglDebugEnabled()&&
(this._numOfDrawCalls++,this._numOfTriangles+=r(A,z));this.gl.drawArrays(A,w,z);t.webglDebugEnabled()&&(A=f.getErrorString(this))&&console.error("drawArrays:",A)};y.drawElements=function(A,w,z,C){t.webglDebugEnabled()&&(this._numOfDrawCalls++,this._numOfTriangles+=r(A,w));this.gl.drawElements(A,w,z,C);if(t.webglDebugEnabled()){const G=f.getErrorString(this);if(G){var E=this.getBoundVAO(),F=E?.indexBuffer;E={indexBuffer:F,vertexBuffers:E?.vertexBuffers};A={mode:A,count:w,type:z,offset:C};F=D.applySome(F,
H=>H.size)??0;w=C+w;console.error(`drawElements: ${G}${F<w?`. Buffer is too small. Attempted to draw index ${w} of ${F}`:""}`,{args:A,vao:E})}}};y.logInfo=function(){t.webglDebugEnabled()&&console.log(`DrawCalls: ${this._numOfDrawCalls}, Triangles: ${this._numOfTriangles}`)};y.resetInfo=function(){t.webglDebugEnabled()&&(this._numOfTriangles=this._numOfDrawCalls=0)};y.setViewport=function(A,w,z,C){z=Math.max(Math.round(z),1);C=Math.max(Math.round(C),1);const E=this._state.viewport;if(E.x!==A||E.y!==
w||E.width!==z||E.height!==C)E.x=A,E.y=w,E.width=z,E.height=C,this.gl.viewport(A,w,z,C)};y.getViewport=function(){const A=this._state.viewport;return{x:A.x,y:A.y,width:A.width,height:A.height}};y.useProgram=function(A){this._state.program!==A&&(this._state.program?.stop(),this._state.program=A,this.gl.useProgram(A?.glName??null))};y.bindTexture=function(A,w,z=!1){(w>=this.parameters.maxTextureImageUnits||0>w)&&console.error("Input texture unit is out of range of available units!");const C=this._state.textureUnitMap[w];
if(D.isNone(A)||null==A.glName)return D.isSome(C)&&(this.setActiveTexture(w,z),this.gl.bindTexture(C.descriptor.target,null)),this._state.textureUnitMap[w]=null,C;if(!z&&C===A)return A.isDirty&&(this.setActiveTexture(w,z),A.applyChanges()),C;this.setActiveTexture(w,z);this.gl.bindTexture(A.descriptor.target,A.glName);A.applyChanges();this._state.textureUnitMap[w]=A;return C};y.unbindTexture=function(A){if(!D.isNone(A))for(let w=0;w<this.parameters.maxTextureImageUnits;w++)this._state.textureUnitMap[w]===
A&&(this.bindTexture(null,w),this._state.textureUnitMap[w]=null)};y.bindFramebuffer=function(A,w=!1){if(w||this._state.readFramebuffer!==A||this._state.drawFramebuffer!==A)D.isNone(A)?(this.gl.bindFramebuffer(e.FramebufferTarget.FRAMEBUFFER,null),this._state.readFramebuffer=null,this._state.drawFramebuffer=null):(A.initializeAndBind(e.FramebufferTarget.FRAMEBUFFER),this._state.readFramebuffer=A,this._state.drawFramebuffer=A)};y.bindFramebufferSeparate=function(A,w,z=!1){const C=w===e.FramebufferTarget.READ_FRAMEBUFFER,
E=C?this._state.readFramebuffer:this._state.drawFramebuffer;if(z||E!==A)D.isNone(A)?this.gl.bindFramebuffer(w,null):A.initializeAndBind(w),C?this._state.readFramebuffer=D.unwrapOr(A,null):this._state.drawFramebuffer=D.unwrapOr(A,null)};y.blitFramebuffer=function(A,w,z=0,C=0,E=A.width,F=A.height,G=0,H=0,L=w.width,K=w.height,M=e.ClearBufferBit.COLOR_BUFFER_BIT,U=e.TextureSamplingMode.NEAREST){this.bindFramebufferSeparate(A,e.FramebufferTarget.READ_FRAMEBUFFER);this.bindFramebufferSeparate(w,e.FramebufferTarget.DRAW_FRAMEBUFFER);
this.gl.blitFramebuffer(z,C,E,F,G,H,L,K,M,U)};y.bindBuffer=function(A,w){if(A)switch(w??(w=A.bufferType),w){case e.BufferType.ARRAY_BUFFER:this._state.vertexBuffer=x(this.gl,A,w,this._state.vertexBuffer);break;case e.BufferType.ELEMENT_ARRAY_BUFFER:this._state.indexBuffer=x(this.gl,A,w,this._state.indexBuffer);break;case e.BufferType.UNIFORM_BUFFER:this._state.uniformBuffer=x(this.gl,A,w,this._state.uniformBuffer);break;case e.BufferType.PIXEL_PACK_BUFFER:this._state.pixelPackBuffer=x(this.gl,A,w,
this._state.pixelPackBuffer);break;case e.BufferType.PIXEL_UNPACK_BUFFER:this._state.pixelUnpackBuffer=x(this.gl,A,w,this._state.pixelUnpackBuffer);break;case e.BufferType.COPY_READ_BUFFER:this._state.copyReadBuffer=x(this.gl,A,w,this._state.copyReadBuffer);break;case e.BufferType.COPY_WRITE_BUFFER:this._state.copyWriteBuffer=x(this.gl,A,w,this._state.copyWriteBuffer)}};y.bindRenderbuffer=function(A){const w=this.gl;A||(w.bindRenderbuffer(w.RENDERBUFFER,null),this._state.renderbuffer=null);this._state.renderbuffer!==
A&&(w.bindRenderbuffer(w.RENDERBUFFER,A.glName),this._state.renderbuffer=A)};y._getBufferBinding=function(A,w){if(w>=this.parameters.maxUniformBufferBindings||0>w)return console.error("Uniform buffer binding point is out of range!"),null;A=this._state.uniformBufferBindingPoints;let z=A[w];D.isNone(z)&&(z={buffer:null,offset:0,size:0},A[w]=z);return z};y.bindBufferBase=function(A,w,z){const C=this._getBufferBinding(A,w);D.isNone(C)||C.buffer===z&&0===C.offset&&0===C.size||(this.gl.bindBufferBase(A,
w,z?z.glName:null),C.buffer=z,C.offset=0,C.size=0)};y.bindBufferRange=function(A,w,z,C,E){const F=this._getBufferBinding(A,w);D.isNone(F)||F.buffer===z&&F.offset===C&&F.size===E||(0!==C%this._parameters.uniformBufferOffsetAlignment?console.error("Uniform buffer binding offset is not a multiple of the context offset alignment"):(this.gl.bindBufferRange(A,w,z.glName,C,E),F.buffer=z,F.offset=C,F.size=E))};y.bindUBO=function(A,w,z,C){D.isNone(w)?this.bindBufferBase(e.BufferType.UNIFORM_BUFFER,A,null):
(t.webglDebugEnabled()&&(C??w.byteLength)>this._parameters.maxUniformBlockSize&&console.error("Attempting to bind more data than the maximum uniform block size"),w.initialize(),void 0!==z&&void 0!==C?this.bindBufferRange(e.BufferType.UNIFORM_BUFFER,A,w.buffer,z,C):this.bindBufferBase(e.BufferType.UNIFORM_BUFFER,A,w.buffer))};y.unbindUBO=function(A){for(let w=0,z=this._state.uniformBufferBindingPoints.length;w<z;w++){const C=this._state.uniformBufferBindingPoints[w];D.isSome(C)&&C.buffer===A.buffer&&
this.bindBufferBase(e.BufferType.UNIFORM_BUFFER,w,null)}};y.unbindBuffer=function(A){switch(A){case e.BufferType.ARRAY_BUFFER:this._state.vertexBuffer=x(this.gl,null,A,this._state.vertexBuffer);break;case e.BufferType.ELEMENT_ARRAY_BUFFER:this._state.indexBuffer=x(this.gl,null,A,this._state.indexBuffer);break;case e.BufferType.UNIFORM_BUFFER:this._state.uniformBuffer=x(this.gl,null,A,this._state.uniformBuffer);break;case e.BufferType.PIXEL_PACK_BUFFER:this._state.pixelPackBuffer=x(this.gl,null,A,
this._state.pixelPackBuffer);break;case e.BufferType.PIXEL_UNPACK_BUFFER:this._state.pixelUnpackBuffer=x(this.gl,null,A,this._state.pixelUnpackBuffer);break;case e.BufferType.COPY_READ_BUFFER:this._state.copyReadBuffer=x(this.gl,null,A,this._state.copyReadBuffer);break;case e.BufferType.COPY_WRITE_BUFFER:this._state.copyWriteBuffer=x(this.gl,null,A,this._state.copyWriteBuffer)}};y.bindVAO=function(A=null){D.isNone(A)?this._state.vertexArrayObject&&(this._state.vertexArrayObject.unbind(),this._state.vertexArrayObject=
null):this._state.vertexArrayObject!==A&&(A.bind(),this._state.vertexArrayObject=A)};y.clientWaitAsync=function(){var A=p._asyncToGenerator(function*(w=u.Milliseconds(10)){const z=this.gl,C=z.fenceSync(e.SyncCondition.SYNC_GPU_COMMANDS_COMPLETE,0);if(!C)throw Error("Client wait failed, could not create sync object");this.instanceCounter.increment(e.ResourceType.Sync,C);z.flush();let E;do yield B.after(w),E=z.clientWaitSync(C,0,0);while(E===e.ClientWaitSyncStatus.TIMEOUT_EXPIRED);this.instanceCounter.decrement(e.ResourceType.Sync,
C);z.deleteSync(C);if(E===e.ClientWaitSyncStatus.WAIT_FAILED)throw Error("Client wait failed");});return function(){return A.apply(this,arguments)}}();y.getBoundFramebufferObject=function(A=e.FramebufferTarget.FRAMEBUFFER){return A===e.FramebufferTarget.READ_FRAMEBUFFER?this._state.readFramebuffer:this._state.drawFramebuffer};y.getBoundVAO=function(){return this._state.vertexArrayObject};y.resetState=function(){this.useProgram(null);this.bindVAO(null);this.bindFramebuffer(null,!0);this.unbindBuffer(e.BufferType.ARRAY_BUFFER);
this.unbindBuffer(e.BufferType.ELEMENT_ARRAY_BUFFER);this.type===h.ContextType.WEBGL2&&(this.unbindBuffer(e.BufferType.UNIFORM_BUFFER),this._state.uniformBufferBindingPoints.length=0,this.unbindBuffer(e.BufferType.PIXEL_PACK_BUFFER),this.unbindBuffer(e.BufferType.PIXEL_UNPACK_BUFFER),this.unbindBuffer(e.BufferType.COPY_READ_BUFFER),this.unbindBuffer(e.BufferType.COPY_WRITE_BUFFER));for(let A=0;A<this.parameters.maxTextureImageUnits;++A)this.bindTexture(null,A);this.setBlendingEnabled(!1);this.setBlendFunction(e.BlendFactor.ONE,
e.BlendFactor.ZERO);this.setBlendEquation(e.BlendOperation.ADD);this.setBlendColor(0,0,0,0);this.setFaceCullingEnabled(!1);this.setCullFace(e.Face.BACK);this.setFrontFace(e.CullMode.CCW);this.setPolygonOffsetFillEnabled(!1);this.setPolygonOffset(0,0);this.setScissorTestEnabled(!1);this.setScissorRect(0,0,this.gl.canvas.width,this.gl.canvas.height);this.setDepthTestEnabled(!1);this.setDepthFunction(e.CompareFunction.LESS);this.setDepthRange(0,1);this.setStencilTestEnabled(!1);this.setStencilFunction(e.CompareFunction.ALWAYS,
0,0);this.setStencilOp(e.StencilOperation.KEEP,e.StencilOperation.KEEP,e.StencilOperation.KEEP);this.setClearColor(0,0,0,0);this.setClearDepth(1);this.setClearStencil(0);this.setColorMask(!0,!0,!0,!0);this.setStencilWriteMask(4294967295);this.setDepthWriteEnabled(!0);this.setViewport(0,0,this.gl.canvas.width,this.gl.canvas.height)};y.enforceState=function(){var A=this.capabilities.vao;A&&A.bindVertexArray(null);const {gl:w,gl2:z}=this;for(var C=0;C<this.parameters.maxVertexAttributes;C++)w.disableVertexAttribArray(C);
this._state.vertexBuffer?w.bindBuffer(this._state.vertexBuffer.bufferType,this._state.vertexBuffer.glName):w.bindBuffer(e.BufferType.ARRAY_BUFFER,null);this._state.indexBuffer?w.bindBuffer(this._state.indexBuffer.bufferType,this._state.indexBuffer.glName):w.bindBuffer(e.BufferType.ELEMENT_ARRAY_BUFFER,null);if(D.isSome(z)){this._state.uniformBuffer?z.bindBuffer(this._state.uniformBuffer.bufferType,this._state.uniformBuffer.glName):z.bindBuffer(e.BufferType.UNIFORM_BUFFER,null);for(C=0;C<this._parameters.maxUniformBufferBindings;C++){const E=
this._state.uniformBufferBindingPoints[C];if(D.isSome(E)){const {buffer:F,offset:G,size:H}=E;null!==F?0===G&&0===H?z.bindBufferBase(e.BufferType.UNIFORM_BUFFER,C,F.glName):z.bindBufferRange(e.BufferType.UNIFORM_BUFFER,C,F.glName,G,H):z.bindBufferBase(e.BufferType.UNIFORM_BUFFER,C,null)}}this._state.pixelPackBuffer?z.bindBuffer(this._state.pixelPackBuffer.bufferType,this._state.pixelPackBuffer.glName):z.bindBuffer(e.BufferType.PIXEL_PACK_BUFFER,null);this._state.pixelUnpackBuffer?z.bindBuffer(this._state.pixelUnpackBuffer.bufferType,
this._state.pixelUnpackBuffer.glName):z.bindBuffer(e.BufferType.PIXEL_UNPACK_BUFFER,null);this._state.copyReadBuffer?z.bindBuffer(this._state.copyReadBuffer.bufferType,this._state.copyReadBuffer.glName):z.bindBuffer(e.BufferType.COPY_READ_BUFFER,null);this._state.copyWriteBuffer?z.bindBuffer(this._state.copyWriteBuffer.bufferType,this._state.copyWriteBuffer.glName):z.bindBuffer(e.BufferType.COPY_WRITE_BUFFER,null);z.bindFramebuffer(e.FramebufferTarget.READ_FRAMEBUFFER,null);z.readBuffer(z.BACK);this._state.readFramebuffer&&
(z.bindFramebuffer(e.FramebufferTarget.READ_FRAMEBUFFER,this._state.readFramebuffer.glName),z.readBuffer(e.ColorAttachment.COLOR_ATTACHMENT0));z.bindFramebuffer(e.FramebufferTarget.DRAW_FRAMEBUFFER,this._state.drawFramebuffer?.glName??null)}else this._state.readFramebuffer=this._state.drawFramebuffer,w.bindFramebuffer(e.FramebufferTarget.FRAMEBUFFER,this._state.drawFramebuffer?.glName??null);if(A&&this._state.vertexArrayObject){if(A=this._state.vertexArrayObject)this._state.vertexArrayObject.unbind(),
this._state.vertexArrayObject=null;this.bindVAO(A)}w.useProgram(this._state.program?.glName??null);w.blendColor(this._state.blendColor.r,this._state.blendColor.g,this._state.blendColor.b,this._state.blendColor.a);w.bindRenderbuffer(w.RENDERBUFFER,this._state.renderbuffer?this._state.renderbuffer.glName:null);!0===this._state.blend?w.enable(this.gl.BLEND):w.disable(this.gl.BLEND);w.blendEquationSeparate(this._state.blendEquation.mode,this._state.blendEquation.modeAlpha);w.blendFuncSeparate(this._state.blendFunction.srcRGB,
this._state.blendFunction.dstRGB,this._state.blendFunction.srcAlpha,this._state.blendFunction.dstAlpha);w.clearColor(this._state.clearColor.r,this._state.clearColor.g,this._state.clearColor.b,this._state.clearColor.a);w.clearDepth(this._state.clearDepth);w.clearStencil(this._state.clearStencil);w.colorMask(this._state.colorMask.r,this._state.colorMask.g,this._state.colorMask.b,this._state.colorMask.a);w.cullFace(this._state.cullFace);w.depthFunc(this._state.depthFunction);w.depthRange(this._state.depthRange.zNear,
this._state.depthRange.zFar);!0===this._state.depthTest?w.enable(w.DEPTH_TEST):w.disable(w.DEPTH_TEST);w.depthMask(this._state.depthWrite);w.frontFace(this._state.frontFace);w.lineWidth(1);!0===this._state.faceCulling?w.enable(w.CULL_FACE):w.disable(w.CULL_FACE);w.polygonOffset(this._state.polygonOffset[0],this._state.polygonOffset[1]);!0===this._state.polygonOffsetFill?w.enable(w.POLYGON_OFFSET_FILL):w.disable(w.POLYGON_OFFSET_FILL);w.scissor(this._state.scissorRect.x,this._state.scissorRect.y,this._state.scissorRect.width,
this._state.scissorRect.height);!0===this._state.scissorTest?w.enable(w.SCISSOR_TEST):w.disable(w.SCISSOR_TEST);w.stencilFunc(this._state.stencilFunction.func,this._state.stencilFunction.ref,this._state.stencilFunction.mask);w.stencilOpSeparate(this._state.stencilOperation.face,this._state.stencilOperation.fail,this._state.stencilOperation.zFail,this._state.stencilOperation.zPass);!0===this._state.stencilTest?w.enable(w.STENCIL_TEST):w.disable(w.STENCIL_TEST);w.stencilMask(this._state.stencilWriteMask);
for(A=0;A<this.parameters.maxTextureImageUnits;A++)w.activeTexture(e.BASE_TEXTURE_UNIT+A),w.bindTexture(e.TextureType.TEXTURE_2D,null),w.bindTexture(e.TextureType.TEXTURE_CUBE_MAP,null),this.type===h.ContextType.WEBGL2&&(w.bindTexture(e.TextureType.TEXTURE_3D,null),w.bindTexture(e.TextureType.TEXTURE_2D_ARRAY,null)),C=this._state.textureUnitMap[A],D.isSome(C)&&w.bindTexture(C.descriptor.target,C.glName);w.activeTexture(e.BASE_TEXTURE_UNIT+this._state.activeTexture);A=this._state.viewport;w.viewport(A.x,
A.y,A.width,A.height);this.resetInfo()};y._loadExtensions=function(){this.type===h.ContextType.WEBGL1&&this.gl.getExtension("OES_element_index_uint");this.gl.getExtension("KHR_parallel_shader_compile")};y._loadParameters=function(A){var w=this.capabilities.textureFilterAnisotropic;A=A.maxAnisotropy??Infinity;const z=this.type===h.ContextType.WEBGL2,C=this.gl;w={versionString:this.gl.getParameter(this.gl.VERSION),maxVertexTextureImageUnits:this.gl.getParameter(this.gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),
maxVertexAttributes:this.gl.getParameter(this.gl.MAX_VERTEX_ATTRIBS),maxMaxAnisotropy:w?Math.min(this.gl.getParameter(w.MAX_TEXTURE_MAX_ANISOTROPY),A):1,maxTextureImageUnits:this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),maxTextureSize:this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE),maxUniformBufferBindings:z?C.getParameter(C.MAX_UNIFORM_BUFFER_BINDINGS):0,maxVertexUniformBlocks:z?C.getParameter(C.MAX_VERTEX_UNIFORM_BLOCKS):0,maxFragmentUniformBlocks:z?C.getParameter(C.MAX_FRAGMENT_UNIFORM_BLOCKS):
0,maxUniformBlockSize:z?C.getParameter(C.MAX_UNIFORM_BLOCK_SIZE):0,uniformBufferOffsetAlignment:z?C.getParameter(C.UNIFORM_BUFFER_OFFSET_ALIGNMENT):1,maxArrayTextureLayers:z?C.getParameter(C.MAX_ARRAY_TEXTURE_LAYERS):1,maxSamples:z?C.getParameter(C.MAX_SAMPLES):1};c.Texture.TEXTURE_UNIT_FOR_UPDATES=w.maxTextureImageUnits-1;return w};p._createClass(q,[{key:"gl2",get:function(){return this.type===h.ContextType.WEBGL1?null:this.gl}},{key:"driverTest",get:function(){return this._driverTest}},{key:"contextAttributes",
get:function(){return this.gl.getContextAttributes()}},{key:"parameters",get:function(){return this._parameters}},{key:"capabilities",get:function(){return this._capabilities}}]);return q}();m.RenderingContext=v;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/ContextState":function(){define(["exports","./enums"],function(m,p){m.ContextState=function(){this.blend=!1;this.blendColor={r:0,g:0,b:0,a:0};this.blendFunction={srcRGB:p.BlendFactor.ONE,dstRGB:p.BlendFactor.ZERO,
srcAlpha:p.BlendFactor.ONE,dstAlpha:p.BlendFactor.ZERO};this.blendEquation={mode:p.BlendOperation.ADD,modeAlpha:p.BlendOperation.ADD};this.colorMask={r:!0,g:!0,b:!0,a:!0};this.faceCulling=!1;this.cullFace=p.Face.BACK;this.frontFace=p.CullMode.CCW;this.scissorTest=!1;this.scissorRect={x:0,y:0,width:0,height:0};this.depthTest=!1;this.depthFunction=p.CompareFunction.LESS;this.clearDepth=1;this.depthWrite=!0;this.depthRange={zNear:0,zFar:1};this.viewport=null;this.polygonOffsetFill=this.stencilTest=!1;
this.polygonOffset=[0,0];this.stencilFunction={face:p.Face.FRONT_AND_BACK,func:p.CompareFunction.ALWAYS,ref:0,mask:1};this.clearStencil=0;this.stencilWriteMask=1;this.stencilOperation={face:p.Face.FRONT_AND_BACK,fail:p.StencilOperation.KEEP,zFail:p.StencilOperation.KEEP,zPass:p.StencilOperation.KEEP};this.clearColor={r:0,g:0,b:0,a:0};this.copyWriteBuffer=this.copyReadBuffer=this.pixelUnpackBuffer=this.pixelPackBuffer=this.uniformBuffer=this.indexBuffer=this.vertexBuffer=this.program=null;this.uniformBufferBindingPoints=
[];this.renderbuffer=this.drawFramebuffer=this.readFramebuffer=null;this.activeTexture=0;this.textureUnitMap=[];this.vertexArrayObject=null};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/InstanceCounter":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../support/AllocationTracer","./enums"],function(m,p,D,B){const u={RECORD_ALLOCATIONS:!1};let t=function(){function h(){this._current=[];this._max=[];for(this._allocations=new D.AllocationTracer(u.RECORD_ALLOCATIONS);this._current.length<
B.ResourceType.COUNT;)this._current.push(0),this._max.push(0)}var l=h.prototype;l.resetMax=function(){for(this._max.length=0;this._max.length<this._current.length;)this._max.push(0)};l.increment=function(e,b){const d=++this._current[e];this._max[e]=Math.max(d,this._max[e]);this._allocations.add(b)};l.decrement=function(e,b){--this._current[e];this._allocations.remove(b)};p._createClass(h,[{key:"max",get:function(){return this._max}},{key:"current",get:function(){return this._current}},{key:"total",
get:function(){return this.current.reduce((e,b)=>e+b,0)}},{key:"resourceInformation",get:function(){let e="";if(0<this.total){e+="Live objects:\n";for(let b=0;b<B.ResourceType.COUNT;++b){const d=this._current[b];0<d&&(e+=`${B.ResourceType[b]}: ${d}\n`)}}return e+=this._allocations.information}}]);return h}();m.InstanceCounter=t;m.test=u;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/AllocationTracer":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers"],
function(m,p){let D=function(){function B(t){this._allocations=new Map;t?Error.stackTraceLimit=Infinity:(this.add=()=>{},this.remove=()=>{})}var u=B.prototype;u.add=function(t){this._allocations.set(t,Error().stack)};u.remove=function(t){this._allocations.delete(t)};p._createClass(B,[{key:"information",get:function(){let t="";if(0<this._allocations.size){t+=`${this._allocations.size} live object allocations:\n`;const h=new Map;this._allocations.forEach(l=>{h.set(l,(h.get(l)??0)+1)});h.forEach((l,
e)=>{e=e.split("\n");e.shift();e.shift();t+=`${l}: ${e.shift()}\n`;e.forEach(b=>t+=`   ${b}\n`)})}return t}}]);return B}();m.AllocationTracer=D;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/renderState":function(){define(["exports","../3d/webgl-engine/lib/basicInterfaces","./enums"],function(m,p,D){function B(M){return w.intern(M)}function u(M){return z.intern(M)}function t(M){return C.intern(M)}function h(M){return E.intern(M)}function l(M){return F.intern(M)}
function e(M){return G.intern(M)}function b(M){return H.intern(M)}function d(M){return L.intern(M)}function a(M){return"["+M.join(",")+"]"}function c(M){return M?a([M.srcRgb,M.srcAlpha,M.dstRgb,M.dstAlpha,M.opRgb,M.opAlpha,M.color.r,M.color.g,M.color.b,M.color.a]):null}function f(M){return M?a([M.face,M.mode]):null}function g(M){return M?a([M.factor,M.units]):null}function n(M){return M?a([M.func]):null}function k(M){return M?a([M.function.func,M.function.ref,M.function.mask,M.operation.fail,M.operation.zFail,
M.operation.zPass]):null}function x(M){return M?a([M.zNear,M.zFar]):null}function r(M){return M?a([M.r,M.g,M.b,M.a]):null}function v(M){return M?a([M.mask]):null}const q={face:D.Face.BACK,mode:D.CullMode.CCW},y={face:D.Face.FRONT,mode:D.CullMode.CCW};var A=function(){function M(U,T){this._makeKey=U;this._makeRef=T;this._interns=new Map}M.prototype.intern=function(U){if(!U)return null;const T=this._makeKey(U),Z=this._interns;Z.has(T)||Z.set(T,this._makeRef(U));return Z.get(T)??null};return M}();const w=
new A(c,M=>({__tag:"Blending",...M})),z=new A(f,M=>({__tag:"Culling",...M})),C=new A(g,M=>({__tag:"PolygonOffset",...M})),E=new A(n,M=>({__tag:"DepthTest",...M})),F=new A(k,M=>({__tag:"StencilTest",...M})),G=new A(x,M=>({__tag:"DepthWrite",...M})),H=new A(r,M=>({__tag:"ColorWrite",...M})),L=new A(v,M=>({__tag:"StencilWrite",...M})),K=new A(function(M){return M?a([c(M.blending),f(M.culling),g(M.polygonOffset),n(M.depthTest),k(M.stencilTest),x(M.depthWrite),r(M.colorWrite),v(M.stencilWrite)]):null},
M=>({blending:B(M.blending),culling:u(M.culling),polygonOffset:t(M.polygonOffset),depthTest:h(M.depthTest),stencilTest:l(M.stencilTest),depthWrite:e(M.depthWrite),colorWrite:b(M.colorWrite),stencilWrite:d(M.stencilWrite)}));A=function(){function M(T){this._stencilWriteInvalid=this._colorWriteInvalid=this._depthWriteInvalid=this._stencilTestInvalid=this._depthTestInvalid=this._polygonOffsetInvalid=this._cullingInvalid=this._blendingInvalid=this._pipelineInvalid=!0;this._stateSetters=T}var U=M.prototype;
U.setPipeline=function(T){if(this._pipelineInvalid||T!==this._pipeline)this._setBlending(T.blending),this._setCulling(T.culling),this._setPolygonOffset(T.polygonOffset),this._setDepthTest(T.depthTest),this._setStencilTest(T.stencilTest),this._setDepthWrite(T.depthWrite),this._setColorWrite(T.colorWrite),this._setStencilWrite(T.stencilWrite),this._pipeline=T;this._pipelineInvalid=!1};U.invalidateBlending=function(){this._pipelineInvalid=this._blendingInvalid=!0};U.invalidateCulling=function(){this._pipelineInvalid=
this._cullingInvalid=!0};U.invalidatePolygonOffset=function(){this._pipelineInvalid=this._polygonOffsetInvalid=!0};U.invalidateDepthTest=function(){this._pipelineInvalid=this._depthTestInvalid=!0};U.invalidateStencilTest=function(){this._pipelineInvalid=this._stencilTestInvalid=!0};U.invalidateDepthWrite=function(){this._pipelineInvalid=this._depthWriteInvalid=!0};U.invalidateColorWrite=function(){this._pipelineInvalid=this._colorWriteInvalid=!0};U.invalidateStencilWrite=function(){this._pipelineInvalid=
this._stencilTestInvalid=!0};U._setBlending=function(T){this._blending=this._setSubState(T,this._blending,this._blendingInvalid,this._stateSetters.setBlending);this._blendingInvalid=!1};U._setCulling=function(T){this._culling=this._setSubState(T,this._culling,this._cullingInvalid,this._stateSetters.setCulling);this._cullingInvalid=!1};U._setPolygonOffset=function(T){this._polygonOffset=this._setSubState(T,this._polygonOffset,this._polygonOffsetInvalid,this._stateSetters.setPolygonOffset);this._polygonOffsetInvalid=
!1};U._setDepthTest=function(T){this._depthTest=this._setSubState(T,this._depthTest,this._depthTestInvalid,this._stateSetters.setDepthTest);this._depthTestInvalid=!1};U._setStencilTest=function(T){this._stencilTest=this._setSubState(T,this._stencilTest,this._stencilTestInvalid,this._stateSetters.setStencilTest);this._stencilTestInvalid=!1};U._setDepthWrite=function(T){this._depthWrite=this._setSubState(T,this._depthWrite,this._depthWriteInvalid,this._stateSetters.setDepthWrite);this._depthWriteInvalid=
!1};U._setColorWrite=function(T){this._colorWrite=this._setSubState(T,this._colorWrite,this._colorWriteInvalid,this._stateSetters.setColorWrite);this._colorWriteInvalid=!1};U._setStencilWrite=function(T){this._stencilWrite=this._setSubState(T,this._stencilWrite,this._stencilWriteInvalid,this._stateSetters.setStencilWrite);this._stencilTestInvalid=!1};U._setSubState=function(T,Z,X,ca){if(X||T!==Z)ca(T),this._pipelineInvalid=!0;return T};return M}();m.StateTracker=A;m.backFaceCullingParams=q;m.cullingParams=
M=>M===p.CullFaceOptions.Back?q:M===p.CullFaceOptions.Front?y:null;m.defaultColorWriteParams={r:!0,g:!0,b:!0,a:!0};m.defaultDepthWriteParams={zNear:0,zFar:1};m.frontFaceCullingParams=y;m.makeBlending=B;m.makeColorWrite=b;m.makeCulling=u;m.makeDepthTest=h;m.makeDepthWrite=e;m.makePipelineState=function(M){return K.intern(M)};m.makePolygonOffset=t;m.makeStencilTest=l;m.makeStencilWrite=d;m.separateBlendingParams=function(M,U,T,Z,X=D.BlendOperation.ADD,ca=D.BlendOperation.ADD,P=[0,0,0,0]){return{srcRgb:M,
srcAlpha:U,dstRgb:T,dstAlpha:Z,opRgb:X,opAlpha:ca,color:{r:P[0],g:P[1],b:P[2],a:P[3]}}};m.simpleBlendingParams=function(M,U,T=D.BlendOperation.ADD,Z=[0,0,0,0]){return{srcRgb:M,srcAlpha:M,dstRgb:U,dstAlpha:U,opRgb:T,opAlpha:T,color:{r:Z[0],g:Z[1],b:Z[2],a:Z[3]}}};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/lib/basicInterfaces":function(){define(["exports"],function(m){m.CullFaceOptions=void 0;(function(p){p[p.None=0]="None";p[p.Front=1]="Front";p[p.Back=
2]="Back";p[p.COUNT=3]="COUNT"})(m.CullFaceOptions||(m.CullFaceOptions={}));m.DepthTestFunction=void 0;(function(p){p[p.Less=0]="Less";p[p.Lequal=1]="Lequal";p[p.COUNT=2]="COUNT"})(m.DepthTestFunction||(m.DepthTestFunction={}));m.RenderRequestType=void 0;(function(p){p[p.BACKGROUND=0]="BACKGROUND";p[p.UPDATE=1]="UPDATE"})(m.RenderRequestType||(m.RenderRequestType={}));m.ResourceState=void 0;(function(p){p[p.NOT_LOADED=0]="NOT_LOADED";p[p.LOADING=1]="LOADING";p[p.LOADED=2]="LOADED"})(m.ResourceState||
(m.ResourceState={}));m.StencilBits=void 0;(function(p){p[p.IntegratedMeshMaskExcluded=1]="IntegratedMeshMaskExcluded";p[p.OutlineVisualElementMask=2]="OutlineVisualElementMask"})(m.StencilBits||(m.StencilBits={}));m.Object3DState=void 0;(function(p){p[p.Highlight=0]="Highlight";p[p.MaskOccludee=1]="MaskOccludee";p[p.COUNT=2]="COUNT"})(m.Object3DState||(m.Object3DState={}));m.PowerOfTwoResizeMode=void 0;(function(p){p[p.STRETCH=1]="STRETCH";p[p.PAD=2]="PAD"})(m.PowerOfTwoResizeMode||(m.PowerOfTwoResizeMode=
{}));m.ValidationState=void 0;(function(p){p[p.CHANGED=0]="CHANGED";p[p.UNCHANGED=1]="UNCHANGED"})(m.ValidationState||(m.ValidationState={}));m.AlphaDiscardMode=void 0;(function(p){p[p.Blend=0]="Blend";p[p.Opaque=1]="Opaque";p[p.Mask=2]="Mask";p[p.MaskBlend=3]="MaskBlend";p[p.COUNT=4]="COUNT"})(m.AlphaDiscardMode||(m.AlphaDiscardMode={}));m.Decorations=void 0;(function(p){p[p.OFF=0]="OFF";p[p.ON=1]="ON"})(m.Decorations||(m.Decorations={}));m.TextureEncodingMimeType=void 0;(function(p){p.DDS_ENCODING=
"image/vnd-ms.dds";p.KTX2_ENCODING="image/ktx2";p.BASIS_ENCODING="image/x.basis"})(m.TextureEncodingMimeType||(m.TextureEncodingMimeType={}));Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/WebGLDriverTest":function(){define("exports ./testAppleAmdDrawArrays ./testDoublePrecisionArithmetic ./testFloatBufferBlend ./testSamplerPrecision ./testSVGPremultipliedAlpha".split(" "),function(m,p,D,B,u,t){let h=function(){function l(e){this.rctx=e;this.floatBufferBlend=new B.FloatBufferBlend(e);
this.svgPremultipliesAlpha=new t.SVGPremultipliedAlpha(e);this.doublePrecisionRequiresObfuscation=new D.DoublePrecisionRequiresObfuscation(e);this.ignoresSamplerPrecision=new u.IgnoresSamplerPrecision(e);this.drawArraysRequiresIndicesTypeReset=new p.DrawArraysRequiresIndicesTypeReset(e)}l.prototype.dispose=function(){this.ignoresSamplerPrecision.dispose();this.doublePrecisionRequiresObfuscation.dispose();this.svgPremultipliesAlpha.dispose();this.floatBufferBlend.dispose();this.drawArraysRequiresIndicesTypeReset.dispose()};
return l}();m.WebGLDriverTest=h;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/testAppleAmdDrawArrays":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/has ../3d/webgl-engine/core/shaderModules/interfaces ./BufferObject ./context-util ./enums ./FramebufferObject ./WebGLDriverTestModule".split(" "),function(m,p,D,B,u,t,h,l,e){e=function(b){function d(c){var f=b.call(this)||this;f._rctx=c;f._dummyProgram=null;f._rctx.type===t.ContextType.WEBGL2&&
D("mac")&&D("chrome")&&(f._program=f._prepareProgram(),f._dummyProgram=f._prepareDummyProgram());return f}p._inheritsLoose(d,b);var a=d.prototype;a.dispose=function(){b.prototype.dispose.call(this);this._dummyProgram?.dispose();this._dummyProgram=null};a._test=function(c){const f=this._rctx;f.resetState();const g=new l.FramebufferObject(f,{colorTarget:h.TargetType.TEXTURE,depthStencilTarget:h.DepthStencilTargetType.NONE},{target:h.TextureType.TEXTURE_2D,wrapMode:h.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:h.PixelFormat.RGBA,
dataType:h.PixelType.UNSIGNED_BYTE,samplingMode:h.TextureSamplingMode.NEAREST,width:1,height:1}),n=u.BufferObject.createIndex(this._rctx,h.Usage.STATIC_DRAW,new Uint8Array([0]));f.bindFramebuffer(g);f.setViewport(0,0,1,1);f.useProgram(this._dummyProgram);f.bindBuffer(n,h.BufferType.ELEMENT_ARRAY_BUFFER);f.drawElements(h.PrimitiveType.POINTS,1,h.DataType.UNSIGNED_BYTE,0);f.useProgram(c);f.bindVAO(null);f.drawArrays(h.PrimitiveType.TRIANGLES,0,258);c=new Uint8Array(4);g.readPixels(0,0,1,1,h.PixelFormat.RGBA,
h.PixelType.UNSIGNED_BYTE,c);g.dispose();n.dispose();return 255===c[0]};a._prepareProgram=function(){const c=`\n    precision highp float;\n\n    varying float triangleId;\n\n    const vec3 triangleVertices[3] = vec3[3](vec3(-0.5, -0.5, 0.0), vec3(0.5, -0.5, 0.0), vec3(0.0, 0.5, 0.0));\n\n    void main(void) {\n      triangleId = floor(float(gl_VertexID)/3.0);\n\n      vec3 position = triangleVertices[gl_VertexID % 3];\n      float offset = triangleId / ${B.glsl.float(85)};\n      position.z = 0.5 - offset;\n\n      gl_Position = vec4(position, 1.0);\n    }\n    `,
f=`\n    precision highp float;\n\n    varying float triangleId;\n\n    void main(void) {\n      gl_FragColor = triangleId == ${B.glsl.float(85)} ? vec4(0.0, 1.0, 0.0, 1.0) : vec4(1.0, 0.0, 0.0, 1.0);\n    }\n    `;return this._rctx.programCache.acquire(c,f,new Map([]))};a._prepareDummyProgram=function(){return this._rctx.programCache.acquire("\n    void main(void) {\n      gl_Position \x3d vec4(0.0, 0.0, float(gl_VertexID)-2.0, 1.0);\n    }","\n    void main(void) {\n      gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 1.0);\n    }",
new Map([]))};return d}(e.WebGLDriverTestModule);m.DrawArraysRequiresIndicesTypeReset=e;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/core/shaderModules/interfaces":function(){define(["exports"],function(m){function p(D,...B){let u="";for(let t=0;t<B.length;t++)u+=D[t]+B[t];return u+=D[D.length-1]}(function(D){D.int=function(B){return Math.round(B).toString()};D.float=function(B){return B.toPrecision(8)}})(p||(p={}));m.NoParameters=function(){};m.glsl=
p;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/WebGLDriverTestModule":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../core/maybe"],function(m,p,D){let B=function(){function u(){this._result=!1}u.prototype.dispose=function(){this._program=D.disposeMaybe(this._program)};p._createClass(u,[{key:"result",get:function(){D.isSome(this._program)&&(this._result=this._test(this._program),this.dispose());return this._result}}]);return u}();m.WebGLDriverTestModule=
B;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/testDoublePrecisionArithmetic":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/floatRGBA ../../core/has ../../core/maybe ../../chunks/vec3f64 ./BufferObject ./doublePrecisionUtils ./enums ./FramebufferObject ./VertexArrayObject ./VertexElementDescriptor ./WebGLDriverTestModule".split(" "),function(m,p,D,B,u,t,h,l,e,b,d,a,c){function f(g,n){return g.programCache.acquire(`\n\n  precision highp float;\n\n  attribute vec2 position;\n\n  uniform vec3 u_highA;\n  uniform vec3 u_lowA;\n  uniform vec3 u_highB;\n  uniform vec3 u_lowB;\n\n  varying vec4 v_color;\n\n  ${n?
"#define DOUBLE_PRECISION_REQUIRES_OBFUSCATION":""}\n\n  #ifdef DOUBLE_PRECISION_REQUIRES_OBFUSCATION\n\n  vec3 dpPlusFrc(vec3 a, vec3 b) {\n    return mix(a, a + b, vec3(notEqual(b, vec3(0))));\n  }\n\n  vec3 dpMinusFrc(vec3 a, vec3 b) {\n    return mix(vec3(0), a - b, vec3(notEqual(a, b)));\n  }\n\n  vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\n    vec3 t1 = dpPlusFrc(hiA, hiB);\n    vec3 e = dpMinusFrc(t1, hiA);\n    vec3 t2 = dpMinusFrc(hiB, e) + dpMinusFrc(hiA, dpMinusFrc(t1, e)) + loA + loB;\n    return t1 + t2;\n  }\n\n  #else\n\n  vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\n    vec3 t1 = hiA + hiB;\n    vec3 e = t1 - hiA;\n    vec3 t2 = ((hiB - e) + (hiA - (t1 - e))) + loA + loB;\n    return t1 + t2;\n  }\n\n  #endif\n\n  const float MAX_RGBA_FLOAT =\n    255.0 / 256.0 +\n    255.0 / 256.0 / 256.0 +\n    255.0 / 256.0 / 256.0 / 256.0 +\n    255.0 / 256.0 / 256.0 / 256.0 / 256.0;\n\n  const vec4 FIXED_POINT_FACTORS = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);\n\n  vec4 float2rgba(const float value) {\n    // Make sure value is in the domain we can represent\n    float valueInValidDomain = clamp(value, 0.0, MAX_RGBA_FLOAT);\n\n    // Decompose value in 32bit fixed point parts represented as\n    // uint8 rgba components. Decomposition uses the fractional part after multiplying\n    // by a power of 256 (this removes the bits that are represented in the previous\n    // component) and then converts the fractional part to 8bits.\n    vec4 fixedPointU8 = floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);\n\n    // Convert uint8 values (from 0 to 255) to floating point representation for\n    // the shader\n    const float toU8AsFloat = 1.0 / 255.0;\n\n    return fixedPointU8 * toU8AsFloat;\n  }\n\n  void main() {\n    vec3 val = dpAdd(u_highA, u_lowA, -u_highB, -u_lowB);\n\n    v_color = float2rgba(val.z / 25.0);\n\n    gl_Position = vec4(position * 2.0 - 1.0, 0.0, 1.0);\n  }\n  `,
"\n  precision highp float;\n\n  varying vec4 v_color;\n\n  void main() {\n    gl_FragColor \x3d v_color;\n  }\n  ",new Map([["position",0]]))}c=function(g){function n(x){var r=g.call(this)||this;r._rctx=x;r._program=f(r._rctx,!1);r._obfuscated=f(r._rctx,!0);return r}p._inheritsLoose(n,g);var k=n.prototype;k.dispose=function(){g.prototype.dispose.call(this);this._obfuscated=u.disposeMaybe(this._obfuscated)};k._test=function(x){if(B("force-double-precision-obfuscation"))return!0;if(u.isNone(this._obfuscated))return!1;
x=this._runProgram(x);const r=this._runProgram(this._obfuscated);return 0!==x&&(0===r||5<x/r)};k._runProgram=function(x){const r=this._rctx;r.resetState();var v=new b.FramebufferObject(r,{colorTarget:e.TargetType.TEXTURE,depthStencilTarget:e.DepthStencilTargetType.NONE},{target:e.TextureType.TEXTURE_2D,wrapMode:e.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:e.PixelFormat.RGBA,dataType:e.PixelType.UNSIGNED_BYTE,samplingMode:e.TextureSamplingMode.NEAREST,width:1,height:1}),q=h.BufferObject.createVertex(r,
e.Usage.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1]));const y=new d.VertexArrayObject(r,new Map([["position",0]]),{geometry:[new a.VertexElementDescriptor("position",2,e.DataType.UNSIGNED_SHORT,0,4)]},{geometry:q}),A=t.fromValues(5633261.287538229,2626832.878767164,1434988.0495278358),w=t.fromValues(5633271.46742708,2626873.6381334523,1434963.231608387),z=new Float32Array(6);l.encodeDoubleArray(A,z,3);const C=new Float32Array(6);l.encodeDoubleArray(w,C,3);r.useProgram(x);x.setUniform3f("u_highA",
z[0],z[2],z[4]);x.setUniform3f("u_lowA",z[1],z[3],z[5]);x.setUniform3f("u_highB",C[0],C[2],C[4]);x.setUniform3f("u_lowB",C[1],C[3],C[5]);r.bindFramebuffer(v);r.setViewport(0,0,1,1);r.bindVAO(y);r.drawArrays(e.PrimitiveType.TRIANGLE_STRIP,0,4);x=new Uint8Array(4);v.readPixels(0,0,1,1,e.PixelFormat.RGBA,e.PixelType.UNSIGNED_BYTE,x);y.dispose(!1);q.dispose();v.dispose();v=(A[2]-w[2])/25;q=D.unpackFloatRGBA(x);return Math.abs(v-q)};return n}(c.WebGLDriverTestModule);m.DoublePrecisionRequiresObfuscation=
c;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/doublePrecisionUtils":function(){define(["exports"],function(m){const p=new Float32Array(2);m.decodeDoubleArray=function(D,B,u){for(let t=0;t<u;++t)B[t]=D[2*t]+D[2*t+1]};m.encodeDoubleArray=function(D,B,u){for(let t=0;t<u;++t)B[2*t]=D[t],B[2*t+1]=D[t]-B[2*t]};m.encodeDoubleHi=function(D,B){const u=D.length;for(let t=0;t<u;++t)p[0]=D[t],B[t]=p[0];return B};m.encodeDoubleLo=function(D,B){const u=D.length;for(let t=0;t<
u;++t)p[0]=D[t],p[1]=D[t]-p[0],B[t]=p[1];return B};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/testFloatBufferBlend":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../3d/webgl-engine/lib/OrderIndependentTransparency ../../chunks/webgl-debug ./BufferObject ./context-util ./enums ./FramebufferObject ./renderState ./VertexArrayObject ./VertexElementDescriptor ./WebGLDriverTestModule".split(" "),function(m,p,D,B,u,t,h,l,e,b,d,a){a=function(c){function f(g){var n=
c.call(this)||this;n._rctx=g;if(!g.gl)return p._assertThisInitialized(n);if(g.type===t.ContextType.WEBGL1)return n._result=!(!g.capabilities.textureFloat?.textureFloat||!g.capabilities.colorBufferFloat?.textureFloat),p._assertThisInitialized(n);if(!(g.capabilities.textureFloat?.textureFloat&&g.capabilities.colorBufferFloat?.textureFloat&&g.capabilities.colorBufferFloat?.floatBlend))return p._assertThisInitialized(n);n._program=g.programCache.acquire("\n    precision highp float;\n    attribute vec2 a_pos;\n\n    void main() {\n      gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n    }\n    ",
"\n     precision highp float;\n\n     void main() {\n      gl_FragColor \x3d vec4(0.5, 0.5, 0.5, 0.5);\n     }\n    ",new Map([["a_pos",0]]));return n}p._inheritsLoose(f,c);f.prototype._test=function(g){const n=this._rctx,k=new l.FramebufferObject(n,{colorTarget:h.TargetType.TEXTURE,depthStencilTarget:h.DepthStencilTargetType.NONE},{target:h.TextureType.TEXTURE_2D,wrapMode:h.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:h.PixelFormat.RGBA,dataType:h.PixelType.FLOAT,internalFormat:h.SizedPixelFormat.RGBA32F,
samplingMode:h.TextureSamplingMode.NEAREST,width:1,height:1}),x=u.BufferObject.createVertex(n,h.Usage.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),r=new b.VertexArrayObject(n,new Map([["a_pos",0]]),{geometry:[new d.VertexElementDescriptor("a_pos",2,h.DataType.UNSIGNED_SHORT,0,4)]},{geometry:x});n.useProgram(g);g=n.getBoundFramebufferObject();const {x:v,y:q,width:y,height:A}=n.getViewport();n.bindFramebuffer(k);n.setViewport(0,0,1,1);n.bindVAO(r);n.drawArrays(h.PrimitiveType.TRIANGLE_STRIP,0,4);
var w=e.makePipelineState({blending:D.blendingAlpha});n.setPipelineState(w);n.drawArrays(h.PrimitiveType.TRIANGLE_STRIP,0,4);B.webglDebugExports.init(n);w=n.gl.getError();n.setViewport(v,q,y,A);n.bindFramebuffer(g);r.dispose(!1);x.dispose();k.dispose();return 1282===w?(console.warn("Device claims support for WebGL extension EXT_float_blend but does not support it. Using fall back."),!1):!0};return f}(a.WebGLDriverTestModule);m.FloatBufferBlend=a;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},
"esri/views/3d/webgl-engine/lib/OrderIndependentTransparency":function(){define(["exports","./TransparencyPassType","../../../webgl/enums","../../../webgl/renderState"],function(m,p,D,B){const u=B.separateBlendingParams(D.BlendFactor.SRC_ALPHA,D.BlendFactor.ONE,D.BlendFactor.ONE_MINUS_SRC_ALPHA,D.BlendFactor.ONE_MINUS_SRC_ALPHA),t=B.simpleBlendingParams(D.BlendFactor.ONE,D.BlendFactor.ONE),h=B.simpleBlendingParams(D.BlendFactor.ZERO,D.BlendFactor.ONE_MINUS_SRC_ALPHA),l={factor:-1,units:-2};m.OITPolygonOffset=
l;m.OITPolygonOffsetLimit=5E5;m.blendingAlpha=h;m.blendingColor=t;m.blendingDefault=u;m.getOITPolygonOffset=function(e){return e?l:null};m.oitBlending=function(e){return e===p.TransparencyPassType.FrontFace?null:e===p.TransparencyPassType.Alpha?h:t};m.oitDepthTest=function(e,b=D.CompareFunction.LESS){return e===p.TransparencyPassType.NONE||e===p.TransparencyPassType.FrontFace?b:D.CompareFunction.LEQUAL};m.oitDepthWrite=function(e){return e===p.TransparencyPassType.FrontFace?B.defaultDepthWriteParams:
null};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/lib/TransparencyPassType":function(){define(["exports"],function(m){m.TransparencyPassType=void 0;var p=m.TransparencyPassType||(m.TransparencyPassType={});p[p.Color=0]="Color";p[p.Alpha=1]="Alpha";p[p.FrontFace=2]="FrontFace";p[p.NONE=3]="NONE";p[p.COUNT=4]="COUNT";Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/webgl-debug":function(){define(["exports"],function(m){m.webglDebugExports=
{};(function(p){(function(D){D=D();void 0!==D&&(p.exports=D)})(function(){function D(c){if(null==d){d={};a={};for(var f in c)"number"==typeof c[f]&&(d[c[f]]=f,a[f]=c[f])}}function B(){if(null==d)throw"WebGLDebugUtils.init(ctx) not called";}function u(c){B();var f=d[c];return void 0!==f?"gl."+f:"/*UNKNOWN WebGL ENUM*/ 0x"+c.toString(16)}function t(c,f,g,n){c=b[c];if(void 0!==c&&(c=c[f],void 0!==c&&c[g])){if("object"===typeof c[g]&&void 0!==c[g].enumBitwiseOr){f=c[g].enumBitwiseOr;g=0;c=[];for(var k=
0;k<f.length;++k){var x=a[f[k]];0!==(n&x)&&(g|=x,c.push(u(x)))}return g===n?c.join(" | "):u(n)}return u(n)}return null===n?"null":void 0===n?"undefined":n.toString()}function h(c,f,g){c.__defineGetter__(g,function(){return f[g]});c.__defineSetter__(g,function(n){f[g]=n})}function l(c,f,g,n){function k(y,A){return function(){g&&g(A,arguments);var w=y[A].apply(y,arguments),z=n.getError();0!=z&&(x[z]=!0,f(z,A,arguments));return w}}n=n||c;D(c);f=f||function(y,A,w){for(var z="",C=w.length,E=0;E<C;++E)z+=
(0==E?"":", ")+t(A,C,E,w[E]);y="WebGL error "+u(y)+" in "+A+"("+z+")";window.console&&window.console.error?window.console.error(y):window.console&&window.console.log&&window.console.log(y)};var x={},r={},v;for(v in c)if("function"==typeof c[v])if("getExtension"!=v)r[v]=k(c,v);else{var q=k(c,v);r[v]=function(){var y=q.apply(c,arguments);return l(y,f,g,n)}}else h(r,c,v);r.getError=function(){for(var y in x)if(x.hasOwnProperty(y)&&x[y])return x[y]=!1,y;return c.NO_ERROR};return r}function e(c){var f=
c.getParameter(c.MAX_VERTEX_ATTRIBS),g=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,g);for(var n=0;n<f;++n)c.disableVertexAttribArray(n),c.vertexAttribPointer(n,4,c.FLOAT,!1,0,0),c.vertexAttrib1f(n,0);c.deleteBuffer(g);f=c.getParameter(c.MAX_TEXTURE_IMAGE_UNITS);for(n=0;n<f;++n)c.activeTexture(c.TEXTURE0+n),c.bindTexture(c.TEXTURE_CUBE_MAP,null),c.bindTexture(c.TEXTURE_2D,null);c.activeTexture(c.TEXTURE0);c.useProgram(null);c.bindBuffer(c.ARRAY_BUFFER,null);c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,null);
c.bindFramebuffer(c.FRAMEBUFFER,null);c.bindRenderbuffer(c.RENDERBUFFER,null);c.disable(c.BLEND);c.disable(c.CULL_FACE);c.disable(c.DEPTH_TEST);c.disable(c.DITHER);c.disable(c.SCISSOR_TEST);c.blendColor(0,0,0,0);c.blendEquation(c.FUNC_ADD);c.blendFunc(c.ONE,c.ZERO);c.clearColor(0,0,0,0);c.clearDepth(1);c.clearStencil(-1);c.colorMask(!0,!0,!0,!0);c.cullFace(c.BACK);c.depthFunc(c.LESS);c.depthMask(!0);c.depthRange(0,1);c.frontFace(c.CCW);c.hint(c.GENERATE_MIPMAP_HINT,c.DONT_CARE);c.lineWidth(1);c.pixelStorei(c.PACK_ALIGNMENT,
4);c.pixelStorei(c.UNPACK_ALIGNMENT,4);c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,!1);c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1);c.UNPACK_COLORSPACE_CONVERSION_WEBGL&&c.pixelStorei(c.UNPACK_COLORSPACE_CONVERSION_WEBGL,c.BROWSER_DEFAULT_WEBGL);c.polygonOffset(0,0);c.sampleCoverage(1,!1);c.scissor(0,0,c.canvas.width,c.canvas.height);c.stencilFunc(c.ALWAYS,0,4294967295);c.stencilMask(4294967295);c.stencilOp(c.KEEP,c.KEEP,c.KEEP);c.viewport(0,0,c.canvas.width,c.canvas.height);for(c.clear(c.COLOR_BUFFER_BIT|
c.DEPTH_BUFFER_BIT|c.STENCIL_BUFFER_BIT);c.getError(););}var b={enable:{1:{0:!0}},disable:{1:{0:!0}},getParameter:{1:{0:!0}},drawArrays:{3:{0:!0}},drawElements:{4:{0:!0,2:!0}},createShader:{1:{0:!0}},getShaderParameter:{2:{1:!0}},getProgramParameter:{2:{1:!0}},getShaderPrecisionFormat:{2:{0:!0,1:!0}},getVertexAttrib:{2:{1:!0}},vertexAttribPointer:{6:{2:!0}},bindTexture:{2:{0:!0}},activeTexture:{1:{0:!0}},getTexParameter:{2:{0:!0,1:!0}},texParameterf:{3:{0:!0,1:!0}},texParameteri:{3:{0:!0,1:!0,2:!0}},
texImage2D:{9:{0:!0,2:!0,6:!0,7:!0},6:{0:!0,2:!0,3:!0,4:!0}},texSubImage2D:{9:{0:!0,6:!0,7:!0},7:{0:!0,4:!0,5:!0}},copyTexImage2D:{8:{0:!0,2:!0}},copyTexSubImage2D:{8:{0:!0}},generateMipmap:{1:{0:!0}},compressedTexImage2D:{7:{0:!0,2:!0}},compressedTexSubImage2D:{8:{0:!0,6:!0}},bindBuffer:{2:{0:!0}},bufferData:{3:{0:!0,2:!0}},bufferSubData:{3:{0:!0}},getBufferParameter:{2:{0:!0,1:!0}},pixelStorei:{2:{0:!0,1:!0}},readPixels:{7:{4:!0,5:!0}},bindRenderbuffer:{2:{0:!0}},bindFramebuffer:{2:{0:!0}},checkFramebufferStatus:{1:{0:!0}},
framebufferRenderbuffer:{4:{0:!0,1:!0,2:!0}},framebufferTexture2D:{5:{0:!0,1:!0,2:!0}},getFramebufferAttachmentParameter:{3:{0:!0,1:!0,2:!0}},getRenderbufferParameter:{2:{0:!0,1:!0}},renderbufferStorage:{4:{0:!0,1:!0}},clear:{1:{0:{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]}}},depthFunc:{1:{0:!0}},blendFunc:{2:{0:!0,1:!0}},blendFuncSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},blendEquation:{1:{0:!0}},blendEquationSeparate:{2:{0:!0,1:!0}},stencilFunc:{3:{0:!0}},stencilFuncSeparate:{4:{0:!0,
1:!0}},stencilMaskSeparate:{2:{0:!0}},stencilOp:{3:{0:!0,1:!0,2:!0}},stencilOpSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},cullFace:{1:{0:!0}},frontFace:{1:{0:!0}},drawArraysInstancedANGLE:{4:{0:!0}},drawElementsInstancedANGLE:{5:{0:!0,2:!0}},blendEquationEXT:{1:{0:!0}}},d=null,a=null;return{init:D,mightBeEnum:function(c){B();return void 0!==d[c]},glEnumToString:u,glFunctionArgToString:t,glFunctionArgsToString:function(c,f){for(var g="",n=f.length,k=0;k<n;++k)g+=(0==k?"":", ")+t(c,n,k,f[k]);return g},makeDebugContext:l,
makeLostContextSimulatingCanvas:function(c){function f(K){return"function"==typeof K?K:function(M){K.handleEvent(M)}}function g(){for(var K=Object.keys(L),M=0;M<K.length;++M)delete L[K]}function n(){++F;z||E==F&&c.loseContext()}function k(K,M){var U=K[M];return function(){n();if(!z)return U.apply(K,arguments)}}function x(K){return{statusMessage:K,preventDefault:function(){G=!0}}}function r(K){for(var M in K)"function"==typeof K[M]?A[M]=k(K,M):h(A,K,M);A.getError=function(){n();if(!z)for(var Z;Z=v.getError();)L[Z]=
!0;for(Z in L)if(L[Z])return delete L[Z],Z;return A.NO_ERROR};var U="createBuffer createFramebuffer createProgram createRenderbuffer createShader createTexture".split(" ");for(M=0;M<U.length;++M){var T=U[M];A[T]=function(Z){return function(){n();if(z)return null;var X=Z.apply(K,arguments);X.__webglDebugContextLostId__=w;C.push(X);return X}}(K[T])}U="getActiveAttrib getActiveUniform getBufferParameter getContextAttributes getAttachedShaders getFramebufferAttachmentParameter getParameter getProgramParameter getProgramInfoLog getRenderbufferParameter getShaderParameter getShaderInfoLog getShaderSource getTexParameter getUniform getUniformLocation getVertexAttrib".split(" ");
for(M=0;M<U.length;++M)T=U[M],A[T]=function(Z){return function(){n();return z?null:Z.apply(K,arguments)}}(A[T]);U="isBuffer isEnabled isFramebuffer isProgram isRenderbuffer isShader isTexture".split(" ");for(M=0;M<U.length;++M)T=U[M],A[T]=function(Z){return function(){n();return z?!1:Z.apply(K,arguments)}}(A[T]);A.checkFramebufferStatus=function(Z){return function(){n();return z?A.FRAMEBUFFER_UNSUPPORTED:Z.apply(K,arguments)}}(A.checkFramebufferStatus);A.getAttribLocation=function(Z){return function(){n();
return z?-1:Z.apply(K,arguments)}}(A.getAttribLocation);A.getVertexAttribOffset=function(Z){return function(){n();return z?0:Z.apply(K,arguments)}}(A.getVertexAttribOffset);A.isContextLost=function(){return z};return A}var v,q=[],y=[];var A={};var w=1,z=!1,C=[],E=0,F=0,G=!1,H=0,L={};c.getContext=function(K){return function(){var M=K.apply(c,arguments);if(M instanceof WebGLRenderingContext){if(M!=v){if(v)throw"got different context";v=M;A=r(v)}return A}return M}}(c.getContext);(function(K){var M=K.addEventListener;
K.addEventListener=function(U,T,Z){switch(U){case "webglcontextlost":q.push(f(T));break;case "webglcontextrestored":y.push(f(T));break;default:M.apply(K,arguments)}}})(c);c.loseContext=function(){if(!z){z=!0;E=0;for(++w;v.getError(););g();L[v.CONTEXT_LOST_WEBGL]=!0;var K=x("context lost"),M=q.slice();setTimeout(function(){for(var U=0;U<M.length;++U)M[U](K);0<=H&&setTimeout(function(){c.restoreContext()},H)},0)}};c.restoreContext=function(){z&&y.length&&setTimeout(function(){if(!G)throw"can not restore. webglcontestlost listener did not call event.preventDefault";
for(var K=0;K<C.length;++K){var M=C[K];M instanceof WebGLBuffer?v.deleteBuffer(M):M instanceof WebGLFramebuffer?v.deleteFramebuffer(M):M instanceof WebGLProgram?v.deleteProgram(M):M instanceof WebGLRenderbuffer?v.deleteRenderbuffer(M):M instanceof WebGLShader?v.deleteShader(M):M instanceof WebGLTexture&&v.deleteTexture(M)}e(v);z=!1;F=0;G=!1;K=y.slice();M=x("context restored");for(var U=0;U<K.length;++U)K[U](M)},0)};c.loseContextInNCalls=function(K){if(z)throw"You can not ask a lost contet to be lost";
E=F+K};c.getNumCalls=function(){return F};c.setRestoreTimeout=function(K){H=K};return c},resetToInitialState:e}})})({get exports(){return m.webglDebugExports},set exports(p){m.webglDebugExports=p}})})},"esri/views/webgl/testSamplerPrecision":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/Logger ./BufferObject ./enums ./FramebufferObject ./Texture ./VertexArrayObject ./VertexElementDescriptor ./WebGLDriverTestModule".split(" "),function(m,p,D,B,u,t,h,l,e,b){b=function(d){function a(c){var f=
d.call(this)||this;f._rctx=c;f._program=c.programCache.acquire("\n      precision highp float;\n      attribute vec2 a_pos;\n      uniform highp sampler2D u_texture;\n      varying vec4 v_color;\n\n      float getBit(in float bitset, in int bitIndex) {\n        float offset \x3d pow(2.0, float(bitIndex));\n        return mod(floor(bitset / offset), 2.0);\n      }\n\n      void main() {\n        vec4 value \x3d texture2D(u_texture, vec2(0.0));\n        float bit \x3d getBit(value.x * 255.0, 1);\n\n        v_color \x3d bit * vec4(1.0);\n        gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n      }\n      ",
"\n      precision highp float;\n      varying vec4 v_color;\n\n      void main() {\n        gl_FragColor \x3d v_color;\n      }\n      ",new Map([["a_pos",0]]));return f}p._inheritsLoose(a,d);a.prototype._test=function(c){const f=this._rctx,g=new t.FramebufferObject(f,{colorTarget:u.TargetType.TEXTURE,depthStencilTarget:u.DepthStencilTargetType.NONE},{target:u.TextureType.TEXTURE_2D,wrapMode:u.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:u.PixelFormat.RGBA,dataType:u.PixelType.UNSIGNED_BYTE,samplingMode:u.TextureSamplingMode.NEAREST,
width:1,height:1}),n=new Uint8Array(4),k=B.BufferObject.createVertex(f,u.Usage.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),x=new l.VertexArrayObject(f,new Map([["a_position",0]]),{geometry:[new e.VertexElementDescriptor("a_position",2,u.DataType.SHORT,0,4)]},{geometry:k});f.useProgram(c);var r=new h.Texture(f,{target:u.TextureType.TEXTURE_2D,wrapMode:u.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:u.PixelFormat.RGBA,dataType:u.PixelType.UNSIGNED_BYTE,samplingMode:u.TextureSamplingMode.NEAREST,width:1,
height:1},new Uint8Array([2,255,0,0]));c.setUniform1i("u_texture",0);f.bindTexture(r,0);r=f.getBoundFramebufferObject();f.bindFramebuffer(g);f.useProgram(c);const {x:v,y:q,width:y,height:A}=f.getViewport();f.setViewport(0,0,1,1);f.bindVAO(x);f.drawArrays(u.PrimitiveType.TRIANGLE_STRIP,0,4);f.setViewport(v,q,y,A);g.readPixels(0,0,1,1,u.PixelFormat.RGBA,u.PixelType.UNSIGNED_BYTE,n);x.dispose(!1);k.dispose();g.dispose();(c=255!==n[0]||255!==n[1]||255!==n[2]||255!==n[3])&&D.getLogger("esri.views.webgl.testSamplerPrecision").warn(`A problem was detected with your graphics driver. Your driver does not appear to honor sampler precision specifiers, which may result in rendering issues due to numerical instability. We recommend ensuring that your drivers have been updated to the latest version. Applying lowp sampler workaround. [${n[0]}.${n[1]}.${n[2]}.${n[3]}]`);
f.bindFramebuffer(r);return c};return a}(b.WebGLDriverTestModule);m.IgnoresSamplerPrecision=b;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/testSVGPremultipliedAlpha":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../2d/engine/webgl/DefaultVertexAttributeLayouts ./BufferObject ./enums ./FramebufferObject ./Texture ./VertexArrayObject ./WebGLDriverTestModule".split(" "),function(m,p,D,B,u,t,h,l,e){e=function(b){function d(c){var f=b.call(this)||
this;f._rctx=c;f._image=new Image;f._image.src="data:image/svg+xml,%3C%3Fxml version\x3d'1.0' encoding\x3d'UTF-8'%3F%3E%3Csvg width\x3d'5' height\x3d'5' version\x3d'1.1' viewBox\x3d'0 0 5 5' xmlns\x3d'http://www.w3.org/2000/svg'%3E%3Crect width\x3d'5' height\x3d'5' fill\x3d'%23f00' fill-opacity\x3d'.5'/%3E%3C/svg%3E%0A";f._image.width=5;f._image.height=5;f._image.decode();f._program=c.programCache.acquire("\n    precision highp float;\n\n    attribute vec2 a_pos;\n    varying vec2 v_uv;\n\n    void main() {\n      v_uv \x3d a_pos;\n      gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n    }\n    ",
"\n    precision highp float;\n\n    varying vec2 v_uv;\n    uniform sampler2D u_texture;\n\n    void main() {\n      gl_FragColor \x3d texture2D(u_texture, v_uv);\n    }\n    ",new Map([["a_pos",0]]));return f}p._inheritsLoose(d,b);var a=d.prototype;a.dispose=function(){b.prototype.dispose.call(this);this._image.src=""};a._test=function(c){const f=this._rctx;if(!f.gl)return c.dispose(),!0;const g=new t.FramebufferObject(f,{colorTarget:u.TargetType.TEXTURE,depthStencilTarget:u.DepthStencilTargetType.NONE},
{target:u.TextureType.TEXTURE_2D,wrapMode:u.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:u.PixelFormat.RGBA,dataType:u.PixelType.UNSIGNED_BYTE,samplingMode:u.TextureSamplingMode.NEAREST,width:1,height:1}),n=B.BufferObject.createVertex(f,u.Usage.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),k=new l.VertexArrayObject(f,new Map([["a_pos",0]]),D.Pos2us,{geometry:n}),x=new h.Texture(f,{dataType:u.PixelType.UNSIGNED_BYTE,pixelFormat:u.PixelFormat.RGBA,preMultiplyAlpha:!1,wrapMode:u.TextureWrapMode.CLAMP_TO_EDGE,
samplingMode:u.TextureSamplingMode.LINEAR},this._image);f.useProgram(c);f.bindTexture(x,0);c.setUniform1i("u_texture",0);c=f.getBoundFramebufferObject();const {x:r,y:v,width:q,height:y}=f.getViewport();f.bindFramebuffer(g);f.setViewport(0,0,1,1);f.setClearColor(0,0,0,0);f.setBlendingEnabled(!1);f.clearSafe(u.ClearBufferBit.COLOR_BUFFER_BIT);f.bindVAO(k);f.drawArrays(u.PrimitiveType.TRIANGLE_STRIP,0,4);const A=new Uint8Array(4);g.readPixels(0,0,1,1,u.PixelFormat.RGBA,u.PixelType.UNSIGNED_BYTE,A);k.dispose(!1);
n.dispose();g.dispose();x.dispose();f.setViewport(r,v,q,y);f.bindFramebuffer(c);return 255!==A[0]};return d}(e.WebGLDriverTestModule);m.SVGPremultipliedAlpha=e;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/capabilities/Capabilities":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ./DisjointTimerQuery ./DrawBuffers ./Instancing ./load ./LoseContext ./VertexArrayObjects".split(" "),function(m,p,D,B,u,t,h,l){let e=function(){function b(d,a){this._gl=
d;this._textureFloatLinear=this._fragDepth=this._shaderTextureLOD=this._standardDerivatives=this._depthTexture=this._textureNorm16=this._drawBuffers=this._loseContext=this._minMaxBlending=this._colorBufferFloat=this._textureFloat=this._textureFilterAnisotropic=this._compressedTextureS3TC=this._compressedTextureETC=this._vertexArrayObject=this._instancing=null;this._disabledExtensions=a.disabledExtensions||{};this._debugWebGLExtensions=a.debugWebGLExtensions||{}}b.prototype.enable=function(d){return this[d]};
p._createClass(b,[{key:"drawBuffers",get:function(){this._drawBuffers||(this._drawBuffers=B.load(this._gl,this._disabledExtensions));return this._drawBuffers}},{key:"instancing",get:function(){this._instancing||(this._instancing=u.load(this._gl));return this._instancing}},{key:"vao",get:function(){this._vertexArrayObject||(this._vertexArrayObject=l.load(this._gl,this._disabledExtensions));return this._vertexArrayObject}},{key:"compressedTextureETC",get:function(){this._compressedTextureETC||(this._compressedTextureETC=
t.loadCompressedTextureETC(this._gl,this._disabledExtensions));return this._compressedTextureETC}},{key:"compressedTextureS3TC",get:function(){this._compressedTextureS3TC||(this._compressedTextureS3TC=t.loadCompressedTextureS3TC(this._gl,this._disabledExtensions));return this._compressedTextureS3TC}},{key:"textureFilterAnisotropic",get:function(){this._textureFilterAnisotropic||(this._textureFilterAnisotropic=t.loadTextureFilterAnisotropicCapability(this._gl,this._disabledExtensions));return this._textureFilterAnisotropic}},
{key:"disjointTimerQuery",get:function(){this._disjointTimerQuery||(this._disjointTimerQuery=D.createDisjointTimerQuery(this._gl,this._disabledExtensions));return this._disjointTimerQuery}},{key:"textureFloat",get:function(){this._textureFloat||(this._textureFloat=t.loadTextureFloat(this._gl,this._disabledExtensions));return this._textureFloat}},{key:"colorBufferFloat",get:function(){this._colorBufferFloat||(this._colorBufferFloat=t.loadColorBufferFloat(this._gl,this._disabledExtensions));return this._colorBufferFloat}},
{key:"blendMinMax",get:function(){this._minMaxBlending||(this._minMaxBlending=t.loadMinMaxBlending(this._gl,this._disabledExtensions));return this._minMaxBlending}},{key:"depthTexture",get:function(){null===this._depthTexture&&(this._depthTexture=t.loadBooleanExtension(this._gl,this._disabledExtensions,"depthTexture",!0,["WEBGL_depth_texture","MOZ_WEBGL_depth_texture","WEBKIT_WEBGL_depth_texture"]));return this._depthTexture}},{key:"standardDerivatives",get:function(){null===this._standardDerivatives&&
(this._standardDerivatives=t.loadBooleanExtension(this._gl,this._disabledExtensions,"standardDerivatives",!0,["OES_standard_derivatives"]));return this._standardDerivatives}},{key:"shaderTextureLOD",get:function(){null===this._shaderTextureLOD&&(this._shaderTextureLOD=t.loadBooleanExtension(this._gl,this._disabledExtensions,"shaderTextureLOD",!0,["EXT_shader_texture_lod"]));return this._shaderTextureLOD}},{key:"fragDepth",get:function(){null===this._fragDepth&&(this._fragDepth=t.loadBooleanExtension(this._gl,
this._disabledExtensions,"fragDepth",!0,["EXT_frag_depth"]));return this._fragDepth}},{key:"loseContext",get:function(){this._loseContext||(this._loseContext=h.load(this._gl,this._debugWebGLExtensions));return this._loseContext}},{key:"textureNorm16",get:function(){this._textureNorm16||(this._textureNorm16=t.loadTextureNorm16(this._gl,this._disabledExtensions));return this._textureNorm16}},{key:"textureFloatLinear",get:function(){null===this._textureFloatLinear&&(this._textureFloatLinear=t.loadBooleanExtension(this._gl,
this._disabledExtensions,"textureFloatLinear",!1,["OES_texture_float_linear"]));return this._textureFloatLinear}}]);return b}();m.Capabilities=e;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/capabilities/DrawBuffers":function(){define(["exports","./isWebGL2Context"],function(m,p){m.load=function(D,B){return B.disjointTimerQuery?null:p(D)?{drawBuffers:D.drawBuffers.bind(D),MAX_DRAW_BUFFERS:D.MAX_DRAW_BUFFERS,MAX_COLOR_ATTACHMENTS:D.MAX_COLOR_ATTACHMENTS}:B.drawBuffers?
null:(D=D.getExtension("WEBGL_draw_buffers"))?{drawBuffers:D.drawBuffersWEBGL.bind(D),MAX_DRAW_BUFFERS:D.MAX_DRAW_BUFFERS_WEBGL,MAX_COLOR_ATTACHMENTS:D.MAX_COLOR_ATTACHMENTS_WEBGL}:null};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/capabilities/Instancing":function(){define(["exports","./isWebGL2Context"],function(m,p){m.load=function(D){return p(D)?D:(D=D.getExtension("ANGLE_instanced_arrays"))?{drawArraysInstanced:D.drawArraysInstancedANGLE.bind(D),drawElementsInstanced:D.drawElementsInstancedANGLE.bind(D),
vertexAttribDivisor:D.vertexAttribDivisorANGLE.bind(D)}:null};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/capabilities/load":function(){define(["exports","./isWebGL2Context"],function(m,p){m.loadBooleanExtension=function(D,B,u,t,h){if(t&&p(D))return!0;if(B[u])return!1;for(const l of h)if(D.getExtension(l))return!0;return!1};m.loadColorBufferFloat=function(D,B){if(p(D)){var u=!B.colorBufferHalfFloat&&D.getExtension("EXT_color_buffer_half_float")||!B.colorBufferFloat&&
D.getExtension("EXT_color_buffer_float"),t=!B.colorBufferFloat&&D.getExtension("EXT_color_buffer_float");B=!B.floatBlend&&!B.colorBufferFloat&&D.getExtension("EXT_float_blend");return u||t||B?{textureFloat:!!t,textureHalfFloat:!!u,floatBlend:!!B,R16F:D.R16F,RG16F:D.RG16F,RGBA16F:D.RGBA16F,R32F:D.R32F,RG32F:D.RG32F,RGBA32F:D.RGBA32F,R11F_G11F_B10F:D.R11F_G11F_B10F,RGB16F:D.RGB16F}:null}return D instanceof WebGLRenderingContext?(u=!B.colorBufferHalfFloat&&D.getExtension("EXT_color_buffer_half_float"),
t=!B.colorBufferFloat&&D.getExtension("WEBGL_color_buffer_float"),D=!B.floatBlend&&!B.colorBufferFloat&&D.getExtension("EXT_float_blend"),u||t||D?{textureFloat:!!t,textureHalfFloat:!!u,floatBlend:!!D,RGBA16F:u?u.RGBA16F_EXT:void 0,RGB16F:u?u.RGB16F_EXT:void 0,RGBA32F:t?t.RGBA32F_EXT:void 0}:null):null};m.loadCompressedTextureETC=function(D,B){return B.compressedTextureETC?null:(D=D.getExtension("WEBGL_compressed_texture_etc"))?{COMPRESSED_R11_EAC:D.COMPRESSED_R11_EAC,COMPRESSED_SIGNED_R11_EAC:D.COMPRESSED_SIGNED_R11_EAC,
COMPRESSED_RG11_EAC:D.COMPRESSED_RG11_EAC,COMPRESSED_SIGNED_RG11_EAC:D.COMPRESSED_SIGNED_RG11_EAC,COMPRESSED_RGB8_ETC2:D.COMPRESSED_RGB8_ETC2,COMPRESSED_SRGB8_ETC2:D.COMPRESSED_SRGB8_ETC2,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:D.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:D.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2,COMPRESSED_RGBA8_ETC2_EAC:D.COMPRESSED_RGBA8_ETC2_EAC,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:D.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC}:null};m.loadCompressedTextureS3TC=
function(D,B){return B.compressedTextureS3TC?null:(D=D.getExtension("WEBGL_compressed_texture_s3tc"))?{COMPRESSED_RGB_S3TC_DXT1:D.COMPRESSED_RGB_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT1:D.COMPRESSED_RGBA_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT3:D.COMPRESSED_RGBA_S3TC_DXT3_EXT,COMPRESSED_RGBA_S3TC_DXT5:D.COMPRESSED_RGBA_S3TC_DXT5_EXT}:null};m.loadMinMaxBlending=function(D,B){return p(D)?{MIN:D.MIN,MAX:D.MAX}:B.blendMinMax?null:(D=D.getExtension("EXT_blend_minmax"))?{MIN:D.MIN_EXT,MAX:D.MAX_EXT}:null};
m.loadTextureFilterAnisotropicCapability=function(D,B){return B.textureFilterAnisotropic?null:(D=D.getExtension("EXT_texture_filter_anisotropic")||D.getExtension("MOZ_EXT_texture_filter_anisotropic")||D.getExtension("WEBKIT_EXT_texture_filter_anisotropic"))?{MAX_TEXTURE_MAX_ANISOTROPY:D.MAX_TEXTURE_MAX_ANISOTROPY_EXT,TEXTURE_MAX_ANISOTROPY:D.TEXTURE_MAX_ANISOTROPY_EXT}:null};m.loadTextureFloat=function(D,B){if(p(D))return{textureFloat:!0,textureFloatLinear:!B.textureFloatLinear&&!!D.getExtension("OES_texture_float_linear"),
textureHalfFloat:!0,textureHalfFloatLinear:!0,HALF_FLOAT:D.HALF_FLOAT,R16F:D.R16F,RG16F:D.RG16F,RGBA16F:D.RGBA16F,R32F:D.R32F,RG32F:D.RG32F,RGBA32F:D.RGBA32F,R11F_G11F_B10F:D.R11F_G11F_B10F,RGB16F:D.RGB16F};if(D instanceof WebGLRenderingContext){const u=!B.textureHalfFloat&&D.getExtension("OES_texture_half_float");return{textureFloat:!B.textureFloat&&!!D.getExtension("OES_texture_float"),textureFloatLinear:!B.textureFloatLinear&&!!D.getExtension("OES_texture_float_linear"),textureHalfFloat:!!u,textureHalfFloatLinear:!B.textureHalfFloatLinear&&
!!D.getExtension("OES_texture_half_float_linear"),HALF_FLOAT:u?u.HALF_FLOAT_OES:void 0}}return null};m.loadTextureNorm16=function(D,B){return!p(D)||B.textureNorm16?null:(D=D.getExtension("EXT_texture_norm16"))?{R16:D.R16_EXT,RG16:D.RG16_EXT,RGB16:D.RGB16_EXT,RGBA16:D.RGBA16_EXT,R16_SNORM:D.R16_SNORM_EXT,RG16_SNORM:D.RG16_SNORM_EXT,RGB16_SNORM:D.RGB16_SNORM_EXT,RGBA16_SNORM:D.RGBA16_SNORM_EXT}:null};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/capabilities/LoseContext":function(){define(["exports"],
function(m){m.load=function(p,D){const B=D.loseContext&&p.getExtension("WEBGL_lose_context");return B?{loseRenderingContext:()=>B.loseContext()}:null};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/capabilities/VertexArrayObjects":function(){define(["exports","./isWebGL2Context"],function(m,p){m.load=function(D,B){return p(D)?{createVertexArray:D.createVertexArray.bind(D),deleteVertexArray:D.deleteVertexArray.bind(D),bindVertexArray:D.bindVertexArray.bind(D)}:B.vao?
null:(D=D.getExtension("OES_vertex_array_object")||D.getExtension("MOZ_OES_vertex_array_object")||D.getExtension("WEBKIT_OES_vertex_array_object"))?{createVertexArray:D.createVertexArrayOES.bind(D),deleteVertexArray:D.deleteVertexArrayOES.bind(D),bindVertexArray:D.bindVertexArrayOES.bind(D)}:null};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/LabelManager":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Error ../../core/HandleOwner ../../core/has ../../core/Logger ../../core/maybe ../../core/throttle ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass ./engine/webgl/collisions/CollisionEngine".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d,a,c,f){D=function(g){function n(x){x=g.call(this,x)||this;x._applyVisibilityPassThrottled=e.throttle(x._applyVisibilityPass,32,m._assertThisInitialized(x));x.lastUpdateId=-1;x.updateRequested=!1;x.view=null;return x}m._inheritsLoose(n,g);var k=n.prototype;k.initialize=function(){this.collisionEngine=new f.CollisionEngine};k.destroy=function(){this.collisionEngine=null;this._applyVisibilityPassThrottled=l.removeMaybe(this._applyVisibilityPassThrottled)};k.update=function(x){this._applyVisibilityPassThrottled(x)};
k.viewChange=function(){this.requestUpdate()};k.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.view?.requestUpdate())};k.processUpdate=function(x){this._set("updateParameters",x);this.updateRequested&&(this.updateRequested=!1,this.update(x))};k._applyVisibilityPass=function(x){const r=this.view;if(r)try{const v=r.featuresTilingScheme.getClosestInfoForScale(x.state.scale).level;this.collisionEngine.run(r.allLayerViews.items,x,v)}catch(v){}};m._createClass(n,[{key:"updating",
get:function(){t("esri-2d-log-updating")&&console.log(`Updating LabelManager ${this.updateRequested}:\n-> updateRequested: ${this.updateRequested}`);return this.updateRequested}}]);return n}(u.HandleOwnerMixin(D));p.__decorate([b.property()],D.prototype,"updateRequested",void 0);p.__decorate([b.property({readOnly:!0})],D.prototype,"updateParameters",void 0);p.__decorate([b.property()],D.prototype,"updating",null);p.__decorate([b.property()],D.prototype,"view",void 0);return D=p.__decorate([c.subclass("esri.views.2d.layers.labels.LabelManager")],
D)})},"esri/views/2d/engine/webgl/collisions/CollisionEngine":function(){define("exports ../../../../../core/maybe ../../../../../core/screenUtils ../definitions ./CollisionGrid ./visualVariableSimpleUtils".split(" "),function(m,p,D,B,u,t){function h(d,a){const c=[];d.forEachTile(f=>c.push(f));c.sort((f,g)=>f.instanceId-g.instanceId);c.forEach(f=>{p.isSome(f.labelMetrics)&&f.isReady&&a(f,f.labelMetrics.getCursor())})}function l(d){return a=>D.pt2px(t.getSizeForValueSimple(a,d))}function e(d){for(const a of d)if(d=
("featureReduction"in a&&a.featureReduction&&"labelingInfo"in a.featureReduction?a.featureReduction:void 0)?.labelingInfo||[],d=[...(a.labelingInfo||[]),...d],a.labelsVisible&&d.length&&d.some(c=>"none"===c.deconflictionStrategy))return!0;return!1}let b=function(){function d(){}var a=d.prototype;a.run=function(c,f,g){const n=[];for(let v=c.length-1;0<=v;v--)a:{var k=n,x=c[v];if(!x.layer||"feature"!==x.layer.type&&"csv"!==x.layer.type&&"geojson"!==x.layer.type&&"ogc-feature"!==x.layer.type&&"stream"!==
x.layer.type&&"subtype-group"!==x.layer.type&&"wfs"!==x.layer.type)break a;const q=x.layer.geometryType,y=!e("subtype-group"===x.layer.type?x.layer.sublayers.items:[x.layer]),A={};if("subtype-group"!==x.layer.type){if("heatmap"===x.tileRenderer?.type)break a;b:{var r=x.layer.renderer;if(r=null!=r&&"visualVariables"in r&&r.visualVariables)for(const w of r)if("size"===w.type){r=l(w);break b}r=null}A[0]=r}r=x.tileRenderer;p.isNone(r)||k.push({tileRenderer:r,vvEvaluators:A,deconflictionEnabled:y,geometryType:q,
visible:x.layer.visible&&!x.suspended})}this._transformMetrics(n);this._runCollision(n,f,g)};a._runCollision=function(c,f,g){const [n,k]=f.state.size,x=new u.CollisionBitsetGrid(n,k,f.pixelRatio);for(const {tileRenderer:r,deconflictionEnabled:v,visible:q}of c){const y=r.featuresView.attributeView;v?q?(this._prepare(r),this._collideVisible(x,r,g),this._collideInvisible(x,r)):h(r,(A,w)=>{for(;w.nextId();)y.setLabelMinZoom(w.id,255)}):h(r,(A,w)=>{for(;w.nextId();)y.setLabelMinZoom(w.id,0),q&&x.insertMetrics(w)})}};
a._isFiltered=function(c,f,g){f=f.getFilterFlags(c);c=!g.hasFilter||!!(f&B.FILTER_FLAG_0);g=p.isNone(g.featureEffect)||g.featureEffect.excludedLabelsVisible||!!(f&B.EFFECT_FLAG_0);return!(c&&g)};a._prepare=function(c){const f=c.featuresView.attributeView,g=new Set;h(c,(n,k)=>{for(;k.nextId();)g.has(k.id)||(g.add(k.id),this._isFiltered(k.id,f,c.layerView)?f.setLabelMinZoom(k.id,254):0!==f.getLabelMinZoom(k.id)?f.setLabelMinZoom(k.id,255):f.setLabelMinZoom(k.id,0))})};a._collideVisible=function(c,f,
g){const n=f.featuresView.attributeView,k=new Set;h(f,(x,r)=>{for(;r.nextId();)if(!k.has(r.id))if(x.key.level!==g)n.setLabelMinZoom(r.id,254);else if(0===n.getLabelMinZoom(r.id))switch(c.insertMetrics(r)){case u.HAS_COLLISION:n.setLabelMinZoom(r.id,254);k.add(r.id);break;case u.NONE:n.setLabelMinZoom(r.id,0),k.add(r.id)}})};a._collideInvisible=function(c,f){const g=f.featuresView.attributeView,n=new Set;h(f,(k,x)=>{for(;x.nextId();)if(!n.has(x.id)&&255===g.getLabelMinZoom(x.id))switch(c.insertMetrics(x)){case u.HAS_COLLISION:g.setLabelMinZoom(x.id,
255);n.add(x.id);break;case u.NONE:g.setLabelMinZoom(x.id,0),n.add(x.id)}})};a._transformMetrics=function(c){for(const {tileRenderer:f,geometryType:g,vvEvaluators:n}of c)h(f,(k,x)=>{const r=f.featuresView.attributeView;k=k.transforms.labelMat2d;k[4]=Math.round(k[4]);k[5]=Math.round(k[5]);const v="polyline"===g;for(;x.next();){const C=x.boundsCount,E=x.anchorX,F=x.anchorY;var q=x.size,y=n[0];if(p.isSome(y)){var A=r.getVVSize(x.id);y=y(A);q=isNaN(y)||null==y||Infinity===y?q:y}y=q/2*x.directionX;q=q/
2*x.directionY;for(A=0;A<C;A++){var w=E,z=x.anchorY;v?(w=w+x.boundsX(A)+y,z=z+x.boundsY(A)+q,w=k[0]*w+k[2]*z+k[4],z=k[1]*w+k[3]*z+k[5],x.setBoundsComputedAnchorX(A,Math.floor(w)),x.setBoundsComputedAnchorY(A,Math.floor(z))):(w=k[0]*E+k[2]*F+k[4],z=k[1]*E+k[3]*F+k[5],w=w+x.boundsX(A)+y,z=z+x.boundsY(A)+q,x.setBoundsComputedAnchorX(A,w),x.setBoundsComputedAnchorY(A,z))}}})};return d}();m.CollisionEngine=b;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/collisions/CollisionGrid":function(){define(["exports",
"../../../../../core/mathUtils","../../../layers/features/support/StaticBitSet"],function(m,p,D){let B=function(){function u(h,l,e){this._debugMap=new Map;this._width=h*e;this._height=l*e;this._pixelRatio=e;h=Math.ceil(this._width/1);l=Math.ceil(this._height/1);this._cols=h;this._rows=l;this._cells=D.StaticBitSet.create(h*l)}var t=u.prototype;t.insertMetrics=function(h){const l=this._hasCollision(h);0===l&&this._markMetrics(h);return l};t.getCellId=function(h,l){return h+l*this._cols};t.has=function(h){return this._cells.has(h)};
t.hasRange=function(h,l){return this._cells.hasRange(h,l)};t.set=function(h){this._cells.set(h)};t.setRange=function(h,l){this._cells.setRange(h,l)};t._collide=function(h,l,e,b){h-=e/2;l-=b/2;e=h+e;var d=l+b;if(0>e||0>d||h>this._width||l>this._height)return 1;b=p.clamp(Math.floor(h/1),0,this._cols);var a=p.clamp(Math.floor(l/1),0,this._rows);h=p.clamp(Math.ceil(e/1),0,this._cols);l=p.clamp(Math.ceil(d/1),0,this._rows);for(e=a;e<=l;e++)for(d=b;d<=h;d++)if(a=this.getCellId(d,e),this.has(a))return 2;
return 0};t._mark=function(h,l,e,b,d){h-=e/2;l-=b/2;e=h+e;var a=l+b;b=p.clamp(Math.floor(h/1),0,this._cols);var c=p.clamp(Math.floor(l/1),0,this._rows);h=p.clamp(Math.ceil(e/1),0,this._cols);l=p.clamp(Math.ceil(a/1),0,this._rows);for(e=c;e<=l;e++)for(a=b;a<=h;a++)c=this.getCellId(a,e),this._debugMap.set(c,d),this.set(c);return!1};t._hasCollision=function(h){const l=h.id;let e=0,b=0;h.save();do{const d=h.boundsCount;e+=d;for(let a=0;a<d;a++){const c=h.boundsComputedAnchorX(a),f=h.boundsComputedAnchorY(a),
g=(h.boundsWidth(a)+2)*this._pixelRatio,n=(h.boundsHeight(a)+2)*this._pixelRatio;switch(this._collide(c,f,g,n)){case 2:return 2;case 1:b++}}}while(h.peekId()===l&&h.next());h.restore();return e===b?1:0};t._markMetrics=function(h){const l=h.id;h.save();do{const e=h.boundsCount;for(let b=0;b<e;b++){const d=h.boundsComputedAnchorX(b),a=h.boundsComputedAnchorY(b),c=(h.boundsWidth(b)+2)*this._pixelRatio,f=(h.boundsHeight(b)+2)*this._pixelRatio;this._mark(d,a,c,f,h.id)}}while(h.peekId()===l&&h.next());
h.restore()};return u}();m.CollisionBitsetGrid=B;m.HAS_COLLISION=2;m.NONE=0;m.OUTSIDE_EXTENT=1;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/StaticBitSet":function(){define(["exports"],function(m){let p=function(){function D(u,t){this._mask=0;this._buf=u;this._mask=t}D.fromBuffer=function(u,t){return new D(u,t)};D.create=function(u,t=4294967295){u=new Uint32Array(Math.ceil(u/32));return new D(u,t)};var B=D.prototype;B._getIndex=function(u){return Math.floor(u/
32)};B.has=function(u){u&=this._mask;return!!(this._buf[this._getIndex(u)]&1<<u%32)};B.hasRange=function(u,t){for(;u%32&&u!==t;){if(this.has(u))return!0;u++}for(;t%32&&u!==t;){if(this.has(u))return!0;t--}if(u===t)return!1;for(u/=32;u!==t/32;u++)if(this._buf[u])return!0;return!1};B.set=function(u){u&=this._mask;const t=this._getIndex(u);this._buf[t]|=1<<u%32};B.setRange=function(u,t){for(;u%32&&u!==t;)this.set(u++);for(;t%32&&u!==t;)this.set(t--);if(u!==t)for(u/=32;u!==t/32;u++)this._buf[u]=4294967295};
B.unset=function(u){u&=this._mask;const t=this._getIndex(u);this._buf[t]&=4294967295^1<<u%32};B.resize=function(u){const t=this._buf;u=new Uint32Array(Math.ceil(u/32));u.set(t);this._buf=u};B.or=function(u){for(let t=0;t<this._buf.length;t++)this._buf[t]|=u._buf[t];return this};B.and=function(u){for(let t=0;t<this._buf.length;t++)this._buf[t]&=u._buf[t];return this};B.xor=function(u){for(let t=0;t<this._buf.length;t++)this._buf[t]^=u._buf[t];return this};B.ior=function(u){for(let t=0;t<this._buf.length;t++)this._buf[t]|=
~u._buf[t];return this};B.iand=function(u){for(let t=0;t<this._buf.length;t++)this._buf[t]&=~u._buf[t];return this};B.ixor=function(u){for(let t=0;t<this._buf.length;t++)this._buf[t]^=~u._buf[t];return this};B.any=function(){for(let u=0;u<this._buf.length;u++)if(this._buf[u])return!0;return!1};B.copy=function(u){for(let t=0;t<this._buf.length;t++)this._buf[t]=u._buf[t];return this};B.clone=function(){return new D(this._buf.slice(),this._mask)};B.clear=function(){for(let u=0;u<this._buf.length;u++)this._buf[u]=
0};B.forEachSet=function(u){for(let t=0;t<this._buf.length;t++){let h=this._buf[t],l=32*t;if(h)for(;h;)h&1&&u(l),h>>>=1,l++}};B.countSet=function(){let u=0;this.forEachSet(t=>{u++});return u};return D}();m.StaticBitSet=p;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/collisions/visualVariableSimpleUtils":function(){define(["exports","../../../../../core/mathUtils","../../../../../renderers/support/lengthUtils","../../../../../renderers/visualVariables/support/sizeVariableUtils"],
function(m,p,D,B){function u(e,b){switch(b.transformationType){case B.TransformationType.Additive:var d=t(b.minSize,e);return e+(d||b.minDataValue);case B.TransformationType.Constant:return d=(d=b.stops)&&d.length&&d[0].size,null==d&&(d=b.minSize),t(d,e);case B.TransformationType.ClampedLinear:d=b.minDataValue;var a=b.maxDataValue,c=(e-d)/(a-d),f=t(b.minSize,e);b=t(b.maxSize,e);e=e<=d?f:e>=a?b:f+c*(b-f);return e;case B.TransformationType.Proportional:return d=e/b.minDataValue,a=t(b.minSize,e),e=t(b.maxSize,
e),p.clamp(d*a,a,e);case B.TransformationType.Stops:{const [g,n,k]=h(e,b.cache.ipData);g===n?e=t(b.stops[g].size,e):(d=t(b.stops[g].size,e),e=t(b.stops[n].size,e),e=d+(e-d)*k)}return e;case B.TransformationType.RealWorldSize:return d=D.meterIn[b.valueUnit],a=t(b.minSize,e),c=t(b.maxSize,e),{valueRepresentation:b}=b,f=null,f="area"===b?2*Math.sqrt(e/l)/d:"radius"===b||"distance"===b?2*e/d:e/d,p.clamp(f,a,c);case B.TransformationType.Identity:return e;case B.TransformationType.Unknown:return null}}
function t(e,b){return"number"===typeof e?e:u(b,e)}function h(e,b){if(b){var d=0,a=b.length-1;b.some((c,f)=>{if(e<c)return a=f,!0;d=f;return!1});return[d,a,(e-b[d])/(b[a]-b[d])]}}const l=Math.PI;m.getSizeForValueSimple=u;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/graphics/GraphicsView2D":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Accessor ../../../../core/BidiText ../../../../core/HandleOwner ../../../../core/has ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/reactiveUtils ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/accessorSupport/decorators/subclass ../../../../geometry/SpatialReference ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/coordsUtils ../../../../geometry/support/jsonUtils ../../../../geometry/support/normalizeUtilsSync ../../../../geometry/support/spatialReferenceUtils ../../../../layers/graphics/data/projectionSupport ../../../../symbols/cim/CIMSymbolHelper ../../../../symbols/support/defaults ../../engine/webgl/definitions ../../engine/webgl/enums ../../engine/webgl/GraphicTile ../../engine/webgl/TileData ../../engine/webgl/WGLDisplayObject ../../engine/webgl/mesh/MeshData ../../engine/webgl/mesh/factories/WGLMeshFactory ../../engine/webgl/mesh/templates/WGLTemplateStore ../../engine/webgl/util/Matcher ../features/schemaUtils ../features/support/AttributeStore ../features/support/ComputedAttributeStorage ../features/support/GraphicsReader ./GraphicStore ./graphicsUtils ../support/cimSymbolUtils ../../../layers/GraphicsView ../../../webgl/capabilities ../features/createSymbolSchema".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d,a,c,f,g,n,k,x,r,v,q,y,A,w,z,C,E,F,G,H,L,K,M,U,T,Z,X,ca,P,J,N){function S(Y,ba,aa){let I=aa.get(Y);I||(I={tile:ba,addedOrModified:[],removed:[]},aa.set(Y,I));return I}const Q=t("esri-2d-graphic-debug");D=function(Y){function ba(I){I=Y.call(this,I)||this;I._storage=new U.ComputedAttributeStorage;I._displayIds=new Map;I._controller=new AbortController;I._tiles=new Map;I._graphicStoreUpdate=!1;I._graphicsSet=new Set;I._matcher=Promise.resolve(null);I._tileUpdateSet=new Set;
I._tilesToUpdate=new Map;I._graphicIdToAbortController=new Map;I._attached=!1;I._updatingGraphicsTimer=null;I._hashToExpandedSymbol=new Map;I._hashToExpandedSymbolPromise=new Map;I._hashToCIMSymbolPromise=new Map;I._hashToCIM=new Map;I._processing=!1;I._needsProcessing=!1;I._pendingUpdate={added:new Set,updated:new Set,removed:new Set};I.lastUpdateId=-1;I.updateRequested=!1;I.defaultPointSymbolEnabled=!0;I.graphicUpdateHandler=I.graphicUpdateHandler.bind(m._assertThisInitialized(I));return I}m._inheritsLoose(ba,
Y);var aa=ba.prototype;aa.destroy=function(){this._updatingGraphicsTimer&&(clearTimeout(this._updatingGraphicsTimer),this._updatingGraphicsTimer=null,this.notifyChange("updating"));this._controller.abort();this.container.destroy();this._set("graphics",null);this._graphicStore.clear();this._attributeStore=null;this._hashToExpandedSymbol.clear();this.renderer=this.view=null;this._hashToCIM.clear();this._hashToCIMSymbolPromise.clear();this._hashToExpandedSymbolPromise.clear()};aa._createMatcher=function(I,
O,R){if(I){const V=K.createSymbolSchemaOptions(I);I=K.createMatcherSchema({indexCount:0,fields:{}},"feature",I,V);this._matcher=L.createMatcher(I,O,null,R)}};aa._createDisplayId=function(I){let O=this._displayIds.get(I);O||(O=this._storage.createDisplayId(),this._displayIds.set(I,O));return O};aa.initialize=function(){this._attributeStore=new M({type:"local",initialize:O=>Promise.resolve(this.container.attributeView.initialize(O)),update:O=>this.container.attributeView.requestUpdate(O),render:()=>
this.container.requestRender()},J.getWebGLCapabilities("2d"),()=>this.notifyChange("updating"));this.container.hasHighlight=()=>this._attributeStore.hasHighlight;const I=new H.WGLTemplateStore(this.container.getMaterialItems.bind(this.container),this.view.featuresTilingScheme.tileInfo);this._graphicStore=new Z(this.view.featuresTilingScheme,this.view.state.scale,this.uid,this.graphics,O=>{this._createDisplayId(O.uid);this._setFilterState(O.uid,O.visible)},O=>{const R=this._displayIds.get(O.uid);this._displayIds.delete(O.uid);
this._storage.releaseDisplayId(R)},this._hashToCIM);this._meshFactory=new G.WGLMeshFactory(null,this.uid,I);this._templateStore=I;this.handles.add([e.watch(()=>this.renderer,O=>{this._createMatcher(O,I,this.container.stage.resourceManager);for(const R of this.graphics)this._pendingUpdate.updated.add(R);this.requestUpdate()}),this.view.graphicsTileStore.on("update",this._onTileUpdate.bind(this)),this.container.on("attach",()=>{Q&&this.container.enableRenderingBounds(()=>this._graphicStore.getAllBounds());
0<this.graphics.items.length&&this._graphicsChangeHandler({target:this.graphics,added:this.graphics.items,removed:[],moved:[]});this.handles.add(this.graphics.on("change",R=>this._graphicsChangeHandler(R)),"graphics");const O=this.container.stage.resourceManager;this._createMatcher(this.renderer,I,O);this._graphicStore.setResourceManager(O);this._attached=!0;this.notifyChange("updating")})]);this._onTileUpdate({added:this.view.graphicsTileStore.tiles,removed:[]})};aa.hitTest=function(I){if(!this.view||
!this.view.position)return[];const {resolution:O,rotation:R}=this.view.state;return this._graphicStore.hitTest(I.x,I.y,2,O,R)};aa.update=function(I){l.throwIfAborted(this._controller.signal);({resolution:I}=I.state);this._graphicStore.updateLevel(I);this._graphicStoreUpdate=!0;this.updateRequested=!1;0<this._pendingUpdate.updated.size&&(this._processing?this._needsProcessing=!0:this._updateGraphics())};aa.viewChange=function(){this.requestUpdate()};aa.requestUpdate=function(){this.updateRequested||
(this.updateRequested=!0,this.requestUpdateCallback())};aa.processUpdate=function(I){this.updateRequested&&(this.updateRequested=!1,this.update(I))};aa.graphicUpdateHandler=function(I){const {graphic:O,property:R}=I;switch(R){case "attributes":case "geometry":case "symbol":this._pendingUpdate.updated.add(O);this.requestUpdate();break;case "visible":this._setFilterState(O.uid,O.visible),this._attributeStore.sendUpdates()}};aa.setHighlight=function(I){const O=I.map(R=>this._displayIds.get(R)).filter(h.isSome);
this._attributeStore.setHighlight(I,O)};aa._getIntersectingTiles=function(I){I=this._graphicStore.getBounds(I);if(!I||0===g.width(I)||0===g.height(I))return[];const O=X.intersectingInternationalDateline(I,this.view.spatialReference);return h.isSome(O)?[...(new Set([...this.view.graphicsTileStore.boundsIntersections(O[0]),...this.view.graphicsTileStore.boundsIntersections(O[1])]))]:this.view.graphicsTileStore.boundsIntersections(I)};aa._updateTile=function(){var I=m._asyncToGenerator(function*(O){l.throwIfAborted(this._controller.signal);
const R=O.tile;var V=this._getGraphicsData(this._templateStore,R,O.addedOrModified);V=yield this._processGraphics(R,V);l.throwIfAborted(this._controller.signal);this._patchTile(R.key,{type:"update",addOrUpdate:V,remove:O.removed,end:!0,clear:!1,sort:!1});return V});return function(O){return I.apply(this,arguments)}}();aa._patchTile=function(I,O){if(I=this._tiles.get(I))this.container.onTileData(I,O),this.container.requestRender()};aa._graphicsChangeHandler=function(I){const O=this._pendingUpdate;
for(const R of I.added)O.added.add(R);for(const R of I.moved)O.updated.add(R);for(const R of I.removed)this._pendingUpdate.added.has(R)?O.added.delete(R):O.removed.add(R);this._processing?this._needsProcessing=!0:this._updateGraphics()};aa._getGraphicsToUpdate=function(){const I={added:[],removed:[],updated:[]};if(!this.graphics)return I;const O=this._pendingUpdate;for(const R of this.graphics.items)O.added.has(R)?I.added.push(R):O.updated.has(R)&&I.updated.push(R);for(const R of O.removed)this._graphicStore.has(R)&&
I.removed.push(R);O.added.clear();O.removed.clear();O.updated.clear();return I};aa._updateGraphics=function(){var I=m._asyncToGenerator(function*(){this._processing=!0;const {added:O,removed:R,updated:V}=this._getGraphicsToUpdate(),W=this._tilesToUpdate;try{if(!this._graphicStoreUpdate){var {resolution:da}=this.view.state;this._graphicStore.updateLevel(da)}da=[];const ia=Array(O.length+R.length);for(let ka=0;ka<V.length;ka++){var ea=V[ka];const ja=this._getIntersectingTiles(ea);for(const ma of ja){var fa=
ma.id;S(fa,ma,W).removed.push(this._displayIds.get(ea.uid))}da.push(this._updateGraphic(ea,null));ia[ka]=ea}var ha=V.length;for(ea=0;ea<O.length;ea++){const ka=O[ea];ia[ha+ea]=ka;this._graphicsSet.add(ka);da.push(this._addGraphic(ka))}for(const ka of R){this._abortProcessingGraphic(ka.uid);const ja=this._getIntersectingTiles(ka);for(const ma of ja)fa=ma.id,S(fa,ma,W).removed.push(this._displayIds.get(ka.uid));this._graphicsSet.delete(ka);this._graphicStore.remove(ka)}this._flipUpdatingGraphics();
yield Promise.all(da);let la;for(ha=0;ha<ia.length;ha++){la=ia[ha];const ka=this._getIntersectingTiles(la);for(const ja of ka)fa=ja.id,S(fa,ja,W).addedOrModified.push(la)}this._graphicStore.updateZ();fa=[];for(const [,ka]of W)fa.push(this._updateTile(ka));yield Promise.all(fa)}catch(ia){l.isAbortError(ia)}for(const ia of R)try{const la=yield this._getSymbolForGraphic(ia,null);if(la){const ka=la.hash();this._hashToExpandedSymbol.delete(ka)}}catch(la){l.isAbortError(la)}W.clear();this.notifyChange("updating");
this._processing=!1;this._needsProcessing&&(this._needsProcessing=!1,this._updateGraphics())});return function(){return I.apply(this,arguments)}}();aa._getArcadeInfo=function(I){const O=(I.attributes?Object.keys(I.attributes):[]).map(R=>({name:R,alias:R,type:"string"===typeof I.attributes[R]?"esriFieldTypeString":"esriFieldTypeDouble"}));return h.isNone(I.geometry)?null:{geometryType:k.getJsonType(I.geometry),spatialReference:f.fromJSON(I.geometry.spatialReference),fields:O}};aa._getSymbolForGraphic=
function(I,O){l.throwIfAborted(this._controller.signal);return h.isSome(I.symbol)?Promise.resolve(I.symbol):h.isSome(this.renderer)?this.renderer.getSymbolAsync(I,{scale:this.view.scale,signal:h.isSome(O)?O.signal:null}):Promise.resolve(this._getNullSymbol(I))};aa._getCIMSymbol=function(I,O,R){var V=this._hashToCIM.get(O);if(V)return Promise.resolve(V);I=q.symbolToCIM(I);if(h.isSome(I)){if("CIMSymbolReference"===I.type)return V=I,this._hashToCIM.set(O,V),Promise.resolve(V);if(V=this._hashToCIMSymbolPromise.get(O))return V;
V=I.fetchCIMSymbol(R).then(W=>{this._hashToCIM.set(O,W.data);this._hashToCIMSymbolPromise.delete(O);return W}).catch(W=>{this._hashToCIMSymbolPromise.delete(O);l.throwIfAbortError(W);return null});this._hashToCIMSymbolPromise.set(O,V);return V}return Promise.resolve(null)};aa._expandCIMSymbol=function(I,O,R,V){var W=this._hashToExpandedSymbol.get(R);if(W)return Promise.resolve(W);if(W=this._hashToExpandedSymbolPromise.get(R))return W;W=this.container.stage;O=this._getArcadeInfo(O);const da=K.createSymbolSchemaOptions(null);
I=N.createSymbolSchema(I,da);W=ca.expandSymbol(I,O,W.resourceManager,V);this._hashToExpandedSymbolPromise.set(R,W);W.then(ea=>{this._hashToExpandedSymbol.set(R,ea);this._hashToExpandedSymbolPromise.delete(R);return ea});return W};aa._getSymbolResources=function(){var I=m._asyncToGenerator(function*(O,R){l.throwIfAborted(this._controller.signal);return this.container.stage?this._getSymbolForGraphic(O,R).then(V=>{if(!V)return null;const W=V.hash();return this._getCIMSymbol(V,W,R).then(da=>h.isNone(da)?
null:this._expandCIMSymbol(da,O,W,R).then(ea=>{const fa=ea.layers.filter(ha=>"text"===ha.type&&"string"===typeof ha.text);if(fa&&0<fa.length){const ha=Array(fa.length);for(let la=0;la<fa.length;la++){const ka=fa[la],ja=[],[ma]=B.bidiText(ka.text);ka.text=ma;for(let na=0;na<ma.length;na++)ja.push(ma.charCodeAt(na));ha[la]={symbol:ka,id:la,glyphIds:ja}}const ia=new Map;return this.container.getMaterialItems(ha).then(la=>{h.assertIsSome(la);for(let ka=0;ka<fa.length;ka++){const ja=fa[ka];ia.set(ja.cim,
{text:ja.text,mosaicItem:la[ka].mosaicItem})}return{symbol:ea,textInfo:ia,hash:W}})}return{symbol:ea,hash:W}}))}).catch(V=>{l.throwIfAbortError(V);return null}):null});return function(O,R){return I.apply(this,arguments)}}();aa._projectAndNormalizeGeometry=function(){var I=m._asyncToGenerator(function*(O,R){l.throwIfAborted(this._controller.signal);if(h.isNone(O.geometry)||"mesh"===O.geometry.type)return null;var V=O.geometry;k.isPolygon(V)?V.rings=V.rings:k.isPolyline(V)?V.paths=V.paths:k.isExtent(V)&&
(O=yield this._getSymbolForGraphic(O,R),l.throwIfAborted(this._controller.signal),V=O&&(X.isMarkerSymbol(O.type)||X.isTextSymbol(O.type))?V.center:X.polygonFromExtent(V));yield v.checkProjectionSupport(V.spatialReference,this.view.spatialReference);O=x.normalizeCentralMeridianForDisplay(V);(V=v.project(O,V.spatialReference,this.view.spatialReference))&&n.closeRingsAndFixWinding(V);return V});return function(O,R){return I.apply(this,arguments)}}();aa._onTileUpdate=function(I){const O=r.getInfo(this.view.spatialReference);
if(I.added&&0<I.added.length)for(const R of I.added)this._addNewTile(R,O);if(I.removed&&0<I.removed.length)for(const R of I.removed)this._removeTile(R.key)};aa._addGraphic=function(){var I=m._asyncToGenerator(function*(O){this._abortProcessingGraphic(O.uid);l.throwIfAborted(this._controller.signal);var R=new AbortController;this._graphicIdToAbortController.set(O.uid,R);R={signal:R.signal};try{yield this._addOrUpdateGraphic(O,R),l.throwIfAborted(this._controller.signal),this._graphicIdToAbortController.delete(O.uid)}catch(V){if(this._graphicIdToAbortController.delete(O.uid),
!l.isAbortError(V))throw V;}});return function(O){return I.apply(this,arguments)}}();aa._updateGraphic=function(I,O){l.throwIfAborted(this._controller.signal);const R=this._projectAndNormalizeGeometry(I,O);O=this._getSymbolResources(I,O);return Promise.all([R,O]).then(([V,W])=>{l.throwIfAborted(this._controller.signal);this._graphicStore.addOrModify(I,W,V)})};aa._addOrUpdateGraphic=function(I,O){l.throwIfAborted(this._controller.signal);const R=this._projectAndNormalizeGeometry(I,O);O=this._getSymbolResources(I,
O);return Promise.all([R,O]).then(([V,W])=>{l.throwIfAborted(this._controller.signal);this._graphicsSet.has(I)&&this._graphicStore.addOrModify(I,W,V)})};aa._addTile=function(I){var O=this.view.featuresTilingScheme.getTileBounds(g.create(),I);const R=this.view.featuresTilingScheme.getTileResolution(I.level);O=new z.GraphicTile(I,R,O[0],O[3]);this._tiles.set(I,O);this.container.addChild(O);return O};aa._addNewTile=function(){var I=m._asyncToGenerator(function*(O,R){const V=this._addTile(O.key),W=this._graphicStore.queryTileData(this._templateStore,
O);if(0!==W.length){if(R){R=Math.round((R.valid[1]-R.valid[0])/O.resolution);for(var da of W)da.geometry&&(k.isPoint(da.geometry)||k.isMultipoint(da.geometry))&&this._wrapPoints(da,R)}da=O.key;this._tileUpdateSet.add(O.key);this.notifyChange("updating");try{const ea={type:"update",clear:!1,addOrUpdate:yield this._processGraphics(O,W),remove:[],end:!0,sort:!1};V.patch(ea);this._tileUpdateSet.delete(da);this.notifyChange("updating")}catch(ea){if(this._tileUpdateSet.delete(da),this.notifyChange("updating"),
!l.isAbortError(ea))throw ea;}}});return function(O,R){return I.apply(this,arguments)}}();aa._removeTile=function(I){if(this._tiles.has(I)){var O=this._tiles.get(I);this.container.removeChild(O);O.destroy();this._tiles.delete(I)}};aa._setFilterState=function(I,O){const R=this._displayIds.get(I);I=this._attributeStore.getHighlightFlag(I);this._attributeStore.setData(R,0,0,I|(O?A.FILTER_FLAG_0:0))};aa._getGraphicsData=function(I,O,R){const V=r.getInfo(this.view.spatialReference);I=this._graphicStore.getGraphicsData(I,
O,R);if(V){O=Math.round((V.valid[1]-V.valid[0])/O.resolution);for(const W of I)W.geometry&&(k.isPoint(W.geometry)||k.isMultipoint(W.geometry))&&this._wrapPoints(W,O)}return I};aa._wrapPoints=function(I,O){const R=I.geometry;k.isMultipoint(R)?this._wrapMultipoint(R,O):this._wrapPoint(I,O)};aa._wrapMultipoint=function(I,O){var R=I.points;const V=[];let W=0,da=0;for(const [ea,fa]of R)V.push([ea+W,fa]),W=0,O===X.TILE_SIZE?(R=5*X.PIXEL_BUFFER,ea+da<R?(V.push([O,0]),W=-O):ea+da>X.TILE_SIZE-R&&(V.push([-O,
0]),W=O)):ea+da<-X.PIXEL_BUFFER?(V.push([O,0]),W=-O):ea+da>X.TILE_SIZE+X.PIXEL_BUFFER&&(V.push([-O,0]),W=O),da+=ea;I.points=V};aa._wrapPoint=function(I,O){const R=I.geometry;if(O===X.TILE_SIZE){const V=5*X.PIXEL_BUFFER;R.x<V?I.geometry={points:[[R.x,R.y],[O,0]]}:R.x>X.TILE_SIZE-V&&(I.geometry={points:[[R.x,R.y],[-O,0]]})}else R.x<-X.PIXEL_BUFFER?I.geometry={points:[[R.x,R.y],[O,0]]}:R.x>X.TILE_SIZE+X.PIXEL_BUFFER&&(I.geometry={points:[[R.x,R.y],[-O,0]]})};aa._processGraphics=function(I,O,R){if(!O||
!O.length||!this._meshFactory)return Promise.resolve(null);const V=T.GraphicsReader.from(O,this.uid,I.transform),W=this._meshFactory;return this._matcher.then(da=>W.analyzeGraphics(V,this.container.stage.resourceManager,da,null,null,R).then(()=>{this._attributeStore.sendUpdates();return this._processAnalyzedGraphics(I,V)}))};aa._processAnalyzedGraphics=function(I,O){const R=this._meshFactory;var V=O.getSize();O=O.getCursor();const W=new F.MeshData(I.key.id,{features:V,records:V,metrics:0},w.WGLSymbologyType.DEFAULT,
!1,!1);for(V=[];O.next();){const da=O.readGraphic();da.insertAfter=-1===da.insertAfter?-1:this._displayIds.get(da.insertAfter);da.displayId=this._displayIds.get(da.attributes[this.uid]);const ea=new E(da.displayId);ea.insertAfter=da.insertAfter;V.push(ea);R.writeGraphic(W,O,I.level,this.container.stage.resourceManager)}I=W.serialize(I.tileInfoView.tileInfo.isWrappable);return 1!==I.length?new C.TileData:C.TileData.fromVertexData(I[0].message,V)};aa._abortProcessingGraphic=function(I){this._graphicIdToAbortController.get(I)?.abort()};
aa._getNullSymbol=function(I){I=I.geometry;return k.isPolyline(I)?y.errorPolylineSymbol2D:k.isPolygon(I)||k.isExtent(I)?y.errorPolygonSymbol2D:this.defaultPointSymbolEnabled?y.errorPointSymbol2D:null};aa._flipUpdatingGraphics=function(){this._updatingGraphicsTimer&&clearTimeout(this._updatingGraphicsTimer);this._updatingGraphicsTimer=setTimeout(()=>{this._updatingGraphicsTimer=null;this.notifyChange("updating")},160);this.notifyChange("updating")};m._createClass(ba,[{key:"updating",get:function(){return!this._attached||
null!==this._updatingGraphicsTimer||0<this._tileUpdateSet.size||0<this._tilesToUpdate.size||this._attributeStore.isUpdating()}}]);return ba}(P.GraphicsView(u.HandleOwnerMixin(D)));p.__decorate([b.property({constructOnly:!0})],D.prototype,"requestUpdateCallback",void 0);p.__decorate([b.property()],D.prototype,"container",void 0);p.__decorate([b.property({constructOnly:!0})],D.prototype,"graphics",void 0);p.__decorate([b.property()],D.prototype,"updating",null);p.__decorate([b.property()],D.prototype,
"view",void 0);p.__decorate([b.property()],D.prototype,"updateRequested",void 0);p.__decorate([b.property()],D.prototype,"defaultPointSymbolEnabled",void 0);return D=p.__decorate([c.subclass("esri.views.2d.layers.support.GraphicsView2D")],D)})},"esri/geometry/support/normalizeUtilsSync":function(){define("exports ../../core/maybe ./aaBoundingRect ./boundsUtils ./coordsUtils ./jsonUtils ./normalizeUtilsCommon ./spatialReferenceUtils".split(" "),function(m,p,D,B,u,t,h,l){function e(v,q){if(p.isNone(v))return null;
var y=v.spatialReference,A=l.getInfo(y);v="toJSON"in v?v.toJSON():v;if(!A)return v;y=l.isWebMercator(y)?102100:4326;const w=h.cutParams[y].maxX,z=h.cutParams[y].minX;if(t.isPoint(v))return d(v,w,z);if(t.isMultipoint(v))v.points=v.points.map(C=>d(C,w,z));else{if(t.isExtent(v))return b(v,A);if(t.isPolygon(v)||t.isPolyline(v)){y=B.getBoundsXY(x,v);A=y[0];y=y[2];const C=2*h.offsetMagnitude(A,z)*w;v=0===C?v:h.updatePolyGeometry(v,C);A+=C;y+=C;return y>w?n(v,w,q):A<z?n(v,z,q):v}}return v}function b(v,q){if(!q)return v;
const y=a(v,q).map(A=>A.extent);return 2>y.length?y[0]||v:2<y.length?(v.xmin=q.valid[0],v.xmax=q.valid[1],v):{rings:y.map(A=>[[A.xmin,A.ymin],[A.xmin,A.ymax],[A.xmax,A.ymax],[A.xmax,A.ymin],[A.xmin,A.ymin]])}}function d(v,q,y){if(Array.isArray(v)){var A=v[0];A>q?(y=h.offsetMagnitude(A,q),v[0]=A+-2*y*q):A<y&&(q=h.offsetMagnitude(A,y),v[0]=A+-2*q*y)}else A=v.x,A>q?(y=h.offsetMagnitude(A,q),v.x+=-2*y*q):A<y&&(q=h.offsetMagnitude(A,y),v.x+=-2*q*y);return v}function a(v,q){const y=[],{ymin:A,ymax:w,xmin:z,
xmax:C}=v;var E=v.xmax-v.xmin;const [F,G]=q.valid,{x:H,frameId:L}=c(v.xmin,q),{x:K,frameId:M}=c(v.xmax,q);v=H===K&&0<E;if(E>2*G){E={xmin:z<C?H:K,ymin:A,xmax:G,ymax:w};v={xmin:F,ymin:A,xmax:z<C?K:H,ymax:w};q={xmin:0,ymin:A,xmax:G,ymax:w};const U={xmin:F,ymin:A,xmax:0,ymax:w},T=[],Z=[];f(E,q)&&T.push(L);f(E,U)&&Z.push(L);f(v,q)&&T.push(M);f(v,U)&&Z.push(M);for(let X=L+1;X<M;X++)T.push(X),Z.push(X);y.push(new k(E,[L]),new k(v,[M]),new k(q,T),new k(U,Z))}else H>K||v?y.push(new k({xmin:H,ymin:A,xmax:G,
ymax:w},[L]),new k({xmin:F,ymin:A,xmax:K,ymax:w},[M])):y.push(new k({xmin:H,ymin:A,xmax:K,ymax:w},[L]));return y}function c(v,q){const [y,A]=q.valid;q=2*A;var w=0;v>A?(w=Math.ceil(Math.abs(v-A)/q),v-=w*q):v<y&&(w=Math.ceil(Math.abs(v-y)/q),v+=w*q,w=-w);return{x:v,frameId:w}}function f(v,q){const {xmin:y,ymin:A,xmax:w,ymax:z}=q;return g(v,y,A)&&g(v,y,z)&&g(v,w,z)&&g(v,w,A)}function g(v,q,y){return q>=v.xmin&&q<=v.xmax&&y>=v.ymin&&y<=v.ymax?!0:!1}function n(v,q,y=!0){const A=!t.isPolyline(v);A&&u.closeRings(v);
if(y)return(new r).cut(v,q);y=A?v.rings:v.paths;const w=A?4:2,z=y.length;q*=-2;for(let C=0;C<z;C++){const E=y[C];if(E&&E.length>=w){const F=[];for(const G of E)F.push([G[0]+q,G[1]]);y.push(F)}}A?v.rings=y:v.paths=y;return v}let k=function(v,q){this.extent=v;this.frameIds=q};const x=D.create();let r=function(){function v(){this._linesIn=[];this._linesOut=[]}var q=v.prototype;q.cut=function(y,A){this._xCut=A;if(y.rings)this._closed=!0,A=y.rings,this._minPts=4;else if(y.paths)this._closed=!1,A=y.paths,
this._minPts=2;else return null;for(var w of A)if(w&&!(w.length<this._minPts)){A=!0;for(const z of w)A?(this.moveTo(z),A=!1):this.lineTo(z);this._closed&&this.close()}this._pushLineIn();this._pushLineOut();A=[];for(const z of this._linesIn)z&&z.length>=this._minPts&&A.push(z);w=-2*this._xCut;for(const z of this._linesOut)if(z&&z.length>=this._minPts){for(const C of z)C[0]+=w;A.push(z)}this._closed?y.rings=A:y.paths=A;return y};q.moveTo=function(y){this._pushLineIn();this._pushLineOut();this._prevSide=
this._side(y[0]);this._moveTo(y[0],y[1],this._prevSide);this._firstPt=this._prevPt=y};q.lineTo=function(y){const A=this._side(y[0]);if(-1===A*this._prevSide){const w=this._intersect(this._prevPt,y);this._lineTo(this._xCut,w,0);this._prevSide=0}this._lineTo(y[0],y[1],A);this._prevSide=A;this._prevPt=y};q.close=function(){const y=this._firstPt,A=this._prevPt;y[0]===A[0]&&y[1]===A[1]||this.lineTo(y);this._checkClosingPt(this._lineIn);this._checkClosingPt(this._lineOut)};q._moveTo=function(y,A,w){this._closed?
(this._lineIn.push([0>=w?y:this._xCut,A]),this._lineOut.push([0<=w?y:this._xCut,A])):(0>=w&&this._lineIn.push([y,A]),0<=w&&this._lineOut.push([y,A]))};q._lineTo=function(y,A,w){this._closed?(this._addPolyVertex(this._lineIn,0>=w?y:this._xCut,A),this._addPolyVertex(this._lineOut,0<=w?y:this._xCut,A)):0>w?(0===this._prevSide&&this._pushLineOut(),this._lineIn.push([y,A])):0<w?(0===this._prevSide&&this._pushLineIn(),this._lineOut.push([y,A])):0>this._prevSide?(this._lineIn.push([y,A]),this._lineOut.push([y,
A])):0<this._prevSide&&(this._lineOut.push([y,A]),this._lineIn.push([y,A]))};q._addPolyVertex=function(y,A,w){const z=y.length;1<z&&y[z-1][0]===A&&y[z-2][0]===A?y[z-1][1]=w:y.push([A,w])};q._checkClosingPt=function(y){const A=y.length;3<A&&y[0][0]===this._xCut&&y[A-2][0]===this._xCut&&y[1][0]===this._xCut&&(y[0][1]=y[A-2][1],y.pop())};q._side=function(y){return y<this._xCut?-1:y>this._xCut?1:0};q._intersect=function(y,A){return y[1]+(this._xCut-y[0])/(A[0]-y[0])*(A[1]-y[1])};q._pushLineIn=function(){this._lineIn&&
this._lineIn.length>=this._minPts&&this._linesIn.push(this._lineIn);this._lineIn=[]};q._pushLineOut=function(){this._lineOut&&this._lineOut.length>=this._minPts&&this._linesOut.push(this._lineOut);this._lineOut=[]};return v}();m.CutVertical=r;m.normalizeCentralMeridianForDisplay=function(v){return e(v,!1)};m.normalizeCentralMeridianSync=function(v){return e(v,!0)};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/projectionSupport":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),
function(m,p,D,B,u,t,h){function l(n,k){if(!k)return null;if("x"in k){var x={x:0,y:0};[x.x,x.y]=n(k.x,k.y,a);null!=k.z&&(x.z=k.z);null!=k.m&&(x.m=k.m);return x}return"xmin"in k?(x={xmin:0,ymin:0,xmax:0,ymax:0},[x.xmin,x.ymin]=n(k.xmin,k.ymin,a),[x.xmax,x.ymax]=n(k.xmax,k.ymax,a),k.hasZ&&(x.zmin=k.zmin,x.zmax=k.zmax,x.hasZ=!0),k.hasM&&(x.mmin=k.mmin,x.mmax=k.mmax,x.hasM=!0),x):"rings"in k?{rings:e(k.rings,n),hasM:k.hasM,hasZ:k.hasZ}:"paths"in k?{paths:e(k.paths,n),hasM:k.hasM,hasZ:k.hasZ}:"points"in
k?{points:b(k.points,n),hasM:k.hasM,hasZ:k.hasZ}:null}function e(n,k){const x=[];for(const r of n)x.push(b(r,k));return x}function b(n,k){const x=[];for(const r of n)n=k(r[0],r[1],[0,0]),x.push(n),2<r.length&&n.push(r[2]),3<r.length&&n.push(r[3]);return x}function d(){d=p._asyncToGenerator(function*(n,k){n&&k&&(n=Array.isArray(n)?n.map(x=>D.isSome(x.geometry)?x.geometry.spatialReference:null).filter(D.isSome):[n],yield B.initializeProjection(n.map(x=>({source:x,dest:k}))))});return d.apply(this,arguments)}
const a=[0,0],c=l.bind(null,h.lngLatToXY),f=l.bind(null,h.xyToLngLat),g=new (function(){function n(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}var k=n.prototype;k.push=function(){var x=p._asyncToGenerator(function*(r,v,q){if(!(r&&r.length&&v&&q)||t.equals(v,q))return r;const y={geometries:r,inSpatialReference:v,outSpatialReference:q,resolve:null};this._jobs.push(y);return new Promise(A=>{y.resolve=A;null===this._timer&&(this._timer=setTimeout(this._process,10))})});return function(r,
v,q){return x.apply(this,arguments)}}();k._process=function(){this._timer=null;const x=this._jobs.shift();if(x){var {geometries:r,inSpatialReference:v,outSpatialReference:q,resolve:y}=x;h.canProject(v,q)?t.isWebMercator(q)?y(r.map(c)):y(r.map(f)):y(B.projectMany(u.jsonAdapter,r,v,q,null,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return n}());m.checkProjectionSupport=function(n,k){return d.apply(this,arguments)};m.project=function(n,k,x,r){if(!n)return n;x||(x=k,k=n.spatialReference);
return t.isValid(k)&&t.isValid(x)&&!t.equals(k,x)?h.canProject(k,x)?(n=t.isWebMercator(x)?c(n):f(n),n.spatialReference=x,n):B.projectMany(u.jsonAdapter,[n],k,x,null,r)[0]:n};m.projectMany=function(n,k,x){return g.push(n,k,x)};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/geometryAdapters/json":function(){define(["exports"],function(m){let p=function(h,l,e){this.x=h;this.y=l;this.spatialReference=e;this.m=this.z=void 0},D=function(h,l,e,b){this.rings=h;this.spatialReference=
l;this.hasM=this.hasZ=void 0;e&&(this.hasZ=e);b&&(this.hasM=b)},B=function(h,l,e,b){this.paths=h;this.spatialReference=l;this.hasM=this.hasZ=void 0;e&&(this.hasZ=e);b&&(this.hasM=b)},u=function(h,l,e,b){this.points=h;this.spatialReference=l;this.hasM=this.hasZ=void 0;e&&(this.hasZ=e);b&&(this.hasM=b)},t=function(h,l,e,b,d){this.xmin=h;this.ymin=l;this.xmax=e;this.ymax=b;this.spatialReference=d;this.mmax=this.mmin=this.zmax=this.zmin=void 0};m.jsonAdapter={convertToGEGeometry:function(h,l){return null==
l?null:h.convertJSONToGeometry(l)},exportPoint:function(h,l,e){e=new p(h.getPointX(l),h.getPointY(l),e);const b=h.hasZ(l),d=h.hasM(l);b&&(e.z=h.getPointZ(l));d&&(e.m=h.getPointM(l));return e},exportPolygon:function(h,l,e){return new D(h.exportPaths(l),e,h.hasZ(l),h.hasM(l))},exportPolyline:function(h,l,e){return new B(h.exportPaths(l),e,h.hasZ(l),h.hasM(l))},exportMultipoint:function(h,l,e){return new u(h.exportPoints(l),e,h.hasZ(l),h.hasM(l))},exportExtent:function(h,l,e){var b=h.hasZ(l);const d=
h.hasM(l);e=new t(h.getXMin(l),h.getYMin(l),h.getXMax(l),h.getYMax(l),e);b&&(b=h.getZExtent(l),e.zmin=b.vmin,e.zmax=b.vmax);d&&(h=h.getMExtent(l),e.mmin=h.vmin,e.mmax=h.vmax);return e}};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/GraphicTile":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ./DirtyMap ./DisplayRecordStore ./WGLBuffers ./WGLTile".split(" "),function(m,p,D,B,u,t){t=function(h){function l(){var b=h.apply(this,arguments)||
this;b._data=null;b._displayList=null;b._lastCommitTime=0;b._hasData=!1;b._invalidated=!1;b._wglBuffers=null;b._dirtyMap=new D;return b}p._inheritsLoose(l,h);var e=l.prototype;e.destroy=function(){h.prototype.destroy.call(this);this.clear()};e.getGeometry=function(b){return this._wglBuffers&&this._wglBuffers.has(b)?this._wglBuffers.get(b):null};e.getDisplayList=function(){return this._displayList};e.patch=function(b){if(!0===b.clear)this.clear(),this._hasData=!1;else{var d=b.addOrUpdate,a=b.remove;
!this._data&&d&&d.tileDisplayData?.displayObjects.length?(d.tileDisplayData.computeDisplayList(),this._dirtyMap=new D,this._dispRecStore=B.fromTileData(d,this._dirtyMap),this._data=d,this._dirtyMap.markAllDirty(),this._hasData=!0,b.end&&this.ready()):this._data?d&&d.tileDisplayData?.displayObjects.length||a.length?this._doPatchData(b):b.end&&this.ready():b.end&&this.ready();b.end&&!this._data&&this.clear();this.requestRender();this.emit("change")}};e.commit=function(b){if(!b.time||b.time!==this._lastCommitTime)if(this._lastCommitTime=
b.time,this.visible&&this._data&&(this._wglBuffers||(this._wglBuffers=new u(b.context)),this._dirtyMap.hasDirty()||this._invalidated))this._invalidated=!1,this._wglBuffers.upload(this._data.tileBufferData,this._dirtyMap),this._displayList=this._data.tileDisplayData.displayList.clone(),this._displayObjects=this._data.tileDisplayData.displayObjects.slice(),this._dirtyMap.markAllClean()};e.clear=function(){this._dispRecStore=this._displayList=this._data=null;this._wglBuffers&&(this._wglBuffers.dispose(),
this._wglBuffers=null)};e._doPatchData=function(b){this._invalidated=!0;this._patchData(b)||(this._dirtyMap.markAllDirty(),this._data.reshuffle(),this._dispRecStore=B.fromTileData(this._data,this._dirtyMap));this.requestRender()};e._patchData=function(b){let d=!0;var a=b.addOrUpdate&&b.addOrUpdate.tileDisplayData&&b.addOrUpdate.tileDisplayData.displayObjects||[],c=(b.remove||[]).slice();for(var f of a)null!=f.insertAfter&&c.push(f.id);let g;0<c.length&&(g=new Set(c));f=this._data.tileDisplayData;
for(var n of c)if(c=f.displayObjectRegistry.get(n)){f.displayList.removeFromList(c.displayRecords);for(var k of c.displayRecords)this._dispRecStore.delete(k);f.displayObjectRegistry.delete(n)}g?.size&&(f.displayObjects=f.displayObjects.filter(y=>!g.has(y.id)));for(const y of a){a=f.displayObjectRegistry.get(y.id);let A;if(a){n=a.displayRecords;a.set(y);a.displayRecords=n;n=a.displayRecords.length;for(k=0;k<n;++k){c=a.displayRecords[k];var x=y.displayRecords[k];if(k>=y.displayRecords.length||c.geometryType!==
x.geometryType||c.symbolLevel!==x.symbolLevel||c.zOrder!==x.zOrder||c.materialKey!==x.materialKey)this._dispRecStore.delete(a.displayRecords[k]),k<y.displayRecords.length&&(a.displayRecords[k]=void 0)}a.displayRecords.length=y.displayRecords.length}else if(a=y.copy(),a.displayRecords=[],f.displayObjectRegistry.set(y.id,a),n=f.displayObjects,null!=a.insertAfter?(A={},0<=a.insertAfter?(k=f.displayObjectRegistry.get(a.insertAfter))?(x=n.indexOf(k)+1,x<n.length?n.splice(x,0,a):(n.push(a),x=n.length)):
(n.push(a),x=n.length):(n.unshift(a),x=0)):(n.push(a),x=n.length),A)for(k=0<y.displayRecords.length?1:0,c=0,--x;0<=x&&c<k;--x)for(var r=n[x].displayRecords.length-1;0<=r&&c<k;--r){var v=n[x].displayRecords[r],q=f.displayList.getDPInfoType();A[q]||(A[q]=v,++c)}n=y.displayRecords.length;for(k=0;k<n;++k){c=y.displayRecords[k];(x=a.displayRecords[k])?(x.meshData=c.meshData,x.materialKey=c.materialKey):(x=c.copy(),x.vertexFrom=void 0,x.indexFrom=void 0,a.displayRecords[k]=x);v=c.geometryType;r=f.displayList.getDPInfoType();
q=b.addOrUpdate.tileBufferData.geometries[v];v=q.vertexBuffer;q=q.indexBuffer;let w=void 0;A&&(w=A[r]?f.displayList.splitAfter(A[r]):-1);d=this._dispRecStore.setMeshData(x,c,v,q,w)&&d;A&&null!=x.indexFrom&&null!=x.indexFrom&&(A[r]=x)}}return d};p._createClass(l,[{key:"hasData",get:function(){return!!this._hasData}},{key:"displayObjects",get:function(){return this._displayObjects??[]}}]);return l}(t.WGLTile);m.GraphicTile=t;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/DirtyMap":function(){define(function(){return function(){function m(){this._dirties=
[{vertexFrom:-1,vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1},{vertexFrom:-1,vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1},{vertexFrom:-1,vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1},{vertexFrom:-1,vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1},{vertexFrom:-1,vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1}]}var p=m.prototype;p.hasDirty=function(){return this._dirties.some(D=>-1!==D.indexCount||D.allDirty)};p.markAllClean=function(){for(const D of this._dirties)D.indexFrom=
-1,D.indexCount=-1,D.vertexFrom=-1,D.vertexCount=-1,D.allDirty=!1};p.markAllDirty=function(){for(const D of this._dirties)D.allDirty=!0};p.forEach=function(D){for(let B=0;B<this._dirties.length;++B){const {indexCount:u,indexFrom:t,vertexCount:h,vertexFrom:l,allDirty:e}=this._dirties[B],b={};let d=void 0,a=!1;if(e||-1!==l&&0<h)b.geometry={count:h,from:l,allDirty:e},a=!0;if(e||-1!==t&&0<u)d={count:u,from:t,allDirty:e},a=!0;a&&D({indices:d,vertices:b},B)}};p.markDirtyIndices=function(D,B,u){D=this._dirties[D];
if(!D.allDirty)if(-1!==D.indexCount){const t=Math.min(D.indexFrom,B);B=Math.max(D.indexFrom+D.indexCount,B+u)-t;D.indexFrom=t;D.indexCount=B}else D.indexFrom=B,D.indexCount=u};p.markDirtyVertices=function(D,B,u,t){D=this._dirties[D];D.allDirty||(-1!==D.vertexCount?(B=Math.min(D.vertexFrom,u),u=Math.max(D.vertexFrom+D.vertexCount,u+t)-B,D.vertexFrom=B,D.vertexCount=u):(D.vertexFrom=u,D.vertexCount=t))};return m}()})},"esri/views/2d/engine/webgl/DisplayRecordStore":function(){define(["../../../../core/has",
"./FreeList","./Utils"],function(m,p,D){const B=["FILL","LINE","MARKER","TEXT","LABEL"];return function(){function u(h,l,e,b){this._strides=h;this._displayList=l;this._freeListsAndStorage={};this._dirtyMap=null;this._dirtyMap=e;for(const d in h){this._freeListsAndStorage[d]={vtxFreeList:b?new p.FreeList(b):null,idxFreeList:b?new p.FreeList(b):null,vertexBuffers:{},indexBuffer:b?new Uint32Array(b):null};for(const a in h[d])this._freeListsAndStorage[d].vertexBuffers[a]={data:b?D.allocateTypedArrayBuffer(b,
h[d][a]):null,stride:h[d][a]}}}u.fromTileData=function(h,l){var e=h.getStrides(),b={};for(var d=0;d<e.length;d++)b[B[d]]=e[d];e=[0,0,0,0,0];d=[0,0,0,0,0];for(var a of h.tileDisplayData.displayObjects)for(var c of a.displayRecords)e[c.geometryType]=Math.max(e[c.geometryType],c.vertexFrom+c.vertexCount),d[c.geometryType]=Math.max(d[c.geometryType],c.indexFrom+c.indexCount);l=new u(b,h.tileDisplayData.displayList,l,void 0);h=h.tileBufferData?.geometries??[];for(b=0;b<h.length;++b){a=e[b];var f=d[b],
g=h[b];c=l._storageFor(B[b]);var n=h[b].indexBuffer;c.indexBuffer=n;c.idxFreeList=new p.FreeList(n.length);c.idxFreeList.allocate(f);f=0;for(const k in g.vertexBuffer)g=h[b].vertexBuffer[k],c.vertexBuffers[k].data=g.data,c.vertexBuffers[k].stride=g.stride,n=D.strideToPackingFactor(g.stride),g=g.data.length*n/g.stride,f||(f=g);c.vtxFreeList=new p.FreeList(f);c.vtxFreeList.allocate(a)}return l};var t=u.prototype;t.delete=function(h){const l=B[h.geometryType];this._freeVertices(l,h.vertexFrom,h.vertexCount);
this._freeIndices(l,h.indexFrom,h.indexCount);this._displayList.removeFromList(h);h.vertexFrom=void 0;h.indexFrom=void 0};t.setMeshData=function(h,l,e,b,d){const a=B[h.geometryType];h.meshData=null;let c=void 0,f=void 0;void 0===h.vertexFrom?(f=l.vertexCount,c=this._allocateVertices(a,f)):l.vertexCount>h.vertexCount?(this._freeVertices(a,h.vertexFrom,h.vertexCount),f=l.vertexCount,c=this._allocateVertices(a,f)):l.vertexCount===h.vertexCount?(c=h.vertexFrom,f=h.vertexCount):(this._freeVertices(a,h.vertexFrom+
l.vertexCount,h.vertexCount-l.vertexCount),c=h.vertexFrom,f=l.vertexCount);let g=!0,n=void 0,k=void 0,x=void 0;void 0===h.indexFrom?(n=d,x=l.indexCount,k=this._allocateIndices(a,x)):l.indexCount>h.indexCount?(n=this._displayList.removeFromList(h),this._freeIndices(a,h.indexFrom,h.indexCount),x=l.indexCount,k=this._allocateIndices(a,x)):l.indexCount===h.indexCount?(g=!1,k=h.indexFrom,x=h.indexCount):(n=this._displayList.removeFromList(h),this._freeIndices(a,h.indexFrom+l.indexCount,h.indexCount-l.indexCount),
k=h.indexFrom,x=l.indexCount);if(-1!==c&&-1!==k){d=this._storageFor(a);D.copyMeshData(c,k,d.vertexBuffers,d.indexBuffer,l,e,b);h.vertexFrom=c;h.indexFrom=k;h.vertexCount=l.vertexCount;h.indexCount=l.indexCount;if(this._dirtyMap){this._dirtyMap.markDirtyIndices(h.geometryType,h.indexFrom,h.indexCount);for(const r in e)this._dirtyMap.markDirtyVertices(h.geometryType,r,h.vertexFrom,h.vertexCount)}g&&this._displayList.addToList(h,n);return!0}-1!==c&&this._freeVertices(a,c,f);-1!==k&&this._freeIndices(a,
k,x);h.setMeshDataFromBuffers(l,e,b);h.vertexFrom=void 0;h.vertexCount=0;h.indexFrom=void 0;h.indexCount=0;return!1};t.tryAddMeshData=function(h,l){const e=l.vertexBuffer;l=l.indexBuffer;var b=B[h.geometryType];const d=this._allocateVertices(b,h.vertexCount);if(-1===d)return this._freeVertices(b,d,h.vertexCount),!1;const a=this._allocateIndices(b,h.indexCount);if(-1===a)return this._freeVertices(b,d,h.vertexCount),this._freeIndices(b,a,h.indexCount),!1;b=this._storageFor(b);D.copyMeshData(d,a,b.vertexBuffers,
b.indexBuffer,h,e,l);h.vertexFrom=d;h.indexFrom=a;if(this._dirtyMap){this._dirtyMap.markDirtyIndices(h.geometryType,h.indexFrom,h.indexCount);for(const c in e)this._dirtyMap.markDirtyVertices(h.geometryType,c,d,h.vertexCount)}this._displayList.addToList(h);return!0};t._allocateVertices=function(h,l){h=this._storageFor(h);l=h.vtxFreeList?.allocate(l);if(null==l||-1===l)return-1;h=h.vtxFreeList?.fragmentation;return null==h||.5<h?-1:l};t._freeVertices=function(h,l,e){this._storageFor(h).vtxFreeList?.free(l,
e)};t._freeIndices=function(h,l,e){this._storageFor(h).idxFreeList?.free(l,e)};t._allocateIndices=function(h,l){h=this._storageFor(h);l=h.idxFreeList?.allocate(l);if(null==l||-1===l)return-1;h=h.idxFreeList?.fragmentation;return null==h||.5<h?-1:l};t._storageFor=function(h){return this._freeListsAndStorage[h]};t._stridesFor=function(h,l){return this._strides[h][l]};return u}()})},"esri/views/2d/engine/webgl/FreeList":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers"],function(m,
p){let D=function(){function u(h){this._largestRange=null;this._parent=h;this._updateLargestRange()}var t=u.prototype;t.rangeCreated=function(h){if(!this._largestRange||h.count>this._largestRange.count)this._largestRange=h};t.rangeResized=function(h,l){if(h===this._largestRange)h.count<l&&this._updateLargestRange();else if(!this._largestRange||h.count>this._largestRange.count)this._largestRange=h};t.findBestRange=function(h){let l=this._parent._freeHead,e=null;for(;null!==l;)l.count>=h&&(!e||l.count-
h<e.count-h)&&(e=l),l=l.next;return e};t.findAdjacentRanges=function(h,l){let e=!0,b=!1,d=null,a=this._parent._freeHead;for(;e&&!b;){const c=null!==a?a.from:this._parent._size;h>=(null!==d?d.from+d.count:0)&&h+l<=c?(e=!1,b=!0):null!==a?(d=a,a=a.next):e=!1}return[d,a]};t._updateLargestRange=function(){let h=null,l=this._parent._freeHead;for(;null!==l;){if(!h||l.count>h.count)h=l;l=l.next}this._largestRange=h};p._createClass(u,[{key:"largestRange",get:function(){return this._largestRange}}]);return u}(),
B=function(){function u(h,l){this._allocated=0;this._size=h;this._freeHead=0<h?{from:0,count:h,prev:null,next:null}:null;this._bookKeeper=l||new D(this);this._freeHead&&this._bookKeeper.rangeCreated(this._freeHead)}var t=u.prototype;t.allocate=function(h){const l=this._bookKeeper.findBestRange(h);if(null==l)return-1;const e=l.from,b=l.count;l.from+=h;l.count-=h;this._bookKeeper.rangeResized(l,e,b);this._allocated+=h;0===l.count&&(h=null!==l.prev?this._freeHead:l.next,u._removeRange(l),this._freeHead=
h);return e};t.free=function(h,l){const [e,b]=this._bookKeeper.findAdjacentRanges(h,l);h={from:h,count:l,prev:e??null,next:b??null};null!=e&&(e.next=h);null!=b&&(b.prev=h);this._bookKeeper.rangeCreated(h);this._allocated-=l;if(null!=b&&h.from+h.count===b.from){l=h.from;var d=h.count;u._fuse(h,b);u._removeRange(b);this._bookKeeper.rangeResized(h,l,d);this._bookKeeper.rangeResized(b,void 0,0)}null!=e&&e.from+e.count===h.from&&(l=e.from,d=e.count,u._fuse(e,h),u._removeRange(h),this._bookKeeper.rangeResized(e,
l,d),this._bookKeeper.rangeResized(h,void 0,0));this._freeHead=null!==h.prev?this._freeHead:h};u._removeRange=function(h){null!==h.prev?null!==h.next?(h.prev.next=h.next,h.next.prev=h.prev):h.prev.next=null:null!==h.next&&(h.next.prev=null)};u._fuse=function(h,l){h.count+=l.count;h.next=l.next;l.from+=l.count;l.count=0;null!==l.next&&(l.next.prev=h)};p._createClass(u,[{key:"fragmentation",get:function(){const h=this._size-this._allocated;return 0===h?0:1-this._bookKeeper.largestRange.count/h}}]);
return u}();m.FreeList=B;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/WGLBuffers":function(){define(["./Utils","../../../webgl/BufferObject","../../../webgl/enums","../../../webgl/VertexArrayObject"],function(m,p,D,B){return function(){function u(h){this.geometryMap=m.createGeometryData(()=>({indexBuffer:p.BufferObject.createIndex(h,D.Usage.STATIC_DRAW),vao:null}),(l,e)=>({vertexBuffer:p.BufferObject.createVertex(h,m.C_VBO_INFO[e])}))}var t=u.prototype;
t.dispose=function(){for(let h=0;5>h;h++){const l=this.geometryMap[h];if(l){l.data.vao&&l.data.vao.dispose(!1);l.data.indexBuffer&&l.data.indexBuffer.dispose();for(const e in l.buffers)l.buffers[e]&&l.buffers[e].data.vertexBuffer.dispose()}}};t.get=function(h){const l=this.geometryMap[h];return{getVAO(e,b,d){if(!l.data.vao){const a={};for(const c in l.buffers)a[c]=l.buffers[c].data.vertexBuffer;l.data.vao=new B.VertexArrayObject(e,d,b,a,l.data.indexBuffer)}return l.data.vao}}};t.has=function(h){return null!=
this.geometryMap[h]};t.upload=function(h,l){l.forEach((e,b)=>{this._upload(e,b,h)})};t._upload=function(h,l,e){h.indices&&(h.indices.allDirty?this._uploadIndices(e,l):null!=h.indices.from&&null!=h.indices.count&&this._uploadIndices(e,l,h.indices.from,h.indices.count));if(h.vertices){h=h.vertices;for(const b in h){const d=h[b];d.allDirty?this._uploadVertices(e,l,b):null!=d.from&&null!=d.count&&this._uploadVertices(e,l,b,d.from,d.count)}}};t._uploadVertices=function(h,l,e,b,d){const a=this.geometryMap[l];
if(a&&(h=h.geometries[l].vertexBuffer[e])){var {data:c,stride:f}=h;a.buffers[e]&&0<c.length&&(h=f/c.BYTES_PER_ELEMENT,null!=b&&null!=d?a.buffers[e].data.vertexBuffer.setSubData(c,b*h,b*h,(b+d)*h):a.buffers[e].data.vertexBuffer.setData(c))}};t._uploadIndices=function(h,l,e,b){const d=this.geometryMap[l];d&&(h=h.geometries[l].indexBuffer,d.data.indexBuffer&&0<h.length&&(null!=e&&null!=b?d.data.indexBuffer.setSubData(h,e,e,e+b):d.data.indexBuffer.setData(h)))};return u}()})},"esri/views/2d/engine/webgl/WGLTile":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/mat2d ../../../../chunks/mat2df32 ../../../../chunks/mat3 ../../../../chunks/mat3f32 ./definitions ./TiledDisplayObject".split(" "),
function(m,p,D,B,u,t,h,l){let e=function(){function b(){}var d=b.prototype;d.acquire=function(a){return{refCount:1,version:-1,labelMat2d:B.create(),tileMat3:t.create(),dvs:t.create()}};d.release=function(a){};return b}();l=function(b){function d(c,f,g,n){return b.call(this,c,f,g,n,h.TILE_SIZE,h.TILE_SIZE)||this}p._inheritsLoose(d,b);var a=d.prototype;a.destroy=function(){b.prototype.destroy.call(this);this._transforms&&d.TransformCache.release(this.key.hash)};a.setTransform=function(c){var f=this.resolution/
c.resolution,g=this.transforms.tileMat3;const [n,k]=c.toScreenNoRotation([0,0],[this.x,this.y]);var x=this.width/this.rangeX*f;f*=this.height/this.rangeY;u.set(g,x,0,0,0,f,0,n,k,1);u.multiply(this.transforms.dvs,c.displayViewMat3,g);g=this.transforms.labelMat2d;const r=window.devicePixelRatio;x=D.set(B.create(),x*r,0,0,f*r,n*r,k*r);D.multiply(g,c.viewMat2d,x)};a._createTransforms=function(){return d.TransformCache.acquire(this.key.hash)};return d}(l.TiledDisplayObject);l.TransformCache=new e;m.WGLTile=
l;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/TiledDisplayObject":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/mat3","../DisplayObject","../../tiling/TileKey"],function(m,p,D,B,u){B=function(t){function h(e,b,d,a,c,f,g=c,n=f){var k=t.call(this)||this;k.triangleCountReportedInDebug=0;k.triangleCount=0;k.texture=null;k.key=new u(e);k.resolution=b;k.x=d;k.y=a;k.width=c;k.height=f;k.rangeX=g;k.rangeY=n;
return k}p._inheritsLoose(h,t);var l=h.prototype;l.destroy=function(){this.texture&&(this.texture.dispose(),this.texture=null)};l.setTransform=function(e){const b=this.resolution/(e.resolution*e.pixelRatio),d=this.transforms.tileMat3,[a,c]=e.toScreenNoRotation([0,0],[this.x,this.y]);D.set(d,this.width/this.rangeX*b,0,0,0,this.height/this.rangeY*b,0,a,c,1);D.multiply(this.transforms.dvs,e.displayViewMat3,d)};return h}(B.DisplayObject);m.TiledDisplayObject=B;Object.defineProperty(m,Symbol.toStringTag,
{value:"Module"})})},"esri/views/2d/engine/webgl/TileData":function(){define("exports ../../../../core/maybe ./enums ./MemoryRequirements ./TileBufferData ./TileDisplayData ./Utils ./WGLDisplayRecord ./cpuMapped/DisplayRecordReader ./mesh/VertexBuffer ./mesh/VertexVector ./util/Writer".split(" "),function(m,p,D,B,u,t,h,l,e,b,d,a){const c=new B,f=new B;B=function(){function g(){this.tileBufferData=this.tileDisplayData=null}var n=g.prototype;n.reshuffle=function(){c.reset();if(this.tileDisplayData){var k=
[[],[],[],[],[]],x=this.tileDisplayData.displayObjects;for(var r of x)for(var v of r.displayRecords)k[v.geometryType].push(v);for(var q of k)for(var y of q)y&&c.needMore(y.geometryType,y.meshData?y.meshData.vertexCount:y.vertexCount,y.meshData?y.meshData.indexData.length:y.indexCount);x=k.length;r=new u;for(v=0;v<x;++v)if(r.geometries[v].indexBuffer=new Uint32Array(Math.round(1.5*c.indicesFor(v))),y=[],q=this.tileBufferData?.geometries[v].vertexBuffer){for(var A in q)y.push(q[A].stride);y=g._computeVertexAlignment(y);
var w=Math.round(1.5*c.verticesFor(v));y=g._align(w,y);for(var z in q)w=q[z].stride,r.geometries[v].vertexBuffer[z]={stride:w,data:h.allocateTypedArrayBuffer(y,w)}}f.reset();this.tileDisplayData.displayList?.clear();for(A=0;A<x;++A){z=k[A];for(const F of z){if(F.meshData)F.writeMeshDataToBuffers(f.verticesFor(A),r.geometries[A].vertexBuffer,f.indicesFor(A),r.geometries[A].indexBuffer),F.meshData=null;else if(v=this.tileBufferData?.geometries[A]){z=v.vertexBuffer;v=v.indexBuffer;q=r.geometries[A].vertexBuffer;
y=r.geometries[A].indexBuffer;w=f.verticesFor(A);const G=f.indicesFor(A);h.copyMeshData(w,G,q,y,F,z,v);F.vertexFrom=w;F.indexFrom=G}f.needMore(A,F.vertexCount,F.indexCount)}}var {displayList:C,displayObjects:E}=this.tileDisplayData;if(C)for(const F of E)C.addToList(F.displayRecords);this.tileBufferData=r}};n.getStrides=function(){const k=[],x=this.tileBufferData?.geometries;if(!x)return k;for(let r=0;r<x.length;++r){const v=x[r];k[r]={};for(const q in v.vertexBuffer)k[r][q]=v.vertexBuffer[q].stride}return k};
n.clone=function(){const k=new g;k.tileBufferData=this.tileBufferData?.clone()??null;k.tileDisplayData=this.tileDisplayData?.clone()??null;return k};n._guessSize=function(){const k=this.tileDisplayData?.displayObjects??[],x=Math.min(k.length,4);let r=0;for(let v=0;v<x;v++)r=Math.max(r,k[v].displayRecords.length);return 2*(12*k.length+k.length*r*40)};n.serialize=function(){const k=this.tileBufferData.serialize(),x=this.tileBufferData.getBuffers(),r=this.tileDisplayData.serialize(new a(Int32Array,this._guessSize())).buffer();
x.push(r);return{result:{displayData:r,bufferData:k},transferList:x}};g.fromVertexData=function(k,x){const r={},v=new Map;for(const q of x)v.set(q.id,q);h.forEachGeometryType(q=>{const y=k.data[q];if(p.isSome(y)){const w=e.DisplayRecordReader.from(y.records).getCursor();for(;w.next();){var A=w.id;const z=w.materialKey,C=w.indexFrom,E=w.indexCount,F=w.vertexFrom,G=w.vertexCount,H=v.get(A);A=new l(A,q,z);A.indexFrom=C;A.indexCount=E;A.vertexFrom=F;A.vertexCount=G;H.displayRecords.push(A)}r[q]=b.VertexBuffers.fromVertexData(y,
q)}else r[q]=(new d.VertexVectors(q,0,D.WGLSymbologyType.DEFAULT)).intoBuffers()});return g.fromMeshData({displayObjects:x,vertexBuffersMap:r})};g.fromMeshData=function(k){const x=new g,r=new t,v=new u;r.displayObjects=k.displayObjects;for(const q in k.vertexBuffersMap){const y=k.vertexBuffersMap[q];v.geometries[q].indexBuffer=y.indexBuffer;v.geometries[q].vertexBuffer=y.namedBuffers}x.tileDisplayData=r;x.tileBufferData=v;return x};g.bind=function(k,x){const r=new g;r.tileDisplayData=k;r.tileBufferData=
x;return r};g.create=function(k,x){const r=new g;r.tileDisplayData=new t;r.tileDisplayData.displayObjects=k;const v=[0,0,0,0,0],q=[0,0,0,0,0],y=[[],[],[],[],[]];for(var A of k)for(var w of A.displayRecords)y[w.geometryType].push(w),v[w.geometryType]+=w.meshData.vertexCount,q[w.geometryType]+=w.meshData.indexData.length;k=new u;x=[x.fill||{},x.line||{},x.icon||{},x.text||{},x.label||{}];for(A=0;5>A;A++){w=new Uint32Array(q[A]);var z=x[A],C=v[A];const E={};for(const F in z){const G={data:h.allocateTypedArrayBuffer(C,
z[F]),stride:z[F]};E[F]=G}z=E;l.writeAllMeshDataToBuffers(y[A],z,w);k.geometries[A]={indexBuffer:w,vertexBuffer:z}}r.tileBufferData=k;return r};g._align=function(k,x){const r=k%x;return 0===r?k:k+(x-r)};g._computeVertexAlignment=function(k){let x=!1,r=!1;for(const v of k)2===v%4?x=!0:0!==v%4&&(r=!0);return r?4:x?2:1};return g}();m.TileData=B;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/MemoryRequirements":function(){define(["../../../../chunks/_rollupPluginBabelHelpers"],
function(m){return function(){function p(){this._byGeometryType=null}var D=p.prototype;D.reset=function(){this._byGeometryType=null};D.verticesFor=function(B){return this._byGeometryType?this._byGeometryType[B].vertices:0};D.indicesFor=function(B){return this._byGeometryType?this._byGeometryType[B].indices:0};D.needMore=function(B,u,t){if(u||t)this._byGeometryType||(this._byGeometryType=[{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0}]),
B=this._byGeometryType[B],B.vertices+=u,B.indices+=t};m._createClass(p,[{key:"satisfied",get:function(){return!this._byGeometryType}}]);return p}()})},"esri/views/2d/engine/webgl/TileBufferData":function(){define(["./Utils"],function(m){return function(){function p(){this.geometries=[{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}}]}var D=p.prototype;D.clone=function(){const B=
new p;for(let u=0;u<this.geometries.length;u++){const t=this.geometries[u],h=B.geometries[u];h.indexBuffer=t.indexBuffer.slice();h.vertexBuffer={};for(const l in t.vertexBuffer){const {data:e,stride:b}=t.vertexBuffer[l];h.vertexBuffer[l]={data:e.slice(),stride:b}}}return B};p.deserialize=function(B){const u=new p;for(let t=0;5>t;++t){u.geometries[t].indexBuffer=new Uint32Array(B.geometries[t].indexBuffer);u.geometries[t].vertexBuffer={};for(const h in B.geometries[t].vertexBuffer)u.geometries[t].vertexBuffer[h]=
{data:m.allocateTypedArrayBufferwithData(B.geometries[t].vertexBuffer[h].data,B.geometries[t].vertexBuffer[h].stride),stride:B.geometries[t].vertexBuffer[h].stride}}return u};D.serialize=function(){const B={geometries:[{indexBuffer:this.geometries[0].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[1].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[2].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[3].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[4].indexBuffer.buffer,
vertexBuffer:{}}]};for(let u=0;5>u;++u)for(const t in this.geometries[u].vertexBuffer)B.geometries[u].vertexBuffer[t]={data:this.geometries[u].vertexBuffer[t].data.buffer,stride:this.geometries[u].vertexBuffer[t].stride};return B};D.getBuffers=function(){const B=[];for(let u=0;5>u;++u){B.push(this.geometries[u].indexBuffer.buffer);for(const t in this.geometries[u].vertexBuffer)B.push(this.geometries[u].vertexBuffer[t].data.buffer)}return B};return p}()})},"esri/views/2d/engine/webgl/TileDisplayData":function(){define(["../../../../chunks/_rollupPluginBabelHelpers",
"./GraphicDisplayList","./WGLDisplayObject","./util/serializationUtils"],function(m,p,D,B){return function(){function u(){this.displayObjects=[];this._displayList=null}var t=u.prototype;t.computeDisplayList=function(){this._displayList=new p;for(const h of this.displayObjects)for(const l of h.displayRecords)this._displayList.addToList(l)};t.clone=function(){const h=new u;this.displayObjects&&(h.displayObjects=this.displayObjects.map(l=>l.clone()));return h};t.serialize=function(h){B.serializeList(h,
this.displayObjects);return h};t._deserializeObjects=function(h){var l=h.readInt32();l=Array(l);const e=new Map;for(let b=0;b<l.length;++b){const d=D.deserialize(h);l[b]=d;e.set(d.id,d)}this.displayObjects=l;this._displayList=null;this._displayObjectRegistry=e};u.deserialize=function(h){const l=new u;l._deserializeObjects(h);return l};m._createClass(u,[{key:"displayObjectRegistry",get:function(){if(!this._displayObjectRegistry){this._displayObjectRegistry=new Map;for(const h of this.displayObjects)this._displayObjectRegistry.set(h.id,
h)}return this._displayObjectRegistry}},{key:"displayList",get:function(){return this._displayList}}]);return u}()})},"esri/views/2d/engine/webgl/GraphicDisplayList":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","./materialKey/MaterialKey"],function(m,p){function D(e,b,d,...a){b<e.length?e.splice(b,d,...a):e.push(...a)}let B=function(){function e(){this.symbolLevels=[]}var b=e.prototype;b.replay=function(d,a,c){for(const n of this.symbolLevels)for(const k of n.zLevels){var f=k.geometryDPInfo.unified;
if(f)for(const x of f){const {geometryType:r,materialKey:v,indexFrom:q,indexCount:y}=x;f=p.MaterialKeyBase.load(v).symbologyType;f=d.painter.getBrush(r,f);var g=a.getGeometry(r);g={geometryType:r,materialKey:v,indexFrom:q,indexCount:y,target:g};f.prepareState(d);f.drawGeometry(d,a,g,c)}}};b.clear=function(){this.symbolLevels.length=0};b.addToList=function(d,a){if(Array.isArray(d))for(const c of d)this._addToList(c,a);else this._addToList(d,a)};b.removeFromList=function(d){Array.isArray(d)||(d=[d]);
let a=null;for(const c of d)a=this._removeFromList(c);return a};b.clone=function(){const d=new e;for(const a of this.symbolLevels)d.symbolLevels.push(a.clone());return d};b.splitAfter=function(d){const a=this._getDisplayList(d.symbolLevel,d.zOrder),c=a.length,f=d.indexFrom+d.indexCount;for(let g=0;g<c;++g){const n=a[g];if(n.geometryType===d.geometryType&&f>n.indexFrom&&f<=n.indexFrom+n.indexCount)return f<n.indexFrom+n.indexCount&&(d=new u,d.geometryType=n.geometryType,d.materialKey=n.materialKey,
d.indexFrom=f,d.indexCount=n.indexFrom+n.indexCount-f,a.splice(g+1,0,d),n.indexCount=f-n.indexFrom),g}};b._addToList=function(d,a){const c=this._getDisplayList(d.symbolLevel,d.zOrder);a=null!=a?a:c.length-1;var f=0<=a&&a<c.length?c[a]:null;null!==f&&f.materialKey===d.materialKey&&f.indexFrom+f.indexCount===d.indexFrom&&f.geometryType===d.geometryType?f.indexCount+=d.indexCount:(f=new u,f.indexFrom=d.indexFrom,f.indexCount=d.indexCount,f.materialKey=d.materialKey,f.geometryType=d.geometryType,D(c,
a+1,0,f))};b._removeFromList=function(d){const a=this._getDisplayList(d.symbolLevel,d.zOrder);var c=a.length;let f=void 0;for(var g=0;g<c;++g){var n=a[g];if(d.indexFrom+d.indexCount>n.indexFrom&&d.indexFrom<n.indexFrom+n.indexCount&&n.geometryType===d.geometryType){f=g;break}}if(void 0!==f){c=a[f];if(d.indexFrom===c.indexFrom)return c.indexCount-=d.indexCount,c.indexFrom+=d.indexCount,0===c.indexCount&&D(a,f,1),f-1;if(d.indexFrom+d.indexCount===c.indexFrom+c.indexCount)return c.indexCount-=d.indexCount,
0===c.indexCount?(D(a,f,1),f-1):f;g=c.indexFrom;n=d.indexFrom-c.indexFrom;const k=d.indexCount;d=c.indexFrom+c.indexCount-(d.indexFrom+d.indexCount);c.indexCount=n;const x=new u;x.geometryType=c.geometryType;x.materialKey=c.materialKey;x.indexFrom=g+n+k;x.indexCount=d;D(a,f+1,0,x);return f}return null};b._getDisplayList=function(d,a){let c;var f=this.symbolLevels.length;for(let n=0;n<f;n++)if(this.symbolLevels[n].symbolLevel===d){c=this.symbolLevels[n];break}c||(c=new l,c.symbolLevel=d,this.symbolLevels.push(c));
let g;d=c.zLevels.length;for(f=0;f<d;f++)if(c.zLevels[f].zLevel===a){g=c.zLevels[f];break}g||(g=new h,g.geometryDPInfo=new t,g.zLevel=a,c.zLevels.push(g));g.geometryDPInfo.unified||(g.geometryDPInfo.unified=[]);return g.geometryDPInfo.unified};b.getDPInfoType=function(){return"unified"};m._createClass(e,[{key:"empty",get:function(){return!this.symbolLevels||0===this.symbolLevels.length}}]);return e}(),u=function(){function e(){this.materialKey=null;this.indexCount=this.indexFrom=0}e.prototype.clone=
function(){const b=new e;b.geometryType=this.geometryType;b.materialKey=this.materialKey;b.indexFrom=this.indexFrom;b.indexCount=this.indexCount;return b};return e}(),t=function(){function e(){this.unified=this.label=this.text=this.marker=this.line=this.fill=null}e.prototype.clone=function(){const b=new e;b.fill=this.fill&&this.fill.map(d=>d.clone());b.line=this.line&&this.line.map(d=>d.clone());b.marker=this.marker&&this.marker.map(d=>d.clone());b.text=this.text&&this.text.map(d=>d.clone());b.label=
this.label&&this.label.map(d=>d.clone());b.unified=this.unified&&this.unified.map(d=>d.clone());return b};return e}(),h=function(){function e(){this.geometryDPInfo=new t}e.prototype.clone=function(){const b=new e;b.zLevel=this.zLevel;b.geometryDPInfo=this.geometryDPInfo.clone();return b};return e}(),l=function(){function e(){this.zLevels=[]}e.prototype.clone=function(){const b=new e;b.symbolLevel=this.symbolLevel;for(const d of this.zLevels)b.zLevels.push(d.clone());return b};return e}();return B})},
"esri/views/2d/engine/webgl/WGLDisplayObject":function(){define(["./WGLDisplayRecord","./util/serializationUtils"],function(m,p){return function(){function D(u){this.insertAfter=null;this.id=u;this.displayRecords=[]}var B=D.prototype;B.copy=function(){const u=new D(this.id);u.set(this);return u};B.clone=function(){const u=new D(this.id);u.displayRecords=this.displayRecords.map(t=>t.clone());u.insertAfter=this.insertAfter;return u};B.set=function(u){this.id=u.id;this.displayRecords=u.displayRecords;
this.insertAfter=u.insertAfter};B.serialize=function(u){u.push(this.id);p.serializeList(u,this.displayRecords);return u};D.deserialize=function(u){const t=u.readInt32(),h=new D(t);h.displayRecords=p.deserializeList(u,m,{id:t})??[];return h};return D}()})},"esri/views/2d/engine/webgl/WGLDisplayRecord":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","./MeshData","./Utils"],function(m,p,D){return function(){function B(t,h,l,e=0,b=0){this.id=t;this.geometryType=h;this.materialKey=l;
this.minZoom=e;this.maxZoom=b;this.meshData=null;this.indexCount=this.indexFrom=this.vertexCount=this.vertexFrom=this.zOrder=this.symbolLevel=0;this._sortKey=null}var u=B.prototype;u.clone=function(){return this.copy()};u.copy=function(){const t=new B(this.id,this.geometryType,this.materialKey);t.vertexFrom=this.vertexFrom;t.vertexCount=this.vertexCount;t.indexFrom=this.indexFrom;t.indexCount=this.indexCount;t.zOrder=this.zOrder;t.symbolLevel=this.symbolLevel;t.meshData=this.meshData;t.minZoom=this.minZoom;
t.maxZoom=this.maxZoom;return t};u.setMeshDataFromBuffers=function(t,h,l){const e=new p;for(const b in h){const d=h[b].stride,a=h[b].data;if(!a)continue;const c=[],f=D.strideToPackingFactor(d);for(let g=0;g<d*t.vertexCount/f;++g)c[g]=a[g+d*t.vertexFrom/f];e.vertexData.set(b,c)}e.indexData.length=0;for(h=0;h<t.indexCount;++h)e.indexData[h]=l[h+t.indexFrom]-t.vertexFrom;e.vertexCount=t.vertexCount;this.meshData=e};u.readMeshDataFromBuffers=function(t,h){this.meshData?this.meshData.clear():this.meshData=
new p;for(const l in t){const e=t[l].stride,b=t[l].data,d=[],a=D.strideToPackingFactor(e);for(let c=0;c<e*this.vertexCount/a;++c)d[c]=b[c+e*this.vertexFrom/a];this.meshData.vertexData.set(l,d)}this.meshData.indexData.length=0;for(t=0;t<this.indexCount;++t)this.meshData.indexData[t]=h[t+this.indexFrom]-this.vertexFrom;this.meshData.vertexCount=this.vertexCount};u.writeMeshDataToBuffers=function(t,h,l,e){if(this.meshData){for(const b in h){const d=h[b].stride,a=this.meshData.vertexData.get(b),c=h[b].data,
f=D.strideToPackingFactor(d);for(let g=0;g<d*this.meshData.vertexCount/f;++g)c[g+d*t/f]=a[g]}for(h=0;h<this.meshData.indexData.length;++h)e[h+l]=this.meshData.indexData[h]+t;this.vertexFrom=t;this.vertexCount=this.meshData.vertexCount;this.indexFrom=l;this.indexCount=this.meshData.indexData.length}};B.writeAllMeshDataToBuffers=function(t,h,l){let e=0,b=0;for(const d of t)d.writeMeshDataToBuffers(e,h,b,l),e+=d.vertexCount,b+=d.indexCount};u._computeSortKey=function(){this._sortKey=(this.symbolLevel&
31)<<12|(this.zOrder&127)<<4|this.geometryType&7};u.serialize=function(t){t.push(this.geometryType);t.push(this.materialKey);t.push(this.vertexFrom);t.push(this.vertexCount);t.push(this.indexFrom);t.push(this.indexCount);t.push(this.minZoom);t.push(this.maxZoom);return t};B.deserialize=function(t,h){const l=t.readInt32(),e=t.readInt32();h=new B(h.id,l,e);h.vertexFrom=t.readInt32();h.vertexCount=t.readInt32();h.indexFrom=t.readInt32();h.indexCount=t.readInt32();h.minZoom=t.readInt32();h.maxZoom=t.readInt32();
return h};m._createClass(B,[{key:"sortKey",get:function(){null==this._sortKey&&this._computeSortKey();return this._sortKey}}]);return B}()})},"esri/views/2d/engine/webgl/MeshData":function(){define(function(){return function(){function m(){this.vertexData=new Map;this.vertexCount=0;this.indexData=[]}var p=m.prototype;p.clear=function(){this.vertexData.clear();this.vertexCount=0;this.indexData=[]};p.update=function(D,B,u){for(const t in D)this.vertexData.set(t,D[t]);for(const t in this.vertexData)null===
D[t]&&this.vertexData.delete(t);this.vertexCount=B;this.indexData=u};return m}()})},"esri/views/2d/engine/webgl/util/serializationUtils":function(){define(["exports"],function(m){m.deserializeList=function(p,D,B){var u=p.readInt32();u=Array(u);for(let t=0;t<u.length;t++)u[t]=D.deserialize(p,B);return u};m.serializeList=function(p,D){if(null===D)p.push(0);else{p.push(D.length);for(const B of D)B.serialize(p);return p}};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/cpuMapped/DisplayRecordReader":function(){define(["exports",
"../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe","../definitions"],function(m,p,D,B){let u=function(){function h(e){this._cursor=this._head=e}h.from=function(e,b=0,d=e.byteLength/t.BYTES_PER_RECORD-b){e=new t(new Int32Array(e,b*t.BYTES_PER_RECORD,d*t.ELEMENTS_PER_RECORD));return new h(e)};var l=h.prototype;l.size=function(){let e=this._cursor,b=0;for(;e;)b+=e.size(),e=e._link;return b};l.seekIndex=function(e){for(this._cursor=this._head;this._cursor;){const b=this._cursor.size();
if(e<b)return this._cursor._index=e,!0;e-=b;this._cursor=this._cursor._link}return!1};l.forEach=function(e){const b=this.getCursor();for(;b.next();)e(b)};l.link=function(e){if(this._head){for(var b=this._head;b._link;)b=b._link;b._link=e._head;b._link._indexStart=b._indexStart+b.size()}else this._head=e._head};l.getCursor=function(){return this.copy()};l.lookup=function(e){for(this._cursor=this._head;this._cursor&&!this._cursor.lookup(e);){if(!this._cursor._link)return!1;this._cursor=this._cursor._link}return!!this._cursor};
l.copy=function(){const e=new h(this._head?.copy());if(!e._head)return e;let b=e._head,d=e._head._link;for(;d;)b._link=d.copy(),b=d,d=b._link;return e};l.next=function(){if(!this._cursor)return!1;if(!this._cursor.next()){if(!this._cursor._link)return!1;this._cursor=this._cursor._link;return this.next()}return!0};l.peekId=function(){return this._cursor.peekId()??this._cursor._link.peekId()};l.delete=function(e){let b=this._head,d=null;for(;b;){if(b.delete(e))return b.isEmpty()&&(D.isSome(d)&&(d._link=
b._link),b===this._head&&(this._head=b._link),b===this._cursor&&(this._cursor=b._link)),!0;d=b;b=b._link}return!1};p._createClass(h,[{key:"id",get:function(){return this._cursor.id},set:function(e){this._cursor.id=e}},{key:"materialKey",get:function(){return this._cursor.materialKey},set:function(e){this._cursor.materialKey=e}},{key:"insertAfter",get:function(){return this._cursor.insertAfter}},{key:"indexFrom",get:function(){return this._cursor.indexFrom},set:function(e){this._cursor.indexFrom=e}},
{key:"indexCount",get:function(){return this._cursor.indexCount},set:function(e){this._cursor.indexCount=e}},{key:"vertexFrom",get:function(){return this._cursor.vertexFrom},set:function(e){this._cursor.vertexFrom=e}},{key:"vertexCount",get:function(){return this._cursor.vertexCount},set:function(e){this._cursor.vertexCount=e}},{key:"sortKey",get:function(){return this._cursor.sortKey},set:function(e){this._cursor.sortKey=e}},{key:"index",get:function(){return this._cursor._indexStart+this._cursor._index}}]);
return h}();u.ELEMENTS_PER_RECORD=B.DISPLAY_RECORD_INT_PER_ELEMENT;u.BYTES_PER_RECORD=u.ELEMENTS_PER_RECORD*Int32Array.BYTES_PER_ELEMENT;let t=function(){function h(e){this._link=null;this._index=-1;this._indexStart=0;this._packedRecordsF32=null;this._deletedCount=0;this._offsets={instance:null};this._packedRecords=e}h.from=function(e,b=0,d=e.byteLength/this.BYTES_PER_RECORD-b){return new h(new Int32Array(e,b*this.BYTES_PER_RECORD,d*this.ELEMENTS_PER_RECORD))};var l=h.prototype;l.delete=function(e){const b=
this._index,d=this.lookup(e);if(d)for(this.id=2147483647,++this._deletedCount;this.next()&&this.id===e;)this.id=2147483647,++this._deletedCount;this._index=b;return d};l.isEmpty=function(){return this._deletedCount===this.size()};l.link=function(e){this._link?this._link.link(e):this._link=e};l.lookup=function(e){if(D.isNone(this._offsets.instance)){this._offsets.instance=new Map;var b=this.copy();b._index=-1;let d=0;for(;b.next();)b.id!==d&&(this._offsets.instance.set(b.id,b._index),d=b.id)}if(!this._offsets.instance.has(e))return!1;
b=this._index;this._index=this._offsets.instance.get(e);return 2147483647===this.id?(this._index=b,!1):!0};l.size=function(){return this._packedRecords.length/h.ELEMENTS_PER_RECORD};l.next=function(){for(;++this._index<this.size()&&2147483647===this.id;);return this._index<this.size()};l.peekId=function(){const e=(this._index+1)*h.ELEMENTS_PER_RECORD;return e>=this._packedRecords.length?0:this._packedRecords[e]};l.getCursor=function(){return this.copy()};l.copy=function(){const e=new h(this._packedRecords);
e._indexStart=this._indexStart;e._link=this._link;e._index=this._index;e._offsets=this._offsets;e._deletedCount=this._deletedCount;return e};p._createClass(h,[{key:"id",get:function(){return this._packedRecords[this._index*h.ELEMENTS_PER_RECORD]},set:function(e){this._packedRecords[this._index*h.ELEMENTS_PER_RECORD]=e}},{key:"materialKey",get:function(){return this._packedRecords[this._index*h.ELEMENTS_PER_RECORD+1]},set:function(e){this._packedRecords[this._index*h.ELEMENTS_PER_RECORD+1]=e}},{key:"insertAfter",
get:function(){return this._packedRecords[this._index*h.ELEMENTS_PER_RECORD+2]}},{key:"indexFrom",get:function(){return this._packedRecords[this._index*h.ELEMENTS_PER_RECORD+3]},set:function(e){this._packedRecords[this._index*h.ELEMENTS_PER_RECORD+3]=e}},{key:"indexCount",get:function(){return this._packedRecords[this._index*h.ELEMENTS_PER_RECORD+4]},set:function(e){this._packedRecords[this._index*h.ELEMENTS_PER_RECORD+4]=e}},{key:"vertexFrom",get:function(){return this._packedRecords[this._index*
h.ELEMENTS_PER_RECORD+5]},set:function(e){this._packedRecords[this._index*h.ELEMENTS_PER_RECORD+5]=e}},{key:"vertexCount",get:function(){return this._packedRecords[this._index*h.ELEMENTS_PER_RECORD+6]},set:function(e){this._packedRecords[this._index*h.ELEMENTS_PER_RECORD+6]=e}},{key:"sortKey",get:function(){this._packedRecordsF32||(this._packedRecordsF32=new Float32Array(this._packedRecords.buffer));return this._packedRecordsF32[this._index*h.ELEMENTS_PER_RECORD+7]},set:function(e){this._packedRecordsF32||
(this._packedRecordsF32=new Float32Array(this._packedRecords.buffer));this._packedRecordsF32[this._index*h.ELEMENTS_PER_RECORD+7]=e}},{key:"index",get:function(){return this._index}}]);return h}();t.ELEMENTS_PER_RECORD=B.DISPLAY_RECORD_INT_PER_ELEMENT;t.BYTES_PER_RECORD=t.ELEMENTS_PER_RECORD*Int32Array.BYTES_PER_ELEMENT;m.DisplayRecordReader=u;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/VertexBuffer":function(){define(["exports","../Utils"],function(m,
p){let D=function(){function u(t,h){this.data=t;this.stride=h}u.decode=function(t){const h=p.allocateTypedArrayBufferwithData(t.data,t.stride);return new u(h,t.stride)};u.fromVertexVector=function(t){const h=p.allocateTypedArrayBufferwithData(t.data.buffer(),t.stride);return new u(h,t.stride)};return u}(),B=function(){function u(t,h,l){this.geometryType=t;this.indexBuffer=new Uint32Array(h);this.namedBuffers=l}u.decode=function(t){const h=t.geometryType,l=t.indexBuffer,e={};for(const b in t.namedBuffers)e[b]=
D.decode(t.namedBuffers[b]);return new u(h,l,e)};u.fromVertexData=function(t,h){const l=t.indices,e=p.allocateTypedArrayBufferwithData(t.vertices,t.stride);t={geometry:new D(e,t.stride)};return new u(h,l,t)};u.fromVertexVectors=function(t){const h=t.geometryType,l=t.indexVector.buffer(),e={};for(const b in t.namedVectors)e[b]=D.fromVertexVector(t.namedVectors[b]);return new u(h,l,e)};return u}();m.VertexBuffers=B;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/VertexVector":function(){define(["exports",
"../../../../../chunks/_rollupPluginBabelHelpers","../Utils","./VertexBuffer","../util/Writer"],function(m,p,D,B,u){let t=function(){function l(e,b){this.data=e;this.stride=b}l.prototype.transfer=function(e,b){const d=this.data.buffer();e.vertexCount=this.vertexCount;e.data=d;e.stride=this.stride;b.push(d)};p._createClass(l,[{key:"vertexCount",get:function(){const e=this.data.length/(this.stride/4);e!==(e|0)&&console.debug("Corrupted stride");return e}}]);return l}(),h=function(){function l(b,d,a){this.geometryType=
b;this.indexVector=new u(Uint32Array,6*d);this.namedVectors={};b=D.getStrides(b,a);for(const c in b){a=b[c];let f;switch(a%4){case 0:case 2:f=new u(Uint32Array,a*d);break;case 1:case 3:f=new u(Uint8Array,a*d)}this.namedVectors[c]=new t(f,a)}}var e=l.prototype;e.get=function(b){return this.namedVectors[b].data};e.getVector=function(b){return this.namedVectors[b]};e.transfer=function(b,d){const a=this.indexVector.buffer(),c={};d.push(a);for(const f in this.namedVectors){const g=this.namedVectors[f];
c[f]={};g.transfer(c[f],d)}b.geometryType=this.geometryType;b.indexBuffer=a;b.namedBuffers=c;this.destroy()};e.intoBuffers=function(){const b=B.VertexBuffers.fromVertexVectors(this);this.destroy();return b};e.destroy=function(){this.namedVectors=this.indexVector=null};return l}();m.VertexVector=t;m.VertexVectors=h;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/util/Writer":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers"],function(m){return function(){function p(B,
u){this._pos=0;u=u?this._roundToNearest(u,B.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(u);this._buffer=new B(this._array);this._ctor=B;this._i16View=new Int16Array(this._array)}var D=p.prototype;D._roundToNearest=function(B,u){B=Math.round(B);return B+(u-B%u)};D._ensureSize=function(B){if(this._pos+B>=this._buffer.length){B=this._roundToNearest(1.25*(this._array.byteLength+B*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT);B=new ArrayBuffer(B);const u=new this._ctor(B);u.set(this._buffer,
0);this._array=B;this._buffer=u;this._i16View=new Int16Array(this._array)}};D.ensureSize=function(B){this._ensureSize(B)};D.writeF32=function(B){this._ensureSize(1);const u=this._pos;(new Float32Array(this._array,4*this._pos,1))[0]=B;this._pos++;return u};D.push=function(B){this._ensureSize(1);const u=this._pos;this._buffer[this._pos++]=B;return u};D.writeFixed=function(B){this._buffer[this._pos++]=B};D.setValue=function(B,u){this._buffer[B]=u};D.i1616Add=function(B,u,t){this._i16View[2*B]+=u;this._i16View[2*
B+1]+=t};D.getValue=function(B){return this._buffer[B]};D.incr=function(B){if(this._buffer.length<B)throw Error("Increment index overflows the target buffer");this._buffer[B]++};D.decr=function(B){this._buffer[B]--};D.writeRegion=function(B){this._ensureSize(B.length);const u=this._pos;this._buffer.set(B,this._pos);this._pos+=B.length;return u};D.writeManyFrom=function(B,u,t){for(this._ensureSize(t-u);u!==t;u++)this.writeFixed(B._buffer[u])};D.buffer=function(){const B=this._array.slice(0,4*this._pos);
this.destroy();return B};D.toArray=function(){const B=this._array,u=[];for(let t=0;t<B.byteLength/4;t++)u.push(B[t]);return u};D.seek=function(B){this._pos=B};D.destroy=function(){this._buffer=this._array=null};m._createClass(p,[{key:"length",get:function(){return this._pos}}]);return p}()})},"esri/views/2d/engine/webgl/mesh/MeshData":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../tiling/PagedTileQueue ../../../tiling/TileInfoView ../../../tiling/TileKey ../../../tiling/TileQueue ../../../tiling/TileStrategy ../definitions ../DisplayId ../enums ../Utils ./VertexDataWriter ../../../layers/features/support/tileUtils".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d,a,c){function f(n){switch(n){case 1:case 8:case 32:return-1;case 2:case 64:return 0;case 4:case 16:case 128:return 1}}function g(n){switch(n){case 1:case 2:case 4:return-1;case 8:case 16:return 0;case 32:case 64:case 128:return 1}}D=function(){function n(x,r,v,q,y,A=0){this.hasRecords=this._hasAggregate=!1;this._data={self:new Map,neighbors:[]};this._version=0;this._current={geometryType:0,writer:null,overlaps:0,start:0,insertAfter:0,sortKey:0,id:0,materialKey:0,indexStart:0,
vertStart:0,isDotDensity:!1,bufferingEnabled:!1,metricBoxLenPointer:0};this.hint=r;this.tileKey=x;this._hasAggregate=q;this._pixelBufferEnabled=y;this._version=A;this._symbologyType=v}var k=n.prototype;k.serialize=function(x){const r=[];r.push(this._serializeTileVertexData(this.tileKey,this.tileKey,this._data.self));this._data.neighbors.forEach((v,q)=>{var y=1<<q;q=f(y);y=g(y);q=c.getPow2NeighborKey(new u(this.tileKey),q,y,x);q=this._serializeTileVertexData(this.tileKey,q.id,v.vertexData);q.message.bufferIds=
v.displayIds;r.push(q)});return r};k._serializeTileVertexData=function(x,r,v){const q=[];v={[b.WGLGeometryType.MARKER]:v.get(b.WGLGeometryType.MARKER)?.serialize(q),[b.WGLGeometryType.FILL]:v.get(b.WGLGeometryType.FILL)?.serialize(q),[b.WGLGeometryType.LINE]:v.get(b.WGLGeometryType.LINE)?.serialize(q),[b.WGLGeometryType.TEXT]:v.get(b.WGLGeometryType.TEXT)?.serialize(q),[b.WGLGeometryType.LABEL]:v.get(b.WGLGeometryType.LABEL)?.serialize(q)};return{message:{tileKeyOrigin:x,tileKey:r,data:v,version:this._version},
transferList:q}};k.featureStart=function(x,r){this._current.insertAfter=x;this._current.sortKey=r};k.featureEnd=function(){};k.recordStart=function(x,r,v,q){this._current.writer=this._getVertexWriter(v);this._current.overlaps=0;this._current.indexStart=this._current.writer.indexCount;this._current.vertStart=this._current.writer.vertexCount;this._current.bufferingEnabled=q;this._current.id=x;this._current.materialKey=r;this._current.geometryType=v;this._current.isDotDensity=!1;this._current.writer.recordStart()};
k.recordCount=function(){return this._current.writer.recordCount};k.vertexCount=function(){return this._current.writer.vertexCount};k.indexCount=function(){return this._current.writer.indexCount};k.vertexEnsureSize=function(x){this._current.writer.vertexEnsureSize(x)};k.indexEnsureSize=function(x){this._current.writer.indexEnsureSize(x)};k.vertexBounds=function(x,r,v,q){this._current.bufferingEnabled&&this._addOverlap(x,r,v,q)};k.vertexWrite=function(x){this._current.writer.writeVertex(x)};k.vertexWriteF32=
function(x){this._current.writer.writeVertexF32(x)};k.vertexEnd=function(){};k.vertexWriter=function(){return this._current.writer.vertexWriter};k.indexWrite=function(x){this._current.writer.writeIndex(x)};k.indexWriter=function(){return this._current.writer.indexWriter};k.metricWriter=function(){return this._current.writer.metricWriter};k.metricStart=function(x,r,v,q,y,A,w,z){this._current.writer=this._getVertexWriter(b.WGLGeometryType.LABEL);const C=this._current.writer.metricWriter;C.push(e.getDisplayIdTexel(x));
C.push(r);C.push(v);C.push(q);C.push(y);C.push(A);C.push(w);C.push(z);C.push(255);this._current.metricBoxLenPointer=C.push(0)};k.metricEnd=function(){const x=this._current.writer.metricWriter;0===x.getValue(this._current.metricBoxLenPointer)&&x.seek(x.length-10)};k.metricBoxWrite=function(x,r,v,q){const y=this._current.writer.metricWriter;y.incr(this._current.metricBoxLenPointer);y.push(0);y.push(0);y.push(x);y.push(r);y.push(v);y.push(q)};k.recordEnd=function(){var x=this._current.vertStart,r=this._current.writer.vertexCount-
x;if(!r)return!1;this.hasRecords=!0;var v=this._current.indexStart;this._current.writer.recordEnd(this._current.id,this._current.materialKey,this._current.insertAfter,v,this._current.writer.indexCount-v,x,r,this._current.sortKey);if(!this._pixelBufferEnabled||this._hasAggregate||0===this._current.overlaps||this._current.geometryType===b.WGLGeometryType.LABEL)return!0;x=this._current.writer;for(r=0;8>r;r++){var q=1<<r;if(this._current.overlaps&q){this._data.neighbors[r]||(this._data.neighbors[r]={vertexData:new Map,
displayIds:new Set});v=this._data.neighbors[r];var y=this._current.geometryType;if(!v.vertexData.has(y)){var A=d.getStrides(y,this._symbologyType).geometry;A=new a.VertexDataWriter(y,A,l.PATCH_PIXEL_BUFFER_ALLOC_SIZE);v.vertexData.set(y,A)}y=v.vertexData.get(this._current.geometryType);A=4096*-f(q);q=4096*-g(q);y?.copyLastFrom(x,A,q);v.displayIds.add(this._current.id)}}return!0};k._addOverlap=function(x,r,v,q){this._current.overlaps|=255^((x<0+v?148:x>=l.TILE_SIZE-v?41:189)|(r<0+q?224:r>=l.TILE_SIZE-
q?7:231))};k._getVertexWriter=function(x){if(!this._data.self.has(x)){const r=this._data.self,v=d.getStrides(x,this._symbologyType).geometry;r.set(x,new a.VertexDataWriter(x,v,this.hint.records))}return this._data.self.get(x)};p._createClass(n,[{key:"hasAggregates",get:function(){return this._hasAggregate}},{key:"hasPixelBufferEnabled",get:function(){return this._pixelBufferEnabled}}]);return n}();m.MeshData=D;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/DisplayId":function(){define(["exports"],
function(m){m.AGGREGATE_VALID_FILTERS_MASK=254;m.DISPLAY_ID_TEXEL_MASK=8388607;m.DISPLAY_ID_TYPE_AGGREGATE=1;m.DISPLAY_ID_TYPE_FEATURE=0;m.DISPLAY_ID_TYPE_MASK=8388608;m.NONAGGREGATE_VALID_FILTERS_MASK=255;m.createDisplayId=function(p,D){return((D?8388608:0)|p)>>>0};m.getDisplayIdFilterMask=p=>1===(p&8388608)>>>23?254:255;m.getDisplayIdTexel=p=>p&8388607;m.getDisplayIdType=p=>(p&8388608)>>>23;m.isAggregateId=function(p){return 1===(p&8388608)>>>23};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},
"esri/views/2d/engine/webgl/mesh/VertexDataWriter":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../definitions","./heuristics","../util/Writer"],function(m,p,D,B,u){let t=function(){function h(e,b,d){this._start={index:0,vertex:0};d=B.getMeshSizeHint(e,b,d);b/=4;this.geometryType=e;this._records=new u(Int32Array,d.recordBytes);this._indices=new u(Uint32Array,d.indexBytes);this._vertices=new u(Uint32Array,d.vertexBytes);this._metrics=new u(Float32Array,0);this._strideInt=
b}var l=h.prototype;l.serialize=function(e){const b=this._records.buffer(),d=this._indices.buffer(),a=this._vertices.buffer(),c=this._metrics.length?this._metrics.buffer():null,f=4*this._strideInt;e.push(b,d,a);return{stride:f,records:b,indices:d,vertices:a,metrics:c}};l.vertexEnsureSize=function(e){this._vertices.ensureSize(e)};l.indexEnsureSize=function(e){this._indices.ensureSize(e)};l.recordStart=function(){this._start.index=this._indices.length;this._start.vertex=this._vertices.length};l.recordEnd=
function(e,b,d,a,c,f,g,n){this._records.push(e);this._records.push(b??0);this._records.push(d);this._records.push(a);this._records.push(c);this._records.push(f);this._records.push(g);this._records.writeF32(n)};l.writeIndex=function(e){this._indices.push(e)};l.writeVertex=function(e){this._vertices.push(e)};l.writeVertexF32=function(e){this._vertices.writeF32(e)};l.copyLastFrom=function(e,b,d){var a=e._records.length-D.DISPLAY_RECORD_INT_PER_ELEMENT;const c=e._records.getValue(a),f=e._records.getValue(a+
1),g=e._records.getValue(a+2),n=e._records.getValue(a+4),k=e._records.getValue(a+6);a=e._records.getValue(a+7);const x=this._vertices.length;var r=(e._start.vertex-this._vertices.length)/this._strideInt;const v=this._indices.length,q=this.vertexCount;for(var y=e._start.index;y!==e._indices.length;y++){const A=e._indices.getValue(y);this._indices.push(A-r)}for(r=e._start.vertex;r!==e._vertices.length;r++)y=e._vertices.getValue(r),this._vertices.push(y);for(e=x;e<=this._vertices.length;e+=this._strideInt)this._vertices.i1616Add(e,
b,d);this._records.push(c);this._records.push(f);this._records.push(g);this._records.push(v);this._records.push(n);this._records.push(q);this._records.push(k);this._records.push(a)};p._createClass(h,[{key:"strideInt",get:function(){return this._strideInt}},{key:"recordCount",get:function(){return this._records.length/D.DISPLAY_RECORD_INT_PER_ELEMENT}},{key:"vertexCount",get:function(){return this._vertices.length/this._strideInt}},{key:"indexCount",get:function(){return this._indices.length}},{key:"indexWriter",
get:function(){return this._indices}},{key:"vertexWriter",get:function(){return this._vertices}},{key:"metricWriter",get:function(){return this._metrics}}]);return h}();m.VertexDataWriter=t;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/heuristics":function(){define(["exports","../definitions","../enums"],function(m,p,D){const B=new Map;B.set(D.WGLGeometryType.MARKER,{multiplier:1,indicesPerRecord:6,verticesPerRecord:4});B.set(D.WGLGeometryType.LINE,
{multiplier:1,indicesPerRecord:24,verticesPerRecord:8});B.set(D.WGLGeometryType.FILL,{multiplier:1,indicesPerRecord:10,verticesPerRecord:10});B.set(D.WGLGeometryType.TEXT,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});B.set(D.WGLGeometryType.LABEL,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});m.getMeshSizeHint=function(u,t,h){const {indicesPerRecord:l,multiplier:e,verticesPerRecord:b}=B.get(u);return{recordBytes:h*p.DISPLAY_RECORD_INT_PER_ELEMENT*Uint32Array.BYTES_PER_ELEMENT,indexBytes:e*
l*h*Uint32Array.BYTES_PER_ELEMENT,vertexBytes:e*b*h*t}};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/tileUtils":function(){define(["exports"],function(m){m.getPow2NeighborKey=function(p,D,B,u){p=p.clone();const t=1<<p.level;D=p.col+D;B=p.row+B;u&&0>D?(p.col=D+t,--p.world):D>=t?(p.col=D-t,p.world+=1):p.col=D;p.row=B;return p};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/factories/WGLMeshFactory":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../../../../../core/maybe ../../../../../../core/promiseUtils ../../../../../../geometry/libtess ../../DisplayId ../templates/WGLLabelTemplate ../templates/WGLMarkerTemplate ../templates/WGLTemplateStore".split(" "),
function(m,p,D,B,u,t,h,l,e,b){D=function(){function d(c,f,g){this._loadPromise=t.loadLibtess();this._geometryType=c;this._idField=f;this._templateStore=g}var a=d.prototype;a.update=function(c,f){B.isSome(c.mesh.labels)&&(this._labelTemplates=this._createLabelTemplates(c.mesh.labels,f));this._schema=c};a._createLabelTemplates=function(c,f){const g=new Map;if("simple"===c.type){for(var n of c.classes)c=l.fromLabelClass(n,f),g.set(n.index,c);return g}for(const k in c.classes){n=c.classes[k];for(const x of n)n=
l.fromLabelClass(x,f),g.set(x.index,n)}return g};a.analyze=function(){var c=p._asyncToGenerator(function*(f,g,n,k,x,r,v){if(!u.isAborted(v)){var q;"dictionary"===n?.type&&(q=yield n.analyze(this._idField,f.copy(),g,x,r,v));for(g=0;f.next();){var y=null;y=q?q[g++]:B.isSome(k)&&h.isAggregateId(f.getDisplayId())&&1!==f.readAttribute("cluster_count")?k.match(this._idField,f,this._geometryType,x,r):n.match(this._idField,f,this._geometryType,x,r);f.setGroupId(y);if(b.isDynamicId(y)){y=this._templateStore.getDynamicTemplateGroup(y).templates;
for(const A of y)A&&A.analyze&&A.analyze(this._templateStore,f,x,r)}}yield this._loadPromise;return this._templateStore.finalize(v)}});return function(f,g,n,k,x,r,v){return c.apply(this,arguments)}}();a.analyzeGraphics=function(){var c=p._asyncToGenerator(function*(f,g,n,k,x,r){if(!u.isAborted(r)){f=f.getCursor();for(n&&(yield n.analyze(this._idField,f.copy(),g,k,x,r));f.next();){g=f.getGroupId();if(null==g||-1===g)g=n?.match(this._idField,f,f.geometryType,k,x),f.setGroupId(g);if(b.isDynamicId(g)){const v=
this._templateStore.getDynamicTemplateGroup(g).templates;for(const q of v)q&&q.analyze&&q.analyze(this._templateStore,f,k,x)}f.setGroupId(g)}yield this._loadPromise;return this._templateStore.finalize(r)}});return function(f,g,n,k,x,r){return c.apply(this,arguments)}}();a.writeGraphic=function(c,f,g,n){const k=f.getGroupId(),x=f.getDisplayId(),r=this._templateStore.getTemplateGroup(k);c.featureStart(f.insertAfter,0);if(null!=x){if(b.isDynamicId(k))for(const v of r.templates)v&&v.bindFeature(f,null,
null);if(r){for(const v of r.templates)v&&v.write(c,f,g,n);c.featureEnd()}}};a.writeCursor=function(c,f,g,n,k,x,r){const v=f.getGroupId(),q=f.getDisplayId();var y=this._templateStore.getTemplateGroup(v);const A=y.templates;y=this._getSortKeyValue(f,y);c.featureStart(0,y);if(null!=q&&A){if(b.isDynamicId(v))for(const w of A)w.bindFeature(f,g,n);for(const w of A)w.write(c,f,k,r);B.isSome(x)&&c.hasRecords&&(g=x&&this._findLabelRef(A),this._writeLabels(c,f,x,g,k,r));c.featureEnd()}};a._getSortKeyValue=
function(c,f){const g=this._schema.mesh.sortKey;if(B.isNone(g))return 0;let n=0;n=!0===g.byRenderer&&null!=f.sortKey?f.sortKey:null!=g.fieldIndex?c.getComputedNumericAtIndex(g.fieldIndex):null!=g.field?c.readAttribute(g.field):c.readAttribute(this._idField);n*="asc"===g.order?1:-1;return null==n||isNaN(n)?0:n};a._findLabelRef=function(c){for(const f of c)if(f instanceof e)return f;return null};a._writeLabels=function(c,f,g,n,k,x){for(const r of g)if(B.isSome(r)&&r){const {glyphs:v,rtl:q,index:y}=
r;if(g=this._labelTemplates.get(y))g.setZoomLevel(k),g.bindReferenceTemplate(n),g.bindTextInfo(v,q),g.write(c,f,null,x)}};p._createClass(d,[{key:"templates",get:function(){return this._templateStore}}]);return d}();m.WGLMeshFactory=D;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/libtess":function(){define(["require","exports","../chunks/_rollupPluginBabelHelpers","../assets","../core/has"],function(m,p,D,B,u){function t(){t=D._asyncToGenerator(function*(){e||(e=h());
return e});return t.apply(this,arguments)}function h(){return l.apply(this,arguments)}function l(){l=D._asyncToGenerator(function*(){b=yield(u("esri-csp-restrictions")?yield(new Promise((d,a)=>m(["../chunks/libtess-asm"],d,a))).then(d=>d.libtessAsm):yield(new Promise((d,a)=>m(["../chunks/libtess"],d,a))).then(d=>d.libtess)).load({locateFile:d=>B.getAssetUrl(`esri/core/libs/libtess/${d}`)})});return l.apply(this,arguments)}let e=null,b=null;p.loadLibtess=function(){return t.apply(this,arguments)};
p.triangulate=function(d,a){return b.triangulate(d,a,Math.max(d.length,128E3))};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/WGLLabelTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../symbols/cim/enums ../../alignmentUtils ../../color ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./segmentUtils ./WGLTextTemplate".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d,a,c,f,g,n,k){const x=D.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate"),r=(q,y="mapview-labeling")=>x.error(new p(y,q)),v=function(q){const y=new Map;return A=>{y.has(A)||y.set(A,q(A));return y.get(A)}}(q=>{let y=0;if(0===q)return Infinity;for(;!(q%2);)y++,q/=2;return y});return function(q){function y(w,z,C,E){var F=q.call(this,w,C.font?.size,C.haloSize||0,C.font?.size,C.color&&d.premultiplyAlphaRGBAArray(C.color)||0,C.haloColor&&d.premultiplyAlphaRGBAArray(C.haloColor)||
0,C.horizontalAlignment,C.verticalAlignment,b.isMapAligned(z.labelPlacement)?e.Alignment.MAP:e.Alignment.SCREEN,C.font?.decoration,!1,C.angle||0,C.xoffset,C.yoffset,C.lineWidth,C.lineHeight,null,null,!1,null,null,C.backgroundColor&&d.premultiplyAlphaRGBAArray(C.backgroundColor),C.borderLineColor&&d.premultiplyAlphaRGBAArray(C.borderLineColor),C.borderLineSize)||this;F._outLineLabelAngle=0;F._refPlacementPadding=0;F._refPlacementDirX=0;F._refPlacementDirY=0;F._refOffsetX=0;F._refOffsetY=0;F._zoomLevel=
0;F.geometryType=c.WGLGeometryType.LABEL;F._allowOverrun=z.allowOverrun??!1;F._repeatLabel=z.repeatLabel??!0;F._labelPosition=z.labelPosition??"curved";var G=!!z.minScale&&E.scaleToZoom(z.minScale)||0;G=B.clamp(G,0,25.5);E=!!z.maxScale&&E.scaleToZoom(z.maxScale)||255;E=B.clamp(E,0,25.5);const [H,L]=b.getAlignmentFromPlacement(z.labelPlacement);F._xAlignD=H;F._yAlignD=L;F._minZoom=G;F._maxZoom=E;F._minBackgroundZoom=G;F._maxBackgroundZoom=E;F._refPlacementPadding=t.pt2px(C.haloSize)+a.TEXT_PLACEMENT_PADDING;
F._repeatLabelDistance=z.repeatLabelDistance?t.pt2px(z.repeatLabelDistance):128;w=g.LabelMaterialKey.load(w);w.sdf=!0;F._materialKey=w.data;return F}m._inheritsLoose(y,q);y.fromLabelClass=function(w,z){if("esriServerLinePlacementCenterAlong"===w.labelPlacement){const C=w.symbol;C.xoffset=0;C.yoffset=0;C.angle=0;C.font.decoration="none"}return new y(w.materialKey,w,w.symbol,z)};var A=y.prototype;A.setZoomLevel=function(w){this._zoomLevel=w};A.bindReferenceTemplate=function(w){let z=b.getXDirection(this._xAlignD),
C=b.getYDirection(this._yAlignD);this._refOffsetY=this._refOffsetX=0;if(u.isNone(w))this._refSymbolAndPlacementOffset=f.i8888to32(0,0,Math.floor(127*z+127),Math.floor(127*C+127));else{if("circle"===w.boundsType&&(z||C)){var E=Math.sqrt(z*z+C*C);z/=E;C/=E}E=Math.max(w.height,w.width);this._refSymbolAndPlacementOffset=f.i8888to32(4*this._refPlacementPadding,E,Math.floor(127*z+127),Math.floor(127*C+127));this._referenceSize=E;this._refPlacementDirX=z;this._refPlacementDirY=C;this._refOffsetX=w.xOffset;
this._refOffsetY=w.yOffset}};A._write=function(w,z){if(!u.isNone(this._shapingInfo)){var C=this._shapingInfo,E=z.getDisplayId(),F="esriGeometryPolygon"===z.geometryType?z.readLegacyCentroid():z.readLegacyGeometry();if(F)switch(this._current={out:w,inId:E,inShaping:C,zoomLevel:this._zoomLevel},"esriGeometryPolyline"===z.geometryType&&"curved"===this._labelPosition&&(this._borderLineColor||this._backgroundColor)&&x.warnOnce("TextSymbol properties 'borderLineColor', 'borderLineSize', and 'backgroundColor' are not supported in curved labels"),
z.geometryType){case "esriGeometryPolyline":this._placeLineLabels(F);break;case "esriGeometryPoint":case "esriGeometryPolygon":this._placePointLabels(F);break;default:r(`Geometry of type ${z.geometryType} is not supported`)}}};A._isVisible=function(w,z){const C=Math.floor(10*this._current.zoomLevel);return Math.floor(10*w)<=C&&C<=Math.floor(10*z)};A._placePointLabels=function(w){const {out:z,inId:C,inShaping:E}=this._current;this._writeGlyphs(z,C,w,E)};A._placeLineLabels=function(w){w=n.smoothPaths(w.paths,
this._current.inShaping.bounds.width);const z=this._placeSubdivGlyphs.bind(this),C=(this._shapedBox.width+this._repeatLabelDistance)/2;for(const E of w)n.pathDivide(E,C,z,this._repeatLabel)};A._placeSubdivGlyphs=function(w,z,C,E){var F=v(z),G=this._shapedBox.width/2,H=Math.sqrt(this._repeatLabelDistance)/2;C=Math.min(C,E-C);G=this._current.inShaping.isMultiline?25:Math.log2(C/(H+G/2));F=Math.max(this._minZoom,this._current.zoomLevel+1-(0===z?G:Math.min(F,G)));G=this._current.zoomLevel-F;H=this._shapedBox.width/
2*2**G;this._current.inShaping.isMultiline?0===z&&this._placeStraight(w,F):this._allowOverrun&&0>G?this._placeStraightAlong(w,this._minZoom):"parallel"===this._labelPosition?this._placeStraightAlong(w,F):"curved"===this._labelPosition&&this._placeCurved(w,F,H)};A._placeStraight=function(w,z){const {out:C,inId:E,inShaping:F}=this._current,G=Math.ceil((180/Math.PI*w.angle+180)%360);this._outLineLabelAngle=Math.round(254/360*Math.ceil(180/Math.PI*w.angle%360));this._writeGlyphs(C,E,w,F,z);this._outLineLabelAngle=
Math.round(254/360*G);this._writeGlyphs(C,E,w,F,z)};A._placeCurved=function(w,z,C){const {out:E,inId:F}=this._current;E.metricStart(F,z,w.x,w.y,0,0,0,0);const G=w.clone(),H=(180/Math.PI*w.angle+180)%360;this._outLineLabelAngle=Math.round(180/Math.PI*w.angle%360*(254/360));this._placeFirst(G,z,1);this._placeBack(w,G,z,C,1);this._placeForward(w,G,z,C,1);this._outLineLabelAngle=Math.round(254/360*H);this._placeFirst(G,z,0);this._placeBack(w,G,z,C,0);this._placeForward(w,G,z,C,0);E.metricEnd()};A._placeStraightAlong=
function(w,z){const {out:C,inId:E,inShaping:F}=this._current;C.metricStart(E,z,w.x,w.y,0,0,0,0);const G=w.clone(),H=180/Math.PI*w.angle%360,L=(180/Math.PI*w.angle+180)%360;var K=0<F.glyphs.length&&(this._borderLineColor||this._backgroundColor);this._maxBackgroundZoom=25;this._minBackgroundZoom=Math.max(z,0);if(K){K=g.LabelMaterialKey.load(this._materialKey);K.textureBinding=F.glyphs[0].textureBinding;const M=h.fromRotation(l.create(),-w.angle),[U,T]=F.shapeBackground(M);this._outLineLabelAngle=Math.round(254/
360*H);C.recordStart(E,K.data,this.geometryType,!0);this._writeBackgroundGeometry(C,E,w,U,T);C.recordEnd();this._outLineLabelAngle=Math.round(254/360*L);C.recordStart(E,K.data,this.geometryType,!0);this._writeBackgroundGeometry(C,E,w,U,T);C.recordEnd()}this._outLineLabelAngle=Math.round(254/360*H);this._placeFirst(G,z,1,!0);this._outLineLabelAngle=Math.round(254/360*L);this._placeFirst(G,z,0,!0);C.metricEnd()};A._placeBack=function(w,z,C,E,F){const G=w.clone();for(w=w.backwardLength+0;G.prev()&&!(w>=
E);)this._placeOnSegment(G,z,w,C,-1,F),w+=G.length+0};A._placeForward=function(w,z,C,E,F){const G=w.clone();for(w=w.remainingLength+0;G.next()&&!(w>=E);)this._placeOnSegment(G,z,w,C,1,F),w+=G.length+0};A._placeFirst=function(w,z,C,E=!1){const F=this._current.inShaping;var G=F.glyphs;const H=this._current.zoomLevel,{out:L,inId:K}=this._current;for(const M of G)G=M.x>F.bounds.x?C:1-C,G=Math.max(0,H+Math.log2(Math.abs(M.x+M.width/2-F.bounds.x)/(G*w.remainingLength+(1-G)*w.backwardLength))),G=Math.max(z,
E?0:G),M.maxZoom=25,M.angle=w.angle+(1-C)*Math.PI,M.minZoom=G,this._writeGlyph(L,K,w.x,w.y,M),C&&this._isVisible(M.minZoom,M.maxZoom)&&(G=M.bounds,L.metricBoxWrite(G.center[0],G.center[1],G.width,G.height))};A._placeOnSegment=function(w,z,C,E,F,G){var H=this._current.inShaping.glyphs;const {out:L,inId:K}=this._current,M=this._current.inShaping,U=this._current.zoomLevel;var T=w.x+w.dx/w.length*-F*C,Z=w.y+w.dy/w.length*-F*C;for(const ca of H)if((H=ca.x>M.bounds.x?G:1-G)&&1===F||!H&&-1===F){var X=Math.abs(ca.x+
ca.width/2-M.bounds.x);H=Math.max(0,U+Math.log2(X/C)-.1);X=Math.max(E,U+Math.log2(X/(C+w.length+0)));0!==H&&(ca.angle=w.angle+(1-G)*Math.PI,ca.minZoom=X,ca.maxZoom=H,this._writeGlyph(L,K,T,Z,ca),G&&this._isVisible(ca.minZoom,ca.maxZoom)&&(H=ca.bounds,L.metricBoxWrite(H.center[0]+(w.x-z.x),H.center[1]+(w.y-z.y),H.width,H.height)))}};A._writeGlyphs=function(w,z,C,E,F=this._minZoom){if(!(0>C.x||512<=C.x||0>C.y||512<=C.y)){if(0<E.glyphs.length&&(this._borderLineColor||this._backgroundColor)){var G=g.LabelMaterialKey.load(this._materialKey);
G.textureBinding=E.glyphs[0].textureBinding;w.recordStart(z,G.data,this.geometryType,!0);this._writeBackgroundGeometry(w,z,C,E.bounds,E.background);w.recordEnd()}G=C.x+this._refOffsetX;C=C.y-this._refOffsetY;for(const H of E.glyphs)H.minZoom=F,H.maxZoom=this._maxZoom,this._writeGlyph(w,z,G,C,H);E=E.boundsT;w.metricStart(z,F,G,C,this._refPlacementDirX,this._refPlacementDirY,this._referenceSize,this._materialKey);w.metricBoxWrite(E.center[0],E.center[1],E.width,E.height);w.metricEnd()}};A._writeVertexCommon=
function(w,z,C,E){const F=this._color,G=this._haloColor,H=f.i8888to32(0,0,this._size,this._haloSize);E=f.i8888to32(Math.floor(10*Math.max(E.minZoom,this._minZoom)),Math.floor(10*Math.min(E.maxZoom,this._maxZoom)),this._outLineLabelAngle,0);w.vertexWrite(C);w.vertexWrite(z);w.vertexWrite(F);w.vertexWrite(G);w.vertexWrite(H);w.vertexWrite(this._refSymbolAndPlacementOffset);w.vertexWrite(E)};A._writeBackgroundVertex=function(w,z,C,E,F,G){const H=f.i8888to32(0,0,this._size,this._haloSize),L=f.i8888to32(0,
0,0,0),K=f.i8888to32(Math.floor(10*this._minBackgroundZoom),Math.floor(10*this._maxBackgroundZoom),this._outLineLabelAngle,1);w.vertexWrite(C);w.vertexWrite(z);w.vertexWrite(E);w.vertexWrite(L);w.vertexWrite(H);w.vertexWrite(this._refSymbolAndPlacementOffset);w.vertexWrite(K);w.vertexWrite(F);w.vertexWrite(G);w.vertexEnd()};m._createClass(y,[{key:"_shapedBox",get:function(){return u.unwrap(this._shapingInfo).bounds}}]);return y}(k)})},"esri/views/2d/engine/webgl/mesh/templates/segmentUtils":function(){define(["exports",
"../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/maybe","./util"],function(m,p,D,B){function u(b){return b.length-1}function t(b){let d=0;for(let a=0;a<u(b);a++)d+=h(b,a);return d}function h(b,d,a=1){const [c,f]=b[d+1];return Math.sqrt(c*c+f*f)*a}function l(b,d,a,c,f){if(!(a<d)){var g=c.clone().seek(a/2);D.isNone(g)||(b(g.clone(),a,f),a=(a-d)/2,g=D.unwrap(g.seek(d/2)),l(b,d,a,c,f+1),l(b,d,a,g,f+1))}}let e=function(){function b(a,c,f,g,n){this._segments=a;this._index=c;
this._distance=f;this._xStart=g;this._yStart=n;this._done=!1}b.create=function(a){return new b(a,0,0,a[0][0],a[0][1])};var d=b.prototype;d.clone=function(){return new b(this._segments,this._index,this._distance,this.xStart,this.yStart)};d.equals=function(a){return this._index===a._index||a._index===this._index-1&&(0===this._distance||1===a._distance)||a._index===this._index+1&&(1===this._distance||0===a._distance)};d.leq=function(a){return this._index<a._index||this._index===a._index&&this._distance<=
a._distance};d.geq=function(a){return this._index>a._index||this._index===a._index&&this._distance>=a._distance};d.hasPrev=function(){return 0<=this._index-1};d.hasNext=function(){return this._index+1<u(this._segments)};d.next=function(){if(!this.hasNext())return null;this._xStart+=this.dx;this._yStart+=this.dy;this._distance=0;this._index+=1;return this};d.prev=function(){if(!this.hasPrev())return this._done=!0,null;--this._index;this._xStart-=this.dx;this._yStart-=this.dy;this._distance=1;return this};
d._seekBackwards=function(a,c){var f=this.backwardLength;if(a<=f)return this._distance=(f-a)/this.length,this;for(f=this.backwardLength;this.prev();){if(f+this.length>a)return this._seekBackwards(a-f);f+=this.length}this._distance=0;return c?this:null};d.seek=function(a,c=!1){if(0>a)return this._seekBackwards(Math.abs(a),c);if(a<=this.remainingLength)return this._distance=(this.backwardLength+a)/this.length,this;let f=this.remainingLength;for(;this.next();){if(f+this.length>a)return this.seek(a-f,
c);f+=this.length}this._distance=1;return c?this:null};p._createClass(b,[{key:"_segment",get:function(){return this._segments[this._index+1]}},{key:"angle",get:function(){const a=this.dy;let c=Math.acos((0*a+-1*-this.dx)/(1*this.length));0<a&&(c=2*Math.PI-c);return c}},{key:"xStart",get:function(){return this._xStart}},{key:"yStart",get:function(){return this._yStart}},{key:"x",get:function(){return this.xStart+this.distance*this.dx}},{key:"y",get:function(){return this.yStart+this.distance*this.dy}},
{key:"dx",get:function(){return this._segment[0]}},{key:"dy",get:function(){return this._segment[1]}},{key:"xMidpoint",get:function(){return this.xStart+.5*this.dx}},{key:"yMidpoint",get:function(){return this.yStart+.5*this.dy}},{key:"xEnd",get:function(){return this.xStart+this.dx}},{key:"yEnd",get:function(){return this.yStart+this.dy}},{key:"length",get:function(){const {dx:a,dy:c}=this;return Math.sqrt(a*a+c*c)}},{key:"remainingLength",get:function(){return this.length*(1-this._distance)}},{key:"backwardLength",
get:function(){return this.length*this._distance}},{key:"distance",get:function(){return this._distance}},{key:"done",get:function(){return this._done}}]);return b}();m.SegmentCursor=e;m.pathDivide=function(b,d,a,c=!0){const f=t(b);b=e.create(b);const g=f/2;if(c){c=Math.floor(Math.max((f-d)/2,0)/d);b.seek(g-c*d);for(let n=-c;n<=c;n++)512>b.x&&0<=b.x&&512>b.y&&0<=b.y&&a(b.clone(),n,g+n*d,f),b.seek(d)}else b.seek(g),a(b.clone(),0,g+0*d,f)};m.pathLength=t;m.pathSubdivide=function(b,d,a){l(a,d,t(b),e.create(b),
0)};m.segmentAt=function(b,d){return b[d+1]};m.segmentCount=u;m.segmentLength=h;m.smoothPaths=function(b,d){for(let E=0;E<b.length;E++){var a=b[E];const F=[];F.push(a[0]);for(var c=1;c<a.length;c++){let [G,H]=F[c-1];G+=a[c][0];H+=a[c][1];F.push([G,H])}a:{a=F;c=d;if(0>=c)break a;const G=a.length;if(3>G)break a;const H=[];var f=0;H.push(0);for(var g=1;g<G;g++)f+=B.dist(a[g],a[g-1]),H.push(f);c=Math.min(c,.2*f);f=[];f.push(a[0][0]);f.push(a[0][1]);g=a[G-1][0];const L=a[G-1][1];var n=B.sub([0,0],a[0],
a[1]);B.normalize(n);a[0][0]+=c*n[0];a[0][1]+=c*n[1];B.sub(n,a[G-1],a[G-2]);B.normalize(n);a[G-1][0]+=c*n[0];a[G-1][1]+=c*n[1];for(n=1;n<G;n++)H[n]+=c;H[G-1]+=c;n=.5*c;for(let K=1;K<G-1;K++){let M=0,U=0,T=0;for(var k=K-1;0<=k&&!(H[k+1]<H[K]-n);k--){var x=n+H[k+1]-H[K],r=H[k+1]-H[k],v=H[K]-H[k]<n?1:x/r;if(1E-6>Math.abs(v))break;var q=v*v,y=v*x-.5*q*r,A=v*r/c,w=a[k+1],z=a[k][0]-w[0],C=a[k][1]-w[1];M+=A/y*(w[0]*v*x+.5*q*(x*z-r*w[0])-q*v*r*z/3);U+=A/y*(w[1]*v*x+.5*q*(x*C-r*w[1])-q*v*r*C/3);T+=A}for(k=
K+1;k<G&&!(H[k-1]>H[K]+n);k++){x=n-H[k-1]+H[K];r=H[k]-H[k-1];v=H[k]-H[K]<n?1:x/r;if(1E-6>Math.abs(v))break;q=v*v;y=v*x-.5*q*r;A=v*r/c;w=a[k-1];z=a[k][0]-w[0];C=a[k][1]-w[1];M+=A/y*(w[0]*v*x+.5*q*(x*z-r*w[0])-q*v*r*z/3);U+=A/y*(w[1]*v*x+.5*q*(x*C-r*w[1])-q*v*r*C/3);T+=A}f.push(M/T);f.push(U/T)}f.push(g);f.push(L);for(let K=0,M=0;K<G;K++)a[K][0]=f[M++],a[K][1]=f[M++]}a=[];a.push(F[0]);for(c=1;c<F.length;c++){const [G,H]=F[c-1],[L,K]=F[c];a.push([Math.round(L-G),Math.round(K-H)])}b[E]=a}return b};Object.defineProperty(m,
Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/util":function(){define(["exports"],function(m){function p(D,B){return Math.sqrt(D*D+B*B)}m.DEFAULT_MAX_ZOOM=100;m.DEFAULT_MIN_ZOOM=0;m.dist=function(D,B){return p(D[0]-B[0],D[1]-B[1])};m.getLimitCosine=function(D=2){return 1/Math.max(D,1)};m.getMinMaxZoom=function(D,B){const u=!!D?.minScale&&B.scaleToZoom(D.minScale)||0;D=!!D?.maxScale&&B.scaleToZoom(D.maxScale)||100;return[u,D]};m.isExtent=function(D){return void 0!==
D.xmin&&void 0!==D.ymin&&void 0!==D.xmax&&void 0!==D.ymax};m.isFunction=function(D){return"function"===typeof D};m.isMultipoint=function(D){return void 0!==D.points};m.isPoint=function(D){return void 0!==D.x&&void 0!==D.y};m.isPolygon=function(D){return void 0!==D.rings};m.isPolyline=function(D){return void 0!==D.paths};m.len=p;m.normalize=function(D){const B=p(D[0],D[1]);D[0]/=B;D[1]/=B};m.sub=function(D,B,u){D[0]=B[0]-u[0];D[1]=B[1]-u[1];return D};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},
"esri/views/2d/engine/webgl/mesh/templates/WGLTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/BidiText ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../alignmentUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLMeshTemplate".split(" "),function(m,p,D,B,u,t,h,l,e,b,d,a){return function(c){function f(g,n,k,x,r,v,q,y,A,w,z,C,E,F,G,H,L,K,M,U,T,Z,X,ca){var P=
c.call(this)||this;P._xOffset=D.pt2px(E);P._yOffset=D.pt2px(F);P._decoration=w||"none";P._backgroundColor=Z;P._borderLineColor=X;P._borderLineSize=ca;P._color=r;P._haloColor=v;P._haloSize=Math.min(Math.floor(5*D.pt2px(D.toPt(k))),127);P._size=Math.min(Math.round(D.pt2px(n)),127);n=Math.min(Math.round(D.pt2px(x||n)),127);P._referenceSize=Math.round(Math.sqrt(256*n));P._scale=P._size/h.GLYPH_SIZE;P._angle=C;P._justify=u.getJustification(q||"center");P._xAlignD=u.getXAnchorDirection(q||"center");P._yAlignD=
u.getYAnchorDirection(y||"baseline");P._baseline="baseline"===(y||"baseline");P._bitset=(A===B.Alignment.MAP?1:0)|(z?1:0)<<1;g=e.MaterialKeyBase.load(g);g.sdf=!0;P._materialKey=g.data;P._lineWidth=D.pt2px(G)||512;P._lineHeight=H||1;P._textPlacement=L;P._effects=K;P._isCIM=M??!1;P._minMaxZoom=l.i1616to32(Math.round(U*h.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(T*h.MIN_MAX_ZOOM_PRECISION_FACTOR));return P}m._inheritsLoose(f,c);f.fromText=function(g,n){const k=g.font?.size,x=new f(g.materialKey,k,g.haloSize||
0,k,g.color&&t.premultiplyAlphaRGBAArray(g.color)||0,g.haloColor&&t.premultiplyAlphaRGBAArray(g.haloColor)||0,g.horizontalAlignment,g.verticalAlignment,B.Alignment.SCREEN,g.font?.decoration,!1,g.angle||0,g.xoffset||0,g.yoffset||0,g.lineWidth||0,g.lineHeight||0,null,null,!1,b.DEFAULT_MIN_ZOOM,b.DEFAULT_MAX_ZOOM,g.backgroundColor&&t.premultiplyAlphaRGBAArray(g.backgroundColor),g.borderLineColor&&t.premultiplyAlphaRGBAArray(g.borderLineColor),g.borderLineSize),[,r]=p.bidiText(g.text);x.bindTextInfo(n??
[],r);x._vertexBoundsScale=g.maxVVSize&&k?g.maxVVSize/k:1;return x};f.fromCIMText=function(g,n,k){var x=g.scaleFactor||1;const r=g.size*g.sizeRatio*x,[v,q]=b.getMinMaxZoom(g.scaleInfo,k);k=new f(g.materialKey,r,g.outlineSize*g.sizeRatio,g.referenceSize,t.premultiplyAlphaRGBA(g.color),t.premultiplyAlphaRGBA(g.outlineColor),g.horizontalAlignment,g.verticalAlignment,g.alignment,g.decoration,g.colorLocked??!1,g.angle,g.offsetX*g.sizeRatio*x,g.offsetY*g.sizeRatio*x,512,1,g.markerPlacement,g.effects,!0,
v,q,g.backgroundColor?t.premultiplyAlphaRGBA(g.backgroundColor):void 0,g.borderLineColor?t.premultiplyAlphaRGBA(g.borderLineColor):void 0,g.borderLineWidth);[,x]=p.bidiText(g.text);k.bindTextInfo(n,x);k._vertexBoundsScale=g.maxVVSize?g.maxVVSize/r:1;return k};return f}(d(a))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../layers/graphics/featureConversionUtils ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./shapingUtils".split(" "),
function(m,p,D,B,u,t,h,l,e,b){const d=l.i1616to32(4,4),a=l.i1616to32(4,2),c=l.i1616to32(4,6),f=[a,a,c,c],g=[a,c,a,c],n=[c,c,d,d],k=[d,d,c,c],x=[c,d,c,d],r=[d,c,d,c];return v=>function(q){function y(...w){w=q.call(this,...w)||this;w._isCIM=!1;w._vertexBoundsScale=1;w.geometryType=h.WGLGeometryType.TEXT;w._aux=l.i8888to32(0,0,w._referenceSize,w._bitset);return w}m._inheritsLoose(y,q);var A=y.prototype;A.bindTextInfo=function(w,z){this._shapingInfo=w&&w.length?p.applySome(w,C=>b.shapeGlyphs(C,z,{scale:this._scale,
angle:this._angle,xOffset:this._xOffset,yOffset:this._yOffset,hAlign:this._xAlignD,vAlign:this._yAlignD,maxLineWidth:Math.max(32,Math.min(this._lineWidth,512)),lineHeight:t.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(this._lineHeight,4)),decoration:this._decoration,isCIM:this._isCIM,hasBackground:!!this._backgroundColor,borderLineSize:this._borderLineSize})):null};A._write=function(w,z,C,E){const F=z.getDisplayId();this._writeGeometry(w,z,F,C,E)};A._writeGeometry=function(w,z,C,E,F){const G=this._shapingInfo;
if(!p.isNone(G)){if(p.isSome(this._textPlacement))return z=F??z.readLegacyGeometryForDisplay(),this._writePlacedText(w,C,z,G,E);E=F?B.deltaDecodeGeometry(B.convertFromGeometry(F),2):"esriGeometryPolygon"===z.geometryType?z.readCentroid():z.readGeometryForDisplay();if(!p.isNone(E)){if(E.isPoint){const [H,L]=E.coords;return!w.hasAggregates&&w.hasPixelBufferEnabled&&(0>H||512<=H||0>L||512<=L)?void 0:this._writeGlyphs(w,C,{x:H,y:L},G)}E.forEachVertex((H,L)=>this._writeGlyphs(w,C,{x:H,y:L},G))}}};A._writePlacedText=
function(w,z,C,E,F){var G=p.unwrap(this._textPlacement);if(C=u.CIMMarkerPlacementHelper.getPlacement(C,G,D.pt2px(1),w.tileKey,F.geometryEngine))for(var H=C.next();null!=H;)F=-H.getAngle(),E.setRotation(F),G=H.tx,H=-H.ty,0>G||512<=G||0>H||512<=H||(this._writeGlyphs(w,z,{x:G,y:H},E),E.setRotation(-F)),H=C.next()};A._writeGlyphs=function(w,z,C,E){const F=e.MaterialKeyBase.load(this._materialKey),G=l.i1616to32(Math.round(8*C.x),Math.round(8*C.y)),H=this._vertexBoundsScale,{bounds:L,background:K,glyphs:M}=
E;0<M.length&&(this._borderLineColor||this._backgroundColor)&&(F.textureBinding=M[0].textureBinding,w.recordStart(z,F.data,this.geometryType,!0),this._writeBackgroundGeometry(w,z,C,L,K),w.recordEnd());const U=2*Math.max(L.width,L.height);for(const T of E.glyphs)F.textureBinding=T.textureBinding,w.recordStart(z,F.data,this.geometryType,!0),w.vertexBounds(C.x+L.x+this._xOffset,C.y+L.y-this._yOffset,U*H,U*H),this._writeVertices(w,z,G,T),w.recordEnd()};A._writeGlyph=function(w,z,C,E,F){var G=e.MaterialKeyBase.load(this._materialKey);
const H=l.i1616to32(Math.round(8*C),Math.round(8*E));G.textureBinding=F.textureBinding;w.recordStart(z,G.data,this.geometryType,!0);G=F.bounds;const L=this._vertexBoundsScale;w.vertexBounds(C+G.x*L,E+G.y*L,G.width*L,G.height*L);this._writeVertices(w,z,H,F);w.recordEnd()};A._writeVertices=function(w,z,C,E){const F=w.vertexCount();this._writeVertexCommon(w,z,C,E);w.vertexWrite(E.offsets.upperLeft);w.vertexWrite(E.texcoords.upperLeft);w.vertexEnd();this._writeVertexCommon(w,z,C,E);w.vertexWrite(E.offsets.upperRight);
w.vertexWrite(E.texcoords.upperRight);w.vertexEnd();this._writeVertexCommon(w,z,C,E);w.vertexWrite(E.offsets.lowerLeft);w.vertexWrite(E.texcoords.lowerLeft);w.vertexEnd();this._writeVertexCommon(w,z,C,E);w.vertexWrite(E.offsets.lowerRight);w.vertexWrite(E.texcoords.lowerRight);w.vertexEnd();w.indexWrite(F+0);w.indexWrite(F+1);w.indexWrite(F+2);w.indexWrite(F+1);w.indexWrite(F+3);w.indexWrite(F+2)};A._writeVertexCommon=function(w,z,C,E){E=this._color;const F=this._haloColor,G=l.i8888to32(0,0,this._referenceSize,
this._bitset),H=l.i8888to32(0,0,this._size,this._haloSize);w.vertexWrite(C);w.vertexWrite(z);w.vertexWrite(E);w.vertexWrite(F);w.vertexWrite(H);w.vertexWrite(G);w.vertexWrite(this._minMaxZoom)};A._writeBackgroundVertex=function(w,z,C,E,F,G){const H=l.i8888to32(0,1,this._referenceSize,this._bitset),L=l.i8888to32(0,0,this._size,this._haloSize),K=l.i8888to32(0,0,0,0);w.vertexWrite(C);w.vertexWrite(z);w.vertexWrite(E);w.vertexWrite(K);w.vertexWrite(L);w.vertexWrite(H);w.vertexWrite(this._minMaxZoom);
w.vertexWrite(F);w.vertexWrite(G);w.vertexEnd()};A._writeBackgroundQuad=function(w,z,C,E,F,G){const H=w.vertexCount();this._writeBackgroundVertex(w,z,C,E,F.upperLeft,G[0]);this._writeBackgroundVertex(w,z,C,E,F.upperRight,G[1]);this._writeBackgroundVertex(w,z,C,E,F.lowerLeft,G[2]);this._writeBackgroundVertex(w,z,C,E,F.lowerRight,G[3]);w.indexWrite(H+0);w.indexWrite(H+1);w.indexWrite(H+2);w.indexWrite(H+1);w.indexWrite(H+3);w.indexWrite(H+2)};A._writeBackgroundGeometry=function(w,z,C,E,F){const G=l.i1616to32(Math.round(8*
C.x),Math.round(8*C.y)),{x:H,y:L,width:K,height:M}=E;E=2*Math.max(K,M);w.vertexBounds(C.x+H+this._xOffset,C.y+L-this._yOffset,E*this._vertexBoundsScale,E*this._vertexBoundsScale);this._backgroundColor&&this._writeBackgroundQuad(w,z,G,this._backgroundColor,F.main,[d,d,d,d]);if(this._borderLineColor||this._backgroundColor){const [U,T,Z,X,ca]=this._borderLineColor&&this._borderLineSize&&0<this._borderLineSize?[f,f,g,g,this._borderLineColor]:[n,k,x,r,this._backgroundColor];this._writeBackgroundQuad(w,
z,G,ca,F.top,U);this._writeBackgroundQuad(w,z,G,ca,F.bot,T);this._writeBackgroundQuad(w,z,G,ca,F.left,Z);this._writeBackgroundQuad(w,z,G,ca,F.right,X)}};return y}(v)})},"esri/symbols/cim/placements/CIMMarkerPlacementHelper":function(){define(["exports","../CIMCursor","../CIMOperators"],function(m,p,D){let B=function(){function u(){}u.getPlacement=function(t,h,l,e,b){const d=D.getPlacementOperator(h);if(!d)return null;t=p.cloneAndDecodeGeometry(t);return d.execute(t,h,l,e,b)};return u}();m.CIMMarkerPlacementHelper=
B;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/WGLMeshTemplate":function(){define(["../../../../../../core/maybe","../../../../../../symbols/cim/effects/CIMEffectHelper"],function(m,p){return function(){function D(){this._materialKey=null}var B=D.prototype;B.bindFeature=function(u,t,h){};B.write=function(u,t,h,l){if(m.isNone(this._effects)||0===this._effects?.length)return this._write(u,t,l);h=p.CIMEffectHelper.executeEffects(this._effects,
t.readLegacyGeometryForDisplay(),u.tileKey,l.geometryEngine);let e=p.CIMEffectHelper.next(h);for(;e;)this._write(u,t,l,e),e=p.CIMEffectHelper.next(h)};B._write=function(u,t,h,l){};return D}()})},"esri/symbols/cim/effects/CIMEffectHelper":function(){define(["exports","../../../geometry/support/jsonUtils","../CIMCursor","../CIMEffects","../CIMOperators"],function(m,p,D,B,u){const t=96/72;let h=function(){function l(){}l.executeEffects=function(e,b,d,a){b=D.cloneAndDecodeGeometry(b);b=new B.SimpleGeometryCursor(b);
for(const c of e)(e=u.getEffectOperator(c))&&(b=e.execute(b,c,t,d,a));return b};l.next=function(e){e=e.next();D.deltaEncodeGeometry(e);return e};l.applyEffects=function(e,b,d){if(!e)return b;b=new B.SimpleGeometryCursor(b);for(var a of e)(e=u.getEffectOperator(a))&&(b=e.execute(b,a,1,null,d));for(d=null;a=b.next();)d?p.isPolyline(d)?p.isPolyline(a)&&d.paths.push(...a.paths):p.isPolygon(d)&&p.isPolygon(a)&&d.rings.push(...a.rings):d=a;return d};return l}();m.CIMEffectHelper=h;Object.defineProperty(m,
Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/WGLMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLMeshTemplate".split(" "),function(m,p,D,B,
u,t,h,l,e,b,d,a,c,f){return function(g){function n(k,x,r,v,q,y,A,w,z,C,E,F,G,H,L,K,M,U,T,Z,X,ca,P){var J=g.call(this)||this;J.angle=v;J.height=A;J.width=y;J.xOffset=x*T;J.yOffset=r*T;J._markerPlacement=Z;J._effects=X;J._anchorX=K;J._anchorY=M;J._minMaxZoom=b.i1616to32(Math.round(ca*l.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(P*l.MIN_MAX_ZOOM_PRECISION_FACTOR));x=(H===t.Alignment.MAP?l.BITSET_MARKER_ALIGNMENT_MAP:l.BITSET_MARKER_ALIGNMENT_SCREEN)|(E?l.BITSET_GENERIC_LOCK_COLOR:0)|(G?l.BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE:
0)|(F?l.BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY:0);r=L&&L.sdf;k=d.MarkerMaterialKey.load(k);k.sdf=r;k.pattern=!0;k.textureBinding=L.textureBinding;J._materialKey=k.data;J._fillColor=q;J._outlineColor=z;J._sizeOutlineWidth=b.i8888to32(Math.round(Math.min(Math.sqrt(128*y),255)),Math.round(Math.min(Math.sqrt(128*A),255)),Math.round(Math.min(Math.sqrt(128*C),255)),Math.round(Math.min(Math.sqrt(128*w),255)));q=L.rect.x+l.SPRITE_PADDING;w=L.rect.y+l.SPRITE_PADDING;z=q+L.width;L=w+L.height;J._offsets.xUpperLeft=
q;J._offsets.yUpperLeft=w;J._offsets.xUpperRight=z;J._offsets.yUpperRight=w;J._offsets.xBottomLeft=q;J._offsets.yBottomLeft=L;J._offsets.xBottomRight=z;J._offsets.yBottomRight=L;k.symbologyType===e.WGLSymbologyType.PIE_CHART?(J._texUpperLeft=b.i1616to32(0,1),J._texUpperRight=b.i1616to32(1,1),J._texBottomLeft=b.i1616to32(0,0),J._texBottomRight=b.i1616to32(1,0)):(J._texUpperLeft=b.i1616to32(q,w),J._texUpperRight=b.i1616to32(z,w),J._texBottomLeft=b.i1616to32(q,L),J._texBottomRight=b.i1616to32(z,L));
y=y*U*T;A=A*U*T;J._bitestAndDistRatio=b.i1616to32(x,Math.round(64*U));J._computedWidth=y;J._computedHeight=A;y=u.create();A=B.create();J._applyTransformation(A,y);return J}m._inheritsLoose(n,g);n.fromCIMMarker=function(k,x,r){const v=k.size,q=(x&&x.width||1)/(x&&x.height||1)*k.scaleX;var y=k.scaleSymbolsProportionally&&k.frameHeight?v/k.frameHeight:1;const A=h.premultiplyAlphaRGBA(k.color),w=h.premultiplyAlphaRGBA(k.outlineColor),z=D.pt2px(v),C=z*q,E=D.pt2px(k.offsetX||0),F=D.pt2px(k.offsetY||0);
y*=D.pt2px(k.outlineWidth||0);const G=k.alignment||t.Alignment.SCREEN,H=D.pt2px(k.referenceSize),[L,K]=a.getMinMaxZoom(k.scaleInfo,r);r=k.rotation||0;k.rotateClockwise||(r=-r);let M=0,U=0;const T=k.anchorPoint;T&&(k.isAbsoluteAnchorPoint?v&&(M=T.x/(v*q),U=T.y/v):(M=T.x,U=T.y));x=new n(k.materialKey,E,F,r,A,C,z,H,w,y,k.colorLocked,k.scaleSymbolsProportionally,!1,G,x,M,U,k.sizeRatio,p.unwrapOr(k.scaleFactor,1),k.markerPlacement,k.effects,L,K);x._vertexBoundsScaleX=k.maxVVSize?k.maxVVSize/C:1;x._vertexBoundsScaleY=
k.maxVVSize?k.maxVVSize/z:1;return x};n.fromPictureMarker=function(k,x){const r=Math.round(D.pt2px(k.width)),v=Math.round(D.pt2px(k.height)),q=l.PICTURE_FILL_COLOR,y=Math.round(D.pt2px(k.xoffset||0)),A=Math.round(D.pt2px(k.yoffset||0));x=new n(k.materialKey,y,A,k.angle,q,r,v,v,0,0,!1,!1,!1,t.Alignment.SCREEN,x,0,0,1,1,null,null,a.DEFAULT_MIN_ZOOM,a.DEFAULT_MAX_ZOOM);x._vertexBoundsScaleX=k.maxVVSize?k.maxVVSize/k.width:1;x._vertexBoundsScaleY=k.maxVVSize?k.maxVVSize/k.height:1;return x};n.fromSimpleMarker=
function(k,x){const r=h.premultiplyAlphaRGBAArray(k.color),v=Math.round(D.pt2px(k.size)),q=Math.round(D.pt2px(k.xoffset||0)),y=Math.round(D.pt2px(k.yoffset||0)),A=k.style;var w=k.outline;const z=(w?.color&&h.premultiplyAlphaRGBAArray(w.color))|0;w=(w?.width&&Math.round(D.pt2px(w.width)))|0;x=new n(k.materialKey,q,y,k.angle,r,v,v,v,z,w,!1,!1,"esriSMSCross"===A||"esriSMSX"===A,t.Alignment.SCREEN,x,0,0,1.96875,1,null,null,a.DEFAULT_MIN_ZOOM,a.DEFAULT_MAX_ZOOM);x.boundsType="esriSMSCircle"===A?"circle":
"square";x._vertexBoundsScaleX=k.maxVVSize?k.maxVVSize/k.size:1;x._vertexBoundsScaleY=k.maxVVSize?k.maxVVSize/k.size:1;return x};n.fromLineSymbolMarker=function(k,x){const r=h.premultiplyAlphaRGBAArray(k.color),v=Math.round(D.pt2px(6*k.lineWidth)),q="cross"===k.style||"x"===k.style;switch(k.placement){case "begin-end":var y=t.ExtremityPlacement.Both;break;case "begin":y=t.ExtremityPlacement.JustBegin;break;case "end":y=t.ExtremityPlacement.JustEnd;break;default:y=t.ExtremityPlacement.None}y={type:"CIMMarkerPlacementAtExtremities",
angleToLine:!0,offset:0,extremityPlacement:y,offsetAlongLine:0};x=new n(k.materialKey,0,0,0,r,v,v,v/6,r,q?Math.round(D.pt2px(k.lineWidth)):0,!1,!1,q,t.Alignment.MAP,x,0,0,1.96875,1,y,null,a.DEFAULT_MIN_ZOOM,a.DEFAULT_MAX_ZOOM);x.boundsType="circle"===k.style?"circle":"square";return x};return n}(c(f))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2 ../../../../../../chunks/vec2f32 ../../../../../../layers/graphics/featureConversionUtils ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper ../../definitions ../../enums ../../number ../../materialKey/MaterialKey".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d,a,c){const f=3.14159265359/180;return g=>function(n){function k(...r){r=n.call(this,...r)||this;r.angle=0;r.xOffset=0;r.yOffset=0;r.width=0;r.height=0;r.boundsType="square";r._anchorX=0;r._anchorY=0;r._computedWidth=0;r._computedHeight=0;r._allowBorrowing=!0;r._vertexBoundsScaleX=1;r._vertexBoundsScaleY=1;r._offsets={xUpperLeft:0,yUpperLeft:0,xUpperRight:0,yUpperRight:0,xBottomLeft:0,yBottomLeft:0,xBottomRight:0,yBottomRight:0};r.geometryType=d.WGLGeometryType.MARKER;
return r}m._inheritsLoose(k,n);var x=k.prototype;x._write=function(r,v,q,y){const A=v.getDisplayId();r.recordStart(A,this._materialKey,this.geometryType,!0);this._writeGeometry(r,v,A,q,y);r.recordEnd()};x._writeGeometry=function(r,v,q,y,A){if(p.isSome(this._markerPlacement))return this._writePlacedMarkers(r,v,y,A);this._allowBorrowing=!0;if(!A&&"esriGeometryPoint"===v.geometryType)return y=v.getX(),v=v.getY(),!r.hasAggregates&&r.hasPixelBufferEnabled&&(0>y||513<=y||0>v||513<=v)?void 0:this._writeVertices(r,
q,this._getPos(y,v),y,v);v=A?l.deltaDecodeGeometry(l.convertFromGeometry(A),2):"esriGeometryPolygon"===v.geometryType?v.readCentroid():v.readGeometryForDisplay();if(!p.isNone(v)){if(v.isPoint){const [w,z]=v.coords;return!r.hasAggregates&&r.hasPixelBufferEnabled&&(0>w||512<=w||0>z||512<=z)?void 0:this._writeVertices(r,q,this._getPos(w,z),w,z)}v.forEachVertex((w,z)=>{const C=2*b.TILE_SIZE;w<-C||w>=C||z<-C||z>=C||this._writeVertices(r,q,this._getPos(w,z),w,z)})}};x._writePlacedMarkers=function(r,v,q,
y){y=y??v.readLegacyGeometryForDisplay();if(q=e.CIMMarkerPlacementHelper.getPlacement(y,p.unwrap(this._markerPlacement),D.pt2px(1),r.tileKey,q.geometryEngine)){this._allowBorrowing="esriGeometryPolygon"===v.geometryType?!1:!0;v=v.getDisplayId();y=h.create();for(var A=u.create(),w=q.next();null!=w;){const z=w.tx,C=-w.ty;-128<=z&&640>=z&&-128<=C&&640>=C&&(this._applyTransformation(A,y,-w.getAngle()/f),this._writeVertices(r,v,this._getPos(z,C),z,C));w=q.next()}}};x._writeVertices=function(r,v,q,y,A){const w=
c.MarkerMaterialKey.load(this._materialKey);switch(w.symbologyType){case d.WGLSymbologyType.HEATMAP:return this._writeHeatmapVertices(r,v,q);default:return this._writeMarkerVertices(r,v,w,q,y,A)}};x._writeMarkerVertices=function(r,v,q,y,A,w){var z=q.vvRotation;q=r.vertexCount();let C=this._computedWidth*this._vertexBoundsScaleX;var E=this._computedHeight*this._vertexBoundsScaleY;this.angle&&(C=E=Math.max(C,E));z&&(z=Math.max(this.xOffset,this.yOffset),C+=z,E+=z);this._allowBorrowing&&r.vertexBounds(A+
this.xOffset,w-this.yOffset,C,E);r.vertexWrite(y);r.vertexWrite(this._offsetUpperLeft);r.vertexWrite(this._texUpperLeft);r.vertexWrite(this._bitestAndDistRatio);r.vertexWrite(v);r.vertexWrite(this._fillColor);r.vertexWrite(this._outlineColor);r.vertexWrite(this._sizeOutlineWidth);r.vertexWrite(this._minMaxZoom);r.vertexEnd();r.vertexWrite(y);r.vertexWrite(this._offsetUpperRight);r.vertexWrite(this._texUpperRight);r.vertexWrite(this._bitestAndDistRatio);r.vertexWrite(v);r.vertexWrite(this._fillColor);
r.vertexWrite(this._outlineColor);r.vertexWrite(this._sizeOutlineWidth);r.vertexWrite(this._minMaxZoom);r.vertexEnd();r.vertexWrite(y);r.vertexWrite(this._offsetBottomLeft);r.vertexWrite(this._texBottomLeft);r.vertexWrite(this._bitestAndDistRatio);r.vertexWrite(v);r.vertexWrite(this._fillColor);r.vertexWrite(this._outlineColor);r.vertexWrite(this._sizeOutlineWidth);r.vertexWrite(this._minMaxZoom);r.vertexEnd();r.vertexWrite(y);r.vertexWrite(this._offsetBottomRight);r.vertexWrite(this._texBottomRight);
r.vertexWrite(this._bitestAndDistRatio);r.vertexWrite(v);r.vertexWrite(this._fillColor);r.vertexWrite(this._outlineColor);r.vertexWrite(this._sizeOutlineWidth);r.vertexWrite(this._minMaxZoom);r.vertexEnd();this._writeIndices(r,q)};x._writeHeatmapVertices=function(r,v,q){const y=r.vertexCount();r.vertexWrite(q);r.vertexWrite(this._offsetUpperLeft);r.vertexWrite(v);r.vertexEnd();r.vertexWrite(q);r.vertexWrite(this._offsetUpperRight);r.vertexWrite(v);r.vertexEnd();r.vertexWrite(q);r.vertexWrite(this._offsetBottomLeft);
r.vertexWrite(v);r.vertexEnd();r.vertexWrite(q);r.vertexWrite(this._offsetBottomRight);r.vertexWrite(v);r.vertexEnd();this._writeIndices(r,y)};x._writeIndices=function(r,v){r.indexWrite(v+0);r.indexWrite(v+1);r.indexWrite(v+2);r.indexWrite(v+1);r.indexWrite(v+3);r.indexWrite(v+2)};x._applyTransformation=function(r,v,q=0){B.fromTranslation(r,h.fromValues(this.xOffset,-this.yOffset));null!=this.angle&&0!==this.angle+q&&B.rotate(r,r,f*(this.angle+q));q=this._computedWidth;const y=this._computedHeight,
A=-(.5+this._anchorX)*q,w=-(.5-this._anchorY)*y;t.set(v,A,w);t.transformMat2d(v,v,r);this._offsetUpperLeft=a.i1616to32(16*v[0],16*v[1]);this._offsets.xUpperLeft=v[0];this._offsets.yUpperLeft=v[1];t.set(v,A+q,w);t.transformMat2d(v,v,r);this._offsetUpperRight=a.i1616to32(16*v[0],16*v[1]);this._offsets.xUpperRight=v[0];this._offsets.yUpperRight=v[1];t.set(v,A,w+y);t.transformMat2d(v,v,r);this._offsetBottomLeft=a.i1616to32(16*v[0],16*v[1]);this._offsets.xBottomLeft=v[0];this._offsets.yBottomLeft=v[1];
t.set(v,A+q,w+y);t.transformMat2d(v,v,r);this._offsetBottomRight=a.i1616to32(16*v[0],16*v[1]);this._offsets.xBottomRight=v[0];this._offsets.yBottomRight=v[1]};x._getPos=function(r,v){return a.i1616to32(Math.round(8*r),Math.round(8*v))};return k}(g)})},"esri/views/2d/engine/webgl/mesh/templates/WGLTemplateStore":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/promiseUtils ../../../../../../symbols/support/defaultsJSON ../../enums ../../materialKey/MaterialKey ./WGLDynamicFillTemplate ./WGLDynamicLineTemplate ./WGLDynamicMarkerTemplate ./WGLDynamicTextTemplate ./WGLFillTemplate ./WGLLineTemplate ./WGLMarkerTemplate ./WGLTextTemplate ../../util/Lock ../../util/Result ../../../../layers/features/textUtils ../../../../layers/support/cimSymbolUtils".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d,a,c,f,g,n,k,x,r,v){function q(F,G){const H=F.length;F.push(null);G.then(L=>F[H]=L);return F}function y(F){return null!=F&&!!(F&1)}const A=B.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),w={sortKey:null,templates:[]};B={isOutline:!1,placement:null,symbologyType:h.WGLSymbologyType.DEFAULT,vvFlags:0};const z={...t.errorPointSymbolJSON,hash:JSON.stringify(t.errorPointSymbolJSON),materialKey:l.createMaterialKey(h.WGLGeometryType.MARKER,B)},C={...t.errorPolylineSymbolJSON,
hash:JSON.stringify(t.errorPolylineSymbolJSON),materialKey:l.createMaterialKey(h.WGLGeometryType.LINE,B)},E={...t.errorPolygonSymbolJSON,hash:JSON.stringify(t.errorPolygonSymbolJSON),materialKey:l.createMaterialKey(h.WGLGeometryType.FILL,B)};t=function(){function F(H,L){this._templateIdCounter=this._idCounter=1;this._idToTemplateGroup=new Map;this._symbolToTemplate=new Map;this._fetchQueue=[];this._idToResolver=new Map;this._cimTemplateCache=new Map;this._cimAnalyses=[];this._lock=new k.Lock;this._fetchResource=
H;this._tileInfo=L}var G=F.prototype;G.createTemplateGroup=function(H,L,K=null){this._initErrorTemplates();const M=H.hash;var U=this._symbolToTemplate.get(M);if(null!=U)return U;U=[];K={sortKey:K,templates:U};L&&this._createMeshTemplates(U,L,!0);this._createMeshTemplates(U,H,!1);L=this._createGroupId;if(U="expanded-cim"===H.type)a:{if(H.layers)for(const T of H.layers)if("function"===typeof T.materialHash){U=!0;break a}U=!1}H=L.call(this,U);this._idToTemplateGroup.set(H,K);this._symbolToTemplate.set(M,
H);return H};G.getTemplateGroup=function(H){return this._idToTemplateGroup.get(H)??w};G.getDynamicTemplateGroup=function(H){if(!this._idToTemplateGroup.has(H))return w;y(H)||A.error("mapview-template-store",`Id ${H} does not refer to a dynamic template`);return this._idToTemplateGroup.get(H)};G.getMosaicItem=function(H,L){const K=this._createTemplateId(),M=new Promise(U=>this._idToResolver.set(K,U));this._fetchQueue.push({symbol:H,id:K,glyphIds:L});return M};G.finalize=function(H){return this._fetchQueue.length||
this._lock.isHeld()?k.withLock(this._lock,this._fetchAllQueuedResources.bind(this),H):Promise.resolve()};G._initErrorTemplates=function(){this._errorTemplates||(this._errorTemplates={fill:this._createMeshTemplates([],E,!1),marker:this._createMeshTemplates([],z,!1),line:this._createMeshTemplates([],C,!1)})};G._fetchAllQueuedResources=function(H){if(!this._fetchQueue.length)return Promise.resolve();const L=this._fetchQueue,K=this._cimAnalyses;this._fetchQueue=[];this._cimAnalyses=[];return Promise.all(K).then(()=>
this._fetchResource(L,H).then(M=>{for(const {id:U,mosaicItem:T}of M)this._idToResolver.get(U)(T),this._idToResolver.delete(U)})).catch(M=>{u.isAbortError(M)?this._fetchQueue=this._fetchQueue.concat(L):"worker:port-closed"!==M.name&&A.error(new D("mapview-template-store","Unable to fetch requested texture resources",M))})};G._createGroupId=function(H){return this._idCounter++<<1|(H?1:0)};G._createTemplateId=function(){return this._templateIdCounter++};G._createSMS=function(){var H=p._asyncToGenerator(function*(L){const {spriteMosaicItem:K}=
yield this.getMosaicItem(L);return x.ok(K,A)?g.fromSimpleMarker(L,K):this._markerError});return function(L){return H.apply(this,arguments)}}();G._createPMS=function(){var H=p._asyncToGenerator(function*(L){const {spriteMosaicItem:K}=yield this.getMosaicItem(L);return x.ok(K,A)?g.fromPictureMarker(L,K):this._markerError});return function(L){return H.apply(this,arguments)}}();G._createSFS=function(){var H=p._asyncToGenerator(function*(L,K){const {spriteMosaicItem:M}=yield this.getMosaicItem(L);return x.ok(M,
A)?c.fromSimpleFill(L,M,K):this._fillError});return function(L,K){return H.apply(this,arguments)}}();G._createPFS=function(){var H=p._asyncToGenerator(function*(L,K){const {spriteMosaicItem:M}=yield this.getMosaicItem(L);return x.ok(M,A)?c.fromPictureFill(L,M,K):this._fillError});return function(L,K){return H.apply(this,arguments)}}();G._createSLS=function(){var H=p._asyncToGenerator(function*(L,K){({spriteMosaicItem:K}=yield this.getMosaicItem(L));return x.ok(K,A)?f.fromSimpleLine(L,K):this._lineError});
return function(L,K){return H.apply(this,arguments)}}();G._createLMS=function(){var H=p._asyncToGenerator(function*(L){const {spriteMosaicItem:K}=yield this.getMosaicItem(L);return x.ok(K,A)?g.fromLineSymbolMarker(L,K):this._markerError});return function(L){return H.apply(this,arguments)}}();G._createTS=function(){var H=p._asyncToGenerator(function*(L){const {glyphMosaicItems:K}=yield this.getMosaicItem(L);return n.fromText(L,K??[])});return function(L){return H.apply(this,arguments)}}();G._createCIMText=
function(){var H=p._asyncToGenerator(function*(L){const {glyphMosaicItems:K}=yield this.getMosaicItem(v.cimLayerToRasterizationInfo(L),r.codepoints(L.text));return x.ok(K,A)?n.fromCIMText(L,K,this._tileInfo):this._textError});return function(L){return H.apply(this,arguments)}}();G._createCIMFill=function(){var H=p._asyncToGenerator(function*(L){const {spriteMosaicItem:K}=yield this.getMosaicItem(v.cimLayerToRasterizationInfo(L));return x.ok(K,A)?c.fromCIMFill(L,K,this._tileInfo):this._fillError});
return function(L){return H.apply(this,arguments)}}();G._createCIMLine=function(){var H=p._asyncToGenerator(function*(L){const {spriteMosaicItem:K}=yield this.getMosaicItem(v.cimLayerToRasterizationInfo(L));return x.ok(K,A)?f.fromCIMLine(L,K,this._tileInfo):this._lineError});return function(L){return H.apply(this,arguments)}}();G._createCIMMarker=function(){var H=p._asyncToGenerator(function*(L){const {spriteMosaicItem:K}=yield this.getMosaicItem(v.cimLayerToRasterizationInfo(L));return x.ok(K,A)?
g.fromCIMMarker(L,K,this._tileInfo):this._markerError});return function(L){return H.apply(this,arguments)}}();G._createCIM=function(){var H=p._asyncToGenerator(function*(L){const K=L.templateHash;let M=this._cimTemplateCache.get(K);if(null!=M)return M;switch(L.type){case "marker":M=yield this._createCIMMarker(L);break;case "line":M=yield this._createCIMLine(L);break;case "fill":M=yield this._createCIMFill(L);break;case "text":M=yield this._createCIMText(L)}this._cimTemplateCache.set(K,M);return M});
return function(L){return H.apply(this,arguments)}}();G._createDynamicCIM=function(){var H=p._asyncToGenerator(function*(L){const K=L.templateHash;let M=this._cimTemplateCache.get(K);if(null!=M)return M;switch(L.type){case "marker":M=d.fromCIMMarker(L,this._tileInfo);break;case "line":M=b.fromCIMLine(L,this._tileInfo);break;case "fill":M=e.fromCIMFill(L,this._tileInfo);break;case "text":M=a.fromCIMText(L,this._tileInfo)}this._cimTemplateCache.set(K,M);return M});return function(L){return H.apply(this,
arguments)}}();G._createPrimitiveMeshTemplates=function(H,L,K){switch(L.type){case "esriSMS":return q(H,this._createSMS(L));case "esriPMS":return q(H,this._createPMS(L));case "esriSFS":return q(H,this._createSFS(L,K));case "line-marker":return q(H,this._createLMS(L));case "esriPFS":return q(H,this._createPFS(L,K));case "esriSLS":return q(H,this._createSLS(L,!1));case "esriTS":return q(H,this._createTS(L));default:return A.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),
H}};G._createMeshTemplates=function(H,L,K){if(L.type.includes("3d"))return A.error("3D symbols are not supported with MapView"),H;if("expanded-cim"===L.type){for(const M of L.layers)"function"===typeof M.materialHash?q(H,this._createDynamicCIM(M)):q(H,this._createCIM(M));return H}if("composite-symbol"===L.type){for(const M of L.layers)this._createPrimitiveMeshTemplates(H,M,K);return H}return"cim"===L.type||"label"===L.type||"web-style"===L.type?H:this._createPrimitiveMeshTemplates(H,L,K)};p._createClass(F,
[{key:"_markerError",get:function(){return this._errorTemplates.marker[0]}},{key:"_fillError",get:function(){return this._errorTemplates.fill[0]}},{key:"_lineError",get:function(){return this._errorTemplates.line[0]}},{key:"_textError",get:function(){return this._errorTemplates.line[0]}}]);return F}();m.WGLTemplateStore=t;m.errorPointSchema2D=z;m.errorPolygonSchema2D=E;m.errorPolylineSchema2D=C;m.isDynamicId=y;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../color ../../definitions ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./util ./WGLBaseFillTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d,a){return function(c){function f(g,n,k){var x=c.call(this,g)||this;x._minMaxZoom=h.i1616to32(Math.round(n*u.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(k*u.MIN_MAX_ZOOM_PRECISION_FACTOR));e.isFunction(g.color)?x._dynamicPropertyMap.set("fillColor",(w,z,C)=>(w=g.color(w,z,C))&&B.premultiplyAlphaRGBA(w)||0):(n=g.color,x.fillColor=n&&B.premultiplyAlphaRGBA(n)||0);const r="CIMMarkerPlacementInsidePolygon"===g.cim.placement?.type&&g.cim.placement.shiftOddRows?2:1,v=g.height;
e.isFunction(v)?x._dynamicPropertyMap.set("_height",(w,z,C)=>v(w,z,C)*r):x._height=(v||0)*r;const q=g.offsetX;e.isFunction(q)?x._dynamicPropertyMap.set("_offsetX",(w,z,C)=>D.pt2px(q(w,z,C))):x._offsetX=D.pt2px(q||0);const y=g.offsetY;e.isFunction(y)?x._dynamicPropertyMap.set("_offsetY",(w,z,C)=>D.pt2px(-y(w,z,C))):x._offsetY=D.pt2px(-y||0);n=g.scaleX;e.isFunction(n)?x._dynamicPropertyMap.set("_scaleX",n):x._scaleX=n||1;const A=g.angle;e.isFunction(A)?x._dynamicPropertyMap.set("_angle",(w,z,C)=>t.degToByte(A(w,
z,C))):x._angle=t.degToByte(A)||0;p.isSome(g.effects)&&(n=g.effects,e.isFunction(n)?x._dynamicPropertyMap.set("_effects",n):x._effects=n);x._cimFillLayer=g;x._bitset=(g.colorLocked?u.BITSET_GENERIC_LOCK_COLOR:0)|(g.applyRandomOffset?u.BITSET_FILL_RANDOM_PATTERN_OFFSET:0)|(g.sampleAlphaOnly?u.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0)|(g.hasUnresolvedReplacementColor?u.BITSET_FILL_HAS_UNRESOLVED_REPLACEMENT_COLOR:0);x._fillMaterialKey=g.materialKey;return x}m._inheritsLoose(f,c);f.fromCIMFill=function(g,
n){const [k,x]=e.getMinMaxZoom(g.scaleInfo,n);return new f(g,k,x)};f.prototype.bindFeature=function(g,n,k){const x=g.readLegacyFeature();this._dynamicPropertyMap.forEach((q,y)=>{this[y]=q(x,n,k)});g=l.FillMaterialKey.load(this._fillMaterialKey);var r=this._materialCache,v=this._cimFillLayer.materialHash;v=v(x,n,k);v=r.get(v);r=null;v&&a.ok(v.spriteMosaicItem)&&(r=v.spriteMosaicItem);if(r){const {rect:q,width:y,height:A}=r;v=q.x+u.SPRITE_PADDING;const w=q.y+u.SPRITE_PADDING,z=v+y,C=w+A;let E=Math.round(D.pt2px(this._height));
0>=E&&(E=C-w);let F=Math.round(D.pt2px(this._height/A*y||0));0>=F&&(F=z-v);const G=this._scaleX;this.tl=h.i1616to32(v,w);this.br=h.i1616to32(z,C);this.aux21=h.i1616to32(F,E);this.aux22=h.i1616to32(this._offsetX,this._offsetY);this.aux3=h.i8888to32(128*G,128,this._angle,0);g.sdf=r.sdf;g.pattern=!0;g.textureBinding=r.textureBinding}else this.aux3=this.aux22=this.aux21=this.br=this.tl=0,g.sdf=!1,g.pattern=!1,g.textureBinding=0;this._materialKey=g.data};return f}(b(d))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../layers/graphics/featureConversionUtils ../../enums ../../number ../../Utils ../../materialKey/MaterialKey ./templateUtils ./WGLLineTemplate".split(" "),
function(m,p,D,B,u,t,h,l,e){return b=>function(d){function a(...f){f=d.call(this,...f)||this;f.forceLibtess=!1;f._bitset=0;f._lineTemplate=null;f.geometryType=B.WGLGeometryType.FILL;return f}m._inheritsLoose(a,d);var c=a.prototype;c._maybeAddLineTemplate=function(f){this._lineTemplate=e.fromFillOutline(f)};c._write=function(f,g,n,k){n="esriGeometryPoint"===g.geometryType;const x=h.FillMaterialKey.load(this._materialKey);f.recordStart(g.getDisplayId(),this._materialKey,this.geometryType,n);this._writeGeometry(f,
g,x,k,n);h.hasOutlineFillSymbology(x)&&p.isSome(this._lineTemplate)&&this._lineTemplate.writeGeometry(f,g,k,n);f.recordEnd()};c._writeGeometry=function(f,g,n,k,x){k=this._getGeometry(g,k,x);p.isNone(k)||(x=[],100<k.maxLength||this.forceLibtess||!l.triangulate(x,k)?(k=l.triangulateLibtess(k),this._writeVertices(f,g,k,[k.length/2],n)):x.length&&this._writeVertices(f,g,k.coords,k.lengths,n,x))};c._writeVertex=function(f,g,n,k,x,r){const v=u.i1616to32(1*k,1*x);f.vertexBounds(k,x,0,0);f.vertexWrite(v);
f.vertexWrite(g);n.symbologyType===B.WGLSymbologyType.DOT_DENSITY?f.vertexWriteF32(1/Math.abs(r.readGeometryArea())):(f.vertexWrite(this.fillColor),g=h.hasSimpleSymbology(n),g||(f.vertexWrite(this.tl),f.vertexWrite(this.br)),f.vertexWrite(this.aux21),f.vertexWrite(this.aux22),f.vertexWrite(this.aux3),g||f.vertexWrite(this._minMaxZoom))};c._writeVertices=function(f,g,n,k,x,r){var v=g.getDisplayId();v|=this._bitset<<24;var q=k.reduce((A,w)=>A+w);const y=t.getStrides(x.geometryType,x.symbologyType).geometry/
4;k=f.vertexCount();f.vertexEnsureSize(y*q);q=0;if(r)for(const A of r)this._writeVertex(f,v,x,n[2*A],n[2*A+1],g),q++;else for(r=0;r<n.length;r+=2)this._writeVertex(f,v,x,Math.round(n[r]),Math.round(n[r+1]),g),q++;f.indexEnsureSize(q);for(g=0;g<q;g++)f.indexWrite(g+k)};c._getGeometry=function(f,g,n){return(f=g?D.deltaDecodeGeometry(D.convertFromGeometry(g),2):f.readGeometryForDisplay())?l.clipMarshall(f,n?256:8):null};return a}(b)})},"esri/views/2d/engine/webgl/mesh/templates/templateUtils":function(){define("exports ../../../../../../core/maybe ../../../../../../chunks/earcut ../../../../../../geometry/libtess ../../../../../../geometry/support/TileClipper ../../../../../../layers/graphics/OptimizedGeometry ../../definitions ../bufcut".split(" "),
function(m,p,D,B,u,t,h,l){function e(c,f,g){let n=0;for(let k=1;k<g;k++)n+=(c[2*(f+k)]-c[2*(f+k-1)])*(c[2*(f+k)+1]+c[2*(f+k-1)+1]);return n}function b(c,f,g,n,k){let x=0;for(;g<n;g+=3){const r=2*(c[g]-k),v=2*(c[g+1]-k),q=2*(c[g+2]-k);x+=Math.abs((f[r]-f[q])*(f[v+1]-f[r+1])-(f[r]-f[v])*(f[q+1]-f[r+1]))}return x}const d=new u.TileClipper(0,0,0,1,0),a=new u.TileClipper(0,0,0,1,0);d.setExtent(h.TILE_SIZE);a.setExtent(h.TILE_SIZE);m.area=e;m.clipLinesMarshall=function(c,f){a.setPixelMargin(f);const g=
-f;f=h.TILE_SIZE+f;let n=[];var k=!1;let x=0;for(;x<c.length;){const r=[],v=c[x];if(!v)return null;a.reset(u.GeometryType.LineString);let [q,y]=v[0];if(k)a.moveTo(q,y);else{if(q<g||q>f||y<g||y>f){k=!0;continue}r.push({x:q,y})}let A=!1;const w=v.length;for(let z=1;z<w;++z)if(q+=v[z][0],y+=v[z][1],k)a.lineTo(q,y);else{if(q<g||q>f||y<g||y>f){A=!0;break}r.push({x:q,y})}if(A)k=!0;else{if(k){if(k=a.resultWithStarts())for(const z of k)n.push(z)}else n.push({line:r,start:0});x++;k=!1}}n=n.filter(r=>1<r.line.length);
return 0===n.length?null:n};m.clipMarshall=function(c,f){if(p.isNone(c))return null;a:{var g=h.TILE_SIZE+128;var n=0;for(var k=0;k<c.lengths.length;k++){var x=c.lengths[k];for(var r=0;r<x;r++){const v=c.coords[2*(r+n)],q=c.coords[2*(r+n)+1];if(-128>v||v>g||-128>q||q>g){g=!0;break a}}n+=x}g=!1}if(!g)return c;d.setPixelMargin(f);d.reset(u.GeometryType.Polygon);f=0;for(g=0;g<c.lengths.length;g++){n=c.lengths[g];k=c.coords[2*(0+f)];x=c.coords[2*(0+f)+1];d.moveTo(k,x);for(r=1;r<n;r++)k=c.coords[2*(r+f)],
x=c.coords[2*(r+f)+1],d.lineTo(k,x);d.close();f+=n}g=d.result(!1);if(!g)return null;c=[];f=[];for(const v of g){g=0;for(const q of v)f.push(q.x),f.push(q.y),g++;c.push(g)}return new t(c,f)};m.triangleAreaArray=b;m.triangulate=function(c,f){const {coords:g,lengths:n,hasIndeterminateRingOrder:k}=f;if(k)return!1;f=0;for(var x=0;x<n.length;){let q=x,y=n[x];x=e(g,f,y);for(var r=[];++q<n.length;){var v=n[q];const A=e(g,f+y,v);if(!(0<A))break;x+=A;r.push(f+y);y+=v}v=c.length;l.bufcut(c,g,f,f+y,r,2,0);r=
b(c,g,v,c.length,0);x=Math.abs(x);if(1E-5<Math.abs((r-x)/Math.max(1E-7,x)))return c.length=0,!1;x=q;f+=y}return!0};m.triangulateEarcut=function(c,f,g){const {coords:n,lengths:k,hasIndeterminateRingOrder:x}=f;if(x)return!1;let r=0;for(var v=0;v<k.length;){let y=v,A=k[v];for(v=[];++y<k.length;){var q=k[y];if(!(0<e(n,r+A,q)))break;v.push(r+A-r);A+=q}q=f.coords.slice(2*r,2*(r+A));v=D.earcut(q,v,2);for(const w of v)c.push(w+g+r);v=y;r+=A}return!0};m.triangulateLibtess=function(c){const {coords:f,lengths:g}=
c;({buffer:c}=B.triangulate(f,g));return c};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/earcut":function(){define(["exports"],function(m){var p={};(function(D){(function(B){B=B();void 0!==B&&(D.exports=B)})(function(){function B(z,C,E){E=E||2;var F=C&&C.length,G=F?C[0]*E:z.length,H=u(z,0,G,E,!0),L=[];if(!H||H.next===H.prev)return L;var K;if(F){var M=H;var U=E;H=[];var T;F=0;for(T=C.length;F<T;F++){var Z=C[F]*U;var X=F<T-1?C[F+1]*U:z.length;Z=u(z,Z,X,U,!1);Z===Z.next&&
(Z.steiner=!0);X=H;var ca=X.push,P=Z,J=Z;do{if(P.x<J.x||P.x===J.x&&P.y<J.y)J=P;P=P.next}while(P!==Z);ca.call(X,J)}H.sort(e);for(F=0;F<H.length;F++)U=H[F],C=M,(M=d(U,C))?(T=v(M,U),U=t(M,M.next),T=b(T),t(T,T.next),U=b(U),M=b(C===M?U:C)):M=C,M=t(M,M.next);H=M}if(z.length>80*E){var N=K=z[0];var S=F=z[1];for(U=E;U<G;U+=E)C=z[U],M=z[U+1],C<N&&(N=C),M<S&&(S=M),C>K&&(K=C),M>F&&(F=M);K=Math.max(K-N,F-S);K=0!==K?1/K:0}h(H,L,E,N,S,K);return L}function u(z,C,E,F,G){if(G===0<w(z,C,E,F))for(G=C;G<E;G+=F)var H=
q(G,z[G],z[G+1],H);else for(G=E-F;G>=C;G-=F)H=q(G,z[G],z[G+1],H);H&&g(H,H.next)&&(z=H.next,y(H),H=z);return H}function t(z,C){if(!z)return z;C||(C=z);do{var E=!1;if(z.steiner||!g(z,z.next)&&0!==f(z.prev,z,z.next))z=z.next;else{C=z.prev;y(z);z=C;if(z===z.next)break;E=!0}}while(E||z!==C);return C}function h(z,C,E,F,G,H,L){if(z){if(!L&&H){var K=z,M=K;do null===M.z&&(M.z=a(M.x,M.y,F,G,H)),M.prevZ=M.prev,M=M.nextZ=M.next;while(M!==K);M.prevZ.nextZ=null;M.prevZ=null;K=M;var U,T,Z,X,ca=1;do{M=K;var P=K=
null;for(T=0;M;){T++;var J=M;for(U=Z=0;U<ca&&(Z++,J=J.nextZ,J);U++);for(X=ca;0<Z||0<X&&J;)0!==Z&&(0===X||!J||M.z<=J.z)?(U=M,M=M.nextZ,Z--):(U=J,J=J.nextZ,X--),P?P.nextZ=U:K=U,U.prevZ=P,P=U;M=J}P.nextZ=null;ca*=2}while(1<T)}for(K=z;z.prev!==z.next;){M=z.prev;J=z.next;if(H)P=l(z,F,G,H);else a:if(P=z,T=P.prev,Z=P,ca=P.next,0<=f(T,Z,ca))P=!1;else{for(U=P.next.next;U!==P.prev;){if(c(T.x,T.y,Z.x,Z.y,ca.x,ca.y,U.x,U.y)&&0<=f(U.prev,U,U.next)){P=!1;break a}U=U.next}P=!0}if(P)C.push(M.i/E),C.push(z.i/E),C.push(J.i/
E),y(z),K=z=J.next;else if(z=J,z===K){if(!L)h(t(z),C,E,F,G,H,1);else if(1===L){z=t(z);L=C;K=E;M=z;do J=M.prev,P=M.next.next,!g(J,P)&&n(J,M,M.next,P)&&r(J,P)&&r(P,J)&&(L.push(J.i/K),L.push(M.i/K),L.push(P.i/K),y(M),y(M.next),M=z=P),M=M.next;while(M!==z);z=t(M);h(z,C,E,F,G,H,2)}else if(2===L)a:{L=z;do{for(K=L.next.next;K!==L.prev;){if(M=L.i!==K.i){P=P=P=P=void 0;M=L;J=K;if(P=M.next.i!==J.i&&M.prev.i!==J.i){b:{P=M;do{if(P.i!==M.i&&P.next.i!==M.i&&P.i!==J.i&&P.next.i!==J.i&&n(P,P.next,M,J)){P=!0;break b}P=
P.next}while(P!==M);P=!1}P=!P}if(P){if(P=r(M,J)&&r(J,M)){P=M;T=!1;Z=(M.x+J.x)/2;ca=(M.y+J.y)/2;do P.y>ca!==P.next.y>ca&&P.next.y!==P.y&&Z<(P.next.x-P.x)*(ca-P.y)/(P.next.y-P.y)+P.x&&(T=!T),P=P.next;while(P!==M);P=T}P=P&&(f(M.prev,M,J.prev)||f(M,J.prev,J))||g(M,J)&&0<f(M.prev,M,M.next)&&0<f(J.prev,J,J.next)}M=P}if(M){z=v(L,K);L=t(L,L.next);z=t(z,z.next);h(L,C,E,F,G,H);h(z,C,E,F,G,H);break a}K=K.next}L=L.next}while(L!==z)}break}}}}function l(z,C,E,F){var G=z.prev,H=z.next;if(0<=f(G,z,H))return!1;var L=
G.x>z.x?G.x>H.x?G.x:H.x:z.x>H.x?z.x:H.x,K=G.y>z.y?G.y>H.y?G.y:H.y:z.y>H.y?z.y:H.y,M=a(G.x<z.x?G.x<H.x?G.x:H.x:z.x<H.x?z.x:H.x,G.y<z.y?G.y<H.y?G.y:H.y:z.y<H.y?z.y:H.y,C,E,F);C=a(L,K,C,E,F);E=z.prevZ;for(F=z.nextZ;E&&E.z>=M&&F&&F.z<=C;){if(E!==z.prev&&E!==z.next&&c(G.x,G.y,z.x,z.y,H.x,H.y,E.x,E.y)&&0<=f(E.prev,E,E.next))return!1;E=E.prevZ;if(F!==z.prev&&F!==z.next&&c(G.x,G.y,z.x,z.y,H.x,H.y,F.x,F.y)&&0<=f(F.prev,F,F.next))return!1;F=F.nextZ}for(;E&&E.z>=M;){if(E!==z.prev&&E!==z.next&&c(G.x,G.y,z.x,
z.y,H.x,H.y,E.x,E.y)&&0<=f(E.prev,E,E.next))return!1;E=E.prevZ}for(;F&&F.z<=C;){if(F!==z.prev&&F!==z.next&&c(G.x,G.y,z.x,z.y,H.x,H.y,F.x,F.y)&&0<=f(F.prev,F,F.next))return!1;F=F.nextZ}return!0}function e(z,C){return z.x-C.x}function b(z){if(z.next.prev===z)return z;let C=z;do{const E=C.next;if(E.prev===C||E===C||E===z)break;C=E}while(1);return C}function d(z,C){var E=C,F=z.x,G=z.y,H=-Infinity;do{if(G<=E.y&&G>=E.next.y&&E.next.y!==E.y){var L=E.x+(G-E.y)*(E.next.x-E.x)/(E.next.y-E.y);if(L<=F&&L>H){H=
L;if(L===F){if(G===E.y)return E;if(G===E.next.y)return E.next}var K=E.x<E.next.x?E:E.next}}E=E.next}while(E!==C);if(!K)return null;if(F===H)return K;C=K;L=K.x;var M=K.y,U=Infinity;E=K;do{if(F>=E.x&&E.x>=L&&F!==E.x&&c(G<M?F:H,G,L,M,G<M?H:F,G,E.x,E.y)){var T=Math.abs(G-E.y)/(F-E.x);var Z;if((Z=r(E,z))&&!(Z=T<U)&&(Z=T===U)&&!(Z=E.x>K.x)&&(Z=E.x===K.x)){Z=K;var X=E;Z=0>f(Z.prev,Z,X.prev)&&0>f(X.next,Z,Z.next)}Z&&(K=E,U=T)}E=E.next}while(E!==C);return K}function a(z,C,E,F,G){z=32767*(z-E)*G;C=32767*(C-
F)*G;z=(z|z<<8)&16711935;z=(z|z<<4)&252645135;z=(z|z<<2)&858993459;C=(C|C<<8)&16711935;C=(C|C<<4)&252645135;C=(C|C<<2)&858993459;return(z|z<<1)&1431655765|((C|C<<1)&1431655765)<<1}function c(z,C,E,F,G,H,L,K){return 0<=(G-L)*(C-K)-(z-L)*(H-K)&&0<=(z-L)*(F-K)-(E-L)*(C-K)&&0<=(E-L)*(H-K)-(G-L)*(F-K)}function f(z,C,E){return(C.y-z.y)*(E.x-C.x)-(C.x-z.x)*(E.y-C.y)}function g(z,C){return z.x===C.x&&z.y===C.y}function n(z,C,E,F){var G=x(f(z,C,E)),H=x(f(z,C,F)),L=x(f(E,F,z)),K=x(f(E,F,C));return G!==H&&L!==
K||0===G&&k(z,E,C)||0===H&&k(z,F,C)||0===L&&k(E,z,F)||0===K&&k(E,C,F)?!0:!1}function k(z,C,E){return C.x<=Math.max(z.x,E.x)&&C.x>=Math.min(z.x,E.x)&&C.y<=Math.max(z.y,E.y)&&C.y>=Math.min(z.y,E.y)}function x(z){return 0<z?1:0>z?-1:0}function r(z,C){return 0>f(z.prev,z,z.next)?0<=f(z,C,z.next)&&0<=f(z,z.prev,C):0>f(z,C,z.prev)||0>f(z,z.next,C)}function v(z,C){var E=new A(z.i,z.x,z.y),F=new A(C.i,C.x,C.y),G=z.next,H=C.prev;z.next=C;C.prev=z;E.next=G;G.prev=E;F.next=E;E.prev=F;H.next=F;F.prev=H;return F}
function q(z,C,E,F){z=new A(z,C,E);F?(z.next=F.next,z.prev=F,F.next.prev=z,F.next=z):(z.prev=z,z.next=z);return z}function y(z){z.next.prev=z.prev;z.prev.next=z.next;z.prevZ&&(z.prevZ.nextZ=z.nextZ);z.nextZ&&(z.nextZ.prevZ=z.prevZ)}function A(z,C,E){this.i=z;this.x=C;this.y=E;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}function w(z,C,E,F){for(var G=0,H=E-F;C<E;C+=F)G+=(z[H]-z[C])*(z[C+1]+z[H+1]),H=C;return G}B.deviation=function(z,C,E,F){var G=C&&C.length,H=Math.abs(w(z,
0,G?C[0]*E:z.length,E));if(G){G=0;for(var L=C.length;G<L;G++)H-=Math.abs(w(z,C[G]*E,G<L-1?C[G+1]*E:z.length,E))}for(G=C=0;G<F.length;G+=3){L=F[G]*E;var K=F[G+1]*E,M=F[G+2]*E;C+=Math.abs((z[L]-z[M])*(z[K+1]-z[L+1])-(z[L]-z[K])*(z[M+1]-z[L+1]))}return 0===H&&0===C?0:Math.abs((C-H)/H)};B.flatten=function(z){for(var C=z[0][0].length,E={vertices:[],holes:[],dimensions:C},F=0,G=0;G<z.length;G++){for(var H=0;H<z[G].length;H++)for(var L=0;L<C;L++)E.vertices.push(z[G][H][L]);0<G&&(F+=z[G-1].length,E.holes.push(F))}return E};
return B})})({get exports(){return p},set exports(D){p=D}});m.earcut=p})},"esri/views/2d/engine/webgl/mesh/bufcut":function(){define(["exports"],function(m){function p(q,y,A,w,z,C,E){let F;A=0;for(let G=w,H=z-C;G<z;G+=C)A+=(q[H+y*C]-q[G+y*C])*(q[G+1+y*C]+q[H+1+y*C]),H=G;if(E===0<A)for(;w<z;w+=C)F=t(w+y*C,q[w+y*C],q[w+1+y*C],F);else for(z-=C;z>=w;z-=C)F=t(z+y*C,q[z+y*C],q[z+1+y*C],F);F&&g(F,F.next)&&(h(F),F=F.next);return F}function D(q,y=q){if(!q)return q;let A;do if(A=!1,q.steiner||!g(q,q.next)&&
0!==b(q.prev,q,q.next))q=q.next;else{h(q);q=y=q.prev;if(q===q.next)break;A=!0}while(A||q!==y);return y}function B(q,y,A,w,z,C,E,F){if(q){!F&&C&&(q=e(q,w,z,C));for(var G=q;q.prev!==q.next;){var H=q.prev,L=q.next;if(C)var K=u(q,w,z,C);else a:{K=q;var M=K.prev,U=K;const T=K.next;if(0<=b(M,U,T)){K=!1;break a}let Z=K.next.next;const X=Z;let ca=0;for(;Z!==K.prev&&(0===ca||Z!==X);){ca++;if(a(M.x,M.y,U.x,U.y,T.x,T.y,Z.x,Z.y)&&0<=b(Z.prev,Z,Z.next)){K=!1;break a}Z=Z.next}K=!0}if(K)y.push(H.index/A+E),y.push(q.index/
A+E),y.push(L.index/A+E),h(q),G=q=L.next;else if(q=L,q===G){if(!F)B(D(q),y,A,w,z,C,E,1);else if(1===F){F=y;G=A;H=E;L=q;do K=L.prev,M=L.next.next,!g(K,M)&&d(K,L,L.next,M)&&c(K,M)&&c(M,K)&&(F.push(K.index/G+H),F.push(L.index/G+H),F.push(M.index/G+H),h(L),h(L.next),L=q=M),L=L.next;while(L!==q);q=L;B(q,y,A,w,z,C,E,2)}else if(2===F)a:{F=q;do{for(G=F.next.next;G!==F.prev;){if(H=F.index!==G.index){K=K=K=void 0;H=F;L=G;if(K=H.next.index!==L.index&&H.prev.index!==L.index){b:{K=H;do{if(K.index!==H.index&&K.next.index!==
H.index&&K.index!==L.index&&K.next.index!==L.index&&d(K,K.next,H,L)){K=!0;break b}K=K.next}while(K!==H);K=!1}K=!K}if(K=K&&c(H,L)&&c(L,H)){K=H;M=!1;U=(H.x+L.x)/2;L=(H.y+L.y)/2;do K.y>L!==K.next.y>L&&K.next.y!==K.y&&U<(K.next.x-K.x)*(L-K.y)/(K.next.y-K.y)+K.x&&(M=!M),K=K.next;while(K!==H);K=M}H=K}if(H){q=k(F,G);F=D(F,F.next);q=D(q,q.next);B(F,y,A,w,z,C,E,0);B(q,y,A,w,z,C,E,0);break a}G=G.next}F=F.next}while(F!==q)}break}}}}function u(q,y,A,w){const z=q.prev,C=q.next;if(0<=b(z,q,C))return!1;const E=
z.x>q.x?z.x>C.x?z.x:C.x:q.x>C.x?q.x:C.x,F=z.y>q.y?z.y>C.y?z.y:C.y:q.y>C.y?q.y:C.y,G=f(z.x<q.x?z.x<C.x?z.x:C.x:q.x<C.x?q.x:C.x,z.y<q.y?z.y<C.y?z.y:C.y:q.y<C.y?q.y:C.y,y,A,w);y=f(E,F,y,A,w);A=q.prevZ;for(w=q.nextZ;A&&A.z>=G&&w&&w.z<=y;){if(A!==q.prev&&A!==q.next&&a(z.x,z.y,q.x,q.y,C.x,C.y,A.x,A.y)&&0<=b(A.prev,A,A.next))return!1;A=A.prevZ;if(w!==q.prev&&w!==q.next&&a(z.x,z.y,q.x,q.y,C.x,C.y,w.x,w.y)&&0<=b(w.prev,w,w.next))return!1;w=w.nextZ}for(;A&&A.z>=G;){if(A!==q.prev&&A!==q.next&&a(z.x,z.y,q.x,
q.y,C.x,C.y,A.x,A.y)&&0<=b(A.prev,A,A.next))return!1;A=A.prevZ}for(;w&&w.z<=y;){if(w!==q.prev&&w!==q.next&&a(z.x,z.y,q.x,q.y,C.x,C.y,w.x,w.y)&&0<=b(w.prev,w,w.next))return!1;w=w.nextZ}return!0}function t(q,y,A,w){q=x.create(q,y,A);w?(q.next=w.next,q.prev=w,w.next.prev=q,w.next=q):(q.prev=q,q.next=q);return q}function h(q){q.next.prev=q.prev;q.prev.next=q.next;q.prevZ&&(q.prevZ.nextZ=q.nextZ);q.nextZ&&(q.nextZ.prevZ=q.prevZ)}function l(q,y){let A=y;const w=q.x,z=q.y;let C=-Infinity,E;do{if(z<=A.y&&
z>=A.next.y&&A.next.y!==A.y){var F=A.x+(z-A.y)*(A.next.x-A.x)/(A.next.y-A.y);if(F<=w&&F>C){C=F;if(F===w){if(z===A.y)return A;if(z===A.next.y)return A.next}E=A.x<A.next.x?A:A.next}}A=A.next}while(A!==y);if(!E)return null;if(w===C)return E.prev;y=E;F=E.x;const G=E.y;let H=Infinity,L;for(A=E.next;A!==y;)w>=A.x&&A.x>=F&&w!==A.x&&a(z<G?w:C,z,F,G,z<G?C:w,z,A.x,A.y)&&(L=Math.abs(z-A.y)/(w-A.x),(L<H||L===H&&A.x>E.x)&&c(A,q)&&(E=A,H=L)),A=A.next;return E}function e(q,y,A,w){for(var z;z!==q;z=z.next){z=z||
q;null===z.z&&(z.z=f(z.x,z.y,y,A,w));if(z.prev.next!==z||z.next.prev!==z)return z.prev.next=z,z.next.prev=z,e(q,y,A,w);z.prevZ=z.prev;z.nextZ=z.next}q.prevZ.nextZ=null;q.prevZ=null;a:for(A=1;;){w=q;y=q=null;let C=0;for(;w;){C++;z=w;let E=0;for(;E<A&&z;E++)z=z.nextZ;let F=A;for(;0<E||0<F&&z;){let G;0===E?(G=z,z=z.nextZ,F--):0!==F&&z?w.z<=z.z?(G=w,w=w.nextZ,E--):(G=z,z=z.nextZ,F--):(G=w,w=w.nextZ,E--);y?y.nextZ=G:q=G;G.prevZ=y;y=G}w=z}y.nextZ=null;A*=2;if(2>C)break a}return q}function b(q,y,A){return(y.y-
q.y)*(A.x-y.x)-(y.x-q.x)*(A.y-y.y)}function d(q,y,A,w){return g(q,y)&&g(A,w)||g(q,w)&&g(A,y)?!0:0<b(q,y,A)!==0<b(q,y,w)&&0<b(A,w,q)!==0<b(A,w,y)}function a(q,y,A,w,z,C,E,F){return 0<=(z-E)*(y-F)-(q-E)*(C-F)&&0<=(q-E)*(w-F)-(A-E)*(y-F)&&0<=(A-E)*(C-F)-(z-E)*(w-F)}function c(q,y){return 0>b(q.prev,q,q.next)?0<=b(q,y,q.next)&&0<=b(q,q.prev,y):0>b(q,y,q.prev)||0>b(q,q.next,y)}function f(q,y,A,w,z){q=32767*(q-A)*z;y=32767*(y-w)*z;q=(q|q<<8)&16711935;q=(q|q<<4)&252645135;q=(q|q<<2)&858993459;y=(y|y<<8)&
16711935;y=(y|y<<4)&252645135;y=(y|y<<2)&858993459;return(q|q<<1)&1431655765|((y|y<<1)&1431655765)<<1}function g(q,y){return q.x===y.x&&q.y===y.y}function n(q,y){return q.x-y.x}function k(q,y){const A=x.create(q.index,q.x,q.y),w=x.create(y.index,y.x,y.y),z=q.next,C=y.prev;q.next=y;y.prev=q;A.next=z;z.prev=A;w.next=A;A.prev=w;C.next=w;w.prev=C;return w}let x=function(){function q(){this.y=this.x=this.index=0;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}q.create=function(y,
A,w){const z=v<r.length?r[v++]:new q;z.index=y;z.x=A;z.y=w;z.prev=null;z.next=null;z.z=null;z.prevZ=null;z.nextZ=null;z.steiner=!1;return z};return q}();const r=[];let v=0;for(let q=0;8096>q;q++)r.push(new x);m.bufcut=function(q,y,A,w,z,C,E){v=0;var F=(w-A)*C,G=z&&z.length;const H=G?(z[0]-A)*C:F;var L=p(y,A,w,0,H,C,!0);if(L&&L.next!==L.prev){var K;if(G){const X=[];for(let ca=0,P=z.length;ca<P;ca++){const J=p(y,A,w,z[ca]*C,ca<P-1?z[ca+1]*C:w*C,C,!1);J===J.next&&(J.steiner=!0);G=X;var M=G.push;let N=
J,S=J;do{if(N.x<S.x||N.x===S.x&&N.y<S.y)S=N;N=N.next}while(N!==J);M.call(G,S)}X.sort(n);for(var U of X)if(w=U,z=l(w,L))w=k(z,w),D(w,w.next),L=D(z,z.next)}if(F>80*C){var T=F=y[A*C];var Z=K=y[1+A*C];for(U=C;U<H;U+=C)w=y[U+A*C],z=y[U+1+A*C],T=Math.min(T,w),Z=Math.min(Z,z),F=Math.max(F,w),K=Math.max(K,z);K=Math.max(F-T,K-Z);K=0!==K?1/K:0}B(L,q,C,T,Z,K,E,0)}};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/WGLLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Logger ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../color ../../definitions ../../number ../../Utils ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLMeshTemplate".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d,a){return function(c){function f(g,n,k,x,r,v,q,y,A,w,z,C,E,F,G,H,L,K,M,U){var T=c.call(this)||this;g=e.LineMaterialKey.load(g);n&&(g.sdf=n.sdf,g.pattern=!0,g.textureBinding=n.textureBinding);T._capType=x;T._joinType=r;T._miterLimitCosine=b.getLimitCosine(v);T.tessellationProperties._fillColor=q;T.tessellationProperties._tl=y;T.tessellationProperties._br=A;T._hasPattern=w;T._isDashed=z;T._zOrder=L;T._effects=K;T._minMaxZoom=h.i1616to32(Math.round(M*t.MIN_MAX_ZOOM_PRECISION_FACTOR),
Math.round(U*t.MIN_MAX_ZOOM_PRECISION_FACTOR));T._materialKey=g.data;T.tessellationProperties._bitset=(E?t.BITSET_GENERIC_LOCK_COLOR:0)|(F?t.BITSET_TYPE_FILL_OUTLINE:0)|(C?t.BITSET_LINE_SCALE_DASH:0)|(G?t.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0);T.tessellationProperties._halfWidth=.5*k;T.tessellationProperties._halfReferenceWidth=.5*H;T.tessellationProperties.offset=0;T._initializeTessellator(!1);return T}m._inheritsLoose(f,c);f.fromCIMLine=function(g,n,k){var x=g.color,r=g.scaleFactor||1;const v=!!g.dashTemplate;
let q=g.cap;v&&q===B.CapType.ROUND&&(q=B.CapType.SQUARE);const y=g.join;r*=D.pt2px(g.width);const A=D.pt2px(g.referenceWidth),w=D.pt2px(g.miterLimit);x=x&&u.premultiplyAlphaRGBA(x)||0;const [z,C]=b.getMinMaxZoom(g.scaleInfo,k);if(!n)return new f(g.materialKey,n,r,q,y,w,x,0,0,!1,v,g.scaleDash??!1,g.colorLocked??!1,!1,g.sampleAlphaOnly,A,g.zOrder,g.effects,z,C);const {rect:E,width:F,height:G}=n;var H=E.x+t.SPRITE_PADDING;const L=E.y+t.SPRITE_PADDING;k=H+F;const K=L+G;H=h.i1616to32(H,L);k=h.i1616to32(k,
K);return new f(g.materialKey,n,r,q,y,w,x,H,k,!0,v,g.scaleDash??!1,g.colorLocked??!1,!1,g.sampleAlphaOnly,A,g.zOrder,g.effects,z,C)};f.fromFillOutline=function(g){const n=e.FillMaterialKey.load(g.materialKey);return e.hasOutlineFillSymbology(n)&&g.outline&&"esriSLSSolid"===g.outline?.style?f.fromSimpleLine({hash:"",materialKey:g.materialKey,...g.outline},null,!0):null};f.fromSimpleLine=function(g,n,k=!1){var {color:x}=g;const r="esriSLSSolid"!==g.style&&"esriSLSNull"!==g.style,v=l.getCapType(g.cap||
"round"),q=l.getJoinType(g.join||"round");x=x&&"esriSLSNull"!==g.style&&u.premultiplyAlphaRGBAArray(x)||0;"esriSLSNull"===g.style&&(x=0);const y=D.pt2px(g.width),A=g.miterLimit;if(!n)return new f(g.materialKey,n,y,v,q,A,x,0,0,!1,r,!0,!1,k,!1,y,0,null,b.DEFAULT_MIN_ZOOM,b.DEFAULT_MAX_ZOOM);const {rect:w,width:z,height:C}=n;var E=w.x+t.SPRITE_PADDING;const F=w.y+t.SPRITE_PADDING;var G=E+z;const H=F+C;E=h.i1616to32(E,F);G=h.i1616to32(G,H);return new f(g.materialKey,n,y,v,q,A,x,E,G,!0,r,!0,!1,k,!1,y,
0,null,b.DEFAULT_MIN_ZOOM,b.DEFAULT_MAX_ZOOM)};f.fromPictureLineSymbol=function(g,n,k,x){p.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate").error("PictureLineSymbol support does not exist!");return null};return f}(d(a))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../definitions ../../enums ../../number ../../TurboLine ../../materialKey/MaterialKey ./templateUtils".split(" "),
function(m,p,D,B,u,t,h,l){const e=(a,c,f)=>(g,n,k,x,r,v,q,y,A,w,z)=>{k=u.i1616to32(z,Math.ceil(16*a._halfWidth));q=u.i8888to32(Math.round(16*q),Math.round(16*y),Math.round(16*A),Math.round(16*w));r=u.i8888to32(16*r,16*v,0,a._bitset);v=a.out;v.vertexBounds(g,n,c,f);v.vertexWrite(u.i1616to32(8*g,8*n));v.vertexWrite(a.id);v.vertexWrite(a._fillColor);v.vertexWrite(q);v.vertexWrite(k);v.vertexWrite(a._tl);v.vertexWrite(a._br);v.vertexWrite(r);v.vertexWrite(u.i1616to32(Math.ceil(16*a._halfReferenceWidth),
0));v.vertexWrite(a.minMaxZoom);v.vertexEnd();return a.offset+a.vertexCount++},b=(a,c,f)=>(g,n,k,x,r,v,q,y,A,w,z)=>{k=u.i1616to32(16*a._halfWidth,16*a._halfReferenceWidth);q=u.i8888to32(16*q+128,16*y+128,16*A+128,16*w+128);y=a.out;A=a._bitset<<24|a.id;y.vertexBounds(g,n,c,f);y.vertexWrite(u.i1616to32(8*g,8*n));y.vertexWrite(A);y.vertexWrite(a._fillColor);g=h.hasSimpleSymbology(a.key);g||(y.vertexWrite(0),y.vertexWrite(0));y.vertexWrite(0);y.vertexWrite(k);y.vertexWrite(q);g||y.vertexWrite(a.minMaxZoom);
y.vertexEnd();return a.offset+a.vertexCount++},d=a=>(c,f,g)=>{const n=a.out;n.indexWrite(c);n.indexWrite(f);n.indexWrite(g);a.indexCount+=3};return a=>function(c){function f(...n){n=c.call(this,...n)||this;n.tessellationProperties={};n._tessellationOptions={halfWidth:0,pixelCoordRatio:1,offset:0};n.geometryType=B.WGLGeometryType.LINE;return n}m._inheritsLoose(f,c);var g=f.prototype;g.writeGeometry=function(n,k,x,r){this._writeGeometry(n,k,x,r)};g._initializeTessellator=function(n){var k=h.LineMaterialKey.load(this._materialKey),
x=h.FillMaterialKey.load(this._materialKey),r=this._tessellationOptions;k=k.vvSizeFieldStops||k.vvSizeMinMaxValue||k.vvSizeScaleStops||k.vvSizeUnitValue;n=this.tessellationProperties._halfWidth<D.THIN_LINE_HALF_WIDTH_THRESHOLD&&!n&&!k;this.tessellationProperties.minMaxZoom=this._minMaxZoom;r.wrapDistance=65535;r.textured=this._isDashed||this._hasPattern;r.offset=this.tessellationProperties.offset;r.halfWidth=this.tessellationProperties._halfWidth;r=n?0:1;x=h.hasOutlineFillSymbology(x)?b:e;this._lineTessellator=
new t.LineTessellation(x(this.tessellationProperties,r,r),d(this.tessellationProperties),n)};g._write=function(n,k,x,r){x="esriGeometryPoint"===k.geometryType;n.recordStart(k.getDisplayId(),this._materialKey,this.geometryType,x);this._writeGeometry(n,k,r,x);n.recordEnd()};g._writeGeometry=function(n,k,x,r){x=x??k.readLegacyGeometryForDisplay();r=this._getLines(x,r);p.isNone(r)||this._writeVertices(n,k,r)};g._getLines=function(n,k){if(p.isNone(n))return null;n=n.paths||n.rings;return p.isNone(n)?null:
l.clipLinesMarshall(n,k?256:16)};g._writeVertices=function(n,k,x){const r=k.getDisplayId(),v=n.vertexCount(),q=this.tessellationProperties;k=this._tessellationOptions;q.out=n;q.id=r;q.indexCount=0;q.vertexCount=0;q.offset=v;k.capType=this._capType;k.joinType=this._joinType;n=h.FillMaterialKey.load(this._materialKey);this.tessellationProperties.key=h.hasOutlineFillSymbology(n)?n:h.LineMaterialKey.load(this._materialKey);for(const {line:y,start:A}of x)k.initialDistance=A%65535,this._lineTessellator.tessellate(y,
k)};return f}(a)})},"esri/views/2d/engine/webgl/TurboLine":function(){define(["exports","../../../../symbols/cim/enums","./definitions"],function(m,p,D){function B(a,c){return a.x===c.x&&a.y===c.y}function u(a,c){a.x=c.y;a.y=-c.x;return a}function t(a,c){a.x=-c.y;a.y=c.x;return a}function h(a,c){a.x=c.x;a.y=c.y;return a}function l(a,c){a.x=-c.x;a.y=-c.y;return a}function e(a){return Math.sqrt(a.x*a.x+a.y*a.y)}function b(a,c,f,g){a.x=c.x*f+c.y*g;a.y=c.x*g-c.y*f;return a}let d=function(){function a(f,
g,n){this._writeVertex=f;this._writeTriangle=g;this._canUseThinTessellation=n;this._prevNormal={x:void 0,y:void 0};this._nextNormal={x:void 0,y:void 0};this._textureNormalLeft={x:0,y:1};this._textureNormalRight={x:0,y:-1};this._textureNormal={x:void 0,y:void 0};this._joinNormal={x:void 0,y:void 0};this._inner={x:void 0,y:void 0};this._outer={x:void 0,y:void 0};this._roundStart={x:void 0,y:void 0};this._roundEnd={x:void 0,y:void 0};this._startBreak={x:void 0,y:void 0};this._endBreak={x:void 0,y:void 0};
this._innerPrev={x:void 0,y:void 0};this._innerNext={x:void 0,y:void 0};this._bevelStart={x:void 0,y:void 0};this._bevelEnd={x:void 0,y:void 0};this._bevelMiddle={x:void 0,y:void 0}}var c=a.prototype;c.tessellate=function(f,g){if(f){var n=f.length;if(!(1>=n)){var k=0;for(let x=1;x<n;x++)B(f[x],f[k])||++k===x||(f[k]=f[x]);f.length=k+1}}this._canUseThinTessellation&&g.halfWidth<D.THIN_LINE_HALF_WIDTH_THRESHOLD&&!g.offset?this._tessellateThin(f,g):this._tessellate(f,g)};c._tessellateThin=function(f,
g){if(!(2>f.length)){var n=g.wrapDistance||65535;g=g.initialDistance||0;var k=!1,x=f[0].x,r=f[0].y,v=f.length;for(let w=1;w<v;++w){k&&(k=!1,g=0);let z=f[w].x,C=f[w].y;var q=z-x;let E=C-r;var y=Math.sqrt(q*q+E*E);q/=y;E/=y;if(g+y>n){k=!0;var A=(n-g)/y;y=n-g;z=(1-A)*x+A*z;C=(1-A)*r+A*C;--w}A=this._writeVertex(x,r,0,0,q,E,E,-q,0,-1,g);x=this._writeVertex(x,r,0,0,q,E,-E,q,0,1,g);g+=y;y=this._writeVertex(z,C,0,0,q,E,E,-q,0,-1,g);q=this._writeVertex(z,C,0,0,q,E,-E,q,0,1,g);this._writeTriangle(A,x,y);this._writeTriangle(x,
y,q);x=z;r=C}}};c._tessellate=function(f,g){var n=f[f.length-1];const k=B(f[0],n);if(!(f.length<(k?3:2))){var x=g.pixelCoordRatio,r=null!=g.capType?g.capType:p.CapType.BUTT,v=null!=g.joinType?g.joinType:p.JoinType.MITER,q=null!=g.miterLimit?Math.min(g.miterLimit,4):2,y=null!=g.roundLimit?Math.min(g.roundLimit,1.05):1.05,A=null!=g.halfWidth?g.halfWidth:2,w=!!g.textured,z=null,C=this._prevNormal,E=this._nextNormal,F=-1,G=-1,H=this._joinNormal,L=this._textureNormalLeft,K=this._textureNormalRight,M=this._textureNormal,
U=-1,T=-1,Z=g.wrapDistance||65535,X=g.initialDistance||0,ca=this._writeVertex,P=this._writeTriangle;g=(ia,la,ka,ja,ma,na)=>{ia=ca(N,S,ba,aa,ka,ja,ia,la,ma,na,X);0<=U&&0<=T&&0<=ia&&P(U,T,ia);U=T;return T=ia};if(k){var J=f[f.length-2];E.x=n.x-J.x;E.y=n.y-J.y;G=e(E);E.x/=G;E.y/=G}n=!1;for(let ia=0;ia<f.length;++ia){n&&(n=!1,X=0);J&&(C.x=-E.x,C.y=-E.y,F=G,X+F>Z&&(n=!0));n?(z=(Z-X)/F,F=Z-X,J={x:(1-z)*J.x+z*f[ia].x,y:(1-z)*J.y+z*f[ia].y},--ia):J=f[ia];var N=J.x;var S=J.y;var Q=0>=ia&&!n,Y=ia===f.length-
1;Q||(X+=F);(z=Y?k?f[1]:null:f[ia+1])?(E.x=z.x-N,E.y=z.y-S,G=e(E),E.x/=G,E.y/=G):(E.x=void 0,E.y=void 0);if(!k){if(Q){t(H,E);var ba=H.x;var aa=H.y;r===p.CapType.SQUARE&&(g(-E.y-E.x,E.x-E.y,E.x,E.y,0,-1),g(E.y-E.x,-E.x-E.y,E.x,E.y,0,1));r===p.CapType.ROUND&&(g(-E.y-E.x,E.x-E.y,E.x,E.y,-1,-1),g(E.y-E.x,-E.x-E.y,E.x,E.y,-1,1));if(r===p.CapType.ROUND||r===p.CapType.BUTT)g(-E.y,E.x,E.x,E.y,0,-1),g(E.y,-E.x,E.x,E.y,0,1);continue}if(Y){u(H,C);ba=H.x;aa=H.y;if(r===p.CapType.ROUND||r===p.CapType.BUTT)g(C.y,
-C.x,-C.x,-C.y,0,-1),g(-C.y,C.x,-C.x,-C.y,0,1);r===p.CapType.SQUARE&&(g(C.y-C.x,-C.x-C.y,-C.x,-C.y,0,-1),g(-C.y-C.x,C.x-C.y,-C.x,-C.y,0,1));r===p.CapType.ROUND&&(g(C.y-C.x,-C.x-C.y,-C.x,-C.y,1,-1),g(-C.y-C.x,C.x-C.y,-C.x,-C.y,1,1));continue}}var I=void 0;Q=-(C.x*E.y-C.y*E.x);.01>Math.abs(Q)?0<C.x*E.x+C.y*E.y?(H.x=C.x,H.y=C.y,Q=1,I=Number.MAX_VALUE,z=!0):(t(H,E),I=Q=1,z=!1):(H.x=(C.x+E.x)/Q,H.y=(C.y+E.y)/Q,I=e(H),z=(I-1)*A*x,z=4<I||z>F&&z>G);ba=H.x;aa=H.y;var O=v;switch(v){case p.JoinType.BEVEL:1.05>
I&&(O=p.JoinType.MITER);break;case p.JoinType.ROUND:I<y&&(O=p.JoinType.MITER);break;case p.JoinType.MITER:I>q&&(O=p.JoinType.BEVEL)}switch(O){case p.JoinType.MITER:g(H.x,H.y,-C.x,-C.y,0,-1);g(-H.x,-H.y,-C.x,-C.y,0,1);if(Y)break;w&&(z=n?0:X,U=this._writeVertex(N,S,ba,aa,E.x,E.y,H.x,H.y,0,-1,z),T=this._writeVertex(N,S,ba,aa,E.x,E.y,-H.x,-H.y,0,1,z));break;case p.JoinType.BEVEL:Q=0>Q;var R=void 0;Q?(O=U,U=T,T=O,R=L,O=K):(R=K,O=L);var V=void 0,W=void 0;z?(V=Q?t(this._innerPrev,C):u(this._innerPrev,C),
W=Q?u(this._innerNext,E):t(this._innerNext,E)):V=W=Q?l(this._inner,H):h(this._inner,H);I=Q?u(this._bevelStart,C):t(this._bevelStart,C);g(V.x,V.y,-C.x,-C.y,R.x,R.y);V=g(I.x,I.y,-C.x,-C.y,O.x,O.y);if(Y)break;Y=Q?t(this._bevelEnd,E):u(this._bevelEnd,E);z?(z=this._writeVertex(N,S,ba,aa,-C.x,-C.y,0,0,0,0,X),U=this._writeVertex(N,S,ba,aa,E.x,E.y,W.x,W.y,R.x,R.y,X),T=this._writeVertex(N,S,ba,aa,E.x,E.y,Y.x,Y.y,O.x,O.y,X),this._writeTriangle(V,z,T)):(w?(z=this._bevelMiddle,z.x=(I.x+Y.x)/2,z.y=(I.y+Y.y)/2,
b(M,z,-C.x,-C.y),g(z.x,z.y,-C.x,-C.y,M.x,M.y),b(M,z,E.x,E.y),U=this._writeVertex(N,S,ba,aa,E.x,E.y,z.x,z.y,M.x,M.y,X),T=this._writeVertex(N,S,ba,aa,E.x,E.y,W.x,W.y,R.x,R.y,X)):(z=U,U=T,T=z),g(Y.x,Y.y,E.x,E.y,O.x,O.y));Q&&(z=U,U=T,T=z);break;case p.JoinType.ROUND:Q=0>Q;var da=void 0;Q?(O=U,U=T,T=O,O=L,da=K):(O=K,da=L);var ea=Q?l(this._inner,H):h(this._inner,H);z?(W=Q?t(this._innerPrev,C):u(this._innerPrev,C),R=Q?u(this._innerNext,E):t(this._innerNext,E)):R=W=ea;V=Q?u(this._roundStart,C):t(this._roundStart,
C);var fa=Q?t(this._roundEnd,E):u(this._roundEnd,E);W=g(W.x,W.y,-C.x,-C.y,O.x,O.y);V=g(V.x,V.y,-C.x,-C.y,da.x,da.y);if(Y)break;Y=this._writeVertex(N,S,ba,aa,-C.x,-C.y,0,0,0,0,X);z||this._writeTriangle(U,T,Y);ea=l(this._outer,ea);da=this._writeVertex(N,S,ba,aa,E.x,E.y,fa.x,fa.y,da.x,da.y,X);let la,ka;if(fa=2<I){var ha=void 0;I!==Number.MAX_VALUE?(ea.x/=I,ea.y/=I,ha=C.x*ea.x+C.y*ea.y,ha=(I*(ha*ha-1)+1)/ha):ha=-1;la=Q?u(this._startBreak,C):t(this._startBreak,C);la.x+=C.x*ha;la.y+=C.y*ha;ka=Q?t(this._endBreak,
E):u(this._endBreak,E);ka.x+=E.x*ha;ka.y+=E.y*ha}b(M,ea,-C.x,-C.y);I=this._writeVertex(N,S,ba,aa,-C.x,-C.y,ea.x,ea.y,M.x,M.y,X);b(M,ea,E.x,E.y);ea=w?this._writeVertex(N,S,ba,aa,E.x,E.y,ea.x,ea.y,M.x,M.y,X):I;ha=Y;const ja=w?this._writeVertex(N,S,ba,aa,E.x,E.y,0,0,0,0,X):Y;let ma=-1,na=-1;fa&&(b(M,la,-C.x,-C.y),ma=this._writeVertex(N,S,ba,aa,-C.x,-C.y,la.x,la.y,M.x,M.y,X),b(M,ka,E.x,E.y),na=this._writeVertex(N,S,ba,aa,E.x,E.y,ka.x,ka.y,M.x,M.y,X));w?fa?(this._writeTriangle(ha,V,ma),this._writeTriangle(ha,
ma,I),this._writeTriangle(ja,ea,na),this._writeTriangle(ja,na,da)):(this._writeTriangle(ha,V,I),this._writeTriangle(ja,ea,da)):fa?(this._writeTriangle(Y,V,ma),this._writeTriangle(Y,ma,na),this._writeTriangle(Y,na,da)):(this._writeTriangle(Y,V,I),this._writeTriangle(Y,ea,da));z?U=this._writeVertex(N,S,ba,aa,E.x,E.y,R.x,R.y,O.x,O.y,X):(U=w?this._writeVertex(N,S,ba,aa,E.x,E.y,R.x,R.y,O.x,O.y,X):W,this._writeTriangle(U,ja,da));T=da;Q&&(z=U,U=T,T=z)}}}};return a}();m.LineTessellation=d;Object.defineProperty(m,
Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMeshTemplate":function(){define(["../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/Logger","../../../../../../symbols/cim/cimAnalyzer","../../../../../../symbols/cim/utils","./WGLMeshTemplate"],function(m,p,D,B,u){const t=p.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate");return function(h){function l(e){var b=h.call(this)||this;b._ongoingMaterialRequestMap=new Map;
b._materialCache=new Map;b._dynamicPropertyMap=new Map;b._cimLayer=e;return b}m._inheritsLoose(l,h);l.prototype.analyze=function(e,b,d,a,c){if(c&&0===c.length)return null;const f=c&&0<c.length,g=b.readLegacyFeature();b=b.getObjectId();const n=this._materialCache;var k=this._cimLayer.materialHash;if(!k)return t.error("A Dynamic mesh template must have a material hash value or function!"),Promise.reject(null);const x="function"===typeof k?k(g,d,a,b):k;k=n.get(x);if(null!=k)return Promise.resolve(k);
if(k=this._ongoingMaterialRequestMap.get(x))return k;k=this._cimLayer;const r=D.analyzeCIMResource(k.cim,this._cimLayer.materialOverrides);r.mosaicHash=x;const {type:v,url:q}=k;b={cim:r,type:v,mosaicHash:x,url:q,size:null,dashTemplate:null,text:null,fontName:null,objectId:b,animatedSymbolProperties:null};switch(v){case "marker":b.size=B.evaluateValueOrFunction(k.size,g,d,a);b.animatedSymbolProperties=B.evaluateValueOrFunction(k.animatedSymbolProperties,g,d,a);break;case "line":b.dashTemplate=k.dashTemplate;
break;case "text":b.text=B.evaluateValueOrFunction(k.text,g,d,a),b.fontName=B.evaluateValueOrFunction(k.fontName,g,d,a)}e=e.getMosaicItem(b,c).then(y=>{f||(this._ongoingMaterialRequestMap.delete(x),n.set(x,y));return y}).catch(y=>{this._ongoingMaterialRequestMap.delete(x);t.error(".analyze()",y.message);return null});f||this._ongoingMaterialRequestMap.set(x,e);return e};return l}(u)})},"esri/symbols/cim/cimAnalyzer":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../Color ../../core/fontUtils ../../core/lang ../../core/Logger ../../core/maybe ../../core/screenUtils ../../core/string ../../support/arcadeOnDemand ./CIMSymbolHelper ./enums ./quantizeTime ./SDFHelper ./utils ./effects/CIMEffectHelper ../../views/2d/arcade/callExpressionWithFeature ../../views/2d/engine/webgl/definitions ../../views/2d/engine/webgl/grouping".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d,a,c,f,g,n,k,x,r){function v(I){switch(I){case "Butt":return a.CapType.BUTT;case "Square":return a.CapType.SQUARE;default:return a.CapType.ROUND}}function q(I){switch(I){case "Bevel":return a.JoinType.BEVEL;case "Miter":return a.JoinType.MITER;default:return a.JoinType.ROUND}}function y(I,O,R,V){let W;I[O]?W=I[O]:(W={},I[O]=W);W[R]=V}function A(I){return(I=I.markerPlacement)&&I.angleToLine?a.Alignment.MAP:a.Alignment.SCREEN}function w(){w=p._asyncToGenerator(function*(I,
O,R,V,W){V=V??[];if(!I)return V;let da;const ea={};if("CIMSymbolReference"===I.type){if(da=I.symbol,I=I.primitiveOverrides){var fa=[];for(const ia of I){var ha=ia.valueExpressionInfo;ha&&O?(ha=b.createRendererExpression(ha.expression,O.spatialReference,O.fields).then(la=>{h.isNone(la)||y(ea,ia.primitiveName,ia.propertyName,la)}),fa.push(ha)):null!=ia.value&&y(ea,ia.primitiveName,ia.propertyName,ia.value)}0<fa.length&&(yield Promise.all(fa))}}else return aa.error("Expect cim type to be 'CIMSymbolReference'"),
V;fa=[];d.CIMSymbolHelper.fetchResources(da,R,fa);0<fa.length&&(yield Promise.all(fa));switch(da?.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":z(da,I,ea,O,V,R,!!W)}return V});return w.apply(this,arguments)}function z(I,O,R,V,W,da,ea){if(I){var fa=I.symbolLayers;if(fa){var ha=I.effects,ia=a.Alignment.SCREEN,la=d.CIMSymbolHelper.getSize(I)??0;"CIMPointSymbol"===I.type&&"Map"===I.angleAlignment&&(ia=a.Alignment.MAP);for(var ka=fa.length;ka--;){var ja=fa[ka];if(!ja||!1===ja.enable)continue;
let za;ha&&ha.length&&(za=[...ha]);var ma=ja.effects;ma&&ma.length&&(ha?za.push(...ma):za=[...ma]);ma=[];d.OverrideHelper.findEffectOverrides(za,O,ma);ma=0<ma.length?N(za,ma,R,V):za;var na=[];d.OverrideHelper.findApplicableOverrides(ja,O,na);switch(ja.type){case "CIMSolidFill":C(ja,ma,R,na,V,W);break;case "CIMPictureFill":E(ja,ma,R,na,V,da,W);break;case "CIMHatchFill":F(ja,ma,R,na,V,W);break;case "CIMGradientFill":var pa=R,oa=V,qa=W;const [Ja,Qa]=ba(na,ja.primitiveName,ma,null,null);var ta=e.numericHash(JSON.stringify(ja)+
Qa).toString();qa.push({type:"fill",templateHash:ta,materialHash:Ja?Y(ta,pa,na,oa):ta,cim:ja,materialOverrides:null,colorLocked:!!ja.colorLocked,effects:ma,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,applyRandomOffset:!1,sampleAlphaOnly:!1});break;case "CIMSolidStroke":G(ja,ma,R,na,V,W,"CIMPolygonSymbol"===I.type,la);break;case "CIMPictureStroke":H(ja,ma,R,na,V,W,"CIMPolygonSymbol"===I.type,la);break;case "CIMGradientStroke":pa=R;oa=V;qa=W;ta="CIMPolygonSymbol"===I.type;
var ra=la,xa=ja.primitiveName,Fa=null!=ja.width?ja.width:4,ya=v(ja.capStyle),ua=q(ja.joinStyle),va=ja.miterLimit;const [Ca,Ba]=ba(na,xa,ma,null,null),wa=e.numericHash(JSON.stringify(ja)+Ba).toString();qa.push({type:"line",templateHash:wa,materialHash:Ca?Y(wa,pa,na,oa):wa,cim:ja,materialOverrides:null,isOutline:ta,colorLocked:!!ja.colorLocked,effects:ma,color:{r:128,g:128,b:128,a:1},width:P(xa,pa,"Width",oa,Fa),cap:P(xa,pa,"CapStyle",oa,ya),join:P(xa,pa,"JoinStyle",oa,ua),miterLimit:va&&P(xa,pa,"MiterLimit",
oa,va),referenceWidth:ra,zOrder:X(ja.name),dashTemplate:null,scaleDash:!1,sampleAlphaOnly:!1});break;case "CIMCharacterMarker":L(ja,ma,R,na,V,W);break;case "CIMPictureMarker":if(L(ja,ma,R,na,V,W))break;"CIMLineSymbol"===I.type&&(ia=A(ja));K(ja,ma,R,na,V,da,W,ia,la);break;case "CIMVectorMarker":if(L(ja,ma,R,na,V,W))break;"CIMLineSymbol"===I.type&&(ia=A(ja));pa=R;oa=V;qa=W;ta=da;ra=ia;xa=la;Fa=ea;if(ua=ja.markerGraphics){ya=0;ja.scaleSymbolsProportionally&&(va=ja.frame)&&(ya=va.ymax-va.ymin);va=S(ja.markerPlacement,
na,pa,oa);for(const Ha of ua)if(Ha&&(ua=Ha.symbol))switch(ua.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":U(ja,ma,va,null,Ha,na,pa,oa,qa,ta,ra,xa,ya,!!Fa);break;case "CIMTextSymbol":M(ja,ma,va,Ha,pa,na,oa,qa,ra,xa,ya)}}break;default:aa.error("Cannot analyze CIM layer",ja.type)}}}}}function C(I,O,R,V,W,da){const ea=I.primitiveName,fa=g.fromCIMColor(I.color),[ha,ia]=ba(V,ea,O,null,null),la=e.numericHash(JSON.stringify(I)+ia).toString();da.push({type:"fill",templateHash:la,
materialHash:ha?()=>la:la,cim:I,materialOverrides:null,colorLocked:!!I.colorLocked,color:P(ea,R,"Color",W,fa,ca),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:O,applyRandomOffset:!1,sampleAlphaOnly:!0})}function E(I,O,R,V,W,da,ea){const fa=I.primitiveName,ha=g.getTintColor(I),[ia,la]=ba(V,fa,O,null,null);V=e.numericHash(JSON.stringify(I)+la).toString();const ka=e.numericHash(`${I.url}${JSON.stringify(I.colorSubstitutions)}`).toString();let ja=g.getValue(I.scaleX);if("width"in I&&"number"===
typeof I.width){const ma=I.width;let na=1;da=da.getResource(I.url);h.isSome(da)&&(na=da.width/da.height);ja/=I.height/ma*na}ea.push({type:"fill",templateHash:V,materialHash:ia?()=>ka:ka,cim:I,materialOverrides:null,colorLocked:!!I.colorLocked,effects:O,color:P(fa,R,"TintColor",W,ha,ca),height:P(fa,R,"Height",W,I.height),scaleX:P(fa,R,"ScaleX",W,ja),angle:P(fa,R,"Rotation",W,g.getValue(I.rotation)),offsetX:P(fa,R,"OffsetX",W,g.getValue(I.offsetX)),offsetY:P(fa,R,"OffsetY",W,g.getValue(I.offsetY)),
url:I.url,applyRandomOffset:!1,sampleAlphaOnly:!1})}function F(I,O,R,V,W,da){const ea=["Rotation","OffsetX","OffsetY"],fa=V.filter(pa=>pa.primitiveName!==I.primitiveName||!ea.includes(pa.propertyName)),ha=I.primitiveName;let [ia,la]=ba(V,ha,O,null,null);V=e.numericHash(JSON.stringify(I)+la).toString();const ka=e.numericHash(`${I.separation}${JSON.stringify(I.lineSymbol)}`).toString();let ja={r:255,g:255,b:255,a:1};var ma=!1;const na=I.lineSymbol?.symbolLayers?.find(pa=>"CIMSolidStroke"===pa.type&&
null!=R[pa.primitiveName]?.Color);na&&(ja=g.fromCIMColor(na.color),ja=P(na.primitiveName,R,"Color",W,ja,ca),ma="function"===typeof ja,ia=ia||ma,ma=null!=na.color||ma);da.push({type:"fill",templateHash:V,materialHash:ia?Y(ka,R,fa,W):ka,cim:I,materialOverrides:fa,colorLocked:!!I.colorLocked,effects:O,color:ja,height:P(ha,R,"Separation",W,I.separation),scaleX:1,angle:P(ha,R,"Rotation",W,g.getValue(I.rotation)),offsetX:P(ha,R,"OffsetX",W,g.getValue(I.offsetX)),offsetY:P(ha,R,"OffsetY",W,g.getValue(I.offsetY)),
applyRandomOffset:!1,sampleAlphaOnly:!0,hasUnresolvedReplacementColor:!ma})}function G(I,O,R,V,W,da,ea,fa){const ha=I.primitiveName,ia=g.fromCIMColor(I.color),la=null!=I.width?I.width:4,ka=v(I.capStyle),ja=q(I.joinStyle),ma=I.miterLimit,[na,pa]=ba(V,ha,O,null,null),oa=e.numericHash(JSON.stringify(I)+pa).toString();let qa;if(O&&O instanceof Array&&0<O.length&&(V=O[O.length-1],"CIMGeometricEffectDashes"===V.type&&"NoConstraint"===V.lineDashEnding&&null===V.offsetAlongLine)){O=[...O];var ta=O.pop();
qa=ta.dashTemplate;ta=ta.scaleDash}da.push({type:"line",templateHash:oa,materialHash:na?()=>oa:oa,cim:I,materialOverrides:null,isOutline:ea,colorLocked:!!I.colorLocked,effects:O,color:P(ha,R,"Color",W,ia,ca),width:P(ha,R,"Width",W,la),cap:P(ha,R,"CapStyle",W,ka),join:P(ha,R,"JoinStyle",W,ja),miterLimit:ma&&P(ha,R,"MiterLimit",W,ma),referenceWidth:fa,zOrder:X(I.name),dashTemplate:qa,scaleDash:ta,sampleAlphaOnly:!0})}function H(I,O,R,V,W,da,ea,fa){const ha=e.numericHash(`${I.url}${JSON.stringify(I.colorSubstitutions)}`).toString(),
ia=I.primitiveName,la=g.getTintColor(I),ka=null!=I.width?I.width:4,ja=v(I.capStyle),ma=q(I.joinStyle),na=I.miterLimit,[pa,oa]=ba(V,ia,O,null,null);V=e.numericHash(JSON.stringify(I)+oa).toString();da.push({type:"line",templateHash:V,materialHash:pa?()=>ha:ha,cim:I,materialOverrides:null,isOutline:ea,colorLocked:!!I.colorLocked,effects:O,color:P(ia,R,"TintColor",W,la,ca),width:P(ia,R,"Width",W,ka),cap:P(ia,R,"CapStyle",W,ja),join:P(ia,R,"JoinStyle",W,ma),miterLimit:na&&P(ia,R,"MiterLimit",W,na),referenceWidth:fa,
zOrder:X(I.name),dashTemplate:null,scaleDash:!1,url:I.url,sampleAlphaOnly:!1})}function L(I,O,R,V,W,da){const {markerPlacement:ea,type:fa}=I;if(!ea||"CIMMarkerPlacementInsidePolygon"!==ea.type)return!1;if("CIMVectorMarker"===fa||"CIMPictureMarker"===fa){var ha=I.primitiveName;if(ha&&([ha]=ba(V,ha,O,null,null),ha))return!1;if(ha=ea.primitiveName)if([ha]=ba(V,ha,O,null,null),ha)return!1;if("CIMVectorMarker"===fa){if({markerGraphics:ha}=I,ha)for(var ia of ha)if({symbol:ha}=ia,"CIMPolygonSymbol"===ha?.type&&
ha.symbolLayers){({symbolLayers:ha}=ha);for(var la of ha)if("CIMSolidStroke"===la.type)return!1}}else if({animatedSymbolProperties:ia}=I,ia)return!1}ha=Math.abs(ea.stepX);var ka=Math.abs(ea.stepY);if(0===ha||0===ka)return!0;const ja=["Rotation","OffsetX","OffsetY"];ia=V.filter(qa=>qa.primitiveName!==I.primitiveName||!ja.includes(qa.propertyName));la="url"in I&&"string"===typeof I.url?I.url:void 0;const [ma,na]=ba(V,ea.primitiveName,O,null,null);V=e.numericHash(JSON.stringify(I)+na).toString();let pa=
null;if("Random"===ea.gridType){var oa=l.px2pt(x.RANDOM_INSIDE_POLYGON_TEXTURE_SIZE);const qa=Math.max(Math.floor(oa/ha),1),ta=Math.max(Math.floor(oa/ka),1);oa=ka*ta;pa=ra=>ra?ra*ta:0;ha=qa*ha/oa}else ea.shiftOddRows?(oa=2*ka,pa=qa=>qa?2*qa:0,ha=ha/ka*.5):(oa=ka,pa=null,ha/=ka);ka=g.getTintColor(I);da.push({type:"fill",templateHash:V,materialHash:ma?Y(V,R,ia,W):V,cim:I,materialOverrides:ia,colorLocked:!!I.colorLocked,effects:O,color:P(ea.primitiveName,R,"TintColor",W,ka,ca),height:P(ea.primitiveName,
R,"StepY",W,oa,pa),scaleX:ha,angle:P(ea.primitiveName,R,"GridAngle",W,ea.gridAngle),offsetX:P(ea.primitiveName,R,"OffsetX",W,g.getValue(ea.offsetX)),offsetY:P(ea.primitiveName,R,"OffsetY",W,g.getValue(ea.offsetY)),url:la,applyRandomOffset:"Random"===ea.gridType,sampleAlphaOnly:!la,hasUnresolvedReplacementColor:!0});return!0}function K(I,O,R,V,W,da,ea,fa,ha){function ia(ua,va){return h.isSome(ra)?g.evaluateValueOrFunction(ra,ua,va):null}const la=I.primitiveName,ka=g.getValue(I.size);let ja=g.getValue(I.scaleX,
1);const ma=g.getValue(I.rotation),na=g.getValue(I.offsetX),pa=g.getValue(I.offsetY),oa=g.getTintColor(I),qa=e.numericHash(`${I.url}${JSON.stringify(I.colorSubstitutions)}${JSON.stringify(I.animatedSymbolProperties)}`).toString(),ta=S(I.markerPlacement,V,R,W),ra=Q(I.animatedSymbolProperties,V,R,W),[xa,Fa]=ba(V,la,O,ta,ra);V=e.numericHash(JSON.stringify(I)+Fa).toString();const ya=I.anchorPoint??{x:0,y:0};if("width"in I&&"number"===typeof I.width){const ua=I.width;let va=1;da=da.getResource(I.url);
h.isSome(da)&&(va=da.width/da.height);ja/=ka/ua*va}ea.push({type:"marker",templateHash:V,materialHash:I.animatedSymbolProperties&&!0===I.animatedSymbolProperties.randomizeStartTime?(ua,va,za,Ja)=>{za=r.getMaterialGroup(Ja??0);ua=ia(ua,va);return qa+`-MATERIALGROUP(${za})`+`-ASP(${JSON.stringify(ua)})`}:xa?(ua,va)=>{ua=ia(ua,va);return qa+`-ASP(${JSON.stringify(ua)})`}:qa,cim:I,materialOverrides:null,colorLocked:!!I.colorLocked,effects:O,scaleSymbolsProportionally:!1,alignment:fa,size:P(la,R,"Size",
W,ka),scaleX:P(la,R,"ScaleX",W,ja),rotation:P(la,R,"Rotation",W,ma),offsetX:P(la,R,"OffsetX",W,na),offsetY:P(la,R,"OffsetY",W,pa),color:P(la,R,"TintColor",W,oa,ca),anchorPoint:{x:ya.x,y:-ya.y},isAbsoluteAnchorPoint:"Relative"!==I.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:!!I.rotateClockwise,referenceSize:ha,sizeRatio:1,markerPlacement:ta,url:I.url,animatedSymbolProperties:ra})}function M(I,O,R,V,W,da,ea,fa,ha,ia,la){d.OverrideHelper.findApplicableOverrides(V,
da,[]);var ka=V.geometry;if("x"in ka&&"y"in ka){var ja=V.symbol,ma=g.fromCIMFontDecoration(ja),na=g.fromCIMFontStyle(ja.fontStyleName),pa=B.getFontFamily(ja.fontFamilyName);ja.font={family:pa,decoration:ma,...na};var oa=I.frame,qa=ka.x-.5*(oa.xmin+oa.xmax),ta=ka.y-.5*(oa.ymin+oa.ymax),ra=I.size/la;la=I.primitiveName;ka=g.getValue(ja.height)*ra;oa=g.getValue(ja.angle);qa=g.getValue(I.offsetX)+(g.getValue(ja.offsetX)+qa)*ra;ta=g.getValue(I.offsetY)+(g.getValue(ja.offsetY)+ta)*ra;var xa=g.fromCIMColor(g.getFillColor(ja)),
Fa=g.fromCIMColor(g.getStrokeColor(ja)),ya=g.getStrokeWidth(ja)??0;ya||(Fa=g.fromCIMColor(g.getFillColor(ja.haloSymbol)),ja.haloSize&&(ya=ja.haloSize*ra));var ua=ra=null,va=0;if(ja.callout&&"CIMBackgroundCallout"===ja.callout.type){var za=ja.callout;if(za.backgroundSymbol&&(za=za.backgroundSymbol.symbolLayers))for(const wa of za)"CIMSolidFill"===wa.type?ra=g.fromCIMColor(wa.color):"CIMSolidStroke"===wa.type&&(ua=g.fromCIMColor(wa.color),va=g.getValue(wa.width))}var [Ja,Qa]=ba(da,la,O,R,null);da=JSON.stringify(I.effects)+
Number(I.colorLocked).toString()+JSON.stringify(I.anchorPoint)+I.anchorPointUnits+JSON.stringify(I.markerPlacement)+I.size.toString();da=e.numericHash(JSON.stringify(V)+da+Qa).toString();var Ca=P(V.primitiveName,W,"TextString",ea,V.textString??"",g.adjustTextCase,ja.textCase);if(null!=Ca){({fontStyleName:V}=ja);var Ba=pa+(V?"-"+V.toLowerCase():"-regular");"string"===typeof Ca&&Ca.includes("[")&&ja.fieldMap&&(Ca=g.createLabelOverrideFunction(ja.fieldMap,Ca,ja.textCase));fa.push({type:"text",templateHash:da,
materialHash:Ja||"function"===typeof Ca||Ca.match(/\[(.*?)\]/)?(wa,Ha,Ga)=>Ba+"-"+g.evaluateValueOrFunction(Ca,wa,Ha,Ga):Ba+"-"+e.numericHash(Ca),cim:ja,materialOverrides:null,colorLocked:!!I.colorLocked,effects:O,alignment:ha,anchorPoint:{x:I.anchorPoint?I.anchorPoint.x:0,y:I.anchorPoint?I.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==I.anchorPointUnits,fontName:Ba,decoration:ma,weight:P(la,W,"Weight",ea,na.weight),style:P(la,W,"Size",ea,na.style),size:P(la,W,"Size",ea,ka),angle:P(la,W,"Rotation",
ea,oa),offsetX:P(la,W,"OffsetX",ea,qa),offsetY:P(la,W,"OffsetY",ea,ta),horizontalAlignment:g.fromCIMHorizontalAlignment(ja.horizontalAlignment),verticalAlignment:g.fromCIMVerticalAlignment(ja.verticalAlignment),text:Ca,color:xa,outlineColor:Fa,outlineSize:ya,backgroundColor:ra,borderLineColor:ua,borderLineWidth:va,referenceSize:ia,sizeRatio:1,markerPlacement:R})}}}function U(I,O,R,V,W,da,ea,fa,ha,ia,la,ka,ja,ma){var na=W.symbol;const pa=na.symbolLayers;if(pa)if(ma)Z(I,O,R,V,W,ea,da,fa,ha,ia,la,ka,
ja);else if(ma=pa.length,pa&&2===pa.length&&pa[0].enable&&pa[1].enable&&"CIMSolidStroke"===pa[0].type&&"CIMSolidFill"===pa[1].type&&!pa[0].effects&&!pa[1].effects)T(I,O,R,V,W,pa,da,ea,fa,ha,la,ka,ja);else if(na=n.CIMEffectHelper.applyEffects(na.effects,W.geometry,ia.geometryEngine))for(;ma--;){var oa=pa[ma];if(oa&&!1!==oa.enable)switch(oa.type){case "CIMSolidFill":case "CIMSolidStroke":var qa=n.CIMEffectHelper.applyEffects(oa.effects,na,ia.geometryEngine),ta=f.getExtent(qa);if(!ta)continue;const Fa=
"Relative"!==I.anchorPointUnits,[ya,ua,va]=f.getSDFMetrics(ta,I.frame,I.size,I.anchorPoint,Fa);var ra="CIMSolidFill"===oa.type;qa={type:"sdf",geom:qa,asFill:ra};var xa=I.primitiveName;ta=g.getValue(I.size)??10;const za=g.getValue(I.rotation),Ja=g.getValue(I.offsetX),Qa=g.getValue(I.offsetY),Ca=oa.path,Ba=oa.primitiveName,wa=ra?g.fromCIMColor(g.getFillColor(oa)):g.fromCIMColor(g.getStrokeColor(oa)),Ha=ra?{r:0,g:0,b:0,a:0}:g.fromCIMColor(g.getStrokeColor(oa)),Ga=g.getStrokeWidth(oa)??0;if(!ra&&!Ga)break;
ra=!1;let Da="";for(const Ma of da)if(Ma.primitiveName===Ba||Ma.primitiveName===xa)void 0!==Ma.value?Da+=`-${Ma.primitiveName}-${Ma.propertyName}-${JSON.stringify(Ma.value)}`:Ma.valueExpressionInfo&&(ra=!0);if(h.isSome(O)&&"function"===typeof O||h.isSome(R)&&"function"===typeof R)ra=!0;xa=JSON.stringify({...I,markerGraphics:null});const Ka=e.numericHash(JSON.stringify(qa)+Ca).toString();oa={type:"marker",templateHash:e.numericHash(JSON.stringify(W)+JSON.stringify(oa)+xa+Da).toString(),materialHash:ra?
()=>Ka:Ka,cim:qa,materialOverrides:null,colorLocked:!!I.colorLocked,effects:O,scaleSymbolsProportionally:!!I.scaleSymbolsProportionally,alignment:la,anchorPoint:{x:ua,y:va},isAbsoluteAnchorPoint:Fa,size:P(I.primitiveName,ea,"Size",fa,ta),rotation:P(I.primitiveName,ea,"Rotation",fa,za),offsetX:P(I.primitiveName,ea,"OffsetX",fa,Ja),offsetY:P(I.primitiveName,ea,"OffsetY",fa,Qa),scaleX:1,frameHeight:ja,rotateClockwise:!!I.rotateClockwise,referenceSize:ka,sizeRatio:ya,color:P(Ba,ea,"Color",fa,wa,ca),outlineColor:P(Ba,
ea,"Color",fa,Ha,ca),outlineWidth:P(Ba,ea,"Width",fa,Ga),markerPlacement:R,animatedSymbolProperties:V,path:Ca};ha.push(oa);break;default:Z(I,O,R,V,W,ea,da,fa,ha,ia,la,ka,ja)}}}function T(I,O,R,V,W,da,ea,fa,ha,ia,la,ka,ja){var ma=W.geometry;const na=da[0];da=da[1];var pa=f.getExtent(ma);if(pa){var oa="Relative"!==I.anchorPointUnits,[qa,ta,ra]=f.getSDFMetrics(pa,I.frame,I.size,I.anchorPoint,oa);ma={type:"sdf",geom:ma,asFill:!0};var xa=I.primitiveName;pa=g.getValue(I.size);var Fa=g.getValue(I.rotation),
ya=g.getValue(I.offsetX),ua=g.getValue(I.offsetY),va=da.path,za=da.primitiveName,Ja=na.primitiveName,Qa=g.fromCIMColor(g.getFillColor(da)),Ca=g.fromCIMColor(g.getStrokeColor(na)),Ba=g.getStrokeWidth(na)??0,wa=!1,Ha="";for(const Da of ea)if(Da.primitiveName===za||Da.primitiveName===Ja||Da.primitiveName===xa)void 0!==Da.value?Ha+=`-${Da.primitiveName}-${Da.propertyName}-${JSON.stringify(Da.value)}`:Da.valueExpressionInfo&&(wa=!0);h.isSome(R)&&"function"===typeof R&&(wa=!0);ea=JSON.stringify({...I,markerGraphics:null});
var Ga=e.numericHash(JSON.stringify(ma)+va).toString();I={type:"marker",templateHash:e.numericHash(JSON.stringify(W)+JSON.stringify(da)+JSON.stringify(na)+ea+Ha).toString(),materialHash:wa?()=>Ga:Ga,cim:ma,materialOverrides:null,colorLocked:!!I.colorLocked,effects:O,scaleSymbolsProportionally:!!I.scaleSymbolsProportionally,alignment:la,anchorPoint:{x:ta,y:ra},isAbsoluteAnchorPoint:oa,size:P(I.primitiveName,fa,"Size",ha,pa),rotation:P(I.primitiveName,fa,"Rotation",ha,Fa),offsetX:P(I.primitiveName,
fa,"OffsetX",ha,ya),offsetY:P(I.primitiveName,fa,"OffsetY",ha,ua),scaleX:1,frameHeight:ja,rotateClockwise:!!I.rotateClockwise,referenceSize:ka,sizeRatio:qa,color:P(za,fa,"Color",ha,Qa,ca),outlineColor:P(Ja,fa,"Color",ha,Ca,ca),outlineWidth:P(Ja,fa,"Width",ha,Ba),markerPlacement:R,path:va,animatedSymbolProperties:V};ia.push(I)}}function Z(I,O,R,V,W,da,ea,fa,ha,ia,la,ka,ja){W={type:I.type,enable:!0,name:I.name,colorLocked:I.colorLocked,primitiveName:I.primitiveName,anchorPoint:I.anchorPoint,anchorPointUnits:I.anchorPointUnits,
offsetX:0,offsetY:0,rotateClockwise:I.rotateClockwise,rotation:0,size:I.size,billboardMode3D:I.billboardMode3D,depth3D:I.depth3D,frame:I.frame,markerGraphics:[W],scaleSymbolsProportionally:I.scaleSymbolsProportionally,respectFrame:I.respectFrame,clippingPath:I.clippingPath};const ma=["Rotation","OffsetX","OffsetY"],na=ea.filter(ya=>ya.primitiveName!==I.primitiveName||!ma.includes(ya.propertyName));var pa="";for(var oa of ea)void 0!==oa.value&&(pa+=`-${oa.primitiveName}-${oa.propertyName}-${JSON.stringify(oa.value)}`);
const [qa,ta,ra]=d.CIMSymbolHelper.getTextureAnchor(W,ia);ea=I.primitiveName;ia=g.getValue(I.rotation);oa=g.getValue(I.offsetX);const xa=g.getValue(I.offsetY);pa=e.numericHash(JSON.stringify(W)+pa).toString();const Fa=0<na.length||h.isSome(O)&&"function"===typeof O;O={type:"marker",templateHash:pa,materialHash:Fa?Y(pa,da,na,fa):pa,cim:W,materialOverrides:na,colorLocked:!!I.colorLocked,effects:O,scaleSymbolsProportionally:!!I.scaleSymbolsProportionally,alignment:la,anchorPoint:{x:qa,y:ta},isAbsoluteAnchorPoint:!1,
size:g.getValue(I.size),rotation:P(ea,da,"Rotation",fa,ia),offsetX:P(ea,da,"OffsetX",fa,oa),offsetY:P(ea,da,"OffsetY",fa,xa),color:{r:255,g:255,b:255,a:1},outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:ja,rotateClockwise:!!I.rotateClockwise,referenceSize:ka,sizeRatio:ra/l.pt2px(I.size),markerPlacement:R,animatedSymbolProperties:V,avoidSDFRasterization:!0};ha.push(O)}function X(I){return I&&0===I.indexOf("Level_")&&(I=parseInt(I.substr(6),10),!isNaN(I))?I:0}function ca(I){if(!I||
0===I.length)return null;I=(new D(I)).toRgba();return{r:I[0],g:I[1],b:I[2],a:I[3]}}function P(I,O,R,V,W,da,ea){if(null==I)return W;if(I=O[I]){const fa=I[R];if("string"===typeof fa||"number"===typeof fa||fa instanceof Array)return da?da.call(null,fa,ea):fa;if(null!=fa&&fa instanceof b.ArcadeExpression&&V?.geometryType)return(ha,ia,la)=>{ha=k(fa,ha,{$view:la},V.geometryType,ia);null!==ha&&da&&(ha=da.call(null,ha,ea));return null!==ha?ha:W}}return W}function J(I){return I?I.charAt(0).toLowerCase()+I.substr(1):
I}function N(I,O,R,V){for(const W of O)if(W.valueExpressionInfo&&V?.geometryType){const da=R[W.primitiveName]&&R[W.primitiveName][W.propertyName];da instanceof b.ArcadeExpression&&(W.fn=(ea,fa,ha)=>k(da,ea,{$view:ha},V.geometryType,fa))}return(W,da,ea)=>{for(var fa of O)fa.fn&&(fa.value=fa.fn(W,da,ea));W=[];for(let ha of I){if(da=ha?.primitiveName){ea=!1;for(const ia of O)ia.primitiveName===da&&(fa=J(ia.propertyName),null!=ia.value&&ia.value!==ha[fa]&&(ea||(ha=u.clone(ha),ea=!0),ha[fa]=ia.value))}W.push(ha)}return W}}
function S(I,O,R,V){const W=[];d.OverrideHelper.findApplicableOverrides(I,O,W);if(null==I||0===W.length)return I;for(const da of W)if(da.valueExpressionInfo&&V?.geometryType){const ea=R[da.primitiveName]&&R[da.primitiveName][da.propertyName];ea instanceof b.ArcadeExpression&&(da.fn=(fa,ha,ia)=>k(ea,fa,{$view:ia},V.geometryType,ha))}return(da,ea,fa)=>{for(const ha of W)ha.fn&&(ha.value=ha.fn(da,ea,fa));da=u.clone(I);ea=I.primitiveName;for(const ha of W)ha.primitiveName===ea&&(fa=J(ha.propertyName),
null!=ha.value&&ha.value!==da[fa]&&(da[fa]=ha.value));return da}}function Q(I,O,R,V){const W=[];d.OverrideHelper.findApplicableOverrides(I,O,W);if(null==I||0===W.length)return I;for(const da of W)if(da.valueExpressionInfo&&V?.geometryType){const ea=R[da.primitiveName]&&R[da.primitiveName][da.propertyName];ea instanceof b.ArcadeExpression&&(da.fn=(fa,ha,ia)=>k(ea,fa,{$view:ia},V.geometryType,ha))}return(da,ea,fa)=>{for(var ha of W)ha.fn&&(ha.value=ha.fn(da,ea,fa));da=u.clone(I);ea=I.primitiveName;
for(const ia of W)ia.primitiveName===ea&&(fa=J(ia.propertyName),null!=ia.value&&(ha=c.quantizeIfNeeded(ia.value,ia.propertyName),ha!==da[fa]&&(da[fa]=ha)));return da}}function Y(I,O,R,V){for(const W of R)if(W.valueExpressionInfo&&V?.geometryType){const da=O[W.primitiveName]&&O[W.primitiveName][W.propertyName];da instanceof b.ArcadeExpression&&(W.fn=(ea,fa,ha)=>k(da,ea,{$view:ha},V.geometryType,fa))}return(W,da,ea)=>{for(const fa of R)fa.fn&&(fa.value=fa.fn(W,da,ea));return e.numericHash(I+d.OverrideHelper.buildOverrideKey(R)).toString()}}
function ba(I,O,R,V,W){let da=!1,ea="";for(const fa of I)fa.primitiveName===O&&(void 0!==fa.value?ea+=`-${fa.primitiveName}-${fa.propertyName}-${JSON.stringify(fa.value)}`:fa.valueExpressionInfo&&(da=!0));h.isSome(R)&&"function"===typeof R&&(da=!0);h.isSome(V)&&"function"===typeof V&&(da=!0);h.isSome(W)&&"function"===typeof W&&(da=!0);return[da,ea]}const aa=t.getLogger("esri.symbols.cim.cimAnalyzer");m.analyzeCIMResource=function(I,O){if(!O||0===O.length)return I;I=u.clone(I);d.OverrideHelper.applyOverrides(I,
O);return I};m.analyzeCIMSymbol=function(I,O,R,V,W){return w.apply(this,arguments)};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/quantizeTime":function(){define(["exports"],function(m){const p=new Set(["StartTimeOffset","Duration","RepeatDelay"]);m.quantizeIfNeeded=function(D,B){return p.has(B)?.05*Math.max(Math.round(D/.05),1):D};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d){return function(a){function c(f,g,n){var k=a.call(this,f)||this;k._minMaxZoom=t.i1616to32(Math.round(g*u.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(n*u.MIN_MAX_ZOOM_PRECISION_FACTOR));k._cimLineLayer=f;let x=0;l.isFunction(f.width)||(x=.5*D.pt2px(f.width));k._dynamicPropertyMap.set("_halfWidth",(q,y,A)=>l.isFunction(f.width)?.5*D.pt2px(f.width(q,y,A)):x);l.isFunction(f.cap)?k._dynamicPropertyMap.set("_capType",f.cap):k._capType=f.cap;l.isFunction(f.join)?k._dynamicPropertyMap.set("_joinType",
f.join):k._joinType=f.join;const r=f.color;l.isFunction(r)?k._dynamicPropertyMap.set("_fillColor",(q,y,A)=>B.premultiplyAlphaRGBA(r(q,y,A))):k._fillColor=r&&B.premultiplyAlphaRGBA(r)||0;const v=f.miterLimit;l.isFunction(v)?k._dynamicPropertyMap.set("_miterLimitCosine",(q,y,A)=>l.getLimitCosine(v(q,y,A))):k._miterLimitCosine=l.getLimitCosine(v);p.isSome(f.effects)&&(g=f.effects,l.isFunction(g)?k._dynamicPropertyMap.set("_effects",g):k._effects=g);k._scaleFactor=f.scaleFactor||1;k._isDashed=null!=f.dashTemplate;
k.tessellationProperties._bitset=(f.colorLocked?u.BITSET_GENERIC_LOCK_COLOR:0)|(f.scaleDash?u.BITSET_LINE_SCALE_DASH:0)|(f.sampleAlphaOnly?u.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0);k._materialKey=f.materialKey;k._initializeTessellator(!0);return k}m._inheritsLoose(c,a);c.fromCIMLine=function(f,g){const [n,k]=l.getMinMaxZoom(f.scaleInfo,g);return new c(f,n,k)};c.prototype.bindFeature=function(f,g,n){const k=f.readLegacyFeature();this._dynamicPropertyMap.forEach((r,v)=>{this[v]=r(k,g,n)});this._halfWidth*=
this._scaleFactor;f=this._materialCache;var x=this._cimLineLayer.materialHash;x=x(k,g,n);x=f.get(x);f=null;x&&d.ok(x.spriteMosaicItem)&&(f=x.spriteMosaicItem);if(f){this._hasPattern=!0;const {rect:r,width:v,height:q}=f;x=r.x+u.SPRITE_PADDING;const y=r.y+u.SPRITE_PADDING,A=x+v,w=y+q;this.tessellationProperties._tl=t.i1616to32(x,y);this.tessellationProperties._br=t.i1616to32(A,w)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=
this._fillColor;this.tessellationProperties._halfWidth=this._halfWidth;this.tessellationProperties.offset=0;this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;x=h.LineMaterialKey.load(this._materialKey);f&&(x.sdf=f.sdf,x.pattern=!0,x.textureBinding=f.textureBinding);this._materialKey=x.data};return c}(e(b))})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d,a,c,f,g,n){const k=h.create(),x=t.create();return function(r){function v(q,y,A){var w=r.call(this,q)||this;w._cimMarkerLayer=q;w._minMaxZoom=d.i1616to32(Math.round(y*b.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(A*b.MIN_MAX_ZOOM_PRECISION_FACTOR));const z=q.color;c.isFunction(z)?w._dynamicPropertyMap.set("_fillColor",(L,K,M)=>e.premultiplyAlphaRGBA(z(L,K,M))):w._fillColor=e.premultiplyAlphaRGBA(z);const C=q.outlineColor;c.isFunction(C)?w._dynamicPropertyMap.set("_outlineColor",
(L,K,M)=>e.premultiplyAlphaRGBA(C(L,K,M))):w._outlineColor=e.premultiplyAlphaRGBA(C);const E=q.size;c.isFunction(E)?w._dynamicPropertyMap.set("_size",(L,K,M)=>u.pt2px(E(L,K,M))):w._size=u.pt2px(E)||0;y=q.scaleX;c.isFunction(y)?w._dynamicPropertyMap.set("_scaleX",y):w._scaleX=y;const F=q.offsetX;c.isFunction(F)?w._dynamicPropertyMap.set("xOffset",(L,K,M)=>u.pt2px(F(L,K,M))):w.xOffset=u.pt2px(F)||0;const G=q.offsetY;c.isFunction(G)?w._dynamicPropertyMap.set("yOffset",(L,K,M)=>u.pt2px(G(L,K,M))):w.yOffset=
u.pt2px(G)||0;const H=q.outlineWidth;c.isFunction(H)?w._dynamicPropertyMap.set("_outlineWidth",(L,K,M)=>u.pt2px(H(L,K,M))):w._outlineWidth=u.pt2px(H)||0;y=q.rotation;c.isFunction(y)?w._dynamicPropertyMap.set("_angle",y):w._angle=y||0;B.isSome(q.effects)&&(y=q.effects,c.isFunction(y)?w._dynamicPropertyMap.set("_effects",y):w._effects=y);B.isSome(q.markerPlacement)&&(y=q.markerPlacement,c.isFunction(y)?w._dynamicPropertyMap.set("_markerPlacement",y):w._markerPlacement=y);w._scaleFactor=B.unwrapOr(q.scaleFactor,
1);w._bitSet=(q.alignment===l.Alignment.MAP?1:0)|(q.colorLocked?1:0)<<1|(q.scaleSymbolsProportionally?1:0)<<3;w._materialKey=q.materialKey;return w}m._inheritsLoose(v,r);v.fromCIMMarker=function(q,y){const [A,w]=c.getMinMaxZoom(q.scaleInfo,y);return new v(q,A,w)};v.prototype.bindFeature=function(q,y,A){const w=q.readLegacyFeature();q=q.getObjectId();this._dynamicPropertyMap.forEach((X,ca)=>{this[ca]=X(w,y,A)});var z=this._cimMarkerLayer.materialHash;q="function"===typeof z?z(w,y,A,q):z;if((q=this._materialCache.get(q))&&
n.ok(q.spriteMosaicItem)&&q.spriteMosaicItem){q=q.spriteMosaicItem;z=this._cimMarkerLayer.sizeRatio;var C=q.width/q.height*this._scaleX,E=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle,F=this._size,G=F*C,H=this.xOffset,L=this.yOffset;this.xOffset*=this._scaleFactor;this.yOffset*=this._scaleFactor;var K=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/u.pt2px(this._cimMarkerLayer.frameHeight):1;K*=this._outlineWidth;var M=u.pt2px(this._cimMarkerLayer.referenceSize),
U=0,T=0,Z=this._cimMarkerLayer.anchorPoint;Z&&(this._cimMarkerLayer.isAbsoluteAnchorPoint?this._size&&(U=u.pt2px(Z.x)/(this._size*C),T=u.pt2px(Z.y)/this._size):(U=Z.x,T=Z.y));this._anchorX=U;this._anchorY=T;this._sizeOutlineWidth=d.i8888to32(Math.round(Math.min(Math.sqrt(128*G),255)),Math.round(Math.min(Math.sqrt(128*F),255)),Math.round(Math.min(Math.sqrt(128*K),255)),Math.round(Math.min(Math.sqrt(128*M),255)));this.angle=E;this._bitestAndDistRatio=d.i1616to32(this._bitSet,Math.round(64*z));C=q.rect.x+
b.SPRITE_PADDING;E=q.rect.y+b.SPRITE_PADDING;K=C+q.width;M=E+q.height;this._texUpperLeft=d.i1616to32(C,E);this._texUpperRight=d.i1616to32(K,E);this._texBottomLeft=d.i1616to32(C,M);this._texBottomRight=d.i1616to32(K,M);C=a.MarkerMaterialKey.load(this._materialKey);C.sdf=q.sdf;C.pattern=!0;C.textureBinding=q.textureBinding;this._materialKey=C.data;G=G*z*this._scaleFactor;F=F*z*this._scaleFactor;G*=q.rect.width/q.width;F*=q.rect.height/q.height;this._computedWidth=G;this._computedHeight=F;this._applyTransformation(x,
k);this.xOffset=H;this.yOffset=L}else D.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate").error(new p("mapview-cim","Encountered an error when binding feature"))};return v}(f(g))})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../alignmentUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLDynamicMeshTemplate ../../../../layers/features/textUtils".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d,a,c){return function(f){function g(k,x,r){var v=f.call(this,k)||this;v._horizontalAlignment="center";v._verticalAlignment="middle";v._textToGlyphs=new Map;v._minMaxZoom=l.i1616to32(Math.round(x*h.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(r*h.MIN_MAX_ZOOM_PRECISION_FACTOR));x=k.scaleFactor||1;v._cimTextLayer=k;const q=k.color;b.isFunction(q)?v._dynamicPropertyMap.set("_color",(C,E,F)=>t.premultiplyAlphaRGBA(q(C,E,F))):v._color=t.premultiplyAlphaRGBA(q);const y=k.outlineColor;
b.isFunction(y)?v._dynamicPropertyMap.set("_haloColor",(C,E,F)=>t.premultiplyAlphaRGBA(y(C,E,F))):v._haloColor=t.premultiplyAlphaRGBA(y);let A;b.isFunction(k.size)||(A=Math.min(Math.round(D.pt2px(k.size*k.sizeRatio)),127));v._dynamicPropertyMap.set("_size",(C,E,F)=>b.isFunction(k.size)?Math.min(Math.round(D.pt2px(k.size(C,E,F)*k.sizeRatio)),127):A);b.isFunction(k.outlineSize)?v._dynamicPropertyMap.set("_haloSize",(C,E,F)=>Math.min(Math.floor(5*D.pt2px(k.outlineSize(C,E,F)*k.sizeRatio)),127)):v._haloSize=
Math.min(Math.floor(5*D.pt2px(k.outlineSize*k.sizeRatio)),127);let w;b.isFunction(k.offsetX)||(w=Math.round(D.pt2px(k.offsetX*k.sizeRatio)));v._dynamicPropertyMap.set("_xOffset",(C,E,F)=>b.isFunction(k.offsetX)?Math.round(D.pt2px(k.offsetX(C,E,F)*k.sizeRatio)):w);let z;b.isFunction(k.offsetY)||(z=Math.round(D.pt2px(k.offsetY*k.sizeRatio)));v._dynamicPropertyMap.set("_yOffset",(C,E,F)=>b.isFunction(k.offsetY)?Math.round(D.pt2px(k.offsetY(C,E,F)*k.sizeRatio)):z);b.isFunction(k.angle)?v._dynamicPropertyMap.set("_angle",
k.angle):v._angle=k.angle;b.isFunction(k.horizontalAlignment)?v._dynamicPropertyMap.set("_horizontalAlignment",k.horizontalAlignment):v._horizontalAlignment=k.horizontalAlignment;b.isFunction(k.verticalAlignment)?v._dynamicPropertyMap.set("_verticalAlignment",k.verticalAlignment):v._verticalAlignment=k.verticalAlignment;p.isSome(k.effects)&&(r=k.effects,b.isFunction(r)?v._dynamicPropertyMap.set("_effects",r):v._effects=r);p.isSome(k.markerPlacement)&&(r=k.markerPlacement,b.isFunction(r)?v._dynamicPropertyMap.set("_markerPlacement",
r):v._textPlacement=r);b.isFunction(k.text)?v._dynamicPropertyMap.set("_text",k.text):v._text=k.text;v._backgroundColor=k.backgroundColor&&t.premultiplyAlphaRGBA(k.backgroundColor);v._borderLineColor=k.borderLineColor&&t.premultiplyAlphaRGBA(k.borderLineColor);v._borderLineSize=k.borderLineWidth;v._scaleFactor=x;x=Math.min(Math.round(D.pt2px(k.referenceSize*k.sizeRatio)),127);v._referenceSize=Math.round(Math.sqrt(256*x));v._materialKey=k.materialKey;x=e.TextMaterialKey.load(v._materialKey);x.sdf=
!0;v._bitset=(k.alignment===B.Alignment.MAP?1:0)|(k.colorLocked?1:0)<<1;v._materialKey=x.data;v._decoration="none";v._lineHeight=1;v._lineWidth=512;v._isCIM=!0;return v}m._inheritsLoose(g,f);g.fromCIMText=function(k,x){const [r,v]=b.getMinMaxZoom(k.scaleInfo,x);return new g(k,r,v)};var n=g.prototype;n.analyze=function(){var k=m._asyncToGenerator(function*(x,r,v,q){var y=r.readLegacyFeature();var A=this._cimTextLayer;y="string"===typeof A.text?A.text:"function"===typeof A.text?A.text(y,v,q)??"":"";
(x=yield f.prototype.analyze.call(this,x,r,v,q,c.codepoints(y)))&&x.glyphMosaicItems&&this._textToGlyphs.set(y,x.glyphMosaicItems);return x});return function(x,r,v,q){return k.apply(this,arguments)}}();n.bindFeature=function(k,x,r){const v=k.readLegacyFeature();this._dynamicPropertyMap.forEach((q,y)=>{this[y]=q(v,x,r)});this._text&&0!==this._text.length?(this._size*=this._scaleFactor,this._scale=this._size/h.GLYPH_SIZE,this._xOffset*=this._scaleFactor,this._yOffset*=this._scaleFactor,this._xAlignD=
u.getXAnchorDirection(p.unwrapOr(this._horizontalAlignment,"center")),this._yAlignD=u.getYAnchorDirection(p.unwrapOr(this._verticalAlignment,"baseline")),k=this._textToGlyphs.get(this._text)??[],this.bindTextInfo(k,!1)):this._shapingInfo=null};return g}(d(a))})},"esri/views/2d/layers/features/textUtils":function(){define(["exports"],function(m){m.codepoints=function(p){if(null==p)return[];const D=Array(p.length);for(let B=0;B<p.length;B++)D[B]=p.charCodeAt(B);return D};Object.defineProperty(m,Symbol.toStringTag,
{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/WGLFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../color ../../definitions ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./util ./WGLBaseFillTemplate ./WGLMeshTemplate".split(" "),function(m,p,D,B,u,t,h,l,e,b){return function(d){function a(c,f,g,n,k,x,r,v,q,y,A,w,z,C,E,F){var G=d.call(this)||this;G._effects=C;c=h.FillMaterialKey.load(c);f&&(c.sdf=
f.sdf,c.pattern=!0,c.textureBinding=f.textureBinding);G.fillColor=g;G.tl=n;G.br=k;G.aux21=t.i1616to32(x,r);G.aux22=t.i1616to32(v,q);G.aux3=t.i8888to32(y,A,w,0);G._bitset=z;G._minMaxZoom=t.i1616to32(Math.round(E*B.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(F*B.MIN_MAX_ZOOM_PRECISION_FACTOR));G._materialKey=c.data;return G}m._inheritsLoose(a,d);a.fromCIMFill=function(c,f,g){var n=c.color;n=n&&D.premultiplyAlphaRGBA(n)||0;const k=c.materialKey,[x,r]=l.getMinMaxZoom(c.scaleInfo,g);g=(c.colorLocked?B.BITSET_GENERIC_LOCK_COLOR:
0)|(c.applyRandomOffset?B.BITSET_FILL_RANDOM_PATTERN_OFFSET:0)|(c.sampleAlphaOnly?B.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0)|(c.hasUnresolvedReplacementColor?B.BITSET_FILL_HAS_UNRESOLVED_REPLACEMENT_COLOR:0);if(!f)return new a(k,null,n,0,0,0,0,0,0,0,0,0,g,c.effects,x,r);const {rect:v,width:q,height:y}=f;var A=c.scaleX||1,w=v.x+B.SPRITE_PADDING;const z=v.y+B.SPRITE_PADDING;var C=w+q;const E=z+y;var F=p.pt2px(c.height);A*=F;"CIMHatchFill"===c.cim.type&&(A*=q/y);F=Math.round(F);0>=F&&(F=E-z);A=Math.round(A);
0>=A&&(A=C-w);const G=p.pt2px(c.offsetX||0),H=p.pt2px(-c.offsetY||0);w=t.i1616to32(w,z);C=t.i1616to32(C,E);return new a(k,f,n,w,C,A,F,G,H,128,128,u.degToByte(c.angle),g,c.effects,x,r)};a.fromSimpleFill=function(c,f,g=!1){var {color:n}=c;n=n&&"esriSFSNull"!==c.style&&D.premultiplyAlphaRGBAArray(n)||0;g=g?B.BITSET_GENERIC_LOCK_COLOR:0;const k=c.materialKey;if(f){const {rect:v,width:q,height:y,pixelRatio:A}=f;var x=v.x+B.SPRITE_PADDING;const w=v.y+B.SPRITE_PADDING;var r=x+q;const z=w+y;x=t.i1616to32(x,
w);r=t.i1616to32(r,z);f=new a(k,f,n,x,r,q/A,y/A,0,0,128,128,0,g,null,l.DEFAULT_MIN_ZOOM,l.DEFAULT_MAX_ZOOM)}else f=new a(k,null,n,0,0,0,0,0,0,0,0,0,g,null,l.DEFAULT_MIN_ZOOM,l.DEFAULT_MAX_ZOOM);f._maybeAddLineTemplate(c);return f};a.fromPictureFill=function(c,f,g=!1){const n=B.PICTURE_FILL_COLOR,{rect:k,width:x,height:r}=f;var v=k.x+B.SPRITE_PADDING,q=k.y+B.SPRITE_PADDING,y=v+x,A=q+r;v=t.i1616to32(v,q);y=t.i1616to32(y,A);A=Math.round(p.pt2px(c.width));q=Math.round(p.pt2px(c.height));const w=p.pt2px(c.xoffset),
z=p.pt2px(-c.yoffset);f=new a(c.materialKey,f,n,v,y,A,q,w,z,128*c.xscale,128*c.yscale,0,g?B.BITSET_GENERIC_LOCK_COLOR:0,null,l.DEFAULT_MIN_ZOOM,l.DEFAULT_MAX_ZOOM);f._maybeAddLineTemplate(c);return f};return a}(e(b))})},"esri/views/2d/engine/webgl/util/Lock":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/promiseUtils"],function(m,p,D){function B(){B=p._asyncToGenerator(function*(t,h,l){try{yield t.acquire(),yield h(l),t.release()}catch(e){throw t.release(),
e;}});return B.apply(this,arguments)}let u=function(){function t(){this._resolver=null}var h=t.prototype;h.isHeld=function(){return!!this._resolver};h.acquire=function(){var l=p._asyncToGenerator(function*(){this._resolver?(yield this._resolver.promise,yield this.acquire()):this._resolver=D.createResolver()});return function(){return l.apply(this,arguments)}}();h.release=function(){const l=this._resolver;this._resolver=null;l?.resolve()};return t}();m.Lock=u;m.withLock=function(t,h,l){return B.apply(this,
arguments)};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/support/cimSymbolUtils":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../symbols/cim/cimAnalyzer","../../../../symbols/cim/ExpandedCIM","./webStyleUtils"],function(m,p,D,B,u){function t(){t=p._asyncToGenerator(function*(l,e,b,d){return l?"cim"===l.type?h(l,e,b):"web-style"===l.type?(l={type:"cim",data:(yield u.fetchCIMSymbolReference(l,null,d))??void 0,rendererKey:l.rendererKey,
maxVVSize:l.maxVVSize},h(l,e,b)):l:null});return t.apply(this,arguments)}const h=function(){var l=p._asyncToGenerator(function*(e,b,d){return new B.ExpandedCIM(yield D.analyzeCIMSymbol(e.data,b,d),e.data,e.rendererKey,e.maxVVSize)});return function(e,b,d){return l.apply(this,arguments)}}();m.cimLayerToRasterizationInfo=function(l){if(!l)return null;const {avoidSDFRasterization:e,type:b,cim:d,url:a,materialHash:c}=l,f={cim:d,type:b,mosaicHash:c,url:a,size:null,dashTemplate:null,path:null,text:null,
fontName:null,animatedSymbolProperties:null,avoidSDFRasterization:e};switch(b){case "marker":f.size=l.size;f.path=l.path;f.animatedSymbolProperties=l.animatedSymbolProperties;break;case "line":f.dashTemplate=l.dashTemplate;break;case "text":f.text=l.text,f.fontName=l.fontName}return f};m.expandSymbol=function(l,e,b,d){return t.apply(this,arguments)};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/ExpandedCIM":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers",
"../../views/2d/engine/webgl/enums","../../views/2d/engine/webgl/materialKey/MaterialKey"],function(m,p,D,B){const u={marker:D.WGLGeometryType.MARKER,fill:D.WGLGeometryType.FILL,line:D.WGLGeometryType.LINE,text:D.WGLGeometryType.TEXT};let t=function(){function h(l,e,b,d){const a={minScale:e?.minScale,maxScale:e?.maxScale};var c=a.minScale||a.maxScale?a.minScale+"-"+a.maxScale:"";this.layers=l;this.data=e;this.hash=this._createHash()+c;this.rendererKey=b;e={isOutline:!1,placement:null,symbologyType:D.WGLSymbologyType.DEFAULT,
vvFlags:b};for(const f of l)l=u[f.type],e.isOutline="line"===f.type&&f.isOutline,f.materialKey=B.createMaterialKey(l,e),f.maxVVSize=d,f.scaleInfo=a,f.templateHash+=c}h.prototype._createHash=function(){let l="";for(const e of this.layers)l+=e.templateHash;return l};p._createClass(h,[{key:"type",get:function(){return"expanded-cim"}}]);return h}();m.ExpandedCIM=t;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/support/webStyleUtils":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/devEnvironmentUtils ../../../../core/Error ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/urlUtils ../../../../portal/Portal ../../../../chunks/persistableUrlUtils ../../../../symbols/support/styleUtils".split(" "),
function(m,p,D,B,u,t,h,l,e,b){function d(){d=p._asyncToGenerator(function*(n,k,x){if(!n.name)throw new B("style-symbol-reference-name-missing","Missing name in style symbol reference");if(n.styleName&&"Esri2DPointSymbolsStyle"===n.styleName)return a(n,x);try{const r=yield b.fetchStyle(n,k,x);return f(r,n.name,k,x)}catch(r){return t.throwIfAborted(r),null}});return d.apply(this,arguments)}function a(n,k){return c.apply(this,arguments)}function c(){c=p._asyncToGenerator(function*(n,k){n=b.Style2DUrlTemplate.replace(/\{SymbolName\}/gi,
n.name);try{const x=yield b.requestJSON(n,k);return b.makeCIMSymbolRef(x.data)}catch(x){return t.throwIfAborted(x),null}});return c.apply(this,arguments)}function f(n,k,x,r){return g.apply(this,arguments)}function g(){g=p._asyncToGenerator(function*(n,k,x,r){var v=n.data;n={portal:x&&u.isSome(x.portal)?x.portal:l.getDefault(),url:h.urlToObject(n.baseUrl),origin:"portal-item"};v=v.items.find(q=>q.name===k);if(!v)throw new B("symbolstyleutils:symbol-name-not-found",`The symbol name '${k}' could not be found`,
{symbolName:k});v=e.fromJSON(b.symbolUrlFromStyleItem(v,"cimRef"),n);D.isDevEnvironment()&&(v=D.adjustStaticAGOUrl(v));try{const q=yield b.requestJSON(v,r);return b.makeCIMSymbolRef(q.data)}catch(q){return t.throwIfAborted(q),null}});return g.apply(this,arguments)}m.fetchCIMSymbolReference=function(n,k,x){return d.apply(this,arguments)};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/util/Matcher":function(){define("require exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/Logger ../../../../../core/LRUCache ../../../../../core/maybe ../../../../../support/arcadeOnDemand ../../../arcade/callExpressionWithFeature ../../../layers/support/cimSymbolUtils".split(" "),
function(m,p,D,B,u,t,h,l,e,b){function d(w,z,C,E){return a.apply(this,arguments)}function a(){a=D._asyncToGenerator(function*(w,z,C,E){switch(w.type){case "simple":case "heatmap":return x.fromBasicRenderer(w,z,C,E);case "map":return q.fromUVRenderer(w,z,C,E);case "interval":return v.fromCBRenderer(w,z,C,E);case "dictionary":return A.fromDictionaryRenderer(w,z,C,E);case "pie-chart":return r.fromPieChartRenderer(w,z,C,E);case "subtype":return r.fromSubtypes(w,z,C,E)}});return a.apply(this,arguments)}
function c(w,z){return f.apply(this,arguments)}function f(){f=D._asyncToGenerator(function*(w,z){const C=w||1;if("number"===typeof C)return(F,G,H)=>C;const E=yield l.createRendererExpression(C,z.spatialReference,z.fields);return(F,G,H)=>e(E,F,{$view:H},z.geometryType,G)||1});return f.apply(this,arguments)}function g(){return n.apply(this,arguments)}function n(){n=D._asyncToGenerator(function*(){y||(y=new Promise((w,z)=>m(["../../../layers/features/createSymbolSchema"],w,z)));return y});return n.apply(this,
arguments)}const k=u.getLogger("esri/views/2d/engine/webgl/util/Matcher");let x=function(){function w(){this.type="feature";this._defaultResult=null}w.fromBasicRenderer=function(){var C=D._asyncToGenerator(function*(E,F,G,H){const L=new w;E.symbol&&(E=yield b.expandSymbol(E.symbol,G,H),F=F.createTemplateGroup(E,null),L.setDefault(F));return L});return function(E,F,G,H){return C.apply(this,arguments)}}();w.fromPieChartRenderer=function(){var C=D._asyncToGenerator(function*(E,F,G,H){const L=new w;if(E.markerSymbol){const K=
yield b.expandSymbol(E.markerSymbol,G,H);let M;E.fillSymbol&&(M=yield b.expandSymbol(E.fillSymbol,G,H));E=F.createTemplateGroup(K,M);L.setDefault(E)}return L});return function(E,F,G,H){return C.apply(this,arguments)}}();var z=w.prototype;z.size=function(){return 1};z.getDefault=function(){return this._defaultResult};z.setDefault=function(C){this._defaultResult=C};z.match=function(C,E,F,G,H){return this.getDefault()};z.analyze=function(){var C=D._asyncToGenerator(function*(E,F,G,H,L,K){return null});
return function(E,F,G,H,L,K){return C.apply(this,arguments)}}();return w}(),r=function(w){function z(C,E){var F=w.call(this)||this;F._subMatchers=C;F._subtypeField=E;return F}D._inheritsLoose(z,w);z.fromSubtypes=function(){var C=D._asyncToGenerator(function*(E,F,G,H){const L=new Map,K=[];for(const M in E.renderers){const U=parseInt(M,10),T=d(E.renderers[M],F,G,H).then(Z=>L.set(U,Z));K.push(T)}yield Promise.all(K);return new z(L,E.subtypeField)});return function(E,F,G,H){return C.apply(this,arguments)}}();
z.prototype.match=function(C,E,F,G,H){var L=E.readAttribute(this._subtypeField);return(L=this._subMatchers.get(L))?L.match(C,E,F,G,H):null};return z}(x),v=function(w){function z(E,F,G,H){var L=w.call(this)||this;L.type="interval";L._intervals=[];L._isMaxInclusive=F;L._fieldIndex=H;L._field=E;L._normalizationInfo=G;return L}D._inheritsLoose(z,w);z.fromCBRenderer=function(){var E=D._asyncToGenerator(function*(F,G,H,L){const {isMaxInclusive:K,normalizationField:M,normalizationTotal:U,normalizationType:T}=
F,Z=new z(F.field,K,{normalizationField:M,normalizationTotal:U,normalizationType:T},F.fieldIndex),X=yield b.expandSymbol(F.backgroundFillSymbol,H,L);yield Promise.all(F.intervals.map(function(){var ca=D._asyncToGenerator(function*(P){var J=yield b.expandSymbol(P.symbol,H,L);J=yield G.createTemplateGroup(J,X);Z.add({min:P.min,max:P.max},J)});return function(P){return ca.apply(this,arguments)}}()));if(F=yield b.expandSymbol(F.defaultSymbol,H,L))F=yield G.createTemplateGroup(F,X),Z.setDefault(F);return Z});
return function(F,G,H,L){return E.apply(this,arguments)}}();var C=z.prototype;C.add=function(E,F){this._intervals.push({interval:E,result:F});this._intervals.sort((G,H)=>G.interval.min-H.interval.min)};C.size=function(){return w.prototype.size.call(this)+this._intervals.length};C.match=function(E,F,G,H,L){if(null==this._fieldIndex&&!this._field)return this.getDefault();E=null!=this._fieldIndex?F.getComputedNumericAtIndex(this._fieldIndex):this._getValueFromField(F);if(null===E||void 0===E||isNaN(E)||
Infinity===E||-Infinity===E)return this.getDefault();for(F=0;F<this._intervals.length;F++){const {interval:K,result:M}=this._intervals[F];G=this._isMaxInclusive?E<=K.max:E<K.max;if(E>=K.min&&G)return M}return this.getDefault()};C._needsNormalization=function(){const E=this._normalizationInfo;return E&&(E.normalizationField||E.normalizationTotal||E.normalizationType)};C._getValueFromField=function(E){const F=E.readAttribute(this._field);if(!this._needsNormalization()||null==F)return F;const {normalizationField:G,
normalizationTotal:H,normalizationType:L}=this._normalizationInfo;E=E.readAttribute(G)??1;if(L)switch(L){case "esriNormalizeByField":return(E||void 0)&&F/E;case "esriNormalizeByLog":return Math.log(F)*Math.LOG10E;case "esriNormalizeByPercentOfTotal":return F/H*100;default:k.error(`Found unknown normalization type: ${L}`)}else k.error("Normalization is required, but no type was set!")};return z}(x),q=function(w){function z(E,F,G){var H=w.call(this)||this;H.type="map";H._nullResult=null;H._resultsMap=
new Map;H._fields=[];H._fieldsIndex=G;H._fields=E;H._seperator=F||"";return H}D._inheritsLoose(z,w);z.fromUVRenderer=function(){var E=D._asyncToGenerator(function*(F,G,H,L){const K=F.fieldDelimiter,M=[F.field];F.field2&&M.push(F.field2);F.field3&&M.push(F.field3);const U=yield b.expandSymbol(F.backgroundFillSymbol,H,L),T=new z(M,K,F.fieldIndex);yield Promise.all(F.map.map(function(){var Z=D._asyncToGenerator(function*(X,ca){const P=yield b.expandSymbol(X.symbol,H,L);ca=yield G.createTemplateGroup(P,
U,ca+1);"\x3cNull\x3e"===X.value?T.setNullResult(ca):T.add(X.value,ca)});return function(X,ca){return Z.apply(this,arguments)}}()));if(F=yield b.expandSymbol(F.defaultSymbol,H,L))F=yield G.createTemplateGroup(F,U,Number.MAX_SAFE_INTEGER),T.setDefault(F);return T});return function(F,G,H,L){return E.apply(this,arguments)}}();var C=z.prototype;C.setNullResult=function(E){this._nullResult=E};C.add=function(E,F){this._resultsMap.set(E.toString(),F)};C.size=function(){return w.prototype.size.call(this)+
this._resultsMap.size};C.match=function(E,F,G,H,L){if(null==this._fieldsIndex&&!this._fields)return this.getDefault();E=null!=this._fieldsIndex?F.getComputedStringAtIndex(this._fieldsIndex):this._getValueFromFields(F);if(null!==this._nullResult&&(null==E||""===E||"\x3cNull\x3e"===E))return this._nullResult;if(null==E)return this.getDefault();E=E.toString();return this._resultsMap.has(E)?this._resultsMap.get(E):this.getDefault()};C._getValueFromFields=function(E){const F=[];for(const G of this._fields){const H=
E.readAttribute(G);null==H||""===H?F.push("\x3cNull\x3e"):F.push(H)}return F.join(this._seperator)};return z}(x),y,A=function(w){function z(E,F,G,H,L,K){var M=w.call(this)||this;M.type="dictionary";M._groupIdCache=new t(100);M._loader=E;M._fieldMap=E.fieldMap;M._symbolFields=E.getSymbolFields();M._templates=F;M._info=G;M._scaleFn=H;M._schemaUtilsModule=L;M._symbolOptions=K;return M}D._inheritsLoose(z,w);z.fromDictionaryRenderer=function(){var E=D._asyncToGenerator(function*(F,G,H,L){const [{DictionaryLoader:K},
M]=yield Promise.all([new Promise((T,Z)=>m(["../../../../../renderers/support/DictionaryLoader"],T,Z)),g()]);L=new K(F.url,F.config,F.fieldMap);yield L.fetchResources({spatialReference:H.spatialReference,fields:H.fields});const U=yield c(F.scaleExpression,H);return new z(L,G,H,U,M,F.symbolOptions)});return function(F,G,H,L){return E.apply(this,arguments)}}();var C=z.prototype;C._analyzeFeature=function(){var E=D._asyncToGenerator(function*(F,G,H,L,K){F=F.readLegacyFeature();const M=this._scaleFn(F,
H,L);H=this._attributeHash(F)+"-"+M;const U=this._groupIdCache.get(H);if(U)return U;L=yield this._loader.getSymbolAsync(F,{...L,spatialReference:this._info.spatialReference,abortOptions:K,fields:this._info.fields});L=this._schemaUtilsModule.createSymbolSchema(L,this._symbolOptions);G=b.expandSymbol(L,this._info,G,K).then(T=>{if("expanded-cim"!==T?.type)return k.error(new B("mapview-bad-type",`Found unexpected type ${T?.type} in dictionary response`)),null;T.hash+="-"+M;for(const Z of T.layers)Z.scaleFactor=
M,Z.templateHash+="-"+M;return this._templates.createTemplateGroup(T,null)});this._groupIdCache.put(H,G,1);return G});return function(F,G,H,L,K){return E.apply(this,arguments)}}();C.analyze=function(){var E=D._asyncToGenerator(function*(F,G,H,L,K,M){F=G.getCursor();for(G=[];F.next();)G.push(this._analyzeFeature(F,H,L,K,M));return Promise.all(G).then(U=>U.filter(h.isSome))});return function(F,G,H,L,K,M){return E.apply(this,arguments)}}();C.match=function(E,F,G,H,L){return null};C._attributeHash=function(E){let F=
"";for(const G of this._symbolFields){const H=this._fieldMap?.[G];H&&(F+=E.attributes[H]+"-")}return F};return z}(x);p.DictionaryMatcher=A;p.FeatureMatcher=x;p.IntervalMatcher=v;p.MapMatcher=q;p.SubtypeMatcher=r;p.createMatcher=d;Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/schemaUtils":function(){define("exports ../../../../core/Error ../../../../core/has ../../../../core/Logger ../../../../core/maybe ../../../../core/screenUtils ../../../../core/sql ../../../../core/accessorSupport/diffUtils ../../../../layers/support/labelingInfo ../../engine/webgl/enums ../../engine/webgl/Utils ../../engine/webgl/techniques/utils ../../engine/webgl/util/vvFlagUtils ./createSymbolSchema ./support/pixelBuffering ./support/rendererUtils ../support/clusterUtils ../support/util".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d,a,c,f,g,n,k,x){function r(I,O){let R=0,V=0,W=b.WGLSymbologyType.DEFAULT;if(u.isSome(I)){V=g.getPtMaxVVSize(I,O);"visualVariables"in I&&(R=c.getVVFlags(I.visualVariables||[]),"dot-density"===I.type&&(W=b.WGLSymbologyType.DOT_DENSITY));"heatmap"===I.type&&(W=b.WGLSymbologyType.HEATMAP);if("dictionary"===I.type)return{maxVVSize:V,vvFlags:R,symbologyType:b.WGLSymbologyType.DEFAULT};if("pie-chart"===I.type)return{maxVVSize:V,vvFlags:R,symbologyType:b.WGLSymbologyType.PIE_CHART};
if(W!==b.WGLSymbologyType.DOT_DENSITY&&W!==b.WGLSymbologyType.HEATMAP){var da=I.getSymbols();"backgroundFillSymbol"in I&&I.backgroundFillSymbol&&da.push(I.backgroundFillSymbol);O=I=!0;for(const fa of da)if("cim"===fa.type&&(O=!1),"simple-fill"===fa.type||"picture-fill"===fa.type){da=(da=fa.outline)&&"none"!==da.style&&"solid"!==da.style;var ea="simple-fill"===fa.type&&"none"!==fa.style&&"solid"!==fa.style;ea="picture-fill"===fa.type||ea||da;da&&(I=!1);ea&&(O=!1)}I?W=O?b.WGLSymbologyType.OUTLINE_FILL_SIMPLE:
b.WGLSymbologyType.OUTLINE_FILL:O&&(W=b.WGLSymbologyType.SIMPLE)}}return{vvFlags:R,maxVVSize:V,symbologyType:W}}function v(I,O=!1){try{const V=H(I,O);var R="heatmap"===I.renderer?.type&&"raster"===n.getSupportedHeatmapRenderer()?{type:"heatmap"}:{type:"symbol"};const W={};V.map(ea=>q(W,I,ea));const da=u.isSome(I.subtypeCode)?`${I.subtypeField} = ${I.subtypeCode}`:null;return{source:{definitionExpression:u.unwrap(h.sqlAnd(I.definitionExpression,da)),fields:I.fields.map(ea=>ea.toJSON()),gdbVersion:I.gdbVersion,
historicMoment:I.historicMoment?.getTime(),outFields:I.availableFields,pixelBuffer:I.pixelBuffer,spatialReference:I.spatialReference.toJSON(),timeExtent:I.timeExtent?.toJSON(),customParameters:I.customParameters},attributes:{fields:{},indexCount:0},processors:V,tileRenderer:R,targets:W}}catch(V){if("ValidationError"===V.fieldName)return ba.error(V),null;throw V;}}function q(I,O,R){switch(R.target){case "feature":w(I,A(O),R);break;case "aggregate":if("featureReduction"in O){var V=O.featureReduction;
switch(V?.type){case "selection":throw new p("ValidationError","Mapview does not support `selection` reduction type",V);case "binning":w(I,A(O),R);C(I,V,O.fields.map(W=>W.toJSON()),R);break;case "cluster":w(I,A(O),R),E(I,V,O.fields.map(W=>W.toJSON()),R)}}}}function y(I,O){for(const V in O){const W=O[V];if(W.target===I.name){var R=I.attributes[V];R?.context?(R=R.context,R.mesh=R.mesh||W.context?.mesh,R.storage=R.storage||W.context?.storage):I.attributes[V]=W}}return I}function A(I){return[u.unwrap(I.filter)?.toJSON()??
null,u.unwrap(u.unwrap(I.featureEffect)?.filter)?.toJSON()??null]}function w(I,O,R){I.feature||(I.feature={name:"feature",input:"source",filters:O,attributes:{}});y(I.feature,R.attributes.fields);return I}function z(I,O){const {onStatisticExpression:R,onStatisticField:V,statisticType:W}=I;switch(W){case "min":case "max":case "avg":case "avg_angle":case "sum":case "count":return"esriFieldTypeDouble";case "mode":if(R)return{returnType:O}=R,O?"string"===O?"esriFieldTypeString":"esriFieldTypeDouble":
(ba.error(new p("ValidationError","Unable to infer type of aggregateField with onStatisticExpression. ReturnType is not defined",I)),"esriFieldTypeString");O=O.find(da=>da.name===V);return O?O.type:(ba.error(new p("ValidationError","Unable to infer type of aggregateField with onStatisticExpression. ReturnType is not defined",I)),"esriFieldTypeString")}}function C(I,O,R,V){I.aggregate||(I.aggregate={name:"aggregate",type:"bin",filters:null,input:"feature",params:{fixedBinLevel:O.fixedBinLevel,fields:(O.fields??
[]).map(W=>({...W.toJSON(),type:z(W,R)}))},attributes:{}});y(I.aggregate,V.attributes.fields);return I}function E(I,O,R,V){I.aggregate||(I.aggregate={name:"aggregate",type:"cluster",input:"feature",filters:null,attributes:{},params:{clusterRadius:t.pt2px(O.clusterRadius/2),clusterPixelBuffer:64*Math.ceil(t.pt2px(O.clusterMaxSize)/64),fields:(O.fields??[])?.map(W=>({...W.toJSON(),type:z(W,R)}))}});y(I.aggregate,V.attributes.fields);return I}function F(I,O){return O.field?G(I,{...O,type:"field",field:O.field}):
O.valueExpression?G(I,{...O,type:"expression",valueExpression:O.valueExpression}):{field:void 0,fieldIndex:void 0}}function G(I,O){switch(O.type){case "expression":var R=O.valueExpression;if(!I.fields[R]){var V=I.indexCount++;I.fields[R]={...O,name:R,fieldIndex:V}}return{fieldIndex:I.fields[R].fieldIndex};case "label-expression":return R=JSON.stringify(O.label),I.fields[R]||(V=I.indexCount++,I.fields[R]={...O,name:R,fieldIndex:V}),{fieldIndex:I.fields[R].fieldIndex};case "field":R=O.field;if("aggregate"===
O.target&&I.fields[R])return{field:R};I.fields[R]={...O,name:R};return{field:R};case "statistic":return I.fields[O.name]={...O},{field:O.name}}}function H(I,O=!1){const R=[];let V=0;R.push(M(I,V++,O));return R}function L(I,O,R,V,W,da=!1){I=G(I,{type:"label-expression",target:R,context:{mesh:!0},resultType:"string",label:{labelExpression:O.labelExpression,labelExpressionInfo:O.labelExpressionInfo?{expression:O.labelExpressionInfo.expression}:null,symbol:!!O.symbol,where:O.where}});({fieldIndex:I}=
I);return{...f.createSymbolSchema(O,W,da),fieldIndex:I,target:R,index:V}}function K(I,O,R){const V="featureReduction"in O&&O.featureReduction;if(!V)return{fields:[],labels:[],matcher:void 0,rendererOverride:void 0};const W=[];let da=null,ea=x.toJSONGeometryType(O.geometryType),fa=[];var ha=null;if(V)switch(V.type){case "selection":return ba.error(new p("ValidationError","Mapview does not support `selection` reduction type",V)),{fields:[],labels:[],matcher:void 0,rendererOverride:void 0};case "cluster":case "binning":W.push(...(V.fields??
[])),"cluster"===V.type?ea="esriGeometryPoint":"binning"===V.type&&(ea="esriGeometryPolygon"),V.renderer&&!V.renderer.authoringInfo?.isAutoGenerated?("cluster"===V.type?{renderer:ha}=k.injectDynamicLevelDependentSizeVisualVariable(V.renderer,V,null):ha=V.renderer,O=r(V.renderer,V),da=P(I,"aggregate",V.renderer,O,R),fa=V&&V.labelsVisible&&V.labelingInfo||[]):"cluster"===V.type&&(ha=k.createClusterRenderer(W,O.renderer,V,null,!0),V.symbol&&(O=r(ha,V),da={type:"simple",symbol:f.createSymbolSchema(V.symbol,
O,R),symbologyType:O.symbologyType}),fa=V&&V.labelsVisible&&V.labelingInfo||[])}T(I,W);return{labels:e.validateLabelingInfo(fa,"binning"===V.type?"esriGeometryPolygon":ea),matcher:da,fields:W,rendererOverride:ha}}function M(I,O,R=!1){const V={indexCount:0,fields:{}};var W="featureReduction"in I?I.featureReduction??void 0:void 0;O=W?"aggregate":"feature";if("sublayers"in I){var da={type:"subtype",subtypeField:I.subtypeField,renderers:{},symbologyType:b.WGLSymbologyType.DEFAULT},ea={type:"subtype",
mapping:{},target:"feature",subtypeField:I.subtypeField},fa={type:"subtype",classes:{}},ha={type:"symbol",target:"feature",aggregateFields:[],attributes:V,storage:ea,mesh:{matcher:da,aggregateMatcher:null,labels:fa,sortKey:null}};W=new Set;let ka=0;for(const {renderer:ja,subtypeCode:ma,labelingInfo:na,labelsVisible:pa}of I.sublayers){I=0;"visualVariables"in ja&&ja.visualVariables&&(ja.visualVariables.some(ra=>"rotation"!==ra.type)&&ba.warnOnce("SubtypeGroupLayer currently only supports rotation visualVariables. All other visualVariable types will be ignored."),
I=c.getVVFlags(ja.visualVariables.filter(ra=>"size"!==ra.type)));const oa={symbologyType:b.WGLSymbologyType.DEFAULT,vvFlags:I,maxVVSize:0};I=P(V,O,ja,oa,R);const qa=Z(V,O,ja),ta=pa&&na;if("dictionary"===I.type)throw new p("ValidationError","Dictionary renderer is not supported in subtype layers");if("subtype"===I.type)throw new p("ValidationError","Nested subtype renderers is not supported");if(u.isSome(qa)&&"subtype"===qa.type)throw new p("ValidationError","Nested subtype storage is not supported");
if(u.isSome(qa)&&u.isSome(qa.attributeMapping))throw new p("ValidationError","Non-visual-variable attributes are not supported in subtype layers");if("heatmap"===I.type)throw new p("ValidationError","Heatmaps are not supported in subtype layers");if("pie-chart"===I.type)throw new p("ValidationError","Pie-charts are not supported in subtype layers");if(W.has(ma))throw new p("ValidationError","Subtype codes for sublayers must be unique");W.add(ma);da.renderers[ma]=I;ea.mapping[ma]=qa;ta&&(fa.classes[ma]=
ta.map(ra=>L(V,ra,"feature",ka++,oa,R)))}return ha}if("heatmap"===I.renderer?.type&&"raster"===n.getSupportedHeatmapRenderer()){const {radius:ka,fieldOffset:ja,field:ma}=I.renderer;return{type:"heatmap",aggregateFields:[],attributes:V,target:O,storage:null,mesh:{radius:ka,fieldOffset:ja,field:F(V,{target:O,field:ma,resultType:"numeric"}).field}}}da=K(V,I,R);fa=x.toJSONGeometryType(I.geometryType);ha=da.rendererOverride??I.renderer;const ia=r(ha,W);ea=P(V,O,ha,ia,R);ha=Z(V,O,ha);W=U(V,I.orderBy,I.renderer,
W);let la=0;I=[...e.validateLabelingInfo(I.labelsVisible&&I.labelingInfo||[],fa).map(ka=>L(V,ka,"feature",la++,ia,R)),...da.labels.map(ka=>L(V,ka,"aggregate",la++,ia,R))];return{type:"symbol",target:O,attributes:V,aggregateFields:da.fields,storage:ha,mesh:{matcher:ea,labels:{type:"simple",classes:I},aggregateMatcher:da.matcher,sortKey:W}}}function U(I,O,R,V){if(u.isSome(V))return null;if(u.isSome(O)&&O.length){1<O.length&&ba.warn(`Layer rendering currently only supports ordering by 1 orderByInfo, but found ${O.length}. All but the first will be discarded`);
O=O[0];R="ascending"===O.order?"asc":"desc";if(O.field)return{field:O.field,order:R};if(O.valueExpression)return{fieldIndex:G(I,{type:"expression",target:"feature",valueExpression:O.valueExpression,resultType:"numeric"}).fieldIndex,order:R};ba.error(new p("ValidationError","Expected to find a field or valueExpression for OrderByInfo",O));return null}return u.isSome(R)&&"unique-value"===R.type&&R.orderByClassesEnabled?{byRenderer:!0,order:"asc"}:null}function T(I,O){const R={mesh:!0,storage:!0};for(const V of O){const {name:W,
onStatisticField:da,onStatisticExpression:ea,statisticType:fa}=V;let ha=O=void 0;ea?ha=G(I,{type:"expression",target:"feature",valueExpression:ea.expression,resultType:"numeric"}).fieldIndex:O=G(I,{type:"field",target:"feature",field:da,resultType:"numeric"}).field;G(I,{type:"statistic",target:"aggregate",name:W,context:R,inField:O,inFieldIndex:ha,statisticType:fa})}}function Z(I,O,R){let V;switch(R.type){case "simple":case "class-breaks":case "unique-value":case "dictionary":V={visualVariables:!0,
attributes:null};break;default:V=a.getTechniqueFromRenderer(R).getStorageSpec(R)}return X(I,O,V,R)}function X(I,O,R,V){if(u.isNone(R))return null;const {visualVariables:W,attributes:da}=R;R=null;W&&"visualVariables"in V&&(R=ca(I,O,V.visualVariables));const ea=u.isSome(R)?4:0;V=null;u.isSome(da)&&(V=da.map((fa,ha)=>{const {field:ia,fieldIndex:la}=F(I,{valueExpression:fa.valueExpression,field:fa.field,resultType:"numeric",target:O});return{binding:ha+ea,field:ia,fieldIndex:la}}));return{type:"simple",
target:O,attributeMapping:V,vvMapping:R}}function ca(I,O,R){if(!R||!R.length)return[];const V={storage:!0};return n.simplifyVisualVariables(R).map(W=>{const da=d.getVVType(W.type),{field:ea,fieldIndex:fa}=F(I,{target:O,valueExpression:W.valueExpression,field:W.field,context:V,resultType:"numeric"});switch(W.type){case "size":return"$view.scale"===W.valueExpression?null:{type:"size",binding:da,field:ea,fieldIndex:fa,normalizationField:F(I,{target:O,field:W.normalizationField,context:V,resultType:"numeric"}).field,
valueRepresentation:W.valueRepresentation??null};case "color":return{type:"color",binding:da,field:ea,fieldIndex:fa,normalizationField:F(I,{target:O,field:W.normalizationField,context:V,resultType:"numeric"}).field};case "opacity":return{type:"opacity",binding:da,field:ea,fieldIndex:fa,normalizationField:F(I,{target:O,field:W.normalizationField,context:V,resultType:"numeric"}).field};case "rotation":return{type:"rotation",binding:da,field:ea,fieldIndex:fa}}}).filter(u.isSome)}function P(I,O,R,V,W=
!1){I=u.unwrapOr(I,{indexCount:0,fields:{}});switch(R.type){case "simple":case "dot-density":return J(I,R,V,W);case "class-breaks":return S(I,O,R,V,W);case "unique-value":return Q(I,O,R,V,W);case "dictionary":return{type:"dictionary",config:R.config,fieldMap:R.fieldMap,scaleExpression:R.scaleExpression,url:R.url,symbolOptions:V,symbologyType:V.symbologyType};case "heatmap":return Y(I,R,V,W);case "pie-chart":return N(I,R,V,W)}}function J(I,O,R,V=!1){I=O.getSymbols();return{type:"simple",symbol:f.createSymbolSchema(I.length?
I[0]:null,R,V),symbologyType:R.symbologyType}}function N(I,O,R,V=!1){I=O.getSymbols();O=1<I.length?I[1]:null;return{type:"pie-chart",markerSymbol:f.createSymbolSchema(I[0],R,V),fillSymbol:f.createSymbolSchema(O,R,V),symbologyType:R.symbologyType}}function S(I,O,R,V,W=!1){const da=R.backgroundFillSymbol,{field:ea,fieldIndex:fa}=F(I,{target:O,field:R.field,valueExpression:R.valueExpression,resultType:"numeric",context:{mesh:!0,use:"renderer.field"}});O=R.normalizationType;O="log"===O?"esriNormalizeByLog":
"percent-of-total"===O?"esriNormalizeByPercentOfTotal":"field"===O?"esriNormalizeByField":null;const ha=R.classBreakInfos.map(ia=>({symbol:f.createSymbolSchema(ia.symbol,V,W),min:ia.minValue,max:ia.maxValue})).sort((ia,la)=>ia.min-la.min);return{type:"interval",attributes:I.fields,field:ea,fieldIndex:fa,backgroundFillSymbol:f.createSymbolSchema(da,V,W),defaultSymbol:f.createSymbolSchema(R.defaultSymbol,V,W),intervals:ha,normalizationField:R.normalizationField,normalizationTotal:R.normalizationTotal,
normalizationType:O,isMaxInclusive:R.isMaxInclusive,symbologyType:V.symbologyType}}function Q(I,O,R,V,W=!1){const da=[],ea=R.backgroundFillSymbol;O={target:O,context:{mesh:!0},resultType:"string"};if(R.field&&"string"!==typeof R.field)throw new p("ValidationError","Expected renderer.field to be a string",R);const {field:fa,fieldIndex:ha}=F(I,{...O,field:R.field,valueExpression:R.valueExpression});for(const ia of R.uniqueValueInfos??[])da.push({value:""+ia.value,symbol:f.createSymbolSchema(ia.symbol,
V,W)});return{type:"map",attributes:I.fields,field:fa,fieldIndex:ha,field2:F(I,{...O,field:R.field2}).field,field3:F(I,{...O,field:R.field3}).field,fieldDelimiter:R.fieldDelimiter??void 0,backgroundFillSymbol:f.createSymbolSchema(ea,V),defaultSymbol:f.createSymbolSchema(R.defaultSymbol,V),map:da,symbologyType:V.symbologyType}}function Y(I,O,R,V=!1){I=O.getSymbols();return{type:"heatmap",symbol:f.createSymbolSchema(I.length?I[0]:null,R,V),symbologyType:R.symbologyType}}const ba=B.getLogger("esri.views.2d.layers.features.schemaUtils");
let aa=null;m.createSymbolSchema=f.createSymbolSchema;m.addAggregateFields=T;m.createMatcherSchema=P;m.createRendererAttributeSchema=F;m.createSchema=function(I){if(D("esri-2d-update-debug")){const O=v(I,!0);console.debug("Created new schema",O);console.debug("Schema diff",l.diff(aa,O));aa=O}return v(I)};m.createSymbolSchemaOptions=r;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/util/vvFlagUtils":function(){define(["exports","../enums","../visualVariablesUtils"],
function(m,p,D){m.getVVFlags=function(B){if(!B)return p.WGLVVFlag.NONE;let u=0;for(const t of B)"size"===t.type?(B=D.getTypeOfSizeVisualVariable(t),u|=B,"outline"===t.target&&(u|=B<<4)):"color"===t.type?u|=p.WGLVVFlag.COLOR:"opacity"===t.type?u|=p.WGLVVFlag.OPACITY:"rotation"===t.type&&(u|=p.WGLVVFlag.ROTATION);return u};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/visualVariablesUtils":function(){define(["exports","../../../../core/Error","../../../../core/Logger",
"./enums","./Utils"],function(m,p,D,B,u){m.getTypeOfSizeVisualVariable=function(t){if(u.isNumber(t.minDataValue)&&u.isNumber(t.maxDataValue)&&null!=t.minSize&&null!=t.maxSize)return B.WGLVVFlag.SIZE_MINMAX_VALUE;if((t.expression&&"view.scale"===t.expression||t.valueExpression&&"$view.scale"===t.valueExpression)&&Array.isArray(t.stops))return B.WGLVVFlag.SIZE_SCALE_STOPS;if((null!=t.field||t.expression&&"view.scale"!==t.expression||t.valueExpression&&"$view.scale"!==t.valueExpression)&&(Array.isArray(t.stops)||
"levels"in t&&t.levels))return B.WGLVVFlag.SIZE_FIELD_STOPS;if((null!=t.field||t.expression&&"view.scale"!==t.expression||t.valueExpression&&"$view.scale"!==t.valueExpression)&&null!=t.valueUnit)return B.WGLVVFlag.SIZE_UNIT_VALUE;D.getLogger("esri.views.2d.engine.webgl").error(new p("mapview-bad-type","Found invalid size VisualVariable",t));return B.WGLVVFlag.NONE};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/createSymbolSchema":function(){define(["exports",
"../../engine/webgl/enums","../../engine/webgl/materialKey/MaterialKey"],function(m,p,D){function B(h){switch(h.type){case "line-marker":return{type:"line-marker",color:h.color?.toJSON(),placement:h.placement,style:h.style};default:return h.constructor.fromJSON(h.toJSON()).toJSON()}}function u(h,l,e){var b=D.createMaterialKey(p.WGLGeometryType.FILL,l);b=e?D.hydrateMaterialKey(b):b;var d=h.clone();h=d.outline;const a=D.isOutlineFillSymbology(l.symbologyType);a||(d.outline=null);d={materialKey:b,hash:d.hash(),
...B(d)};if(a)return d;b=[];b.push(d);h&&(l=D.createMaterialKey(p.WGLGeometryType.LINE,{...l,isOutline:!0}),e={materialKey:e?D.hydrateMaterialKey(l):l,hash:h.hash(),...B(h)},b.push(e));return{type:"composite-symbol",layers:b,hash:b.reduce((c,f)=>f.hash+c,"")}}function t(h,l,e){var b=D.isOutlineFillSymbology(l.symbologyType)?p.WGLSymbologyType.DEFAULT:l.symbologyType;b=D.createMaterialKey(p.WGLGeometryType.LINE,{...l,symbologyType:b});const d=e?D.hydrateMaterialKey(b):b;h=h.clone();b=h.marker;h.marker=
null;const a=[];a.push({materialKey:d,hash:h.hash(),...B(h)});b&&(l=D.createMaterialKey(p.WGLGeometryType.MARKER,l),e=e?D.hydrateMaterialKey(l):l,b.color=b.color??h.color,a.push({materialKey:e,hash:b.hash(),lineWidth:h.width,...B(b)}));return{type:"composite-symbol",layers:a,hash:a.reduce((c,f)=>f.hash+c,"")}}m.createSymbolSchema=function(h,l,e=!1){if(!h)return null;switch(h.type){case "simple-fill":case "picture-fill":return u(h,l,e);case "simple-marker":case "picture-marker":var b=D.createMaterialKey(p.WGLGeometryType.MARKER,
l);e=e?D.hydrateMaterialKey(b):b;b=B(h);return{materialKey:e,hash:h.hash(),...b,angle:h.angle,maxVVSize:l.maxVVSize};case "simple-line":return t(h,l,e);case "text":return b=D.createMaterialKey(p.WGLGeometryType.TEXT,l),e=e?D.hydrateMaterialKey(b):b,b=B(h),{materialKey:e,hash:h.hash(),...b,angle:h.angle,maxVVSize:l.maxVVSize};case "label":return b=h.toJSON(),l=D.createMaterialKey(p.WGLGeometryType.LABEL,{...l,placement:b.labelPlacement}),{materialKey:e?D.hydrateMaterialKey(l):l,hash:h.hash(),...b,
labelPlacement:b.labelPlacement};case "cim":return{type:"cim",rendererKey:l.vvFlags,data:h.data,maxVVSize:l.maxVVSize};case "CIMSymbolReference":return{type:"cim",rendererKey:l.vvFlags,data:h,maxVVSize:l.maxVVSize};case "web-style":return{...B(h),type:"web-style",hash:h.hash(),rendererKey:l.vvFlags,maxVVSize:l.maxVVSize};default:throw Error(`symbol not supported ${h.type}`);}};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/pixelBuffering":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/screenUtils ../../../../../symbols/cim/CIMSymbolHelper ../../../../../symbols/cim/Rect ../../../engine/webgl/definitions ../../graphics/graphicsUtils ../../support/cimSymbolUtils".split(" "),
function(m,p,D,B,u,t,h,l){function e(q,y){if(!("visualVariables"in q&&q.hasVisualVariables("size")))return 0;q=q.getVisualVariablesForType("size");if(!q[0])return 0;q=q[0];if(y&&"cluster_count"===q.field&&"cluster"===y.type)return y.clusterMaxSize;if("outline"===q.target)return 0;if("stops"===q.transformationType)return q.stops.map(A=>A.size).reduce(k,0);if("clamped-linear"===q.transformationType){let A=y=-Infinity;y="number"===typeof q.maxSize?q.maxSize:q.maxSize.stops.map(w=>w.size).reduce(k,0);
A="number"===typeof q.minSize?q.minSize:q.minSize.stops.map(w=>w.size).reduce(k,0);return Math.max(y,A)}if("real-world-size"===q.transformationType)return 30}function b(){b=p._asyncToGenerator(function*(q,y,A,w,z,C){if(!q||C&&"cluster"===C.type)return 0;if("heatmap"===q.type)return Math.round(D.pt2px(q.radius));if("dot-density"===q.type)return 0;if("dictionary"===q.type)return"esriGeometryPoint"===y||"esriGeometryMultipoint"===y?100:200;C=q.getSymbols();q=e(q);const E=[];for(const F of C)E.push(f(F,
q,A,y,w,z));y=yield Promise.all(E);return D.pt2px(y.reduce(k,0))});return b.apply(this,arguments)}function d(q,y){return null==q?y:q}function a(q,y,A,w,z,C){return c.apply(this,arguments)}function c(){c=p._asyncToGenerator(function*(q,y,A,w,z,C){if("simple-marker"===q.type)return y=Math.max(d(q.size,12),y),n(q)+.707*y;if("picture-marker"===q.type)return A=Math.max(d(q.height,12),y),y=d(q.width,12)*(A/d(q.height,12))/2,A/=2,n(q)+Math.sqrt(y*y+A*A);if("text"===q.type){if(A=q.text&&q.text.length){y=
[];for(w=0;w<A;w++)y.push({...v,code:q.text.charCodeAt(w)});y={glyphMosaicItems:y}}else y={glyphMosaicItems:[v]};h.getTextSymbolSize(r,q.toJSON(),y);return Math.max(Math.abs(r[0]),Math.abs(r[1]))+Math.max(r[2],r[3])}return"simple-line"===q.type?(A=Math.max(d(q.width,.75),y)/2,q.marker?Math.max(6*q.width,2*y):A):"simple-fill"===q.type||"picture-fill"===q.type?(A=Math,w=A.max,q=null==q.outline?0:d(q.outline.width,0),w.call(A,q,y)/2):"cim"===q.type?(yield l.expandSymbol({type:"cim",rendererKey:0,data:q.data,
maxVVSize:y},{geometryType:w,fields:z,spatialReference:C},A),(q=B.CIMSymbolHelper.getEnvelope(q.data,null,A))?Math.sqrt(q.width*q.width+q.height*q.height):0):"web-style"===q.type?a(yield q.fetchCIMSymbol(),y,A,w,z,C):0});return c.apply(this,arguments)}function f(q,y,A,w,z,C){return g.apply(this,arguments)}function g(){g=p._asyncToGenerator(function*(q,y,A,w,z,C){return q.type in x?Math.min(yield a(q,y,A,w,z,C),75):0});return g.apply(this,arguments)}function n(q){const y=d(q.xoffset,0);q=d(q.yoffset,
0);return Math.sqrt(y*y+q*q)}function k(q,y){return Math.max(q,y)}const x={"simple-marker":1,"picture-marker":1,text:0,"simple-line":0,"simple-fill":0,"picture-fill":0,cim:1,"web-style":1},r=[0,0,0,0],v={sdf:!0,code:99,metrics:t.AVERAGE_GLYPH_MOSAIC_ITEM.metrics,rect:new u(0,0,24,24),page:0,textureBinding:2};m.computePxBuffer=function(q,y,A,w,z,C){return b.apply(this,arguments)};m.getPtMaxVVSize=e;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/graphics/graphicsUtils":function(){define("exports ../../../../core/BidiText ../../../../core/maybe ../../../../core/screenUtils ../../../../geometry/Polygon ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/spatialReferenceUtils ../../engine/webgl/alignmentUtils ../../engine/webgl/definitions ../../engine/webgl/mesh/templates/shapingUtils".split(" "),
function(m,p,D,B,u,t,h,l,e,b){m.PIXEL_BUFFER=50;m.TILE_SIZE=512;m.getTextSymbolSize=function(d,a,c){if(!c?.glyphMosaicItems?.length)return d;const f=p.bidiText(a.text)[1];a=b.shapeGlyphs(c.glyphMosaicItems,f,{scale:B.pt2px(a.font.size)/e.GLYPH_SIZE,angle:a.angle??0,xOffset:a.xoffset??0,yOffset:a.yoffset??0,hAlign:l.getXAnchorDirection(a.horizontalAlignment||"center"),vAlign:l.getYAnchorDirection(a.verticalAlignment||"baseline"),maxLineWidth:Math.max(32,Math.min(a.lineWidth||512,512)),lineHeight:e.MAGIC_LABEL_LINE_HEIGHT*
Math.max(.25,Math.min(a.lineHeight||1,4)),decoration:a.font.decoration||"none",isCIM:!1,hasBackground:!!a.backgroundColor,borderLineSize:a.borderLineSize}).bounds;d[0]=B.pt2px(a.x-a.halfWidth);d[1]=B.pt2px(a.y-a.halfHeight);d[2]=B.pt2px(a.width);d[3]=B.pt2px(a.height);return d};m.graphicGeometryToNumber=function(d){switch(D.unwrap(d.geometry).type){case "polyline":return 1;case "polygon":case "extent":return 2}return 0};m.intersectingInternationalDateline=function(d,a){a=h.getInfo(a);if(!a)return null;
const [c,f]=a.valid;return d[2]>f?[t.create([d[0],d[1],f,d[3]]),t.create([c,d[1],c+d[2]-f,d[3]])]:d[0]<c?[t.create([c,d[1],d[2],d[3]]),t.create([f-(c-d[0]),d[1],f,d[3]])]:null};m.isMarkerSymbol=function(d){return"simple-marker"===d||"picture-marker"===d||"esriSMS"===d||"esriPMS"===d};m.isTextSymbol=function(d){return"text"===d||"esriTS"===d};m.polygonFromExtent=function(d){if(!d)return null;const {xmin:a,ymin:c,xmax:f,ymax:g,spatialReference:n}=d;return new u({rings:[[[a,c],[a,g],[f,g],[f,c],[a,c]]],
spatialReference:n})};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/rendererUtils":function(){define("exports ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/screenUtils ../../../../webgl/capabilities".split(" "),function(m,p,D,B,u,t){function h(d){return("size"===d.type||"color"===d.type||"opacity"===d.type)&&null!=d.stops}function l(d){var a=d.type;var c=d.stops??[];if(8>=c.length)a=c;else if(b.warn(`Found ${c.length} Visual Variable stops, but MapView only supports ${8}. Displayed stops will be simplified.`),
16<c.length){const [y,...A]=c;var f=A.pop(),g=A[0].value,n=A[A.length-1].value,k=(n-g)/6;const w=[];for(;g<n;g+=k){for(var x=0;g>=A[x].value;)x++;var r=A[x],v=c[x-1],q=g-v.value;r=r.value===v.value?1:q/(r.value-v.value);"color"===a?(v=A[x],x=c[x-1],q=v.color.clone(),q.r=(1-r)*x.color.r+r*q.r,q.g=(1-r)*x.color.g+r*q.g,q.b=(1-r)*x.color.b+r*q.b,q.a=(1-r)*x.color.a+r*q.a,w.push({value:g,color:q,label:v.label})):"size"===a?(v=A[x],q=c[x-1],x=u.toPt(v.size),q=u.toPt(q.size),w.push({value:g,size:(1-r)*
q+r*x,label:v.label})):(v=A[x],w.push({value:g,opacity:(1-r)*c[x-1].opacity+r*v.opacity,label:v.label}))}a=[y,...w,f]}else{const [y,...A]=c;for(a=A.pop();6<A.length;){f=c=0;for(n=1;n<A.length;n++)k=Math.abs(A[n].value-A[n-1].value),k>f&&(f=k,c=n);A.splice(c,1)}a=[y,...A,a]}d.stops=a;return d}function e(){if(D("heatmap-force-raster"))return"raster";const {supportsTextureFloat:d,supportsTextureHalfFloat:a,supportsColorBufferFloat:c,supportsColorBufferFloatBlend:f,supportsColorBufferHalfFloat:g}=t.getWebGLCapabilities("2d");
return d&&c&&f||a&&g?"symbol":D("heatmap-allow-raster-fallback")?"raster":"none"}const b=B.getLogger("esri.views.2d.layers.features.support.rendererUtils");m.getSupportedHeatmapRenderer=e;m.isRendererSupported=function(d){if(!d)return!0;switch(d.type){case "dot-density":if(!t.getWebGLCapabilities("2d").supportsTextureFloat)return b.error(new p("webgl-missing-extension","Missing WebGL extension OES_Texture_Float which is required for DotDensity")),!1;break;case "heatmap":if(d=e(),"none"===d||"raster"===
d&&!D("heatmap-force-raster")){const a=t.getWebGLCapabilities("2d"),c=["supportsTextureFloat","supportsTextureHalfFloat","supportsColorBufferFloat","supportsColorBufferFloatBlend","supportsColorBufferHalfFloat"].filter(f=>!a[f]).join(", ");if("none"===d)return b.errorOnce(new p("webgl-missing-extension",`Missing WebGL${a.type} requirements for Heatmap: ${c}`)),!1;"raster"===d&&b.warnOnce(`Missing WebGL${a.type} requirements for accelerated Heatmap: ${c}. Feature support may be limited.`)}}return!0};
m.simplifyVVRenderer=d=>{if(!("visualVariables"in d&&d.visualVariables&&d.visualVariables.length))return d;d=d.clone();const a=d.visualVariables.map(c=>h(c)?l(c):c);d.visualVariables=a;return d};m.simplifyVisualVariables=function(d){return d.map(a=>h(a)?l(a.clone()):a)};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/support/util":function(){define(["exports","../../../../core/jsonMap"],function(m,p){const D=new p.JSONMap({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",
esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});m.analyzeRings=function(B,u,t){const h=[],l=[];let e=0,b=0;for(const d of B){B=b;let a=d[0][0],c=d[0][1];h[b++]=a;h[b++]=c;let f=0;for(let g=1;g<d.length;++g){const n=a,k=c;a=d[g][0];c=d[g][1];f+=c*n-a*k;h[b++]=a;h[b++]=c}u(f/2);0<f?(0<B-e&&(t(e,B,h,l),e=B),l.length=0):0>f?0<B-e?l.push(.5*(B-e)):b=B:b=B}0<b-e&&t(e,b,h,l)};m.canUseMajorityInterpolationOnDataSource=function(B){const {bandCount:u,
attributeTable:t,colormap:h,pixelType:l}=B.raster.rasterInfo;return 1===u&&(null!=t||null!=h||"u8"===l||"s8"===l)};m.toJSONGeometryType=function(B){return D.toJSON(B)};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/AttributeStore":function(){define("require ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/accessorSupport/diffUtils ../../../../../layers/support/FieldsIndex ../../../engine/webgl/definitions ../../../engine/webgl/DisplayId ../../../engine/webgl/Utils ../../../engine/webgl/util/debug ../tileRenderers/support/visualVariablesUtils ../../../../webgl/enums".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d,a,c,f,g,n){function k(A,w){return z=>w(A(z))}const x=u.getLogger("esri.views.layers.2d.features.support.AttributeStore"),r=f.createDebugLogger(f.DEBUG_ATTR_UPDATES,x);var v=B("esri-shared-array-buffer"),q=B("esri-atomics");let y=function(){function A(z,C,E,F){this.size=0;this.texelSize=4;this.dirtyEnd=this.dirtyStart=0;const {pixelType:G,layout:H,textureOnly:L}=F;this.textureOnly=L||!1;this.pixelType=G;this._ctype=C;this.layout=H;this._resetRange();this._shared=z;this.size=
E;L||(this.data=this._initData(G,E,z,C))}var w=A.prototype;w.unsetComponentAllTexels=function(z,C){const E=h.unwrap(this.data);for(let F=0;F<this.size*this.size;F++)E[F*this.texelSize+z]&=~C;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};w.setComponentAllTexels=function(z,C){const E=h.unwrap(this.data);for(let F=0;F<this.size*this.size;F++)E[F*this.texelSize+z]|=255&C;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};w.setComponent=function(z,C,E){const F=h.unwrap(this.data);for(const G of E)F[G*
this.texelSize+z]|=C,this.dirtyStart=Math.min(this.dirtyStart,G),this.dirtyEnd=Math.max(this.dirtyEnd,G)};w.setComponentTexel=function(z,C,E){h.unwrap(this.data)[E*this.texelSize+z]|=C;this.dirtyStart=Math.min(this.dirtyStart,E);this.dirtyEnd=Math.max(this.dirtyEnd,E)};w.unsetComponentTexel=function(z,C,E){h.unwrap(this.data)[E*this.texelSize+z]&=~C;this.dirtyStart=Math.min(this.dirtyStart,E);this.dirtyEnd=Math.max(this.dirtyEnd,E)};w.getData=function(z,C){z=a.getDisplayIdTexel(z);return h.unwrap(this.data)[z*
this.texelSize+C]};w.setData=function(z,C,E){z=a.getDisplayIdTexel(z);0===(this.layout&1<<C)?x.error("mapview-attributes-store","Tried to set a value for a texel's readonly component"):h.isNone(this.data)||(this.data[z*this.texelSize+C]=E,this.dirtyStart=Math.min(this.dirtyStart,z),this.dirtyEnd=Math.max(this.dirtyEnd,z))};w.lock=function(){this.pixelType===n.PixelType.UNSIGNED_BYTE&&this._shared&&q&&"local"!==this._ctype&&Atomics.store(this.data,0,1)};w.unlock=function(){this.pixelType===n.PixelType.UNSIGNED_BYTE&&
this._shared&&q&&"local"!==this._ctype&&Atomics.store(this.data,0,0)};w.expand=function(z){this.size=z;if(!this.textureOnly){z=this._initData(this.pixelType,z,this._shared,this._ctype);const C=h.unwrap(this.data);z.set(C);this.data=z}};w.toMessage=function(){const z=this.dirtyStart,C=this.dirtyEnd;var E=this.texelSize;if(z>C)return null;this._resetRange();const F=!this._shared&&"local"!==this._ctype,G=this.pixelType,H=this.layout,L=h.unwrap(this.data);E=F&&L.slice(z*E,(C+1)*E)||null;return{start:z,
end:C,data:E,pixelType:G,layout:H}};w._initData=function(z,C,E,F){E=E&&"local"!==F?SharedArrayBuffer:ArrayBuffer;z=c.getPixelArrayCtor(z);C=new z(new E(C*C*4*z.BYTES_PER_ELEMENT));for(z=0;z<C.length;z+=4)C[z+1]=255;return C};w._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};p._createClass(A,[{key:"buffer",get:function(){return h.applySome(this.data,z=>z.buffer)}}]);return A}();return function(){function A(z,C,E=()=>{}){this._client=z;this.config=C;this._notifyChange=E;this._blocks=
[];this._filters=Array(d.MAX_FILTERS);this._attributeComputeInfo=null;this._targetType=0;this._abortController=new AbortController;this._hasScaleExpr=!1;this._size=32;this._currUpdate=this._nextUpdate=null;this._idsToHighlight=new Set;z=C.supportsTextureFloat?n.PixelType.FLOAT:n.PixelType.UNSIGNED_BYTE;r(`Creating AttributeStore ${v?"with":"without"} shared memory`);this._blockDescriptors=[{pixelType:n.PixelType.UNSIGNED_BYTE,layout:1},{pixelType:n.PixelType.UNSIGNED_BYTE,layout:15,textureOnly:!0},
{pixelType:n.PixelType.UNSIGNED_BYTE,layout:15,textureOnly:!0},{pixelType:z,layout:15},{pixelType:z,layout:15},{pixelType:z,layout:15},{pixelType:z,layout:15}];this._blocks=this._blockDescriptors.map(()=>null)}var w=A.prototype;w.destroy=function(){this._abortController.abort()};w.isUpdating=function(){return!!this._currUpdate||!!this._nextUpdate};w.update=function(z,C){this.config=C;C=C.schema.processors[0].storage;const E=e.diff(this._schema,C);if(z.targets.feature||z.targets.aggregate)z.storage.data=
!0;if(E&&(B("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:",E),z.storage.data=!0,this._schema=C,this._attributeComputeInfo=null,!h.isNone(C))){switch(C.target){case "feature":this._targetType=a.DISPLAY_ID_TYPE_FEATURE;break;case "aggregate":this._targetType=a.DISPLAY_ID_TYPE_AGGREGATE}if("subtype"===C.type){this._attributeComputeInfo={isSubtype:!0,subtypeField:C.subtypeField,map:new Map};for(const F in C.mapping)if(z=C.mapping[F],h.isSome(z)&&h.isSome(z.vvMapping))for(const G of z.vvMapping)this._bindAttribute(G,
parseInt(F,10))}else{this._attributeComputeInfo={isSubtype:!1,map:new Map};if(h.isSome(C.vvMapping))for(const F of C.vvMapping)this._bindAttribute(F);if(h.isSome(C.attributeMapping))for(const F of C.attributeMapping)this._bindAttribute(F)}}};w.onTileData=function(z,C){if(!h.isNone(C.addOrUpdate))for(z=C.addOrUpdate.getCursor();z.next();)C=z.getDisplayId(),this.setAttributeData(C,z)};w.setHighlight=function(){var z=p._asyncToGenerator(function*(C,E){const F=this._getBlock(0);E=E.map(G=>a.getDisplayIdTexel(G));
F.lock();F.unsetComponentAllTexels(0,1);F.setComponent(0,1,E);F.unlock();this._idsToHighlight.clear();for(const G of C)this._idsToHighlight.add(G);yield this.sendUpdates()});return function(C,E){return z.apply(this,arguments)}}();w.updateFilters=function(){var z=p._asyncToGenerator(function*(C,E,F){const {service:G,spatialReference:H}=F;({filters:E}=E);E=E.map((L,K)=>this._updateFilter(L,K,G,H));(yield Promise.all(E)).some(L=>L)&&(C.storage.filters=!0,B("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:",
"Filters changed"))});return function(C,E,F){return z.apply(this,arguments)}}();w.setData=function(z,C,E,F){const G=a.getDisplayIdTexel(z);this._ensureSizeForTexel(G);this._getBlock(C).setData(z,E,F)};w.getData=function(z,C,E){return this._getBlock(C).getData(z,E)};w.getHighlightFlag=function(z){return this._idsToHighlight.has(z)?d.HIGHLIGHT_FLAG:0};w.unsetAttributeData=function(z){z=a.getDisplayIdTexel(z);this._getBlock(0).setData(z,0,0)};w.setAttributeData=function(z,C){const E=a.getDisplayIdTexel(z);
this._ensureSizeForTexel(E);this._getBlock(0).setData(E,0,this.getFilterFlags(C));if(this._targetType===a.getDisplayIdType(z)){z=this._attributeComputeInfo;var F=this.config.supportsTextureFloat?1:2,G=null;z&&(G=z.isSubtype?z.map.get(C.readAttribute(z.subtypeField)):z.map)&&G.size&&G.forEach((H,L)=>{const K=L*F%4;L=this._getBlock(Math.floor(L*F/4)+d.ATTRIBUTE_DATA_VV);H=H(C);if(this.config.supportsTextureFloat)L.setData(E,K,H);else if(H===d.NAN_MAGIC_NUMBER)L.setData(E,K,255),L.setData(E,K+1,255);
else{H=t.clamp(Math.round(H),-32767,32766)+32768;const M=(H&65280)>>8;L.setData(E,K,H&255);L.setData(E,K+1,M)}})}};w.sendUpdates=function(){B("esri-2d-update-debug")&&console.debug("AttributeStore::sendUpdate");this._notifyChange();if(this._nextUpdate)return this._nextUpdate.promise;if(this._currUpdate)return this._nextUpdate=l.createResolver(),this._nextUpdate.promise;const z={blocks:this._blocks.map(C=>h.isSome(C)?C.toMessage():null)};return this._currUpdate=this._createResources().then(()=>{var C=
()=>{this._currUpdate=null;if(this._nextUpdate){const E=this._nextUpdate;this._nextUpdate=null;this.sendUpdates().then(()=>E.resolve())}else B("esri-2d-update-debug")&&console.debug("AttributeStore::sendUpdate::No additional updates queued");this._notifyChange()};B("esri-2d-update-debug")&&console.debug("AttributeStore::sendUpdate::client.update");C=this._client.update(z,this._signal).then(C).catch(C);this._client.render(this._signal);return C}).catch(C=>{if(l.isAbortError(C))return this._createResourcesPromise=
null,this._createResources();this._notifyChange();x.error(new D("mapview-attribute-store","Encountered an error during client update",C))})};w._ensureSizeForTexel=function(z){for(;z>=this._size*this._size&&!this._expand(););};w._bindAttribute=function(z,C){function E(){const {normalizationField:M}=z;return M?U=>{const T=U.readAttribute(M);return T?U.readAttribute(z.field)/T:null}:U=>U.readAttribute(z.field)}function F(){z.normalizationField&&x.warn("mapview-arcade","Ignoring normalizationField specified with an arcade expression which is not supported.");
return M=>M.getComputedNumericAtIndex(z.fieldIndex)}let G;if(null!=z.fieldIndex)G=F();else if(z.field)G=E();else return;const {valueRepresentation:H}=z;H&&(G=k(G,M=>g.getVisualVariableSizeValueRepresentationRatio(M,H)));const L=M=>null===M||isNaN(M)||Infinity===M||-Infinity===M?d.NAN_MAGIC_NUMBER:M,K=this._attributeComputeInfo;if(K.isSubtype){const M=K.map.get(C)??new Map;M.set(z.binding,k(G,L));K.map.set(C,M)}else K.map.set(z.binding,k(G,L))};w._createResources=function(){if(h.isSome(this._createResourcesPromise))return this._createResourcesPromise;
this._getBlock(d.ATTRIBUTE_DATA_ANIMATION);this._getBlock(d.ATTRIBUTE_DATA_GPGPU);r("Initializing AttributeStore");var z={shared:v&&"local"!==this._client.type,size:this._size,blocks:h.mapMany(this._blocks,C=>({textureOnly:C.textureOnly,buffer:C.buffer,pixelType:C.pixelType}))};this._createResourcesPromise=z=this._client.initialize(z,this._signal).catch(C=>{l.isAbortError(C)?this._createResourcesPromise=null:x.error(new D("mapview-attribute-store","Encountered an error during client initialization",
C))});z.then(()=>h.isNone(this._createResourcesPromise)?this._createResources():void 0);return z};w._getBlock=function(z){var C=this._blocks[z];if(h.isSome(C))return C;r(`Initializing AttributeBlock at index ${z}`);C=new y(v,this._client.type,this._size,this._blockDescriptors[z]);this._blocks[z]=C;this._createResourcesPromise=null;return C};w._expand=function(){if(this._size<this.config.maxTextureSize){const z=this._size<<=1;r("Expanding block size to",z,this._blocks);h.forEachSome(this._blocks,C=>
C.expand(z));this._createResourcesPromise=null;this._size=z;return 0}x.error(new D("mapview-limitations","Maximum number of onscreen features exceeded."));return-1};w._updateFilter=function(){var z=p._asyncToGenerator(function*(C,E,F,G){const H=this._filters[E],L=h.isSome(H)&&H.hash;if(!H&&!C||L===JSON.stringify(C))return!1;if(h.isNone(C)){if(!H)return!1;C=1<<E+1;F=this._getBlock(0);this._filters[E]=null;F.setComponentAllTexels(0,C);this.sendUpdates();return!0}yield(yield this._getFilter(E,F)).update(C,
G);return!0});return function(C,E,F,G){return z.apply(this,arguments)}}();w._getFilter=function(){var z=p._asyncToGenerator(function*(C,E){var F=this._filters[C];if(h.isSome(F))return F;({default:F}=yield new Promise((G,H)=>m(["./FeatureFilter"],L=>G(Object.freeze(Object.defineProperty({__proto__:null,default:L},Symbol.toStringTag,{value:"Module"}))),H)));E=new F({geometryType:E.geometryType,hasM:!1,hasZ:!1,timeInfo:E.timeInfo,fieldsIndex:new b(E.fields)});return this._filters[C]=E});return function(C,
E){return z.apply(this,arguments)}}();w.isVisible=function(z){return!!(this._getBlock(0).getData(z,0)&2)};w.getFilterFlags=function(z){let C=0;var E=a.getDisplayIdFilterMask(z.getDisplayId());for(let G=0;G<this._filters.length;G++){var F=this._filters[G];F=!(E&1<<G)||h.isNone(F)||F.check(z);C|=(F?1:0)<<G}E=0;this._idsToHighlight.size&&(z=z.getObjectId(),E=this.getHighlightFlag(z));return C<<1|E};p._createClass(A,[{key:"hasScaleExpr",get:function(){return this._hasScaleExpr}},{key:"_signal",get:function(){return this._abortController.signal}},
{key:"hasHighlight",get:function(){return 0<this._idsToHighlight.size}}]);return A}()})},"esri/views/2d/engine/webgl/util/debug":function(){define(["exports"],function(m){m.DEBUG_ATTR_UPDATES=!1;m.createDebugLogger=(p,D)=>p&&((...B)=>D.warn("DEBUG:",...B))||(()=>null);Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/tileRenderers/support/visualVariablesUtils":function(){define("exports ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../engine/webgl/color ../../../../engine/webgl/definitions ../../../../engine/webgl/enums ../../../../engine/webgl/visualVariablesUtils".split(" "),
function(m,p,D,B,u,t,h){function l(g){return{value:g.value,size:D.toPt(g.size)}}function e(g){return(g??[]).map(n=>l(n))}function b(g){return"string"===typeof g||"number"===typeof g?D.toPt(g):{type:"size",expression:g.expression,stops:e(g.stops)}}function d(g){const n={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if("string"===typeof g.field)if(g.stops){if(8<g.stops.length)return null;g=g.stops;for(var k=0;8>k;++k){const x=g[Math.min(k,g.length-1)];n.values[k]=x.value;n.opacities[k]=x.opacity}}else return null;
else if(g.stops&&0<=g.stops.length)for(g=g.stops&&0<=g.stops.length?g.stops[0].opacity:0,k=0;8>k;k++)n.values[k]=Infinity,n.opacities[k]=g;else return null;return n}function a(g,n,k){g[4*n]=k.r/255;g[4*n+1]=k.g/255;g[4*n+2]=k.b/255;g[4*n+3]=k.a}function c(g){if(p.isNone(g)||g.normalizationField)return null;const n={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};if("string"===typeof g.field)if(g.stops){if(8<g.stops.length)return null;n.field=
g.field;g=g.stops;for(var k=0;8>k;++k){const x=g[Math.min(k,g.length-1)];n.values[k]=x.value;a(n.colors,k,x.color)}}else return null;else if(g.stops&&0<=g.stops.length)for(g=g.stops&&0<=g.stops.length&&g.stops[0].color,k=0;8>k;k++)n.values[k]=Infinity,a(n.colors,k,g);else return null;for(g=0;32>g;g+=4)B.premultiplyAlpha(n.colors,g,!0);return n}const f=g=>{const n=[],k=[];g=e(g);const x=g.length;for(let r=0;6>r;r++){const v=g[Math.min(r,x-1)];n.push(v.value);k.push(null==v.size?u.NAN_MAGIC_NUMBER:
D.pt2px(v.size))}return{values:new Float32Array(n),sizes:new Float32Array(k)}};m.convertColorVariable=c;m.convertVisualVariables=function(g){const n=g&&0<g.length?{}:null,k=n?{}:null;if(!n||!k)return{vvFields:n,vvRanges:k};for(const x of g)if(x.field&&(n[x.type]=x.field),"size"===x.type)switch(k.size||(k.size={}),g=x,h.getTypeOfSizeVisualVariable(g)){case t.WGLVVFlag.SIZE_MINMAX_VALUE:k.size.minMaxValue={minDataValue:g.minDataValue,maxDataValue:g.maxDataValue,minSize:b(g.minSize),maxSize:b(g.maxSize)};
break;case t.WGLVVFlag.SIZE_SCALE_STOPS:k.size.scaleStops={stops:e(g.stops)};break;case t.WGLVVFlag.SIZE_FIELD_STOPS:if(g.levels){const r={};for(const v in g.levels)r[v]=f(g.levels[v]);k.size.fieldStops={type:"level-dependent",levels:r}}else k.size.fieldStops={type:"static",...f(g.stops)};break;case t.WGLVVFlag.SIZE_UNIT_VALUE:k.size.unitValue={unit:g.valueUnit,valueRepresentation:g.valueRepresentation??void 0}}else"color"===x.type?k.color=c(x):"opacity"===x.type?k.opacity=d(x):"rotation"===x.type&&
(k.rotation={type:x.rotationType});return{vvFields:n,vvRanges:k}};m.getVisualVariableSizeValueRepresentationRatio=function(g,n){if(!g||!n)return g;switch(n){case "radius":case "distance":return 2*g;case "area":return Math.sqrt(g)}return g};m.normalizeSizeElement=b;m.normalizeSizeStops=e;m.stopToSizeStop=l;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/ComputedAttributeStorage":function(){define(["exports","../../../engine/webgl/DisplayId","./DisplayIdGenerator",
"./StaticBitSet"],function(m,p,D,B){function u(h,l,e){if(!(h.length>l))for(;h.length<=l;)h.push(e)}let t=function(){function h(){this._numerics=[];this._strings=[];this._idGenerator=new D.DisplayIdGenerator;this._allocatedSize=256;this._bitsets=[];this._instanceIds=[];this._bounds=[]}var l=h.prototype;l.createBitset=function(){const e=this._bitsets.length;this._bitsets.push(B.StaticBitSet.create(this._allocatedSize,p.DISPLAY_ID_TEXEL_MASK));return e+1};l.getBitset=function(e){return this._bitsets[e-
1]};l._expand=function(){this._allocatedSize<<=1;for(const e of this._bitsets)e.resize(this._allocatedSize)};l._ensureNumeric=function(e,b){this._numerics[e]||(this._numerics[e]=[]);u(this._numerics[e],b,0)};l._ensureInstanceId=function(e){u(this._instanceIds,e,0)};l._ensureString=function(e,b){this._strings[e]||(this._strings[e]=[]);u(this._strings[e],b,null)};l.createDisplayId=function(e=!1){const b=this._idGenerator.createId();b>this._allocatedSize&&this._expand();return p.createDisplayId(b,e)};
l.releaseDisplayId=function(e){for(const b of this._bitsets)b.unset(e);return this._idGenerator.releaseId(e&p.DISPLAY_ID_TEXEL_MASK)};l.getComputedNumeric=function(e,b){return this.getComputedNumericAtIndex(e&p.DISPLAY_ID_TEXEL_MASK,0)};l.setComputedNumeric=function(e,b,d){return this.setComputedNumericAtIndex(e&p.DISPLAY_ID_TEXEL_MASK,d,0)};l.getComputedString=function(e,b){return this.getComputedStringAtIndex(e&p.DISPLAY_ID_TEXEL_MASK,0)};l.setComputedString=function(e,b,d){return this.setComputedStringAtIndex(e&
p.DISPLAY_ID_TEXEL_MASK,0,d)};l.getComputedNumericAtIndex=function(e,b){e&=p.DISPLAY_ID_TEXEL_MASK;this._ensureNumeric(b,e);return this._numerics[b][e]};l.setComputedNumericAtIndex=function(e,b,d){e&=p.DISPLAY_ID_TEXEL_MASK;this._ensureNumeric(b,e);this._numerics[b][e]=d};l.getInstanceId=function(e){e&=p.DISPLAY_ID_TEXEL_MASK;this._ensureInstanceId(e);return this._instanceIds[e]};l.setInstanceId=function(e,b){e&=p.DISPLAY_ID_TEXEL_MASK;this._ensureInstanceId(e);this._instanceIds[e]=b};l.getComputedStringAtIndex=
function(e,b){e&=p.DISPLAY_ID_TEXEL_MASK;this._ensureString(b,e);return this._strings[b][e]};l.setComputedStringAtIndex=function(e,b,d){e&=p.DISPLAY_ID_TEXEL_MASK;this._ensureString(b,e);this._strings[b][e]=d};l.getXMin=function(e){return this._bounds[4*(e&p.DISPLAY_ID_TEXEL_MASK)]};l.getYMin=function(e){return this._bounds[4*(e&p.DISPLAY_ID_TEXEL_MASK)+1]};l.getXMax=function(e){return this._bounds[4*(e&p.DISPLAY_ID_TEXEL_MASK)+2]};l.getYMax=function(e){return this._bounds[4*(e&p.DISPLAY_ID_TEXEL_MASK)+
3]};l.setBounds=function(e,b){b=b.readHydratedGeometry();if(!b||!b.coords.length)return!1;let d=Infinity,a=Infinity,c=-Infinity,f=-Infinity;b.forEachVertex((g,n)=>{d=Math.min(d,g);a=Math.min(a,n);c=Math.max(c,g);f=Math.max(f,n)});e&=p.DISPLAY_ID_TEXEL_MASK;u(this._bounds,4*e+4,0);this._bounds[4*e]=d;this._bounds[4*e+1]=a;this._bounds[4*e+2]=c;this._bounds[4*e+3]=f;return!0};return h}();m.ComputedAttributeStorage=t;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/DisplayIdGenerator":function(){define(["exports",
"../../../engine/webgl/DisplayId"],function(m,p){let D=function(){function B(){this._freeIds=[];this._idCounter=1}var u=B.prototype;u.createId=function(t=!1){return p.createDisplayId(this._getFreeId(),t)};u.releaseId=function(t){this._freeIds.push(t)};u._getFreeId=function(){return this._freeIds.length?this._freeIds.pop():this._idCounter++};return B}();m.DisplayIdGenerator=D;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/GraphicsReader":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry/support/jsonUtils ../../../../../layers/graphics/featureConversionUtils ./FeatureSetReader ./FeatureSetReaderJSON".split(" "),
function(m,p,D,B,u,t){t=function(h){function l(b,d,a){b=h.call(this,b,d,null)||this;b._transform=a;return b}p._inheritsLoose(l,h);l.from=function(b,d,a){const c=u.FeatureSetReader.createInstance(),f=[];b=b.filter(g=>!!g.geometry);for(const g of b)b=D.getJsonType(g.geometry),B.convertFromGraphics(f,[g],b,!1,!1,d);return new l(c,f,a)};var e=l.prototype;e.readGraphic=function(){return this._current};e.getCursor=function(){return this.copy()};e.copy=function(){const b=new l(this.instance,this._features,
this._transform);this.copyInto(b);return b};p._createClass(l,[{key:"geometryType",get:function(){const b=this._current;return b?b.geometryType:null}},{key:"insertAfter",get:function(){return this._current.insertAfter}}]);return l}(t.FeatureSetReaderJSON);m.GraphicsReader=t;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/FeatureSetReader":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry ../../../../../arcade/ArcadeDate ../../../../../arcade/arcadeTimeUtils ../../../../../core/has ../../../../../core/maybe ../../../../../layers/graphics/centroid ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedGeometry ./StaticBitSet ../../../../../geometry/support/jsonUtils".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d,a){let c=0;D=t("featurelayer-simplify-thresholds")??[.5,.5,.5,.5];const f=D[0],g=D[1],n=D[2],k=D[3];D=t("featurelayer-simplify-payload-size-factors")??[1,2,4];const x=D[0],r=D[1],v=D[2],q=t("featurelayer-simplify-mobile-factor")??2,y=t("esri-mobile");t=function(){function A(z,C){this.type="FeatureSetReader";this.arcadeDeclaredClass="esri.arcade.Feature";this.seen=!1;this._ty=this._tx=this.instance=0;this._sy=this._sx=1;this._deleted=null;this._joined=[];this._objectIdToIndex=
null;this._level=0;this.contextTimeReference=this._datetimeMetadata=null;this.instance=z;this._layerSchema=C}A.createInstance=function(){c++;return c=65535<c?0:c};var w=A.prototype;w.getAreaSimplificationThreshold=function(z,C){let E=1;const F=y?q:1;4E6<C?E=v*F:1E6<C?E=r*F:5E5<C?E=x*F:1E5<C&&(E=F);C=0;4E3<z?C=k*E:2E3<z?C=n*E:100<z?C=g:15<z&&(C=f);z=8;4>this._level?z=1:5>this._level?z=2:6>this._level&&(z=4);return C*z};w.createQuantizedExtrudedQuad=function(z,C){return new b([5],[z-1,C,1,-1,1,1,-1,
1,-1,-1])};w.setArcadeSpatialReference=function(z){this._arcadeSpatialReference=z};w.attachStorage=function(z){this._storage=z};w.getQuantizationTransform=function(){throw Error("Unable to find transform for featureSet");};w.getStorage=function(){return this._storage};w.getComputedNumeric=function(z){return this.getComputedNumericAtIndex(0)};w.setComputedNumeric=function(z,C){return this.setComputedNumericAtIndex(C,0)};w.getComputedString=function(z){return this.getComputedStringAtIndex(0)};w.setComputedString=
function(z,C){return this.setComputedStringAtIndex(0,C)};w.getComputedNumericAtIndex=function(z){return this._storage.getComputedNumericAtIndex(this.getDisplayId(),z)};w.setComputedNumericAtIndex=function(z,C){this._storage.setComputedNumericAtIndex(this.getDisplayId(),z,C)};w.getComputedStringAtIndex=function(z){return this._storage.getComputedStringAtIndex(this.getDisplayId(),z)};w.setComputedStringAtIndex=function(z,C){return this._storage.setComputedStringAtIndex(this.getDisplayId(),z,C)};w.transform=
function(z,C,E,F){const G=this.copy();G._tx+=z;G._ty+=C;G._sx*=E;G._sy*=F;return G};w.readAttribute=function(z,C=!1){var E=this._readAttribute(z,C);if(void 0!==E)return E;for(const F of this._joined)if(F.setIndex(this.getIndex()),E=F._readAttribute(z,C),void 0!==E)return E};w.readAttributes=function(){const z=this._readAttributes();for(const C of this._joined){C.setIndex(this.getIndex());const E=C._readAttributes();for(const F of Object.keys(E))z[F]=E[F]}return z};w.joinAttributes=function(z){this._joined.push(z)};
w.readArcadeFeature=function(){return this};w.geometry=function(){var z=this.readHydratedGeometry();z=e.convertToGeometry(z,this.geometryType,this.hasZ,this.hasM);if(z=a.fromJSON(z))z.spatialReference=this._arcadeSpatialReference;return z};w.autocastArcadeDate=function(z,C){return C&&C instanceof Date?this.isUnknownDateTimeField(z)?B.ArcadeDate.unknownDateJSToArcadeDate(C):B.ArcadeDate.dateJSAndZoneToArcadeDate(C,this.contextTimeReference?.timeZone??"system"):C};w.isUnknownDateTimeField=function(z){return"unknown"===
this.dateTimeReferenceFieldIndex?.fieldTimeZone(z)};w.fieldSourceTimeZone=function(z){return this.dateTimeReferenceFieldIndex?.fieldTimeZone(z)??""};w.field=function(z){if(this.hasField(z))return this.autocastArcadeDate(z,this.readAttribute(z,!0));for(var C of this._joined)if(C.setIndex(this.getIndex()),C.hasField(z))return C=C._readAttribute(z,!0),this.autocastArcadeDate(z,C);throw Error(`Field ${z} does not exist`);};w.setField=function(z,C){throw Error("Unable to update feature attribute values, feature is readonly");
};w.keys=function(){return this.getFieldNames()};w.castToText=function(z=!1){if(!z)return JSON.stringify(this.readLegacyFeature());z=this.readLegacyFeature();if(!z)return JSON.stringify(null);z={geometry:z.geometry,attributes:{...(z.attributes?z.attributes:{})}};for(const C in z.attributes){const E=z.attributes[C];E instanceof Date&&(z.attributes[C]=E.getTime())}return JSON.stringify(z)};w.gdbVersion=function(){return null};w.fullSchema=function(){return this._layerSchema};w.castAsJson=function(z=
null){return{attributes:this._readAttributes(),geometry:!0===z?.keepGeometryType?this.geometry():this.geometry()?.toJSON()??null}};w.castAsJsonAsync=function(z,C=null){return Promise.resolve(this.castAsJson(C))};w.removeIds=function(z){if(h.isNone(this._objectIdToIndex)){var C=new Map;const E=this.getCursor();for(;E.next();){const F=h.unwrapOrThrow(E.getObjectId());C.set(F,E.getIndex())}this._objectIdToIndex=C}C=this._objectIdToIndex;for(const E of z)C.has(E)&&this.removeAtIndex(C.get(E))};w.removeAtIndex=
function(z){h.isNone(this._deleted)&&(this._deleted=d.StaticBitSet.create(this.getSize()));this._deleted.set(z)};w.readGeometryForDisplay=function(){return this.readUnquantizedGeometry(!0)};w.readLegacyGeometryForDisplay=function(){return this.readLegacyGeometry(!0)};w.features=function*(){const z=this.getCursor();for(;z.next();)yield z.readOptimizedFeature()};w._getExists=function(){return h.isNone(this._deleted)||!this._deleted.has(this.getIndex())};w._computeCentroid=function(){if("esriGeometryPolygon"!==
this.geometryType)return null;const z=this.readUnquantizedGeometry();if(!z||z.hasIndeterminateRingOrder)return null;const C=h.unwrapOr(this.getQuantizationTransform(),null);return l.getCentroidOptimizedGeometry(new b,z,this.hasM,this.hasZ,C)};w.copyInto=function(z){z.seen=this.seen;z._storage=this._storage;z._arcadeSpatialReference=this._arcadeSpatialReference;z._joined=this._joined;z._tx=this._tx;z._ty=this._ty;z._sx=this._sx;z._sy=this._sy;z._deleted=this._deleted;z._objectIdToIndex=this._objectIdToIndex};
p._createClass(A,[{key:"isEmpty",get:function(){return h.isSome(this._deleted)&&this._deleted.countSet()===this.getSize()}},{key:"level",set:function(z){this._level=z}},{key:"dateTimeReferenceFieldIndex",get:function(){return this._datetimeMetadata?this._datetimeMetadata:this._datetimeMetadata=u.DateTimeReferenceFieldIndex.create(this._layerSchema.fields,this._layerSchema)}},{key:"layerPreferredTimeZone",get:function(){return this.dateTimeReferenceFieldIndex?.layerPreferredTimeZone??""}}]);return A}();
m.FeatureSetReader=t;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/ArcadeDate":function(){define(["exports","../chunks/_rollupPluginBabelHelpers","./executionError","../chunks/datetime"],function(m,p,D,B){function u(b){if(b instanceof B.Zone)return b;if("system"===b.toLowerCase())return"system";if("utc"===b.toLowerCase())return"utc";if("unknown"===b.toLowerCase())return t.instance;if(/^[\+\-]?[0-9]{1,2}([:][0-9]{2})?$/.test(b)){const d=B.FixedOffsetZone.parseSpecifier("UTC"+
(b.startsWith("+")||b.startsWith("-")?"":"+")+b);if(d)return d}b=B.IANAZone.create(b);if(!b.isValid)throw new l(m.ArcadeDateErrorCodes.TimeZoneNotRecognised);return b}let t=function(){};t.instance=new B.IANAZone("Etc/UTC");m.ArcadeDateErrorCodes=void 0;(m.ArcadeDateErrorCodes||(m.ArcadeDateErrorCodes={})).TimeZoneNotRecognised="TimeZoneNotRecognised";const h={[m.ArcadeDateErrorCodes.TimeZoneNotRecognised]:"Timezone identifier has not been recognised."};let l=function(b){function d(a,c){a=b.call(this,
D.doSubstitutions(h[a],c))||this;a.declaredRootClass="esri.arcade.arcadedate.dateerror";Error.captureStackTrace&&Error.captureStackTrace(p._assertThisInitialized(a),d);return a}p._inheritsLoose(d,b);return d}(p._wrapNativeSuper(Error)),e=function(){function b(a){this._date=a;this.declaredRootClass="esri.arcade.arcadedate"}b.fromParts=function(a=0,c=1,f=1,g=0,n=0,k=0,x=0,r){if(isNaN(a)||isNaN(c)||isNaN(f)||isNaN(g)||isNaN(n)||isNaN(k)||isNaN(x))return null;let v=0;var q=B.DateTime.local(a,c).daysInMonth;
1>f&&(v=f-1,f=1);f>q&&(v=f-q,f=q);q=0;12<c?(q=c-12,c=12):1>c&&(q=c-1,c=1);let y=0;59<n?(y=n-59,n=59):0>n&&(y=n,n=0);let A=0;59<k?(A=k-59,k=59):0>k&&(A=k,k=0);let w=0;999<x?(w=x-999,x=999):0>x&&(w=x,x=0);a=B.DateTime.fromObject({day:f,year:a,month:c,hour:g,minute:n,second:k,millisecond:x},{zone:u(r)});0!==q&&(a=a.plus({months:q}));0!==v&&(a=a.plus({days:v}));0!==y&&(a=a.plus({minutes:y}));0!==A&&(a=a.plus({seconds:A}));0!==w&&(a=a.plus({milliseconds:w}));return new b(a)};b.arcadeDateAndZoneToArcadeDate=
function(a,c){const f=u(c);return a.isUnknownTimeZone||f===t.instance?b.fromParts(a.year,a.monthJS+1,a.day,a.hour,a.minute,a.second,a.millisecond,f):new b(a._date.setZone(c))};b.dateJSToArcadeDate=function(a){return new b(B.DateTime.fromJSDate(a,{zone:"system"}))};b.dateJSAndZoneToArcadeDate=function(a,c="system"){return new b(B.DateTime.fromJSDate(a,{zone:c}))};b.unknownEpochToArcadeDate=function(a){return new b(B.DateTime.fromMillis(a,{zone:t.instance}))};b.unknownDateJSToArcadeDate=function(a){return new b(B.DateTime.fromMillis(a.getTime(),
{zone:t.instance}))};b.epochToArcadeDate=function(a,c="system"){return new b(B.DateTime.fromMillis(a,{zone:c}))};b.dateTimeToArcadeDate=function(a){return new b(a)};var d=b.prototype;d.changeTimeZone=function(a){a=u(a);return b.dateTimeToArcadeDate(this._date.setZone(a))};b.dateTimeAndZoneToArcadeDate=function(a,c){c=u(c);return a.zone===t.instance||c===t.instance?b.fromParts(a.year,a.month,a.day,a.hour,a.minute,a.second,a.millisecond,c):new b(a.setZone(c))};b.nowToArcadeDate=function(a){return new b(B.DateTime.fromJSDate(new Date,
{zone:a}))};b.nowUTCToArcadeDate=function(){return new b(B.DateTime.utc())};d.equals=function(a){return this.isSystem&&a.isSystem?this.toNumber()===a.toNumber():this.isUnknownTimeZone!==a.isUnknownTimeZone?!1:this._date.equals(a._date)};d.stringify=function(){return JSON.stringify(this.toJSDate())};d.plus=function(a){return new b(this._date.plus(a))};d.diff=function(a,c="milliseconds"){return this._date.diff(a._date,c)[c]};d.toISOString=function(a){return a?this._date.toISO({suppressMilliseconds:!0,
includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})};d.toFormat=function(a,c){return this._date.toFormat(a,c)};d.toJSDate=function(){return this._date.toJSDate()};d.toSQLString=function(){return"timestamp '"+this._date.toFormat("yyyy-LL-dd HH:mm:ss")+"'"};d.toDateTime=function(){return this._date};d.toNumber=function(){return this._date.toMillis()};d.getTime=function(){return this._date.toMillis()};d.toUTC=function(){return new b(this._date.toUTC())};
d.toLocal=function(){return new b(this._date.toLocal())};d.toString=function(){return this.toISOString(!0)};p._createClass(b,[{key:"isSystem",get:function(){return"system"===this.timeZone||this.timeZone===b.systemTimeZoneCanonicalName}},{key:"isUnknownTimeZone",get:function(){return this._date.zone===t.instance}},{key:"isValid",get:function(){return this._date.isValid}},{key:"hour",get:function(){return this._date.hour}},{key:"second",get:function(){return this._date.second}},{key:"day",get:function(){return this._date.day}},
{key:"dayOfWeekISO",get:function(){return this._date.weekday}},{key:"dayOfWeekJS",get:function(){let a=this._date.weekday;6<a&&(a=0);return a}},{key:"millisecond",get:function(){return this._date.millisecond}},{key:"monthISO",get:function(){return this._date.month}},{key:"weekISO",get:function(){return this._date.weekNumber}},{key:"yearISO",get:function(){return this._date.weekYear}},{key:"monthJS",get:function(){return this._date.month-1}},{key:"year",get:function(){return this._date.year}},{key:"minute",
get:function(){return this._date.minute}},{key:"zone",get:function(){return this._date.zone}},{key:"timeZoneOffset",get:function(){return this.isUnknownTimeZone?0:this._date.offset}},{key:"timeZone",get:function(){if(this.isUnknownTimeZone)return"unknown";if("system"===this._date.zone.type)return"system";const a=this.zone;return"fixed"===a.type?0===a.fixed?"utc":a.formatOffset(0,"short"):a.name}}],[{key:"systemTimeZoneCanonicalName",get:function(){return Intl.DateTimeFormat().resolvedOptions().timeZone??
"system"}}]);return b}();m.ArcadeDate=e;m.ArcadeDateError=l;m.ArcadeDateErrorMessages=h;m.UnknownTimeZone=t;m.createDateTimeZone=u;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/executionError":function(){define(["exports","../chunks/_rollupPluginBabelHelpers"],function(m,p){function D(c){return c&&c.loc?`Line : ${c.loc.start?.line}, ${c.loc.start?.column}: `:""}function B(c,f){try{if(!f)return c;for(const g in f){let n=f[g];n||(n="");c=c.replace("{"+g+"}",f[g])}}catch(g){}return c}
m.ExecutionErrorCodes=void 0;(function(c){c.AsyncNotEnabled="AsyncNotEnabled";c.ModulesNotSupported="ModulesNotSupported";c.CircularModules="CircularModules";c.NeverReach="NeverReach";c.UnsupportedHashType="UnsupportedHashType";c.InvalidParameter="InvalidParameter";c.UnexpectedToken="UnexpectedToken";c.Unrecognised="Unrecognised";c.UnrecognisedType="UnrecognisedType";c.MaximumCallDepth="MaximumCallDepth";c.BooleanConditionRequired="BooleanConditionRequired";c.TypeNotAllowedInFeature="TypeNotAllowedInFeature";
c.KeyMustBeString="KeyMustBeString";c.WrongNumberOfParameters="WrongNumberOfParameters";c.CallNonFunction="CallNonFunction";c.NoFunctionInTemplateLiteral="NoFunctionInTemplateLiteral";c.NoFunctionInDictionary="NoFunctionInDictionary";c.NoFunctionInArray="NoFunctionInArray";c.AssignModuleFunction="AssignModuleFunction";c.LogicExpressionOrAnd="LogicExpressionOrAnd";c.LogicalExpressionOnlyBoolean="LogicalExpressionOnlyBoolean";c.FuncionNotFound="FunctionNotFound";c.InvalidMemberAccessKey="InvalidMemberAccessKey";
c.UnsupportedUnaryOperator="UnsupportUnaryOperator";c.InvalidIdentifier="InvalidIdentifier";c.MemberOfNull="MemberOfNull";c.UnsupportedOperator="UnsupportedOperator";c.Cancelled="Cancelled";c.ModuleAccessorMustBeString="ModuleAccessorMustBeString";c.ModuleExportNotFound="ModuleExportNotFound";c.Immutable="Immutable";c.OutOfBounds="OutOfBounds";c.IllegalResult="IllegalResult";c.FieldNotFound="FieldNotFound";c.PortalRequired="PortalRequired";c.LogicError="LogicError";c.ArrayAccessorMustBeNumber="ArrayAccessMustBeNumber";
c.KeyAccessorMustBeString="KeyAccessorMustBeString";c.WrongSpatialReference="WrongSpatialReference"})(m.ExecutionErrorCodes||(m.ExecutionErrorCodes={}));const u={[m.ExecutionErrorCodes.TypeNotAllowedInFeature]:"Feature attributes only support dates, numbers, strings, guids.",[m.ExecutionErrorCodes.LogicError]:"Logic error - {reason}",[m.ExecutionErrorCodes.NeverReach]:"Encountered unreachable logic",[m.ExecutionErrorCodes.AsyncNotEnabled]:"Async Arcade must be enabled for this script",[m.ExecutionErrorCodes.ModuleAccessorMustBeString]:"Module accessor must be a string",
[m.ExecutionErrorCodes.ModuleExportNotFound]:"Module has no export with provided identifier",[m.ExecutionErrorCodes.ModulesNotSupported]:"Current profile does not support modules",[m.ExecutionErrorCodes.ArrayAccessorMustBeNumber]:"Array accessor must be a number",[m.ExecutionErrorCodes.FuncionNotFound]:"Function not found",[m.ExecutionErrorCodes.FieldNotFound]:"Key not found - {key}",[m.ExecutionErrorCodes.CircularModules]:"Circular module dependencies are not allowed",[m.ExecutionErrorCodes.Cancelled]:"Execution cancelled",
[m.ExecutionErrorCodes.UnsupportedHashType]:"Type not supported in hash function",[m.ExecutionErrorCodes.IllegalResult]:"Value is not a supported return type",[m.ExecutionErrorCodes.PortalRequired]:"Portal is required",[m.ExecutionErrorCodes.InvalidParameter]:"Invalid parameter",[m.ExecutionErrorCodes.WrongNumberOfParameters]:"Call with wrong number of parameters",[m.ExecutionErrorCodes.Unrecognised]:"Unrecognised code structure",[m.ExecutionErrorCodes.UnrecognisedType]:"Unrecognised type",[m.ExecutionErrorCodes.WrongSpatialReference]:"Cannot work with geometry in this spatial reference. It is different to the execution spatial reference",
[m.ExecutionErrorCodes.BooleanConditionRequired]:"Conditions must use booleans",[m.ExecutionErrorCodes.NoFunctionInDictionary]:"Dictionaries cannot contain functions.",[m.ExecutionErrorCodes.NoFunctionInArray]:"Arrays cannot contain functions.",[m.ExecutionErrorCodes.NoFunctionInTemplateLiteral]:"Template Literals do not expect functions by value.",[m.ExecutionErrorCodes.KeyAccessorMustBeString]:"Accessor must be a string",[m.ExecutionErrorCodes.KeyMustBeString]:"Object keys must be a string",[m.ExecutionErrorCodes.Immutable]:"Object is immutable",
[m.ExecutionErrorCodes.InvalidParameter]:"Invalid parameter",[m.ExecutionErrorCodes.UnexpectedToken]:"Unexpected token",[m.ExecutionErrorCodes.MemberOfNull]:"Cannot access property of null object",[m.ExecutionErrorCodes.MaximumCallDepth]:"Exceeded maximum function depth",[m.ExecutionErrorCodes.OutOfBounds]:"Out of bounds",[m.ExecutionErrorCodes.InvalidIdentifier]:"Identifier not recognised",[m.ExecutionErrorCodes.FuncionNotFound]:"Function not found",[m.ExecutionErrorCodes.CallNonFunction]:"Expression is not a function",
[m.ExecutionErrorCodes.InvalidMemberAccessKey]:"Cannot access value using a key of this type",[m.ExecutionErrorCodes.AssignModuleFunction]:"Cannot assign function to module variable",[m.ExecutionErrorCodes.UnsupportedUnaryOperator]:"Unsupported unary operator",[m.ExecutionErrorCodes.UnsupportedOperator]:"Unsupported operator",[m.ExecutionErrorCodes.LogicalExpressionOnlyBoolean]:"Logical expressions must be boolean",[m.ExecutionErrorCodes.LogicExpressionOrAnd]:"Logical expression can only be combined with || or \x26\x26"};
let t=function(c){function f(...g){return c.call(this,...g)||this}p._inheritsLoose(f,c);return f}(p._wrapNativeSuper(Error)),h=function(c){function f(g,n){g=c.call(this,D(n)+g.message,{cause:g})||this;g.loc=null;Error.captureStackTrace&&Error.captureStackTrace(p._assertThisInitialized(g),f);n&&n.loc&&(g.loc=n.loc);return g}p._inheritsLoose(f,c);return f}(t),l=function(c){function f(g,n,k,x){g=c.call(this,"Execution error - "+D(k)+B(u[n],x))||this;g.loc=null;g.declaredRootClass="esri.arcade.arcadeexecutionerror";
Error.captureStackTrace&&Error.captureStackTrace(p._assertThisInitialized(g),f);k&&k.loc&&(g.loc=k.loc);return g}p._inheritsLoose(f,c);return f}(p._wrapNativeSuper(Error)),e=function(c){function f(g,n,k,x){g=c.call(this,"Compilation error - "+D(k)+B(u[n],x))||this;g.loc=null;g.declaredRootClass="esri.arcade.arcadecompilationerror";Error.captureStackTrace&&Error.captureStackTrace(p._assertThisInitialized(g),f);k&&k.loc&&(g.loc=k.loc);return g}p._inheritsLoose(f,c);return f}(p._wrapNativeSuper(Error)),
b=function(c){function f(){var g=c.call(this,"Uncompilable code structures")||this;g.declaredRootClass="esri.arcade.arcadeuncompilableerror";Error.captureStackTrace&&Error.captureStackTrace(p._assertThisInitialized(g),f);return g}p._inheritsLoose(f,c);return f}(p._wrapNativeSuper(Error));m.ModuleErrorCodes=void 0;(function(c){c.UnrecognisedUri="UnrecognisedUri";c.UnsupportedUriProtocol="UnsupportedUriProtocol"})(m.ModuleErrorCodes||(m.ModuleErrorCodes={}));const d={[m.ModuleErrorCodes.UnrecognisedUri]:"Unrecognised uri - {uri}",
[m.ModuleErrorCodes.UnsupportedUriProtocol]:"Unrecognised uri protocol"};let a=function(c){function f(g,n){g=c.call(this,B(d[g],n))||this;g.declaredRootClass="esri.arcade.arcademoduleerror";Error.captureStackTrace&&Error.captureStackTrace(p._assertThisInitialized(g),f);return g}p._inheritsLoose(f,c);return f}(p._wrapNativeSuper(Error));m.ArcadeCompilationError=e;m.ArcadeExecutionError=l;m.ArcadeUncompilableError=b;m.ErrorWithCause=t;m.ExecutionErrorMessages=u;m.LocatableArcadeExecutionError=h;m.ModuleError=
a;m.ModuleErrorMessages=d;m.doSubstitutions=B;m.ensureArcadeExecutionError=function(c,f,g){return"esri.arcade.arcadeexecutionerror"===g.declaredRootClass||"esri.arcade.arcadecompilationerror"===g.declaredRootClass?null===g.loc&&f&&f.loc?new h(g,{cause:g}):g:f&&f.loc?new h(g,{cause:g}):g};m.parsingValidationMessage=function(c,f,g){return"Parsing error - "+D(c)+B(u[f],g)};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/arcadeTimeUtils":function(){define("exports ../chunks/_rollupPluginBabelHelpers ./ArcadeDate ../layers/support/FieldsIndex ../time/TimeReference ../chunks/datetime ../time/timeReferenceUtils".split(" "),
function(m,p,D,B,u,t,h){function l(b){return b?.timeZoneIANA?b?.timeZoneIANA:b?.timeZone?h.convertLegacyTimeZone(b,""):""}let e=function(){function b(){this.dateTimeReferenceMetaData=null;this._fieldTimeZoneIndex={};this._ianaLayerDateFields=this._ianaEditFields=this._ianaTimeInfo=this._ianaPreferred=this._fieldIndex=null}b.create=function(a,c){const f=new b;f.dateTimeReferenceMetaData=c;f._fieldIndex=a instanceof B?a:new B(a);return f};b.createFromLayer=function(a){if(!a)return null;if(!a.fieldsIndex)return!a.declaredClass&&
a.fields?b.create(a.fields,a):null;const c=new b;c._fieldIndex=a.fieldsIndex;c.dateTimeReferenceMetaData={timeInfo:a?.timeInfo?.toJSON()??null,editFieldsInfo:a?.editFieldsInfo?.toJSON()??null,dateFieldsTimeReference:a?.dateFieldsTimeReference?.toJSON()??null,preferredTimeReference:a?.preferredTimeReference?.toJSON()??null,datesInUnknownTimezone:!0===a?.datesInUnknownTimezone};return c};var d=b.prototype;d.fieldTimeZone=function(a){a=this._fieldIndex?.get(a);if(!a||"date"!==a.type&&"esriFieldTypeDate"!==
a.type)return null;var c=this._fieldTimeZoneIndex[a.name];if(void 0!==c)return c;c=[{field:this.dateTimeReferenceMetaData?.editFieldsInfo?.creationDateField,timeReference:this.dateTimeReferenceMetaData?.editFieldsInfo?.dateFieldsTimeReference,isunknown:!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone},{field:this.dateTimeReferenceMetaData?.editFieldsInfo?.editDateField,timeReference:this.dateTimeReferenceMetaData?.editFieldsInfo?.dateFieldsTimeReference,isunknown:!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone},
{field:this.dateTimeReferenceMetaData?.timeInfo?.startTimeField,timeReference:this.dateTimeReferenceMetaData?.timeInfo?.timeReference,isunknown:!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone},{field:this.dateTimeReferenceMetaData?.timeInfo?.endTimeField,timeReference:this.dateTimeReferenceMetaData?.timeInfo?.timeReference,isunknown:!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone}];for(var f of c)if(f.field===a.name)return f=this.convertToIANA(f.timeReference,f.isunknown),
this._fieldTimeZoneIndex[a.name]=f;f=this.convertToIANA(this.dateTimeReferenceMetaData?.dateFieldsTimeReference,this.dateTimeReferenceMetaData?.datesInUnknownTimezone);return this._fieldTimeZoneIndex[a.name]=f};d.convertToIANA=function(a,c){return c?"unknown":l(a)};p._createClass(b,[{key:"layerPreferredTimeZone",get:function(){if(null!==this._ianaPreferred)return this._ianaPreferred;this._ianaPreferred="";return this._ianaPreferred=this.convertToIANA(this.dateTimeReferenceMetaData?.preferredTimeReference,
!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone)}},{key:"layerTimeInfoTimeZone",get:function(){if(null!==this._ianaTimeInfo)return this._ianaTimeInfo;this._ianaTimeInfo="";return this._ianaTimeInfo=this.convertToIANA(this.dateTimeReferenceMetaData?.timeInfo?.timeReference,!1)}},{key:"layerEditFieldsTimeZone",get:function(){if(null!==this._ianaEditFields)return this._ianaEditFields;this._ianaEditFields="";return this._ianaEditFields=this.convertToIANA(this.dateTimeReferenceMetaData?.editFieldsInfo?.dateFieldsTimeReference,
this.dateTimeReferenceMetaData?.datesInUnknownTimezone)}},{key:"layerDateFieldsTimeZone",get:function(){if(null!==this._ianaLayerDateFields)return this._ianaLayerDateFields;this._ianaLayerDateFields="";return this._ianaLayerDateFields=this.convertToIANA(this.dateTimeReferenceMetaData?.dateFieldsTimeReference,!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone)}}]);return b}();m.DateTimeReferenceFieldIndex=e;m.convertTimeReference=function(b){if(!b)return null;b instanceof u&&(b=l(b.toJSON()));
if(b instanceof t.Zone)return b;if("unknown"===b.toLowerCase())return D.UnknownTimeZone.instance;if("system"===b.toLowerCase())return t.SystemZone.instance;if("utc"===b.toLowerCase())return t.FixedOffsetZone.utcInstance;if(/^[\+\-]?[0-9]{1,2}([:][0-9]{2})?$/.test(b)){const d=t.FixedOffsetZone.parseSpecifier("UTC"+(b.startsWith("+")||b.startsWith("-")?"":"+")+b);if(d)return d}b=t.IANAZone.create(b);if(!b.isValid)throw new D.ArcadeDateError(D.ArcadeDateErrorCodes.TimeZoneNotRecognised);return b};m.convertToIANA=
l;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/centroid":function(){define(["exports","../../core/maybe"],function(m,p){function D(u,t,h,l,e,b,d=1){b=e?b?4:3:b?3:2;let a=h,c=h+b,f=0,g=0,n=h=0,k=0;for(let x=0,r=l-1;x<r;x++,a+=b,c+=b){l=t[a];const v=t[a+1],q=t[a+2],y=t[c],A=t[c+1],w=t[c+2];let z=l*A-y*v;n+=z;f+=(l+y)*z;g+=(v+A)*z;e&&(z=l*w-y*q,h+=(q+w)*z,k+=z);l<u[0]&&(u[0]=l);l>u[1]&&(u[1]=l);v<u[2]&&(u[2]=v);v>u[3]&&(u[3]=v);e&&(q<u[4]&&(u[4]=q),q>u[5]&&(u[5]=
q))}0<n*d&&(n*=-1);0<k*d&&(k*=-1);if(!n)return null;u=[f,g,.5*n];e&&(u[3]=h,u[4]=.5*k);return u}function B(u,t,h,l,e){e=l?e?4:3:e?3:2;let b=t,d=t+e,a=0,c=0,f=0,g=0;for(let r=0,v=h-1;r<v;r++,b+=e,d+=e){var n=u[b];const q=u[b+1],y=u[b+2],A=u[d],w=u[d+1],z=u[d+2];if(l){var k=A-n;var x=w-q;const C=z-y;k=Math.sqrt(k*k+x*x+C*C)}else k=A-n,x=w-q,k=Math.sqrt(k*k+x*x);k&&(a+=k,l?(n=[n+.5*(A-n),q+.5*(w-q),y+.5*(z-y)],c+=k*n[0],f+=k*n[1],g+=k*n[2]):(n=[n+.5*(A-n),q+.5*(w-q)],c+=k*n[0],f+=k*n[1]))}return 0<a?
l?[c/a,f/a,g/a]:[c/a,f/a]:0<h?l?[u[t],u[t+1],u[t+2]]:[u[t],u[t+1]]:null}m.getCentroidOptimizedGeometry=function(u,t,h,l,e){if(p.isNone(t)||!t.lengths.length)return null;const b="upperLeft"===e?.originPosition?-1:1;u.lengths.length&&(u.lengths.length=0);u.coords.length&&(u.coords.length=0);e=u.coords;const d=[],a=h?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,
Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:c,coords:f}=t,g=h?l?4:3:l?3:2;let n=0;for(var k of c){const x=D(a,f,n,k,h,l,b);x&&d.push(x);n+=k*g}d.sort((x,r)=>{let v=b*x[2]-b*r[2];0===v&&h&&(v=x[4]-r[4]);return v});d.length&&(k=6*d[0][2],e[0]=d[0][0]/k,e[1]=d[0][1]/k,h&&(k=6*d[0][4],e[2]=0!==k?d[0][3]/k:0),e[0]<a[0]||e[0]>a[1]||e[1]<a[2]||e[1]>a[3]||h&&(e[2]<a[4]||e[2]>a[5]))&&(e.length=0);if(!e.length)if(t=t.lengths[0]?B(f,0,c[0],h,l):null)e[0]=t[0],e[1]=t[1],h&&2<t.length&&(e[2]=t[2]);
else return null;return u};m.lineCentroid=B;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/FeatureSetReaderJSON":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedFeature ./FeatureSetReader".split(" "),function(m,p,D,B,u,t){function h({coords:e,lengths:b}){let d=0;for(const a of b){for(b=1;b<a;b++)e[2*
(d+b)]+=e[2*(d+b)-2],e[2*(d+b)+1]+=e[2*(d+b)-1];d+=a}}let l=function(e){function b(a,c,f){a=e.call(this,a,f)||this;a._exceededTransferLimit=!1;a._featureIndex=-1;a._dateFields=new Set;a._geometryType=f?.geometryType;a._features=c;return a}p._inheritsLoose(b,e);b.fromFeatures=function(a,c){const {objectIdField:f,geometryType:g}=c,n=B.convertFromFeatures([],a,g,!1,!1,f);for(let k=0;k<n.length;k++)n[k].displayId=a[k].displayId;return b.fromOptimizedFeatures(n,c)};b.fromFeatureSet=function(a,c){a=B.convertFromFeatureSet(a,
c.objectIdField);return b.fromOptimizedFeatureSet(a,c)};b.fromOptimizedFeatureSet=function(a,c){const {features:f}=a;c=b.fromOptimizedFeatures(f,c);c._exceededTransferLimit=a.exceededTransferLimit;c._transform=a.transform;for(const g of a.fields)"esriFieldTypeDate"===g.type&&c._dateFields.add(g.name);return c};b.fromOptimizedFeatures=function(a,c,f){const g=t.FeatureSetReader.createInstance();a=new b(g,a,c);a._transform=f;return a};var d=b.prototype;d.removeIds=function(a){const c=new Set(a);this._features=
this._features.filter(f=>!(f.objectId&&c.has(f.objectId)))};d.append=function(a){for(const c of a)this._features.push(c)};d.getSize=function(){return this._features.length};d.getCursor=function(){return this.copy()};d.getQuantizationTransform=function(){return this._transform};d.getAttributeHash=function(){let a="";for(const c in this._current.attributes)a+=this._current.attributes[c];return a};d.getIndex=function(){return this._featureIndex};d.setIndex=function(a){this._featureIndex=a};d.getObjectId=
function(){return this._current?.objectId};d.getDisplayId=function(){return this._current.displayId};d.setDisplayId=function(a){this._current.displayId=a};d.getGroupId=function(){return this._current.groupId};d.setGroupId=function(a){this._current.groupId=a};d.copy=function(){const a=new b(this.instance,this._features,this.fullSchema());this.copyInto(a);return a};d.next=function(){for(;++this._featureIndex<this._features.length&&!this._getExists(););return this._featureIndex<this._features.length};
d.readLegacyFeature=function(){return B.convertToFeature(this._current,this.geometryType,this.hasZ,this.hasM)};d.readOptimizedFeature=function(){return this._current};d.readLegacyPointGeometry=function(){return this.readGeometry()?{x:this.getX(),y:this.getY()}:null};d.readLegacyGeometry=function(){const a=this.readGeometry();return B.convertToGeometry(a,this.geometryType,this.hasZ,this.hasM)};d.readLegacyCentroid=function(){const a=this.readCentroid();return D.isNone(a)?null:{x:a.coords[0]*this._sx+
this._tx,y:a.coords[1]*this._sy+this._ty}};d.readGeometryArea=function(){return u.hasGeometry(this._current)?B.getQuantizedArea(this._current.geometry,2):0};d.readUnquantizedGeometry=function(){var a=this.readGeometry();if("esriGeometryPoint"===this.geometryType||!a)return a;a=a.clone();h(a);return a};d.readHydratedGeometry=function(){var a=this._current.geometry;if(D.isNone(a))return null;a=a.clone();D.isSome(this._transform)&&B.unquantizeOptimizedGeometry(a,a,this.hasZ,this.hasM,this._transform);
return a};d.getXHydrated=function(){if(!u.hasGeometry(this._current))return 0;const a=this._current.geometry.coords[0],c=this.getQuantizationTransform();return D.isNone(c)?a:a*c.scale[0]+c.translate[0]};d.getYHydrated=function(){if(!u.hasGeometry(this._current))return 0;const a=this._current.geometry.coords[1],c=this.getQuantizationTransform();return D.isNone(c)?a:c.translate[1]-a*c.scale[1]};d.getX=function(){return u.hasGeometry(this._current)?this._current.geometry.coords[0]*this._sx+this._tx:
0};d.getY=function(){return u.hasGeometry(this._current)?this._current.geometry.coords[1]*this._sy+this._ty:0};d.readGeometry=function(){if(!u.hasGeometry(this._current)){if(D.isSome(this._current.centroid)){const [f,g]=this._current.centroid.coords;return this.createQuantizedExtrudedQuad(f,g)}return null}const a=this._current.geometry.clone();if(a.isPoint)return a.coords[0]=a.coords[0]*this._sx+this._tx,a.coords[1]=a.coords[1]*this._sy+this._ty,a;let c=0;for(const f of a.lengths)a.coords[2*c]=a.coords[2*
c]*this._sx+this._tx,a.coords[2*c+1]=a.coords[2*c+1]*this._sy+this._ty,c+=f;return a};d.readCentroid=function(){return u.hasGeometry(this._current)?this._computeCentroid():this._current.centroid};d.hasField=function(a){return a in this._current.attributes?!0:this.getFieldNames().map(c=>c.toLowerCase()).includes(a.toLowerCase())};d.getFieldNames=function(){return Object.keys(this._current.attributes)};d._readAttribute=function(a,c){var f=this._current.attributes[a];if(void 0!==f)return null!=f&&c&&
this._dateFields.has(a)?new Date(f):f;f=this.readAttributes();a=a?.toLocaleLowerCase().trim();for(const g in f)if(g.toLocaleLowerCase().trim()===a)return a=this._current.attributes[g],null!=a&&c&&this._dateFields.has(g)?new Date(a):a};d.copyInto=function(a){e.prototype.copyInto.call(this,a);a._featureIndex=this._featureIndex;a._transform=this._transform;a._dateFields=this._dateFields};d._readAttributes=function(){return this._current.attributes};p._createClass(b,[{key:"_current",get:function(){return this._features[this._featureIndex]}},
{key:"geometryType",get:function(){return this._geometryType}},{key:"hasFeatures",get:function(){return!!this._features.length}},{key:"hasNext",get:function(){return this._featureIndex+1<this._features.length}},{key:"exceededTransferLimit",get:function(){return this._exceededTransferLimit}},{key:"hasZ",get:function(){return!1}},{key:"hasM",get:function(){return!1}}]);return b}(t.FeatureSetReader);m.FeatureSetReaderJSON=l;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/graphics/GraphicStore":function(){define("../../../../core/maybe ../../../../core/screenUtils ../../../../chunks/rbush ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/boundsUtils ../../../../geometry/support/normalizeUtils ../../../../geometry/support/spatialReferenceUtils ../../../../symbols/cim/CIMSymbolDrawHelper ../../../../symbols/cim/CIMSymbolHelper ./GraphicStoreItem ./graphicsUtils".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d){function a(k,x,r,v,q){f.minX=x;f.minY=r;f.maxX=v;f.maxY=q;return k.search(f)}function c(k){return{minX:k.bounds[0],minY:k.bounds[1],maxX:k.bounds[2],maxY:k.bounds[3]}}const f={minX:0,minY:0,maxX:0,maxY:0},g=B.create(),n=(k,x)=>{const r=d.graphicGeometryToNumber(k.graphic),v=d.graphicGeometryToNumber(x.graphic);return r===v?x.zorder-k.zorder:r-v};return function(){function k(r,v,q,y,A,w,z){this._graphics=y;this._onAdd=A;this._onRemove=w;this._hashToCIM=z;this._index=
D.rbush(9,c);this._itemByGraphic=new Map;this._inflatedSizeHelper=new e.CIMSymbolInflatedSizeHelper;this._tileInfoView=r;this._uidFieldName=q;if(r=r.getClosestInfoForScale(v))this._resolution=this._tileInfoView.getTileResolution(r.level)}var x=k.prototype;x.setResourceManager=function(r){this._cimResourceManager=r;this._hittestDrawHelper=new l.HittestDrawHelper(r)};x.hitTest=function(r,v,q,y,A){r=t.normalizeMapX(r,this._tileInfoView.spatialReference);var w=.5*y*window.devicePixelRatio*q;g[0]=r-w;
g[1]=v-w;g[2]=r+w;g[3]=v+w;q=.5*y*(q+d.PIXEL_BUFFER);v=a(this._index,r-q,v-q,r+q,v+q);if(!v||0===v.length)return[];r=[];q=B.create();w=B.create();for(var z of v){const {geometry:C,symbolResource:E}=z;this._getSymbolBounds(q,E,C,w,A);w[3]=w[2]=w[1]=w[0]=0;B.intersects(q,g)&&z.graphic?.visible&&r.push(z)}if(0===r.length)return[];z=this._hittestDrawHelper;v=[];for(const C of r){const {geometry:E,symbolResource:F}=C,{hash:G,textInfo:H}=F;(r=this._hashToCIM.get(G))&&z.hitTest(g,r.symbol,E,H,A,y)&&v.push(C)}v.sort(n);
return v.map(C=>C.graphic)};x.getGraphicsData=function(r,v,q){const y=this._searchForItems(v);if(0===y.length||0===q.length)return[];y.sort((G,H)=>G.zorder-H.zorder);y[0].insertAfter=-1;for(var A=1;A<y.length;A++)y[A].insertAfter=y[A-1].graphic.uid;y.sort((G,H)=>G.graphic.uid-H.graphic.uid);q.sort((G,H)=>G.uid-H.uid);let w=A=0,z;const C=v.resolution,E=[],F={originPosition:"upperLeft",scale:[C,C],translate:[v.bounds[0],v.bounds[3]]};for(const G of q){for(w=-2;A<y.length;)if(z=y[A],A++,G.uid===z.graphic.uid){w=
z.insertAfter;break}if(!z?.geometry||-2===w)continue;q=z.getGeometryQuantized(F,v.bounds,this._tileInfoView.spatialReference,C);const H={...z.graphic.attributes};H[this._uidFieldName]=G.uid;null==z.groupId&&(z.groupId=r.createTemplateGroup(z.symbol,null));E.push({centroid:b.getCentroidQuantized(z,F),geometry:q,attributes:H,symbol:z.symbol,groupId:z.groupId,insertAfter:w,zorder:z.zorder})}E.sort((G,H)=>G.zorder-H.zorder);return E};x.queryTileData=function(r,v){if(0===this._graphics.length)return[];
const {bounds:q,resolution:y}=v,A=this._searchForItems(v),w=[];if(0===A.length)return w;this._createTileGraphics(w,r,A,{originPosition:"upperLeft",scale:[y,y],translate:[q[0],q[3]]},v);return w};x.has=function(r){return this._itemByGraphic.has(r)};x.getBounds=function(r){return(r=this._itemByGraphic.get(r))?r.bounds:null};x.getAllBounds=function(){return Array.from(this._itemByGraphic.values()).filter(r=>r.graphic.visible).map(r=>r.bounds)};x.addOrModify=function(r,v,q){if(r&&!m.isNone(v)){this.has(r)&&
this.remove(r);this._onAdd(r);var y=[0,0,0,0],A=this._getSymbolBounds(null,v,q,y,0);v=b.acquire(r,v,q,m.isSome(A)?A:null,y);this._itemByGraphic.set(r,v);q&&this._index.insert(v);return v.bounds}};x.remove=function(r){if(this._itemByGraphic.has(r)){this._onRemove(r);var v=this._itemByGraphic.get(r);v?.bounds&&this._index.remove(v);this._itemByGraphic.delete(r)}};x.updateZ=function(){const r=this._graphics.items;for(let q=0;q<r.length;q++){var v=r[q];if(v=this._itemByGraphic.get(v))v.zorder=q}};x.update=
function(r,v,q){const y=this._itemByGraphic.get(r);y.groupId=null;const A=B.clone(y.bounds);this._index.remove(y);const w=this._getSymbolBounds(y.bounds,v,q,y.size,0);m.isSome(w)&&y.set(r,v,q,w,y.size);q&&this._index.insert(y);return{oldBounds:A,newBounds:y.bounds}};x.updateLevel=function(r){if(this._resolution!==r){this._resolution=r;this._index.clear();var v=this._itemByGraphic;r=[];for(const [,q]of v)v=this._getSymbolBounds(q.bounds,q.symbolResource,q.geometry,q.size,0),q.geometry&&m.isSome(v)&&
(q.bounds=v,r.push(q));this._index.load(r)}};x.clear=function(){this._itemByGraphic.clear();this._index.clear()};x._createTileGraphics=function(r,v,q,y,A){const w=this._uidFieldName,z=this._tileInfoView.spatialReference,{bounds:C,resolution:E}=A;q.sort((L,K)=>L.zorder-K.zorder);let F,G,H;for(let L=0;L<q.length;L++){G=q[L];A=G.graphic;F=G.getGeometryQuantized(y,C,z,E);H=0===L?-1:q[L-1].graphic.uid;const K={...G.graphic.attributes};K[w]=A.uid;null==G.groupId&&(G.groupId=v.createTemplateGroup(G.symbol,
null));r.push({centroid:b.getCentroidQuantized(G,y),geometry:F,attributes:K,symbol:G.symbol,groupId:G.groupId,insertAfter:H,zorder:G.zorder})}};x._searchForItems=function(r){var v=this._tileInfoView.spatialReference,q=r.bounds,y=h.getInfo(v);if(y&&v.isWrappable){const [A,w]=y.valid;v=1E-5>Math.abs(q[2]-w);y=1E-5>Math.abs(q[0]-A);if(!(v&&y||!v&&!y))return r=r.resolution,r=v?B.create([A,q[1],A+r*d.PIXEL_BUFFER,q[3]]):B.create([w-r*d.PIXEL_BUFFER,q[1],w,q[3]]),q=a(this._index,q[0],q[1],q[2],q[3]),r=
a(this._index,r[0],r[1],r[2],r[3]),[...(new Set([...q,...r]))]}return a(this._index,q[0],q[1],q[2],q[3])};x._getSymbolBounds=function(r,v,q,y,A){if(!v||!v.symbol||!q)return null;r||(r=B.create());u.getBoundsXY(r,q);if(!y||0===y[0]&&0===y[1]&&0===y[2]&&0===y[3]){const {hash:w,textInfo:z}=v;v=this._hashToCIM.get(w);if(!v)return null;y||(y=[0,0,0,0]);A=this._inflatedSizeHelper.getSymbolInflateSize(y,v.symbol,this._cimResourceManager,A,z);y[0]=p.pt2px(A[0]);y[1]=p.pt2px(A[1]);y[2]=p.pt2px(A[2]);y[3]=
p.pt2px(A[3])}A=this._resolution;y=e.CIMSymbolInflatedSizeHelper.safeSize(y);r[0]-=y*A;r[1]-=y*A;r[2]+=y*A;r[3]+=y*A;return r};return k}()})},"esri/views/2d/layers/graphics/GraphicStoreItem":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/centroid ../../../../geometry/support/jsonUtils ../../../../geometry/support/quantizationUtils ../../../../geometry/support/spatialReferenceUtils ../../../../layers/graphics/featureConversionUtils ../../../../layers/graphics/OptimizedGeometry".split(" "),
function(m,p,D,B,u,t,h,l,e){function b(c){c.coords.length=0;c.lengths.length=0}const d=new e,a=new e;e=function(){function c(){this.bounds=D.create();this.graphic=null}c.acquire=function(g=null,n,k,x,r){let v;0===c._pool.length?v=new c:(v=c._pool.pop(),this._set.delete(v));v.acquire(g,n,k,x,r);return v};c.release=function(g){g&&!this._set.has(g)&&(g.release(),this._pool.push(g),this._set.add(g))};c.getCentroidQuantized=function(g,n){if(u.isPolygon(g.geometry)){const k=g.symbol;if(p.isNone(k))return null;
if(0<k?.layers.length&&k.layers.some(x=>"text"===x.type||"marker"===x.type))return g=B.polygonCentroid(g.geometry),null!==g?t.quantizePoint(n,{},{x:g[0],y:g[1]},!1,!1):null}return null};var f=c.prototype;f.acquire=function(g=null,n,k,x,r){g&&this.set(g,n,k,x,r)};f.release=function(){this.geometry=this.symbolResource=this.graphic=null};f.set=function(g,n,k,x,r){this.graphic=g;this.geometry=k;this.symbolResource=n;this.bounds=x;r&&(this.size=r)};f.getGeometryQuantized=function(g,n,k,x){var r=this.geometry;
const v=u.getJsonType(r);if(p.isNone(v))return null;switch(v){case "esriGeometryPolygon":({rings:r}=r);if(!r||0===r.length)return null;k=1===r.length&&2===r[0].length?t.quantizeGeometry(g,{paths:[[r[0][0],r[0][1]]]}):t.quantizeGeometry(g,this.geometry);if(!k&&(k=t.quantizeGeometry(g,{x:r[0][0][0],y:r[0][0][1]}))){const {x:y,y:A}=k;return{rings:[[[y-1,A],[1,-1],[1,1],[-1,1],[-1,-1]]]}}return k;case "esriGeometryPolyline":return b(d),b(a),k=r.hasZ??!1,x=r.hasM??!1,l.convertFromPolyline(d,r),l.generalizeOptimizedGeometry(a,
d,k,x,"esriGeometryPolyline",g.scale[0]),l.quantizeOptimizedGeometry(d,a,k,x,"esriGeometryPolyline",g),l.convertToPolyline(d,r.hasZ??!1,r.hasM??!1);case "esriGeometryMultipoint":const q=.5*x*Math.max(Math.abs(this.size[0])+this.size[2]-this.size[0],Math.abs(this.size[1])+this.size[3]-this.size[1]);k=h.getInfo(k);r=r.points;if(k){const [y,A]=k.valid,w=A-y;r=r.filter(z=>{if(z[0]+q>A||z[0]-q<y){const C=[...z];C[0]=z[0]+q>A?C[0]-w:C[0]+w;return D.containsPointWithMargin(n,z,q)||D.containsPointWithMargin(n,
C,q)}return D.containsPointWithMargin(n,z,q)})}return 0===r.length?{points:r}:t.quantizeGeometry(g,{points:r})}return t.quantizeGeometry(g,this.geometry)};m._createClass(c,[{key:"symbol",get:function(){return this.symbolResource.symbol}}]);return c}();e._pool=[];e._set=new Set;return e})},"esri/views/layers/GraphicsView":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Identifiable ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass".split(" "),
function(m,p,D,B,u,t,h,l){m.GraphicsView=e=>{e=function(b){function d(){var a=b.apply(this,arguments)||this;a.graphics=null;a.renderer=null;return a}p._inheritsLoose(d,b);return d}(B.IdentifiableMixin(e));D.__decorate([u.property()],e.prototype,"graphics",void 0);D.__decorate([u.property()],e.prototype,"renderer",void 0);D.__decorate([u.property()],e.prototype,"updating",void 0);D.__decorate([u.property()],e.prototype,"view",void 0);return e=D.__decorate([l.subclass("esri.views.layers.GraphicsView")],
e)};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/graphics/GraphicContainer":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","../../engine/webgl/enums","./BaseGraphicContainer"],function(m,p,D){return function(B){function u(){return B.apply(this,arguments)||this}m._inheritsLoose(u,B);var t=u.prototype;t.renderChildren=function(h){this.attributeView.update();this.children.some(l=>l.hasData)&&(this.attributeView.bindTextures(h.context,!1),B.prototype.renderChildren.call(this,
h),h.drawPhase===p.WGLDrawPhase.MAP&&this._renderChildren(h),this.hasHighlight()&&h.drawPhase===p.WGLDrawPhase.HIGHLIGHT&&this._renderHighlight(h),this._boundsRenderer&&this._boundsRenderer.doRender(h))};t._renderHighlight=function(h){var {painter:l}=h;l=l.effects.highlight;l.bind(h);this._renderChildren(h,l.defines);l.draw(h);l.unbind()};return u}(D)})},"esri/views/2d/layers/graphics/BaseGraphicContainer":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","../../../../core/maybe",
"../../engine/FeatureContainer","./GraphicBoundsRenderer","../../../webgl/enums"],function(m,p,D,B,u){return function(t){function h(e){e=t.call(this,e)||this;e.hasHighlight=()=>!0;return e}m._inheritsLoose(h,t);var l=h.prototype;l.destroy=function(){t.prototype.destroy.call(this);this._boundsRenderer=p.destroyMaybe(this._boundsRenderer)};l.enableRenderingBounds=function(e){this._boundsRenderer=new B(e);this.requestRender()};l.onTileData=function(e,b){e.patch(b);this.contains(e)||this.addChild(e);
this.requestRender()};l.onTileError=function(e){e.clear();this.contains(e)||this.addChild(e)};l._renderChildren=function(e,b){for(const d of this.children)d.isReady&&d.hasData&&(d.commit(e),e.context.setStencilFunction(u.CompareFunction.EQUAL,d.stencilRef,255),d.getDisplayList().replay(e,d,b))};m._createClass(h,[{key:"hasLabels",get:function(){return!1}}]);return h}(D.FeatureContainer)})},"esri/views/2d/engine/FeatureContainer":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/promiseUtils ../../../core/Queue ./webgl/AttributeStoreView ./webgl/TileContainer ./webgl/WGLRendererInfo".split(" "),
function(m,p,D,B,u,t,h){t=function(l){function e(d){var a=l.call(this,d)||this;a._rendererInfo=new h.WGLRendererInfo;a._materialItemsRequestQueue=new B;a.attributeView=new u.AttributeStoreView(()=>a.onAttributeStoreUpdate());return a}p._inheritsLoose(e,l);var b=e.prototype;b.destroy=function(){this.children.forEach(d=>d.destroy());this.removeAllChildren();this.attributeView.destroy();this._materialItemsRequestQueue.clear()};b.setRendererInfo=function(d,a,c){this._rendererInfo.setInfo(d,a,c);this.requestRender()};
b.getMaterialItems=function(){var d=p._asyncToGenerator(function*(a,c){if(!a||0===a.length)return[];const f=D.createResolver();this._materialItemsRequestQueue.push({items:a,abortOptions:c,resolver:f});this.requestRender();return f.promise});return function(a,c){return d.apply(this,arguments)}}();b.doRender=function(d){d.context.capabilities.enable("textureFloat");d.context.capabilities.enable("vao");if(0<this._materialItemsRequestQueue.length){let a=this._materialItemsRequestQueue.pop();for(;a;)this._processMaterialItemRequest(d,
a),a=this._materialItemsRequestQueue.pop()}l.prototype.doRender.call(this,d)};b.renderChildren=function(d){for(const a of this.children)a.commit(d);this._rendererInfo.update(d.state);l.prototype.renderChildren.call(this,d)};b.updateTransforms=function(d){if(this.children.some(a=>a.hasData))for(const a of this.children)a.setTransform(d)};b.createRenderParams=function(d){d=l.prototype.createRenderParams.call(this,d);d.rendererInfo=this._rendererInfo;d.attributeView=this.attributeView;return d};b.onAttributeStoreUpdate=
function(){};b._processMaterialItemRequest=function(d,{items:a,abortOptions:c,resolver:f}){const {painter:g,pixelRatio:n}=d;d=a.map(k=>g.textureManager.rasterizeItem(k.symbol,n,k.glyphIds,c));Promise.all(d).then(k=>{this.stage?(k=k.map((x,r)=>({id:a[r].id,mosaicItem:x})),f.resolve(k)):f.reject()},f.reject)};return e}(t);m.FeatureContainer=t;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/AttributeStoreView":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Error ../../../../core/has ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ./definitions ./DisplayId ./Utils ./util/debug ../../../webgl/enums ../../../webgl/FramebufferObject ../../../webgl/Texture".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d,a,c,f){const g=u.getLogger("esri.views.2d.engine.webgl.AttributeStoreView"),n=d.createDebugLogger(d.DEBUG_ATTR_UPDATES,g);let k=function(){function x(v,q,y){this._lastTexture=this._texture=null;this._fbos={};this.texelSize=4;const {buffer:A,pixelType:w,textureOnly:z}=v;v=b.getPixelArrayCtor(w);this.shared=y;this.pixelType=w;this.size=q;this.textureOnly=z;z||(this.data=new v(t.unwrap(A)));this._resetRange()}var r=x.prototype;r.destroy=function(){t.applySome(this._texture,
v=>v.dispose());for(const v in this._fbos)t.applySome(this._fbos[v],q=>{"0"===v&&q.detachColorTexture();q.dispose()}),this._fbos[v]=null;this._texture=null};r.setData=function(v,q,y){v=e.getDisplayIdTexel(v);const A=t.unwrap(this.data);q=v*this.texelSize+q;!A||q>=A.length||(A[q]=y,this.dirtyStart=Math.min(this.dirtyStart,v),this.dirtyEnd=Math.max(this.dirtyEnd,v))};r.getData=function(v,q){if(t.isNone(this.data))return null;v=e.getDisplayIdTexel(v)*this.texelSize+q;return!this.data||v>=this.data.length?
null:this.data[v]};r.getTexture=function(v){return t.unwrapOr(this._texture,()=>this._initTexture(v))};r.getFBO=function(v,q=0){if(t.isNone(this._fbos[q])){const y={colorTarget:a.TargetType.TEXTURE,depthStencilTarget:a.DepthStencilTargetType.NONE},A=0===q?this.getTexture(v):this._textureDesc;this._fbos[q]=new c.FramebufferObject(v,y,A)}return this._fbos[q]};r.updateTexture=function(v,q){if(!this.locked){try{const y=this.dirtyStart,A=this.dirtyEnd;if(!this.hasDirty)return;this._resetRange();const w=
t.unwrap(this.data).buffer,z=this.getTexture(v),C=(y-y%this.size)/this.size,E=(A-A%this.size)/this.size,F=C*this.size*4,G=4*(this.size+E*this.size)-F,H=b.getPixelArrayCtor(this.pixelType),L=new H(w,F*H.BYTES_PER_ELEMENT,G),K=this.size;v=E-C+1;if(v>this.size){g.error(new D("mapview-webgl","Out-of-bounds index when updating AttributeData"));return}z.updateData(0,0,C,K,v,L)}catch(y){}q()}};r.update=function(v){const {data:q,start:y,end:A}=v;if(t.isSome(q)&&t.isSome(this.data)){const w=this.data,z=y*
this.texelSize;for(let C=0;C<q.length;C++)v.layout&1<<C%this.texelSize&&(w[z+C]=q[C])}this.dirtyStart=Math.min(this.dirtyStart,y);this.dirtyEnd=Math.max(this.dirtyEnd,A)};r.resize=function(v,q){const y=this.size;this.size=q;this.textureOnly?y!==this.size&&(this._lastTexture=this._texture,this._texture=null):(q=b.getPixelArrayCtor(this.pixelType),this.destroy(),this.data=new q(t.unwrap(v.buffer)))};r._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};r._initTexture=function(v){const q=
new f.Texture(v,this._textureDesc,t.unwrapOr(this.data,void 0));if(t.isSome(this._lastTexture)&&this._fbos[0]){const w=this._lastTexture.descriptor.width,z=this._lastTexture.descriptor.height,C=this._lastTexture.descriptor.dataType,E=this._lastTexture.descriptor.pixelFormat,F=this.getFBO(v);var y=b.getPixelBytes(C),A=b.getPixelArrayCtor(C);y=new ArrayBuffer(w*z*y*this.texelSize);A=new A(y);y=v.getBoundFramebufferObject();const {x:G,y:H,width:L,height:K}=v.getViewport();v.bindFramebuffer(F);F.readPixels(0,
0,w,z,E,C,A);q.updateData(0,0,0,2*w,z/2,A);v.setViewport(G,H,L,K);v.bindFramebuffer(y)}this.destroy();return this._texture=q};p._createClass(x,[{key:"_textureDesc",get:function(){return{target:a.TextureType.TEXTURE_2D,wrapMode:a.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:a.PixelFormat.RGBA,dataType:this.pixelType,samplingMode:a.TextureSamplingMode.NEAREST,width:this.size,height:this.size}}},{key:"locked",get:function(){return this.pixelType===a.PixelType.UNSIGNED_BYTE&&this.shared&&!this.textureOnly&&
B("esri-atomics")&&this.data?1===Atomics.load(this.data,0):!1}},{key:"hasDirty",get:function(){return this.dirtyEnd>=this.dirtyStart}}]);return x}();u=function(){function x(v){this._onUpdate=v;this._locked=this._forceNextUpload=this._initialized=!1}var r=x.prototype;r.initialize=function(v){const {blocks:q,shared:y,size:A}=v;this.shared=y;this.size=A;n("Initializing AttributeStoreView",v);if(t.isNone(this._data))this._data=t.mapMany(q,w=>new k(w,A,y));else for(v=0;v<this._data.length;v++){const w=
this._data[v],z=q[v];t.isSome(z)&&(t.isNone(w)?this._data[v]=new k(z,A,y):w.resize(z,A))}this._initialized=!0};r.destroy=function(){t.applySome(this._data,v=>t.mapMany(v,q=>q.destroy()));t.applySome(this._defaultTexture,v=>v.dispose())};r.isEmpty=function(){return t.isNone(this._data)};r.isUpdating=function(){const v=t.isSome(this._pendingAttributeUpdate);B("esri-2d-log-updating")&&console.log(`Updating AttributeStoreView ${v}\n  -> hasPendingUpdate ${v}`);return v};r.getBlock=function(v){return t.isNone(this._data)?
null:this._data[v]};r.setLabelMinZoom=function(v,q){this.setData(v,0,1,q)};r.getLabelMinZoom=function(v){return this.getData(v,0,1,255)};r.getFilterFlags=function(v){return this.getData(v,0,0,0)};r.getVVSize=function(v){return this.getData(v,l.ATTRIBUTE_DATA_VV,0,0)};r.getData=function(v,q,y,A){if(!this._data)return 0;q=t.unwrap(this._data)[q];if(t.isNone(q))return 0;v=q.getData(v,y);return t.isSome(v)?v:A};r.setData=function(v,q,y,A){q=t.unwrap(this._data)[q];t.unwrap(q).setData(v,y,A)};r.lockTextureUpload=
function(){this._locked=!0};r.unlockTextureUpload=function(){this._locked=!1};r.forceTextureUpload=function(){this._forceNextUpload=!0};r.requestUpdate=function(){var v=p._asyncToGenerator(function*(q){if(this._pendingAttributeUpdate)g.error(new D("mapview-webgl","Tried to update attribute data with a pending update"));else{var y=h.createResolver();n("AttributeStoreView Update Requested",q);this._pendingAttributeUpdate={data:q,resolver:y};this._onUpdate();return y.promise}});return function(q){return v.apply(this,
arguments)}}();r.update=function(){if(this._initialized&&t.isSome(this._pendingAttributeUpdate)){B("esri-2d-update-debug")&&console.debug("AttributeStoreView::update");const {data:v,resolver:q}=this._pendingAttributeUpdate,y=t.unwrap(this._data);for(let A=0;A<v.blocks.length;A++){const w=v.blocks[A];t.applySome(y[A],z=>t.applySome(w,C=>{n(`Updating block ${A}`,C);z.update(C)}))}this._pendingAttributeUpdate=null;q();this._onUpdate()}};r.bindTextures=function(v,q=!0){const y=this._getDefaultTexture(v);
if(this._initialized){var A=t.unwrap(this._data);if(!this._locked||this._forceNextUpload)t.forEachSome(A,w=>w.updateTexture(v,()=>this._onUpdate())),this._forceNextUpload=!1;v.bindTexture(t.mapOr(A[l.ATTRIBUTE_DATA_FILTER_FLAGS],y,w=>w.getTexture(v)),l.TEXTURE_BINDING_ATTRIBUTE_DATA_0);q&&(v.bindTexture(t.mapOr(A[l.ATTRIBUTE_DATA_GPGPU],y,w=>w.getTexture(v)),l.TEXTURE_BINDING_GPGPU),v.bindTexture(t.mapOr(A[l.ATTRIBUTE_DATA_ANIMATION],y,w=>w.getTexture(v)),l.TEXTURE_BINDING_ATTRIBUTE_DATA_1),v.bindTexture(t.mapOr(A[l.ATTRIBUTE_DATA_VV],
y,w=>w.getTexture(v)),l.TEXTURE_BINDING_ATTRIBUTE_DATA_2),v.bindTexture(t.mapOr(A[l.ATTRIBUTE_DATA_DD1],y,w=>w.getTexture(v)),l.TEXTURE_BINDING_ATTRIBUTE_DATA_3),v.bindTexture(t.mapOr(A[l.TEXTURE_BINDING_ATTRIBUTE_DATA_4],y,w=>w.getTexture(v)),l.TEXTURE_BINDING_ATTRIBUTE_DATA_4),v.bindTexture(t.mapOr(A[l.TEXTURE_BINDING_ATTRIBUTE_DATA_5],y,w=>w.getTexture(v)),l.TEXTURE_BINDING_ATTRIBUTE_DATA_5))}else v.bindTexture(y,l.TEXTURE_BINDING_ATTRIBUTE_DATA_0),q&&(v.bindTexture(y,l.TEXTURE_BINDING_ATTRIBUTE_DATA_1),
v.bindTexture(y,l.TEXTURE_BINDING_ATTRIBUTE_DATA_2),v.bindTexture(y,l.TEXTURE_BINDING_ATTRIBUTE_DATA_3),v.bindTexture(y,l.TEXTURE_BINDING_ATTRIBUTE_DATA_4),v.bindTexture(y,l.TEXTURE_BINDING_ATTRIBUTE_DATA_5),v.bindTexture(y,l.TEXTURE_BINDING_GPGPU))};r._getDefaultTexture=function(v){t.isNone(this._defaultTexture)&&(this._defaultTexture=new f.Texture(v,{wrapMode:a.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:a.PixelFormat.RGBA,dataType:a.PixelType.UNSIGNED_BYTE,samplingMode:a.TextureSamplingMode.NEAREST,
width:1,height:1},new Uint8Array(4)));return this._defaultTexture};return x}();m.AttributeStoreView=u;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/TileContainer":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ./enums ./WGLContainer ./brushes/WGLBrushInfo ./brushes/WGLBrushStencil".split(" "),function(m,p,D,B,u,t){const h=(l,e)=>0!==l.key.level-e.key.level?l.key.level-e.key.level:0!==l.key.row-e.key.row?l.key.row-
e.key.row:l.key.col-e.key.col;return function(l){function e(d){var a=l.call(this)||this;a._tileInfoView=d;return a}m._inheritsLoose(e,l);var b=e.prototype;b.renderChildren=function(d){this.sortChildren(h);this.setStencilReference(d);l.prototype.renderChildren.call(this,d)};b.createRenderParams=function(d){const {state:a}=d;d=l.prototype.createRenderParams.call(this,d);d.requiredLevel=this._tileInfoView.getClosestInfoForScale(a.scale).level;d.displayLevel=this._tileInfoView.tileInfo.scaleToZoom(a.scale);
return d};b.prepareRenderPasses=function(d){const a=l.prototype.prepareRenderPasses.call(this,d);a.push(d.registerRenderPass({name:"stencil",brushes:[t],drawPhase:D.WGLDrawPhase.DEBUG|D.WGLDrawPhase.MAP|D.WGLDrawPhase.HIGHLIGHT,target:()=>this.getStencilTarget()}));p("esri-tiles-debug")&&a.push(d.registerRenderPass({name:"tileInfo",brushes:[u],drawPhase:D.WGLDrawPhase.DEBUG,target:()=>this.children}));return a};b.getStencilTarget=function(){return this.children};b.setStencilReference=function(d){d=
1;for(const a of this.children)a.stencilRef=d++};m._createClass(e,[{key:"requiresDedicatedFBO",get:function(){return!1}}]);return e}(B)})},"esri/views/2d/engine/webgl/WGLContainer":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/maybe ../../../../chunks/mat3f32 ../brushes ../Container ./ClippingInfo ./enums".split(" "),function(m,p,D,B,u,t,h,l){return function(e){function b(){var a=e.apply(this,arguments)||this;a.name=a.constructor.name;return a}
m._inheritsLoose(b,e);var d=b.prototype;d.beforeRender=function(a){e.prototype.beforeRender.call(this,a);this.updateTransforms(a.state)};d._createTransforms=function(){return{dvs:B.create()}};d.doRender=function(a){a=this.createRenderParams(a);const {painter:c,globalOpacity:f,profiler:g,drawPhase:n}=a,k=n===l.WGLDrawPhase.LABEL||n===l.WGLDrawPhase.HIGHLIGHT?1:f*this.computedOpacity;g.recordContainerStart(this.name);c.beforeRenderLayer(a,this._clippingInfos?255:0,k);this.renderChildren(a);c.compositeLayer(a,
k);g.recordContainerEnd()};d.renderChildren=function(a){D.isNone(this._renderPasses)&&(this._renderPasses=this.prepareRenderPasses(a.painter));for(const c of this._renderPasses)try{c.render(a)}catch(f){}};d.createRenderParams=function(a){a.requireFBO=this.requiresDedicatedFBO;return a};d.prepareRenderPasses=function(a){return[a.registerRenderPass({name:"clip",brushes:[u.brushes.clip],target:()=>this._clippingInfos,drawPhase:l.WGLDrawPhase.MAP|l.WGLDrawPhase.LABEL|l.WGLDrawPhase.LABEL_ALPHA|l.WGLDrawPhase.DEBUG|
l.WGLDrawPhase.HIGHLIGHT})]};d.updateTransforms=function(a){for(const c of this.children)c.setTransform(a)};d.onAttach=function(){e.prototype.onAttach.call(this);this._updateClippingInfo()};d.onDetach=function(){e.prototype.onDetach.call(this);this._updateClippingInfo()};d._updateClippingInfo=function(){D.isSome(this._clippingInfos)&&(this._clippingInfos.forEach(f=>f.destroy()),this._clippingInfos=null);const a=this.stage;if(a){var c=this._clips;D.isSome(c)&&c.length&&(this._clippingInfos=c.items.map(f=>
h.fromClipArea(a,f)));this.requestRender()}};m._createClass(b,[{key:"clips",set:function(a){this._clips=a;this.children.forEach(c=>c.clips=a);this._updateClippingInfo()}}]);return b}(t.Container)})},"esri/views/2d/engine/webgl/ClippingInfo":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/reactiveUtils ../../../../chunks/mat3f32 ../DisplayObject ./Mesh2D ../../../webgl/VertexArrayObject".split(" "),
function(m,p,D,B,u,t,h,l,e){return function(b){function d(c,f){var g=b.call(this)||this;g._clip=f;g._cache={};g.stage=c;g._handle=u.watch(()=>f.version,()=>g._invalidate());g.ready();return g}m._inheritsLoose(d,b);d.fromClipArea=function(c,f){return new d(c,f)};var a=d.prototype;a._destroyGL=function(){B.isSome(this._cache.mesh)&&(this._cache.mesh.destroy(),this._cache.mesh=null);B.isSome(this._cache.vao)&&(this._cache.vao.dispose(),this._cache.vao=null)};a.destroy=function(){this._destroyGL();this._handle.remove()};
a.getVAO=function(c,f,g,n){const [k,x]=f.size;if("geometry"===this._clip.type||this._lastWidth!==k||this._lastHeight!==x)this._lastWidth=k,this._lastHeight=x,this._destroyGL();if(B.isNone(this._cache.vao)){f=this._createMesh(f,this._clip);const r=f.getIndexBuffer(c),v=f.getVertexBuffers(c);this._cache.mesh=f;this._cache.vao=new e.VertexArrayObject(c,g,n,v,r)}return this._cache.vao};a._createTransforms=function(){return{dvs:t.create()}};a._invalidate=function(){this._destroyGL();this.requestRender()};
a._createScreenRect=function(c,f){const [g,n]=c.size;c="string"===typeof f.left?parseFloat(f.left)/100*g:f.left;const k="string"===typeof f.right?parseFloat(f.right)/100*g:f.right,x="string"===typeof f.top?parseFloat(f.top)/100*n:f.top;f="string"===typeof f.bottom?parseFloat(f.bottom)/100*n:f.bottom;return{x:c,y:x,width:Math.max(g-k-c,0),height:Math.max(n-f-x,0)}};a._createMesh=function(c,f){switch(f.type){case "rect":return l.fromRect(this._createScreenRect(c,f));case "path":return l.fromPath(f);
case "geometry":return l.fromGeometry(c,f);default:return D.getLogger("esri.views.2d.engine.webgl.ClippingInfo").error(new p("mapview-bad-type","Unable to create ClippingInfo mesh from clip of type: ${clip.type}")),l.fromRect({x:0,y:0,width:1,height:1})}};return d}(h.DisplayObject)})},"esri/views/2d/engine/webgl/Mesh2D":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../chunks/earcut ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../../../layers/graphics/featureConversionUtils ../../../../layers/graphics/OptimizedGeometry ./number ../../../webgl/BufferObject ../../../webgl/enums".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d,a){const c=({coords:f,lengths:g},n)=>{const k=[];for(let v=0,q=0;v<g.length;q+=g[v],v+=1){const y=q;for(var x=[];v<g.length-1;v+=1,q+=g[v]){var r=q+g[v];let A=0;for(let w=1;w<g[v+1];w++)A+=(f[2*(r+w)]-f[2*(r+w-1)])*(f[2*(r+w)+1]+f[2*(r+w-1)+1]);if(!(n?0<A:0>A))break;x.push(q+g[v]-y)}r=f.slice(2*y,2*(q+g[v]));x=u.earcut(r,x,2);for(const A of x)k.push(A+y)}return k};return function(){function f(n,k,x,r=!1){this._cache={};this.vertices=n;this.indices=k;this.primitiveType=
x;this.isMapSpace=r}f.fromRect=function({x:n,y:k,width:x,height:r}){return f.fromScreenExtent({xmin:n,ymin:k,xmax:n+x,ymax:k+r})};f.fromPath=function(n){var k=l.convertFromNestedArray(new e,n.path,!1,!1);n=k.coords;k=new Uint32Array(c(k,!0));const x=new Uint32Array(n.length/2);for(let r=0;r<x.length;r++)x[r]=b.i1616to32(Math.floor(n[2*r]),Math.floor(n[2*r+1]));return new f({geometry:x},k,a.PrimitiveType.TRIANGLES)};f.fromGeometry=function(n,k){const x=k.geometry?.type;switch(x){case "polygon":return f.fromPolygon(n,
k.geometry);case "extent":return f.fromMapExtent(n,k.geometry);default:return D.getLogger("esri.views.2d.engine.webgl.Mesh2D").error(new p("mapview-bad-type",`Unable to create a mesh from type ${x}`,k)),f.fromRect({x:0,y:0,width:1,height:1})}};f.fromPolygon=function(n,k){var x=l.convertFromPolygon(new e,k,!1,!1);k=x.coords;x=new Uint32Array(c(x,!1));const r=new Uint32Array(k.length/2),v=h.create(),q=h.create();for(let y=0;y<r.length;y++)t.set(v,k[2*y],k[2*y+1]),n.toScreen(q,v),r[y]=b.i1616to32(Math.floor(q[0]),
Math.floor(q[1]));return new f({geometry:r},x,a.PrimitiveType.TRIANGLES,!0)};f.fromScreenExtent=function({xmin:n,xmax:k,ymin:x,ymax:r}){n={geometry:new Uint32Array([b.i1616to32(n,x),b.i1616to32(k,x),b.i1616to32(n,r),b.i1616to32(n,r),b.i1616to32(k,x),b.i1616to32(k,r)])};k=new Uint32Array([0,1,2,3,4,5]);return new f(n,k,a.PrimitiveType.TRIANGLES)};f.fromMapExtent=function(n,k){const [x,r]=n.toScreen([0,0],[k.xmin,k.ymin]),[v,q]=n.toScreen([0,0],[k.xmax,k.ymax]);n={geometry:new Uint32Array([b.i1616to32(x,
r),b.i1616to32(v,r),b.i1616to32(x,q),b.i1616to32(x,q),b.i1616to32(v,r),b.i1616to32(v,q)])};k=new Uint32Array([0,1,2,3,4,5]);return new f(n,k,a.PrimitiveType.TRIANGLES)};var g=f.prototype;g.destroy=function(){B.isSome(this._cache.indexBuffer)&&this._cache.indexBuffer.dispose();for(const n in this._cache.vertexBuffers)B.isSome(this._cache.vertexBuffers[n])&&this._cache.vertexBuffers[n].dispose()};g.getIndexBuffer=function(n,k=a.Usage.STATIC_DRAW){this._cache.indexBuffer||(this._cache.indexBuffer=d.BufferObject.createIndex(n,
k,this.indices));return this._cache.indexBuffer};g.getVertexBuffers=function(n,k=a.Usage.STATIC_DRAW){this._cache.vertexBuffers||(this._cache.vertexBuffers=Object.keys(this.vertices).reduce((x,r)=>({...x,[r]:d.BufferObject.createVertex(n,k,this.vertices[r])}),{}));return this._cache.vertexBuffers};m._createClass(f,[{key:"elementType",get:function(){a:switch(this.indices.BYTES_PER_ELEMENT){case 1:var n=a.DataType.UNSIGNED_BYTE;break a;case 2:n=a.DataType.UNSIGNED_SHORT;break a;case 4:n=a.DataType.UNSIGNED_INT;
break a;default:throw new p("Cannot get DataType of array");}return n}}]);return f}()})},"esri/views/2d/engine/webgl/WGLRendererInfo":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/screenUtils ../../../../core/unitUtils ../../../../renderers/support/lengthUtils ./Utils ./techniques/Technique ./techniques/utils ../../../webgl/capabilities".split(" "),function(m,p,D,B,u,t,h,l,e,b){function d(c,f){const g=f.length;if(c<f[0].value||1===
g)return f[0].size;for(let n=1;n<g;n++)if(c<f[n].value)return f[n-1].size+(c-f[n-1].value)/(f[n].value-f[n-1].value)*(f[n].size-f[n-1].size);return f[g-1].size}let a=function(){function c(){this.symbolLevels=[];this.vvColorValues=new Float32Array(8);this.vvColors=new Float32Array(32);this.vvOpacityValues=new Float32Array(8);this.vvOpacities=new Float32Array(8);this.vvSizeMinMaxValue=new Float32Array(4);this.outsideLabelsVisible=!1;this._vvMaterialParameters={vvSizeEnabled:!1,vvColorEnabled:!1,vvRotationEnabled:!1,
vvRotationType:"geographic",vvOpacityEnabled:!1};this._technique=l.Technique}var f=c.prototype;f.getSizeVVFieldStops=function(g){const n=this._vvSizeFieldStops;if(n)switch(n.type){case "static":return n;case "level-dependent":return D.unwrapOr(n.levels[g],()=>{var k=Infinity,x=0;for(var r in n.levels){const v=parseFloat(r),q=Math.abs(g-v);q<k&&(k=q,x=v)}if(Infinity===k)return{sizes:new Float32Array([0,0,0,0,0,0]),values:new Float32Array([0,0,0,0,0,0])};k=2**((g-x)/2);x=D.unwrap(n.levels[x]);r=new Float32Array(x.values);
r[2]*=k;r[3]*=k;return{sizes:D.unwrap(x.sizes),values:r}})}};f.update=function(g){D.isSome(this._vvInfo)&&this._updateVisualVariables(this._vvInfo.vvRanges,g)};f.setInfo=function(g,n,k){this._updateEffects(k);this._vvInfo=n;this._technique=e.getTechniqueFromRenderer(g);this.rendererSchema=this._technique.createOrUpdateRendererSchema(this.rendererSchema,g)};f.getVariation=function(){return{...this._technique.getVariation(this.rendererSchema),outsideLabelsVisible:this.outsideLabelsVisible,supportsTextureFloat:b.getWebGLCapabilities("2d").supportsTextureFloat}};
f.getVariationHash=function(){return this._technique.getVariationHash(this.rendererSchema)<<1|(this.outsideLabelsVisible?1:0)};f._updateEffects=function(g){D.isSome(g)?this.outsideLabelsVisible=g.excludedLabelsVisible:this.outsideLabelsVisible=!1};f._updateVisualVariables=function(g,n){const k=this._vvMaterialParameters;k.vvOpacityEnabled=!1;k.vvSizeEnabled=!1;k.vvColorEnabled=!1;k.vvRotationEnabled=!1;if(g){var x=g.size;if(x){k.vvSizeEnabled=!0;if(x.minMaxValue){const v=x.minMaxValue;let q;if(h.isDefined(v.minSize)&&
h.isDefined(v.maxSize))if(h.isNumber(v.minSize)&&h.isNumber(v.maxSize)){q=B.pt2px(v.minSize);var r=B.pt2px(v.maxSize)}else r=n.scale,q=B.pt2px(d(r,v.minSize.stops)),r=B.pt2px(d(r,v.maxSize.stops));this.vvSizeMinMaxValue.set([v.minDataValue,v.maxDataValue,q,r])}x.scaleStops&&(this.vvSizeScaleStopsValue=B.pt2px(d(n.scale,x.scaleStops.stops)));x.unitValue&&(this.vvSizeUnitValueToPixelsRatio=u.getMetersPerUnitForSR(n.spatialReference)/t.meterIn[x.unitValue.unit]/n.resolution);x.fieldStops&&(this._vvSizeFieldStops=
x.fieldStops)}if(n=g.color)k.vvColorEnabled=!0,this.vvColorValues.set(n.values),this.vvColors.set(n.colors);if(n=g.opacity)k.vvOpacityEnabled=!0,this.vvOpacityValues.set(n.values),this.vvOpacities.set(n.opacities);if(g=g.rotation)k.vvRotationEnabled=!0,k.vvRotationType=g.type}};p._createClass(c,[{key:"vvMaterialParameters",get:function(){return this._vvMaterialParameters}}]);return c}();m.WGLRendererInfo=a;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/graphics/GraphicBoundsRenderer":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../chunks/mat3 ../../../../chunks/mat3f32 ../../../../chunks/vec2f32 ../../../../chunks/vec3f32 ../../../../geometry/support/normalizeUtils ../../engine/DisplayObject ../../engine/webgl/Utils ../../../webgl/BufferObject ../../../webgl/enums ../../../webgl/VertexArrayObject".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d,a){const c=Math.PI/180,f=()=>e.createProgramDescriptor("bounds",{geometry:[{location:0,name:"a_position",count:2,type:d.DataType.FLOAT}]});return function(g){function n(x){var r=g.call(this)||this;r._program=null;r._vao=null;r._vertexBuffer=null;r._indexBuffer=null;r._dvsMat3=B.create();r._localOrigin={x:0,y:0};r._getBounds=x;return r}m._inheritsLoose(n,g);var k=n.prototype;k.destroy=function(){this._vao&&(this._vao.dispose(!0),this._indexBuffer=this._vertexBuffer=this._vao=
null);this._program=p.disposeMaybe(this._program)};k.doRender=function(x){const {context:r}=x,v=this._getBounds();1>v.length||(this._createShaderProgram(r),this._updateMatricesAndLocalOrigin(x),this._updateBufferData(r,v),r.setBlendingEnabled(!0),r.setDepthTestEnabled(!1),r.setStencilWriteMask(0),r.setStencilTestEnabled(!1),r.setBlendFunction(d.BlendFactor.ONE,d.BlendFactor.ONE_MINUS_SRC_ALPHA),r.setColorMask(!0,!0,!0,!0),x=this._program,r.bindVAO(this._vao),r.useProgram(x),x.setUniformMatrix3fv("u_dvsMat3",
this._dvsMat3),r.gl.lineWidth(1),r.drawElements(d.PrimitiveType.LINES,8*v.length,d.DataType.UNSIGNED_INT,0),r.bindVAO())};k._createTransforms=function(){return{dvs:B.create()}};k._createShaderProgram=function(x){this._program||(this._program=x.programCache.acquire("precision highp float;\n        uniform mat3 u_dvsMat3;\n\n        attribute vec2 a_position;\n\n        void main() {\n          mediump vec3 pos \x3d u_dvsMat3 * vec3(a_position, 1.0);\n          gl_Position \x3d vec4(pos.xy, 0.0, 1.0);\n        }",
"precision mediump float;\n      void main() {\n        gl_FragColor \x3d vec4(0.75, 0.0, 0.0, 0.75);\n      }",f().attributes))};k._updateMatricesAndLocalOrigin=function(x){var {state:r}=x;const {displayMat3:v,size:q,resolution:y,pixelRatio:A,rotation:w,viewpoint:z}=r;x=c*w;const {x:C,y:E}=z.targetGeometry;r=h.normalizeMapX(C,r.spatialReference);this._localOrigin.x=r;this._localOrigin.y=E;r=A*q[0];const F=A*q[1],G=y*r,H=y*F,L=D.identity(this._dvsMat3);D.multiply(L,L,v);D.translate(L,L,u.fromValues(r/
2,F/2));D.scale(L,L,t.fromValues(q[0]/G,-F/H,1));D.rotate(L,L,-x)};k._updateBufferData=function(x,r){const {x:v,y:q}=this._localOrigin,y=new Float32Array(8*r.length),A=new Uint32Array(8*r.length);let w=0,z=0;for(const C of r)C&&(y[2*w]=C[0]-v,y[2*w+1]=C[1]-q,y[2*w+2]=C[0]-v,y[2*w+3]=C[3]-q,y[2*w+4]=C[2]-v,y[2*w+5]=C[3]-q,y[2*w+6]=C[2]-v,y[2*w+7]=C[1]-q,A[z+0]=w+0,A[z+1]=w+3,A[z+2]=w+3,A[z+3]=w+2,A[z+4]=w+2,A[z+5]=w+1,A[z+6]=w+1,A[z+7]=w+0,w+=4,z+=8);this._vertexBuffer?this._vertexBuffer.setData(y.buffer):
this._vertexBuffer=b.BufferObject.createVertex(x,d.Usage.DYNAMIC_DRAW,y.buffer);this._indexBuffer?this._indexBuffer.setData(A):this._indexBuffer=b.BufferObject.createIndex(x,d.Usage.DYNAMIC_DRAW,A);this._vao||(r=f(),this._vao=new a.VertexArrayObject(x,r.attributes,r.bufferLayouts,{geometry:this._vertexBuffer},this._indexBuffer))};return n}(l.DisplayObject)})},"esri/chunks/vec3f32":function(){define(["exports"],function(m){function p(){return new Float32Array(3)}function D(k){const x=new Float32Array(3);
x[0]=k[0];x[1]=k[1];x[2]=k[2];return x}function B(k,x,r){const v=new Float32Array(3);v[0]=k;v[1]=x;v[2]=r;return v}function u(k,x){return new Float32Array(k,x,3)}function t(){return p()}function h(){return B(1,1,1)}function l(){return B(1,0,0)}function e(){return B(0,1,0)}function b(){return B(0,0,1)}const d=p(),a=h(),c=l(),f=e(),g=b(),n=Object.freeze(Object.defineProperty({__proto__:null,ONES:a,UNIT_X:c,UNIT_Y:f,UNIT_Z:g,ZEROS:d,clone:D,create:p,createView:u,fromValues:B,ones:h,unitX:l,unitY:e,unitZ:b,
zeros:t},Symbol.toStringTag,{value:"Module"}));m.ONES=a;m.UNIT_X=c;m.UNIT_Y=f;m.UNIT_Z=g;m.ZEROS=d;m.clone=D;m.create=p;m.createView=u;m.fromValues=B;m.ones=h;m.unitX=l;m.unitY=e;m.unitZ=b;m.vec3f32=n;m.zeros=t})},"esri/views/2d/navigation/MapViewNavigation":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Viewpoint ../../../core/Accessor ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ../../../geometry/Point ../viewpointUtils ./ZoomBox ./actions/Pan ./actions/Pinch ./actions/Rotate".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d,a,c,f,g){const n=new D({targetGeometry:new b}),k=[0,0];D=function(x){function r(q){q=x.call(this,q)||this;q._endTimer=null;q._lastEventTimestamp=null;q.animationManager=null;q.interacting=!1;return q}m._inheritsLoose(r,x);var v=r.prototype;v.initialize=function(){this.pan=new c({navigation:this});this.rotate=new g({navigation:this});this.pinch=new f({navigation:this});this.zoomBox=new a({view:this.view,navigation:this})};v.destroy=function(){this.pan=u.destroyMaybe(this.pan);
this.rotate=u.destroyMaybe(this.rotate);this.pinch=u.destroyMaybe(this.pinch);this.zoomBox=u.destroyMaybe(this.zoomBox);this.animationManager=null};v.begin=function(){this._set("interacting",!0)};v.end=function(){this._lastEventTimestamp=performance.now();this._startTimer(250)};v.zoom=function(){var q=m._asyncToGenerator(function*(y,A=this._getDefaultAnchor()){this.stop();this.begin();if(this.view.constraints.snapToZoom&&this.view.constraints.effectiveLODs)return 1>y?this.zoomIn(A):this.zoomOut(A);
this.setViewpoint(A,y,0,[0,0])});return function(y){return q.apply(this,arguments)}}();v.zoomIn=function(){var q=m._asyncToGenerator(function*(y){var A=this.view;A=A.constraints.snapToNextScale(A.scale);return this._zoomToScale(A,y)});return function(y){return q.apply(this,arguments)}}();v.zoomOut=function(){var q=m._asyncToGenerator(function*(y){var A=this.view;A=A.constraints.snapToPreviousScale(A.scale);return this._zoomToScale(A,y)});return function(y){return q.apply(this,arguments)}}();v.setViewpoint=
function(q,y,A,w){this.begin();this.view.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,q,y,A,w);this.end()};v.setViewpointImmediate=function(q,y=0,A=[0,0],w=this._getDefaultAnchor()){this.view.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,w,q,y,A)};v.continousRotateClockwise=function(){const q=this.get("view.viewpoint");this.animationManager?.animateContinous(q,y=>{d.rotateBy(y,y,-1)})};v.continousRotateCounterclockwise=function(){const q=this.get("view.viewpoint");
this.animationManager?.animateContinous(q,y=>{d.rotateBy(y,y,1)})};v.resetRotation=function(){this.view.rotation=0};v.continousPanLeft=function(){this._continuousPan([-10,0])};v.continousPanRight=function(){this._continuousPan([10,0])};v.continousPanUp=function(){this._continuousPan([0,10])};v.continousPanDown=function(){this._continuousPan([0,-10])};v.stop=function(){this.pan.stopMomentumNavigation();this.animationManager?.stop();this.end();null!==this._endTimer&&(clearTimeout(this._endTimer),this._endTimer=
null,this._set("interacting",!1))};v._continuousPan=function(q){const y=this.view.viewpoint;this.animationManager?.animateContinous(y,A=>{d.translateBy(A,A,q);this.view.constraints.constrainByGeometry(A)})};v._startTimer=function(q){return null!==this._endTimer?this._endTimer:this._endTimer=setTimeout(()=>{this._endTimer=null;const y=performance.now()-(this._lastEventTimestamp??0);250>y?this._endTimer=this._startTimer(y):this._set("interacting",!1)},q)};v._getDefaultAnchor=function(){const {size:q,
padding:{left:y,right:A,top:w,bottom:z}}=this.view;k[0]=.5*(q[0]-A+y);k[1]=.5*(q[1]-z+w);return k};v._zoomToScale=function(){var q=m._asyncToGenerator(function*(y,A=this._getDefaultAnchor()){const {view:w}=this,{constraints:z,scale:C,viewpoint:E,size:F,padding:G}=w,H=z.canZoomInTo(y),L=z.canZoomOutTo(y);if(!(y<C&&!H||y>C&&!L))return d.padAndScaleAndRotateBy(n,E,y/C,0,A,F,G),z.constrainByGeometry(n),w.goTo(n,{animate:!0})});return function(y){return q.apply(this,arguments)}}();v._scaleRotateTranslateViewpoint=
function(q,y,A,w,z){var {view:C}=this;const {size:E,padding:F,constraints:G,scale:H,viewpoint:L}=C;var K=H*A;C=G.canZoomInTo(K);K=G.canZoomOutTo(K);if(1>A&&!C||1<A&&!K)A=1;d.translateBy(L,L,z);d.padAndScaleAndRotateBy(q,L,A,w,y,E,F);return G.constrainByGeometry(q)};return r}(B);p.__decorate([t.property()],D.prototype,"animationManager",void 0);p.__decorate([t.property({type:Boolean,readOnly:!0})],D.prototype,"interacting",void 0);p.__decorate([t.property()],D.prototype,"pan",void 0);p.__decorate([t.property()],
D.prototype,"pinch",void 0);p.__decorate([t.property()],D.prototype,"rotate",void 0);p.__decorate([t.property()],D.prototype,"view",void 0);p.__decorate([t.property()],D.prototype,"zoomBox",void 0);return D=p.__decorate([e.subclass("esri.views.2d.navigation.MapViewNavigation")],D)})},"esri/views/2d/navigation/ZoomBox":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/screenUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ../../input/InputManager".split(" "),
function(m,p,D,B,u,t,h,l,e){D=function(b){function d(c){c=b.call(this,c)||this;c._container=null;c._overlay=null;c._backgroundShape=null;c._boxShape=null;c._box={x:0,y:0,width:0,height:0};c._rafId=null;c._handles=null;c._redraw=c._redraw.bind(m._assertThisInitialized(c));return c}m._inheritsLoose(d,b);var a=d.prototype;a.destroy=function(){this.view=null};a._start=function(){this._createContainer();this._createOverlay();this.navigation.begin()};a._update=function(c,f,g,n){this._box.x=c;this._box.y=
f;this._box.width=g;this._box.height=n;this._rafId||(this._rafId=requestAnimationFrame(this._redraw))};a._end=function(c,f,g,n,k){const x=this.view;c=x.toMap(B.createScreenPoint(c+.5*g,f+.5*n));g=Math.max(g/x.width,n/x.height);-1===k&&(g=1/g);this._destroyOverlay();this.navigation.end();x.goTo({center:c,scale:x.scale*g})};a._updateBox=function(c,f,g,n){const k=this._boxShape;k.setAttributeNS(null,"x",""+c);k.setAttributeNS(null,"y",""+f);k.setAttributeNS(null,"width",""+g);k.setAttributeNS(null,"height",
""+n);k.setAttributeNS(null,"class","esri-zoom-box__outline")};a._updateBackground=function(c,f,g,n){this._backgroundShape.setAttributeNS(null,"d",this._toSVGPath(c,f,g,n,this.view.width,this.view.height))};a._createContainer=function(){const c=document.createElement("div");c.className="esri-zoom-box__container";this.view.root.appendChild(c);this._container=c};a._createOverlay=function(){var c=this.view.width,f=this.view.height;const g=document.createElementNS("http://www.w3.org/2000/svg","path");
g.setAttributeNS(null,"d","M 0 0 L "+c+" 0 L "+c+" "+f+" L 0 "+f+" Z");g.setAttributeNS(null,"class","esri-zoom-box__overlay-background");c=document.createElementNS("http://www.w3.org/2000/svg","rect");f=document.createElementNS("http://www.w3.org/2000/svg","svg");f.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink");f.setAttributeNS(null,"class","esri-zoom-box__overlay");f.appendChild(g);f.appendChild(c);this._container.appendChild(f);this._backgroundShape=
g;this._boxShape=c;this._overlay=f};a._destroyOverlay=function(){this._container&&this._container.parentNode&&this._container.parentNode.removeChild(this._container);this._container=this._backgroundShape=this._boxShape=this._overlay=null};a._toSVGPath=function(c,f,g,n,k,x){g=c+g;n=f+n;return"M 0 0 L "+k+" 0 L "+k+" "+x+" L 0 "+x+" ZM "+c+" "+f+" L "+c+" "+n+" L "+g+" "+n+" L "+g+" "+f+" Z"};a._handleDrag=function(c,f){var g=c.x,n=c.y,k=c.origin.x;const x=c.origin.y;let r;g>k?(r=k,k=g-k):(r=g,k-=g);
n>x?(g=x,n-=x):(g=n,n=x-n);switch(c.action){case "start":this._start();break;case "update":this._update(r,g,k,n);break;case "end":this._end(r,g,k,n,f)}c.stopPropagation()};a._redraw=function(){if(this._rafId&&(this._rafId=null,this._overlay)){var {x:c,y:f,width:g,height:n}=this._box;this._updateBox(c,f,g,n);this._updateBackground(c,f,g,n);this._rafId=requestAnimationFrame(this._redraw)}};m._createClass(d,[{key:"view",set:function(c){this._handles&&this._handles.forEach(f=>{f.remove()});this._handles=
null;this._destroyOverlay();this._set("view",c);c&&(c.on("drag",["Shift"],f=>this._handleDrag(f,1),e.ViewEventPriorities.INTERNAL),c.on("drag",["Shift","Ctrl"],f=>this._handleDrag(f,-1),e.ViewEventPriorities.INTERNAL))}}]);return d}(D);p.__decorate([u.property()],D.prototype,"navigation",void 0);p.__decorate([u.property()],D.prototype,"view",null);return D=p.__decorate([l.subclass("esri.views.2d.navigation.ZoomBox")],D)})},"esri/views/2d/navigation/actions/Pan":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../Viewpoint ../../../../core/Accessor ../../../../core/reactiveUtils ../../../../core/screenUtils ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/accessorSupport/decorators/subclass ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../viewpointUtils ../../../navigation/PanPlanarMomentumEstimator ../../../../geometry/Point".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d,a,c,f,g,n){D=function(k){function x(v){var q=k.call(this,v)||this;q.animationTime=0;q.momentumEstimator=new g.PanPlanarMomentumEstimator(500,6,.92);q.momentum=null;q.tmpMomentum=c.create();q.momentumFinished=!1;q.viewpoint=new B({targetGeometry:new n,scale:0,rotation:0});q._previousDrag=null;t.when(()=>q.momentumFinished,()=>q.navigation.stop());return q}m._inheritsLoose(x,k);var r=x.prototype;r.begin=function(v,q){this.navigation.begin();this.momentumEstimator.reset();
this.addToEstimator(q);this._previousDrag=q};r.update=function(v,q){this.addToEstimator(q);let y=q.center.x,A=q.center.y;const w=this._previousDrag;y=w?w.center.x-y:-y;A=w?A-w.center.y:A;v.viewpoint=f.translateBy(this.viewpoint,v.viewpoint,[y||0,A||0]);this._previousDrag=q};r.end=function(v,q){this.addToEstimator(q);this.momentum=v.navigation.momentumEnabled?this.momentumEstimator.evaluateMomentum():null;this.animationTime=0;if(this.momentum)this.onAnimationUpdate(v);this._previousDrag=null;this.navigation.end()};
r.addToEstimator=function(v){var q=v.center.x;const y=v.center.y,A=h.createScreenPointArray(-q,y);q=c.fromValues(-q,y,0);this.momentumEstimator.add(A,q,.001*v.timestamp)};r.onAnimationUpdate=function(v){this.navigation.animationManager?.animateContinous(v.viewpoint,(q,y)=>{const {momentum:A,animationTime:w,tmpMomentum:z}=this;var C=this.momentumFinished=!A||A.isFinished(w);y*=.001;C||(C=A.valueDelta(w,y),a.scale(z,A.direction,C),f.translateBy(q,q,z),v.constraints.constrainByGeometry(q));this.animationTime+=
y})};r.stopMomentumNavigation=function(){this.momentum&&(this.momentumEstimator.reset(),this.momentum=null,this.navigation.stop())};return x}(u);p.__decorate([l.property()],D.prototype,"momentumFinished",void 0);p.__decorate([l.property()],D.prototype,"viewpoint",void 0);p.__decorate([l.property()],D.prototype,"navigation",void 0);return D=p.__decorate([d.subclass("esri.views.2d.navigation.actions.Pan")],D)})},"esri/views/navigation/PanPlanarMomentumEstimator":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/vec3 ../../chunks/vec3f64 ./FilteredFiniteDifference ./Momentum".split(" "),
function(m,p,D,B,u,t){let h=function(l){function e(b,d,a,c,f){b=l.call(this,b,d,a)||this;b._sceneVelocity=c;b.direction=f;return b}p._inheritsLoose(e,l);e.prototype.value=function(b){return l.prototype.valueFromInitialVelocity.call(this,this._sceneVelocity,b)};return e}(t.Momentum);t=function(){function l(b=300,d=12,a=.84){this._minimumInitialVelocity=b;this._stopVelocity=d;this._friction=a;this.enabled=!0;this._time=new u.FilteredFiniteDifference(.6);this._screen=[new u.FilteredFiniteDifference(.4),
new u.FilteredFiniteDifference(.4)];this._scene=[new u.FilteredFiniteDifference(.6),new u.FilteredFiniteDifference(.6),new u.FilteredFiniteDifference(.6)];this._tmpDirection=B.create()}var e=l.prototype;e.add=function(b,d,a){!this.enabled||this._time.hasLastValue()&&.015>this._time.computeDelta(a)||(this._screen[0].update(b[0]),this._screen[1].update(b[1]),this._scene[0].update(d[0]),this._scene[1].update(d[1]),this._scene[2].update(d[2]),this._time.update(a))};e.reset=function(){this._screen[0].reset();
this._screen[1].reset();this._scene[0].reset();this._scene[1].reset();this._scene[2].reset();this._time.reset()};e.evaluateMomentum=function(){if(!this.enabled||!this._screen[0].hasFilteredDelta()||!this._time.hasFilteredDelta())return null;var b=this._screen[0].filteredDelta,d=this._screen[1].filteredDelta;b=null==b||null==d?0:Math.sqrt(b*b+d*d);d=this._time.filteredDelta;b=null==d||null==b?0:b/d;return Math.abs(b)<this._minimumInitialVelocity?null:this.createMomentum(b,this._stopVelocity,this._friction)};
e.createMomentum=function(b,d,a){D.set(this._tmpDirection,this._scene[0].filteredDelta??0,this._scene[1].filteredDelta??0,this._scene[2].filteredDelta??0);const c=D.length(this._tmpDirection);0<c&&D.scale(this._tmpDirection,this._tmpDirection,1/c);const f=this._time.filteredDelta;return new h(b,d,a,null==f?0:c/f,this._tmpDirection)};return l}();m.PanPlanarMomentum=h;m.PanPlanarMomentumEstimator=t;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/navigation/FilteredFiniteDifference":function(){define(["exports"],
function(m){let p=function(){function D(u){this._gain=u;this.filteredDelta=this.lastValue=void 0}var B=D.prototype;B.update=function(u){if(this.hasLastValue()){const t=this.computeDelta(u);this._updateDelta(t)}this.lastValue=u};B.reset=function(){this.filteredDelta=this.lastValue=void 0};B.hasLastValue=function(){return void 0!==this.lastValue};B.hasFilteredDelta=function(){return void 0!==this.filteredDelta};B.computeDelta=function(u){return void 0===this.lastValue?NaN:u-this.lastValue};B._updateDelta=
function(u){this.filteredDelta=void 0!==this.filteredDelta?(1-this._gain)*this.filteredDelta+this._gain*u:u};return D}();m.FilteredFiniteDifference=p;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/navigation/Momentum":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers"],function(m,p){let D=function(){function B(t,h,l){this._initialVelocity=t;this._stopVelocity=h;this._friction=l;this._duration=Math.abs(Math.log(Math.abs(this._initialVelocity)/this._stopVelocity)/
Math.log(1-this._friction))}var u=B.prototype;u.isFinished=function(t){return t>this.duration};u.value=function(t){return this.valueFromInitialVelocity(this._initialVelocity,t)};u.valueDelta=function(t,h){const l=this.value(t);return this.value(t+h)-l};u.valueFromInitialVelocity=function(t,h){h=Math.min(h,this.duration);const l=1-this.friction;return t*(l**h-1)/Math.log(l)};p._createClass(B,[{key:"duration",get:function(){return this._duration}},{key:"friction",get:function(){return this._friction}}]);
return B}();m.Momentum=D;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/navigation/actions/Pinch":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../Viewpoint ../../../../core/Accessor ../../../../core/reactiveUtils ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/accessorSupport/decorators/subclass ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../viewpointUtils ../../../navigation/RotationMomentumEstimator ../../../navigation/ZoomMomentumEstimator ../../../../geometry/Point".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d,a,c,f,g,n){D=function(k){function x(v){var q=k.call(this,v)||this;q._animationTime=0;q._momentumFinished=!1;q._previousAngle=0;q._previousRadius=0;q._previousCenter=null;q._rotationMomentumEstimator=new f.RotationMomentumEstimator(.6,.15,.95);q._rotationDirection=1;q._startAngle=0;q._startRadius=0;q._updateTimestamp=null;q._zoomDirection=1;q._zoomMomentumEstimator=new g.ZoomMomentumEstimator;q._zoomOnly=null;q.zoomMomentum=null;q.rotateMomentum=null;q.viewpoint=new B({targetGeometry:new n,
scale:0,rotation:0});q.addHandles(t.when(()=>q._momentumFinished,()=>q.navigation.stop()));return q}m._inheritsLoose(x,k);var r=x.prototype;r.begin=function(v,q){this.navigation.begin();this._rotationMomentumEstimator.reset();this._zoomMomentumEstimator.reset();this._zoomOnly=null;this._previousAngle=this._startAngle=q.angle;this._previousRadius=this._startRadius=q.radius;this._previousCenter=q.center;this._updateTimestamp=null;v.constraints.rotationEnabled&&this.addToRotateEstimator(0,q.timestamp);
this.addToZoomEstimator(q,1)};r.update=function(v,q){null===this._updateTimestamp&&(this._updateTimestamp=q.timestamp);const y=q.angle,A=q.radius,w=q.center,z=Math.abs(180*(y-this._startAngle)/Math.PI),C=Math.abs(A-this._startRadius),E=this._startRadius/A;if(this._previousRadius&&this._previousCenter){const F=A/this._previousRadius;let G=180*(y-this._previousAngle)/Math.PI;this._rotationDirection=0<=G?1:-1;this._zoomDirection=1<=F?1:-1;v.constraints.rotationEnabled?(null===this._zoomOnly&&200<q.timestamp-
this._updateTimestamp&&(this._zoomOnly=0<C-z),null===this._zoomOnly||this._zoomOnly?G=0:this.addToRotateEstimator(y-this._startAngle,q.timestamp)):G=0;this.addToZoomEstimator(q,E);this.navigation.setViewpoint([w.x,w.y],1/F,G,[this._previousCenter.x-w.x,w.y-this._previousCenter.y])}this._previousAngle=y;this._previousRadius=A;this._previousCenter=w};r.end=function(v){this.rotateMomentum=this._rotationMomentumEstimator.evaluateMomentum();this.zoomMomentum=this._zoomMomentumEstimator.evaluateMomentum();
this._animationTime=0;if(this.rotateMomentum||this.zoomMomentum)this.onAnimationUpdate(v);this.navigation.end()};r.addToRotateEstimator=function(v,q){this._rotationMomentumEstimator.add(v,.001*q)};r.addToZoomEstimator=function(v,q){this._zoomMomentumEstimator.add(q,.001*v.timestamp)};r.canZoomIn=function(v){const q=v.scale;v=v.constraints.effectiveMaxScale;return 0===v||q>v};r.canZoomOut=function(v){const q=v.scale;v=v.constraints.effectiveMinScale;return 0===v||q<v};r.onAnimationUpdate=function(v){this.navigation.animationManager?.animateContinous(v.viewpoint,
(q,y)=>{var A=!this.canZoomIn(v)&&1<this._zoomDirection||!this.canZoomOut(v)&&1>this._zoomDirection,w=!this.rotateMomentum||this.rotateMomentum.isFinished(this._animationTime);A=A||!this.zoomMomentum||this.zoomMomentum.isFinished(this._animationTime);y*=.001;this._momentumFinished=w&&A;if(!this._momentumFinished){w=this.rotateMomentum?Math.abs(this.rotateMomentum.valueDelta(this._animationTime,y))*this._rotationDirection*180/Math.PI:0;A=this.zoomMomentum?Math.abs(this.zoomMomentum.valueDelta(this._animationTime,
y)):1;const C=a.create();var z=a.create();if(this._previousCenter){d.set(C,this._previousCenter.x,this._previousCenter.y);c.getPaddingScreenTranslation(z,v.size,v.padding);d.add(C,C,z);const {constraints:E,scale:F}=v;z=F*A;1>A&&!E.canZoomInTo(z)?(A=F/E.effectiveMaxScale,this.rotateMomentum=this.zoomMomentum=null):1<A&&!E.canZoomOutTo(z)&&(A=F/E.effectiveMinScale,this.rotateMomentum=this.zoomMomentum=null);c.scaleAndRotateBy(q,v.viewpoint,A,w,C,v.size);v.constraints.constrainByGeometry(q)}}this._animationTime+=
y})};r.stopMomentumNavigation=function(){if(this.rotateMomentum||this.zoomMomentum)this.rotateMomentum&&(this._rotationMomentumEstimator.reset(),this.rotateMomentum=null),this.zoomMomentum&&(this._zoomMomentumEstimator.reset(),this.zoomMomentum=null),this.navigation.stop()};return x}(u);p.__decorate([h.property()],D.prototype,"_momentumFinished",void 0);p.__decorate([h.property()],D.prototype,"viewpoint",void 0);p.__decorate([h.property()],D.prototype,"navigation",void 0);return D=p.__decorate([b.subclass("esri.views.2d.navigation.actions.Pinch")],
D)})},"esri/views/navigation/RotationMomentumEstimator":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","./MomentumEstimator"],function(m,p,D){D=function(B){function u(t=3,h=.01,l=.95,e=12){return B.call(this,t,h,l,e)||this}p._inheritsLoose(u,B);u.prototype.add=function(t,h){const l=this.value.lastValue;if(null!=l){for(t-=l;t>Math.PI;)t-=2*Math.PI;for(;t<-Math.PI;)t+=2*Math.PI;t=l+t}B.prototype.add.call(this,t,h)};return u}(D.MomentumEstimator);m.RotationMomentumEstimator=D;
Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/navigation/MomentumEstimator":function(){define(["exports","../../core/mathUtils","./FilteredFiniteDifference","./Momentum"],function(m,p,D,B){let u=function(){function t(l=2.5,e=.01,b=.95,d=12){this._minimumInitialVelocity=l;this._stopVelocity=e;this._friction=b;this._maxVelocity=d;this.enabled=!0;this.value=new D.FilteredFiniteDifference(.8);this.time=new D.FilteredFiniteDifference(.3)}var h=t.prototype;h.add=function(l,
e){if(this.enabled&&null!=e){if(this.time.hasLastValue()){if(.01>this.time.computeDelta(e))return;if(this.value.hasFilteredDelta()){const b=this.value.computeDelta(l);0>this.value.filteredDelta*b&&this.value.reset()}}this.time.update(e);this.value.update(l)}};h.reset=function(){this.value.reset();this.time.reset()};h.evaluateMomentum=function(){if(!this.enabled||!this.value.hasFilteredDelta()||!this.time.hasFilteredDelta())return null;let l=this.value.filteredDelta/this.time.filteredDelta;l=p.clamp(l,
-this._maxVelocity,this._maxVelocity);return Math.abs(l)<this._minimumInitialVelocity?null:this.createMomentum(l,this._stopVelocity,this._friction)};h.createMomentum=function(l,e,b){return new B.Momentum(l,e,b)};return t}();m.MomentumEstimator=u;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/navigation/ZoomMomentumEstimator":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","./Momentum","./MomentumEstimator"],function(m,p,D,B){let u=function(t){function h(e,
b,d){return t.call(this,e,b,d)||this}p._inheritsLoose(h,t);var l=h.prototype;l.value=function(e){e=t.prototype.value.call(this,e);return Math.exp(e)};l.valueDelta=function(e,b){const d=t.prototype.value.call(this,e);e=t.prototype.value.call(this,e+b);return Math.exp(e-d)};return h}(D.Momentum);D=function(t){function h(e=2.5,b=.01,d=.95,a=12){return t.call(this,e,b,d,a)||this}p._inheritsLoose(h,t);var l=h.prototype;l.add=function(e,b){t.prototype.add.call(this,Math.log(e),b)};l.createMomentum=function(e,
b,d){return new u(e,b,d)};return h}(B.MomentumEstimator);m.ZoomMomentum=u;m.ZoomMomentumEstimator=D;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/navigation/actions/Rotate":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../Viewpoint ../../../../core/Accessor ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/accessorSupport/decorators/subclass ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../viewpointUtils ../../../../geometry/Point".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d,a,c){const f=d.create(),g=d.create();D=function(n){function k(r){r=n.call(this,r)||this;r._previousCenter=d.create();r.viewpoint=new B({targetGeometry:new c,scale:0,rotation:0});return r}m._inheritsLoose(k,n);var x=k.prototype;x.begin=function(r,v){this.navigation.begin();b.set(this._previousCenter,v.center.x,v.center.y)};x.update=function(r,v){const {state:{size:q,padding:y}}=r;b.set(f,v.center.x,v.center.y);a.getAnchor(g,q,y);r.viewpoint=a.rotateBy(this.viewpoint,
r.state.paddedViewState.viewpoint,a.angleBetween(g,this._previousCenter,f));b.copy(this._previousCenter,f)};x.end=function(){this.navigation.end()};return k}(u);p.__decorate([t.property()],D.prototype,"viewpoint",void 0);p.__decorate([t.property()],D.prototype,"navigation",void 0);return D=p.__decorate([e.subclass("esri.views.2d.actions.Rotate")],D)})},"esri/views/2d/magnifier/MagnifierView2D":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../request ../../../core/asyncUtils ../../../core/Handles ../../../core/mathUtils ../../../core/maybe ../../../core/reactiveUtils ../../../core/urlUtils ../../../chunks/mat3f32 ../engine/DisplayObject ../engine/webgl/DefaultVertexAttributeLayouts ../engine/webgl/enums ../engine/webgl/shaders/MagnifierPrograms ../../magnifier/resources ../../webgl/BufferObject ../../webgl/enums ../../webgl/Texture ../../webgl/VertexArrayObject".split(" "),
function(m,p,D,B,u,t,h,l,e,b,d,a,c,f,g,n,k,x){return function(r){function v(){var y=r.call(this)||this;y._handles=new B;y._resourcePixelRatio=1;y.visible=!1;return y}m._inheritsLoose(v,r);var q=v.prototype;q.destroy=function(){this._handles=t.destroyMaybe(this._handles);this._disposeRenderResources();this._resourcesTask=t.abortMaybe(this._resourcesTask)};q._createTransforms=function(){return{dvs:e.create()}};q.doRender=function(y){const A=y.context;if(!this._resourcesTask)this._reloadResources();
else if(y.drawPhase===a.WGLDrawPhase.MAP&&this._canRender()){this._updateResources(y);var w=this._magnifier;if(!t.isNone(w.position)){var z=y.pixelRatio,C=w.size*z,E=Math.ceil(1/w.factor*C);this._readbackTexture.resize(E,E);var {size:F}=y.state;y=z*F[0];F=z*F[1];var G=.5*E,H=.5*E,L=u.clamp(z*w.position.x,G,y-G-1),K=u.clamp(F-z*w.position.y,H,F-H-1);A.setBlendingEnabled(!0);G=L-G;H=K-H;var M=this._readbackTexture;A.bindTexture(M,0);A.gl.copyTexImage2D(M.descriptor.target,0,M.descriptor.pixelFormat,
G,H,E,E,0);E=(E=this.background?.color)?[E.a*E.r/255,E.a*E.g/255,E.a*E.b/255,E.a]:[1,1,1,1];L=-1+(L+w.offset.x*z)/y*2;z=-1+(K-w.offset.y*z)/F*2;y=C/y*2;C=C/F*2;F=this._program;A.bindVAO(this._vertexArrayObject);A.bindTexture(this._overlayTexture,6);A.bindTexture(this._maskTexture,7);A.useProgram(F);F.setUniform4fv("u_background",E);F.setUniform1i("u_readbackTexture",0);F.setUniform1i("u_overlayTexture",6);F.setUniform1i("u_maskTexture",7);F.setUniform4f("u_drawPos",L,z,y,C);F.setUniform1i("u_maskEnabled",
w.maskEnabled?1:0);F.setUniform1i("u_overlayEnabled",w.overlayEnabled?1:0);A.setStencilTestEnabled(!1);A.setColorMask(!0,!0,!0,!0);A.drawArrays(n.PrimitiveType.TRIANGLE_STRIP,0,4);A.bindVAO()}}};q._canRender=function(){return this.mask&&this.overlay&&null!=this._magnifier};q._reloadResources=function(){var y=this;this._resourcesTask&&this._resourcesTask.abort();const A=t.isSome(this._magnifier)?this._magnifier.maskUrl:null,w=t.isSome(this._magnifier)?this._magnifier.overlayUrl:null;this._resourcesTask=
D.createTask(function(){var z=m._asyncToGenerator(function*(C){const E=t.isNone(A)||t.isNone(w)?f.loadMagnifierResources(C):null,F=t.isSome(A)?p(A,{responseType:"image",signal:C}).then(L=>L.data):E.then(L=>L.mask);C=t.isSome(w)?p(w,{responseType:"image",signal:C}).then(L=>L.data):E.then(L=>L.overlay);const [G,H]=yield Promise.all([F,C]);y.mask=G;y.overlay=H;y._disposeRenderResources();y.requestRender()});return function(C){return z.apply(this,arguments)}}())};q._disposeRenderResources=function(){this._readbackTexture=
t.disposeMaybe(this._readbackTexture);this._overlayTexture=t.disposeMaybe(this._overlayTexture);this._maskTexture=t.disposeMaybe(this._maskTexture);this._vertexArrayObject=t.disposeMaybe(this._vertexArrayObject);this._program=t.disposeMaybe(this._program)};q._updateResources=function(y){y.pixelRatio!==this._resourcePixelRatio&&this._disposeRenderResources();if(!this._readbackTexture){var A=y.context;this._resourcePixelRatio=y.pixelRatio;var w=Math.ceil(this._magnifier.size*y.pixelRatio);this._program=
c.createMagnifierProgram(A);var z=new Uint16Array([0,1,0,0,1,1,1,0]);this._vertexArrayObject=new x.VertexArrayObject(A,c.magnifierProgramTemplate.attributes,d.Pos2us,{geometry:g.BufferObject.createVertex(A,n.Usage.STATIC_DRAW,z)});this.overlay.width=w;this.overlay.height=w;this._overlayTexture=new k.Texture(A,{target:n.TextureType.TEXTURE_2D,pixelFormat:n.PixelFormat.RGBA,internalFormat:n.PixelFormat.RGBA,dataType:n.PixelType.UNSIGNED_BYTE,wrapMode:n.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:n.TextureSamplingMode.NEAREST,
flipped:!0,preMultiplyAlpha:l.isSVG(this.overlay.src)&&y.context.driverTest.svgPremultipliesAlpha.result?!1:!0},this.overlay);this.mask.width=w;this.mask.height=w;this._maskTexture=new k.Texture(A,{target:n.TextureType.TEXTURE_2D,pixelFormat:n.PixelFormat.ALPHA,internalFormat:n.PixelFormat.ALPHA,dataType:n.PixelType.UNSIGNED_BYTE,wrapMode:n.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:n.TextureSamplingMode.NEAREST,flipped:!0},this.mask);y=1/this._magnifier.factor;this._readbackTexture=new k.Texture(A,
{target:n.TextureType.TEXTURE_2D,pixelFormat:n.PixelFormat.RGBA,internalFormat:n.PixelFormat.RGBA,dataType:n.PixelType.UNSIGNED_BYTE,wrapMode:n.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:n.TextureSamplingMode.LINEAR,flipped:!1,width:Math.ceil(y*w),height:Math.ceil(y*w)})}};m._createClass(v,[{key:"background",get:function(){return this._background},set:function(y){this._background=y;this.requestRender()}},{key:"magnifier",get:function(){return this._magnifier},set:function(y){this._magnifier=y;this._handles.removeAll();
this._handles.add([h.watch(()=>y.version,()=>{this.visible=y.visible&&t.isSome(y.position)&&0<y.size;this.requestRender()},h.initial),h.watch(()=>[y.maskUrl,y.overlayUrl],()=>this._reloadResources()),h.watch(()=>y.size,()=>{this._disposeRenderResources();this.requestRender()})])}}]);return v}(b.DisplayObject)})},"esri/views/2d/engine/webgl/shaders/MagnifierPrograms":function(){define(["exports","./sources/resolver","../../../../webgl/ProgramTemplate"],function(m,p,D){const B={shaders:{vertexShader:p.resolveIncludes("magnifier/magnifier.vert"),
fragmentShader:p.resolveIncludes("magnifier/magnifier.frag")},attributes:new Map([["a_pos",0]])};m.createMagnifierProgram=function(u){return D.createProgram(u,B)};m.magnifierProgramTemplate=B;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/magnifier/resources":function(){define(["require","exports","../../chunks/_rollupPluginBabelHelpers","../../core/promiseUtils","../../support/requestImageUtils"],function(m,p,D,B,u){function t(){t=D._asyncToGenerator(function*(l){var e=
new Promise((d,a)=>m(["./mask-svg"],c=>d(h(c)),a)),b=new Promise((d,a)=>m(["./overlay-svg"],c=>d(h(c)),a));e=u.requestImage((yield e).default,{signal:l});b=u.requestImage((yield b).default,{signal:l});b={mask:yield e,overlay:yield b};B.throwIfAborted(l);return b});return t.apply(this,arguments)}const h=l=>Object.freeze(Object.defineProperty({__proto__:null,default:l},Symbol.toStringTag,{value:"Module"}));p.loadMagnifierResources=function(l){return t.apply(this,arguments)};Object.defineProperty(p,
Symbol.toStringTag,{value:"Module"})})},"esri/support/requestImageUtils":function(){define(["exports","../chunks/_rollupPluginBabelHelpers","../request"],function(m,p,D){function B(){B=p._asyncToGenerator(function*(u,t){({data:u}=yield D(u,{responseType:"image",...t}));return u});return B.apply(this,arguments)}m.requestImage=function(u,t){return B.apply(this,arguments)};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/mat4":function(){define(["exports","../../../chunks/mat4"],
function(m,p){m.mat4=p.mat4;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/mat4f32":function(){define(["exports","../../../chunks/mat4f32"],function(m,p){m.mat4f32=p.mat4f32;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/vec3f32":function(){define(["exports","../../../chunks/vec3f32"],function(m,p){m.vec3f32=p.vec3f32;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/vec4f32":function(){define(["exports",
"../../../chunks/vec4f32"],function(m,p){m.vec4f32=p.vec4f32;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/Bitmap":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../core/promiseUtils ../../../chunks/mat3 ../../../chunks/mat3f32 ../../../chunks/vec2f32 ./DisplayObject ./ImageryBitmapSource ../../webgl/context-util ../../webgl/enums ../../webgl/Texture".split(" "),function(m,p,D,B,u,t,h,l,e,b,d,a){function c(n){return n&&
"render"in n}function f(n){const k=document.createElement("canvas");k.width=n.width;k.height=n.height;n.render(k.getContext("2d"));return k}function g(n){return c(n)?n instanceof e?D.applySome(n.getRenderedRasterPixels(),k=>k.renderedRasterPixels):f(n):n}l=function(n){function k(r=null,v){var q=n.call(this)||this;q.blendFunction="standard";q._sourceWidth=0;q._sourceHeight=0;q._textureInvalidated=!1;q._texture=null;q.stencilRef=0;q.coordScale=[1,1];q._height=void 0;q.pixelRatio=1;q.resolution=0;q.rotation=
0;q._source=null;q._width=void 0;q.x=0;q.y=0;q.immutable=v.immutable??!1;q.requestRenderOnSourceChangedEnabled=v.requestRenderOnSourceChangedEnabled??!0;q.source=r;q.requestRender=q.requestRender.bind(p._assertThisInitialized(q));return q}p._inheritsLoose(k,n);var x=k.prototype;x.destroy=function(){this._texture&&(this._texture.dispose(),this._texture=null);D.isSome(this._uploadStatus)&&(this._uploadStatus.controller.abort(),this._uploadStatus=null)};x.beforeRender=function(r){n.prototype.beforeRender.call(this,
r);this.updateTexture(r)};x.setSourceAsync=function(){var r=p._asyncToGenerator(function*(v,q){D.isSome(this._uploadStatus)&&this._uploadStatus.controller.abort();const y=new AbortController,A=B.createResolver();B.onAbortOrThrow(q,()=>y.abort());B.onAbortOrThrow(y,w=>A.reject(w));this._uploadStatus={controller:y,resolver:A};this.source=v;return A.promise});return function(v,q){return r.apply(this,arguments)}}();x.invalidateTexture=function(){this._textureInvalidated||(this._textureInvalidated=!0,
this.requestRenderOnSourceChangedEnabled&&this.requestRender())};x.updateTransitionProperties=function(r,v){64<=r&&(this.inFadeTransition=this.fadeTransitionEnabled=!1);n.prototype.updateTransitionProperties.call(this,r,v)};x.setTransform=function(r){const v=u.identity(this.transforms.dvs),[q,y]=r.toScreenNoRotation([0,0],[this.x,this.y]);var A=this.resolution/this.pixelRatio/r.resolution;const w=A*this.width;A*=this.height;const z=Math.PI*this.rotation/180;u.translate(v,v,h.fromValues(q,y));u.translate(v,
v,h.fromValues(w/2,A/2));u.rotate(v,v,-z);u.translate(v,v,h.fromValues(-w/2,-A/2));u.scaleByVec2(v,v,h.fromValues(w,A));u.multiply(this.transforms.dvs,r.displayViewMat3,v)};x.setSamplingProfile=function(r){this._texture&&(r.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(r.samplingMode))};x.bind=function(r,v){this._texture&&r.bindTexture(this._texture,v)};x.updateTexture=function(){var r=p._asyncToGenerator(function*({context:v,painter:q}){if(this._textureInvalidated)if(this._textureInvalidated=
!1,this._texture||(this._texture=this._createTexture(v)),this.source){this._texture.resize(this._sourceWidth,this._sourceHeight);v=g(this.source);try{if(D.isSome(this._uploadStatus)){const {controller:y,resolver:A}=this._uploadStatus,w={signal:y.signal},{width:z,height:C}=this;yield q.textureUploadManager.enqueueTextureUpdate({data:v,texture:this._texture,width:z,height:C},w);A.resolve();this._uploadStatus=null}else this._texture.setData(v);this.ready()}catch(y){B.throwIfNotAbortError(y)}}else this._texture.setData(null)});
return function(v){return r.apply(this,arguments)}}();x.onDetach=function(){this.destroy()};x._createTransforms=function(){return{dvs:t.create()}};x._createTexture=function(r){const v=this.immutable&&r.type===b.ContextType.WEBGL2;return new a.Texture(r,{target:d.TextureType.TEXTURE_2D,pixelFormat:d.PixelFormat.RGBA,internalFormat:v?d.SizedPixelFormat.RGBA8:d.PixelFormat.RGBA,dataType:d.PixelType.UNSIGNED_BYTE,wrapMode:d.TextureWrapMode.CLAMP_TO_EDGE,isImmutable:v,width:this._sourceWidth,height:this._sourceHeight})};
p._createClass(k,[{key:"isSourceScaled",get:function(){return this.width!==this._sourceWidth||this.height!==this._sourceHeight}},{key:"height",get:function(){return void 0!==this._height?this._height:this._sourceHeight},set:function(r){this._height=r}},{key:"source",get:function(){return this._source},set:function(r){if(null!=r||null!=this._source)this._source=r,this._source instanceof HTMLImageElement?(this._sourceHeight=this._source.naturalHeight,this._sourceWidth=this._source.naturalWidth):this._source&&
(this._sourceHeight=this._source.height,this._sourceWidth=this._source.width),this.invalidateTexture()}},{key:"width",get:function(){return void 0!==this._width?this._width:this._sourceWidth},set:function(r){this._width=r}}]);return k}(l.DisplayObject);m.Bitmap=l;m.isImageSource=c;m.rasterize=f;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/ImageryBitmapSource":function(){define(["../../../chunks/_rollupPluginBabelHelpers","../../../core/maybe"],function(m,p){return function(){function D(u,
t,h){this.pixelBlock=u;this.extent=t;this.originalPixelBlock=h}var B=D.prototype;B.render=function(u){var t=this.pixelBlock;if(!p.isNone(t)){var h=this.filter({extent:this.extent,pixelBlock:this.originalPixelBlock??t});p.isNone(h.pixelBlock)||(h.pixelBlock.maskIsAlpha&&(h.pixelBlock.premultiplyAlpha=!0),t=h.pixelBlock.getAsRGBA(),h=u.createImageData(h.pixelBlock.width,h.pixelBlock.height),h.data.set(t),u.putImageData(h,0,0))}};B.getRenderedRasterPixels=function(){const u=this.filter({extent:this.extent,
pixelBlock:this.pixelBlock});if(p.isNone(u.pixelBlock))return null;u.pixelBlock.maskIsAlpha&&(u.pixelBlock.premultiplyAlpha=!0);return{width:u.pixelBlock.width,height:u.pixelBlock.height,renderedRasterPixels:new Uint8Array(u.pixelBlock.getAsRGBA().buffer)}};m._createClass(D,[{key:"width",get:function(){return p.isSome(this.pixelBlock)?this.pixelBlock.width:0}},{key:"height",get:function(){return p.isSome(this.pixelBlock)?this.pixelBlock.height:0}}]);return D}()})},"esri/views/2d/engine/BitmapContainer":function(){define(["exports",
"../../../chunks/_rollupPluginBabelHelpers","./brushes","./webgl/enums","./webgl/WGLContainer"],function(m,p,D,B,u){u=function(t){function h(){var e=t.apply(this,arguments)||this;e._hasCrossfade=!1;return e}p._inheritsLoose(h,t);var l=h.prototype;l.beforeRender=function(e){t.prototype.beforeRender.call(this,e);this._manageFade()};l.prepareRenderPasses=function(e){const b=e.registerRenderPass({name:"bitmap",brushes:[D.brushes.bitmap],target:()=>this.children,drawPhase:B.WGLDrawPhase.MAP});return[...t.prototype.prepareRenderPasses.call(this,
e),b]};l._manageFade=function(){2<=this.children.reduce((e,b)=>e+(b.inFadeTransition?1:0),0)?(this.children.forEach(e=>e.blendFunction="additive"),this._hasCrossfade=!0):(this.children.forEach(e=>e.blendFunction="standard"),this._hasCrossfade=!1)};p._createClass(h,[{key:"requiresDedicatedFBO",get:function(){return this._hasCrossfade}}]);return h}(u);m.BitmapContainer=u;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/BitmapTile":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers",
"../../../chunks/mat3f32","./Bitmap","./webgl/TiledDisplayObject"],function(m,p,D,B,u){u=function(t){function h(e,b,d,a,c,f,g=null){var n=t.call(this,e,b,d,a,c,f)||this;n.bitmap=new B.Bitmap(g,{immutable:!1,requestRenderOnSourceChangedEnabled:!1});n.bitmap.coordScale=[c,f];n.bitmap.once("isReady",()=>n.ready());return n}p._inheritsLoose(h,t);var l=h.prototype;l.destroy=function(){t.prototype.destroy.call(this);this.bitmap.destroy()};l.beforeRender=function(e){t.prototype.beforeRender.call(this,e);
this.bitmap.beforeRender(e)};l.afterRender=function(e){t.prototype.afterRender.call(this,e);this.bitmap.afterRender(e)};l._createTransforms=function(){return{dvs:D.create(),tileMat3:D.create()}};l.setTransform=function(e){t.prototype.setTransform.call(this,e);this.bitmap.transforms.dvs=this.transforms.dvs};l.onAttach=function(){this.bitmap.stage=this.stage};l.onDetach=function(){this.bitmap&&(this.bitmap.stage=null)};p._createClass(h,[{key:"stencilRef",get:function(){return this.bitmap.stencilRef},
set:function(e){this.bitmap.stencilRef=e}}]);return h}(u.TiledDisplayObject);m.BitmapTile=u;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/BitmapTileContainer":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../geometry/support/aaBoundingRect ./BitmapTile ./brushes ./webgl/enums ./webgl/TileContainer".split(" "),function(m,p,D,B,u,t,h){h=function(l){function e(){return l.apply(this,arguments)||this}p._inheritsLoose(e,l);var b=e.prototype;
b.createTile=function(d){const a=this._tileInfoView.getTileBounds(D.create(),d),c=this._tileInfoView.getTileResolution(d.level),[f,g]=this._tileInfoView.tileInfo.size;return new B.BitmapTile(d,c,a[0],a[3],f,g)};b.prepareRenderPasses=function(d){const a=d.registerRenderPass({name:"bitmap (tile)",brushes:[u.brushes.bitmap],target:()=>this.children.map(c=>c.bitmap),drawPhase:t.WGLDrawPhase.MAP});return[...l.prototype.prepareRenderPasses.call(this,d),a]};b.doRender=function(d){this.visible&&d.drawPhase===
t.WGLDrawPhase.MAP&&l.prototype.doRender.call(this,d)};p._createClass(e,[{key:"requiresDedicatedFBO",get:function(){return this.children.some(d=>"additive"===d.bitmap.blendFunction)}}]);return e}(h);m.BitmapTileContainer=h;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("exports ./engine/Stage ./LabelManager ./layers/graphics/GraphicsView2D ./layers/graphics/GraphicContainer ./navigation/MapViewNavigation ./magnifier/MagnifierView2D".split(" "),function(m,p,D,B,u,t,h){m.Stage=p.Stage;m.LabelManager=D;m.GraphicsView2D=B;m.GraphicContainer=u;m.MapViewNavigation=t;m.MagnifierView2D=h;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})});