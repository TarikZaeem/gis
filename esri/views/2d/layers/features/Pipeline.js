// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.26/esri/copyright.txt for details.
//>>built
require({cache:{"esri/core/HandleOwner":function(){define("exports ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./Accessor ./Handles ./accessorSupport/decorators/property ./accessorSupport/decorators/subclass ./support/WatchUpdatingTracking".split(" "),function(u,t,H,C,w,y,x,m){const h=c=>{c=function(d){function f(){return d.apply(this,arguments)||this}t._inheritsLoose(f,d);f.prototype.destroy=function(){this.destroyed||(this._get("handles")?.destroy(),this._get("updatingHandles")?.destroy())};
t._createClass(f,[{key:"handles",get:function(){return this._get("handles")||new w}},{key:"updatingHandles",get:function(){return this._get("updatingHandles")||new m.WatchUpdatingTracking}}]);return f}(c);H.__decorate([y.property({readOnly:!0})],c.prototype,"handles",null);H.__decorate([y.property({readOnly:!0})],c.prototype,"updatingHandles",null);return c=H.__decorate([x.subclass("esri.core.HandleOwner")],c)};u.HandleOwner=function(c){function d(){return c.apply(this,arguments)||this}t._inheritsLoose(d,
c);return d}(h(C));u.HandleOwner=H.__decorate([x.subclass("esri.core.HandleOwner")],u.HandleOwner);u.HandleOwnerMixin=h;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/core/support/WatchUpdatingTracking":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../Accessor ../Handles ../maybe ../reactiveUtils ../scheduling ../accessorSupport/decorators/property ../accessorSupport/decorators/subclass".split(" "),function(u,t,H,C,w,y,x,m,h,c){u.WatchUpdatingTracking=
function(d){function f(){var g=d.apply(this,arguments)||this;g.updating=!1;g._handleId=0;g._handles=new w;g._scheduleHandleId=0;g._pendingPromises=new Set;return g}t._inheritsLoose(f,d);var k=f.prototype;k.destroy=function(){this.removeAll();this._handles.destroy()};k.add=function(g,e,a={}){return this._installWatch(g,e,a,x.watch)};k.addWhen=function(g,e,a={}){return this._installWatch(g,e,a,x.when)};k.addOnCollectionChange=function(g,e,{initial:a=!1,final:b=!1}={}){const l=++this._handleId;this._handles.add([x.on(g,
"after-changes",this._createSyncUpdatingCallback(),x.sync),x.on(g,"change",e,{onListenerAdd:a?q=>e({added:q.toArray(),removed:[]}):void 0,onListenerRemove:b?q=>e({added:[],removed:q.toArray()}):void 0})],l);return{remove:()=>this._handles.remove(l)}};k.addPromise=function(g){if(y.isNone(g))return g;const e=++this._handleId;this._handles.add({remove:()=>{this._pendingPromises.delete(g)&&(0!==this._pendingPromises.size||this._handles.has(-42)||this._set("updating",!1))}},e);this._pendingPromises.add(g);
this._set("updating",!0);const a=()=>this._handles.remove(e);g.then(a,a);return g};k.removeAll=function(){this._pendingPromises.clear();this._handles.removeAll();this._set("updating",!1)};k._installWatch=function(g,e,a={},b){const l=++this._handleId;a.sync||this._installSyncUpdatingWatch(g,l);g=b(g,e,a);this._handles.add(g,l);return{remove:()=>this._handles.remove(l)}};k._installSyncUpdatingWatch=function(g,e){const a=this._createSyncUpdatingCallback();g=x.watch(g,a,{sync:!0,equals:()=>!1});this._handles.add(g,
e);return g};k._createSyncUpdatingCallback=function(){return()=>{this._handles.remove(-42);++this._scheduleHandleId;const g=this._scheduleHandleId;this._get("updating")||this._set("updating",!0);this._handles.add(m.schedule(()=>{g===this._scheduleHandleId&&(this._set("updating",0<this._pendingPromises.size),this._handles.remove(-42))}),-42)}};return f}(C);H.__decorate([h.property({readOnly:!0})],u.WatchUpdatingTracking.prototype,"updating",void 0);u.WatchUpdatingTracking=H.__decorate([c.subclass("esri.core.support.WatchUpdatingTracking")],
u.WatchUpdatingTracking);Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/core/reactiveUtils":function(){define("exports ./events ./handleUtils ./maybe ./promiseUtils ./accessorSupport/watch ./accessorSupport/trackingUtils".split(" "),function(u,t,H,C,w,y,x){function m(k,g,e={}){return h(k,g,e,d)}function h(k,g,e={},a){let b=null;const l=e.once?(q,n)=>{a(q)&&(C.removeMaybe(b),g(q,n))}:(q,n)=>{a(q)&&g(q,n)};b=y.watchTracked(k,l,e.sync,e.equals);e.initial&&(k=k(),l(k,k));return b}
function c(k,g,e){if(w.isAborted(e))return Promise.reject(w.createAbortError());const a=k();if(g?.(a))return Promise.resolve(a);let b=null;return new Promise((l,q)=>{b=H.handlesGroup([w.onAbort(e,()=>{b=C.removeMaybe(b);q(w.createAbortError())}),h(k,n=>{b=C.removeMaybe(b);l(n)},{sync:!1,once:!0},g??d)])})}function d(k){return!0}function f(k){return!!k}u.autorun=x.autorun;u.initial={initial:!0};u.on=function(k,g,e,a={}){function b(){q&&n&&(n.remove(),a.onListenerRemove?.(q),n=q=null)}function l(z){a.once&&
a.once&&C.removeMaybe(v);e(z)}let q=null,n=null,v=null;const B=m(k,(z,p)=>{b();t.isEventTarget(z)&&(q=z,n=t.on(z,g,l),a.onListenerAdd?.(z))},{sync:a.sync,initial:!0});return v=H.makeHandle(()=>{B.remove();b()})};u.once=function(k,g){return c(k,null,g)};u.pausable=function(k,g,e={}){let a=!1;const b=m(k,(l,q)=>{a||g(l,q)},e);return{remove(){b.remove()},pause(){a=!0},resume(){a=!1}}};u.sync={sync:!0};u.syncAndInitial={sync:!0,initial:!0};u.watch=m;u.when=function(k,g,e={}){return h(k,g,e,f)};u.whenOnce=
function(k,g){return c(k,f,g)};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/TileInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/maybe ../../core/unitUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../geometry/Point ../../geometry/SpatialReference ../../geometry/support/aaBoundingRect ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ./LOD ./TileKey".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f,k,g,e,a,b,l,q){var n;H=new H.JSONMap({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});C=n=function(v){function B(p){p=v.call(this,p)||this;p.dpi=96;p.format=null;p.origin=null;p.minScale=0;p.maxScale=0;p.size=null;p.spatialReference=null;return p}u._inheritsLoose(B,v);B.create=function(p=
{}){const {resolutionFactor:r=1,scales:D,size:J=256,spatialReference:K=g.WebMercator,numLODs:F=24}=p;if(!a.isValid(K)){p=[];if(D)for(var A=0;A<D.length;A++){var I=D[A];p.push(new l({level:A,scale:I,resolution:I}))}else for(A=5E-4,I=F-1;0<=I;I--)p.unshift(new l({level:I,scale:A,resolution:A})),A*=2;return new n({dpi:96,lods:p,origin:new k(0,0,K),size:[J,J],spatialReference:K})}A=a.getInfo(K);p=p.origin?new k({x:p.origin.x,y:p.origin.y,spatialReference:K}):A?new k({x:A.origin[0],y:A.origin[1],spatialReference:K}):
new k({x:0,y:0,spatialReference:K});A=1/(39.37*y.getMetersPerUnitForSR(K)*96);I=[];if(D)for(var G=0;G<D.length;G++){var E=D[G];I.push(new l({level:G,scale:E,resolution:E*A}))}else{var M=a.isGeographic(K)?512/J*5.916575275917094E8:256/J*5.91657527591555E8;G=Math.ceil(F/r);I.push(new l({level:0,scale:M,resolution:M*A}));for(E=1;E<G;E++)M/=2**r,I.push(new l({level:E,scale:M,resolution:M*A}))}return new n({dpi:96,lods:I,origin:p,size:[J,J],spatialReference:K})};var z=B.prototype;z.readOrigin=function(p,
r){return k.fromJSON({spatialReference:r.spatialReference,...p})};z.readSize=function(p,r){return[r.cols,r.rows]};z.writeSize=function(p,r){r.cols=p[0];r.rows=p[1]};z.zoomToScale=function(p){const r=this.scales;if(0>=p)return r[0];if(p>=r.length-1)return r[r.length-1];const D=Math.floor(p);return r[D]/(r[D]/r[D+1])**(p-D)};z.scaleToZoom=function(p){const r=this.scales,D=r.length-1;let J=0;for(;J<D;J++){const K=r[J],F=r[J+1];if(K<=p)break;if(F===p)return J+1;if(K>p&&F<p)return J+Math.log(K/p)/Math.log(K/
F)}return J};z.snapScale=function(p,r=.95){p=this.scaleToZoom(p);return p%Math.floor(p)>=r?this.zoomToScale(Math.ceil(p)):this.zoomToScale(Math.floor(p))};z.tileAt=function(p,r,D,J){var K=this.lodAt(p);if(!K)return null;let F;if("number"===typeof r)F=r,r=D;else{if(a.equals(r.spatialReference,this.spatialReference))F=r.x,r=r.y;else{J=b.project(r,this.spatialReference);if(w.isNone(J))return null;F=J.x;r=J.y}J=D}D=K.resolution*this.size[0];K=K.resolution*this.size[1];J||(J=new q.TileKey(null,0,0,0,e.create()));
J.level=p;J.row=Math.floor((this.origin.y-r)/K+.001);J.col=Math.floor((F-this.origin.x)/D+.001);this.updateTileInfo(J);return J};z.updateTileInfo=function(p,r=n.ExtrapolateOptions.NONE){var D=this.lodAt(p.level);D||r!==n.ExtrapolateOptions.POWER_OF_TWO||(r=this.lods[this.lods.length-1],r.level<p.level&&(D=r));if(D){var J=p.level-D.level;r=D.resolution*this.size[0]/2**J;D=D.resolution*this.size[1]/2**J;p.id=`${p.level}/${p.row}/${p.col}`;p.extent||(p.extent=e.create());p.extent[0]=this.origin.x+p.col*
r;p.extent[1]=this.origin.y-(p.row+1)*D;p.extent[2]=p.extent[0]+r;p.extent[3]=p.extent[1]+D}};z.upsampleTile=function(p){const r=this._upsampleLevels[p.level];if(!r||-1===r.parentLevel)return!1;p.level=r.parentLevel;p.row=Math.floor(p.row/r.factor+.001);p.col=Math.floor(p.col/r.factor+.001);this.updateTileInfo(p);return!0};z.getTileBounds=function(p,r){var D=this.lodAt(r.level);if(null==D)return null;var {resolution:J}=D;D=J*this.size[0];J*=this.size[1];p[0]=this.origin.x+r.col*D;p[1]=this.origin.y-
(r.row+1)*J;p[2]=p[0]+D;p[3]=p[1]+J;return p};z.lodAt=function(p){return this._levelToLOD?.[p]??null};z.clone=function(){return n.fromJSON(this.write({}))};z.getOrCreateCompatible=function(p,r){if(256===this.size[0]&&256===this.size[1])return 256===p?this:null;const D=[],J=this.lods.length;for(let K=0;K<J;K++){const F=this.lods[K];D.push(new l({level:F.level,scale:F.scale,resolution:F.resolution*r}))}return new n({size:[p,p],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,
origin:this.origin,spatialReference:this.spatialReference,lods:D})};z._initializeUpsampleLevels=function(){const p=this.lods;this._upsampleLevels=[];let r=null;for(let D=0;D<p.length;D++){const J=p[D];this._upsampleLevels[J.level]={parentLevel:r?r.level:-1,factor:r?r.resolution/J.resolution:0};r=J}};u._createClass(B,[{key:"isWrappable",get:function(){const {spatialReference:p,origin:r}=this;if(p&&r){const D=a.getInfo(p);return p.isWrappable&&!!D&&Math.abs(D.origin[0]-r.x)<=D.dx}return!1}},{key:"lods",
set:function(p){let r=0,D=0;const J=[],K=this._levelToLOD={};p&&(r=-Infinity,D=Infinity,p.forEach(F=>{J.push(F.scale);r=F.scale>r?F.scale:r;D=F.scale<D?F.scale:D;K[F.level]=F}));this._set("scales",J);this._set("minScale",r);this._set("maxScale",D);this._set("lods",p);this._initializeUpsampleLevels()}}]);return B}(C.JSONSupport);t.__decorate([x.property({type:Number,json:{write:!0}})],C.prototype,"compressionQuality",void 0);t.__decorate([x.property({type:Number,json:{write:!0}})],C.prototype,"dpi",
void 0);t.__decorate([x.property({type:String,json:{read:H.read,write:H.write,origins:{"web-scene":{read:!1,write:!1}}}})],C.prototype,"format",void 0);t.__decorate([x.property({readOnly:!0})],C.prototype,"isWrappable",null);t.__decorate([x.property({type:k,json:{write:!0}})],C.prototype,"origin",void 0);t.__decorate([c.reader("origin")],C.prototype,"readOrigin",null);t.__decorate([x.property({type:[l],value:null,json:{write:!0}})],C.prototype,"lods",null);t.__decorate([x.property({readOnly:!0})],
C.prototype,"minScale",void 0);t.__decorate([x.property({readOnly:!0})],C.prototype,"maxScale",void 0);t.__decorate([x.property({readOnly:!0})],C.prototype,"scales",void 0);t.__decorate([x.property({cast:v=>Array.isArray(v)?v:"number"===typeof v?[v,v]:[256,256]})],C.prototype,"size",void 0);t.__decorate([c.reader("size",["rows","cols"])],C.prototype,"readSize",null);t.__decorate([f.writer("size",{cols:{type:m.Integer},rows:{type:m.Integer}})],C.prototype,"writeSize",null);t.__decorate([x.property({type:g,
json:{write:!0}})],C.prototype,"spatialReference",void 0);C=n=t.__decorate([d.subclass("esri.layers.support.TileInfo")],C);(function(v){v=v.ExtrapolateOptions||(v.ExtrapolateOptions={});v[v.NONE=0]="NONE";v[v.POWER_OF_TWO=1]="POWER_OF_TWO"})(C||(C={}));return C})},"esri/geometry/support/aaBoundingRect":function(){define(["exports","../../core/has","../../core/mathUtils","../../core/maybe","../Extent"],function(u,t,H,C,w){function y(g=k){return[g[0],g[1],g[2],g[3]]}function x(g,e){g!==e&&(g[0]=e[0],
g[1]=e[1],g[2]=e[2],g[3]=e[3]);return g}function m(g){return C.isNone(g)||g[0]>=g[2]?0:g[2]-g[0]}function h(g){return g[1]>=g[3]?0:g[3]-g[1]}function c(g,e,a){return e>=g[0]&&a>=g[1]&&e<=g[2]&&a<=g[3]}function d(g){return null!=g&&4===g.length}const f=[Infinity,Infinity,-Infinity,-Infinity],k=[0,0,0,0];u.NEGATIVE_INFINITY=f;u.POSITIVE_INFINITY=[-Infinity,-Infinity,Infinity,Infinity];u.UNIT=[0,0,1,1];u.ZERO=k;u.allFinite=function(g){for(let e=0;4>e;e++)if(!isFinite(g[e]))return!1;return!0};u.area=
function(g){return m(g)*h(g)};u.center=function(g,e=[0,0]){e[0]=(g[0]+g[2])/2;e[1]=(g[1]+g[3])/2;return e};u.clone=function(g){return[g[0],g[1],g[2],g[3]]};u.contains=function(g,e){return e[0]>=g[0]&&e[2]<=g[2]&&e[1]>=g[1]&&e[3]<=g[3]};u.containsPoint=function(g,e){return c(g,e[0],e[1])};u.containsPointObject=function(g,e){return c(g,e.x,e.y)};u.containsPointWithMargin=function(g,e,a){return e[0]>=g[0]-a&&e[1]>=g[1]-a&&e[0]<=g[2]+a&&e[1]<=g[3]+a};u.containsXY=c;u.containsXYWithMargin=function(g,e,
a,b){return e>=g[0]-b&&a>=g[1]-b&&e<=g[2]+b&&a<=g[3]+b};u.copy=x;u.create=y;u.distance=function(g,e){const a=(g[1]+g[3])/2,b=Math.max(Math.abs(e[0]-(g[0]+g[2])/2)-m(g)/2,0);g=Math.max(Math.abs(e[1]-a)-h(g)/2,0);return Math.sqrt(b*b+g*g)};u.empty=function(g){return g?x(g,f):y(f)};u.equals=function(g,e){return d(g)&&d(e)?g[0]===e[0]&&g[1]===e[1]&&g[2]===e[2]&&g[3]===e[3]:g===e};u.expand=function(g,e,a){if(C.isNone(e))x(a,g);else if("length"in e)if(d(e))a[0]=Math.min(g[0],e[0]),a[1]=Math.min(g[1],e[1]),
a[2]=Math.max(g[2],e[2]),a[3]=Math.max(g[3],e[3]);else{if(2===e.length||3===e.length)a[0]=Math.min(g[0],e[0]),a[1]=Math.min(g[1],e[1]),a[2]=Math.max(g[2],e[0]),a[3]=Math.max(g[3],e[1])}else switch(e.type){case "extent":a[0]=Math.min(g[0],e.xmin);a[1]=Math.min(g[1],e.ymin);a[2]=Math.max(g[2],e.xmax);a[3]=Math.max(g[3],e.ymax);break;case "point":a[0]=Math.min(g[0],e.x),a[1]=Math.min(g[1],e.y),a[2]=Math.max(g[2],e.x),a[3]=Math.max(g[3],e.y)}};u.expandPointInPlace=function(g,e){e[0]<g[0]&&(g[0]=e[0]);
e[0]>g[2]&&(g[2]=e[0]);e[1]<g[1]&&(g[1]=e[1]);e[1]>g[3]&&(g[3]=e[1])};u.expandWithNestedArray=function(g,e,a=g){const b=e.length;let l=g[0],q=g[1],n=g[2];g=g[3];for(let v=0;v<b;v++){const B=e[v];l=Math.min(l,B[0]);q=Math.min(q,B[1]);n=Math.max(n,B[0]);g=Math.max(g,B[1])}a[0]=l;a[1]=q;a[2]=n;a[3]=g;return a};u.fromExtent=function(g,e=y()){e[0]=g.xmin;e[1]=g.ymin;e[2]=g.xmax;e[3]=g.ymax;return e};u.fromValues=function(g,e,a,b,l=y()){l[0]=g;l[1]=e;l[2]=a;l[3]=b;return l};u.height=h;u.intersection=function(g,
e,a){if(C.isNone(e))return x(a,g);const b=e[0],l=e[1],q=e[2];e=e[3];a[0]=H.clamp(g[0],b,q);a[1]=H.clamp(g[1],l,e);a[2]=H.clamp(g[2],b,q);a[3]=H.clamp(g[3],l,e);return a};u.intersects=function(g,e){return Math.max(e[0],g[0])<=Math.min(e[2],g[2])&&Math.max(e[1],g[1])<=Math.min(e[3],g[3])};u.intersectsSegment=function(g,e,a){const b=g[0],l=g[1],q=g[2];g=g[3];const {x:n,y:v}=e,{x:B,y:z}=a;var p=(D,J)=>0>(z-v)*D+(n-B)*J+(B*v-n*z);e=p(b,g);a=p(q,g);const r=p(q,l);p=p(b,l);return e===a&&a===r&&r===p&&p===
e||n<b&&B<b||n>q&&B>q||v>g&&z>g||v<l&&z<l?!1:!0};u.intersectsSphere=function(g,e){const a=e[3];var b=Math.abs(e[0]-.5*(g[0]+g[2]));const l=.5*(g[2]-g[0]);if(b>a+l)return!1;var q=.5*(g[3]-g[1]);g=Math.abs(e[1]-.5*(g[1]+g[3]));if(g>a+q)return!1;if(b<l||g<q)return!0;b-=l;q=g-q;return b*b+q*q<=a*a};u.is=d;u.isPoint=function(g){return(0===m(g)||!isFinite(g[0]))&&(0===h(g)||!isFinite(g[1]))};u.offset=function(g,e,a,b=g){b[0]=g[0]+e;b[1]=g[1]+a;b[2]=g[2]+e;b[3]=g[3]+a;return b};u.pad=function(g,e,a=g){a[0]=
g[0]-e;a[1]=g[1]-e;a[2]=g[2]+e;a[3]=g[3]+e;return a};u.setMax=function(g,e,a=g){a[2]=e[0];a[3]=e[1];a!==g&&(a[0]=g[0],a[1]=g[1]);return g};u.setMin=function(g,e,a=g){a[0]=e[0];a[1]=e[1];a!==g&&(a[2]=g[2],a[3]=g[3]);return a};u.size=function(g,e){e[0]=g[2]-g[0];e[1]=g[3]-g[1]};u.toExtent=function(g,e){return new w({xmin:g[0],ymin:g[1],xmax:g[2],ymax:g[3],spatialReference:e})};u.width=m;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/LOD":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass".split(" "),
function(u,t,H,C,w,y,x){var m;H=m=function(h){function c(d){d=h.call(this,d)||this;d.cols=null;d.level=0;d.levelValue=null;d.origin=null;d.resolution=0;d.rows=null;d.scale=0;return d}u._inheritsLoose(c,h);c.prototype.clone=function(){return new m({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})};return c}(H.JSONSupport);t.__decorate([C.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,
write:!1}}}})],H.prototype,"cols",void 0);t.__decorate([C.property({type:w.Integer,json:{write:!0}})],H.prototype,"level",void 0);t.__decorate([C.property({type:String,json:{write:!0}})],H.prototype,"levelValue",void 0);t.__decorate([C.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],H.prototype,"origin",void 0);t.__decorate([C.property({type:Number,json:{write:!0}})],H.prototype,"resolution",void 0);t.__decorate([C.property({json:{write:!0,
origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],H.prototype,"rows",void 0);t.__decorate([C.property({type:Number,json:{write:!0}})],H.prototype,"scale",void 0);return H=m=t.__decorate([x.subclass("esri.layers.support.LOD")],H)})},"esri/layers/support/TileKey":function(){define(["exports"],function(u){u.TileKey=function(t,H,C,w,y){this.id=t;this.level=H;this.row=C;this.col=w;this.extent=y};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/processors":function(){define(["require",
"exports"],function(u,t){const H=C=>Object.freeze(Object.defineProperty({__proto__:null,default:C},Symbol.toStringTag,{value:"Module"}));t.loadProcessorModule=function(C){return"heatmap"===C?new Promise((w,y)=>u(["./processors/HeatmapProcessor"],x=>w(H(x)),y)):new Promise((w,y)=>u(["./processors/SymbolProcessor"],x=>w(H(x)),y))};Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/controllers/FeatureController2D":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/Accessor ../../../../../core/has ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/accessorSupport/ensureType ../../../../../core/arrayUtils ../../../../../core/accessorSupport/decorators/subclass ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/data/QueryEngine ../../../../../layers/support/FieldsIndex ../FeatureStore2D ../sources/createSource ../support/AttributeStore ../support/BinStore ../support/ClusterStore ../support/ComputedAttributeStorage ../support/FeatureSetReaderJSON ../support/UpdateToken ../../../../support/QueueProcessor".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f,k,g,e,a,b,l,q,n,v,B,z){function p(D){if(!y.isAbortError(D)&&"worker:port-closed"!==D.name)throw D;}function r(D){return"feature"===D.type&&"snapshot"===D.mode}H=function(D){function J(){var F=D.apply(this,arguments)||this;F._storage=new n.ComputedAttributeStorage;F._markedIdsBufId=F._storage.createBitset();F._lastCleanup=performance.now();F._cleanupNeeded=!1;F._invalidated=!1;F._tileToResolver=new Map;F._didEdit=!1;F._updateVersion=1;F.tileStore=null;F.config=null;
F.processor=null;F.remoteClient=null;F.service=null;return F}u._inheritsLoose(J,D);var K=J.prototype;K.initialize=function(){this._initStores();this._initSource();this._updateQueue=new z.QueueProcessor({concurrency:"stream"===this._source.type?1:4,process:(F,A)=>this._onTileMessage(F,{signal:A})});this.addHandles([this.tileStore.on("update",this.onTileUpdate.bind(this)),x.when(()=>!this.updating,()=>this.onIdle())]);this._checkUpdating=setInterval(()=>this.notifyChange("updating"),300)};K._initSource=
function(){this._source=a.createSource(this.service,this.spatialReference,this.tileStore.tileScheme,(F,A)=>{this._invalidated=!0;return this._patchTile(F,A)},()=>this._updateQueue&&50>this._updateQueue.length,this.featureStore);this._proxyEvents()};K._proxyEvents=function(){if("stream"===this._source.type){const F=this._source.events,A=this._source;this.addHandles([x.watch(()=>A.connectionStatus,I=>this.remoteClient.invoke("setProperty",{propertyName:"connectionStatus",value:I}).catch(p),{initial:!0}),
x.watch(()=>A.errorString,I=>this.remoteClient.invoke("setProperty",{propertyName:"errorString",value:I}).catch(p),{initial:!0}),F.on("data-received",I=>this.remoteClient.invoke("emitEvent",{name:"data-received",event:{attributes:I.attributes,centroid:I.centroid,geometry:I.geometry}}).catch(p)),F.on("message-received",I=>this.remoteClient.invoke("emitEvent",{name:"message-received",event:I}).catch(p)),F.on("updateRate",I=>this.remoteClient.invoke("emitEvent",{name:"update-rate",event:{...I}}).catch(p))])}};
K._initAttributeStore=function(F){this.attributeStore||(this.attributeStore=new b({type:"remote",initialize:(A,I)=>y.ignoreAbortErrors(this.remoteClient.invoke("tileRenderer.featuresView.attributeView.initialize",A,{signal:I}).catch(p)),update:(A,I)=>y.ignoreAbortErrors(this.remoteClient.invoke("tileRenderer.featuresView.attributeView.requestUpdate",A,{signal:I}).catch(p)),render:A=>y.ignoreAbortErrors(this.remoteClient.invoke("tileRenderer.featuresView.requestRender",void 0,{signal:A}).catch(p))},
F,()=>this.notifyChange("updating")))};K._initStores=function(){this.featureStore=new e.FeatureStore2D({geometryInfo:{geometryType:this.service.geometryType,hasM:!1,hasZ:!1},spatialReference:this.spatialReference,fieldsIndex:this.fieldsIndex,fields:this.service.fields},this._storage,"snapshot"===this.service.type?"snapshot":"on-demand")};K._initQueryEngine=function(F){const A=this;this.featureQueryEngine?.destroy();this.featureQueryEngine=new k.QueryEngine({definitionExpression:F.schema.source.definitionExpression??
void 0,fields:this.service.fields,geometryType:this.service.geometryType,objectIdField:this.service.objectIdField,hasM:!1,hasZ:!1,spatialReference:this.spatialReference.toJSON(),cacheSpatialQueries:!0,featureStore:this.featureStore,aggregateAdapter:{getFeatureObjectIds(I){return w.isNone(A.aggregateStore)?[]:A.aggregateStore.getFeatureDisplayIdsForAggregate(I).map(G=>A.getObjectId(G))}},timeInfo:this.service.timeInfo})};K._initAggregateQueryEngine=function(F,A){this.aggregateQueryEngine?.destroy();
w.isNone(F)||(A=A.targets.aggregate.params.fields.slice(),this.aggregateQueryEngine=new k.QueryEngine({definitionExpression:void 0,fields:A,geometryType:F.geometryInfo.geometryType,objectIdField:F.objectIdField,hasM:F.geometryInfo.hasM,hasZ:F.geometryInfo.hasZ,spatialReference:this.spatialReference.toJSON(),cacheSpatialQueries:!1,featureStore:F,aggregateAdapter:{getFeatureObjectIds(I){return[]}}}))};K.destroy=function(){this._updateQueue.destroy();this._source.destroy();this.featureQueryEngine?.destroy();
this.aggregateQueryEngine?.destroy();this.attributeStore?.destroy();for(const F of this.tileStore.tiles)this._source.unsubscribe(F);clearInterval(this._checkUpdating)};K.isUpdating=function(){const F=this._source.updating,A=!!this._updateQueue.length,I=!this.attributeStore||this.attributeStore.isUpdating(),G=F||A||I;C("esri-2d-log-updating")&&console.log(`Updating FeatureController2D: ${G}\n  -> updatingSource ${F}\n  -> updateQueue ${A}\n  -> updatingAttributeStore ${I}\n`);return G};K.updateCustomParameters=
function(F){"stream"===this._source.type&&this._source.updateCustomParameters(F)};K.enableEvent=function(F){this._source.enableEvent(F.name,F.value)};K.pause=function(){this._updateQueue.pause();this._updateQueue.clear()};K.resume=function(){this._updateQueue.resume()};K.pauseStream=function(){"stream"===this._source.type&&this._source.pauseStream()};K.resumeStream=function(){"stream"===this._source.type&&this._source.resumeStream()};K.sendMessageToSocket=function(F){"stream"===this._source.type&&
this._source.sendMessageToSocket(F)};K.sendMessageToClient=function(F){"stream"===this._source.type&&this._source.sendMessageToClient(F)};K._initAggregateStore=function(F){F=F.schema.targets?.aggregate?.type;if(w.applySome(this.config,A=>A.schema.targets?.aggregate?.type)!==F&&(w.isSome(this.aggregateStore)&&(this.removeHandles("valueRangesChanged"),this.aggregateStore.destroy(),this.aggregateStore=null),F)){switch(F){case "cluster":this.aggregateStore=new q.ClusterStore({geometryInfo:{geometryType:"esriGeometryPoint",
hasM:!1,hasZ:!1},spatialReference:this.spatialReference,fieldsIndex:this.fieldsIndex,fields:this.service.fields},this.spatialReference,this._storage,this.service);this.addHandles(this.aggregateStore.events.on("valueRangesChanged",A=>{this.remoteClient.invoke("emitEvent",{name:"valueRangesChanged",event:{valueRanges:A.valueRanges}}).catch(p)}),"valueRangesChanged");break;case "bin":this.aggregateStore=new l.BinStore({geometryInfo:{geometryType:"esriGeometryPolygon",hasM:!1,hasZ:!1},spatialReference:this.spatialReference,
fieldsIndex:this.fieldsIndex,fields:this.service.fields},this.spatialReference,this._storage,this.service)}this.aggregateStore.onTileUpdate({added:this.tileStore.tiles,removed:[]})}};K.update=function(){var F=u._asyncToGenerator(function*(A,I){this._updateVersion++;this._initQueryEngine(I);this._initAttributeStore(I);this.pause();yield Promise.all([this._source.update(A,I.schema.source),this.featureStore.updateSchema(A,I.schema.targets.feature),this.attributeStore.update(A,I),this.attributeStore.updateFilters(A,
I,this)]);this._initAggregateStore(I);w.isSome(this.aggregateStore)&&(yield this.aggregateStore.updateSchema(A,I.schema.targets.aggregate));this._initAggregateQueryEngine(this.aggregateStore,I.schema);C("esri-2d-update-debug")&&A.describe();this._set("config",I)});return function(A,I){return F.apply(this,arguments)}}();K.applyUpdate=function(){var F=u._asyncToGenerator(function*(A){A.version=this._updateVersion;C("esri-2d-update-debug")&&console.debug(`Applying update ${A.version}`);A.mesh&&this.clearTiles();
this._updateQueue.resume();yield this._source.applyUpdate(A);this.notifyChange("updating");yield x.whenOnce(()=>!this.updating);w.isSome(this.aggregateStore)&&(yield y.after(10),yield x.whenOnce(()=>!this.updating))});return function(A){return F.apply(this,arguments)}}();K.onEdits=function(){var F=u._asyncToGenerator(function*({edits:A}){C("esri-2d-update-debug")&&console.debug("Applying Edit:",A);this._didEdit=!0;try{const I=A.removed.map(E=>E.objectId&&-1!==E.objectId?E.objectId:this._lookupObjectIdByGlobalId(E.globalId)),
G=A.addOrModified.map(({objectId:E})=>E);this.featureStore.invalidate();yield this._source.edit(G,I);this.clearTiles();this.notifyChange("updating");w.isSome(this.aggregateStore)&&this.aggregateStore.clear();yield this._source.resend();yield x.whenOnce(()=>!this.updating)}catch(I){}});return function(A){return F.apply(this,arguments)}}();K.refresh=function(){var F=u._asyncToGenerator(function*(A){if(!A.dataChanged)return A=B.UpdateToken.empty(),A.storage.filters=!0,this.applyUpdate(A);this.featureStore.invalidate();
this.clearTiles();this._source.refresh(this._updateVersion,A);this._cleanupNeeded=!0;this.notifyChange("updating");yield x.whenOnce(()=>!this.updating)});return function(A){return F.apply(this,arguments)}}();K.clearTiles=function(){for(const F of this.tileStore.tiles)this.processor.onTileClear(F)};K.onTileUpdate=function(F){if(w.isSome(this.aggregateStore))this.aggregateStore.onTileUpdate(F);for(const A of F.added)this._source.subscribe(A,this._updateVersion),this._level=A.level;for(const A of F.removed)this._source.unsubscribe(A),
this._cleanupNeeded=!0,this._tileToResolver.has(A.id)&&(this._tileToResolver.get(A.id).resolve(),this._tileToResolver.delete(A.id));this.notifyChange("updating")};K.onIdle=function(){var F=u._asyncToGenerator(function*(){this._invalidated&&(this._invalidated=!1,w.isSome(this.aggregateStore)||"heatmap"===this.processor.type)&&(yield this._repushCurrentLevelTiles());this._markAndSweep()});return function(){return F.apply(this,arguments)}}();K.querySummaryStatistics=function(){var F=u._asyncToGenerator(function*({query:A,
params:I}){return this.featureQueryEngine.executeQueryForSummaryStatistics(A,I)});return function(A){return F.apply(this,arguments)}}();K.queryAggregateSummaryStatistics=function(){var F=u._asyncToGenerator(function*({query:A,params:I}){return this.aggregateQueryEngine.executeQueryForSummaryStatistics(A,I)});return function(A){return F.apply(this,arguments)}}();K.queryUniqueValues=function(){var F=u._asyncToGenerator(function*({query:A,params:I}){return this.featureQueryEngine.executeQueryForUniqueValues(A,
I)});return function(A){return F.apply(this,arguments)}}();K.queryAggregateUniqueValues=function(){var F=u._asyncToGenerator(function*({query:A,params:I}){return this.aggregateQueryEngine.executeQueryForUniqueValues(A,I)});return function(A){return F.apply(this,arguments)}}();K.queryClassBreaks=function(){var F=u._asyncToGenerator(function*({query:A,params:I}){return this.featureQueryEngine.executeQueryForClassBreaks(A,I)});return function(A){return F.apply(this,arguments)}}();K.queryAggregateClassBreaks=
function(){var F=u._asyncToGenerator(function*({query:A,params:I}){return this.aggregateQueryEngine.executeQueryForClassBreaks(A,I)});return function(A){return F.apply(this,arguments)}}();K.queryHistogram=function(){var F=u._asyncToGenerator(function*({query:A,params:I}){return this.featureQueryEngine.executeQueryForHistogram(A,I)});return function(A){return F.apply(this,arguments)}}();K.queryAggregateHistogram=function(){var F=u._asyncToGenerator(function*({query:A,params:I}){return this.aggregateQueryEngine.executeQueryForHistogram(A,
I)});return function(A){return F.apply(this,arguments)}}();K.queryExtent=function(F){return this.featureQueryEngine.executeQueryForExtent(F)};K.queryAggregates=function(F){return this.aggregateQueryEngine.executeQuery(F)};K.queryAggregateCount=function(F){return this.aggregateQueryEngine.executeQueryForCount(F)};K.queryAggregateIds=function(F){return this.aggregateQueryEngine.executeQueryForIds(F)};K.queryFeatures=function(F){return this.featureQueryEngine.executeQuery(F)};K.queryVisibleFeatures=
function(){var F=u._asyncToGenerator(function*(A){A=yield this.featureQueryEngine.executeQuery(A);const I=A.objectIdFieldName;A.features=A.features.filter(G=>{G=this.getDisplayId(G.attributes[I]);return w.applySome(G,E=>this.attributeStore.isVisible(E))});return A});return function(A){return F.apply(this,arguments)}}();K.queryFeatureCount=function(F){return this.featureQueryEngine.executeQueryForCount(F)};K.queryLatestObservations=function(F){return this.featureQueryEngine.executeQueryForLatestObservations(F)};
K.queryObjectIds=function(F){return this.featureQueryEngine.executeQueryForIds(F)};K.queryStatistics=function(){var F=u._asyncToGenerator(function*(){return this.featureStore.storeStatistics});return function(){return F.apply(this,arguments)}}();K.getObjectId=function(F){return this.featureStore.lookupObjectId(F,this._storage)};K.getDisplayId=function(F){if(w.isSome(this.aggregateStore)){const A=this.aggregateStore.getDisplayId(F);return w.isNone(A)?(F=this.featureStore.lookupDisplayId(F),this.aggregateStore.getDisplayIdForReferenceId(F)):
A}return this.featureStore.lookupDisplayId(F)};K.getFeatures=function(F){const A=[],I=[];for(const G of F)F=w.isSome(this.aggregateStore)?this.getAggregate(G):null,w.isSome(F)?w.isSome(F.attributes.referenceId)?(F=this.getFeature(F.attributes.referenceId),w.isSome(F)&&A.push(F)):I.push(F):(F=this.getFeature(G),w.isSome(F)&&A.push(F));return{features:A,aggregates:I}};K.getFeature=function(F){F=this.featureStore.lookupFeatureByDisplayId(F,this._storage);if(w.isNone(F))return null;var A=F.readHydratedGeometry();
A=f.convertToGeometry(A,F.geometryType,F.hasZ,F.hasM);return{attributes:F.readAttributes(),geometry:A}};K.getAggregate=function(F){return w.isNone(this.aggregateStore)?null:this.aggregateStore.getAggregate(F)};K.getAggregates=function(){return w.isNone(this.aggregateStore)?[]:this.aggregateStore.getAggregates()};K.setHighlight=function(){var F=u._asyncToGenerator(function*(A){const I=w.filterNones(A.map(G=>this.getDisplayId(G)));return this.attributeStore.setHighlight(A,I)});return function(A){return F.apply(this,
arguments)}}();K._lookupObjectIdByGlobalId=function(F){const A=this.service.globalIdField;if(w.isNone(A))throw Error("Expected globalIdField to be defined");let I=null;this.featureStore.forEach(G=>{F===G.readAttribute(A)&&(I=G.getObjectId())});if(w.isNone(I))throw Error(`Expected to find a feature with globalId ${F}`);return I};K._repushCurrentLevelTiles=function(){var F=u._asyncToGenerator(function*(){var A=this,I=this.tileStore.tiles.filter(G=>G.level===this._level);I.map(function(){var G=u._asyncToGenerator(function*(E){return A._patchTile({type:"append",
id:E.key.id,clear:!0,addOrUpdate:null,end:!1})});return function(E){return G.apply(this,arguments)}}());I=I.map(function(){var G=u._asyncToGenerator(function*(E){return A._patchTile({type:"append",id:E.key.id,addOrUpdate:v.FeatureSetReaderJSON.fromOptimizedFeatures([],A.service),remove:[],end:!0,isRepush:!0,status:B.UpdateToken.empty()})});return function(E){return G.apply(this,arguments)}}());yield Promise.all(I)});return function(){return F.apply(this,arguments)}}();K._maybeForceCleanup=function(){5E3<
performance.now()-this._lastCleanup&&this._markAndSweep()};K._patchTile=function(F,A){F=this._updateQueue.push(F,A).then(()=>{this.notifyChange("updating")}).catch(I=>{this.notifyChange("updating")});this.notifyChange("updating");return F};K._onTileMessage=function(){var F=u._asyncToGenerator(function*(A,I){y.throwIfAborted(I);if(C("esri-2d-update-debug")){var G=w.applySome(A.addOrUpdate,T=>T.hasFeatures);console.debug(A.id,`FeatureController:onTileMessage: [clear:${A.clear}, end:${A.end}, features: ${G}]`)}if(G=
this.tileStore.get(A.id)){if(A.clear)return this.processor.onTileClear(G);var E=A.status;this._cleanupNeeded=!0;var M=[];for(const T of A.remove??[]){const Y=this.featureStore.lookupDisplayId(T);Y&&M.push(Y)}A.remove=M;try{if(w.isNone(A.addOrUpdate))this.processor.onTileMessage(G,{...A,addOrUpdate:null},w.isSome(this.aggregateStore),I).catch(y.throwIfNotAbortError);else{A.addOrUpdate.setArcadeSpatialReference(this.spatialReference);this.featureStore.hasInstance(A.addOrUpdate.instance)&&E.targets.feature||
(E.targets.feature=!0,this.featureStore.onTileData(G,A));E.storage.data&&E.storage.filters||(E.storage.data=!0,E.storage.filters=!0,this.attributeStore.onTileData(G,A),"stream"===this._source.type||this._didEdit?(yield this.attributeStore.sendUpdates(),y.throwIfAborted(I)):this.attributeStore.sendUpdates());if(w.isSome(this.aggregateStore)&&!E.targets.aggregate){E.targets.aggregate=!0;const T=r(this._source)&&this._source.loading,Y=!r(this._source)||T||A.end;this.aggregateStore.onTileData(G,A,this._storage,
this.attributeStore,Y);if(!Y)return;E.mesh||(this.attributeStore.onTileData(G,A),yield this.attributeStore.sendUpdates())}if(!E.mesh){E.mesh=!0;const T=w.isSome(this.aggregateStore)&&"cluster"===this.aggregateStore.type;yield this.processor.onTileMessage(G,A,T,I);y.throwIfAborted(I)}this._maybeForceCleanup()}}catch(T){y.throwIfNotAbortError(T)}}});return function(A,I){return F.apply(this,arguments)}}();K._mark=function(F,A,I){const G=this._storage.getInstanceId(F);F&&(A.add((4294901760&G)>>>16),I.set(F))};
K._markAndSweep=function(){this._lastCleanup=performance.now();if(!("feature"===this._source.type&&"snapshot"===this._source.mode||"stream"!==this._source.type&&!this._cleanupNeeded)){this._cleanupNeeded=!1;var F=this._storage.getBitset(this._markedIdsBufId),A=new Set;F.clear();for(const G of this.tileStore.tiles)for(const E of this._source.readers(G.id)){const M=E.getCursor();for(;M.next();){var I=M.getDisplayId();I||(I=M.getObjectId(),I=this.featureStore.lookupDisplayId(I));this._mark(I,A,F)}}"symbol"===
this.processor.type&&this.processor.forEachBufferId(G=>{this._mark(G,A,F)});this._updateQueue.forEach(G=>{for(const E of G.remove??[])G=this.featureStore.lookupDisplayId(E),this._mark(G,A,F)});w.isSome(this.aggregateStore)&&(this.aggregateStore.sweepFeatures(F,this.featureStore),"sweepAggregates"in this.aggregateStore&&this.aggregateStore.sweepAggregates(this._storage,this.attributeStore,this._level));this.featureStore.sweepFeatures(F,this._storage,this.attributeStore);this.featureStore.sweepFeatureSets(A)}};
u._createClass(J,[{key:"fieldsIndex",get:function(){return new g(this.service.fields)}},{key:"spatialReference",get:function(){return this.tileStore.tileScheme.spatialReference}},{key:"updating",get:function(){return this.isUpdating()}}]);return J}(H);t.__decorate([m.property({constructOnly:!0})],H.prototype,"tileStore",void 0);t.__decorate([m.property()],H.prototype,"config",void 0);t.__decorate([m.property({readOnly:!0})],H.prototype,"fieldsIndex",null);t.__decorate([m.property()],H.prototype,"processor",
void 0);t.__decorate([m.property({constructOnly:!0})],H.prototype,"remoteClient",void 0);t.__decorate([m.property({constructOnly:!0})],H.prototype,"service",void 0);t.__decorate([m.property()],H.prototype,"spatialReference",null);t.__decorate([m.property()],H.prototype,"updating",null);return H=t.__decorate([d.subclass("esri.views.2d.layers.features.controllers.FeatureController2D")],H)})},"esri/layers/graphics/featureConversionUtils":function(){define("exports ../../core/Error ../../core/Logger ../../core/maybe ../../geometry/support/aaBoundingBox ../../geometry/support/aaBoundingRect ../../geometry/support/jsonUtils ./OptimizedFeature ./OptimizedFeatureSet ./OptimizedGeometry".split(" "),
function(u,t,H,C,w,y,x,m,h,c){function d(W,ca){return W?ca?4:3:ca?3:2}function f(W,ca,ka,la){if(W){if(ka)return ca&&la?S:za;if(ca&&la)return N}else if(ca&&la)return za;return Ea}function k({scale:W,translate:ca},ka){return Math.round((ka-ca[0])/W[0])}function g({scale:W,translate:ca},ka){return Math.round((ca[1]-ka)/W[1])}function e({scale:W,translate:ca},ka,la){return ka*W[la]+ca[la]}function a(W){W=W.coords;return{x:W[0],y:W[1]}}function b(W,ca){W.coords[0]=ca.x;W.coords[1]=ca.y;return W}function l(W){W=
W.coords;return{x:W[0],y:W[1],z:W[2]}}function q(W,ca){W.coords[0]=ca.x;W.coords[1]=ca.y;W.coords[2]=ca.z;return W}function n(W){W=W.coords;return{x:W[0],y:W[1],m:W[2]}}function v(W,ca){W.coords[0]=ca.x;W.coords[1]=ca.y;W.coords[2]=ca.m;return W}function B(W){W=W.coords;return{x:W[0],y:W[1],z:W[2],m:W[3]}}function z(W,ca){W.coords[0]=ca.x;W.coords[1]=ca.y;W.coords[2]=ca.z;W.coords[3]=ca.m;return W}function p(W,ca){return W&&ca?z:W?q:ca?v:b}function r(W,ca,ka,la,ma){ka=p(ka,la);for(const {geometry:ua,
attributes:xa}of ca)ca=C.isSome(ua)?ka(new c,ua):null,W.push(new m.OptimizedFeature(ca,xa,null,ma?xa[ma]:void 0));return W}function D(W,ca,ka,la){for(const {geometry:ma,attributes:ua}of ca)W.push({attributes:ua,geometry:C.isSome(ma)?J(ma,ka,la):null});return W}function J(W,ca,ka){if(C.isNone(W))return null;const la=d(ca,ka),ma=[];for(let ua=0;ua<W.coords.length;ua+=la){const xa=[];for(let ia=0;ia<la;ia++)xa.push(W.coords[ua+ia]);ma.push(xa)}return ca?ka?{points:ma,hasZ:ca,hasM:ka}:{points:ma,hasZ:ca}:
ka?{points:ma,hasM:ka}:{points:ma}}function K(W,ca,ka,la,ma){ka=d(ka,la);for(const {geometry:ua,attributes:xa}of ca)ca=C.isSome(ua)?F(new c,ua,ka):null,W.push(new m.OptimizedFeature(ca,xa,null,ma?xa[ma]:void 0));return W}function F(W,ca,ka=d(ca.hasZ,ca.hasM)){W.lengths[0]=ca.points.length;const la=W.coords;let ma=0;for(const ua of ca.points)for(ca=0;ca<ka;ca++)la[ma++]=ua[ca];return W}function A(W,ca,ka){if(!W)return null;const la=d(ca,ka),{coords:ma,lengths:ua}=W;W=[];let xa=0;for(const ia of ua){const na=
[];for(let ya=0;ya<ia;ya++){const Ga=[];for(let Ka=0;Ka<la;Ka++)Ga.push(ma[xa++]);na.push(Ga)}W.push(na)}return ca?ka?{paths:W,hasZ:ca,hasM:ka}:{paths:W,hasZ:ca}:ka?{paths:W,hasM:ka}:{paths:W}}function I(W,ca,ka,la,ma){ka=d(ka,la);for(const {geometry:ua,attributes:xa}of ca)ca=C.isSome(ua)?G(new c,ua,ka):null,W.push(new m.OptimizedFeature(ca,xa,null,ma?xa[ma]:void 0));return W}function G(W,ca,ka=d(ca.hasZ,ca.hasM)){const {lengths:la,coords:ma}=W;let ua=0;for(const xa of ca.paths){for(const ia of xa)for(ca=
0;ca<ka;ca++)ma[ua++]=ia[ca];la.push(xa.length)}return W}function E(W,ca,ka){if(!W)return null;const la=d(ca,ka),{coords:ma,lengths:ua}=W;W=[];let xa=0;for(const ia of ua){const na=[];for(let ya=0;ya<ia;ya++){const Ga=[];for(let Ka=0;Ka<la;Ka++)Ga.push(ma[xa++]);na.push(Ga)}W.push(na)}return ca?ka?{rings:W,hasZ:ca,hasM:ka}:{rings:W,hasZ:ca}:ka?{rings:W,hasM:ka}:{rings:W}}function M(W,ca,ka,la,ma){for(const {geometry:ua,centroid:xa,attributes:ia}of ca){ca=C.isSome(ua)?T(new c,ua,ka,la):null;const na=
ma?ia[ma]:void 0;C.isSome(xa)?W.push(new m.OptimizedFeature(ca,ia,b(new c,xa),na)):W.push(new m.OptimizedFeature(ca,ia,null,na))}return W}function T(W,ca,ka=ca.hasZ,la=ca.hasM){Y(W,ca.rings,ka,la);return W}function Y(W,ca,ka,la){ka=d(ka,la);const {lengths:ma,coords:ua}=W;la=0;sa(W);for(const xa of ca){for(const ia of xa)for(ca=0;ca<ka;ca++)ua[la++]=ia[ca];ma.push(xa.length)}return W}function fa(W,ca,ka,la,ma,ua){Aa(W);if(!ka){for(const xa of ca)W.push(new m.OptimizedFeature(null,xa.attributes,null,
ua?xa.attributes[ua]:void 0));return W}switch(ka){case "esriGeometryPoint":return r(W,ca,la,ma,ua);case "esriGeometryMultipoint":return K(W,ca,la,ma,ua);case "esriGeometryPolyline":return I(W,ca,la,ma,ua);case "esriGeometryPolygon":return M(W,ca,la,ma,ua);default:Da.error("convertToFeatureSet:unknown-geometry",new t(`Unable to parse unknown geometry type '${ka}'`)),Aa(W)}return W}function ba(W,ca,ka,la){W=W&&("coords"in W?W:W.geometry);if(C.isNone(W))return null;switch(ca){case "esriGeometryPoint":return ca=
a,ka&&la?ca=B:ka?ca=l:la&&(ca=n),ca(W);case "esriGeometryMultipoint":return J(W,ka,la);case "esriGeometryPolyline":return A(W,ka,la);case "esriGeometryPolygon":return E(W,ka,la);default:return Da.error("convertToGeometry:unknown-geometry",new t(`Unable to parse unknown geometry type '${ca}'`)),null}}function U(W,ca,ka,la,ma){Aa(W);if(C.isNone(ka)){for(const xa of ca)W.push({attributes:xa.attributes});return W}switch(ka){case "esriGeometryPoint":ka=a;la&&ma?ka=B:la?ka=l:ma&&(ka=n);for(var ua of ca){const {geometry:xa,
attributes:ia}=ua;la=C.isSome(xa)?ka(xa):null;W.push({attributes:ia,geometry:la})}break;case "esriGeometryMultipoint":return D(W,ca,la,ma);case "esriGeometryPolyline":for(const {geometry:xa,attributes:ia}of ca)W.push({attributes:ia,geometry:C.isSome(xa)?A(xa,la,ma):null});break;case "esriGeometryPolygon":for(const {geometry:xa,attributes:ia,centroid:na}of ca)ua=C.isSome(xa)?E(xa,la,ma):null,C.isSome(na)?(ca=a(na),W.push({attributes:ia,centroid:ca,geometry:ua})):W.push({attributes:ia,geometry:ua});
break;default:Da.error("convertToFeatureSet:unknown-geometry",new t(`Unable to parse unknown geometry type '${ka}'`))}return W}function P(W,ca,ka,la,ma,ua,xa=ka,ia=la){sa(W);if(C.isNone(ca)||!ca.coords.length)return null;ma=ha[ma];const {coords:na,lengths:ya}=ca;ca=d(ka,la);const Ga=d(ka&&xa,la&&ia);ka=f(ka,la,xa,ia);if(!ya.length)return ka(W.coords,na,0,0,k(ua,na[0]),g(ua,na[1])),sa(W,ca,0),W;let Ka,Ra=0,Qa,Ta=0;for(const Sa of ya){if(Sa<ma)continue;let Na=0;Qa=Ta;ia=la=k(ua,na[Ra]);Ka=xa=g(ua,na[Ra+
1]);ka(W.coords,na,Qa,Ra,ia,Ka);Na++;Ra+=ca;Qa+=Ga;for(let Ua=1;Ua<Sa;Ua++,Ra+=ca)if(ia=k(ua,na[Ra]),Ka=g(ua,na[Ra+1]),ia!==la||Ka!==xa)ka(W.coords,na,Qa,Ra,ia-la,Ka-xa),Qa+=Ga,Na++,la=ia,xa=Ka;Na>=ma&&(W.lengths.push(Na),Ta=Qa)}Aa(W.coords,Ta);return W.coords.length?W:null}function Q(W,ca,ka,la,ma,ua,xa){let ia=la,na=0;for(let Ga=ua+ka;Ga<xa;Ga+=ka){var ya=ca[Ga];const Ka=ca[Ga+1],Ra=ca[xa],Qa=ca[xa+1];let Ta=ca[ua],Sa=ca[ua+1],Na=Ra-Ta,Ua=Qa-Sa;if(0!==Na||0!==Ua){const Ja=((ya-Ta)*Na+(Ka-Sa)*Ua)/
(Na*Na+Ua*Ua);1<Ja?(Ta=Ra,Sa=Qa):0<Ja&&(Ta+=Na*Ja,Sa+=Ua*Ja)}Na=ya-Ta;Ua=Ka-Sa;ya=Na*Na+Ua*Ua;ya>ia&&(na=Ga,ia=ya)}ia>la&&(na-ua>ka&&Q(W,ca,ka,la,ma,ua,na),ma(W,ca,W.length,na,ca[na],ca[na+1]),xa-na>ka&&Q(W,ca,ka,la,ma,na,xa))}function Z(W,ca,ka,la,ma){const {coords:ua,lengths:xa}=ca;ka=d(ka,la);if(!ua.length)return W!==ca&&sa(W),W;C.assertIsSome(ma);const {originPosition:ia,scale:na,translate:ya}=ma;ma=va;ma.originPosition=ia;la=ma.scale;la[0]=na[0]??1;la[1]=-(na[1]??1);la[2]=na[2]??1;la[3]=na[3]??
1;var Ga=ma.translate;Ga[0]=ya[0]??0;Ga[1]=ya[1]??0;Ga[2]=ya[2]??0;Ga[3]=ya[3]??0;if(!xa.length){for(la=0;la<ka;++la)W.coords[la]=e(ma,ua[la],la);W!==ca&&sa(W,ka,0);return W}Ga=0;for(let Ra=0;Ra<xa.length;Ra++){const Qa=xa[Ra];W.lengths[Ra]=Qa;for(var Ka=0;Ka<ka;++Ka)W.coords[Ga+Ka]=e(ma,ua[Ga+Ka],Ka);Ka=W.coords[Ga];let Ta=W.coords[Ga+1];Ga+=ka;for(let Sa=1;Sa<Qa;Sa++,Ga+=ka){Ka+=ua[Ga]*la[0];Ta+=ua[Ga+1]*la[1];W.coords[Ga]=Ka;W.coords[Ga+1]=Ta;for(let Na=2;Na<ka;++Na)W.coords[Ga+Na]=e(ma,ua[Ga+
Na],Na)}}W!==ca&&sa(W,ua.length,xa.length);return W}function X(W,ca,ka,la){let ma=0,ua=W[la*ca],xa=W[la*(ca+1)];for(let ia=1;ia<ka;ia++){const na=ua+W[la*(ca+ia)],ya=xa+W[la*(ca+ia)+1],Ga=(na-ua)*(ya+xa);ua=na;xa=ya;ma+=Ga}return.5*ma}function sa(W,ca=0,ka=0){Aa(W.lengths,ka);Aa(W.coords,ca)}function Aa(W,ca=0){W.length!==ca&&(W.length=ca)}const Da=H.getLogger("esri.layers.graphics.featureConversionUtils"),ha={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0},
Ea=(W,ca,ka,la,ma,ua)=>{W[ka]=ma;W[ka+1]=ua},za=(W,ca,ka,la,ma,ua)=>{W[ka]=ma;W[ka+1]=ua;W[ka+2]=ca[la+2]},N=(W,ca,ka,la,ma,ua)=>{W[ka]=ma;W[ka+1]=ua;W[ka+2]=ca[la+3]},S=(W,ca,ka,la,ma,ua)=>{W[ka]=ma;W[ka+1]=ua;W[ka+2]=ca[la+2];W[ka+3]=ca[la+3]},ea=[],oa=[],va={originPosition:"lowerLeft",scale:[1,1,1,1],translate:[0,0,0,0]};u.convertFromFeature=function(W,ca,ka,la,ma){ea[0]=W;[W]=fa(oa,ea,ca,ka,la,ma);Aa(ea);Aa(oa);return W};u.convertFromFeatureSet=function(W,ca){const ka=new h,{hasM:la,hasZ:ma,features:ua,
objectIdFieldName:xa,spatialReference:ia,geometryType:na,exceededTransferLimit:ya,transform:Ga,fields:Ka}=W;Ka&&(ka.fields=Ka);ka.geometryType=na??null;ka.objectIdFieldName=xa??ca??null;ka.spatialReference=ia??null;if(!ka.objectIdFieldName)return Da.error(new t("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),ka;ua&&fa(ka.features,ua,na,ma,la,ka.objectIdFieldName);ya&&(ka.exceededTransferLimit=ya);la&&(ka.hasM=la);ma&&(ka.hasZ=ma);Ga&&(ka.transform=Ga);return ka};u.convertFromFeatures=
fa;u.convertFromGeometry=function(W,ca,ka){if(C.isNone(W))return null;const la=new c;"hasZ"in W&&null==ca&&(ca=W.hasZ);"hasM"in W&&null==ka&&(ka=W.hasM);if(x.isPoint(W))return p(null!=ca?ca:null!=W.z,null!=ka?ka:null!=W.m)(la,W);if(x.isPolygon(W))return T(la,W,ca,ka);if(x.isPolyline(W))return G(la,W,d(ca,ka));if(x.isMultipoint(W))return F(la,W,d(ca,ka));Da.error("convertFromGeometry:unknown-geometry",new t(`Unable to parse unknown geometry type '${W}'`))};u.convertFromGraphics=function(W,ca,ka,la,
ma,ua){const xa=W.length;switch(ka){case "esriGeometryPoint":r(W,ca,la,ma,ua);break;case "esriGeometryMultipoint":K(W,ca,la,ma,ua);break;case "esriGeometryPolyline":I(W,ca,la,ma,ua);break;case "esriGeometryPolygon":M(W,ca,la,ma,ua);break;default:Da.error("convertToFeatureSet:unknown-geometry",new t(`Unable to parse unknown geometry type '${ka}'`))}for(la=0;la<ca.length;la++)W[la+xa].geometryType=ka,W[la+xa].insertAfter=ca[la].insertAfter,W[la+xa].groupId=ca[la].groupId;return W};u.convertFromMultipoint=
F;u.convertFromMultipointFeatures=K;u.convertFromNestedArray=Y;u.convertFromPoint=function(W,ca,ka=p(null!=ca.z,null!=ca.m)){return ka(W,ca)};u.convertFromPointFeatures=r;u.convertFromPolygon=T;u.convertFromPolyline=G;u.convertFromPolylineFeatures=I;u.convertToFeature=function(W,ca,ka,la){oa[0]=W;U(ea,oa,ca,ka,la);W=ea[0];Aa(ea);Aa(oa);return W};u.convertToFeatureSet=function(W){const {objectIdFieldName:ca,spatialReference:ka,transform:la,fields:ma,hasM:ua,hasZ:xa,features:ia,geometryType:na,exceededTransferLimit:ya,
uniqueIdField:Ga,queryGeometry:Ka,queryGeometryType:Ra}=W;W=U([],ia,na,xa,ua);const Qa=ba(Ka,Ra,!1,!1);W={features:W,fields:ma,geometryType:na,objectIdFieldName:ca,spatialReference:ka,uniqueIdField:Ga,queryGeometry:Qa};la&&(W.transform=la);ya&&(W.exceededTransferLimit=ya);ua&&(W.hasM=ua);xa&&(W.hasZ=xa);return W};u.convertToFeatures=U;u.convertToGeometry=ba;u.convertToMultipoint=J;u.convertToMultipointFeatures=D;u.convertToPoint=function(W,ca,ka){return W?ca?ka?B(W):l(W):ka?n(W):a(W):null};u.convertToPolygon=
E;u.convertToPolyline=A;u.deltaDecodeGeometry=function(W,ca){if(C.isNone(W))return null;const ka=W.clone(),la=W.coords;W=W.lengths;let ma=0;for(let ia=0;ia<W.length;ia++){const na=W[ia];var ua=la[ca*ma],xa=la[ca*ma+1];for(let ya=1;ya<na;ya++)ua+=la[ca*(ma+ya)],xa+=la[ca*(ma+ya)+1],ka.coords[ca*(ma+ya)]=ua,ka.coords[ca*(ma+ya)+1]=xa;ma+=na}return ka};u.deltaEncodeGeometry=function(W,ca){const ka=W.clone(),la=W.coords;W=W.lengths;let ma=0;for(let xa=0;xa<W.length;xa++){const ia=W[xa];let na=la[ca*ma];
var ua=la[ca*ma+1];for(let ya=1;ya<ia;ya++){const Ga=la[ca*(ma+ya)],Ka=la[ca*(ma+ya)+1];ua=Ka-ua;ka.coords[ca*(ma+ya)]=Ga-na;ka.coords[ca*(ma+ya)+1]=ua;na=Ga;ua=Ka}ma+=ia}return ka};u.generalizeOptimizedGeometry=function(W,ca,ka,la,ma,ua,xa=ka,ia=la){sa(W);if(!ca||!ca.coords.length)return null;ma=ha[ma];const {coords:na,lengths:ya}=ca;ca=d(ka,la);const Ga=d(ka&&xa,la&&ia);ka=f(ka,la,xa,ia);if(!ya.length)return ka(W.coords,na,0,0,na[0],na[1]),sa(W,ca,0),W;la=0;ua*=ua;for(const Ka of ya){if(Ka<ma){la+=
Ka*ca;continue}xa=W.coords.length/Ga;ia=la;const Ra=la+(Ka-1)*ca;ka(W.coords,na,W.coords.length,ia,na[ia],na[ia+1]);Q(W.coords,na,ca,ua,ka,ia,Ra);ka(W.coords,na,W.coords.length,Ra,na[Ra],na[Ra+1]);ia=W.coords.length/Ga-xa;ia>=ma?W.lengths.push(ia):Aa(W.coords,xa*Ga);la+=Ka*ca}return W.coords.length?W:null};u.getBoundsOptimizedGeometry=function(W,ca,ka,la){if(C.isNone(ca)||!ca.coords||!ca.coords.length)return null;ka=d(ka,la);let ma=la=Number.POSITIVE_INFINITY,ua=Number.NEGATIVE_INFINITY,xa=Number.NEGATIVE_INFINITY;
if(ca&&ca.coords){ca=ca.coords;for(let ia=0;ia<ca.length;ia+=ka){const na=ca[ia],ya=ca[ia+1];la=Math.min(la,na);ua=Math.max(ua,na);ma=Math.min(ma,ya);xa=Math.max(xa,ya)}}w.is(W)?w.fromRectValues(W,la,ma,ua,xa):y.fromValues(la,ma,ua,xa,W);return W};u.getQuantizedArea=function(W,ca){const {coords:ka,lengths:la}=W;let ma=W=0;for(let ua=0;ua<la.length;ua++){const xa=la[ua];ma+=X(ka,W,xa,ca);W+=xa}return Math.abs(ma)};u.getQuantizedBoundsOptimizedGeometry=function(W,ca,ka,la){ka=d(ka,la);const {lengths:ma,
coords:ua}=ca;la=ca=Number.POSITIVE_INFINITY;let xa=Number.NEGATIVE_INFINITY,ia=Number.NEGATIVE_INFINITY,na=0;for(const ya of ma){let Ga=ua[na],Ka=ua[na+1];ca=Math.min(Ga,ca);la=Math.min(Ka,la);xa=Math.max(Ga,xa);ia=Math.max(Ka,ia);na+=ka;for(let Ra=1;Ra<ya;Ra++,na+=ka){const Qa=ua[na],Ta=ua[na+1];Ga+=Qa;Ka+=Ta;0>Qa&&(ca=Math.min(ca,Ga));0<Qa&&(xa=Math.max(xa,Ga));0>Ta?la=Math.min(la,Ka):0<Ta&&(ia=Math.max(ia,Ka))}}W[0]=ca;W[1]=la;W[2]=xa;W[3]=ia;return W};u.getSignedQuantizedRingArea=X;u.quantizeOptimizedFeatureSet=
function(W,ca){const {geometryType:ka,features:la,hasM:ma,hasZ:ua}=ca;if(!W)return ca;for(let xa=0;xa<la.length;xa++){const ia=la[xa],na=ia.weakClone();na.geometry=new c;P(na.geometry,ia.geometry,ma,ua,ka,W);ia.centroid&&(na.centroid=new c,P(na.centroid,ia.centroid,ma,ua,"esriGeometryPoint",W));la[xa]=na}ca.transform=W;return ca};u.quantizeOptimizedGeometry=P;u.quantizeX=k;u.quantizeY=g;u.removeCollinearVectices=function(W,ca,ka,la,ma){if(!ca||!ca.coords||!ca.coords.length)return null;ka=ha[ka];const {coords:ua,
lengths:xa}=ca;ca=f(la,ma,la,ma);la=d(la,ma);let ia=ma=0,na=0,ya=0;for(const Ra of xa){ia=ya;ca(W.coords,ua,ia,ma,ua[ma],ua[ma+1]);ma+=la;var Ga=ua[ma];let Qa=ua[ma+1],Ta=Ga,Sa=Qa;var Ka=Qa/Ga;ia+=la;ca(W.coords,ua,ia,ma,Ta,Sa);ma+=la;for(let Na=2;Na<Ra;Na++){Ga=ua[ma];Qa=ua[ma+1];const Ua=Qa/Ga,Ja=Ka===Ua||!isFinite(Ka)&&!isFinite(Ua);Ka=Ja&&isFinite(Ua)?0<=Ka&&0<=Ua||0>=Ka&&0>=Ua:0<=Sa&&0<=Qa||0>=Sa&&0>=Qa;Ja&&Ka?(Ta+=Ga,Sa+=Qa):(Ta=Ga,Sa=Qa,ia+=la);ca(W.coords,ua,ia,ma,Ta,Sa);ma+=la;Ka=Ua}ia+=
la;Ga=(ia-ya)/la;Ga>=ka&&(W.lengths[na]=Ga,ya=ia,na++)}W.coords.length>ya&&(W.coords.length=ya);W.lengths.length>na&&(W.lengths.length=na);return W.coords.length&&W.lengths.length?W:null};u.removeZMValues=function(W,ca,ka,la,ma,ua){sa(W);W.lengths.push(...ca.lengths);if(ka===ma&&la===ua)for(var xa=0;xa<ca.coords.length;xa++)W.coords.push(ca.coords[xa]);else for(xa=d(ka,la),ka=f(ka,la,ma,ua),ca=ca.coords,la=0;la<ca.length;la+=xa)ka(W.coords,ca,W.coords.length,la,ca[la],ca[la+1]);return W};u.unquantizeOptimizedFeatureSet=
function(W){const {transform:ca,features:ka,hasM:la,hasZ:ma}=W;if(!ca)return W;for(const ua of ka)C.isSome(ua.geometry)&&Z(ua.geometry,ua.geometry,la,ma,ca),C.isSome(ua.centroid)&&Z(ua.centroid,ua.centroid,la,ma,ca);W.transform=null;return W};u.unquantizeOptimizedGeometry=Z;u.unquantizeValue=e;u.unquantizeX=function(W,ca){return e(W,ca,0)};u.unquantizeY=function(W,ca){return e(W,-ca,1)};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/aaBoundingBox":function(){define(["exports",
"../../core/maybe","../Extent","./aaBoundingRect"],function(u,t,H,C){function w(a=g){return[a[0],a[1],a[2],a[3],a[4],a[5]]}function y(a,b,l,q,n,v,B=w()){B[0]=a;B[1]=b;B[2]=l;B[3]=q;B[4]=n;B[5]=v;return B}function x(a){return a[0]>=a[3]?0:a[3]-a[0]}function m(a){return a[1]>=a[4]?0:a[4]-a[1]}function h(a){return a[2]>=a[5]?0:a[5]-a[2]}function c(a,b){return Math.max(b[0],a[0])<=Math.min(b[3],a[3])&&Math.max(b[1],a[1])<=Math.min(b[4],a[4])&&Math.max(b[2],a[2])<=Math.min(b[5],a[5])}function d(a,b){a[0]=
b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];return a}function f(a){return 6===a.length}const k=[Infinity,Infinity,Infinity,-Infinity,-Infinity,-Infinity],g=[0,0,0,0,0,0],e=w();u.NEGATIVE_INFINITY=k;u.POSITIVE_INFINITY=[-Infinity,-Infinity,-Infinity,Infinity,Infinity,Infinity];u.ZERO=g;u.allFinite=function(a){for(let b=0;6>b;b++)if(!isFinite(a[b]))return!1;return!0};u.center=function(a,b=[0,0,0]){b[0]=a[0]+x(a)/2;b[1]=a[1]+m(a)/2;b[2]=a[2]+h(a)/2;return b};u.contains=function(a,b){return b[0]>=
a[0]&&b[1]>=a[1]&&b[2]>=a[2]&&b[3]<=a[3]&&b[4]<=a[4]&&b[5]<=a[5]};u.containsPoint=function(a,b){return b[0]>=a[0]&&b[1]>=a[1]&&b[2]>=a[2]&&b[0]<=a[3]&&b[1]<=a[4]&&b[2]<=a[5]};u.containsPointWithMargin=function(a,b,l){return b[0]>=a[0]-l&&b[1]>=a[1]-l&&b[2]>=a[2]-l&&b[0]<=a[3]+l&&b[1]<=a[4]+l&&b[2]<=a[5]+l};u.create=w;u.depth=m;u.diameter=function(a){const b=x(a),l=h(a);a=m(a);return Math.sqrt(b*b+l*l+a*a)};u.empty=function(a){return a?d(a,k):w(k)};u.equals=function(a,b,l){if(t.isNone(a)||t.isNone(b))return a===
b;if(!f(a)||!f(b))return!1;if(l)for(let q=0;q<a.length;q++){if(!l(a[q],b[q]))return!1}else for(l=0;l<a.length;l++)if(a[l]!==b[l])return!1;return!0};u.expandWithAABB=function(a,b){a[0]=Math.min(a[0],b[0]);a[1]=Math.min(a[1],b[1]);a[2]=Math.min(a[2],b[2]);a[3]=Math.max(a[3],b[3]);a[4]=Math.max(a[4],b[4]);a[5]=Math.max(a[5],b[5])};u.expandWithBuffer=function(a,b,l=0,q=b.length/3){let n=a[0],v=a[1],B=a[2],z=a[3],p=a[4],r=a[5];for(let D=0;D<q;D++)n=Math.min(n,b[l+3*D]),v=Math.min(v,b[l+3*D+1]),B=Math.min(B,
b[l+3*D+2]),z=Math.max(z,b[l+3*D]),p=Math.max(p,b[l+3*D+1]),r=Math.max(r,b[l+3*D+2]);a[0]=n;a[1]=v;a[2]=B;a[3]=z;a[4]=p;a[5]=r};u.expandWithNestedArray=function(a,b,l){const q=b.length;let n=a[0],v=a[1],B=a[2],z=a[3],p=a[4],r=a[5];if(l)for(l=0;l<q;l++){var D=b[l];n=Math.min(n,D[0]);v=Math.min(v,D[1]);B=Math.min(B,D[2]);z=Math.max(z,D[0]);p=Math.max(p,D[1]);r=Math.max(r,D[2])}else for(l=0;l<q;l++)D=b[l],n=Math.min(n,D[0]),v=Math.min(v,D[1]),z=Math.max(z,D[0]),p=Math.max(p,D[1]);a[0]=n;a[1]=v;a[2]=
B;a[3]=z;a[4]=p;a[5]=r};u.expandWithOffset=function(a,b,l,q){a[0]=Math.min(a[0],a[0]+b);a[3]=Math.max(a[3],a[3]+b);a[1]=Math.min(a[1],a[1]+l);a[4]=Math.max(a[4],a[4]+l);a[2]=Math.min(a[2],a[2]+q);a[5]=Math.max(a[5],a[5]+q)};u.expandWithRect=function(a,b){a[0]=Math.min(a[0],b[0]);a[1]=Math.min(a[1],b[1]);a[3]=Math.max(a[3],b[2]);a[4]=Math.max(a[4],b[3])};u.expandWithVec3=function(a,b){a[0]=Math.min(a[0],b[0]);a[1]=Math.min(a[1],b[1]);a[2]=Math.min(a[2],b[2]);a[3]=Math.max(a[3],b[0]);a[4]=Math.max(a[4],
b[1]);a[5]=Math.max(a[5],b[2])};u.fromExtent=function(a,b=w()){b[0]=a.xmin;b[1]=a.ymin;b[2]=a.hasZ?a.zmin:-Infinity;b[3]=a.xmax;b[4]=a.ymax;b[5]=a.hasZ?a.zmax:Infinity;return b};u.fromMinMax=function(a,b,l=w()){l[0]=a[0];l[1]=a[1];l[2]=a[2];l[3]=b[0];l[4]=b[1];l[5]=b[2];return l};u.fromRect=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=Number.NEGATIVE_INFINITY;a[3]=b[2];a[4]=b[3];a[5]=Number.POSITIVE_INFINITY;return a};u.fromRectValues=function(a,b,l,q,n){a[0]=b;a[1]=l;a[2]=Number.NEGATIVE_INFINITY;a[3]=
q;a[4]=n;a[5]=Number.POSITIVE_INFINITY;return a};u.fromValues=y;u.getMax=function(a,b){b[0]=a[3];b[1]=a[4];b[2]=a[5];return b};u.getMin=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};u.height=h;u.intersects=c;u.intersectsClippingArea=function(a,b){return t.isNone(b)?!0:c(a,b)};u.is=f;u.isPoint=function(a){return 0===x(a)&&0===m(a)&&0===h(a)};u.maximumDimension=function(a){return Math.max(x(a),h(a),m(a))};u.offset=function(a,b,l,q,n=a){n[0]=a[0]+b;n[1]=a[1]+l;n[2]=a[2]+q;n[3]=a[3]+b;n[4]=a[4]+
l;n[5]=a[5]+q;return n};u.scale=function(a,b,l=a){const q=a[0]+x(a)/2,n=a[1]+m(a)/2,v=a[2]+h(a)/2;l[0]=q+(a[0]-q)*b;l[1]=n+(a[1]-n)*b;l[2]=v+(a[2]-v)*b;l[3]=q+(a[3]-q)*b;l[4]=n+(a[4]-n)*b;l[5]=v+(a[5]-v)*b;return l};u.set=d;u.setMax=function(a,b,l=a){l[3]=b[0];l[4]=b[1];l[5]=b[2];l!==a&&(l[0]=a[0],l[1]=a[1],l[2]=a[2]);return a};u.setMin=function(a,b,l=a){l[0]=b[0];l[1]=b[1];l[2]=b[2];l!==a&&(l[3]=a[3],l[4]=a[4],l[5]=a[5]);return l};u.size=function(a,b=[0,0,0]){b[0]=x(a);b[1]=m(a);b[2]=h(a);return b};
u.toExtent=function(a,b){return isFinite(a[2])||isFinite(a[5])?new H({xmin:a[0],xmax:a[3],ymin:a[1],ymax:a[4],zmin:a[2],zmax:a[5],spatialReference:b}):new H({xmin:a[0],xmax:a[3],ymin:a[1],ymax:a[4],spatialReference:b})};u.toRect=function(a,b){b||(b=C.create());b[0]=a[0];b[1]=a[1];b[2]=a[3];b[3]=a[4];return b};u.width=x;u.wrap=function(a,b,l,q,n,v){return y(a,b,l,q,n,v,e)};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/OptimizedFeature":function(){define(["exports",
"../../chunks/_rollupPluginBabelHelpers","../../core/maybe"],function(u,t,H){let C=function(){function y(x=null,m={},h,c){this.geometry=x;this.attributes=m;this.centroid=h;this.objectId=c;this.geohashY=this.geohashX=this.displayId=0}y.prototype.weakClone=function(){const x=new y(this.geometry,this.attributes,this.centroid,this.objectId);x.displayId=this.displayId;x.geohashX=this.geohashX;x.geohashY=this.geohashY;return x};return y}(),w=function(y){function x(){return y.apply(this,arguments)||this}
t._inheritsLoose(x,y);return x}(C);u.OptimizedFeature=C;u.OptimizedFeatureWithGeometry=w;u.hasGeometry=function(y){return!(H.isNone(y.geometry)||!y.geometry.coords||!y.geometry.coords.length)};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/OptimizedFeatureSet":function(){define(function(){return function(){function u(){this.spatialReference=this.geometryType=this.geometryProperties=this.geohashFieldName=this.globalIdFieldName=this.objectIdFieldName=null;this.hasM=
this.hasZ=!1;this.features=[];this.fields=[];this.transform=null;this.exceededTransferLimit=!1;this.queryGeometry=this.queryGeometryType=this.uniqueIdField=null}u.prototype.weakClone=function(){const t=new u;t.objectIdFieldName=this.objectIdFieldName;t.globalIdFieldName=this.globalIdFieldName;t.geohashFieldName=this.geohashFieldName;t.geometryProperties=this.geometryProperties;t.geometryType=this.geometryType;t.spatialReference=this.spatialReference;t.hasZ=this.hasZ;t.hasM=this.hasM;t.features=this.features;
t.fields=this.fields;t.transform=this.transform;t.exceededTransferLimit=this.exceededTransferLimit;t.uniqueIdField=this.uniqueIdField;t.queryGeometry=this.queryGeometry;t.queryGeometryType=this.queryGeometryType;return t};return u}()})},"esri/layers/graphics/OptimizedGeometry":function(){define(["../../chunks/_rollupPluginBabelHelpers"],function(u){return function(){function t(C=[],w=[],y=!1){this.lengths=C??[];this.coords=w??[];this.hasIndeterminateRingOrder=y}t.fromRect=function(C){const [w,y,x,
m]=C;C=x-w;const h=m-y;return new t([5],[w,y,C,0,0,h,-C,0,0,-h])};var H=t.prototype;H.forEachVertex=function(C){let w=0;this.lengths.length||C(this.coords[0],this.coords[1]);for(let y=0;y<this.lengths.length;y++){const x=this.lengths[y];for(let m=0;m<x;m++)C(this.coords[2*(m+w)],this.coords[2*(m+w)+1]);w+=x}};H.clone=function(C){return C?(C.set(this.coords),new t(this.lengths.slice(),C,this.hasIndeterminateRingOrder)):new t(this.lengths.slice(),this.coords.slice(),this.hasIndeterminateRingOrder)};
u._createClass(t,[{key:"isPoint",get:function(){return 0===this.lengths.length}},{key:"maxLength",get:function(){return Math.max(...this.lengths)}},{key:"size",get:function(){return this.lengths.reduce((C,w)=>C+w)}}]);return t}()})},"esri/layers/graphics/data/QueryEngine":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/arrayUtils ../../../core/Error ../../../core/lang ../../../core/maybe ../../../core/MemCache ../../../core/promiseUtils ../../../core/unitUtils ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./attributeSupport ./projectionSupport ./QueryEngineCapabilities ./QueryEngineResult ./spatialQuerySupport ./timeSupport ./utils ../../support/FieldsIndex ../../../support/arcadeOnDemand ../../../views/support/Scheduler".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f,k,g,e,a,b,l,q,n,v,B,z,p,r,D){function J(I){return null!=I&&I.every(G=>"exceedslimit"!==G.statisticType)}const K=new x.MemCacheStorage(2E6);let F=0,A=function(){function I(E){this._changeHandle=this._geometryQueryCache=null;this.capabilities={query:q.queryCapabilities};this.geometryType=E.geometryType;this.hasM=!!E.hasM;this.hasZ=!!E.hasZ;this.objectIdField=E.objectIdField;this.spatialReference=E.spatialReference;this.definitionExpression=E.definitionExpression;this.featureStore=
E.featureStore;this.aggregateAdapter=E.aggregateAdapter;this._changeHandle=this.featureStore.events.on("changed",()=>this.clearCache());this.timeInfo=E.timeInfo;E.cacheSpatialQueries&&(this._geometryQueryCache=new x.MemCache(F++ +"$$",K));this.fieldsIndex=new p(E.fields);E.scheduler&&E.priority&&(this._frameTask=E.scheduler.registerTask(E.priority))}var G=I.prototype;G.destroy=function(){this._frameTask=y.removeMaybe(this._frameTask);this.clearCache();y.destroyMaybe(this._geometryQueryCache);this._changeHandle=
y.removeMaybe(this._changeHandle);y.destroyMaybe(this.fieldsIndex)};G.clearCache=function(){this._geometryQueryCache?.clear();this._timeExtentPromise=this._allFeaturesPromise=null};G.executeQuery=function(){var E=t._asyncToGenerator(function*(M,T){try{return(yield this._executeQuery(M,{},T)).createQueryResponse()}catch(Y){if(Y!==z.QUERY_ENGINE_EMPTY_RESULT)throw Y;return(new n.QueryEngineResult([],M,this)).createQueryResponse()}});return function(M,T){return E.apply(this,arguments)}}();G.executeQueryForCount=
function(){var E=t._asyncToGenerator(function*(M={},T){try{return(yield this._executeQuery(M,{returnGeometry:!1,returnCentroid:!1,outSR:null},T)).createQueryResponseForCount()}catch(Y){if(Y!==z.QUERY_ENGINE_EMPTY_RESULT)throw Y;return 0}});return function(){return E.apply(this,arguments)}}();G.executeQueryForExtent=function(){var E=t._asyncToGenerator(function*(M,T){const Y=M.outSR;try{const fa=yield this._executeQuery(M,{returnGeometry:!0,returnCentroid:!1,outSR:null},T),ba=fa.size;if(!ba)return{count:0,
extent:null};const U=yield this._getBounds(fa.items,fa.spatialReference,Y||this.spatialReference);return{count:ba,extent:U}}catch(fa){if(fa===z.QUERY_ENGINE_EMPTY_RESULT)return{count:0,extent:null};throw fa;}});return function(M,T){return E.apply(this,arguments)}}();G.executeQueryForIds=function(){var E=t._asyncToGenerator(function*(M,T){return this.executeQueryForIdSet(M,T).then(Y=>Array.from(Y))});return function(M,T){return E.apply(this,arguments)}}();G.executeQueryForIdSet=function(){var E=t._asyncToGenerator(function*(M,
T){try{const Y=yield this._executeQuery(M,{returnGeometry:!0,returnCentroid:!1,outSR:null},T),fa=Y.items,ba=new Set;yield this._reschedule(()=>{for(const U of fa)ba.add(Y.featureAdapter.getObjectId(U))},T);return ba}catch(Y){if(Y===z.QUERY_ENGINE_EMPTY_RESULT)return new Set;throw Y;}});return function(M,T){return E.apply(this,arguments)}}();G.executeQueryForSnapping=function(){var E=t._asyncToGenerator(function*(M,T){const {point:Y,distance:fa,types:ba}=M;if(ba===n.SnappingTypes.NONE)return{candidates:[]};
const U=yield this._reschedule(()=>this._checkQuerySupport(M.query),T),P=!e.equals(Y.spatialReference,this.spatialReference);P&&(yield l.checkProjectionSupport(Y.spatialReference,this.spatialReference));var Q="number"===typeof fa?fa:fa.x,Z="number"===typeof fa?fa:fa.y;Q={xmin:Y.x-Q,xmax:Y.x+Q,ymin:Y.y-Z,ymax:Y.y+Z,spatialReference:Y.spatialReference};Q=P?l.project(Q,this.spatialReference):Q;if(!Q)return{candidates:[]};Z=(yield g.normalizeCentralMeridian(k.fromJSON(Y),null,{signal:T}))[0];const X=
(yield g.normalizeCentralMeridian(k.fromJSON(Q),null,{signal:T}))[0];if(y.isNone(Z)||y.isNone(X))return{candidates:[]};const sa=new n.QueryEngineResult(yield this._reschedule(()=>this._searchFeatures(this._getQueryBBoxes(X.toJSON())),T),U,this);yield this._reschedule(()=>this._executeObjectIdsQuery(sa),T);yield this._reschedule(()=>this._executeTimeQuery(sa),T);yield this._reschedule(()=>this._executeAttributesQuery(sa),T);T=Z.toJSON();T=P?l.project(T,this.spatialReference):T;return sa.createSnappingResponse({...M,
point:T,distance:P?Math.max(Q.xmax-Q.xmin,Q.ymax-Q.ymin)/2:fa},Y.spatialReference)});return function(M,T){return E.apply(this,arguments)}}();G.executeQueryForLatestObservations=function(){var E=t._asyncToGenerator(function*(M,T){if(!this.timeInfo||!this.timeInfo.trackIdField)throw new C("feature-store:unsupported-query","Missing timeInfo or timeInfo.trackIdField",{query:M,timeInfo:this.timeInfo});try{const Y=yield this._executeQuery(M,{},T);yield this._reschedule(()=>this._filterLatest(Y),T);return Y.createQueryResponse()}catch(Y){if(Y!==
z.QUERY_ENGINE_EMPTY_RESULT)throw Y;return(new n.QueryEngineResult([],M,this)).createQueryResponse()}});return function(M,T){return E.apply(this,arguments)}}();G.executeQueryForSummaryStatistics=function(){var E=t._asyncToGenerator(function*(M={},T,Y){const {field:fa,normalizationField:ba,valueExpression:U}=T;return(yield this._getQueryEngineResultForStats(M,{field:fa,normalizationField:ba,valueExpression:U},Y)).createSummaryStatisticsResponse(T)});return function(){return E.apply(this,arguments)}}();
G.executeQueryForUniqueValues=function(){var E=t._asyncToGenerator(function*(M={},T,Y){const {field:fa,field2:ba,field3:U,valueExpression:P}=T;return(yield this._getQueryEngineResultForStats(M,{field:fa,field2:ba,field3:U,valueExpression:P},Y)).createUniqueValuesResponse(T)});return function(){return E.apply(this,arguments)}}();G.executeQueryForClassBreaks=function(){var E=t._asyncToGenerator(function*(M={},T,Y){const {field:fa,normalizationField:ba,valueExpression:U}=T;return(yield this._getQueryEngineResultForStats(M,
{field:fa,normalizationField:ba,valueExpression:U},Y)).createClassBreaksResponse(T)});return function(){return E.apply(this,arguments)}}();G.executeQueryForHistogram=function(){var E=t._asyncToGenerator(function*(M={},T,Y){const {field:fa,normalizationField:ba,valueExpression:U}=T;return(yield this._getQueryEngineResultForStats(M,{field:fa,normalizationField:ba,valueExpression:U},Y)).createHistogramResponse(T)});return function(){return E.apply(this,arguments)}}();G.fetchRecomputedExtents=function(){var E=
t._asyncToGenerator(function*(M){const [T,Y]=yield Promise.all(["getFullExtent"in this.featureStore&&this.featureStore.getFullExtent?Promise.resolve(this.featureStore.getFullExtent(this.spatialReference)):this._getBounds(yield this._getAllFeatures(),this.spatialReference,this.spatialReference),y.isSome(this._timeExtentPromise)?this._timeExtentPromise:this._timeExtentPromise=B.getTimeExtent(this.timeInfo,this.featureStore)]);m.throwIfAborted(M);return{fullExtent:T,timeExtent:Y}});return function(M){return E.apply(this,
arguments)}}();G._getBounds=function(){var E=t._asyncToGenerator(function*(M,T,Y){const fa=c.set(c.create(),c.NEGATIVE_INFINITY);yield this.featureStore.forEachBounds(M,ba=>c.expandWithAABB(fa,ba));M={xmin:fa[0],ymin:fa[1],xmax:fa[3],ymax:fa[4],spatialReference:z.cleanFromGeometryEngine(this.spatialReference)};this.hasZ&&isFinite(fa[2])&&isFinite(fa[5])&&(M.zmin=fa[2],M.zmax=fa[5]);T=l.project(M,T,Y);T.spatialReference=z.cleanFromGeometryEngine(Y);0===T.xmax-T.xmin&&(Y=h.getMetersPerUnitForSR(T.spatialReference),
T.xmin-=Y,T.xmax+=Y);0===T.ymax-T.ymin&&(Y=h.getMetersPerUnitForSR(T.spatialReference),T.ymin-=Y,T.ymax+=Y);this.hasZ&&null!=T.zmin&&null!=T.zmax&&0===T.zmax-T.zmin&&(Y=h.getMetersPerUnitForSR(T.spatialReference),T.zmin-=Y,T.zmax+=Y);return T});return function(M,T,Y){return E.apply(this,arguments)}}();G._schedule=function(){var E=t._asyncToGenerator(function*(M,T){return y.isSome(this._frameTask)?this._frameTask.schedule(M,T):M(D.noBudget)});return function(M,T){return E.apply(this,arguments)}}();
G._reschedule=function(){var E=t._asyncToGenerator(function*(M,T){return y.isSome(this._frameTask)?this._frameTask.reschedule(M,T):M(D.noBudget)});return function(M,T){return E.apply(this,arguments)}}();G._getAllFeaturesQueryEngineResult=function(){var E=t._asyncToGenerator(function*(M){return new n.QueryEngineResult(yield this._getAllFeatures(),M,this)});return function(M){return E.apply(this,arguments)}}();G._getAllFeatures=function(){var E=t._asyncToGenerator(function*(){var M=this;if(y.isNone(this._allFeaturesPromise)){const fa=
[];this._allFeaturesPromise=t._asyncToGenerator(function*(){yield M.featureStore.forEach(ba=>fa.push(ba))})().then(()=>fa)}const T=this._allFeaturesPromise,Y=yield T;return T===this._allFeaturesPromise?Y.slice():this._getAllFeatures()});return function(){return E.apply(this,arguments)}}();G._executeQuery=function(){var E=t._asyncToGenerator(function*(M,T,Y){M=w.clone(M);M=yield this._schedule(()=>z.normalizeQuery(M,this.definitionExpression,this.spatialReference),Y);M=yield this._reschedule(()=>this._checkQuerySupport(M),
Y);M={...M,...T};const fa=yield this._reschedule(()=>this._executeSceneFilterQuery(M,Y),Y),ba=yield this._reschedule(()=>this._executeGeometryQuery(M,fa,Y),Y);yield this._reschedule(()=>this._executeAggregateIdsQuery(ba),Y);yield this._reschedule(()=>this._executeObjectIdsQuery(ba),Y);yield this._reschedule(()=>this._executeTimeQuery(ba),Y);yield this._reschedule(()=>this._executeAttributesQuery(ba),Y);return ba});return function(M,T,Y){return E.apply(this,arguments)}}();G._executeSceneFilterQuery=
function(){var E=t._asyncToGenerator(function*(M,T){var Y=this;if(y.isNone(M.sceneFilter))return null;const {outSR:fa,returnGeometry:ba,returnCentroid:U}=M;var P=this.featureStore.featureSpatialReference,Q=M.sceneFilter.geometry;const Z=y.isNone(P)||e.equals(P,Q.spatialReference)?Q:l.project(Q,P);if(!Z)return null;P=ba||U;P=e.isValid(fa)&&!e.equals(this.spatialReference,fa)&&P?function(){var Da=t._asyncToGenerator(function*(ha){return Y._project(ha,fa)});return function(ha){return Da.apply(this,arguments)}}():
Da=>Da;const X=this.featureAdapter;Q=yield this._reschedule(()=>this._searchFeatures(this._getQueryBBoxes(Z)),T);if("disjoint"===M.sceneFilter.spatialRelationship){if(!Q.length)return null;const Da=new Set;for(var sa of Q)Da.add(X.getObjectId(sa));const ha=yield this._reschedule(()=>this._getAllFeatures(),T);sa=yield this._reschedule(t._asyncToGenerator(function*(){const Ea=yield v.getSpatialQueryOperator("esriSpatialRelDisjoint",Z,Y.geometryType,Y.hasZ,Y.hasM),za=yield Y._runSpatialFilter(ha,N=>
!Da.has(X.getObjectId(N))||Ea(X.getGeometry(N)),T);return new n.QueryEngineResult(za,M,Y)}),T);return P(sa)}if(!Q.length)return new n.QueryEngineResult([],M,this);if(this._canExecuteSinglePass(Z,M))return P(new n.QueryEngineResult(Q,M,this));const Aa=yield v.getSpatialQueryOperator("esriSpatialRelContains",Z,this.geometryType,this.hasZ,this.hasM);sa=yield this._runSpatialFilter(Q,Da=>Aa(X.getGeometry(Da)),T);return P(new n.QueryEngineResult(sa,M,this))});return function(M,T){return E.apply(this,arguments)}}();
G._executeGeometryQuery=function(){var E=t._asyncToGenerator(function*(M,T,Y){var fa=this;if(y.isSome(T)&&0===T.items.length)return T;M=y.isSome(T)?T.query:M;const {geometry:ba,outSR:U,spatialRel:P,returnGeometry:Q,returnCentroid:Z}=M;var X=this.featureStore.featureSpatialReference;const sa=!ba||y.isNone(X)||e.equals(X,ba.spatialReference)?ba:l.project(ba,X),Aa=Q||Z,Da=e.isValid(U)&&!e.equals(this.spatialReference,U),ha=this._geometryQueryCache&&y.isNone(T)?Da&&Aa?JSON.stringify({originalFilterGeometry:ba,
spatialRelationship:P,outSpatialReference:U}):JSON.stringify({originalFilterGeometry:ba,spatialRelationship:P}):null;X=ha?this._geometryQueryCache.get(ha):null;if(y.isSome(X))return new n.QueryEngineResult(X,M,this);X=function(){var ea=t._asyncToGenerator(function*(oa){Da&&Aa&&(yield fa._project(oa,U));ha&&fa._geometryQueryCache.put(ha,oa.items,oa.items.length+1);return oa});return function(oa){return ea.apply(this,arguments)}}();if(!sa)return X(y.isSome(T)?T:yield this._getAllFeaturesQueryEngineResult(M));
const Ea=this.featureAdapter;let za=yield this._reschedule(()=>this._searchFeatures(this._getQueryBBoxes(ba)),Y);if("esriSpatialRelDisjoint"===P){if(!za.length)return X(y.isSome(T)?T:yield this._getAllFeaturesQueryEngineResult(M));const ea=new Set;for(var N of za)ea.add(Ea.getObjectId(N));const oa=y.isSome(T)?T.items:yield this._reschedule(()=>this._getAllFeatures(),Y);N=yield this._reschedule(t._asyncToGenerator(function*(){const va=yield v.getSpatialQueryOperator(P,sa,fa.geometryType,fa.hasZ,fa.hasM),
W=yield fa._runSpatialFilter(oa,ca=>!ea.has(Ea.getObjectId(ca))||va(Ea.getGeometry(ca)),Y);return new n.QueryEngineResult(W,M,fa)}),Y);return X(N)}if(y.isSome(T)){const ea=new H.PositionHint;za=za.filter(oa=>0<=H.indexOf(T.items,oa,T.items.length,ea))}if(!za.length)return X=new n.QueryEngineResult([],M,this),ha&&this._geometryQueryCache.put(ha,X.items,1),X;if(this._canExecuteSinglePass(sa,M))return X(new n.QueryEngineResult(za,M,this));const S=yield v.getSpatialQueryOperator(P,sa,this.geometryType,
this.hasZ,this.hasM);N=yield this._runSpatialFilter(za,ea=>S(Ea.getGeometry(ea)),Y);return X(new n.QueryEngineResult(N,M,this))});return function(M,T,Y){return E.apply(this,arguments)}}();G._executeAggregateIdsQuery=function(E){if(0!==E.items.length&&E.query.aggregateIds&&E.query.aggregateIds.length&&!y.isNone(this.aggregateAdapter)){var M=new Set;for(const Y of E.query.aggregateIds)this.aggregateAdapter.getFeatureObjectIds(Y).forEach(fa=>M.add(fa));var T=this.featureAdapter.getObjectId;E.items=E.items.filter(Y=>
M.has(T(Y)))}};G._executeObjectIdsQuery=function(E){if(0!==E.items.length&&E.query.objectIds&&E.query.objectIds.length){var M=new Set(E.query.objectIds),T=this.featureAdapter.getObjectId;E.items=E.items.filter(Y=>M.has(T(Y)))}};G._executeTimeQuery=function(E){if(0!==E.items.length){var M=B.getTimeOperator(this.timeInfo,E.query.timeExtent,this.featureAdapter);y.isNone(M)||(E.items=E.items.filter(M))}};G._executeAttributesQuery=function(E){if(0!==E.items.length){var M=b.getWhereClause(E.query.where,
this.fieldsIndex);if(M){if(!M.isStandardized)throw new TypeError("Where clause is not standardized");E.items=E.items.filter(T=>M.testFeature(T,this.featureAdapter))}}};G._runSpatialFilter=function(){var E=t._asyncToGenerator(function*(M,T,Y){var fa=this;if(!T)return M;if(y.isNone(this._frameTask))return M.filter(Q=>T(Q));let ba=0;const U=[],P=function(){var Q=t._asyncToGenerator(function*(Z){for(;ba<M.length;){const X=M[ba++];T(X)&&(U.push(X),Z.madeProgress());Z.done&&(yield fa._reschedule(sa=>P(sa),
Y))}});return function(Z){return Q.apply(this,arguments)}}();return this._reschedule(Q=>P(Q),Y).then(()=>U)});return function(M,T,Y){return E.apply(this,arguments)}}();G._filterLatest=function(E){const {trackIdField:M,startTimeField:T,endTimeField:Y}=this.timeInfo,fa=Y||T,ba=new Map,U=this.featureAdapter.getAttribute;for(const P of E.items){const Q=U(P,M),Z=U(P,fa),X=ba.get(Q);(!X||Z>U(X,fa))&&ba.set(Q,P)}E.items=Array.from(ba.values())};G._canExecuteSinglePass=function(E,M){({spatialRel:M}=M);return v.canQueryWithRBush(E)&&
("esriSpatialRelEnvelopeIntersects"===M||"esriGeometryPoint"===this.geometryType&&("esriSpatialRelIntersects"===M||"esriSpatialRelContains"===M||"esriSpatialRelWithin"===M))};G._project=function(){var E=t._asyncToGenerator(function*(M,T){if(!T||e.equals(this.spatialReference,T))return M;const Y=this.featureAdapter;T=yield l.projectMany(M.items.map(fa=>z.getGeometry(this.geometryType,this.hasZ,this.hasM,Y.getGeometry(fa))),this.spatialReference,T);M.items=T.map((fa,ba)=>Y.cloneWithGeometry(M.items[ba],
a.convertFromGeometry(fa,this.hasZ,this.hasM)));return M});return function(M,T){return E.apply(this,arguments)}}();G._getQueryBBoxes=function(E){if(v.canQueryWithRBush(E)){if(k.isExtent(E))return[d.fromValues(E.xmin,E.ymin,E.xmax,E.ymax)];if(k.isPolygon(E))return E.rings.map(M=>d.fromValues(Math.min(M[0][0],M[2][0]),Math.min(M[0][1],M[2][1]),Math.max(M[0][0],M[2][0]),Math.max(M[0][1],M[2][1])))}return[f.getBoundsXY(d.create(),E)]};G._searchFeatures=function(){var E=t._asyncToGenerator(function*(M){const T=
new Set;yield Promise.all(M.map(Y=>this.featureStore.forEachInBounds(Y,fa=>T.add(fa))));M=Array.from(T.values());T.clear();return M});return function(M){return E.apply(this,arguments)}}();G._checkStatisticsSupport=function(){var E=t._asyncToGenerator(function*(M,T){if(0>(M.distance??0)||null!=M.geometryPrecision||M.multipatchOption||M.pixelSize||M.relationParam||M.text||M.outStatistics||M.groupByFieldsForStatistics||M.having||M.orderByFields)throw new C("feature-store:unsupported-query","Unsupported query options",
{query:M});this._checkAttributesQuerySupport(M);return Promise.all([this._checkStatisticsParamsSupport(T),v.checkSpatialQuerySupport(M,this.geometryType,this.spatialReference),l.checkProjectionSupport(this.spatialReference,M.outSR)]).then(()=>M)});return function(M,T){return E.apply(this,arguments)}}();G._checkStatisticsParamsSupport=function(){var E=t._asyncToGenerator(function*(M){var T=[];M.valueExpression&&({arcadeUtils:T}=yield r.loadArcade(),T=T.extractFieldNames(M.valueExpression));M.field&&
T.push(M.field);M.field2&&T.push(M.field2);M.field3&&T.push(M.field3);M.normalizationField&&T.push(M.normalizationField);if(!T.length)throw new C("feature-store:unsupported-query","params should have at least a field or valueExpression",{params:M});b.validateFields(this.fieldsIndex,T,"params contains missing fields")});return function(M){return E.apply(this,arguments)}}();G._checkQuerySupport=function(){var E=t._asyncToGenerator(function*(M){if(0>(M.distance??0)||null!=M.geometryPrecision||M.multipatchOption||
M.pixelSize||M.relationParam||M.text)throw new C("feature-store:unsupported-query","Unsupported query options",{query:M});this._checkAttributesQuerySupport(M);this._checkStatisticsQuerySupport(M);return Promise.all([v.checkSpatialQuerySupport(M,this.geometryType,this.spatialReference),l.checkProjectionSupport(this.spatialReference,M.outSR)]).then(()=>M)});return function(M){return E.apply(this,arguments)}}();G._checkAttributesQuerySupport=function(E){const {outFields:M,orderByFields:T,returnDistinctValues:Y,
outStatistics:fa}=E,ba=fa?fa.map(U=>U.outStatisticFieldName&&U.outStatisticFieldName.toLowerCase()).filter(Boolean):[];if(T&&0<T.length){const U=T.map(P=>{const Q=P.toLowerCase();return Q.includes(" asc")?Q.split(" asc")[0]:Q.includes(" desc")?Q.split(" desc")[0]:P}).filter(P=>!ba.includes(P));b.validateFields(this.fieldsIndex,U,"orderByFields contains missing fields")}if(M&&0<M.length)b.validateFields(this.fieldsIndex,M,"outFields contains missing fields");else if(Y)throw new C("feature-store:unsupported-query",
"outFields should be specified for returnDistinctValues",{query:E});b.validateWhere(this.fieldsIndex,E.where)};G._checkStatisticsQuerySupport=function(E){const {outStatistics:M,groupByFieldsForStatistics:T,having:Y}=E;var fa=T&&T.length,ba=M&&M.length;if(Y){if(!fa||!ba)throw new C("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:E});b.validateHaving(this.fieldsIndex,Y,M)}if(ba&&J(M)){ba=M.map(U=>U.onStatisticField).filter(Boolean);
b.validateFields(this.fieldsIndex,ba,"onStatisticFields contains missing fields");fa&&b.validateFields(this.fieldsIndex,T,"groupByFieldsForStatistics contains missing fields");for(const U of M){const {onStatisticField:P,statisticType:Q}=U;if(("percentile_disc"===Q||"percentile_cont"===Q)&&"statisticParameters"in U){if({statisticParameters:fa}=U,!fa)throw new C("feature-store:unsupported-query","statisticParamters should be set for percentile type",{definition:U,query:E});}else if("count"!==Q&&P&&
b.hasInvalidFieldType(P,this.fieldsIndex))throw new C("feature-store:unsupported-query","outStatistics contains non-numeric fields",{definition:U,query:E});}}};G._getQueryEngineResultForStats=function(){var E=t._asyncToGenerator(function*(M,T,Y){M=w.clone(M);try{M=yield this._schedule(()=>z.normalizeQuery(M,this.definitionExpression,this.spatialReference),Y);M=yield this._reschedule(()=>this._checkStatisticsSupport(M,T),Y);const fa=yield this._reschedule(()=>this._executeSceneFilterQuery(M,Y),Y),
ba=yield this._reschedule(()=>this._executeGeometryQuery(M,fa,Y),Y);yield this._reschedule(()=>this._executeAggregateIdsQuery(ba),Y);yield this._reschedule(()=>this._executeObjectIdsQuery(ba),Y);yield this._reschedule(()=>this._executeTimeQuery(ba),Y);yield this._reschedule(()=>this._executeAttributesQuery(ba),Y);return ba}catch(fa){if(fa!==z.QUERY_ENGINE_EMPTY_RESULT)throw fa;return new n.QueryEngineResult([],M,this)}});return function(M,T,Y){return E.apply(this,arguments)}}();t._createClass(I,[{key:"featureAdapter",
get:function(){return this.featureStore.featureAdapter}}]);return I}();u.Feature=function(I,G=null,E,M,T){this.attributes=I;this.geometry=E;this.centroid=M;this.filterFlags=T;this.groupId=-1;this.displayId=G};u.QueryEngine=A;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/core/MemCache":function(){define(["exports","../chunks/_rollupPluginBabelHelpers","./maybe","./PooledArray"],function(u,t,H,C){u.RemoveMode=void 0;(function(x){x[x.ALL=0]="ALL";x[x.SOME=1]="SOME"})(u.RemoveMode||
(u.RemoveMode={}));let w=function(){function x(h,c,d){this._namespace=h;this._storage=c;this._removeFunc=!1;this._miss=this._hit=0;this._storage.register(this);this._namespace+=":";d&&(this._storage.registerRemoveFunc(this._namespace,d),this._removeFunc=!0)}var m=x.prototype;m.destroy=function(){this._storage.clear(this._namespace);this._removeFunc&&this._storage.deregisterRemoveFunc(this._namespace);this._storage.deregister(this);this._storage=null};m.resetHitRate=function(){this._hit=this._miss=
0};m.put=function(h,c,d,f=0){this._storage.put(this._namespace+h,c,d,f)};m.get=function(h){h=this._storage.get(this._namespace+h);void 0===h?++this._miss:++this._hit;return h};m.pop=function(h){h=this._storage.pop(this._namespace+h);void 0===h?++this._miss:++this._hit;return h};m.updateSize=function(h,c,d){this._storage.updateSize(this._namespace+h,c,d)};m.clear=function(){this._storage.clear(this._namespace)};m.clearAll=function(){this._storage.clearAll()};m.getStats=function(){return this._storage.getStats()};
m.resetStats=function(){this._storage.resetStats()};t._createClass(x,[{key:"namespace",get:function(){return this._namespace.slice(0,-1)}},{key:"hitRate",get:function(){return this._hit/(this._hit+this._miss)}},{key:"size",get:function(){return this._storage.size}},{key:"maxSize",get:function(){return this._storage.maxSize}}]);return x}(),y=function(){function x(h=10485760){this._maxSize=h;this._db=new Map;this._miss=this._hit=this._size=0;this._removeFuncs=new C;this._users=new C}var m=x.prototype;
m.destroy=function(){this.clearAll();this._removeFuncs.clear();this._users.clear();this._db=null};m.register=function(h){this._users.push(h)};m.deregister=function(h){this._users.removeUnordered(h)};m.registerRemoveFunc=function(h,c){this._removeFuncs.push([h,c])};m.deregisterRemoveFunc=function(h){this._removeFuncs.filterInPlace(c=>c[0]!==h)};m.put=function(h,c,d,f){const k=this._db.get(h);k&&(this._size-=k.size,this._db.delete(h),k.entry!==c&&this._notifyRemove(h,k.entry,u.RemoveMode.ALL));d>this._maxSize?
this._notifyRemove(h,c,u.RemoveMode.ALL):void 0===c?console.warn("Refusing to cache undefined entry "):!d||0>d?console.warn("Refusing to cache entry with invalid size "+d):(f=1+Math.max(f,-3)- -3,this._db.set(h,{entry:c,size:d,lifetime:f,lives:f}),this._size+=d,this._checkSizeLimit())};m.updateSize=function(h,c,d){const f=this._db.get(h);if(f&&f.entry===c){for(this._size-=f.size;d>this._maxSize;)if(d=this._notifyRemove(h,c,u.RemoveMode.SOME),!(H.isSome(d)&&0<d)){this._db.delete(h);return}f.size=d;
this._size+=d;this._checkSizeLimit()}};m.pop=function(h){const c=this._db.get(h);if(c)return this._size-=c.size,this._db.delete(h),++this._hit,c.entry;++this._miss};m.get=function(h){const c=this._db.get(h);if(void 0===c)++this._miss;else return this._db.delete(h),c.lives=c.lifetime,this._db.set(h,c),++this._hit,c.entry};m.getStats=function(){const h={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},
c={},d=[];this._db.forEach((g,e)=>{const a=g.lifetime;d[a]=(d[a]||0)+g.size;this._users.forAll(b=>{b=b.namespace;e.startsWith(b)&&(c[b]=(c[b]||0)+g.size)})});const f={};this._users.forAll(g=>{const e=g.namespace;!isNaN(g.hitRate)&&0<g.hitRate?(c[e]=c[e]||0,f[e]=Math.round(100*g.hitRate)+"%"):f[e]="0%"});var k=Object.keys(c);k.sort((g,e)=>c[e]-c[g]);k.forEach(g=>h[g]=Math.round(c[g]/2**20)+"MB / "+f[g]);for(k=d.length-1;0<=k;--k){const g=d[k];g&&(h["Priority "+(k+-3-1)]=Math.round(g/this.size*100)+
"%")}return h};m.resetStats=function(){this._hit=this._miss=0;this._users.forAll(h=>h.resetHitRate())};m.clear=function(h){this._db.forEach((c,d)=>{d.startsWith(h)&&(this._size-=c.size,this._db.delete(d),this._notifyRemove(d,c.entry,u.RemoveMode.ALL))})};m.clearAll=function(){this._db.forEach((h,c)=>this._notifyRemove(c,h.entry,u.RemoveMode.ALL));this._size=0;this._db.clear()};m._getHitRate=function(){return this._hit/(this._hit+this._miss)};m._notifyRemove=function(h,c,d){let f;this._removeFuncs.some(k=>
h.startsWith(k[0])?(k=k[1](c,d),"number"===typeof k&&(f=k),!0):!1);return f};m._checkSizeLimit=function(){if(!(this._size<=this._maxSize))for(const [h,c]of this._db){this._db.delete(h);if(1>=c.lives){this._size-=c.size;const d=this._notifyRemove(h,c.entry,u.RemoveMode.SOME);H.isSome(d)&&0<d&&(this._size+=d,c.lives=c.lifetime,c.size=d,this._db.set(h,c))}else--c.lives,this._db.set(h,c);if(this._size<=.9*this.maxSize)break}};t._createClass(x,[{key:"size",get:function(){return this._size}},{key:"maxSize",
get:function(){return this._maxSize},set:function(h){this._maxSize=Math.max(h,0);this._checkSizeLimit()}}]);return x}();u.MIN_PRIORITY=-3;u.MemCache=w;u.MemCacheStorage=y;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/normalizeUtils":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../config ../../core/Error ../../core/Logger ../../core/maybe ../Polygon ../Polyline ./normalizeUtilsCommon ./spatialReferenceUtils ./webMercatorUtils ../../rest/geometryService/cut ../../rest/geometryService/simplify".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f,k){function g(B){const z=[];let p=0,r=0;for(let D=0;D<B.length;D++){const J=B[D];let K=null;for(let F=0;F<J.length;F++)K=J[F],z.push(K),0===F?r=p=K[0]:(p=Math.min(p,K[0]),r=Math.max(r,K[0]));K&&z.push([(p+r)/2,0])}return z}function e(B,z){if(!(B instanceof m||B instanceof x))throw v.error("straightLineDensify: the input geometry is neither polyline nor polygon"),new C("straightLineDensify: the input geometry is neither polyline nor polygon");var p=h.getGeometryParts(B);
const r=[];for(const J of p){p=[];r.push(p);p.push([J[0][0],J[0][1]]);for(let K=0;K<J.length-1;K++){const F=J[K][0],A=J[K][1],I=J[K+1][0],G=J[K+1][1];var D=Math.sqrt((I-F)*(I-F)+(G-A)*(G-A));const E=(G-A)/D,M=(I-F)/D,T=D/z;if(1<T){for(let Y=1;Y<=T-1;Y++){const fa=Y*z;p.push([M*fa+F,E*fa+A])}D=(D+Math.floor(T-1)*z)/2;p.push([M*D+F,E*D+A])}p.push([I,G])}}return"polygon"===B.type?new x({rings:r,spatialReference:B.spatialReference}):new m({paths:r,spatialReference:B.spatialReference})}function a(B,z,
p){z&&(B=e(B,1E6),B=d.webMercatorToGeographic(B,!0));p&&(B=h.updatePolyGeometry(B,p));return B}function b(B,z,p){if(Array.isArray(B)){var r=B[0];r>z?(p=h.offsetMagnitude(r,z),B[0]=r+-2*p*z):r<p&&(z=h.offsetMagnitude(r,p),B[0]=r+-2*z*p)}else r=B.x,r>z?(p=h.offsetMagnitude(r,z),B=B.clone().offset(-2*p*z,0)):r<p&&(z=h.offsetMagnitude(r,p),B=B.clone().offset(-2*z*p,0));return B}function l(B,z){let p=-1;for(let r=0;r<z.cutIndexes.length;r++){const D=z.cutIndexes[r],J=z.geometries[r],K=h.getGeometryParts(J);
for(let F=0;F<K.length;F++){const A=K[F];A.some(I=>{if(180>I[0])return!0;I=0;for(var G=0;G<A.length;G++){var E=A[G][0];I=E>I?E:I}I=Number(I.toFixed(9));I=-360*h.offsetMagnitude(I,180);for(G=0;G<A.length;G++)E=J.getPoint(F,G),J.setPoint(F,G,E.clone().offset(I,0));return!0})}if(D===p)if("polygon"===B[0].type)for(const F of h.getGeometryParts(J))B[D]=B[D].addRing(F);else{if("polyline"===B[0].type)for(const F of h.getGeometryParts(J))B[D]=B[D].addPath(F)}else p=D,B[D]=J}return B}function q(B,z,p){return n.apply(this,
arguments)}function n(){n=t._asyncToGenerator(function*(B,z,p){if(!Array.isArray(B))return q([B],z);z&&"string"!==typeof z&&v.warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");var r="string"===typeof z?z:z?.url??H.geometryServiceUrl;let D,J,K;let F=0;var A=[];z=[];for(var I of B)if(y.isNone(I))z.push(I);else{if(!G){var G=I.spatialReference;var E=c.getInfo(G);var M=(D=G.isWebMercator)?102100:4326;J=h.cutParams[M].maxX;K=h.cutParams[M].minX;var T=h.cutParams[M].plus180Line;
M=h.cutParams[M].minus180Line}if(E)if("mesh"===I.type)z.push(I);else if("point"===I.type)z.push(b(I.clone(),J,K));else if("multipoint"===I.type){var Y=I.clone();Y.points=Y.points.map(fa=>b(fa,J,K));z.push(Y)}else if("extent"===I.type)Y=I.clone()._normalize(!1,!1,E),z.push(Y.rings?new x(Y):Y);else if(I.extent){Y=I.extent;const fa=2*h.offsetMagnitude(Y.xmin,K)*J;let ba=0===fa?I.clone():h.updatePolyGeometry(I.clone(),fa);Y.offset(fa,0);Y.intersects(T)&&Y.xmax!==J?(F=Y.xmax>F?Y.xmax:F,ba=a(ba,D),A.push(ba),
z.push("cut")):Y.intersects(M)&&Y.xmin!==K?(F=2*Y.xmax*J>F?2*Y.xmax*J:F,ba=a(ba,D,360),A.push(ba),z.push("cut")):z.push(ba)}else z.push(I.clone());else z.push(I)}G=h.offsetMagnitude(F,J);E=-90;T=G;for(I=new m;0<G;)M=-180+360*G,I.addPath([[M,E],[M,-1*E]]),E*=-1,G--;if(0<A.length&&0<T){G=yield f.cut(r,A,I,p);G=l(A,G);E=[];A=[];for(T=0;T<z.length;T++)I=z[T],"cut"!==I?A.push(I):(I=G.shift(),M=B[T],y.isSome(M)&&"polygon"===M.type&&M.rings&&1<M.rings.length&&I.rings.length>=M.rings.length?(E.push(I),A.push("simplify")):
A.push(D?d.geographicToWebMercator(I):I));if(!E.length)return A;z=yield k.simplify(r,E,p);B=[];for(p=0;p<A.length;p++)r=A[p],"simplify"!==r?B.push(r):B.push(D?d.geographicToWebMercator(z.shift()):z.shift());return B}B=[];for(p=0;p<z.length;p++)r=z[p],"cut"!==r?B.push(r):(r=A.shift(),B.push(!0===D?d.geographicToWebMercator(r):r));return B});return n.apply(this,arguments)}const v=w.getLogger("esri.geometry.support.normalizeUtils");u.getDenormalizedExtent=function(B){if(!B)return null;const z=B.extent;
if(!z)return null;var p=B.spatialReference&&c.getInfo(B.spatialReference);if(!p)return z;const [r,D]=p.valid;({width:p}=z);let {xmin:J,xmax:K}=z;[J,K]=[K,J];if("extent"===B.type||0===p||p<=D||p>2*D||J<r||K>D)return z;let F;switch(B.type){case "polygon":if(1<B.rings.length)F=g(B.rings);else return z;break;case "polyline":if(1<B.paths.length)F=g(B.paths);else return z;break;case "multipoint":F=B.points}B=z.clone();for(let A=0;A<F.length;A++){let I=F[A][0];0>I?(I+=D,K=Math.max(I,K)):(I-=D,J=Math.min(I,
J))}B.xmin=J;B.xmax=K;return B.width<p?(B.xmin-=D,B.xmax-=D,B):z};u.normalizeCentralMeridian=q;u.normalizeMapX=function(B,z){if(z=c.getInfo(z)){const [p,r]=z.valid;z=r-p;if(B<p)for(;B<p;)B+=z;if(B>r)for(;B>r;)B-=z}return B};u.straightLineDensify=e;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/normalizeUtilsCommon":function(){define(["exports","../Polyline","../SpatialReference","./jsonUtils"],function(u,t,H,C){function w(y){return C.isPolygon(y)?y.rings:y.paths}
t={102100:{maxX:2.0037508342788905E7,minX:-2.0037508342788905E7,plus180Line:new t({paths:[[[2.0037508342788905E7,-2.0037508342788905E7],[2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:H.WebMercator}),minus180Line:new t({paths:[[[-2.0037508342788905E7,-2.0037508342788905E7],[-2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:H.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new t({paths:[[[180,-180],[180,180]]],spatialReference:H.WGS84}),minus180Line:new t({paths:[[[-180,
-180],[-180,180]]],spatialReference:H.WGS84})}};u.cutParams=t;u.getGeometryParts=w;u.offsetMagnitude=function(y,x){return Math.ceil((y-x)/(2*x))};u.updatePolyGeometry=function(y,x){const m=w(y);for(const h of m)for(const c of h)c[0]+=x;return y};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/rest/geometryService/cut":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../geometry ../../request ../../geometry/support/jsonUtils ../utils".split(" "),function(u,
t,H,C,w,y){function x(){x=t._asyncToGenerator(function*(m,h,c,d){m=y.parseUrl(m);const f=h[0].spatialReference;h={...d,query:{...m.query,f:"json",sr:JSON.stringify(f),target:JSON.stringify({geometryType:w.getJsonType(h[0]),geometries:h}),cutter:JSON.stringify(c)}};h=yield C(m.path+"/cut",h);const {cutIndexes:k,geometries:g=[]}=h.data;return{cutIndexes:k,geometries:g.map(e=>{e=w.fromJSON(e);e.spatialReference=f;return e})}});return x.apply(this,arguments)}u.cut=function(m,h,c,d){return x.apply(this,
arguments)};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/rest/utils":function(){define("exports ../config ../kernel ../core/lang ../core/urlUtils ../support/apiKeyUtils".split(" "),function(u,t,H,C,w,y){function x(m,h,c){const d={};for(const k in m)if("declaredClass"!==k){var f=m[k];if(null!=f&&"function"!==typeof f)if(Array.isArray(f)){d[k]=[];for(let g=0;g<f.length;g++)d[k][g]=x(f[g])}else"object"===typeof f?f.toJSON?(f=f.toJSON(c&&c[k]),d[k]=h?f:JSON.stringify(f)):d[k]=
h?f:JSON.stringify(f):d[k]=f}return d}u.asValidOptions=function(m,h){return h?{...h,query:{...(m??{}),...h.query}}:{query:m}};u.encode=x;u.getToken=function(m,h){return y.supportsApiKey(m)&&(h||t.apiKey)?h||t.apiKey:H.id?.findCredential(m)?.token};u.parseUrl=function(m){return"string"===typeof m?w.urlToObject(m):C.clone(m)};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/rest/geometryService/simplify":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../request ../../core/urlUtils ../../geometry/support/jsonUtils ./utils".split(" "),
function(u,t,H,C,w,y){function x(){x=t._asyncToGenerator(function*(m,h,c){const d="string"===typeof m?C.urlToObject(m):m;m=h[0].spatialReference;const f=w.getJsonType(h[0]);h={...c,query:{...d.query,f:"json",sr:m.wkid?m.wkid:JSON.stringify(m),geometries:JSON.stringify(y.encodeGeometries(h))}};({data:h}=yield H(d.path+"/simplify",h));return y.decodeGeometries(h.geometries,f,m)});return x.apply(this,arguments)}u.simplify=function(m,h,c){return x.apply(this,arguments)};Object.defineProperty(u,Symbol.toStringTag,
{value:"Module"})})},"esri/rest/geometryService/utils":function(){define(["exports","../../geometry/support/jsonUtils"],function(u,t){u.decodeGeometries=function(H,C,w){const y=t.getGeometryType(C);return H.map(x=>{x=y.fromJSON(x);x.spatialReference=w;return x})};u.encodeGeometries=function(H){return{geometryType:t.getJsonType(H[0]),geometries:H.map(C=>C.toJSON())}};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/attributeSupport":function(){define(["exports",
"../../../core/Error","../../../core/sql/WhereClauseCache"],function(u,t,H){function C(h,c){return h?x.get(h,c):null}function w(h,c,d,f=!0){const k=[];for(const g of c)if("*"!==g&&!h.has(g))if(f){c=y(g);try{const e=C(c,h);if(!e)throw new t("feature-store:unsupported-query","invalid SQL expression",{where:c});if(!e.isStandardized)throw new t("feature-store:unsupported-query","expression is not standard",{clause:e});w(h,e.fieldNames,"expression contains missing fields")}catch(e){if((c=e&&e.details)&&
(c.clause||c.where))throw e;c&&c.missingFields?k.push(...c.missingFields):k.push(g)}}else k.push(g);if(k.length)throw new t("feature-store:unsupported-query",d,{missingFields:k});}function y(h){return h.split(" as ")[0]}const x=new H.WhereClauseCache(50,500),m=new Set("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeDate".split(" "));u.getAliasFromFieldName=function(h){return h.split(" as ")[1]};u.getExpressionFromFieldName=
y;u.getWhereClause=C;u.hasInvalidFieldType=function(h,c){return(h=c.get(h))?!m.has(h.type):!1};u.validateFields=w;u.validateHaving=function(h,c,d){if(!c)return!0;const f=x.get(c,h);if(!f)throw new t("feature-store:unsupported-query","invalid SQL expression",{having:c});if(!f.isAggregate)throw new t("feature-store:unsupported-query","having does not contain a valid aggregate function",{having:c});w(h,f.fieldNames,"having contains missing fields");if(!f.getExpressions().every(k=>{const {aggregateType:g,
field:e}=k,a=h.get(e)?.name;return d.some(b=>{const {onStatisticField:l,statisticType:q}=b;return h.get(l)?.name===a&&q.toLowerCase().trim()===g})}))throw new t("feature-store:unsupported-query","expressions in having should also exist in outStatistics",{having:c});return!0};u.validateWhere=function(h,c){if(!c)return!0;const d=x.get(c,h);if(!d)throw new t("feature-store:unsupported-query","invalid SQL expression",{where:c});if(!d.isStandardized)throw new t("feature-store:unsupported-query","where clause is not standard",
{where:c});w(h,d.fieldNames,"where clause contains missing fields");return!0};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereClauseCache":function(){define(["exports","../ItemCache","./WhereClause"],function(u,t,H){let C=function(){function w(y,x){this._cache=new t(y);this._invalidCache=new t(x)}w.prototype.get=function(y,x){const m=`${x.uid}:${y}`,h=this._cache.get(m);if(h)return h;if(void 0!==this._invalidCache.get(m))return null;try{const c=H.WhereClause.create(y,
x);this._cache.put(m,c);return c}catch{return this._invalidCache.put(m,null),null}};return w}();u.WhereClauseCache=C;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/core/ItemCache":function(){define(["./MemCache"],function(u){return function(){function t(C,w){this._storage=new u.MemCacheStorage;this._storage.maxSize=C;w&&this._storage.registerRemoveFunc("",w)}var H=t.prototype;H.put=function(C,w){this._storage.put(C,w,1,1)};H.pop=function(C){return this._storage.pop(C)};H.get=
function(C){return this._storage.get(C)};H.clear=function(){this._storage.clearAll()};H.destroy=function(){this._storage.destroy()};return t}()})},"esri/core/sql/WhereClause":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../has ./AggregateFunctions ./StandardizedFunctions ./WhereGrammar".split(" "),function(u,t,H,C,w,y){function x(I,G){I+="";return I.length>=G?I:Array(G-I.length+1).join("0")+I}function m(I,G,E="0",M="0",T="0",Y="0",fa="",ba="0",U="0"){return"+"===fa||"-"===fa?
(I=`${x(parseInt(I,10),4)}-${x(parseInt(G,10),2)}-${x(parseInt(E,10),2)}`,G="",10>parseFloat(Y)&&(G="0"),M=`${x(parseInt(M,10),2)}:${x(parseInt(T,10),2)}:${G+parseFloat(Y).toString()}`,fa=`${fa}${x(parseInt(ba,10),2)}:${x(parseInt(U,10),2)}`,new Date(I+"T"+M+fa)):new Date(parseInt(I,10),parseInt(G,10)-1,parseInt(E,10),parseInt(M,10),parseInt(T,10),parseFloat(Y))}function h(I){let G=B.exec(I);if(null!==G){const [,E,M,T,Y,fa,ba]=G;return m(E,M,T,Y,fa,ba)}G=z.exec(I);if(null!==G){const [,E,M,T,Y,fa,
ba,U,P,Q]=G;return m(E,M,T,Y,fa,ba,U,P,Q)}G=p.exec(I);if(null!==G){const [,E,M,T,Y,fa,ba,U,P]=G;return m(E,M,T,Y,fa,"0",ba,U,P)}G=r.exec(I);if(null!==G){const [,E,M,T,Y,fa]=G;return m(E,M,T,Y,fa)}G=v.exec(I);if(null!==G){const [,E,M,T]=G;return m(E,M,T)}throw Error("SQL Invalid Timestamp");}function c(I){const G=v.exec(I);if(null===G)try{return h(I)}catch{throw Error("SQL Invalid Date");}const [,E,M,T]=G;return new Date(parseInt(E,10),parseInt(M,10)-1,parseInt(T,10))}function d(I){return Array.isArray(I)?
I:[I]}function f(I){return null!==I?!0!==I:null}function k(I,G){return null!=I&&null!=G?!0===I&&!0===G:!1===I||!1===G?!1:null}function g(I,G){return null!=I&&null!=G?!0===I||!0===G:!0===I||!0===G?!0:null}function e(I,G){if(null==I)return null;let E=!1;for(const M of G)if(null==M)E=null;else if(I===M){E=!0;break}return E}function a(I,G,E){if(null==I)return null;let M="",T=F.Normal;for(let Y=0;Y<G.length;Y++){const fa=G.charAt(Y);switch(T){case F.Normal:fa===E?T=F.Escaped:M="-[]/{}()*+?.\\^$|".includes(fa)?
M+("\\"+fa):"%"===fa?M+".*":"_"===fa?M+".":M+fa;break;case F.Escaped:M="-[]/{}()*+?.\\^$|".includes(fa)?M+("\\"+fa):M+fa,T=F.Normal}}return(new RegExp("^"+M+"$","m")).test(I)}function b(I){return I instanceof Date?I.valueOf():I}function l(I,G,E){if(null==G||null==E)return null;G=b(G);E=b(E);switch(I){case "\x3c\x3e":return G!==E;case "\x3d":return G===E;case "\x3e":return G>E;case "\x3c":return G<E;case "\x3e\x3d":return G>=E;case "\x3c\x3d":return G<=E}}function q(I,G,E){if("||"===I)return w.evaluateFunction("concat",
[G,E]);if(G instanceof w.SqlInterval)if(E instanceof Date)switch(I){case "+":return new Date(G.valueInMilliseconds()+E.getTime());case "-":return G.valueInMilliseconds()-E.getTime();case "*":return G.valueInMilliseconds()*E.getTime();case "/":return G.valueInMilliseconds()/E.getTime()}else if(E instanceof w.SqlInterval)switch(I){case "+":return w.SqlInterval.createFromMilliseconds(G.valueInMilliseconds()+E.valueInMilliseconds());case "-":return w.SqlInterval.createFromMilliseconds(G.valueInMilliseconds()-
E.valueInMilliseconds());case "*":return G.valueInMilliseconds()*E.valueInMilliseconds();case "/":return G.valueInMilliseconds()/E.valueInMilliseconds()}else G=G.valueInMilliseconds();else if(E instanceof w.SqlInterval)if(G instanceof Date)switch(I){case "+":return new Date(E.valueInMilliseconds()+G.getTime());case "-":return new Date(G.getTime()-E.valueInMilliseconds());case "*":return G.getTime()*E.valueInMilliseconds();case "/":return G.getTime()/E.valueInMilliseconds()}else E=E.valueInMilliseconds();
else if(G instanceof Date&&"number"===typeof E)switch(E*=864E5,G=G.getTime(),I){case "+":return new Date(G+E);case "-":return new Date(G-E);case "*":return new Date(G*E);case "/":return new Date(G/E)}else if(E instanceof Date&&"number"===typeof G)switch(G*=864E5,E=E.getTime(),I){case "+":return new Date(G+E);case "-":return new Date(G-E);case "*":return new Date(G*E);case "/":return new Date(G/E)}switch(I){case "+":return G+E;case "-":return G-E;case "*":return G*E;case "/":return G/E}}function n(I,
G,E,M){I=M.getAttribute(I,G);return null!=I&&1===E[G]?new Date(I):I}const v=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,B=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,z=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,p=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,r=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/,D=new Set(["current_timestamp","current_date","current_time"]);let J=function(){function I(){}
I.makeBool=function(G){return!0===G};I.featureValue=function(G,E,M,T){return n(G,E,M,T)};I.equalsNull=function(G){return null===G};I.applyLike=function(G,E,M){return a(G,E,M)};I.ensureArray=function(G){return d(G)};I.applyIn=function(G,E){return e(G,E)};I.currentDate=function(){const G=new Date;G.setHours(0,0,0,0);return G};I.makeSqlInterval=function(G,E,M){return w.SqlInterval.createFromValueAndQualifer(G,E,M)};I.convertInterval=function(G){return G instanceof w.SqlInterval?G.valueInMilliseconds():
G};I.currentTimestamp=function(){return new Date};I.compare=function(G,E,M){return l(G,E,M)};I.calculate=function(G,E,M){return q(G,E,M)};I.makeComparable=function(G){return b(G)};I.evaluateFunction=function(G,E){return w.evaluateFunction(G,E)};I.lookup=function(G,E){G=E[G];return void 0===G?null:G};I.between=function(G,E){return null==G||null==E[0]||null==E[1]?null:G>=E[0]&&G<=E[1]};I.notbetween=function(G,E){return null==G||null==E[0]||null==E[1]?null:G<E[0]||G>E[1]};I.ternaryNot=function(G){return f(G)};
I.ternaryAnd=function(G,E){return k(G,E)};I.ternaryOr=function(G,E){return g(G,E)};return I}(),K=function(){function I(E,M){this.fieldsIndex=M;this._datefields={};this.parameters={};this._hasDateFunctions=void 0;this.parseTree=y.WhereGrammar.parse(E);const {isStandardized:T,isAggregate:Y,referencedFieldNames:fa}=this._extractExpressionInfo(M);this._referencedFieldNames=fa;this.isStandardized=T;this.isAggregate=Y}I.create=function(E,M){return new I(E,M)};var G=I.prototype;G.testSet=function(E,M=A){const T=
{};for(const Y of this.fieldNames)T[Y]=E.map(fa=>M.getAttribute(fa,Y));return!!this._evaluateNode(this.parseTree,{attributes:T},A)};G.calculateValue=function(E,M=A){E=this._evaluateNode(this.parseTree,E,M);return E instanceof w.SqlInterval?E.valueInMilliseconds()/864E5:E};G.calculateValueCompiled=function(E,M=A){if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(E,this.parameters,M,this._datefields);if(H("esri-csp-restrictions"))return this.calculateValue(E,M);this._compileMe();
return this.parseTree._compiledVersion(E,this.parameters,M,this._datefields)};G.testFeature=function(E,M=A){return!!this._evaluateNode(this.parseTree,E,M)};G.testFeatureCompiled=function(E,M=A){if(null!=this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(E,this.parameters,M,this._datefields);if(H("esri-csp-restrictions"))return this.testFeature(E,M);this._compileMe();return!!this.parseTree._compiledVersion(E,this.parameters,M,this._datefields)};G.getFunctions=function(){const E=
new Set;this._visitAll(this.parseTree,M=>{"function"===M.type&&E.add(M.name.toLowerCase())});return Array.from(E)};G.getExpressions=function(){const E=new Map;this._visitAll(this.parseTree,M=>{if("function"===M.type){const T=M.name.toLowerCase();M=M.args.value[0];if("column-reference"===M.type){M=M.column;const Y=`${T}-${M}`;E.has(Y)||E.set(Y,{aggregateType:T,field:M})}}});return[...E.values()]};G.getVariables=function(){const E=new Set;this._visitAll(this.parseTree,M=>{"parameter"===M.type&&E.add(M.value.toLowerCase())});
return Array.from(E)};G._compileMe=function(){const E="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter","datefields",E)).bind(J)};G._extractExpressionInfo=function(E){const M=[],T=new Set;let Y=!0,fa=!0;this._visitAll(this.parseTree,ba=>{switch(ba.type){case "column-reference":const U=E?.get(ba.column);let P,Q;U?P=Q=U.name??"":(Q=ba.column,P=Q.toLowerCase());U&&U.name&&("date"===U.type||
"esriFieldTypeDate"===U.type)&&(this._datefields[U.name]=1);T.has(P)||(T.add(P),M.push(Q));ba.column=Q;break;case "function":const {name:Z,args:X}=ba;ba=X.value.length;Y&&(Y=w.isStandardized(Z,ba));fa&&(fa=C.isAggregate(Z,ba))}});return{referencedFieldNames:Array.from(M),isStandardized:Y,isAggregate:fa}};G._visitAll=function(E,M){if(null!=E)switch(M(E),E.type){case "when-clause":this._visitAll(E.operand,M);this._visitAll(E.value,M);break;case "case-expression":for(const T of E.clauses)this._visitAll(T,
M);"simple"===E.format&&this._visitAll(E.operand,M);null!==E.else&&this._visitAll(E.else,M);break;case "expression-list":for(const T of E.value)this._visitAll(T,M);break;case "unary-expression":this._visitAll(E.expr,M);break;case "binary-expression":this._visitAll(E.left,M);this._visitAll(E.right,M);break;case "function":this._visitAll(E.args,M)}};G.evaluateNodeToJavaScript=function(E){switch(E.type){case "interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(E.value)+", "+JSON.stringify(E.qualifier)+
","+JSON.stringify(E.op)+")";case "case-expression":var M="";if("simple"===E.format){var T="this.makeComparable("+this.evaluateNodeToJavaScript(E.operand)+")";M="( ";for(let Y=0;Y<E.clauses.length;Y++)M+=" ("+T+" \x3d\x3d\x3d this.makeComparable("+this.evaluateNodeToJavaScript(E.clauses[Y].operand)+")) ? ("+this.evaluateNodeToJavaScript(E.clauses[Y].value)+") : "}else for(M="( ",T=0;T<E.clauses.length;T++)M+=" this.makeBool("+this.evaluateNodeToJavaScript(E.clauses[T].operand)+")\x3d\x3d\x3dtrue ? ("+
this.evaluateNodeToJavaScript(E.clauses[T].value)+") : ";M=null!==E.else?M+this.evaluateNodeToJavaScript(E.else):M+"null";return M+" )";case "parameter":return"this.lookup("+JSON.stringify(E.value.toLowerCase())+",lookups)";case "expression-list":M="[";for(T of E.value)"["!==M&&(M+=","),M+=this.evaluateNodeToJavaScript(T);return M+"]";case "unary-expression":return"this.ternaryNot("+this.evaluateNodeToJavaScript(E.expr)+")";case "binary-expression":switch(E.operator){case "AND":return"this.ternaryAnd("+
this.evaluateNodeToJavaScript(E.left)+","+this.evaluateNodeToJavaScript(E.right)+" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(E.left)+","+this.evaluateNodeToJavaScript(E.right)+" )";case "IS":if("null"!==E.right.type)throw Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(E.left)+")";case "ISNOT":if("null"!==E.right.type)throw Error("Unsupported RHS for IS");return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(E.left)+")))";case "IN":return"this.applyIn("+
this.evaluateNodeToJavaScript(E.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(E.right)+"))";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(E.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(E.right)+")))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(E.left)+","+this.evaluateNodeToJavaScript(E.right)+")";case "NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(E.left)+","+this.evaluateNodeToJavaScript(E.right)+
")";case "LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(E.left)+","+this.evaluateNodeToJavaScript(E.right)+","+JSON.stringify(E.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(E.left)+","+this.evaluateNodeToJavaScript(E.right)+","+JSON.stringify(E.escape)+"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+JSON.stringify(E.operator)+","+this.evaluateNodeToJavaScript(E.left)+","+
this.evaluateNodeToJavaScript(E.right)+")";case "*":case "-":case "+":case "/":case "||":return"this.calculate("+JSON.stringify(E.operator)+","+this.evaluateNodeToJavaScript(E.left)+","+this.evaluateNodeToJavaScript(E.right)+")"}throw Error("Not Supported Operator "+E.operator);case "null":case "boolean":case "string":case "number":return JSON.stringify(E.value);case "date":return"(new Date("+c(E.value).getTime().toString()+"))";case "timestamp":return"(new Date("+h(E.value).getTime().toString()+
"))";case "current-time":return"date"===E.mode?"this.currentDate()":"this.currentTimestamp()";case "column-reference":return"this.featureValue(feature,"+JSON.stringify(E.column)+",datefields,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(E.name)+","+this.evaluateNodeToJavaScript(E.args)+")"}throw Error("Unsupported sql syntax "+E.type);};G._evaluateNode=function(E,M,T){switch(E.type){case "interval":return M=this._evaluateNode(E.value,M,T),w.SqlInterval.createFromValueAndQualifer(M,
E.qualifier,E.op);case "case-expression":if("simple"===E.format){var Y=b(this._evaluateNode(E.operand,M,T));for(var fa=0;fa<E.clauses.length;fa++)if(Y===b(this._evaluateNode(E.clauses[fa].operand,M,T)))return this._evaluateNode(E.clauses[fa].value,M,T)}else for(Y=0;Y<E.clauses.length;Y++)if(!0===this._evaluateNode(E.clauses[Y].operand,M,T))return this._evaluateNode(E.clauses[Y].value,M,T);return null!==E.else?this._evaluateNode(E.else,M,T):null;case "parameter":return this.parameters[E.value.toLowerCase()];
case "expression-list":Y=[];for(fa of E.value)Y.push(this._evaluateNode(fa,M,T));return Y;case "unary-expression":return f(this._evaluateNode(E.expr,M,T));case "binary-expression":switch(E.operator){case "AND":return k(this._evaluateNode(E.left,M,T),this._evaluateNode(E.right,M,T));case "OR":return g(this._evaluateNode(E.left,M,T),this._evaluateNode(E.right,M,T));case "IS":if("null"!==E.right.type)throw Error("Unsupported RHS for IS");return null===this._evaluateNode(E.left,M,T);case "ISNOT":if("null"!==
E.right.type)throw Error("Unsupported RHS for IS");return null!==this._evaluateNode(E.left,M,T);case "IN":return Y=d(this._evaluateNode(E.right,M,T)),e(this._evaluateNode(E.left,M,T),Y);case "NOT IN":return Y=d(this._evaluateNode(E.right,M,T)),f(e(this._evaluateNode(E.left,M,T),Y));case "BETWEEN":return Y=this._evaluateNode(E.left,M,T),E=this._evaluateNode(E.right,M,T),null==Y||null==E[0]||null==E[1]?null:Y>=b(E[0])&&Y<=b(E[1]);case "NOTBETWEEN":return Y=this._evaluateNode(E.left,M,T),E=this._evaluateNode(E.right,
M,T),null==Y||null==E[0]||null==E[1]?null:Y<b(E[0])||Y>b(E[1]);case "LIKE":return a(this._evaluateNode(E.left,M,T),this._evaluateNode(E.right,M,T),E.escape);case "NOT LIKE":return f(a(this._evaluateNode(E.left,M,T),this._evaluateNode(E.right,M,T),E.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return l(E.operator,this._evaluateNode(E.left,M,T),this._evaluateNode(E.right,M,T));case "-":case "+":case "*":case "/":case "||":return q(E.operator,this._evaluateNode(E.left,
M,T),this._evaluateNode(E.right,M,T))}case "null":case "boolean":case "string":case "number":return E.value;case "date":return c(E.value);case "timestamp":return h(E.value);case "current-time":return M=new Date,"date"===E.mode&&M.setHours(0,0,0,0),M;case "column-reference":return n(M,E.column,this._datefields,T);case "data-type":return E.value;case "function":return M=this._evaluateNode(E.args,M,T),this.isAggregate?C.aggregateFunction(E.name,M):w.evaluateFunction(E.name,M)}throw Error("Unsupported sql syntax "+
E.type);};t._createClass(I,[{key:"fieldNames",get:function(){return this._referencedFieldNames}},{key:"hasDateFunctions",get:function(){if(null!=this._hasDateFunctions)return this._hasDateFunctions;this._hasDateFunctions=!1;this._visitAll(this.parseTree,E=>{"current-time"===E.type?this._hasDateFunctions=!0:"function"===E.type&&(this._hasDateFunctions=this._hasDateFunctions||D.has(E.name.toLowerCase()))});return this._hasDateFunctions}}]);return I}();var F;(function(I){I[I.Normal=0]="Normal";I[I.Escaped=
1]="Escaped"})(F||(F={}));const A={getAttribute(I,G){return(I&&"object"===typeof I.attributes?I.attributes:I)[G]}};u.WhereClause=K;u.defaultAttributeAdapter=A;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/AggregateFunctions":function(){define(["exports"],function(u){function t(w){let y=0;for(let x=0;x<w.length;x++)y+=w[x];return y/w.length}function H(w){const y=t(w),x=w.length;let m=0;for(const h of w)m+=(h-y)**2;return 1<x?m/(x-1):0}const C={min:{minParams:1,maxParams:1,
evaluate:w=>null==w[0]?null:Math.min.apply(Math,w[0])},max:{minParams:1,maxParams:1,evaluate:w=>null==w[0]?null:Math.max.apply(Math,w[0])},avg:{minParams:1,maxParams:1,evaluate:w=>null==w[0]?null:t(w[0])},sum:{minParams:1,maxParams:1,evaluate:w=>{if(null==w[0])w=null;else{w=w[0];let y=0;for(let x=0;x<w.length;x++)y+=w[x];w=y}return w}},stddev:{minParams:1,maxParams:1,evaluate:w=>null==w[0]?null:Math.sqrt(H(w[0]))},count:{minParams:1,maxParams:1,evaluate:w=>null==w[0]?null:w[0].length},var:{minParams:1,
maxParams:1,evaluate:w=>null==w[0]?null:H(w[0])}};u.aggregateFunction=function(w,y){const x=C[w.toLowerCase()];if(null==x)throw Error("Function Not Recognised");if(y.length<x.minParams||y.length>x.maxParams)throw Error(`Invalid Parameter count for call to ${w.toUpperCase()}`);return x.evaluate(y)};u.isAggregate=function(w,y){w=C[w.toLowerCase()];return null!=w&&y>=w.minParams&&y<=w.maxParams};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/StandardizedFunctions":function(){define(["exports",
"../../arcade/featureset/support/errorsupport","../string","../../chunks/datetime"],function(u,t,H,C){function w(h){h=new Date(h.getTime());h.setHours(0,0,0,0);return h}function y(h,c){if(h instanceof Date)return c?w(h):h;if("string"===typeof h||h instanceof String)if(h=C.DateTime.fromSQL(h),h.isValid)return c?w(h.toJSDate()):h.toJSDate();throw new t.SqlError(t.SqlErrorCodes.CannotCastValue);}let x=function(){function h(){this.op="+";this.millis=this.minute=this.year=this.month=this.hour=this.second=
this.day=0}h._fixDefaults=function(c){if(null!==c.precision||null!==c.secondary)throw Error("Primary and Secondary SqlInterval qualifiers not supported");};h._parseSecondsComponent=function(c,d){d.includes(".")?(d=d.split("."),c.second=parseFloat(d[0]),c.millis=parseInt(d[1],10)):c.second=parseFloat(d)};h.createFromMilliseconds=function(c){const d=new h;d.second=c/1E3;return d};h.createFromValueAndQualifer=function(c,d,f){let k=null;const g=new h;g.op="-"===f?"-":"+";if("interval-period"===d.type){h._fixDefaults(d);
f=RegExp("^[0-9]{1,}$");if("year"===d.period||"month"===d.period)throw Error("Year-Month Intervals not supported");if("second"===d.period)if(/^[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/.test(c))h._parseSecondsComponent(g,c);else throw Error("Illegal Interval");else if(f.test(c))g[d.period]=parseFloat(c);else throw Error("Illegal Interval");}else{h._fixDefaults(d.start);h._fixDefaults(d.end);if("year"===d.start.period||"month"===d.start.period)throw Error("Year-Month Intervals not supported");if("year"===d.end.period||
"month"===d.end.period)throw Error("Year-Month Intervals not supported");switch(d.start.period){case "day":switch(d.end.period){case "hour":k=RegExp("^[0-9]{1,} [0-9]{1,}$");if(k.test(c))g[d.start.period]=parseFloat(c.split(" ")[0]),g[d.end.period]=parseFloat(c.split(" ")[1]);else throw Error("Illegal Interval");break;case "minute":k=RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$");if(k.test(c))g[d.start.period]=parseFloat(c.split(" ")[0]),c=c.split(" ")[1].split(":"),g.hour=parseFloat(c[0]),g.minute=parseFloat(c[1]);
else throw Error("Illegal Interval");break;case "second":k=RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(k.test(c))g[d.start.period]=parseFloat(c.split(" ")[0]),c=c.split(" ")[1].split(":"),g.hour=parseFloat(c[0]),g.minute=parseFloat(c[1]),h._parseSecondsComponent(g,c[2]);else throw Error("Illegal Interval");break;default:throw Error("Invalid Interval.");}break;case "hour":switch(d.end.period){case "minute":k=RegExp("^[0-9]{1,}:[0-9]{1,}$");if(k.test(c))g.hour=parseFloat(c.split(":")[0]),
g.minute=parseFloat(c.split(":")[1]);else throw Error("Illegal Interval");break;case "second":k=RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(k.test(c))c=c.split(":"),g.hour=parseFloat(c[0]),g.minute=parseFloat(c[1]),h._parseSecondsComponent(g,c[2]);else throw Error("Illegal Interval");break;default:throw Error("Invalid Interval.");}break;case "minute":switch(d.end.period){case "second":k=RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(k.test(c))c=c.split(":"),g.minute=
parseFloat(c[0]),h._parseSecondsComponent(g,c[1]);else throw Error("Illegal Interval");break;default:throw Error("Invalid Interval.");}break;default:throw Error("Invalid Interval.");}}return g};h.prototype.valueInMilliseconds=function(){return("-"===this.op?-1:1)*(this.millis+1E3*this.second+6E4*this.minute+36E5*this.hour+864E5*this.day+365/12*this.month*864E5+31536E6*this.year)};return h}();const m={extract:{minParams:2,maxParams:2,evaluate:([h,c])=>{if(null==c)return null;if(c instanceof Date)switch(h.toUpperCase()){case "SECOND":return c.getSeconds();
case "MINUTE":return c.getMinutes();case "HOUR":return c.getHours();case "DAY":return c.getDate();case "MONTH":return c.getMonth()+1;case "YEAR":return c.getFullYear()}throw Error("Invalid Parameter for call to EXTRACT");}},substring:{minParams:2,maxParams:3,evaluate:h=>{if(2===h.length){const [c,d]=h;return null==c||null==d?null:c.toString().substring(d-1)}if(3===h.length){const [c,d,f]=h;return null==c||null==d||null==f?null:0>=f?"":c.toString().substring(d-1,d+f-1)}}},position:{minParams:2,maxParams:2,
evaluate:([h,c])=>null==h||null==c?null:c.indexOf(h)+1},trim:{minParams:2,maxParams:3,evaluate:h=>{var c=3===h.length,d=c?h[1]:" ";c=c?h[2]:h[1];if(null==d||null==c)return null;d=`(${H.escapeRegExpString(d)})`;switch(h[0]){case "BOTH":return c.replace(new RegExp(`^${d}*|${d}*$`,"g"),"");case "LEADING":return c.replace(new RegExp(`^${d}*`,"g"),"");case "TRAILING":return c.replace(new RegExp(`${d}*$`,"g"),"")}throw Error("Invalid Parameter for call to TRIM");}},abs:{minParams:1,maxParams:1,evaluate:h=>
null==h[0]?null:Math.abs(h[0])},ceiling:{minParams:1,maxParams:1,evaluate:h=>null==h[0]?null:Math.ceil(h[0])},floor:{minParams:1,maxParams:1,evaluate:h=>null==h[0]?null:Math.floor(h[0])},log:{minParams:1,maxParams:1,evaluate:h=>null==h[0]?null:Math.log(h[0])},log10:{minParams:1,maxParams:1,evaluate:h=>null==h[0]?null:Math.log(h[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:h=>null==h[0]?null:Math.sin(h[0])},cos:{minParams:1,maxParams:1,evaluate:h=>null==h[0]?null:Math.cos(h[0])},tan:{minParams:1,
maxParams:1,evaluate:h=>null==h[0]?null:Math.tan(h[0])},asin:{minParams:1,maxParams:1,evaluate:h=>null==h[0]?null:Math.asin(h[0])},acos:{minParams:1,maxParams:1,evaluate:h=>null==h[0]?null:Math.acos(h[0])},atan:{minParams:1,maxParams:1,evaluate:h=>null==h[0]?null:Math.atan(h[0])},sign:{minParams:1,maxParams:1,evaluate:h=>null==h[0]?null:0<h[0]?1:0>h[1]?-1:0},power:{minParams:2,maxParams:2,evaluate:h=>null==h[0]||null==h[1]?null:h[0]**h[1]},mod:{minParams:2,maxParams:2,evaluate:h=>null==h[0]||null==
h[1]?null:h[0]%h[1]},round:{minParams:1,maxParams:2,evaluate:h=>{const c=h[0];h=2===h.length?10**h[1]:1;return null==c?null:Math.round(c*h)/h}},truncate:{minParams:1,maxParams:2,evaluate:h=>null==h[0]?null:1===h.length?parseInt(h[0].toFixed(0),10):parseFloat(h[0].toFixed(h[1]))},char_length:{minParams:1,maxParams:1,evaluate:h=>"string"===typeof h[0]||h[0]instanceof String?h[0].length:0},concat:{minParams:1,maxParams:Infinity,evaluate:h=>{let c="";for(let d=0;d<h.length;d++){if(null==h[d])return null;
c+=h[d].toString()}return c}},lower:{minParams:1,maxParams:1,evaluate:h=>null==h[0]?null:h[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:h=>null==h[0]?null:h[0].toString().toUpperCase()},coalesce:{minParams:1,maxParams:Infinity,evaluate:h=>{for(const c of h)if(null!==c)return c;return null}},cosh:{minParams:1,maxParams:1,evaluate:h=>null==h[0]?null:Math.cosh(h[0])},sinh:{minParams:1,maxParams:1,evaluate:h=>null==h[0]?null:Math.sinh(h[0])},tanh:{minParams:1,maxParams:1,evaluate:h=>
null==h[0]?null:Math.tanh(h[0])},nullif:{minParams:2,maxParams:2,evaluate:h=>{const c=h[0];h=h[1];return(c instanceof Date?c.valueOf():c)===(h instanceof Date?h.valueOf():h)?null:c}},cast:{minParams:2,maxParams:2,evaluate:h=>{var c=h[0];h=h[1];if(null===c)return null;switch(h.type){case "integer":c=parseInt(c,10);if(isNaN(c))throw new t.SqlError(t.SqlErrorCodes.CannotCastValue);return c;case "smallint":c=parseInt(c,10);if(isNaN(c))throw new t.SqlError(t.SqlErrorCodes.CannotCastValue);if(32767<c||
-32767>c)throw new t.SqlError(t.SqlErrorCodes.CannotCastValue);return c;case "float":case "real":c=parseFloat(c);if(isNaN(c))throw new t.SqlError(t.SqlErrorCodes.CannotCastValue);return c;case "date":return y(c,!0);case "timestamp":return y(c,!1);case "varchar":c=c.toString();if(c.length>h.size)throw new t.SqlError(t.SqlErrorCodes.CannotCastValue);return c;default:throw new t.SqlError(t.SqlErrorCodes.InvalidDataType);}}}};u.SqlInterval=x;u.evaluateFunction=function(h,c){const d=m[h.toLowerCase()];
if(null==d)throw Error("Function Not Recognised");if(c.length<d.minParams||c.length>d.maxParams)throw Error(`Invalid Parameter count for call to ${h.toUpperCase()}`);return d.evaluate(c)};u.isStandardized=function(h,c){h=m[h.toLowerCase()];return null!=h&&c>=h.minParams&&c<=h.maxParams};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/featureset/support/errorsupport":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../executionError"],function(u,
t,H){u.SqlErrorCodes=void 0;(function(m){m.InvalidFunctionParameters="InvalidFunctionParameters";m.UnsupportedSqlFunction="UnsupportedSqlFunction";m.UnsupportedOperator="UnsupportedOperator";m.UnsupportedSyntax="UnsupportedSyntax";m.UnsupportedIsRhs="UnsupportedIsRhs";m.UnsupportedIsLhs="UnsupportedIsLhs";m.InvalidDataType="InvalidDataType";m.CannotCastValue="CannotCastValue";m.MissingStatisticParameters="MissingStatisticParameters"})(u.SqlErrorCodes||(u.SqlErrorCodes={}));const C={[u.SqlErrorCodes.MissingStatisticParameters]:"Statistic does not have 1 or 0 Parameters",
[u.SqlErrorCodes.InvalidFunctionParameters]:"Invalid parameters for call to {function}",[u.SqlErrorCodes.UnsupportedIsLhs]:"Unsupported left hand expression in is statement",[u.SqlErrorCodes.UnsupportedIsRhs]:"Unsupported right hand expression in is statement",[u.SqlErrorCodes.UnsupportedOperator]:"Unsupported operator - {operator}",[u.SqlErrorCodes.UnsupportedSyntax]:"Unsupported syntax - {node}",[u.SqlErrorCodes.UnsupportedSqlFunction]:"Sql function not found \x3d {function}",[u.SqlErrorCodes.InvalidDataType]:"Invalid sql data type",
[u.SqlErrorCodes.CannotCastValue]:"Cannot cast value to the required data type"};let w=function(m){function h(c,d){c=m.call(this,H.doSubstitutions(C[c],d))||this;c.declaredRootClass="esri.arcade.featureset.support.sqlerror";Error.captureStackTrace&&Error.captureStackTrace(t._assertThisInitialized(c),h);return c}t._inheritsLoose(h,m);return h}(t._wrapNativeSuper(Error));u.FeatureSetErrorCodes=void 0;(function(m){m.NeverReach="NeverReach";m.NotImplemented="NotImplemented";m.Cancelled="Cancelled";m.InvalidStatResponse=
"InvalidStatResponse";m.InvalidRequest="InvalidRequest";m.RequestFailed="RequestFailed";m.MissingFeatures="MissingFeatures";m.AggregationFieldNotFound="AggregationFieldNotFound";m.DataElementsNotFound="DataElementsNotFound"})(u.FeatureSetErrorCodes||(u.FeatureSetErrorCodes={}));const y={[u.FeatureSetErrorCodes.Cancelled]:"Cancelled",[u.FeatureSetErrorCodes.InvalidStatResponse]:"Invalid statistics response from service",[u.FeatureSetErrorCodes.InvalidRequest]:"Invalid request",[u.FeatureSetErrorCodes.RequestFailed]:"Request failed - {reason}",
[u.FeatureSetErrorCodes.MissingFeatures]:"Missing features",[u.FeatureSetErrorCodes.AggregationFieldNotFound]:"Aggregation field not found",[u.FeatureSetErrorCodes.DataElementsNotFound]:"Data elements not found on service",[u.FeatureSetErrorCodes.NeverReach]:"Encountered unreachable logic",[u.FeatureSetErrorCodes.NotImplemented]:"Not implemented"};let x=function(m){function h(c,d){c=m.call(this,H.doSubstitutions(y[c],d))||this;c.declaredRootClass="esri.arcade.featureset.support.featureseterror";Error.captureStackTrace&&
Error.captureStackTrace(t._assertThisInitialized(c),h);return c}t._inheritsLoose(h,m);return h}(t._wrapNativeSuper(Error));u.FeatureSetError=x;u.FeatureSetErrorMessages=y;u.SqlError=w;u.SqlErrorMessages=C;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/executionError":function(){define(["exports","../chunks/_rollupPluginBabelHelpers"],function(u,t){function H(k){return k&&k.loc?`Line : ${k.loc.start?.line}, ${k.loc.start?.column}: `:""}function C(k,g){try{if(!g)return k;
for(const e in g){let a=g[e];a||(a="");k=k.replace("{"+e+"}",g[e])}}catch(e){}return k}u.ExecutionErrorCodes=void 0;(function(k){k.AsyncNotEnabled="AsyncNotEnabled";k.ModulesNotSupported="ModulesNotSupported";k.CircularModules="CircularModules";k.NeverReach="NeverReach";k.UnsupportedHashType="UnsupportedHashType";k.InvalidParameter="InvalidParameter";k.UnexpectedToken="UnexpectedToken";k.Unrecognised="Unrecognised";k.UnrecognisedType="UnrecognisedType";k.MaximumCallDepth="MaximumCallDepth";k.BooleanConditionRequired=
"BooleanConditionRequired";k.TypeNotAllowedInFeature="TypeNotAllowedInFeature";k.KeyMustBeString="KeyMustBeString";k.WrongNumberOfParameters="WrongNumberOfParameters";k.CallNonFunction="CallNonFunction";k.NoFunctionInTemplateLiteral="NoFunctionInTemplateLiteral";k.NoFunctionInDictionary="NoFunctionInDictionary";k.NoFunctionInArray="NoFunctionInArray";k.AssignModuleFunction="AssignModuleFunction";k.LogicExpressionOrAnd="LogicExpressionOrAnd";k.LogicalExpressionOnlyBoolean="LogicalExpressionOnlyBoolean";
k.FuncionNotFound="FunctionNotFound";k.InvalidMemberAccessKey="InvalidMemberAccessKey";k.UnsupportedUnaryOperator="UnsupportUnaryOperator";k.InvalidIdentifier="InvalidIdentifier";k.MemberOfNull="MemberOfNull";k.UnsupportedOperator="UnsupportedOperator";k.Cancelled="Cancelled";k.ModuleAccessorMustBeString="ModuleAccessorMustBeString";k.ModuleExportNotFound="ModuleExportNotFound";k.Immutable="Immutable";k.OutOfBounds="OutOfBounds";k.IllegalResult="IllegalResult";k.FieldNotFound="FieldNotFound";k.PortalRequired=
"PortalRequired";k.LogicError="LogicError";k.ArrayAccessorMustBeNumber="ArrayAccessMustBeNumber";k.KeyAccessorMustBeString="KeyAccessorMustBeString";k.WrongSpatialReference="WrongSpatialReference"})(u.ExecutionErrorCodes||(u.ExecutionErrorCodes={}));const w={[u.ExecutionErrorCodes.TypeNotAllowedInFeature]:"Feature attributes only support dates, numbers, strings, guids.",[u.ExecutionErrorCodes.LogicError]:"Logic error - {reason}",[u.ExecutionErrorCodes.NeverReach]:"Encountered unreachable logic",[u.ExecutionErrorCodes.AsyncNotEnabled]:"Async Arcade must be enabled for this script",
[u.ExecutionErrorCodes.ModuleAccessorMustBeString]:"Module accessor must be a string",[u.ExecutionErrorCodes.ModuleExportNotFound]:"Module has no export with provided identifier",[u.ExecutionErrorCodes.ModulesNotSupported]:"Current profile does not support modules",[u.ExecutionErrorCodes.ArrayAccessorMustBeNumber]:"Array accessor must be a number",[u.ExecutionErrorCodes.FuncionNotFound]:"Function not found",[u.ExecutionErrorCodes.FieldNotFound]:"Key not found - {key}",[u.ExecutionErrorCodes.CircularModules]:"Circular module dependencies are not allowed",
[u.ExecutionErrorCodes.Cancelled]:"Execution cancelled",[u.ExecutionErrorCodes.UnsupportedHashType]:"Type not supported in hash function",[u.ExecutionErrorCodes.IllegalResult]:"Value is not a supported return type",[u.ExecutionErrorCodes.PortalRequired]:"Portal is required",[u.ExecutionErrorCodes.InvalidParameter]:"Invalid parameter",[u.ExecutionErrorCodes.WrongNumberOfParameters]:"Call with wrong number of parameters",[u.ExecutionErrorCodes.Unrecognised]:"Unrecognised code structure",[u.ExecutionErrorCodes.UnrecognisedType]:"Unrecognised type",
[u.ExecutionErrorCodes.WrongSpatialReference]:"Cannot work with geometry in this spatial reference. It is different to the execution spatial reference",[u.ExecutionErrorCodes.BooleanConditionRequired]:"Conditions must use booleans",[u.ExecutionErrorCodes.NoFunctionInDictionary]:"Dictionaries cannot contain functions.",[u.ExecutionErrorCodes.NoFunctionInArray]:"Arrays cannot contain functions.",[u.ExecutionErrorCodes.NoFunctionInTemplateLiteral]:"Template Literals do not expect functions by value.",
[u.ExecutionErrorCodes.KeyAccessorMustBeString]:"Accessor must be a string",[u.ExecutionErrorCodes.KeyMustBeString]:"Object keys must be a string",[u.ExecutionErrorCodes.Immutable]:"Object is immutable",[u.ExecutionErrorCodes.InvalidParameter]:"Invalid parameter",[u.ExecutionErrorCodes.UnexpectedToken]:"Unexpected token",[u.ExecutionErrorCodes.MemberOfNull]:"Cannot access property of null object",[u.ExecutionErrorCodes.MaximumCallDepth]:"Exceeded maximum function depth",[u.ExecutionErrorCodes.OutOfBounds]:"Out of bounds",
[u.ExecutionErrorCodes.InvalidIdentifier]:"Identifier not recognised",[u.ExecutionErrorCodes.FuncionNotFound]:"Function not found",[u.ExecutionErrorCodes.CallNonFunction]:"Expression is not a function",[u.ExecutionErrorCodes.InvalidMemberAccessKey]:"Cannot access value using a key of this type",[u.ExecutionErrorCodes.AssignModuleFunction]:"Cannot assign function to module variable",[u.ExecutionErrorCodes.UnsupportedUnaryOperator]:"Unsupported unary operator",[u.ExecutionErrorCodes.UnsupportedOperator]:"Unsupported operator",
[u.ExecutionErrorCodes.LogicalExpressionOnlyBoolean]:"Logical expressions must be boolean",[u.ExecutionErrorCodes.LogicExpressionOrAnd]:"Logical expression can only be combined with || or \x26\x26"};let y=function(k){function g(...e){return k.call(this,...e)||this}t._inheritsLoose(g,k);return g}(t._wrapNativeSuper(Error)),x=function(k){function g(e,a){e=k.call(this,H(a)+e.message,{cause:e})||this;e.loc=null;Error.captureStackTrace&&Error.captureStackTrace(t._assertThisInitialized(e),g);a&&a.loc&&
(e.loc=a.loc);return e}t._inheritsLoose(g,k);return g}(y),m=function(k){function g(e,a,b,l){e=k.call(this,"Execution error - "+H(b)+C(w[a],l))||this;e.loc=null;e.declaredRootClass="esri.arcade.arcadeexecutionerror";Error.captureStackTrace&&Error.captureStackTrace(t._assertThisInitialized(e),g);b&&b.loc&&(e.loc=b.loc);return e}t._inheritsLoose(g,k);return g}(t._wrapNativeSuper(Error)),h=function(k){function g(e,a,b,l){e=k.call(this,"Compilation error - "+H(b)+C(w[a],l))||this;e.loc=null;e.declaredRootClass=
"esri.arcade.arcadecompilationerror";Error.captureStackTrace&&Error.captureStackTrace(t._assertThisInitialized(e),g);b&&b.loc&&(e.loc=b.loc);return e}t._inheritsLoose(g,k);return g}(t._wrapNativeSuper(Error)),c=function(k){function g(){var e=k.call(this,"Uncompilable code structures")||this;e.declaredRootClass="esri.arcade.arcadeuncompilableerror";Error.captureStackTrace&&Error.captureStackTrace(t._assertThisInitialized(e),g);return e}t._inheritsLoose(g,k);return g}(t._wrapNativeSuper(Error));u.ModuleErrorCodes=
void 0;(function(k){k.UnrecognisedUri="UnrecognisedUri";k.UnsupportedUriProtocol="UnsupportedUriProtocol"})(u.ModuleErrorCodes||(u.ModuleErrorCodes={}));const d={[u.ModuleErrorCodes.UnrecognisedUri]:"Unrecognised uri - {uri}",[u.ModuleErrorCodes.UnsupportedUriProtocol]:"Unrecognised uri protocol"};let f=function(k){function g(e,a){e=k.call(this,C(d[e],a))||this;e.declaredRootClass="esri.arcade.arcademoduleerror";Error.captureStackTrace&&Error.captureStackTrace(t._assertThisInitialized(e),g);return e}
t._inheritsLoose(g,k);return g}(t._wrapNativeSuper(Error));u.ArcadeCompilationError=h;u.ArcadeExecutionError=m;u.ArcadeUncompilableError=c;u.ErrorWithCause=y;u.ExecutionErrorMessages=w;u.LocatableArcadeExecutionError=x;u.ModuleError=f;u.ModuleErrorMessages=d;u.doSubstitutions=C;u.ensureArcadeExecutionError=function(k,g,e){return"esri.arcade.arcadeexecutionerror"===e.declaredRootClass||"esri.arcade.arcadecompilationerror"===e.declaredRootClass?null===e.loc&&g&&g.loc?new x(e,{cause:e}):e:g&&g.loc?new x(e,
{cause:e}):e};u.parsingValidationMessage=function(k,g,e){return"Parsing error - "+H(k)+C(w[g],e)};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/datetime":function(){define(["exports"],function(u){function t(L,V={}){const ja=JSON.stringify([L,V]);let ta=Fd[ja];ta||(ta=new Intl.ListFormat(L,V),Fd[ja]=ta);return ta}function H(L,V={}){const ja=JSON.stringify([L,V]);let ta=Rb[ja];ta||(ta=new Intl.DateTimeFormat(L,V),Rb[ja]=ta);return ta}function C(L,V={}){const ja=JSON.stringify([L,
V]);let ta=Vb[ja];ta||(ta=new Intl.NumberFormat(L,V),Vb[ja]=ta);return ta}function w(L,V={}){const {base:ja,...ta}=V,Ba=JSON.stringify([L,ta]);let Ha=Mc[Ba];Ha||(Ha=new Intl.RelativeTimeFormat(L,V),Mc[Ba]=Ha);return Ha}function y(L){const V=[];for(let ja=1;12>=ja;ja++){const ta=ab.utc(2016,ja,1);V.push(L(ta))}return V}function x(L){const V=[];for(let ja=1;7>=ja;ja++){const ta=ab.utc(2016,11,13+ja);V.push(L(ta))}return V}function m(L,V,ja,ta,Ba){L=L.listingMode(ja);return"error"===L?null:"en"===L?
ta(V):Ba(V)}function h(L,V){if(c(L)||null===L)return V;if(L instanceof nc)return L;if("string"===typeof L){const ja=L.toLowerCase();return"default"===ja?V:"local"===ja||"system"===ja?qc.instance:"utc"===ja||"gmt"===ja?Kb.utcInstance:Kb.parseSpecifier(ja)||Pb.create(L)}return d(L)?Kb.instance(L):"object"===typeof L&&L.offset&&"number"===typeof L.offset?L:new Gd(L)}function c(L){return"undefined"===typeof L}function d(L){return"number"===typeof L}function f(L){return"number"===typeof L&&0===L%1}function k(){try{return"undefined"!==
typeof Intl&&!!Intl.RelativeTimeFormat}catch(L){return!1}}function g(L,V,ja){if(0!==L.length)return L.reduce((ta,Ba)=>{Ba=[V(Ba),Ba];return ta?ja(ta[0],Ba[0])===ta[0]?ta:Ba:Ba},null)[1]}function e(L,V){return V.reduce((ja,ta)=>{ja[ta]=L[ta];return ja},{})}function a(L,V){return Object.prototype.hasOwnProperty.call(L,V)}function b(L,V,ja){return f(L)&&L>=V&&L<=ja}function l(L,V=2){return 0>L?"-"+(""+-L).padStart(V,"0"):(""+L).padStart(V,"0")}function q(L){if(!c(L)&&null!==L&&""!==L)return parseInt(L,
10)}function n(L){if(!c(L)&&null!==L&&""!==L)return parseFloat(L)}function v(L){if(!c(L)&&null!==L&&""!==L)return L=1E3*parseFloat("0."+L),Math.floor(L)}function B(L,V,ja=!1){V=10**V;return(ja?Math.trunc:Math.round)(L*V)/V}function z(L){return 0===L%4&&(0!==L%100||0===L%400)}function p(L,V){var ja=V-1;ja=ja-12*Math.floor(ja/12)+1;return 2===ja?z(L+(V-ja)/12)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][ja-1]}function r(L){let V=Date.UTC(L.year,L.month-1,L.day,L.hour,L.minute,L.second,L.millisecond);
100>L.year&&0<=L.year&&(V=new Date(V),V.setUTCFullYear(V.getUTCFullYear()-1900));return+V}function D(L){var V=L-1;V=(V+Math.floor(V/4)-Math.floor(V/100)+Math.floor(V/400))%7;return 4===(L+Math.floor(L/4)-Math.floor(L/100)+Math.floor(L/400))%7||3===V?53:52}function J(L){return 99<L?L:L>Gb.twoDigitCutoffYear?1900+L:2E3+L}function K(L,V,ja,ta=null){L=new Date(L);const Ba={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};ta&&(Ba.timeZone=ta);return(V=(new Intl.DateTimeFormat(ja,
{timeZoneName:V,...Ba})).formatToParts(L).find(Ha=>"timezonename"===Ha.type.toLowerCase()))?V.value:null}function F(L,V){L=parseInt(L,10);Number.isNaN(L)&&(L=0);V=parseInt(V,10)||0;V=0>L||Object.is(L,-0)?-V:V;return 60*L+V}function A(L){const V=Number(L);if("boolean"===typeof L||""===L||Number.isNaN(V))throw new Fa(`Invalid unit value ${L}`);return V}function I(L,V){const ja={};for(const ta in L)if(a(L,ta)){const Ba=L[ta];void 0!==Ba&&null!==Ba&&(ja[V(ta)]=A(Ba))}return ja}function G(L,V){const ja=
Math.trunc(Math.abs(L/60)),ta=Math.trunc(Math.abs(L%60));L=0<=L?"+":"-";switch(V){case "short":return`${L}${l(ja,2)}:${l(ta,2)}`;case "narrow":return`${L}${ja}${0<ta?`:${ta}`:""}`;case "techie":return`${L}${l(ja,2)}${l(ta,2)}`;default:throw new RangeError(`Value format ${V} is out of range for property format`);}}function E(L){return e(L,["hour","minute","second","millisecond"])}function M(L){switch(L){case "narrow":return[...yc];case "short":return[...Hd];case "long":return[...Id];case "numeric":return"1 2 3 4 5 6 7 8 9 10 11 12".split(" ");
case "2-digit":return"01 02 03 04 05 06 07 08 09 10 11 12".split(" ");default:return null}}function T(L){switch(L){case "narrow":return[...gc];case "short":return[...hc];case "long":return[...ic];case "numeric":return"1234567".split("");default:return null}}function Y(L){switch(L){case "narrow":return[...sd];case "short":return[...le];case "long":return[...Jd];default:return null}}function fa(L,V,ja="always",ta=!1){const Ba={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],
weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]};var Ha=-1===["hours","minutes","seconds"].indexOf(L);if("auto"===ja&&Ha)switch(ja="days"===L,V){case 1:return ja?"tomorrow":`next ${Ba[L][0]}`;case -1:return ja?"yesterday":`last ${Ba[L][0]}`;case 0:return ja?"today":`this ${Ba[L][0]}`}ja=Object.is(V,-0)||0>V;V=Math.abs(V);Ha=1===V;const Ma=Ba[L];L=ta?Ha?Ma[1]:Ma[2]||Ma[1]:Ha?Ba[L][0]:L;return ja?`${V} ${L} ago`:`in ${V} ${L}`}
function ba(L,V){let ja="";for(const ta of L)ja=ta.literal?ja+ta.val:ja+V(ta.val);return ja}function U(...L){L=L.reduce((V,ja)=>V+ja.source,"");return RegExp(`^${L}$`)}function P(...L){return V=>L.reduce(([ja,ta,Ba],Ha)=>{const [Ma,Va,Xa]=Ha(V,Ba);return[{...ja,...Ma},Va||ta,Xa]},[{},null,1]).slice(0,2)}function Q(L,...V){if(null==L)return[null,null];for(const [ja,ta]of V)if(V=ja.exec(L))return ta(V);return[null,null]}function Z(...L){return(V,ja)=>{const ta={};let Ba;for(Ba=0;Ba<L.length;Ba++)ta[L[Ba]]=
q(V[ja+Ba]);return[ta,null,ja+Ba]}}function X(L,V,ja){L=L[V];return c(L)?ja:q(L)}function sa(L,V){return[{hours:X(L,V,0),minutes:X(L,V+1,0),seconds:X(L,V+2,0),milliseconds:v(L[V+3])},null,V+4]}function Aa(L,V){const ja=!L[V]&&!L[V+1];L=F(L[V+1],L[V+2]);return[{},ja?null:Kb.instance(L),V+3]}function Da(L,V){return[{},L[V]?Pb.create(L[V]):null,V+1]}function ha(L){const [V,ja,ta,Ba,Ha,Ma,Va,Xa,R]=L,bb="-"===V[0];L=Xa&&"-"===Xa[0];const gb=(kb,Ia=!1)=>void 0!==kb&&(Ia||kb&&bb)?-kb:kb;return[{years:gb(n(ja)),
months:gb(n(ta)),weeks:gb(n(Ba)),days:gb(n(Ha)),hours:gb(n(Ma)),minutes:gb(n(Va)),seconds:gb(n(Xa),"-0"===Xa),milliseconds:gb(v(R),L)}]}function Ea(L,V,ja,ta,Ba,Ha,Ma){V={year:2===V.length?J(q(V)):q(V),month:Hd.indexOf(ja)+1,day:q(ta),hour:q(Ba),minute:q(Ha)};Ma&&(V.second=q(Ma));L&&(V.weekday=3<L.length?ic.indexOf(L)+1:hc.indexOf(L)+1);return V}function za(L){const [,V,ja,ta,Ba,Ha,Ma,Va,Xa,R,bb,gb]=L;L=Ea(V,Ba,ta,ja,Ha,Ma,Va);let kb;kb=Xa?me[Xa]:R?0:F(bb,gb);return[L,new Kb(kb)]}function N(L){const [,
V,ja,ta,Ba,Ha,Ma,Va]=L;return[Ea(V,Ba,ta,ja,Ha,Ma,Va),Kb.utcInstance]}function S(L){const [,V,ja,ta,Ba,Ha,Ma,Va]=L;return[Ea(V,Va,ja,ta,Ba,Ha,Ma),Kb.utcInstance]}function ea(L,V,ja=!1){L={values:ja?V.values:{...L.values,...(V.values||{})},loc:L.loc.clone(V.loc),conversionAccuracy:V.conversionAccuracy||L.conversionAccuracy,matrix:V.matrix||L.matrix};return new nb(L)}function oa(L,V,ja,ta,Ba){L=L[Ba][ja];var Ha=V[ja]/L;Ha=Math.sign(Ha)!==Math.sign(ta[Ba])&&0!==ta[Ba]&&1>=Math.abs(Ha)?0>Ha?Math.floor(Ha):
Math.ceil(Ha):Math.trunc(Ha);ta[Ba]+=Ha;V[ja]-=Ha*L}function va(L,V){ed.reduce((ja,ta)=>{if(c(V[ta]))return ja;ja&&oa(L,V,ja,V,ta);return ta},null)}function W(L,V){L=V.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf()-L.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf();return Math.floor(nb.fromMillis(L).as("days"))}function ca(L,V,ja){const ta=[["years",(Xa,R)=>R.year-Xa.year],["quarters",(Xa,R)=>R.quarter-Xa.quarter+4*(R.year-Xa.year)],["months",(Xa,R)=>R.month-Xa.month+12*(R.year-Xa.year)],
["weeks",(Xa,R)=>{Xa=W(Xa,R);return(Xa-Xa%7)/7}],["days",W]],Ba={},Ha=L;let Ma,Va;for(const [Xa,R]of ta)0<=ja.indexOf(Xa)&&(Ma=Xa,Ba[Xa]=R(L,V),Va=Ha.plus(Ba),Va>V?(Ba[Xa]--,L=Ha.plus(Ba)):L=Va);return[L,Ba,Va,Ma]}function ka(L,V,ja,ta){let [Ba,Ha,Ma,Va]=ca(L,V,ja);L=V-Ba;ja=ja.filter(Xa=>0<=["hours","minutes","seconds","milliseconds"].indexOf(Xa));0===ja.length&&(Ma<V&&(Ma=Ba.plus({[Va]:1})),Ma!==Ba&&(Ha[Va]=(Ha[Va]||0)+L/(Ma-Ba)));V=nb.fromObject(Ha,ta);return 0<ja.length?nb.fromMillis(L,ta).shiftTo(...ja).plus(V):
V}function la({numberingSystem:L},V=""){return new RegExp(`${Nc[L||"latn"]}${V}`)}function ma(L,V=ja=>ja){return{regex:L,deser:([ja])=>{{let ta=parseInt(ja,10);if(isNaN(ta)){ta="";for(let Ba=0;Ba<ja.length;Ba++){const Ha=ja.charCodeAt(Ba);if(-1!==ja[Ba].search(Nc.hanidec))ta+=Oc.indexOf(ja[Ba]);else for(const Ma in jc){const [Va,Xa]=jc[Ma];Ha>=Va&&Ha<=Xa&&(ta+=Ha-Va)}}ja=parseInt(ta,10)}else ja=ta}return V(ja)}}}function ua(L){return L.replace(/\./g,"\\.?").replace(Pc,oc)}function xa(L,V){return null===
L?null:{regex:RegExp(L.map(ua).join("|")),deser:([ja])=>L.findIndex(ta=>ja.replace(/\./g,"").replace(Pc," ").toLowerCase()===ta.replace(/\./g,"").replace(Pc," ").toLowerCase())+V}}function ia(L,V){return{regex:L,deser:([,ja,ta])=>F(ja,ta),groups:V}}function na(L){return{regex:L,deser:([V])=>V}}function ya(L,V){const ja=la(V),ta=la(V,"{2}"),Ba=la(V,"{3}"),Ha=la(V,"{4}"),Ma=la(V,"{6}"),Va=la(V,"{1,2}"),Xa=la(V,"{1,3}"),R=la(V,"{1,6}"),bb=la(V,"{1,9}"),gb=la(V,"{2,4}"),kb=la(V,"{4,6}"),Ia=aa=>({regex:RegExp(aa.val.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,
"\\$\x26")),deser:([da])=>da,literal:!0}),zc=(aa=>{if(L.literal)return Ia(aa);switch(aa.val){case "G":return xa(V.eras("short",!1),0);case "GG":return xa(V.eras("long",!1),0);case "y":return ma(R);case "yy":return ma(gb,J);case "yyyy":return ma(Ha);case "yyyyy":return ma(kb);case "yyyyyy":return ma(Ma);case "M":return ma(Va);case "MM":return ma(ta);case "MMM":return xa(V.months("short",!0,!1),1);case "MMMM":return xa(V.months("long",!0,!1),1);case "L":return ma(Va);case "LL":return ma(ta);case "LLL":return xa(V.months("short",
!1,!1),1);case "LLLL":return xa(V.months("long",!1,!1),1);case "d":return ma(Va);case "dd":return ma(ta);case "o":return ma(Xa);case "ooo":return ma(Ba);case "HH":return ma(ta);case "H":return ma(Va);case "hh":return ma(ta);case "h":return ma(Va);case "mm":return ma(ta);case "m":return ma(Va);case "q":return ma(Va);case "qq":return ma(ta);case "s":return ma(Va);case "ss":return ma(ta);case "S":return ma(Xa);case "SSS":return ma(Ba);case "u":return na(bb);case "uu":return na(Va);case "uuu":return ma(ja);
case "a":return xa(V.meridiems(),0);case "kkkk":return ma(Ha);case "kk":return ma(gb,J);case "W":return ma(Va);case "WW":return ma(ta);case "E":case "c":return ma(ja);case "EEE":return xa(V.weekdays("short",!1,!1),1);case "EEEE":return xa(V.weekdays("long",!1,!1),1);case "ccc":return xa(V.weekdays("short",!0,!1),1);case "cccc":return xa(V.weekdays("long",!0,!1),1);case "Z":case "ZZ":return ia(new RegExp(`([+-]${Va.source})(?::(${ta.source}))?`),2);case "ZZZ":return ia(new RegExp(`([+-]${Va.source})(${ta.source})?`),
2);case "z":return na(/[a-z_+-/]{1,256}?/i);default:return Ia(aa)}})(L)||{invalidReason:"missing Intl.DateTimeFormat.formatToParts support"};zc.token=L;return zc}function Ga(L){return[`^${L.map(V=>V.regex).reduce((V,ja)=>`${V}(${ja.source})`,"")}$`,L]}function Ka(L,V,ja){if(L=L.match(V)){V={};let ta=1;for(const Ba in ja)if(a(ja,Ba)){const Ha=ja[Ba],Ma=Ha.groups?Ha.groups+1:1;!Ha.literal&&Ha.token&&(V[Ha.token.val[0]]=Ha.deser(L.slice(ta,ta+Ma)));ta+=Ma}return[L,V]}return[L,{}]}function Ra(L){const V=
Ba=>{switch(Ba){case "S":return"millisecond";case "s":return"second";case "m":return"minute";case "h":case "H":return"hour";case "d":return"day";case "o":return"ordinal";case "L":case "M":return"month";case "y":return"year";case "E":case "c":return"weekday";case "W":return"weekNumber";case "k":return"weekYear";case "q":return"quarter";default:return null}};let ja=null,ta;c(L.z)||(ja=Pb.create(L.z));c(L.Z)||(ja||(ja=new Kb(L.Z)),ta=L.Z);c(L.q)||(L.M=3*(L.q-1)+1);c(L.h)||(12>L.h&&1===L.a?L.h+=12:12===
L.h&&0===L.a&&(L.h=0));0===L.G&&L.y&&(L.y=-L.y);c(L.u)||(L.S=v(L.u));return[Object.keys(L).reduce((Ba,Ha)=>{const Ma=V(Ha);Ma&&(Ba[Ma]=L[Ha]);return Ba},{}),ja,ta]}function Qa(L,V){return Array.prototype.concat(...L.map(ja=>{if(!ja.literal){var ta=Bb.macroTokenToFormatOpts(ja.val);ta=Sa(ta,V);ja=null==ta||ta.includes(void 0)?ja:ta}return ja}))}function Ta(L,V,ja){ja=Qa(Bb.parseFormat(ja),L);var ta=ja.map(kb=>ya(kb,L));const Ba=ta.find(kb=>kb.invalidReason);if(Ba)return{input:V,tokens:ja,invalidReason:Ba.invalidReason};
const [Ha,Ma]=Ga(ta);ta=RegExp(Ha,"i");const [Va,Xa]=Ka(V,ta,Ma),[R,bb,gb]=Xa?Ra(Xa):[null,null,void 0];if(a(Xa,"a")&&a(Xa,"H"))throw new wa("Can't include meridiem when specifying 24-hour format");return{input:V,tokens:ja,regex:ta,rawMatches:Va,matches:Xa,result:R,zone:bb,specificOffset:gb}}function Sa(L,V){if(!L)return null;V=Bb.create(V,L);var ja=V.formatDateTimeParts;td||(td=ab.fromMillis(1555555555555));return ja.call(V,td).map(ta=>{{const {type:Ha,value:Ma}=ta;if("literal"===Ha)ta={literal:!0,
val:Ma};else{ta=L[Ha];var Ba=Kd[Ha];"object"===typeof Ba&&(Ba=Ba[ta]);ta=Ba?{literal:!1,val:Ba}:void 0}}return ta})}function Na(L,V){return new zb("unit out of range",`you specified ${V} (of type ${typeof V}) as a ${L}, which is invalid`)}function Ua(L,V,ja){V=new Date(Date.UTC(L,V-1,ja));100>L&&0<=L&&V.setUTCFullYear(V.getUTCFullYear()-1900);L=V.getUTCDay();return 0===L?7:L}function Ja(L,V){L=z(L)?Ac:ud;const ja=L.findIndex(ta=>ta<V);return{month:ja+1,day:V-L[ja]}}function rb(L){const {year:V,month:ja,
day:ta}=L;var Ba=ta+(z(V)?Ac:ud)[ja-1];const Ha=Ua(V,ja,ta);Ba=Math.floor((Ba-Ha+10)/7);let Ma;1>Ba?(Ma=V-1,Ba=D(Ma)):Ba>D(V)?(Ma=V+1,Ba=1):Ma=V;return{weekYear:Ma,weekNumber:Ba,weekday:Ha,...E(L)}}function hb(L){const {weekYear:V,weekNumber:ja,weekday:ta}=L;var Ba=Ua(V,1,4),Ha=z(V)?366:365;Ba=7*ja+ta-Ba-3;1>Ba?(Ha=V-1,Ba+=z(Ha)?366:365):Ba>Ha?(Ha=V+1,Ba-=z(V)?366:365):Ha=V;const {month:Ma,day:Va}=Ja(Ha,Ba);return{year:Ha,month:Ma,day:Va,...E(L)}}function db(L){const {year:V,month:ja,day:ta}=L;var Ba=
ta+(z(V)?Ac:ud)[ja-1];return{year:V,ordinal:Ba,...E(L)}}function O(L){const {year:V,ordinal:ja}=L,{month:ta,day:Ba}=Ja(V,ja);return{year:V,month:ta,day:Ba,...E(L)}}function eb(L){const V=f(L.year),ja=b(L.month,1,12),ta=b(L.day,1,p(L.year,L.month));return V?ja?ta?!1:Na("day",L.day):Na("month",L.month):Na("year",L.year)}function Za(L){const {hour:V,minute:ja,second:ta,millisecond:Ba}=L;L=b(V,0,23)||24===V&&0===ja&&0===ta&&0===Ba;const Ha=b(ja,0,59),Ma=b(ta,0,59),Va=b(Ba,0,999);return L?Ha?Ma?Va?!1:
Na("millisecond",Ba):Na("second",ta):Na("minute",ja):Na("hour",V)}function pb(L){return new zb("unsupported zone",`the zone "${L.name}" is not supported`)}function Ab(L){null===L.weekData&&(L.weekData=rb(L.c));return L.weekData}function ib(L,V){L={ts:L.ts,zone:L.zone,c:L.c,o:L.o,loc:L.loc,invalid:L.invalid};return new ab({...L,...V,old:L})}function Wb(L,V,ja){let ta=L-6E4*V;const Ba=ja.offset(ta);if(V===Ba)return[ta,V];ta-=6E4*(Ba-V);V=ja.offset(ta);return Ba===V?[ta,Ba]:[L-6E4*Math.min(Ba,V),Math.max(Ba,
V)]}function Ca(L,V){L=new Date(L+6E4*V);return{year:L.getUTCFullYear(),month:L.getUTCMonth()+1,day:L.getUTCDate(),hour:L.getUTCHours(),minute:L.getUTCMinutes(),second:L.getUTCSeconds(),millisecond:L.getUTCMilliseconds()}}function Xb(L,V,ja){return Wb(r(L),V,ja)}function Yb(L,V){const ja=L.o;var ta=L.c.year+Math.trunc(V.years);const Ba=L.c.month+Math.trunc(V.months)+3*Math.trunc(V.quarters);ta={...L.c,year:ta,month:Ba,day:Math.min(L.c.day,p(ta,Ba))+Math.trunc(V.days)+7*Math.trunc(V.weeks)};V=nb.fromObject({years:V.years-
Math.trunc(V.years),quarters:V.quarters-Math.trunc(V.quarters),months:V.months-Math.trunc(V.months),weeks:V.weeks-Math.trunc(V.weeks),days:V.days-Math.trunc(V.days),hours:V.hours,minutes:V.minutes,seconds:V.seconds,milliseconds:V.milliseconds}).as("milliseconds");ta=r(ta);let [Ha,Ma]=Wb(ta,ja,L.zone);0!==V&&(Ha+=V,Ma=L.zone.offset(Ha));return{ts:Ha,o:Ma}}function Jb(L,V,ja,ta,Ba,Ha){const {setZone:Ma,zone:Va}=ja;return L&&0!==Object.keys(L).length?(L=ab.fromObject(L,{...ja,zone:V||Va,specificOffset:Ha}),
Ma?L:L.setZone(Va)):ab.invalid(new zb("unparsable",`the input "${Ba}" can't be parsed as ${ta}`))}function Qb(L,V,ja=!0){return L.isValid?Bb.create(tb.create("en-US"),{allowZ:ja,forceSimple:!0}).formatDateTimeFromString(L,V):null}function kc(L,V){const ja=9999<L.c.year||0>L.c.year;let ta="";ja&&0<=L.c.year&&(ta+="+");ta+=l(L.c.year,ja?6:4);V?(ta=ta+"-"+l(L.c.month),ta=ta+"-"+l(L.c.day)):(ta+=l(L.c.month),ta+=l(L.c.day));return ta}function Zb(L,V,ja,ta,Ba,Ha){let Ma=l(L.c.hour);V?(Ma=Ma+":"+l(L.c.minute),
0===L.c.second&&ja||(Ma+=":")):Ma+=l(L.c.minute);0===L.c.second&&ja||(Ma+=l(L.c.second),0===L.c.millisecond&&ta||(Ma=Ma+"."+l(L.c.millisecond,3)));Ba&&(L.isOffsetFixed&&0===L.offset&&!Ha?Ma+="Z":0>L.o?(Ma=Ma+"-"+l(Math.trunc(-L.o/60)),Ma=Ma+":"+l(Math.trunc(-L.o%60))):(Ma=Ma+"+"+l(Math.trunc(L.o/60)),Ma=Ma+":"+l(Math.trunc(L.o%60))));Ha&&(Ma+="["+L.zone.ianaName+"]");return Ma}function $b(L){const V={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",
minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[L.toLowerCase()];if(!V)throw new qa(L);return V}function Lb(L,V){const ja=h(V.zone,Gb.defaultZone);V=tb.fromObject(V);const ta=Gb.now();var Ba;if(c(L.year))L=ta;else{for(const Ha of fb)c(L[Ha])&&
(L[Ha]=fd[Ha]);if(Ba=eb(L)||Za(L))return ab.invalid(Ba);Ba=ja.offset(ta);[L,Ba]=Xb(L,Ba,ja)}return new ab({ts:L,zone:ja,loc:V,o:Ba})}function ub(L,V,ja){const ta=c(ja.round)?!0:ja.round,Ba=(Ma,Va)=>{Ma=B(Ma,ta||ja.calendary?0:2,!0);return V.loc.clone(ja).relFormatter(ja).format(Ma,Va)},Ha=Ma=>ja.calendary?V.hasSame(L,Ma)?0:V.startOf(Ma).diff(L.startOf(Ma),Ma).get(Ma):V.diff(L,Ma).get(Ma);if(ja.unit)return Ba(Ha(ja.unit),ja.unit);for(const Ma of ja.units){const Va=Ha(Ma);if(1<=Math.abs(Va))return Ba(Va,
Ma)}return Ba(L>V?-0:0,ja.units[ja.units.length-1])}function mb(L){let V={};0<L.length&&"object"===typeof L[L.length-1]?(V=L[L.length-1],L=Array.from(L).slice(0,L.length-1)):L=Array.from(L);return[V,L]}function wb(L){if(ab.isDateTime(L))return L;if(L&&L.valueOf&&d(L.valueOf()))return ab.fromJSDate(L);if(L&&"object"===typeof L)return ab.fromObject(L);throw new Fa(`Unknown datetime argument: ${L}, of type ${typeof L}`);}class Cb extends Error{}class cb extends Cb{constructor(L){super(`Invalid DateTime: ${L.toMessage()}`)}}
class Tb extends Cb{constructor(L){super(`Invalid Interval: ${L.toMessage()}`)}}class pa extends Cb{constructor(L){super(`Invalid Duration: ${L.toMessage()}`)}}class wa extends Cb{}class qa extends Cb{constructor(L){super(`Invalid unit ${L}`)}}class Fa extends Cb{}class Oa extends Cb{constructor(){super("Zone is an abstract class")}}const Pa={year:"numeric",month:"numeric",day:"numeric"},Ya={year:"numeric",month:"short",day:"numeric"},$a={year:"numeric",month:"short",day:"numeric",weekday:"short"},
sb={year:"numeric",month:"long",day:"numeric"},ob={year:"numeric",month:"long",day:"numeric",weekday:"long"},qb={hour:"numeric",minute:"numeric"},vb={hour:"numeric",minute:"numeric",second:"numeric"},Db={hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},vd={hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"long"},rc={hour:"numeric",minute:"numeric",hourCycle:"h23"},wd={hour:"numeric",minute:"numeric",second:"numeric",hourCycle:"h23"},sc={hour:"numeric",minute:"numeric",
second:"numeric",hourCycle:"h23",timeZoneName:"short"},Bc={hour:"numeric",minute:"numeric",second:"numeric",hourCycle:"h23",timeZoneName:"long"},gd={year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"},Cc={year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"},xd={year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"},Dc={year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"},
ne={year:"numeric",month:"short",day:"numeric",weekday:"short",hour:"numeric",minute:"numeric"},hd={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",timeZoneName:"short"},Qc={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},Rc={year:"numeric",month:"long",day:"numeric",weekday:"long",hour:"numeric",minute:"numeric",timeZoneName:"long"},Ec={year:"numeric",month:"long",day:"numeric",weekday:"long",hour:"numeric",
minute:"numeric",second:"numeric",timeZoneName:"long"};class nc{get type(){throw new Oa;}get name(){throw new Oa;}get ianaName(){return this.name}get isUniversal(){throw new Oa;}offsetName(L,V){throw new Oa;}formatOffset(L,V){throw new Oa;}offset(L){throw new Oa;}equals(L){throw new Oa;}get isValid(){throw new Oa;}}let yd=null;class qc extends nc{static get instance(){null===yd&&(yd=new qc);return yd}get type(){return"system"}get name(){return(new Intl.DateTimeFormat).resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(L,
{format:V,locale:ja}){return K(L,V,ja)}formatOffset(L,V){return G(this.offset(L),V)}offset(L){return-(new Date(L)).getTimezoneOffset()}equals(L){return"system"===L.type}get isValid(){return!0}}let ac={};const id={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};let Fc={};class Pb extends nc{static create(L){Fc[L]||(Fc[L]=new Pb(L));return Fc[L]}static resetCache(){Fc={};ac={}}static isValidSpecifier(L){return this.isValidZone(L)}static isValidZone(L){if(!L)return!1;try{return(new Intl.DateTimeFormat("en-US",
{timeZone:L})).format(),!0}catch(V){return!1}}constructor(L){super();this.zoneName=L;this.valid=Pb.isValidZone(L)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(L,{format:V,locale:ja}){return K(L,V,ja,this.name)}formatOffset(L,V){return G(this.offset(L),V)}offset(L){L=new Date(L);if(isNaN(L))return NaN;var V=this.name;ac[V]||(ac[V]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:V,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",
second:"2-digit",era:"short"}));V=ac[V];if(V.formatToParts){V=V.formatToParts(L);var ja=[];for(let bb=0;bb<V.length;bb++){const {type:gb,value:kb}=V[bb],Ia=id[gb];"era"===gb?ja[Ia]=kb:c(Ia)||(ja[Ia]=parseInt(kb,10))}V=ja}else{V=V.format(L).replace(/\u200E/g,"");V=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(V);const [,bb,gb,kb,Ia,zc,aa,da]=V;V=[kb,bb,gb,Ia,zc,aa,da]}let [ta,Ba,Ha,Ma,Va,Xa,R]=V;"BC"===Ma&&(ta=-Math.abs(ta)+1);V=r({year:ta,month:Ba,day:Ha,hour:24===Va?0:Va,minute:Xa,second:R,
millisecond:0});L=+L;ja=L%1E3;return(V-(L-(0<=ja?ja:1E3+ja)))/6E4}equals(L){return"iana"===L.type&&L.name===this.name}get isValid(){return this.valid}}let Fd={},Rb={},Vb={},Mc={},Gc=null;class jd{constructor(L,V,ja){this.padTo=ja.padTo||0;this.floor=ja.floor||!1;const {padTo:ta,floor:Ba,...Ha}=ja;if(!V||0<Object.keys(Ha).length)V={useGrouping:!1,...ja},0<ja.padTo&&(V.minimumIntegerDigits=ja.padTo),this.inf=C(L,V)}format(L){if(this.inf)return this.inf.format(this.floor?Math.floor(L):L);L=this.floor?
Math.floor(L):B(L,3);return l(L,this.padTo)}}class oe{constructor(L,V,ja){this.opts=ja;var ta=void 0;L.zone.isUniversal?(ta=L.offset/60*-1,ta=0<=ta?`Etc/GMT+${ta}`:`Etc/GMT${ta}`,0!==L.offset&&Pb.create(ta).valid?this.dt=L:(ta="UTC",this.dt=ja.timeZoneName?L:0===L.offset?L:ab.fromMillis(L.ts+6E4*L.offset))):"system"===L.zone.type?this.dt=L:(this.dt=L,ta=L.zone.name);L={...this.opts};L.timeZone=L.timeZone||ta;this.dtf=H(V,L)}format(){return this.dtf.format(this.dt.toJSDate())}formatToParts(){return this.dtf.formatToParts(this.dt.toJSDate())}resolvedOptions(){return this.dtf.resolvedOptions()}}
class tc{constructor(L,V,ja){this.opts={style:"long",...ja};!V&&k()&&(this.rtf=w(L,ja))}format(L,V){return this.rtf?this.rtf.format(L,V):fa(V,L,this.opts.numeric,"long"!==this.opts.style)}formatToParts(L,V){return this.rtf?this.rtf.formatToParts(L,V):[]}}class tb{static fromOpts(L){return tb.create(L.locale,L.numberingSystem,L.outputCalendar,L.defaultToEN)}static create(L,V,ja,ta=!1){L=L||Gb.defaultLocale;var Ba;(Ba=L)||(ta?ta="en-US":(Gc||(Gc=(new Intl.DateTimeFormat).resolvedOptions().locale),ta=
Gc),Ba=ta);return new tb(Ba,V||Gb.defaultNumberingSystem,ja||Gb.defaultOutputCalendar,L)}static resetCache(){Gc=null;Rb={};Vb={};Mc={}}static fromObject({locale:L,numberingSystem:V,outputCalendar:ja}={}){return tb.create(L,V,ja)}constructor(L,V,ja,ta){var Ba=L.indexOf("-x-");-1!==Ba&&(L=L.substring(0,Ba));Ba=L.indexOf("-u-");if(-1===Ba)var Ha=[L];else{try{Ha=H(L).resolvedOptions();var Ma=L}catch(kb){Ma=L.substring(0,Ba),Ha=H(Ma).resolvedOptions()}const {numberingSystem:bb,calendar:gb}=Ha;Ha=[Ma,bb,
gb]}const [Va,Xa,R]=Ha;this.locale=Va;this.numberingSystem=V||Xa||null;this.outputCalendar=ja||R||null;V=this.locale;ja=this.numberingSystem;if((Ha=this.outputCalendar)||ja)V.includes("-u-")||(V+="-u"),Ha&&(V+=`-ca-${Ha}`),ja&&(V+=`-nu-${ja}`);this.intl=V;this.weekdaysCache={format:{},standalone:{}};this.monthsCache={format:{},standalone:{}};this.meridiemCache=null;this.eraCache={};this.specifiedLocale=ta;this.fastNumbersCached=null}get fastNumbers(){if(null==this.fastNumbersCached){var L=this.numberingSystem&&
"latn"!==this.numberingSystem?!1:"latn"===this.numberingSystem||!this.locale||this.locale.startsWith("en")||"latn"===(new Intl.DateTimeFormat(this.intl)).resolvedOptions().numberingSystem;this.fastNumbersCached=L}return this.fastNumbersCached}listingMode(){const L=this.isEnglish(),V=(null===this.numberingSystem||"latn"===this.numberingSystem)&&(null===this.outputCalendar||"gregory"===this.outputCalendar);return L&&V?"en":"intl"}clone(L){return L&&0!==Object.getOwnPropertyNames(L).length?tb.create(L.locale||
this.specifiedLocale,L.numberingSystem||this.numberingSystem,L.outputCalendar||this.outputCalendar,L.defaultToEN||!1):this}redefaultToEN(L={}){return this.clone({...L,defaultToEN:!0})}redefaultToSystem(L={}){return this.clone({...L,defaultToEN:!1})}months(L,V=!1,ja=!0){return m(this,L,ja,M,()=>{const ta=V?{month:L,day:"numeric"}:{month:L},Ba=V?"format":"standalone";this.monthsCache[Ba][L]||(this.monthsCache[Ba][L]=y(Ha=>this.extract(Ha,ta,"month")));return this.monthsCache[Ba][L]})}weekdays(L,V=!1,
ja=!0){return m(this,L,ja,T,()=>{const ta=V?{weekday:L,year:"numeric",month:"long",day:"numeric"}:{weekday:L},Ba=V?"format":"standalone";this.weekdaysCache[Ba][L]||(this.weekdaysCache[Ba][L]=x(Ha=>this.extract(Ha,ta,"weekday")));return this.weekdaysCache[Ba][L]})}meridiems(L=!0){return m(this,void 0,L,()=>zd,()=>{if(!this.meridiemCache){const V={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[ab.utc(2016,11,13,9),ab.utc(2016,11,13,19)].map(ja=>this.extract(ja,V,"dayperiod"))}return this.meridiemCache})}eras(L,
V=!0){return m(this,L,V,Y,()=>{const ja={era:L};this.eraCache[L]||(this.eraCache[L]=[ab.utc(-40,1,1),ab.utc(2017,1,1)].map(ta=>this.extract(ta,ja,"era")));return this.eraCache[L]})}extract(L,V,ja){return(L=this.dtFormatter(L,V).formatToParts().find(ta=>ta.type.toLowerCase()===ja))?L.value:null}numberFormatter(L={}){return new jd(this.intl,L.forceSimple||this.fastNumbers,L)}dtFormatter(L,V={}){return new oe(L,this.intl,V)}relFormatter(L={}){return new tc(this.intl,this.isEnglish(),L)}listFormatter(L=
{}){return t(this.intl,L)}isEnglish(){return"en"===this.locale||"en-us"===this.locale.toLowerCase()||(new Intl.DateTimeFormat(this.intl)).resolvedOptions().locale.startsWith("en-us")}equals(L){return this.locale===L.locale&&this.numberingSystem===L.numberingSystem&&this.outputCalendar===L.outputCalendar}}let Sc=null;class Kb extends nc{static get utcInstance(){null===Sc&&(Sc=new Kb(0));return Sc}static instance(L){return 0===L?Kb.utcInstance:new Kb(L)}static parseSpecifier(L){return L&&(L=L.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i))?
new Kb(F(L[1],L[2])):null}constructor(L){super();this.fixed=L}get type(){return"fixed"}get name(){return 0===this.fixed?"UTC":`UTC${G(this.fixed,"narrow")}`}get ianaName(){return 0===this.fixed?"Etc/UTC":`Etc/GMT${G(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(L,V){return G(this.fixed,V)}get isUniversal(){return!0}offset(){return this.fixed}equals(L){return"fixed"===L.type&&L.fixed===this.fixed}get isValid(){return!0}}class Gd extends nc{constructor(L){super();this.zoneName=
L}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}let pc=()=>Date.now(),Tc="system",kd=null,bc=null,ld=null,uc=60,Uc;class Gb{static get now(){return pc}static set now(L){pc=L}static set defaultZone(L){Tc=L}static get defaultZone(){return h(Tc,qc.instance)}static get defaultLocale(){return kd}static set defaultLocale(L){kd=L}static get defaultNumberingSystem(){return bc}static set defaultNumberingSystem(L){bc=
L}static get defaultOutputCalendar(){return ld}static set defaultOutputCalendar(L){ld=L}static get twoDigitCutoffYear(){return uc}static set twoDigitCutoffYear(L){uc=L%100}static get throwOnInvalid(){return Uc}static set throwOnInvalid(L){Uc=L}static resetCaches(){tb.resetCache();Pb.resetCache()}}const Id="January February March April May June July August September October November December".split(" "),Hd="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),yc="JFMAMJJASOND".split(""),ic=
"Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),hc="Mon Tue Wed Thu Fri Sat Sun".split(" "),gc="MTWTFSS".split(""),zd=["AM","PM"],Jd=["Before Christ","Anno Domini"],le=["BC","AD"],sd=["B","A"],Hc={D:Pa,DD:Ya,DDD:sb,DDDD:ob,t:qb,tt:vb,ttt:Db,tttt:vd,T:rc,TT:wd,TTT:sc,TTTT:Bc,f:gd,ff:xd,fff:hd,ffff:Rc,F:Cc,FF:Dc,FFF:Qc,FFFF:Ec};class Bb{static create(L,V={}){return new Bb(L,V)}static parseFormat(L){let V=null,ja="",ta=!1;const Ba=[];for(let Ha=0;Ha<L.length;Ha++){const Ma=L.charAt(Ha);
"'"===Ma?(0<ja.length&&Ba.push({literal:ta,val:ja}),V=null,ja="",ta=!ta):ta?ja+=Ma:Ma===V?ja+=Ma:(0<ja.length&&Ba.push({literal:!1,val:ja}),V=ja=Ma)}0<ja.length&&Ba.push({literal:ta,val:ja});return Ba}static macroTokenToFormatOpts(L){return Hc[L]}constructor(L,V){this.opts=V;this.loc=L;this.systemLoc=null}formatWithSystemDefault(L,V){null===this.systemLoc&&(this.systemLoc=this.loc.redefaultToSystem());return this.systemLoc.dtFormatter(L,{...this.opts,...V}).format()}formatDateTime(L,V={}){return this.loc.dtFormatter(L,
{...this.opts,...V}).format()}formatDateTimeParts(L,V={}){return this.loc.dtFormatter(L,{...this.opts,...V}).formatToParts()}formatInterval(L,V={}){return this.loc.dtFormatter(L.start,{...this.opts,...V}).dtf.formatRange(L.start.toJSDate(),L.end.toJSDate())}resolvedOptions(L,V={}){return this.loc.dtFormatter(L,{...this.opts,...V}).resolvedOptions()}num(L,V=0){if(this.opts.forceSimple)return l(L,V);const ja={...this.opts};0<V&&(ja.padTo=V);return this.loc.numberFormatter(ja).format(L)}formatDateTimeFromString(L,
V){const ja="en"===this.loc.listingMode(),ta=this.loc.outputCalendar&&"gregory"!==this.loc.outputCalendar,Ba=(bb,gb)=>this.loc.extract(L,bb,gb),Ha=bb=>L.isOffsetFixed&&0===L.offset&&bb.allowZ?"Z":L.isValid?L.zone.formatOffset(L.ts,bb.format):"",Ma=(bb,gb)=>ja?M(bb)[L.month-1]:Ba(gb?{month:bb}:{month:bb,day:"numeric"},"month"),Va=(bb,gb)=>ja?T(bb)[L.weekday-1]:Ba(gb?{weekday:bb}:{weekday:bb,month:"long",day:"numeric"},"weekday"),Xa=bb=>{const gb=Bb.macroTokenToFormatOpts(bb);return gb?this.formatWithSystemDefault(L,
gb):bb},R=bb=>ja?Y(bb)[0>L.year?0:1]:Ba({era:bb},"era");return ba(Bb.parseFormat(V),bb=>{switch(bb){case "S":return this.num(L.millisecond);case "u":case "SSS":return this.num(L.millisecond,3);case "s":return this.num(L.second);case "ss":return this.num(L.second,2);case "uu":return this.num(Math.floor(L.millisecond/10),2);case "uuu":return this.num(Math.floor(L.millisecond/100));case "m":return this.num(L.minute);case "mm":return this.num(L.minute,2);case "h":return this.num(0===L.hour%12?12:L.hour%
12);case "hh":return this.num(0===L.hour%12?12:L.hour%12,2);case "H":return this.num(L.hour);case "HH":return this.num(L.hour,2);case "Z":return Ha({format:"narrow",allowZ:this.opts.allowZ});case "ZZ":return Ha({format:"short",allowZ:this.opts.allowZ});case "ZZZ":return Ha({format:"techie",allowZ:this.opts.allowZ});case "ZZZZ":return L.zone.offsetName(L.ts,{format:"short",locale:this.loc.locale});case "ZZZZZ":return L.zone.offsetName(L.ts,{format:"long",locale:this.loc.locale});case "z":return L.zoneName;
case "a":return ja?zd[12>L.hour?0:1]:Ba({hour:"numeric",hourCycle:"h12"},"dayperiod");case "d":return ta?Ba({day:"numeric"},"day"):this.num(L.day);case "dd":return ta?Ba({day:"2-digit"},"day"):this.num(L.day,2);case "c":return this.num(L.weekday);case "ccc":return Va("short",!0);case "cccc":return Va("long",!0);case "ccccc":return Va("narrow",!0);case "E":return this.num(L.weekday);case "EEE":return Va("short",!1);case "EEEE":return Va("long",!1);case "EEEEE":return Va("narrow",!1);case "L":return ta?
Ba({month:"numeric",day:"numeric"},"month"):this.num(L.month);case "LL":return ta?Ba({month:"2-digit",day:"numeric"},"month"):this.num(L.month,2);case "LLL":return Ma("short",!0);case "LLLL":return Ma("long",!0);case "LLLLL":return Ma("narrow",!0);case "M":return ta?Ba({month:"numeric"},"month"):this.num(L.month);case "MM":return ta?Ba({month:"2-digit"},"month"):this.num(L.month,2);case "MMM":return Ma("short",!1);case "MMMM":return Ma("long",!1);case "MMMMM":return Ma("narrow",!1);case "y":return ta?
Ba({year:"numeric"},"year"):this.num(L.year);case "yy":return ta?Ba({year:"2-digit"},"year"):this.num(L.year.toString().slice(-2),2);case "yyyy":return ta?Ba({year:"numeric"},"year"):this.num(L.year,4);case "yyyyyy":return ta?Ba({year:"numeric"},"year"):this.num(L.year,6);case "G":return R("short");case "GG":return R("long");case "GGGGG":return R("narrow");case "kk":return this.num(L.weekYear.toString().slice(-2),2);case "kkkk":return this.num(L.weekYear,4);case "W":return this.num(L.weekNumber);
case "WW":return this.num(L.weekNumber,2);case "o":return this.num(L.ordinal);case "ooo":return this.num(L.ordinal,3);case "q":return this.num(L.quarter);case "qq":return this.num(L.quarter,2);case "X":return this.num(Math.floor(L.ts/1E3));case "x":return this.num(L.ts);default:return Xa(bb)}})}formatDurationFromString(L,V){const ja=Ba=>{switch(Ba[0]){case "S":return"millisecond";case "s":return"second";case "m":return"minute";case "h":return"hour";case "d":return"day";case "w":return"week";case "M":return"month";
case "y":return"year";default:return null}};V=Bb.parseFormat(V);const ta=V.reduce((Ba,{literal:Ha,val:Ma})=>Ha?Ba:Ba.concat(Ma),[]);L=L.shiftTo(...ta.map(ja).filter(Ba=>Ba));return ba(V,(Ba=>Ha=>{const Ma=ja(Ha);return Ma?this.num(Ba.get(Ma),Ha.length):Ha})(L))}}class zb{constructor(L,V){this.reason=L;this.explanation=V}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const Sb=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/,Vc=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,
md=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,Ic=RegExp(`${md.source}${`(?:${Vc.source}?(?:\\[(${Sb.source})\\])?)?`}`),Ad=RegExp(`(?:T${Ic.source})?`),Ld=Z("weekYear","weekNumber","weekDay"),Md=Z("year","ordinal"),nd=RegExp(`${md.source} ?(?:${Vc.source}|(${Sb.source}))?`),Bd=RegExp(`(?: ${nd.source})?`),pe=RegExp(`^T?${md.source}$`),Nd=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/,
me={GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480},Od=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/,Pd=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,Wc=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,
od=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/,vc=U(/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,Ad),Qd=U(/(\d{4})-?W(\d\d)(?:-?(\d))?/,Ad),Rd=U(/(\d{4})-?(\d{3})/,Ad),Sd=U(Ic),Xc=P(function(L,V){return[{year:X(L,V),month:X(L,V+1,1),day:X(L,V+2,1)},null,V+3]},sa,Aa,Da),Td=P(Ld,sa,Aa,Da),Cd=P(Md,sa,Aa,Da),lc=P(sa,Aa,Da),Jc=P(sa),Yc=U(/(\d{4})-(\d\d)-(\d\d)/,Bd),pd=U(nd),Dd=P(sa,Aa,Da),qd={weeks:{days:7,hours:168,minutes:10080,
seconds:604800,milliseconds:6048E5},days:{hours:24,minutes:1440,seconds:86400,milliseconds:864E5},hours:{minutes:60,seconds:3600,milliseconds:36E5},minutes:{seconds:60,milliseconds:6E4},seconds:{milliseconds:1E3}},Zc={years:{quarters:4,months:12,weeks:52,days:365,hours:8760,minutes:525600,seconds:31536E3,milliseconds:31536E6},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:131040,seconds:7862400,milliseconds:78624E5},months:{weeks:4,days:30,hours:720,minutes:43200,seconds:2592E3,milliseconds:2592E6},
...qd},Ud={years:{quarters:4,months:12,weeks:52.1775,days:365.2425,hours:8765.82,minutes:525949.2,seconds:31556952,milliseconds:31556952E3},quarters:{months:3,weeks:13.044375,days:91.310625,hours:2191.455,minutes:131487.3,seconds:7889238,milliseconds:7889238E3},months:{weeks:30.436875/7,days:30.436875,hours:730.485,minutes:43829.1,seconds:2629746,milliseconds:2629746E3},...qd},mc="years quarters months weeks days hours minutes seconds milliseconds".split(" "),ed=mc.slice(0).reverse();class nb{constructor(L){const V=
"longterm"===L.conversionAccuracy||!1;let ja=V?Ud:Zc;L.matrix&&(ja=L.matrix);this.values=L.values;this.loc=L.loc||tb.create();this.conversionAccuracy=V?"longterm":"casual";this.invalid=L.invalid||null;this.matrix=ja;this.isLuxonDuration=!0}static fromMillis(L,V){return nb.fromObject({milliseconds:L},V)}static fromObject(L,V={}){if(null==L||"object"!==typeof L)throw new Fa(`Duration.fromObject: argument expected to be an object, got ${null===L?"null":typeof L}`);return new nb({values:I(L,nb.normalizeUnit),
loc:tb.fromObject(V),conversionAccuracy:V.conversionAccuracy,matrix:V.matrix})}static fromDurationLike(L){if(d(L))return nb.fromMillis(L);if(nb.isDuration(L))return L;if("object"===typeof L)return nb.fromObject(L);throw new Fa(`Unknown duration argument ${L} of type ${typeof L}`);}static fromISO(L,V){const [ja]=Q(L,[Nd,ha]);return ja?nb.fromObject(ja,V):nb.invalid("unparsable",`the input "${L}" can't be parsed as ISO 8601`)}static fromISOTime(L,V){const [ja]=Q(L,[pe,Jc]);return ja?nb.fromObject(ja,
V):nb.invalid("unparsable",`the input "${L}" can't be parsed as ISO 8601`)}static invalid(L,V=null){if(!L)throw new Fa("need to specify a reason the Duration is invalid");L=L instanceof zb?L:new zb(L,V);if(Gb.throwOnInvalid)throw new pa(L);return new nb({invalid:L})}static normalizeUnit(L){const V={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",
second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[L?L.toLowerCase():L];if(!V)throw new qa(L);return V}static isDuration(L){return L&&L.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(L,V={}){V={...V,floor:!1!==V.round&&!1!==V.floor};return this.isValid?Bb.create(this.loc,V).formatDurationFromString(this,L):"Invalid Duration"}toHuman(L={}){const V=mc.map(ja=>
{const ta=this.values[ja];return c(ta)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...L,unit:ja.slice(0,-1)}).format(ta)}).filter(ja=>ja);return this.loc.listFormatter({type:"conjunction",style:L.listStyle||"narrow",...L}).format(V)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let L="P";0!==this.years&&(L+=this.years+"Y");if(0!==this.months||0!==this.quarters)L+=this.months+3*this.quarters+"M";0!==this.weeks&&(L+=this.weeks+"W");0!==this.days&&
(L+=this.days+"D");if(0!==this.hours||0!==this.minutes||0!==this.seconds||0!==this.milliseconds)L+="T";0!==this.hours&&(L+=this.hours+"H");0!==this.minutes&&(L+=this.minutes+"M");if(0!==this.seconds||0!==this.milliseconds)L+=B(this.seconds+this.milliseconds/1E3,3)+"S";"P"===L&&(L+="T0S");return L}toISOTime(L={}){if(!this.isValid)return null;var V=this.toMillis();if(0>V||864E5<=V)return null;L={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...L};V=this.shiftTo("hours",
"minutes","seconds","milliseconds");let ja="basic"===L.format?"hhmm":"hh:mm";L.suppressSeconds&&0===V.seconds&&0===V.milliseconds||(ja+="basic"===L.format?"ss":":ss",L.suppressMilliseconds&&0===V.milliseconds||(ja+=".SSS"));V=V.toFormat(ja);L.includePrefix&&(V="T"+V);return V}toJSON(){return this.toISO()}toString(){return this.toISO()}toMillis(){return this.as("milliseconds")}valueOf(){return this.toMillis()}plus(L){if(!this.isValid)return this;L=nb.fromDurationLike(L);const V={};for(const ja of mc)if(a(L.values,
ja)||a(this.values,ja))V[ja]=L.get(ja)+this.get(ja);return ea(this,{values:V},!0)}minus(L){if(!this.isValid)return this;L=nb.fromDurationLike(L);return this.plus(L.negate())}mapUnits(L){if(!this.isValid)return this;const V={};for(const ja of Object.keys(this.values))V[ja]=A(L(this.values[ja],ja));return ea(this,{values:V},!0)}get(L){return this[nb.normalizeUnit(L)]}set(L){if(!this.isValid)return this;L={...this.values,...I(L,nb.normalizeUnit)};return ea(this,{values:L})}reconfigure({locale:L,numberingSystem:V,
conversionAccuracy:ja,matrix:ta}={}){L={loc:this.loc.clone({locale:L,numberingSystem:V}),matrix:ta,conversionAccuracy:ja};return ea(this,L)}as(L){return this.isValid?this.shiftTo(L).get(L):NaN}normalize(){if(!this.isValid)return this;const L=this.toObject();va(this.matrix,L);return ea(this,{values:L},!0)}rescale(){if(!this.isValid)return this;var L=this.normalize().shiftToAll().toObject();const V={};for(const [ja,ta]of Object.entries(L))0!==ta&&(V[ja]=ta);return ea(this,{values:V},!0)}shiftTo(...L){if(!this.isValid||
0===L.length)return this;L=L.map(Ha=>nb.normalizeUnit(Ha));const V={},ja={},ta=this.toObject();let Ba;for(const Ha of mc)if(0<=L.indexOf(Ha)){Ba=Ha;let Ma=0;for(const Xa in ja)Ma+=this.matrix[Xa][Ha]*ja[Xa],ja[Xa]=0;d(ta[Ha])&&(Ma+=ta[Ha]);const Va=Math.trunc(Ma);V[Ha]=Va;ja[Ha]=(1E3*Ma-1E3*Va)/1E3;for(const Xa in ta)mc.indexOf(Xa)>mc.indexOf(Ha)&&oa(this.matrix,ta,Xa,V,Ha)}else d(ta[Ha])&&(ja[Ha]=ta[Ha]);for(const Ha in ja)0!==ja[Ha]&&(V[Ba]+=Ha===Ba?ja[Ha]:ja[Ha]/this.matrix[Ba][Ha]);return ea(this,
{values:V},!0).normalize()}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const L={};for(const V of Object.keys(this.values))L[V]=0===this.values[V]?0:-this.values[V];return ea(this,{values:L},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?
this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return null===this.invalid}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:
null}equals(L){if(!this.isValid||!L.isValid||!this.loc.equals(L.loc))return!1;for(const ta of mc){var V=this.values[ta];var ja=L.values[ta];V=void 0===V||0===V?void 0===ja||0===ja:V===ja;if(!V)return!1}return!0}}class Eb{constructor(L){this.s=L.start;this.e=L.end;this.invalid=L.invalid||null;this.isLuxonInterval=!0}static invalid(L,V=null){if(!L)throw new Fa("need to specify a reason the Interval is invalid");L=L instanceof zb?L:new zb(L,V);if(Gb.throwOnInvalid)throw new Tb(L);return new Eb({invalid:L})}static fromDateTimes(L,
V){L=wb(L);V=wb(V);var ja=L&&L.isValid?V&&V.isValid?V<L?Eb.invalid("end before start",`The end of an interval must be after its start, but you had start=${L.toISO()} and end=${V.toISO()}`):null:Eb.invalid("missing or invalid end"):Eb.invalid("missing or invalid start");return null==ja?new Eb({start:L,end:V}):ja}static after(L,V){V=nb.fromDurationLike(V);L=wb(L);return Eb.fromDateTimes(L,L.plus(V))}static before(L,V){V=nb.fromDurationLike(V);L=wb(L);return Eb.fromDateTimes(L.minus(V),L)}static fromISO(L,
V){const [ja,ta]=(L||"").split("/",2);if(ja&&ta){let Ma;try{var Ba=ab.fromISO(ja,V);Ma=Ba.isValid}catch(Xa){Ma=!1}let Va;try{var Ha=ab.fromISO(ta,V);Va=Ha.isValid}catch(Xa){Va=!1}if(Ma&&Va)return Eb.fromDateTimes(Ba,Ha);if(Ma){if(Ha=nb.fromISO(ta,V),Ha.isValid)return Eb.after(Ba,Ha)}else if(Va&&(Ba=nb.fromISO(ja,V),Ba.isValid))return Eb.before(Ha,Ba)}return Eb.invalid("unparsable",`the input "${L}" can't be parsed as ISO 8601`)}static isInterval(L){return L&&L.isLuxonInterval||!1}get start(){return this.isValid?
this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return null===this.invalidReason}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(L="milliseconds"){return this.isValid?this.toDuration(...[L]).get(L):NaN}count(L="milliseconds"){if(!this.isValid)return NaN;const V=this.start.startOf(L),ja=this.end.startOf(L);return Math.floor(ja.diff(V,L).get(L))+1}hasSame(L){return this.isValid?this.isEmpty()||
this.e.minus(1).hasSame(this.s,L):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(L){return this.isValid?this.s>L:!1}isBefore(L){return this.isValid?this.e<=L:!1}contains(L){return this.isValid?this.s<=L&&this.e>L:!1}set({start:L,end:V}={}){return this.isValid?Eb.fromDateTimes(L||this.s,V||this.e):this}splitAt(...L){if(!this.isValid)return[];L=L.map(wb).filter(Ha=>this.contains(Ha)).sort();const V=[];let {s:ja}=this,ta=0;for(;ja<this.e;){var Ba=L[ta]||this.e;Ba=+Ba>+this.e?this.e:
Ba;V.push(Eb.fromDateTimes(ja,Ba));ja=Ba;ta+=1}return V}splitBy(L){L=nb.fromDurationLike(L);if(!this.isValid||!L.isValid||0===L.as("milliseconds"))return[];let {s:V}=this,ja=1;const ta=[];for(;V<this.e;){var Ba=this.start.plus(L.mapUnits(Ha=>Ha*ja));Ba=+Ba>+this.e?this.e:Ba;ta.push(Eb.fromDateTimes(V,Ba));V=Ba;ja+=1}return ta}divideEqually(L){return this.isValid?this.splitBy(this.length()/L).slice(0,L):[]}overlaps(L){return this.e>L.s&&this.s<L.e}abutsStart(L){return this.isValid?+this.e===+L.s:!1}abutsEnd(L){return this.isValid?
+L.e===+this.s:!1}engulfs(L){return this.isValid?this.s<=L.s&&this.e>=L.e:!1}equals(L){return this.isValid&&L.isValid?this.s.equals(L.s)&&this.e.equals(L.e):!1}intersection(L){if(!this.isValid)return this;const V=this.s>L.s?this.s:L.s;L=this.e<L.e?this.e:L.e;return V>=L?null:Eb.fromDateTimes(V,L)}union(L){return this.isValid?Eb.fromDateTimes(this.s<L.s?this.s:L.s,this.e>L.e?this.e:L.e):this}static merge(L){const [V,ja]=L.sort((ta,Ba)=>ta.s-Ba.s).reduce(([ta,Ba],Ha)=>Ba?Ba.overlaps(Ha)||Ba.abutsStart(Ha)?
[ta,Ba.union(Ha)]:[ta.concat([Ba]),Ha]:[ta,Ha],[[],null]);ja&&V.push(ja);return V}static xor(L){let V=null,ja=0;const ta=[];L=L.map(Ba=>[{time:Ba.s,type:"s"},{time:Ba.e,type:"e"}]);L=Array.prototype.concat(...L).sort((Ba,Ha)=>Ba.time-Ha.time);for(const Ba of L)ja+="s"===Ba.type?1:-1,1===ja?V=Ba.time:(V&&+V!==+Ba.time&&ta.push(Eb.fromDateTimes(V,Ba.time)),V=null);return Eb.merge(ta)}difference(...L){return Eb.xor([this].concat(L)).map(V=>this.intersection(V)).filter(V=>V&&!V.isEmpty())}toString(){return this.isValid?
`[${this.s.toISO()} \u2013 ${this.e.toISO()})`:"Invalid Interval"}toLocaleString(L=Pa,V={}){return this.isValid?Bb.create(this.s.loc.clone(V),L).formatInterval(this):"Invalid Interval"}toISO(L){return this.isValid?`${this.s.toISO(L)}/${this.e.toISO(L)}`:"Invalid Interval"}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:"Invalid Interval"}toISOTime(L){return this.isValid?`${this.s.toISOTime(L)}/${this.e.toISOTime(L)}`:"Invalid Interval"}toFormat(L,{separator:V=" \u2013 "}=
{}){return this.isValid?`${this.s.toFormat(L)}${V}${this.e.toFormat(L)}`:"Invalid Interval"}toDuration(L,V){return this.isValid?this.e.diff(this.s,L,V):nb.invalid(this.invalidReason)}mapEndpoints(L){return Eb.fromDateTimes(L(this.s),L(this.e))}}class $c{static hasDST(L=Gb.defaultZone){const V=ab.now().setZone(L).set({month:12});return!L.isUniversal&&V.offset!==V.set({month:6}).offset}static isValidIANAZone(L){return Pb.isValidZone(L)}static normalizeZone(L){return h(L,Gb.defaultZone)}static months(L=
"long",{locale:V=null,numberingSystem:ja=null,locObj:ta=null,outputCalendar:Ba="gregory"}={}){return(ta||tb.create(V,ja,Ba)).months(L)}static monthsFormat(L="long",{locale:V=null,numberingSystem:ja=null,locObj:ta=null,outputCalendar:Ba="gregory"}={}){return(ta||tb.create(V,ja,Ba)).months(L,!0)}static weekdays(L="long",{locale:V=null,numberingSystem:ja=null,locObj:ta=null}={}){return(ta||tb.create(V,ja,null)).weekdays(L)}static weekdaysFormat(L="long",{locale:V=null,numberingSystem:ja=null,locObj:ta=
null}={}){return(ta||tb.create(V,ja,null)).weekdays(L,!0)}static meridiems({locale:L=null}={}){return tb.create(L).meridiems()}static eras(L="short",{locale:V=null}={}){return tb.create(V,null,"gregory").eras(L)}static features(){return{relative:k()}}}const Nc={arab:"[\u0660-\u0669]",arabext:"[\u06f0-\u06f9]",bali:"[\u1b50-\u1b59]",beng:"[\u09e6-\u09ef]",deva:"[\u0966-\u096f]",fullwide:"[\uff10-\uff19]",gujr:"[\u0ae6-\u0aef]",hanidec:"[\u3007|\u4e00|\u4e8c|\u4e09|\u56db|\u4e94|\u516d|\u4e03|\u516b|\u4e5d]",
khmr:"[\u17e0-\u17e9]",knda:"[\u0ce6-\u0cef]",laoo:"[\u0ed0-\u0ed9]",limb:"[\u1946-\u194f]",mlym:"[\u0d66-\u0d6f]",mong:"[\u1810-\u1819]",mymr:"[\u1040-\u1049]",orya:"[\u0b66-\u0b6f]",tamldec:"[\u0be6-\u0bef]",telu:"[\u0c66-\u0c6f]",thai:"[\u0e50-\u0e59]",tibt:"[\u0f20-\u0f29]",latn:"\\d"},jc={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,
3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},Oc=Nc.hanidec.replace(/[\[|\]]/g,"").split(""),oc=`[ ${String.fromCharCode(160)}]`,Pc=new RegExp(oc,"g"),Kd={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour:{numeric:"h","2-digit":"hh"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s",
"2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};let td=null;const ud=[0,31,59,90,120,151,181,212,243,273,304,334],Ac=[0,31,60,91,121,152,182,213,244,274,305,335],fd={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},qe={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},Vd={ordinal:1,hour:0,minute:0,second:0,millisecond:0},fb="year month day hour minute second millisecond".split(" "),Fb="weekYear weekNumber weekday hour minute second millisecond".split(" "),Mb="year ordinal hour minute second millisecond".split(" ");
class ab{constructor(L){const V=L.zone||Gb.defaultZone;let ja=L.invalid||(Number.isNaN(L.ts)?new zb("invalid input"):null)||(V.isValid?null:pb(V));this.ts=c(L.ts)?Gb.now():L.ts;let ta=null;var Ba=null;ja||(L.old&&L.old.ts===this.ts&&L.old.zone.equals(V)?[ta,Ba]=[L.old.c,L.old.o]:(Ba=V.offset(this.ts),ta=Ca(this.ts,Ba),ta=(ja=Number.isNaN(ta.year)?new zb("invalid input"):null)?null:ta,Ba=ja?null:Ba));this._zone=V;this.loc=L.loc||tb.create();this.invalid=ja;this.weekData=null;this.c=ta;this.o=Ba;this.isLuxonDateTime=
!0}static now(){return new ab({})}static local(){const [L,V]=mb(arguments),[ja,ta,Ba,Ha,Ma,Va,Xa]=V;return Lb({year:ja,month:ta,day:Ba,hour:Ha,minute:Ma,second:Va,millisecond:Xa},L)}static utc(){const [L,V]=mb(arguments),[ja,ta,Ba,Ha,Ma,Va,Xa]=V;L.zone=Kb.utcInstance;return Lb({year:ja,month:ta,day:Ba,hour:Ha,minute:Ma,second:Va,millisecond:Xa},L)}static fromJSDate(L,V={}){L="[object Date]"===Object.prototype.toString.call(L)?L.valueOf():NaN;if(Number.isNaN(L))return ab.invalid("invalid input");const ja=
h(V.zone,Gb.defaultZone);return ja.isValid?new ab({ts:L,zone:ja,loc:tb.fromObject(V)}):ab.invalid(pb(ja))}static fromMillis(L,V={}){if(d(L))return-864E13>L||864E13<L?ab.invalid("Timestamp out of range"):new ab({ts:L,zone:h(V.zone,Gb.defaultZone),loc:tb.fromObject(V)});throw new Fa(`fromMillis requires a numerical input, but received a ${typeof L} with value ${L}`);}static fromSeconds(L,V={}){if(d(L))return new ab({ts:1E3*L,zone:h(V.zone,Gb.defaultZone),loc:tb.fromObject(V)});throw new Fa("fromSeconds requires a numerical input");
}static fromObject(L,V={}){L=L||{};var ja=h(V.zone,Gb.defaultZone);if(!ja.isValid)return ab.invalid(pb(ja));var ta=Gb.now();const Ba=c(V.specificOffset)?ja.offset(ta):V.specificOffset,Ha=I(L,$b);var Ma=!c(Ha.ordinal),Va=!c(Ha.year),Xa=!c(Ha.month)||!c(Ha.day);Va=Va||Xa;var R=Ha.weekYear||Ha.weekNumber;V=tb.fromObject(V);if((Va||Ma)&&R)throw new wa("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(Xa&&Ma)throw new wa("Can't mix ordinal dates with month/day");Xa=R||Ha.weekday&&
!Va;let bb=Ca(ta,Ba);Xa?(ta=Fb,R=qe,bb=rb(bb)):Ma?(ta=Mb,R=Vd,bb=db(bb)):(ta=fb,R=fd);let gb=!1;for(var kb of ta)c(Ha[kb])?Ha[kb]=gb?R[kb]:bb[kb]:gb=!0;Xa?(kb=f(Ha.weekYear),ta=b(Ha.weekNumber,1,D(Ha.weekYear)),R=b(Ha.weekday,1,7),kb=kb?ta?R?!1:Na("weekday",Ha.weekday):Na("week",Ha.week):Na("weekYear",Ha.weekYear)):Ma?(kb=f(Ha.year),ta=b(Ha.ordinal,1,z(Ha.year)?366:365),kb=kb?ta?!1:Na("ordinal",Ha.ordinal):Na("year",Ha.year)):kb=eb(Ha);if(kb=kb||Za(Ha))return ab.invalid(kb);Ma=Xa?hb(Ha):Ma?O(Ha):
Ha;const [Ia,zc]=Xb(Ma,Ba,ja);ja=new ab({ts:Ia,zone:ja,o:zc,loc:V});return Ha.weekday&&Va&&L.weekday!==ja.weekday?ab.invalid("mismatched weekday",`you can't specify both a weekday of ${Ha.weekday} and a date of ${ja.toISO()}`):ja}static fromISO(L,V={}){const [ja,ta]=Q(L,[vc,Xc],[Qd,Td],[Rd,Cd],[Sd,lc]);return Jb(ja,ta,V,"ISO 8601",L)}static fromRFC2822(L,V={}){const [ja,ta]=Q(L.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim(),[Od,za]);return Jb(ja,ta,V,"RFC 2822",L)}static fromHTTP(L,
V={}){const [ja,ta]=Q(L,[Pd,N],[Wc,N],[od,S]);return Jb(ja,ta,V,"HTTP",V)}static fromFormat(L,V,ja={}){if(c(L)||c(V))throw new Fa("fromFormat requires an input string and a format");const {locale:ta=null,numberingSystem:Ba=null}=ja,Ha=tb.fromOpts({locale:ta,numberingSystem:Ba,defaultToEN:!0}),{result:Ma,zone:Va,specificOffset:Xa,invalidReason:R}=Ta(Ha,L,V),[bb,gb,kb,Ia]=[Ma,Va,Xa,R];return Ia?ab.invalid(Ia):Jb(bb,gb,ja,`format ${V}`,L,kb)}static fromString(L,V,ja={}){return ab.fromFormat(L,V,ja)}static fromSQL(L,
V={}){const [ja,ta]=Q(L,[Yc,Xc],[pd,Dd]);return Jb(ja,ta,V,"SQL",L)}static invalid(L,V=null){if(!L)throw new Fa("need to specify a reason the DateTime is invalid");L=L instanceof zb?L:new zb(L,V);if(Gb.throwOnInvalid)throw new cb(L);return new ab({invalid:L})}static isDateTime(L){return L&&L.isLuxonDateTime||!1}static parseFormatForOpts(L,V={}){return(L=Sa(L,tb.fromObject(V)))?L.map(ja=>ja?ja.val:null).join(""):null}static expandFormat(L,V={}){return Qa(Bb.parseFormat(L),tb.fromObject(V)).map(ja=>
ja.val).join("")}get(L){return this[L]}get isValid(){return null===this.invalid}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?
this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?Ab(this).weekYear:NaN}get weekNumber(){return this.isValid?Ab(this).weekNumber:NaN}get weekday(){return this.isValid?
Ab(this).weekday:NaN}get ordinal(){return this.isValid?db(this.c).ordinal:NaN}get monthShort(){return this.isValid?$c.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?$c.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?$c.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?$c.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?
this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}get isInLeapYear(){return z(this.year)}get daysInMonth(){return p(this.year,this.month)}get daysInYear(){return this.isValid?
z(this.year)?366:365:NaN}get weeksInWeekYear(){return this.isValid?D(this.weekYear):NaN}resolvedLocaleOptions(L={}){const {locale:V,numberingSystem:ja,calendar:ta}=Bb.create(this.loc.clone(L),L).resolvedOptions(this);return{locale:V,numberingSystem:ja,outputCalendar:ta}}toUTC(L=0,V={}){return this.setZone(Kb.instance(L),V)}toLocal(){return this.setZone(Gb.defaultZone)}setZone(L,{keepLocalTime:V=!1,keepCalendarTime:ja=!1}={}){L=h(L,Gb.defaultZone);if(L.equals(this.zone))return this;if(L.isValid){let ta=
this.ts;if(V||ja)V=L.offset(this.ts),ja=this.toObject(),[ta]=Xb(ja,V,L);return ib(this,{ts:ta,zone:L})}return ab.invalid(pb(L))}reconfigure({locale:L,numberingSystem:V,outputCalendar:ja}={}){L=this.loc.clone({locale:L,numberingSystem:V,outputCalendar:ja});return ib(this,{loc:L})}setLocale(L){return this.reconfigure({locale:L})}set(L){if(!this.isValid)return this;L=I(L,$b);var V=!c(L.weekYear)||!c(L.weekNumber)||!c(L.weekday);const ja=!c(L.ordinal),ta=!c(L.year),Ba=!c(L.month)||!c(L.day),Ha=L.weekYear||
L.weekNumber;if((ta||Ba||ja)&&Ha)throw new wa("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(Ba&&ja)throw new wa("Can't mix ordinal dates with month/day");V?V=hb({...rb(this.c),...L}):c(L.ordinal)?(V={...this.toObject(),...L},c(L.day)&&(V.day=Math.min(p(V.year,V.month),V.day))):V=O({...db(this.c),...L});const [Ma,Va]=Xb(V,this.o,this.zone);return ib(this,{ts:Ma,o:Va})}plus(L){if(!this.isValid)return this;L=nb.fromDurationLike(L);return ib(this,Yb(this,L))}minus(L){if(!this.isValid)return this;
L=nb.fromDurationLike(L).negate();return ib(this,Yb(this,L))}startOf(L){if(!this.isValid)return this;const V={};L=nb.normalizeUnit(L);switch(L){case "years":V.month=1;case "quarters":case "months":V.day=1;case "weeks":case "days":V.hour=0;case "hours":V.minute=0;case "minutes":V.second=0;case "seconds":V.millisecond=0}"weeks"===L&&(V.weekday=1);"quarters"===L&&(V.month=3*(Math.ceil(this.month/3)-1)+1);return this.set(V)}endOf(L){return this.isValid?this.plus({[L]:1}).startOf(L).minus(1):this}toFormat(L,
V={}){return this.isValid?Bb.create(this.loc.redefaultToEN(V)).formatDateTimeFromString(this,L):"Invalid DateTime"}toLocaleString(L=Pa,V={}){return this.isValid?Bb.create(this.loc.clone(V),L).formatDateTime(this):"Invalid DateTime"}toLocaleParts(L={}){return this.isValid?Bb.create(this.loc.clone(L),L).formatDateTimeParts(this):[]}toISO({format:L="extended",suppressSeconds:V=!1,suppressMilliseconds:ja=!1,includeOffset:ta=!0,extendedZone:Ba=!1}={}){if(!this.isValid)return null;L="extended"===L;let Ha=
kc(this,L);return Ha=Ha+"T"+Zb(this,L,V,ja,ta,Ba)}toISODate({format:L="extended"}={}){return this.isValid?kc(this,"extended"===L):null}toISOWeekDate(){return Qb(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:L=!1,suppressSeconds:V=!1,includeOffset:ja=!0,includePrefix:ta=!1,extendedZone:Ba=!1,format:Ha="extended"}={}){return this.isValid?(ta?"T":"")+Zb(this,"extended"===Ha,V,L,ja,Ba):null}toRFC2822(){return Qb(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return Qb(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?
kc(this,!0):null}toSQLTime({includeOffset:L=!0,includeZone:V=!1,includeOffsetSpace:ja=!0}={}){let ta="HH:mm:ss.SSS";if(V||L)ja&&(ta+=" "),V?ta+="z":L&&(ta+="ZZ");return Qb(this,ta,!0)}toSQL(L={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(L)}`:null}toString(){return this.isValid?this.toISO():"Invalid DateTime"}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1E3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/
1E3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(L={}){if(!this.isValid)return{};const V={...this.c};L.includeConfig&&(V.outputCalendar=this.outputCalendar,V.numberingSystem=this.loc.numberingSystem,V.locale=this.loc.locale);return V}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(L,V="milliseconds",ja={}){if(!this.isValid||!L.isValid)return nb.invalid("created by diffing an invalid DateTime");ja={locale:this.locale,numberingSystem:this.numberingSystem,...ja};
const ta=(Array.isArray(V)?V:[V]).map(nb.normalizeUnit);V=L.valueOf()>this.valueOf();L=ka(V?this:L,V?L:this,ta,ja);return V?L.negate():L}diffNow(L="milliseconds",V={}){return this.diff(ab.now(),L,V)}until(L){return this.isValid?Eb.fromDateTimes(this,L):this}hasSame(L,V){if(!this.isValid)return!1;const ja=L.valueOf();L=this.setZone(L.zone,{keepLocalTime:!0});return L.startOf(V)<=ja&&ja<=L.endOf(V)}equals(L){return this.isValid&&L.isValid&&this.valueOf()===L.valueOf()&&this.zone.equals(L.zone)&&this.loc.equals(L.loc)}toRelative(L=
{}){if(!this.isValid)return null;const V=L.base||ab.fromObject({},{zone:this.zone}),ja=L.padding?this<V?-L.padding:L.padding:0;let ta="years months days hours minutes seconds".split(" "),Ba=L.unit;Array.isArray(L.unit)&&(ta=L.unit,Ba=void 0);return ub(V,this.plus(ja),{...L,numeric:"always",units:ta,unit:Ba})}toRelativeCalendar(L={}){return this.isValid?ub(L.base||ab.fromObject({},{zone:this.zone}),this,{...L,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...L){if(!L.every(ab.isDateTime))throw new Fa("min requires all arguments be DateTimes");
return g(L,V=>V.valueOf(),Math.min)}static max(...L){if(!L.every(ab.isDateTime))throw new Fa("max requires all arguments be DateTimes");return g(L,V=>V.valueOf(),Math.max)}static fromFormatExplain(L,V,ja={}){const {locale:ta=null,numberingSystem:Ba=null}=ja;ja=tb.fromOpts({locale:ta,numberingSystem:Ba,defaultToEN:!0});return Ta(ja,L,V)}static fromStringExplain(L,V,ja={}){return ab.fromFormatExplain(L,V,ja)}static get DATE_SHORT(){return Pa}static get DATE_MED(){return Ya}static get DATE_MED_WITH_WEEKDAY(){return $a}static get DATE_FULL(){return sb}static get DATE_HUGE(){return ob}static get TIME_SIMPLE(){return qb}static get TIME_WITH_SECONDS(){return vb}static get TIME_WITH_SHORT_OFFSET(){return Db}static get TIME_WITH_LONG_OFFSET(){return vd}static get TIME_24_SIMPLE(){return rc}static get TIME_24_WITH_SECONDS(){return wd}static get TIME_24_WITH_SHORT_OFFSET(){return sc}static get TIME_24_WITH_LONG_OFFSET(){return Bc}static get DATETIME_SHORT(){return gd}static get DATETIME_SHORT_WITH_SECONDS(){return Cc}static get DATETIME_MED(){return xd}static get DATETIME_MED_WITH_SECONDS(){return Dc}static get DATETIME_MED_WITH_WEEKDAY(){return ne}static get DATETIME_FULL(){return hd}static get DATETIME_FULL_WITH_SECONDS(){return Qc}static get DATETIME_HUGE(){return Rc}static get DATETIME_HUGE_WITH_SECONDS(){return Ec}}
u.DateTime=ab;u.Duration=nb;u.FixedOffsetZone=Kb;u.IANAZone=Pb;u.Info=$c;u.Interval=Eb;u.SystemZone=qc;u.Zone=nc})},"esri/core/sql/WhereGrammar":function(){define(["exports","../../chunks/_commonjsHelpers"],function(u,t){var H={};(function(w){(function(y,x){w.exports&&(w.exports=x())})(t.commonjsGlobal,function(){function y(m,h,c,d){m=Error.call(this,m);Object.setPrototypeOf&&Object.setPrototypeOf(m,y.prototype);m.expected=h;m.found=c;m.location=d;m.name="SyntaxError";return m}function x(m,h,c){c=
c||" ";if(m.length>h)return m;h-=m.length;c+=c.repeat(h);return m+c.slice(0,h)}(function(m,h){function c(){this.constructor=m}c.prototype=h.prototype;m.prototype=new c})(y,Error);y.prototype.format=function(m){var h="Error: "+this.message;if(this.location){var c=null,d;for(d=0;d<m.length;d++)if(m[d].source===this.location.source){c=m[d].text.split(/\r\n|\n|\r/g);break}m=this.location.start;d=this.location.source+":"+m.line+":"+m.column;if(c){var f=this.location.end,k=x("",m.line.toString().length,
" ");c=c[m.line-1];f=(m.line===f.line?f.column:c.length+1)-m.column||1;h+="\n --\x3e "+d+"\n"+k+" |\n"+m.line+" | "+c+"\n"+k+" | "+x("",m.column-1," ")+x("",f,"^")}else h+="\n at "+d}return h};y.buildMessage=function(m,h){function c(e){return e.charCodeAt(0).toString(16).toUpperCase()}function d(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+c(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,
function(a){return"\\x"+c(a)})}function f(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+c(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+c(a)})}function k(e){return g[e.type](e)}var g={literal:function(e){return'"'+d(e.text)+'"'},class:function(e){var a=e.parts.map(function(b){return Array.isArray(b)?f(b[0])+
"-"+f(b[1]):f(b)});return"["+(e.inverted?"^":"")+a.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(e){return e.description}};return"Expected "+function(e){e=e.map(k);var a,b;e.sort();if(0<e.length){for(b=a=1;a<e.length;a++)e[a-1]!==e[a]&&(e[b]=e[a],b++);e.length=b}switch(e.length){case 1:return e[0];case 2:return e[0]+" or "+e[1];default:return e.slice(0,-1).join(", ")+", or "+e[e.length-1]}}(m)+" but "+(h?'"'+d(h)+'"':"end of input")+" found."};
return{SyntaxError:y,parse:function(m,h){function c(aa,da){return{type:"literal",text:aa,ignoreCase:da}}function d(aa,da,ra){return{type:"class",parts:aa,inverted:da,ignoreCase:ra}}function f(aa){var da=bb[aa],ra;if(!da){for(ra=aa-1;!bb[ra];)ra--;da=bb[ra];for(da={line:da.line,column:da.column};ra<aa;)10===m.charCodeAt(ra)?(da.line++,da.column=1):da.column++,ra++;bb[aa]=da}return da}function k(aa,da){var ra=f(aa),La=f(da);return{source:eb,start:{offset:aa,line:ra.line,column:ra.column},end:{offset:da,
line:La.line,column:La.column}}}function g(aa){R<gb||(R>gb&&(gb=R,kb=[]),kb.push(aa))}function e(){var aa=R;Ja();var da=b();da!==O?(Ja(),aa=da):(R=aa,aa=O);return aa}function a(){var aa=R;var da=b();if(da!==O){aa=[];var ra=R;var La=Ja();var Wa=Sa();if(Wa!==O){var jb=Ja();var lb=b();lb!==O?ra=La=[La,Wa,jb,lb]:(R=ra,ra=O)}else R=ra,ra=O;for(;ra!==O;)aa.push(ra),ra=R,La=Ja(),Wa=Sa(),Wa!==O?(jb=Ja(),lb=b(),lb!==O?ra=La=[La,Wa,jb,lb]:(R=ra,ra=O)):(R=ra,ra=O);ra={type:"expression-list"};da=[da];for(La=
0;La<aa.length;La++)da.push(aa[La][3]);ra.value=da;aa=ra}else R=aa,aa=O;return aa}function b(){var aa=R;var da=l();if(da!==O){aa=[];var ra=R;var La=Ja();var Wa=oa();if(Wa!==O){var jb=Ja();var lb=l();lb!==O?ra=La=[La,Wa,jb,lb]:(R=ra,ra=O)}else R=ra,ra=O;for(;ra!==O;)aa.push(ra),ra=R,La=Ja(),Wa=oa(),Wa!==O?(jb=Ja(),lb=l(),lb!==O?ra=La=[La,Wa,jb,lb]:(R=ra,ra=O)):(R=ra,ra=O);aa=db(da,aa)}else R=aa,aa=O;return aa}function l(){var aa=R;var da=q();if(da!==O){aa=[];var ra=R;var La=Ja();var Wa=ea();if(Wa!==
O){var jb=Ja();var lb=q();lb!==O?ra=La=[La,Wa,jb,lb]:(R=ra,ra=O)}else R=ra,ra=O;for(;ra!==O;)aa.push(ra),ra=R,La=Ja(),Wa=ea(),Wa!==O?(jb=Ja(),lb=q(),lb!==O?ra=La=[La,Wa,jb,lb]:(R=ra,ra=O)):(R=ra,ra=O);aa=db(da,aa)}else R=aa,aa=O;return aa}function q(){var aa=R;var da=S();if(da===O){da=R;if(33===m.charCodeAt(R)){var ra=Ab;R++}else ra=O,0===Ia&&g(Hd);if(ra!==O){var La=R;Ia++;if(61===m.charCodeAt(R)){var Wa=ib;R++}else Wa=O,0===Ia&&g(yc);Ia--;Wa===O?La=void 0:(R=La,La=O);La!==O?da=ra=[ra,La]:(R=da,da=
O)}else R=da,da=O}da!==O?(ra=Ja(),La=q(),La!==O?aa={type:"unary-expression",operator:"NOT",expr:La}:(R=aa,aa=O)):(R=aa,aa=O);if(aa===O){da=R;aa=z();if(aa!==O){Ja();da=[];ra=R;La=Ja();Wa=n();if(Wa!==O){var jb=Ja();var lb=z();lb!==O?ra=La=[La,Wa,jb,lb]:(R=ra,ra=O)}else R=ra,ra=O;if(ra!==O)for(;ra!==O;)da.push(ra),ra=R,La=Ja(),Wa=n(),Wa!==O?(jb=Ja(),lb=z(),lb!==O?ra=La=[La,Wa,jb,lb]:(R=ra,ra=O)):(R=ra,ra=O);else da=O;da!==O&&(da={type:"arithmetic",tail:da});da===O&&(da=R,ra=B(),ra!==O?(Ja(),La=Na(),
La!==O?(Ja(),La=a(),La!==O?(Ja(),Wa=Ua(),Wa!==O?da={op:ra,right:La}:(R=da,da=O)):(R=da,da=O)):(R=da,da=O)):(R=da,da=O),da===O&&(da=R,ra=B(),ra!==O?(Ja(),La=Na(),La!==O?(Ja(),La=Ua(),La!==O?da={op:ra,right:{type:"expression-list",value:[]}}:(R=da,da=O)):(R=da,da=O)):(R=da,da=O),da===O&&(da=R,ra=B(),ra!==O?(Ja(),La=G(),La!==O?da={op:ra,right:La}:(R=da,da=O)):(R=da,da=O))),da===O&&(da=R,Wa=S(),Wa!==O?(Ja(),ra=va(),ra!==O?(Ja(),La=z(),La!==O?(Ja(),jb=ea(),jb!==O?(Ja(),Wa=z(),Wa!==O?da={op:"NOT"+ra,right:{type:"expression-list",
value:[La,Wa]}}:(R=da,da=O)):(R=da,da=O)):(R=da,da=O)):(R=da,da=O)):(R=da,da=O),da===O&&(da=R,Wa=va(),Wa!==O?(Ja(),ra=z(),ra!==O?(Ja(),La=ea(),La!==O?(Ja(),jb=z(),jb!==O?da={op:Wa,right:{type:"expression-list",value:[ra,jb]}}:(R=da,da=O)):(R=da,da=O)):(R=da,da=O)):(R=da,da=O)),da===O&&(da=R,ra=za(),ra!==O?(Ja(),La=S(),La!==O?(Ja(),La=z(),La!==O?da={op:ra+"NOT",right:La}:(R=da,da=O)):(R=da,da=O)):(R=da,da=O),da===O&&(da=R,ra=za(),ra!==O?(Ja(),La=z(),La!==O?da={op:ra,right:La}:(R=da,da=O)):(R=da,da=
O)),da===O&&(da=R,ra=v(),ra!==O?(Ja(),La=ba(),La!==O?(Ja(),Wa=R,m.substr(R,6).toLowerCase()===Ya?(jb=m.substr(R,6),R+=6):(jb=O,0===Ia&&g(Sd)),jb!==O?(jb=R,Ia++,lb=A(),Ia--,lb===O?jb=void 0:(R=jb,jb=O),jb!==O?Wa="ESCAPE":(R=Wa,Wa=O)):(R=Wa,Wa=O),Wa!==O?(Ja(),Wa=U(),Wa!==O?da={op:ra,right:La,escape:Wa.value}:(R=da,da=O)):(R=da,da=O)):(R=da,da=O)):(R=da,da=O),da===O&&(da=R,ra=v(),ra!==O?(Ja(),La=ba(),La!==O?da={op:ra,right:La,escape:""}:(R=da,da=O)):(R=da,da=O))))));da===O&&(da=null);""==da||void 0==
da||null==da?da=aa:(ra=null,da=ra="arithmetic"==da.type?db(aa,da.tail):hb(da.op,aa,da.right,da.escape))}else R=da,da=O;aa=da}return aa}function n(){if(m.substr(R,2)===Wb){var aa=Wb;R+=2}else aa=O,0===Ia&&g(ic);aa===O&&(62===m.charCodeAt(R)?(aa=Ca,R++):(aa=O,0===Ia&&g(hc)),aa===O&&(m.substr(R,2)===Xb?(aa=Xb,R+=2):(aa=O,0===Ia&&g(gc)),aa===O&&(m.substr(R,2)===Yb?(aa=Yb,R+=2):(aa=O,0===Ia&&g(zd)),aa===O&&(60===m.charCodeAt(R)?(aa=Jb,R++):(aa=O,0===Ia&&g(Jd)),aa===O&&(61===m.charCodeAt(R)?(aa=ib,R++):
(aa=O,0===Ia&&g(yc)),aa===O&&(m.substr(R,2)===Qb?(aa=Qb,R+=2):(aa=O,0===Ia&&g(le))))))));return aa}function v(){var aa=aa=R;var da=S();if(da!==O){var ra=Ja();var La=N();La!==O?aa=da=[da,ra,La]:(R=aa,aa=O)}else R=aa,aa=O;aa!==O&&(aa=aa[0]+" "+aa[2]);aa===O&&(aa=N());return aa}function B(){var aa=aa=R;var da=S();if(da!==O){var ra=Ja();var La=Ea();La!==O?aa=da=[da,ra,La]:(R=aa,aa=O)}else R=aa,aa=O;aa!==O&&(aa=aa[0]+" "+aa[2]);aa===O&&(aa=Ea());return aa}function z(){var aa=R;var da=r();if(da!==O){aa=
[];var ra=R;var La=Ja();var Wa=p();if(Wa!==O){var jb=Ja();var lb=r();lb!==O?ra=La=[La,Wa,jb,lb]:(R=ra,ra=O)}else R=ra,ra=O;for(;ra!==O;)aa.push(ra),ra=R,La=Ja(),Wa=p(),Wa!==O?(jb=Ja(),lb=r(),lb!==O?ra=La=[La,Wa,jb,lb]:(R=ra,ra=O)):(R=ra,ra=O);aa=db(da,aa)}else R=aa,aa=O;return aa}function p(){if(43===m.charCodeAt(R)){var aa=kc;R++}else aa=O,0===Ia&&g(sd);aa===O&&(45===m.charCodeAt(R)?(aa=Zb,R++):(aa=O,0===Ia&&g(Hc)),aa===O&&(m.substr(R,2)===$b?(aa=$b,R+=2):(aa=O,0===Ia&&g(Bb))));return aa}function r(){var aa=
R;var da=J();if(da!==O){aa=[];var ra=R;var La=Ja();var Wa=D();if(Wa!==O){var jb=Ja();var lb=J();lb!==O?ra=La=[La,Wa,jb,lb]:(R=ra,ra=O)}else R=ra,ra=O;for(;ra!==O;)aa.push(ra),ra=R,La=Ja(),Wa=D(),Wa!==O?(jb=Ja(),lb=J(),lb!==O?ra=La=[La,Wa,jb,lb]:(R=ra,ra=O)):(R=ra,ra=O);aa=db(da,aa)}else R=aa,aa=O;return aa}function D(){if(42===m.charCodeAt(R)){var aa=Lb;R++}else aa=O,0===Ia&&g(zb);aa===O&&(47===m.charCodeAt(R)?(aa=ub,R++):(aa=O,0===Ia&&g(Sb)));return aa}function J(){var aa=U();if(aa===O){var da=R;
var ra=R;var La=X();if(La!==O){var Wa=sa();if(Wa!==O){var jb=Aa();jb!==O?ra=parseFloat(La+Wa+jb):(R=ra,ra=O)}else R=ra,ra=O}else R=ra,ra=O;ra===O&&(ra=R,La=X(),La!==O?(Wa=sa(),Wa!==O?ra=parseFloat(La+Wa):(R=ra,ra=O)):(R=ra,ra=O),ra===O&&(ra=R,La=X(),La!==O?(Wa=Aa(),Wa!==O?ra=parseFloat(La+Wa):(R=ra,ra=O)):(R=ra,ra=O),ra===O&&(ra=R,La=X(),La!==O&&(La=parseFloat(La)),ra=La)));var lb=ra;if(lb!==O){var Be=R;Ia++;var Kf=F();Ia--;Kf===O?Be=void 0:(R=Be,Be=O);Be!==O?da={type:"number",value:lb}:(R=da,da=
O)}else R=da,da=O;aa=da;if(aa===O){var re=R;var Wd=R;if(m.substr(R,4).toLowerCase()===wa){var Ce=m.substr(R,4);R+=4}else Ce=O,0===Ia&&g(Wc);if(Ce!==O){var se=R;Ia++;var Lf=A();Ia--;Lf===O?se=void 0:(R=se,se=O);se!==O?Wd=Ce=[Ce,se]:(R=Wd,Wd=O)}else R=Wd,Wd=O;var Ed=Wd;Ed!==O&&(Ed={type:"boolean",value:!0});re=Ed;if(re===O){re=R;var Xd=R;if(m.substr(R,5).toLowerCase()===qa){var De=m.substr(R,5);R+=5}else De=O,0===Ia&&g(od);if(De!==O){var te=R;Ia++;var Mf=A();Ia--;Mf===O?te=void 0:(R=te,te=O);te!==O?
Xd=De=[De,te]:(R=Xd,Xd=O)}else R=Xd,Xd=O;Ed=Xd;Ed!==O&&(Ed={type:"boolean",value:!1});re=Ed}aa=re;if(aa===O){var Yd=R;if(m.substr(R,4).toLowerCase()===pa){var Ee=m.substr(R,4);R+=4}else Ee=O,0===Ia&&g(Pd);if(Ee!==O){var ue=R;Ia++;var Nf=A();Ia--;Nf===O?ue=void 0:(R=ue,ue=O);ue!==O?Yd=Ee=[Ee,ue]:(R=Yd,Yd=O)}else R=Yd,Yd=O;var Ye=Yd;Ye!==O&&(Ye={type:"null",value:null});aa=Ye;if(aa===O){var Zd=R;if(la()!==O){Ja();var kf=ba();kf!==O?Zd={type:"date",value:kf.value}:(R=Zd,Zd=O)}else R=Zd,Zd=O;aa=Zd;if(aa===
O){var $d=R;if(ka()!==O){Ja();var lf=ba();lf!==O?$d={type:"timestamp",value:lf.value}:(R=$d,$d=O)}else R=$d,$d=O;aa=$d;if(aa===O){var Nb=R;var Ze=ma();if(Ze!==O){Ja();if(45===m.charCodeAt(R)){var ad=Zb;R++}else ad=O,0===Ia&&g(Hc);ad===O&&(43===m.charCodeAt(R)?(ad=kc,R++):(ad=O,0===Ia&&g(sd)));if(ad!==O){Ja();var ve=ba();if(ve!==O){Ja();var mf=M();mf!==O?Nb={type:"interval",value:ve,qualifier:mf,op:ad}:(R=Nb,Nb=O)}else R=Nb,Nb=O}else R=Nb,Nb=O}else R=Nb,Nb=O;Nb===O&&(Nb=R,Ze=ma(),Ze!==O?(Ja(),ad=ba(),
ad!==O?(Ja(),ve=M(),ve!==O?Nb={type:"interval",value:ad,qualifier:ve,op:""}:(R=Nb,Nb=O)):(R=Nb,Nb=O)):(R=Nb,Nb=O));aa=Nb}}}}}}var xb=aa;if(xb===O){var cc=R;var ae=R;if(m.substr(R,7).toLowerCase()===rc){var nf=m.substr(R,7);R+=7}else nf=O,0===Ia&&g(Dd);if(nf!==O){var Fe=R;Ia++;var Of=A();Ia--;Of===O?Fe=void 0:(R=Fe,Fe=O);Fe!==O?ae="EXTRACT":(R=ae,ae=O)}else R=ae,ae=O;if(ae!==O){Ja();var Pf=Na();if(Pf!==O){Ja();var wc=ua();wc===O&&(wc=xa(),wc===O&&(wc=ia(),wc===O&&(wc=na(),wc===O&&(wc=ya(),wc===O&&
(wc=Ga())))));var of=wc;if(of!==O){Ja();var Qf=W();if(Qf!==O){Ja();var pf=b();if(pf!==O){Ja();var Rf=Ua();Rf!==O?cc={type:"function",name:"extract",args:{type:"expression-list",value:[{type:"string",value:of},pf]}}:(R=cc,cc=O)}else R=cc,cc=O}else R=cc,cc=O}else R=cc,cc=O}else R=cc,cc=O}else R=cc,cc=O;xb=cc;if(xb===O){var dc=R;var be=R;if(m.substr(R,9).toLowerCase()===vd){var qf=m.substr(R,9);R+=9}else qf=O,0===Ia&&g(pd);if(qf!==O){var Ge=R;Ia++;var Sf=A();Ia--;Sf===O?Ge=void 0:(R=Ge,Ge=O);Ge!==O?
be="SUBSTRING":(R=be,be=O)}else R=be,be=O;if(be!==O){Ja();var Tf=Na();if(Tf!==O){Ja();var $e=b();if($e!==O){Ja();var Uf=W();if(Uf!==O){Ja();var af=b();if(af!==O){Ja();var bd=R;var ce=R;if(m.substr(R,3).toLowerCase()===Db){var rf=m.substr(R,3);R+=3}else rf=O,0===Ia&&g(Yc);if(rf!==O){var He=R;Ia++;var Vf=A();Ia--;Vf===O?He=void 0:(R=He,He=O);He!==O?ce="FOR":(R=ce,ce=O)}else R=ce,ce=O;var we=ce;if(we!==O){var Wf=Ja();var sf=b();if(sf!==O){var Xf=Ja();bd=we=[we,Wf,sf,Xf]}else R=bd,bd=O}else R=bd,bd=O;
bd===O&&(bd=null);we=Ua();we!==O?dc={type:"function",name:"substring",args:{type:"expression-list",value:bd?[$e,af,bd[2]]:[$e,af]}}:(R=dc,dc=O)}else R=dc,dc=O}else R=dc,dc=O}else R=dc,dc=O}else R=dc,dc=O}else R=dc,dc=O;xb=dc;if(xb===O){var Hb=R;var bf=ca();if(bf!==O){Ja();var cf=Na();if(cf!==O){Ja();var cd=E();cd===O&&(cd=null);Ja();var xe=b();if(xe!==O){Ja();var df=W();if(df!==O){Ja();var tf=b();if(tf!==O){Ja();var Yf=Ua();Yf!==O?Hb={type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",
value:null==cd?"BOTH":cd},xe,tf]}}:(R=Hb,Hb=O)}else R=Hb,Hb=O}else R=Hb,Hb=O}else R=Hb,Hb=O}else R=Hb,Hb=O}else R=Hb,Hb=O;Hb===O&&(Hb=R,bf=ca(),bf!==O?(Ja(),cf=Na(),cf!==O?(Ja(),cd=E(),cd===O&&(cd=null),Ja(),xe=b(),xe!==O?(Ja(),df=Ua(),df!==O?Hb={type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:null==cd?"BOTH":cd},xe]}}:(R=Hb,Hb=O)):(R=Hb,Hb=O)):(R=Hb,Hb=O)):(R=Hb,Hb=O));xb=Hb;if(xb===O){var ec=R;var de=R;if(m.substr(R,8).toLowerCase()===sc){var uf=m.substr(R,8);
R+=8}else uf=O,0===Ia&&g(Zc);if(uf!==O){var Ie=R;Ia++;var Zf=A();Ia--;Zf===O?Ie=void 0:(R=Ie,Ie=O);Ie!==O?de="POSITION":(R=de,de=O)}else R=de,de=O;if(de!==O){Ja();var $f=Na();if($f!==O){Ja();var vf=b();if(vf!==O){Ja();var ag=Ea();if(ag!==O){Ja();var wf=b();if(wf!==O){Ja();var bg=Ua();bg!==O?ec={type:"function",name:"position",args:{type:"expression-list",value:[vf,wf]}}:(R=ec,ec=O)}else R=ec,ec=O}else R=ec,ec=O}else R=ec,ec=O}else R=ec,ec=O}else R=ec,ec=O;xb=ec;if(xb===O){var fc=R;var ee=R;if(m.substr(R,
4).toLowerCase()===ne){var xf=m.substr(R,4);R+=4}else xf=O,0===Ia&&g($c);if(xf!==O){var Je=R;Ia++;var cg=A();Ia--;cg===O?Je=void 0:(R=Je,Je=O);Je!==O?ee="CAST":(R=ee,ee=O)}else R=ee,ee=O;if(ee!==O){Ja();var dg=Na();if(dg!==O){Ja();var yf=b();if(yf!==O){Ja();var fe=R;if(m.substr(R,2).toLowerCase()===hd){var zf=m.substr(R,2);R+=2}else zf=O,0===Ia&&g(Nc);if(zf!==O){var Ke=R;Ia++;var eg=A();Ia--;eg===O?Ke=void 0:(R=Ke,Ke=O);Ke!==O?fe="AS":(R=fe,fe=O)}else R=fe,fe=O;var fg=fe;if(fg!==O){Ja();var yb=R;
var ge=R;if(m.substr(R,7).toLowerCase()===Qc){var Af=m.substr(R,7);R+=7}else Af=O,0===Ia&&g(jc);if(Af!==O){var Le=R;Ia++;var gg=A();Ia--;gg===O?Le=void 0:(R=Le,Le=O);Le!==O?ge="INTEGER":(R=ge,ge=O)}else R=ge,ge=O;var Ib=ge;Ib!==O&&(Ib={type:"data-type",value:{type:"integer"}});yb=Ib;if(yb===O){yb=R;var he=R;if(m.substr(R,8).toLowerCase()===Rc){var Bf=m.substr(R,8);R+=8}else Bf=O,0===Ia&&g(Oc);if(Bf!==O){var Me=R;Ia++;var hg=A();Ia--;hg===O?Me=void 0:(R=Me,Me=O);Me!==O?he="SMALLINT":(R=he,he=O)}else R=
he,he=O;Ib=he;Ib!==O&&(Ib={type:"data-type",value:{type:"smallint"}});yb=Ib;if(yb===O){yb=R;var ie=R;if(m.substr(R,5).toLowerCase()===Ec){var Cf=m.substr(R,5);R+=5}else Cf=O,0===Ia&&g(oc);if(Cf!==O){var Ne=R;Ia++;var ig=A();Ia--;ig===O?Ne=void 0:(R=Ne,Ne=O);Ne!==O?ie="FLOAT":(R=ie,ie=O)}else R=ie,ie=O;Ib=ie;Ib!==O&&(Ib={type:"data-type",value:{type:"float"}});yb=Ib;if(yb===O){yb=R;var je=R;if(m.substr(R,4).toLowerCase()===nc){var Df=m.substr(R,4);R+=4}else Df=O,0===Ia&&g(Pc);if(Df!==O){var Oe=R;Ia++;
var jg=A();Ia--;jg===O?Oe=void 0:(R=Oe,Oe=O);Oe!==O?je="REAL":(R=je,je=O)}else R=je,je=O;Ib=je;Ib!==O&&(Ib={type:"data-type",value:{type:"real"}});yb=Ib;if(yb===O&&(yb=R,Ib=la(),Ib!==O&&(Ib={type:"data-type",value:{type:"date"}}),yb=Ib,yb===O&&(yb=R,Ib=ka(),Ib!==O&&(Ib={type:"data-type",value:{type:"timestamp"}}),yb=Ib,yb===O))){yb=R;var ke=R;if(m.substr(R,7).toLowerCase()===yd){var Ef=m.substr(R,7);R+=7}else Ef=O,0===Ia&&g(Kd);if(Ef!==O){var Pe=R;Ia++;var kg=A();Ia--;kg===O?Pe=void 0:(R=Pe,Pe=O);
Pe!==O?ke="VARCHAR":(R=ke,ke=O)}else R=ke,ke=O;Ib=ke;if(Ib!==O){Ja();var lg=Na();if(lg!==O){Ja();var Ff=Da();if(Ff!==O){Ja();var mg=Ua();mg!==O?yb={type:"data-type",value:{type:"varchar",size:parseInt(Ff)}}:(R=yb,yb=O)}else R=yb,yb=O}else R=yb,yb=O}else R=yb,yb=O}}}}var Gf=yb;if(Gf!==O){Ja();var ng=Ua();ng!==O?fc={type:"function",name:"cast",args:{type:"expression-list",value:[yf,Gf]}}:(R=fc,fc=O)}else R=fc,fc=O}else R=fc,fc=O}else R=fc,fc=O}else R=fc,fc=O}else R=fc,fc=O;xb=fc;if(xb===O){var rd=R;
var Qe;var xc=R;xc=Qe=K();if(xc===O)if(xc=R,96===m.charCodeAt(R)?(Qe=Gd,R++):(Qe=O,0===Ia&&g(Va)),Qe!==O){var Re=[];if(Id.test(m.charAt(R))){var dd=m.charAt(R);R++}else dd=O,0===Ia&&g(Xa);if(dd!==O)for(;dd!==O;)Re.push(dd),Id.test(m.charAt(R))?(dd=m.charAt(R),R++):(dd=O,0===Ia&&g(Xa));else Re=O;Re!==O?(96===m.charCodeAt(R)?(dd=Gd,R++):(dd=O,0===Ia&&g(Va)),dd!==O?xc=Re.join(""):(R=xc,xc=O)):(R=xc,xc=O)}else R=xc,xc=O;var Hf=xc;if(Hf!==O){Ja();var og=Na();if(og!==O){Ja();var Se=a();Se===O&&(Se=null);
Ja();var pg=Ua();pg!==O?rd={type:"function",name:Hf,args:Se?Se:{type:"expression-list",value:[]}}:(R=rd,rd=O)}else R=rd,rd=O}else R=rd,rd=O;xb=rd;if(xb===O){var Kc;var Ob=R;var ef=Ka();if(ef!==O){Ja();var ye=b();if(ye!==O){Ja();var ze=[];for(Kc=Q();Kc!==O;)ze.push(Kc),Kc=Q();Kc=Ja();var Te=Ra();Te!==O?Ob={type:"case-expression",format:"simple",operand:ye,clauses:ze,else:null}:(R=Ob,Ob=O)}else R=Ob,Ob=O}else R=Ob,Ob=O;if(Ob===O)if(Ob=R,ef=Ka(),ef!==O)if(Ja(),ye=b(),ye!==O){Ja();ze=[];for(Kc=Q();Kc!==
O;)ze.push(Kc),Kc=Q();Kc=Ja();Te=Z();if(Te!==O){Ja();var qg=Ra();qg!==O?Ob={type:"case-expression",format:"simple",operand:ye,clauses:ze,else:Te.value}:(R=Ob,Ob=O)}else R=Ob,Ob=O}else R=Ob,Ob=O;else R=Ob,Ob=O;var ff=Ob;if(ff===O){var Lc;var Ub=R;var gf=Ka();if(gf!==O){Ja();var Ae=[];for(Lc=P();Lc!==O;)Ae.push(Lc),Lc=P();Lc=Ja();var Ue=Ra();Ue!==O?Ub={type:"case-expression",format:"searched",clauses:Ae,else:null}:(R=Ub,Ub=O)}else R=Ub,Ub=O;if(Ub===O)if(Ub=R,gf=Ka(),gf!==O){Ja();Ae=[];for(Lc=P();Lc!==
O;)Ae.push(Lc),Lc=P();Lc=Ja();Ue=Z();if(Ue!==O){Ja();var rg=Ra();rg!==O?Ub={type:"case-expression",format:"searched",clauses:Ae,else:Ue.value}:(R=Ub,Ub=O)}else R=Ub,Ub=O}else R=Ub,Ub=O;ff=Ub}xb=ff;if(xb===O){var Ve;var We=R;var If=F();if(If!==O){var Jf=[];for(Ve=I();Ve!==O;)Jf.push(Ve),Ve=I();We=If+Jf.join("")}else R=We,We=O;var Xe=We;if(Xe!==O){var hf=Xe;Xe=/^CURRENT_DATE$/i.test(hf)?{type:"current-time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(hf)?{type:"current-time",mode:"timestamp"}:{type:"column-reference",
table:"",column:hf}}xb=Xe;if(xb===O&&(xb=G(),xb===O)){xb=R;var sg=Na();if(sg!==O){Ja();var jf=b();if(jf!==O){Ja();var tg=Ua();tg!==O?(jf.paren=!0,xb=jf):(R=xb,xb=O)}else R=xb,xb=O}else R=xb,xb=O}}}}}}}}}return xb}function K(){var aa;var da=R;var ra=F();if(ra!==O){da=[];for(aa=A();aa!==O;)da.push(aa),aa=A();da=ra+da.join("")}else R=da,da=O;return da}function F(){if(pc.test(m.charAt(R))){var aa=m.charAt(R);R++}else aa=O,0===Ia&&g(Vc);return aa}function A(){if(Tc.test(m.charAt(R))){var aa=m.charAt(R);
R++}else aa=O,0===Ia&&g(md);return aa}function I(){if(kd.test(m.charAt(R))){var aa=m.charAt(R);R++}else aa=O,0===Ia&&g(Ic);return aa}function G(){var aa=R;if(64===m.charCodeAt(R)){var da=mb;R++}else da=O,0===Ia&&g(Ad);if(da!==O){var ra=K();ra!==O?aa=da=[da,ra]:(R=aa,aa=O)}else R=aa,aa=O;aa!==O&&(aa={type:"parameter",value:aa[1]});return aa}function E(){var aa=R;if(m.substr(R,7).toLowerCase()===Cc){var da=m.substr(R,7);R+=7}else da=O,0===Ia&&g(ed);if(da!==O){da=R;Ia++;var ra=A();Ia--;ra===O?da=void 0:
(R=da,da=O);da!==O?aa="LEADING":(R=aa,aa=O)}else R=aa,aa=O;aa===O&&(aa=R,m.substr(R,8).toLowerCase()===xd?(da=m.substr(R,8),R+=8):(da=O,0===Ia&&g(nb)),da!==O?(da=R,Ia++,ra=A(),Ia--,ra===O?da=void 0:(R=da,da=O),da!==O?aa="TRAILING":(R=aa,aa=O)):(R=aa,aa=O),aa===O&&(aa=R,m.substr(R,4).toLowerCase()===Dc?(da=m.substr(R,4),R+=4):(da=O,0===Ia&&g(Eb)),da!==O?(da=R,Ia++,ra=A(),Ia--,ra===O?da=void 0:(R=da,da=O),da!==O?aa="BOTH":(R=aa,aa=O)):(R=aa,aa=O)));return aa}function M(){var aa=R;var da=R;var ra=T();
if(ra!==O){Ja();var La=Na();if(La!==O)if(Ja(),La=fa(),La!==O){Ja();var Wa=Ua();Wa!==O?da={type:"interval-period",period:ra.value,precision:La,secondary:null}:(R=da,da=O)}else R=da,da=O;else R=da,da=O}else R=da,da=O;da===O&&(da=R,ra=T(),ra!==O&&(ra={type:"interval-period",period:ra.value,precision:null,secondary:null}),da=ra);if(da!==O)if(Ja(),ra=R,m.substr(R,2).toLowerCase()===qc?(La=m.substr(R,2),R+=2):(La=O,0===Ia&&g(td)),La!==O?(La=R,Ia++,Wa=A(),Ia--,Wa===O?La=void 0:(R=La,La=O),La!==O?ra="TO":
(R=ra,ra=O)):(R=ra,ra=O),ra!==O){Ja();ra=R;La=T();La!==O&&(La={type:"interval-period",period:La.value,precision:null,secondary:null});ra=La;if(ra===O){ra=R;La=Ga();if(La!==O)if(Ja(),La=Na(),La!==O)if(Ja(),La=fa(),La!==O)if(Ja(),Wa=Sa(),Wa!==O)if(Ja(),Wa=Y(),Wa!==O){Ja();var jb=Ua();jb!==O?ra={type:"interval-period",period:"second",precision:La,secondary:Wa}:(R=ra,ra=O)}else R=ra,ra=O;else R=ra,ra=O;else R=ra,ra=O;else R=ra,ra=O;else R=ra,ra=O;ra===O&&(ra=R,La=Ga(),La!==O?(Ja(),La=Na(),La!==O?(Ja(),
La=fa(),La!==O?(Ja(),Wa=Ua(),Wa!==O?ra={type:"interval-period",period:"second",precision:La,secondary:null}:(R=ra,ra=O)):(R=ra,ra=O)):(R=ra,ra=O)):(R=ra,ra=O),ra===O&&(ra=R,La=Ga(),La!==O&&(La={type:"interval-period",period:"second",precision:null,secondary:null}),ra=La))}ra!==O?aa={type:"interval-qualifier",start:da,end:ra}:(R=aa,aa=O)}else R=aa,aa=O;else R=aa,aa=O;aa===O&&(aa=R,ra=T(),ra!==O?(Ja(),da=Na(),da!==O?(Ja(),da=Y(),da!==O?(Ja(),La=Ua(),La!==O?aa={type:"interval-period",period:ra.value,
precision:da,secondary:null}:(R=aa,aa=O)):(R=aa,aa=O)):(R=aa,aa=O)):(R=aa,aa=O),aa===O&&(aa=R,ra=T(),ra!==O&&(ra={type:"interval-period",period:ra.value,precision:null,secondary:null}),aa=ra,aa===O&&(aa=R,ra=Ga(),ra!==O?(Ja(),da=Na(),da!==O?(Ja(),da=fa(),da!==O?(Ja(),La=Sa(),La!==O?(Ja(),ra=Y(),ra!==O?(Ja(),La=Ua(),La!==O?aa={type:"interval-period",period:"second",precision:da,secondary:ra}:(R=aa,aa=O)):(R=aa,aa=O)):(R=aa,aa=O)):(R=aa,aa=O)):(R=aa,aa=O)):(R=aa,aa=O),aa===O&&(aa=R,ra=Ga(),ra!==O?(Ja(),
da=Na(),da!==O?(Ja(),da=Y(),da!==O?(Ja(),La=Ua(),La!==O?aa={type:"interval-period",period:"second",precision:da,secondary:null}:(R=aa,aa=O)):(R=aa,aa=O)):(R=aa,aa=O)):(R=aa,aa=O),aa===O&&(aa=R,ra=Ga(),ra!==O&&(ra={type:"interval-period",period:"second",precision:null,secondary:null}),aa=ra)))));return aa}function T(){var aa=R;aa=ia();aa!==O&&(aa={type:"string",value:"day"});aa===O&&(aa=R,aa=na(),aa!==O&&(aa={type:"string",value:"hour"}),aa===O&&(aa=R,aa=ya(),aa!==O&&(aa={type:"string",value:"minute"}),
aa===O&&(aa=R,aa=xa(),aa!==O&&(aa={type:"string",value:"month"}),aa===O&&(aa=R,aa=ua(),aa!==O&&(aa={type:"string",value:"year"})))));return aa}function Y(){var aa=Da();aa!==O&&(aa=parseFloat(aa));return aa}function fa(){var aa=Da();aa!==O&&(aa=parseFloat(aa));return aa}function ba(){var aa=U();aa===O&&(aa=G());return aa}function U(){var aa=R;if(39===m.charCodeAt(R)){var da=wb;R++}else da=O,0===Ia&&g(Ld);da===O&&(m.substr(R,2)===Cb?(da=Cb,R+=2):(da=O,0===Ia&&g(Md)));if(da!==O){da=[];var ra=R;m.substr(R,
2)===cb?(ra=cb,R+=2):(ra=O,0===Ia&&g(nd));ra!==O&&(ra="'");ra===O&&(bc.test(m.charAt(R))?(ra=m.charAt(R),R++):(ra=O,0===Ia&&g(Bd)));for(;ra!==O;)da.push(ra),ra=R,m.substr(R,2)===cb?(ra=cb,R+=2):(ra=O,0===Ia&&g(nd)),ra!==O&&(ra="'"),ra===O&&(bc.test(m.charAt(R))?(ra=m.charAt(R),R++):(ra=O,0===Ia&&g(Bd)));39===m.charCodeAt(R)?(ra=wb,R++):(ra=O,0===Ia&&g(Ld));ra!==O?aa={type:"string",value:da.join("")}:(R=aa,aa=O)}else R=aa,aa=O;return aa}function P(){var aa=R;if(Qa()!==O){Ja();var da=b();if(da!==O){Ja();
var ra=Ta();ra!==O?(Ja(),ra=b(),ra!==O?aa={type:"when-clause",operand:da,value:ra}:(R=aa,aa=O)):(R=aa,aa=O)}else R=aa,aa=O}else R=aa,aa=O;return aa}function Q(){var aa=R;if(Qa()!==O){Ja();var da=b();if(da!==O){Ja();var ra=Ta();ra!==O?(Ja(),ra=b(),ra!==O?aa={type:"when-clause",operand:da,value:ra}:(R=aa,aa=O)):(R=aa,aa=O)}else R=aa,aa=O}else R=aa,aa=O;return aa}function Z(){var aa=R;var da=R;if(m.substr(R,4).toLowerCase()===tc){var ra=m.substr(R,4);R+=4}else ra=O,0===Ia&&g(ja);if(ra!==O){ra=R;Ia++;
var La=A();Ia--;La===O?ra=void 0:(R=ra,ra=O);ra!==O?da="ELSE":(R=da,da=O)}else R=da,da=O;da!==O?(Ja(),da=b(),da!==O?aa={type:"else-clause",value:da}:(R=aa,aa=O)):(R=aa,aa=O);return aa}function X(){var aa=Da();if(aa===O){aa=R;if(45===m.charCodeAt(R)){var da=Zb;R++}else da=O,0===Ia&&g(Hc);da===O&&(43===m.charCodeAt(R)?(da=kc,R++):(da=O,0===Ia&&g(sd)));if(da!==O){var ra=Da();ra!==O?aa=da[0]+ra:(R=aa,aa=O)}else R=aa,aa=O}return aa}function sa(){var aa=R;if(46===m.charCodeAt(R)){var da=Tb;R++}else da=
O,0===Ia&&g(pe);da!==O?(aa=Da(),aa===O&&(aa=null),aa="."+(null!=aa?aa:"")):(R=aa,aa=O);return aa}function Aa(){var aa;var da=aa=R;if(uc.test(m.charAt(R))){var ra=m.charAt(R);R++}else ra=O,0===Ia&&g(me);ra!==O?(Uc.test(m.charAt(R))?(da=m.charAt(R),R++):(da=O,0===Ia&&g(Od)),da===O&&(da=null),da="e"+(null===da?"":da)):(R=da,da=O);da!==O?(ra=Da(),ra!==O?aa=da+ra:(R=aa,aa=O)):(R=aa,aa=O);return aa}function Da(){var aa=[];var da=ha();if(da!==O)for(;da!==O;)aa.push(da),da=ha();else aa=O;aa!==O&&(aa=aa.join(""));
return aa}function ha(){if(ld.test(m.charAt(R))){var aa=m.charAt(R);R++}else aa=O,0===Ia&&g(Nd);return aa}function Ea(){var aa=R;if(m.substr(R,2).toLowerCase()===Fa){var da=m.substr(R,2);R+=2}else da=O,0===Ia&&g(vc);if(da!==O){da=R;Ia++;var ra=A();Ia--;ra===O?da=void 0:(R=da,da=O);da!==O?aa="IN":(R=aa,aa=O)}else R=aa,aa=O;return aa}function za(){var aa=R;if(m.substr(R,2).toLowerCase()===Oa){var da=m.substr(R,2);R+=2}else da=O,0===Ia&&g(Qd);if(da!==O){da=R;Ia++;var ra=A();Ia--;ra===O?da=void 0:(R=
da,da=O);da!==O?aa="IS":(R=aa,aa=O)}else R=aa,aa=O;return aa}function N(){var aa=R;if(m.substr(R,4).toLowerCase()===Pa){var da=m.substr(R,4);R+=4}else da=O,0===Ia&&g(Rd);if(da!==O){da=R;Ia++;var ra=A();Ia--;ra===O?da=void 0:(R=da,da=O);da!==O?aa="LIKE":(R=aa,aa=O)}else R=aa,aa=O;return aa}function S(){var aa=R;if(m.substr(R,3).toLowerCase()===$a){var da=m.substr(R,3);R+=3}else da=O,0===Ia&&g(Xc);if(da!==O){da=R;Ia++;var ra=A();Ia--;ra===O?da=void 0:(R=da,da=O);da!==O?aa="NOT":(R=aa,aa=O)}else R=aa,
aa=O;return aa}function ea(){var aa=R;if(m.substr(R,3).toLowerCase()===sb){var da=m.substr(R,3);R+=3}else da=O,0===Ia&&g(Td);if(da!==O){da=R;Ia++;var ra=A();Ia--;ra===O?da=void 0:(R=da,da=O);da!==O?aa="AND":(R=aa,aa=O)}else R=aa,aa=O;return aa}function oa(){var aa=R;if(m.substr(R,2).toLowerCase()===ob){var da=m.substr(R,2);R+=2}else da=O,0===Ia&&g(Cd);if(da!==O){da=R;Ia++;var ra=A();Ia--;ra===O?da=void 0:(R=da,da=O);da!==O?aa="OR":(R=aa,aa=O)}else R=aa,aa=O;return aa}function va(){var aa=R;if(m.substr(R,
7).toLowerCase()===qb){var da=m.substr(R,7);R+=7}else da=O,0===Ia&&g(lc);if(da!==O){da=R;Ia++;var ra=A();Ia--;ra===O?da=void 0:(R=da,da=O);da!==O?aa="BETWEEN":(R=aa,aa=O)}else R=aa,aa=O;return aa}function W(){var aa=R;if(m.substr(R,4).toLowerCase()===vb){var da=m.substr(R,4);R+=4}else da=O,0===Ia&&g(Jc);if(da!==O){da=R;Ia++;var ra=A();Ia--;ra===O?da=void 0:(R=da,da=O);da!==O?aa="FROM":(R=aa,aa=O)}else R=aa,aa=O;return aa}function ca(){var aa=R;if(m.substr(R,4).toLowerCase()===wd){var da=m.substr(R,
4);R+=4}else da=O,0===Ia&&g(qd);if(da!==O){da=R;Ia++;var ra=A();Ia--;ra===O?da=void 0:(R=da,da=O);da!==O?aa="TRIM":(R=aa,aa=O)}else R=aa,aa=O;return aa}function ka(){var aa=R;if(m.substr(R,9).toLowerCase()===Bc){var da=m.substr(R,9);R+=9}else da=O,0===Ia&&g(Ud);if(da!==O){da=R;Ia++;var ra=A();Ia--;ra===O?da=void 0:(R=da,da=O);da!==O?aa="TIMESTAMP":(R=aa,aa=O)}else R=aa,aa=O;return aa}function la(){var aa=R;if(m.substr(R,4).toLowerCase()===gd){var da=m.substr(R,4);R+=4}else da=O,0===Ia&&g(mc);if(da!==
O){da=R;Ia++;var ra=A();Ia--;ra===O?da=void 0:(R=da,da=O);da!==O?aa="DATE":(R=aa,aa=O)}else R=aa,aa=O;return aa}function ma(){var aa=R;if(m.substr(R,8).toLowerCase()===ac){var da=m.substr(R,8);R+=8}else da=O,0===Ia&&g(ud);if(da!==O){da=R;Ia++;var ra=A();Ia--;ra===O?da=void 0:(R=da,da=O);da!==O?aa="INTERVAL":(R=aa,aa=O)}else R=aa,aa=O;return aa}function ua(){var aa=R;if(m.substr(R,4).toLowerCase()===id){var da=m.substr(R,4);R+=4}else da=O,0===Ia&&g(Ac);if(da!==O){da=R;Ia++;var ra=A();Ia--;ra===O?da=
void 0:(R=da,da=O);da!==O?aa="YEAR":(R=aa,aa=O)}else R=aa,aa=O;return aa}function xa(){var aa=R;if(m.substr(R,5).toLowerCase()===Fc){var da=m.substr(R,5);R+=5}else da=O,0===Ia&&g(fd);if(da!==O){da=R;Ia++;var ra=A();Ia--;ra===O?da=void 0:(R=da,da=O);da!==O?aa="MONTH":(R=aa,aa=O)}else R=aa,aa=O;return aa}function ia(){var aa=R;if(m.substr(R,3).toLowerCase()===Pb){var da=m.substr(R,3);R+=3}else da=O,0===Ia&&g(qe);if(da!==O){da=R;Ia++;var ra=A();Ia--;ra===O?da=void 0:(R=da,da=O);da!==O?aa="DAY":(R=aa,
aa=O)}else R=aa,aa=O;return aa}function na(){var aa=R;if(m.substr(R,4).toLowerCase()===Fd){var da=m.substr(R,4);R+=4}else da=O,0===Ia&&g(Vd);if(da!==O){da=R;Ia++;var ra=A();Ia--;ra===O?da=void 0:(R=da,da=O);da!==O?aa="HOUR":(R=aa,aa=O)}else R=aa,aa=O;return aa}function ya(){var aa=R;if(m.substr(R,6).toLowerCase()===Rb){var da=m.substr(R,6);R+=6}else da=O,0===Ia&&g(fb);if(da!==O){da=R;Ia++;var ra=A();Ia--;ra===O?da=void 0:(R=da,da=O);da!==O?aa="MINUTE":(R=aa,aa=O)}else R=aa,aa=O;return aa}function Ga(){var aa=
R;if(m.substr(R,6).toLowerCase()===Vb){var da=m.substr(R,6);R+=6}else da=O,0===Ia&&g(Fb);if(da!==O){da=R;Ia++;var ra=A();Ia--;ra===O?da=void 0:(R=da,da=O);da!==O?aa="SECOND":(R=aa,aa=O)}else R=aa,aa=O;return aa}function Ka(){var aa=R;if(m.substr(R,4).toLowerCase()===Mc){var da=m.substr(R,4);R+=4}else da=O,0===Ia&&g(Mb);if(da!==O){da=R;Ia++;var ra=A();Ia--;ra===O?da=void 0:(R=da,da=O);da!==O?aa="CASE":(R=aa,aa=O)}else R=aa,aa=O;return aa}function Ra(){var aa=R;if(m.substr(R,3).toLowerCase()===Gc){var da=
m.substr(R,3);R+=3}else da=O,0===Ia&&g(ab);if(da!==O){da=R;Ia++;var ra=A();Ia--;ra===O?da=void 0:(R=da,da=O);da!==O?aa="END":(R=aa,aa=O)}else R=aa,aa=O;return aa}function Qa(){var aa=R;if(m.substr(R,4).toLowerCase()===jd){var da=m.substr(R,4);R+=4}else da=O,0===Ia&&g(L);if(da!==O){da=R;Ia++;var ra=A();Ia--;ra===O?da=void 0:(R=da,da=O);da!==O?aa="WHEN":(R=aa,aa=O)}else R=aa,aa=O;return aa}function Ta(){var aa=R;if(m.substr(R,4).toLowerCase()===oe){var da=m.substr(R,4);R+=4}else da=O,0===Ia&&g(V);if(da!==
O){da=R;Ia++;var ra=A();Ia--;ra===O?da=void 0:(R=da,da=O);da!==O?aa="THEN":(R=aa,aa=O)}else R=aa,aa=O;return aa}function Sa(){if(44===m.charCodeAt(R)){var aa=tb;R++}else aa=O,0===Ia&&g(ta);return aa}function Na(){if(40===m.charCodeAt(R)){var aa=Sc;R++}else aa=O,0===Ia&&g(Ba);return aa}function Ua(){if(41===m.charCodeAt(R)){var aa=Kb;R++}else aa=O,0===Ia&&g(Ha);return aa}function Ja(){var aa;var da=[];for(aa=rb();aa!==O;)da.push(aa),aa=rb();return da}function rb(){if(Gb.test(m.charAt(R))){var aa=m.charAt(R);
R++}else aa=O,0===Ia&&g(Ma);return aa}function hb(aa,da,ra,La){aa={type:"binary-expression",operator:aa,left:da,right:ra};void 0!==La&&(aa.escape=La);return aa}function db(aa,da){for(var ra=0;ra<da.length;ra++)aa=hb(da[ra][1],aa,da[ra][3]);return aa}h=void 0!==h?h:{};var O={},eb=h.grammarSource,Za={start:e},pb=e,Ab="!",ib="\x3d",Wb="\x3e\x3d",Ca="\x3e",Xb="\x3c\x3d",Yb="\x3c\x3e",Jb="\x3c",Qb="!\x3d",kc="+",Zb="-",$b="||",Lb="*",ub="/",mb="@",wb="'",Cb="N'",cb="''",Tb=".",pa="null",wa="true",qa="false",
Fa="in",Oa="is",Pa="like",Ya="escape",$a="not",sb="and",ob="or",qb="between",vb="from",Db="for",vd="substring",rc="extract",wd="trim",sc="position",Bc="timestamp",gd="date",Cc="leading",xd="trailing",Dc="both",ne="cast",hd="as",Qc="integer",Rc="smallint",Ec="float",nc="real",yd="varchar",qc="to",ac="interval",id="year",Fc="month",Pb="day",Fd="hour",Rb="minute",Vb="second",Mc="case",Gc="end",jd="when",oe="then",tc="else",tb=",",Sc="(",Kb=")",Gd="`",pc=/^[A-Za-z_\x80-\uFFFF]/,Tc=/^[A-Za-z0-9_]/,kd=
/^[A-Za-z0-9_.\x80-\uFFFF]/,bc=/^[^']/,ld=/^[0-9]/,uc=/^[eE]/,Uc=/^[+\-]/,Gb=/^[ \t\n\r]/,Id=/^[^`]/,Hd=c("!",!1),yc=c("\x3d",!1),ic=c("\x3e\x3d",!1),hc=c("\x3e",!1),gc=c("\x3c\x3d",!1),zd=c("\x3c\x3e",!1),Jd=c("\x3c",!1),le=c("!\x3d",!1),sd=c("+",!1),Hc=c("-",!1),Bb=c("||",!1),zb=c("*",!1),Sb=c("/",!1),Vc=d([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),md=d([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),Ic=d([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],!1,!1),Ad=c("@",!1),Ld=c("'",
!1),Md=c("N'",!1),nd=c("''",!1),Bd=d(["'"],!0,!1),pe=c(".",!1),Nd=d([["0","9"]],!1,!1),me=d(["e","E"],!1,!1),Od=d(["+","-"],!1,!1),Pd=c("NULL",!0),Wc=c("TRUE",!0),od=c("FALSE",!0),vc=c("IN",!0),Qd=c("IS",!0),Rd=c("LIKE",!0),Sd=c("ESCAPE",!0),Xc=c("NOT",!0),Td=c("AND",!0),Cd=c("OR",!0),lc=c("BETWEEN",!0),Jc=c("FROM",!0),Yc=c("FOR",!0),pd=c("SUBSTRING",!0),Dd=c("EXTRACT",!0),qd=c("TRIM",!0),Zc=c("POSITION",!0),Ud=c("TIMESTAMP",!0),mc=c("DATE",!0),ed=c("LEADING",!0),nb=c("TRAILING",!0),Eb=c("BOTH",!0),
$c=c("CAST",!0),Nc=c("AS",!0),jc=c("INTEGER",!0),Oc=c("SMALLINT",!0),oc=c("FLOAT",!0),Pc=c("REAL",!0),Kd=c("VARCHAR",!0),td=c("TO",!0),ud=c("INTERVAL",!0),Ac=c("YEAR",!0),fd=c("MONTH",!0),qe=c("DAY",!0),Vd=c("HOUR",!0),fb=c("MINUTE",!0),Fb=c("SECOND",!0),Mb=c("CASE",!0),ab=c("END",!0),L=c("WHEN",!0),V=c("THEN",!0),ja=c("ELSE",!0),ta=c(",",!1),Ba=c("(",!1),Ha=c(")",!1),Ma=d([" ","\t","\n","\r"],!1,!1),Va=c("`",!1),Xa=d(["`"],!0,!1),R=0,bb=[{line:1,column:1}],gb=0,kb=[],Ia=0;if("startRule"in h){if(!(h.startRule in
Za))throw Error("Can't start parsing from rule \""+h.startRule+'".');pb=Za[h.startRule]}var zc=pb();if(zc!==O&&R===m.length)return zc;zc!==O&&R<m.length&&g({type:"end"});throw function(aa,da,ra){return new y(y.buildMessage(aa,da),aa,da,ra)}(kb,gb<m.length?m.charAt(gb):null,gb<m.length?k(gb,gb+1):k(gb,gb));}}})})({get exports(){return H},set exports(w){H=w}});let C=function(){function w(){}w.parse=function(y){return H.parse(y)};return w}();u.WhereGrammar=C;Object.defineProperty(u,Symbol.toStringTag,
{value:"Module"})})},"esri/chunks/_commonjsHelpers":function(){define(["exports"],function(u){u.commonjsGlobal="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{};u.getDefaultExportFromCjs=function(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t["default"]:t}})},"esri/layers/graphics/data/projectionSupport":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),
function(u,t,H,C,w,y,x){function m(a,b){if(!b)return null;if("x"in b){var l={x:0,y:0};[l.x,l.y]=a(b.x,b.y,f);null!=b.z&&(l.z=b.z);null!=b.m&&(l.m=b.m);return l}return"xmin"in b?(l={xmin:0,ymin:0,xmax:0,ymax:0},[l.xmin,l.ymin]=a(b.xmin,b.ymin,f),[l.xmax,l.ymax]=a(b.xmax,b.ymax,f),b.hasZ&&(l.zmin=b.zmin,l.zmax=b.zmax,l.hasZ=!0),b.hasM&&(l.mmin=b.mmin,l.mmax=b.mmax,l.hasM=!0),l):"rings"in b?{rings:h(b.rings,a),hasM:b.hasM,hasZ:b.hasZ}:"paths"in b?{paths:h(b.paths,a),hasM:b.hasM,hasZ:b.hasZ}:"points"in
b?{points:c(b.points,a),hasM:b.hasM,hasZ:b.hasZ}:null}function h(a,b){const l=[];for(const q of a)l.push(c(q,b));return l}function c(a,b){const l=[];for(const q of a)a=b(q[0],q[1],[0,0]),l.push(a),2<q.length&&a.push(q[2]),3<q.length&&a.push(q[3]);return l}function d(){d=t._asyncToGenerator(function*(a,b){a&&b&&(a=Array.isArray(a)?a.map(l=>H.isSome(l.geometry)?l.geometry.spatialReference:null).filter(H.isSome):[a],yield C.initializeProjection(a.map(l=>({source:l,dest:b}))))});return d.apply(this,arguments)}
const f=[0,0],k=m.bind(null,x.lngLatToXY),g=m.bind(null,x.xyToLngLat),e=new (function(){function a(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}var b=a.prototype;b.push=function(){var l=t._asyncToGenerator(function*(q,n,v){if(!(q&&q.length&&n&&v)||y.equals(n,v))return q;const B={geometries:q,inSpatialReference:n,outSpatialReference:v,resolve:null};this._jobs.push(B);return new Promise(z=>{B.resolve=z;null===this._timer&&(this._timer=setTimeout(this._process,10))})});return function(q,
n,v){return l.apply(this,arguments)}}();b._process=function(){this._timer=null;const l=this._jobs.shift();if(l){var {geometries:q,inSpatialReference:n,outSpatialReference:v,resolve:B}=l;x.canProject(n,v)?y.isWebMercator(v)?B(q.map(k)):B(q.map(g)):B(C.projectMany(w.jsonAdapter,q,n,v,null,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return a}());u.checkProjectionSupport=function(a,b){return d.apply(this,arguments)};u.project=function(a,b,l,q){if(!a)return a;l||(l=b,b=a.spatialReference);
return y.isValid(b)&&y.isValid(l)&&!y.equals(b,l)?x.canProject(b,l)?(a=y.isWebMercator(l)?k(a):g(a),a.spatialReference=l,a):C.projectMany(w.jsonAdapter,[a],b,l,null,q)[0]:a};u.projectMany=function(a,b,l){return e.push(a,b,l)};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/projection":function(){define("require exports ../chunks/_rollupPluginBabelHelpers ../core/Error ../core/mathUtils ../core/maybe ../core/promiseUtils ../core/unitUtils ../core/accessorSupport/tracking ../core/accessorSupport/tracking/SimpleObservable ../chunks/mat4 ../chunks/vec3 ../chunks/vec3f64 ./ellipsoidUtils ./Extent ./Multipoint ../chunks/pe ./Point ./Polygon ./Polyline ./support/aaBoundingRect ./support/Ellipsoid ./support/geodesicConstants ./support/GeographicTransformation ./support/spatialReferenceUtils ./support/SupportedGCSWkids ./support/zscale".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f,k,g,e,a,b,l,q,n,v,B,z,p,r,D,J){function K(){return!!eb&&b.isLoaded()}function F(pa){y.isNone(pb)&&(pb=Promise.all([b.load(),(new Promise((wa,qa)=>u(["../chunks/geometryEngineBase"],wa,qa))).then(wa=>wa.geometryEngineBase),new Promise((wa,qa)=>u(["./geometryAdapters/hydrated"],wa,qa))]));return pb.then(([,wa,{hydratedAdapter:qa}])=>{x.throwIfAborted(pa);Za=qa;eb=wa.default;eb._enableProjection(b.pe);ib.notify()})}function A(pa,wa,qa=null,Fa=null){return Array.isArray(pa)?
0===pa.length?[]:I(Za,pa,pa[0].spatialReference,wa,qa,Fa):I(Za,[pa],pa.spatialReference,wa,qa,Fa)[0]}function I(pa,wa,qa,Fa,Oa=null,Pa=null){if(y.isNone(qa)||y.isNone(Fa))return wa;if(T(qa,Fa,Oa))return wa.map(Ya=>y.unwrap(fa(Ya,qa,Fa)));if(y.isNone(Oa)){const Ya=p.cacheKey(qa,Fa);void 0!==Ab[Ya]?Oa=Ab[Ya]:(Oa=E(qa,Fa,void 0),y.isNone(Oa)&&(Oa=new p),Ab[Ya]=Oa)}if(y.isNone(eb)||y.isNone(pa))throw new Wb;return y.isSome(Pa)?eb._project(pa,wa,qa,Fa,Oa,Pa):eb._project(pa,wa,qa,Fa,Oa)}function G(pa,wa){if(!K())for(const qa of pa)if(y.isSome(qa)&&
!r.equals(qa.spatialReference,wa)&&r.isValid(qa.spatialReference)&&r.isValid(wa)&&!T(qa.spatialReference,wa))return h.trackAccess(ib),{pending:F(),geometries:null};return{pending:null,geometries:pa.map(qa=>y.isNone(qa)?null:r.equals(qa.spatialReference,wa)?qa:r.isValid(qa.spatialReference)&&r.isValid(wa)?M(qa,wa):null)}}function E(pa,wa,qa=null){if(y.isNone(pa)||y.isNone(wa))return null;if(y.isNone(eb)||y.isNone(Za))throw new Wb;pa=eb._getTransformation(Za,pa,wa,qa,qa?.spatialReference);return null!==
pa?p.fromGE(pa):null}function M(pa,wa){try{const qa=A(pa,wa);if(null==qa)return null;"xmin"in pa&&"xmin"in qa&&(qa.zmin=pa.zmin,qa.zmax=pa.zmax);const Fa=J.getGeometryZScaler(qa.type,pa.spatialReference,wa);y.isSome(Fa)&&Fa(qa);return qa}catch(qa){if(!(qa instanceof Wb))throw qa;return null}}function T(pa,wa,qa){return qa?!1:r.equals(pa,wa)?!0:r.isValid(pa)&&r.isValid(wa)&&!!hb(pa,wa,Zb)}function Y(){Y=H._asyncToGenerator(function*(pa,wa,qa,Fa){if(K())return x.waitTick(Fa);if(Array.isArray(pa))for(const {source:Oa,
dest:Pa,geographicTransformation:Ya}of pa){if(!T(Oa,Pa,Ya))return F(Fa)}else if(!T(pa,wa,qa))return F(Fa);return x.waitTick(Fa)});return Y.apply(this,arguments)}function fa(pa,wa,qa){return pa?"x"in pa?ba(pa,wa,new l,qa,0):"xmin"in pa?Z(pa,wa,new e,qa,0):"rings"in pa?Q(pa,wa,new q,qa,0):"paths"in pa?P(pa,wa,new n,qa,0):"points"in pa?U(pa,wa,new a,qa,0):null:null}function ba(pa,wa,qa,Fa,Oa){cb[0]=pa.x;cb[1]=pa.y;const Pa=pa.z;cb[2]=void 0!==Pa?Pa:Oa;if(!Da(cb,wa,0,cb,Fa,0,1))return null;qa.x=cb[0];
qa.y=cb[1];qa.spatialReference=Fa;void 0===Pa?(qa.z=void 0,qa.hasZ=!1):(qa.z=cb[2],qa.hasZ=!0);void 0===pa.m?(qa.m=void 0,qa.hasM=!1):(qa.m=pa.m,qa.hasM=!0);return qa}function U(pa,wa,qa,Fa,Oa){const {points:Pa,hasZ:Ya,hasM:$a}=pa;pa=[];const sb=Pa.length,ob=[];for(var qb of Pa)ob.push(qb[0],qb[1],Ya?qb[2]:Oa);if(!Da(ob,wa,0,ob,Fa,0,sb))return null;for(wa=0;wa<sb;++wa){Oa=3*wa;qb=ob[Oa];const vb=ob[Oa+1];Ya&&$a?pa.push([qb,vb,ob[Oa+2],Pa[wa][3]]):Ya?pa.push([qb,vb,ob[Oa+2]]):$a?pa.push([qb,vb,Pa[wa][2]]):
pa.push([qb,vb])}qa.points=pa;qa.spatialReference=Fa;qa.hasZ=Ya;qa.hasM=$a;return qa}function P(pa,wa,qa,Fa,Oa){const {paths:Pa,hasZ:Ya,hasM:$a}=pa;pa=[];if(!ha(Pa,Ya??!1,$a??!1,wa,pa,Fa,Oa))return null;qa.paths=pa;qa.spatialReference=Fa;qa.hasZ=Ya;qa.hasM=$a;return qa}function Q(pa,wa,qa,Fa,Oa){const {rings:Pa,hasZ:Ya,hasM:$a}=pa;pa=[];if(!ha(Pa,Ya??!1,$a??!1,wa,pa,Fa,Oa))return null;qa.rings=pa;qa.spatialReference=Fa;qa.hasZ=Ya;qa.hasM=$a;return qa}function Z(pa,wa,qa,Fa,Oa){const {xmin:Pa,ymin:Ya,
xmax:$a,ymax:sb,hasZ:ob,hasM:qb}=pa;if(!X(Pa,Ya,ob?pa.zmin:Oa,wa,cb,Fa))return null;qa.xmin=cb[0];qa.ymin=cb[1];ob&&(qa.zmin=cb[2]);if(!X($a,sb,ob?pa.zmax:Oa,wa,cb,Fa))return null;qa.xmax=cb[0];qa.ymax=cb[1];ob&&(qa.zmax=cb[2]);qb&&(qa.mmin=pa.mmin,qa.mmax=pa.mmax);qa.spatialReference=Fa;return qa}function X(pa,wa,qa,Fa,Oa,Pa){mb[0]=pa;mb[1]=wa;mb[2]=qa;return Da(mb,Fa,0,Oa,Pa,0,1)}function sa(pa,wa,qa,Fa){if(y.isNone(wa)||y.isNone(Fa)||2>pa.length)return!1;2===pa.length&&(mb[0]=pa[0],mb[1]=pa[1],
mb[2]=0,pa=mb);return Da(pa,wa,0,qa,Fa,0,1)}function Aa(pa,wa,qa){if(y.isNone(wa))return!1;wa=S(wa,Qb);wa=Jb[wa][Ca.WGS84_COMPARABLE_LON_LAT];if(y.isNone(wa))return!1;wa(pa,0,mb,0);qa!==mb&&(qa[0]=mb[0],qa[1]=mb[1],2<qa.length&&(qa[2]=mb[2]));return!0}function Da(pa,wa,qa,Fa,Oa,Pa,Ya=1){wa=hb(wa,Oa,Zb);if(y.isNone(wa))return!1;if(wa===ea){if(pa===Fa&&qa===Pa)return!0;Ya=qa+3*Ya;for(let $a=qa,sb=Pa;$a<Ya;$a++,sb++)Fa[sb]=pa[$a];return!0}Ya=qa+3*Ya;for(let $a=qa,sb=Pa;$a<Ya;$a+=3,sb+=3)wa(pa,$a,Fa,
sb);return!0}function ha(pa,wa,qa,Fa,Oa,Pa,Ya=0){const $a=[];for(const sb of pa)for(const ob of sb)$a.push(ob[0],ob[1],wa?ob[2]:Ya);if(!Da($a,Fa,0,$a,Pa,0,$a.length/3))return!1;Fa=0;Oa.length=0;for(const sb of pa){pa=[];for(const ob of sb)wa&&qa?pa.push([$a[Fa++],$a[Fa++],$a[Fa++],ob[3]]):wa?pa.push([$a[Fa++],$a[Fa++],$a[Fa++]]):(qa?pa.push([$a[Fa++],$a[Fa++],ob[2]]):pa.push([$a[Fa++],$a[Fa++]]),Fa++);Oa.push(pa)}return!0}function Ea(pa,wa,qa,Fa){wa=Fa+wa;if(wa<Fa/2||qa>wa)return Number.MAX_VALUE;
pa=Math.abs(Lb*pa)+Math.asin(qa/wa);return pa>=Math.PI/2?Number.MAX_VALUE:qa/Math.cos(pa)}function za(pa,wa,qa){const Fa=Math.sin(pa);pa=Math.cos(pa);const Oa=Math.sin(wa);wa=Math.cos(wa);qa[0]=-Fa;qa[4]=-Oa*pa;qa[8]=wa*pa;qa[12]=0;qa[1]=pa;qa[5]=-Oa*Fa;qa[9]=wa*Fa;qa[13]=0;qa[2]=0;qa[6]=wa;qa[10]=Oa;qa[14]=0;qa[3]=0;qa[7]=0;qa[11]=0;qa[15]=1;return qa}function N(pa,wa,qa){za(pa,wa,qa);d.transpose(qa,qa);return qa}function S(pa,wa){if(!pa)return Ca.UNKNOWN;if(wa.spatialReference===pa)return wa.spatialReferenceId;
wa.spatialReference=pa;"metersPerUnit"in wa&&(wa.metersPerUnit=m.getMetersPerUnitForSR(pa,1));return pa.wkt===g.SphericalECEFSpatialReferenceLike.wkt?wa.spatialReferenceId=Ca.SPHERICAL_ECEF:r.isWGS84(pa)?wa.spatialReferenceId=Ca.WGS84:r.isWebMercator(pa)?wa.spatialReferenceId=Ca.WEB_MERCATOR:r.isPlateCarree(pa)?wa.spatialReferenceId=Ca.PLATE_CARREE:pa.wkt===g.WGS84ECEFSpatialReferenceLike.wkt?wa.spatialReferenceId=Ca.WGS84_ECEF:pa.wkid===D.SupportedGCSWkids.CGCS2000?wa.spatialReferenceId=Ca.CGCS2000:
pa.wkt===g.SphericalPCPFMarsLike.wkt?wa.spatialReferenceId=Ca.SPHERICAL_MARS_PCPF:pa.wkt===g.SphericalPCPFMoonLike.wkt?wa.spatialReferenceId=Ca.SPHERICAL_MOON_PCPF:r.isMars(pa)?wa.spatialReferenceId=Ca.GCSMARS2000:r.isMoon(pa)?wa.spatialReferenceId=Ca.GCSMOON2000:wa.spatialReferenceId=Ca.UNKNOWN}function ea(pa,wa,qa,Fa){pa!==qa&&(qa[Fa++]=pa[wa++],qa[Fa++]=pa[wa++],qa[Fa]=pa[wa])}function oa(pa,wa,qa,Fa){qa[Fa++]=ub*(pa[wa++]/B.earth.radius);qa[Fa++]=ub*(Math.PI/2-2*Math.atan(Math.exp(-pa[wa++]/B.earth.radius)));
qa[Fa]=pa[wa]}function va(pa,wa,qa,Fa){oa(pa,wa,qa,Fa);ya(qa,Fa,qa,Fa)}function W(pa,wa,qa,Fa){oa(pa,wa,qa,Fa);Na(qa,Fa,qa,Fa)}function ca(pa,wa,qa,Fa,Oa){var Pa=.4999999*Math.PI;Pa=w.clamp(Lb*pa[wa+1],-Pa,Pa);Pa=Math.sin(Pa);qa[Fa++]=Lb*pa[wa]*Oa.radius;qa[Fa++]=Oa.halfSemiMajorAxis*Math.log((1+Pa)/(1-Pa));qa[Fa]=pa[wa+2]}function ka(pa,wa,qa,Fa){ca(pa,wa,qa,Fa,B.earth)}function la(pa,wa,qa,Fa){qa[Fa]=pa[wa]*Xb;qa[Fa+1]=pa[wa+1]*Xb;qa[Fa+2]=pa[wa+2]}function ma(pa,wa,qa,Fa){qa[Fa]=pa[wa]*Yb;qa[Fa+
1]=pa[wa+1]*Yb;qa[Fa+2]=pa[wa+2]}function ua(pa,wa,qa,Fa){oa(pa,wa,qa,Fa);la(qa,Fa,qa,Fa)}function xa(pa,wa,qa,Fa,Oa){Oa+=pa[wa+2];const Pa=Lb*pa[wa+1];pa=Lb*pa[wa];wa=Math.cos(Pa);qa[Fa++]=Math.cos(pa)*wa*Oa;qa[Fa++]=Math.sin(pa)*wa*Oa;qa[Fa]=Math.sin(Pa)*Oa}function ia(pa,wa,qa,Fa){xa(pa,wa,qa,Fa,B.moon.radius)}function na(pa,wa,qa,Fa){xa(pa,wa,qa,Fa,B.mars.radius)}function ya(pa,wa,qa,Fa){xa(pa,wa,qa,Fa,B.earth.radius)}function Ga(pa,wa,qa,Fa,Oa){var Pa=pa[wa];const Ya=pa[wa+1];wa=pa[wa+2];pa=
Math.sqrt(Pa*Pa+Ya*Ya+wa*wa);wa=w.asinClamped(wa/(0===pa?1:pa));Pa=Math.atan2(Ya,Pa);qa[Fa++]=ub*Pa;qa[Fa++]=ub*wa;qa[Fa]=pa-Oa}function Ka(pa,wa,qa,Fa){Ga(pa,wa,qa,Fa,B.moon.radius)}function Ra(pa,wa,qa,Fa){Ga(pa,wa,qa,Fa,B.mars.radius)}function Qa(pa,wa,qa,Fa){Ga(pa,wa,qa,Fa,B.earth.radius)}function Ta(pa,wa,qa,Fa){Qa(pa,wa,qa,Fa);ka(qa,Fa,qa,Fa)}function Sa(pa,wa,qa,Fa){Qa(pa,wa,qa,Fa);Na(qa,Fa,qa,Fa)}function Na(pa,wa,qa,Fa){var Oa=B.earth;const Pa=Lb*pa[wa];var Ya=Lb*pa[wa+1];pa=pa[wa+2];wa=
Math.sin(Ya);Ya=Math.cos(Ya);const $a=Oa.radius/Math.sqrt(1-Oa.eccentricitySquared*wa*wa);qa[Fa++]=($a+pa)*Ya*Math.cos(Pa);qa[Fa++]=($a+pa)*Ya*Math.sin(Pa);qa[Fa++]=($a*(1-Oa.eccentricitySquared)+pa)*wa}function Ua(pa,wa,qa,Fa){var Oa=z.earthEllipsoidConstants,Pa=pa[wa],Ya=pa[wa+1];pa=pa[wa+2];let $a;wa=Math.abs(pa);var sb=Pa*Pa+Ya*Ya;var ob=Math.sqrt(sb);var qb=sb+pa*pa;var vb=Math.sqrt(qb);Pa=Math.atan2(Ya,Pa);var Db=pa*pa/qb;qb=sb/qb;Ya=Oa.a2/vb;sb=Oa.a3-Oa.a4/vb;.3<qb?(Db=wa/vb*(1+qb*(Oa.a1+Ya+
Db*sb)/vb),vb=Math.asin(Db),Ya=Db*Db,qb=Math.sqrt(1-Ya)):(qb=ob/vb*(1-Db*(Oa.a5-Ya-qb*sb)/vb),vb=Math.acos(qb),Ya=1-qb*qb,Db=Math.sqrt(Ya));$a=1-B.earth.eccentricitySquared*Ya;Ya=B.earth.radius/Math.sqrt($a);Oa=Oa.a6*Ya;Ya=ob-Ya*qb;sb=wa-Oa*Db;wa=qb*Ya+Db*sb;ob=qb*sb-Db*Ya;Oa=ob/(Oa/$a+wa);vb+=Oa;0>pa&&(vb=-vb);qa[Fa++]=ub*Pa;qa[Fa++]=ub*vb;qa[Fa]=wa+ob*Oa/2}function Ja(pa,wa,qa,Fa){Ua(pa,wa,qa,Fa);ya(qa,Fa,qa,Fa)}function rb(pa,wa,qa,Fa){Ua(pa,wa,qa,Fa);ka(qa,Fa,qa,Fa)}function hb(pa,wa,qa=O()){return y.isNone(pa)||
y.isNone(wa)?null:db(pa,wa,qa).projector}function db(pa,wa,qa){if(y.isNone(pa)||y.isNone(wa)||qa.source.spatialReference===pa&&qa.dest.spatialReference===wa)return qa;const Fa=S(pa,qa.source),Oa=S(wa,qa.dest);Fa===Ca.UNKNOWN&&Oa===Ca.UNKNOWN?r.equals(pa,wa)?qa.projector=ea:qa.projector=null:qa.projector=Jb[Fa][Oa];return qa}function O(){return{source:{spatialReference:null,spatialReferenceId:Ca.UNKNOWN,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:Ca.UNKNOWN,metersPerUnit:1},projector:ea}}
let eb=null,Za=null,pb=null,Ab={};const ib=new c.SimpleObservable;let Wb=function(pa){function wa(){return pa.call(this,"projection:not-loaded","projection engine not fully loaded yet, please call load()")||this}H._inheritsLoose(wa,pa);return wa}(C);var Ca;(function(pa){pa[pa.UNKNOWN=0]="UNKNOWN";pa[pa.SPHERICAL_ECEF=1]="SPHERICAL_ECEF";pa[pa.WGS84=2]="WGS84";pa[pa.WEB_MERCATOR=3]="WEB_MERCATOR";pa[pa.WGS84_ECEF=4]="WGS84_ECEF";pa[pa.CGCS2000=5]="CGCS2000";pa[pa.WGS84_COMPARABLE_LON_LAT=6]="WGS84_COMPARABLE_LON_LAT";
pa[pa.SPHERICAL_MARS_PCPF=7]="SPHERICAL_MARS_PCPF";pa[pa.GCSMARS2000=8]="GCSMARS2000";pa[pa.SPHERICAL_MOON_PCPF=9]="SPHERICAL_MOON_PCPF";pa[pa.GCSMOON2000=10]="GCSMOON2000";pa[pa.LON_LAT=11]="LON_LAT";pa[pa.PLATE_CARREE=12]="PLATE_CARREE"})(Ca||(Ca={}));const Xb=B.earth.radius*Math.PI/180,Yb=180/(B.earth.radius*Math.PI),Jb={[Ca.WGS84]:{[Ca.CGCS2000]:null,[Ca.GCSMARS2000]:null,[Ca.GCSMOON2000]:null,[Ca.LON_LAT]:ea,[Ca.WGS84_COMPARABLE_LON_LAT]:ea,[Ca.SPHERICAL_ECEF]:ya,[Ca.SPHERICAL_MARS_PCPF]:null,
[Ca.SPHERICAL_MOON_PCPF]:null,[Ca.UNKNOWN]:null,[Ca.WEB_MERCATOR]:ka,[Ca.PLATE_CARREE]:la,[Ca.WGS84]:ea,[Ca.WGS84_ECEF]:Na},[Ca.CGCS2000]:{[Ca.CGCS2000]:ea,[Ca.GCSMARS2000]:null,[Ca.GCSMOON2000]:null,[Ca.LON_LAT]:ea,[Ca.WGS84_COMPARABLE_LON_LAT]:ea,[Ca.SPHERICAL_ECEF]:ya,[Ca.SPHERICAL_MARS_PCPF]:null,[Ca.SPHERICAL_MOON_PCPF]:null,[Ca.UNKNOWN]:null,[Ca.WEB_MERCATOR]:null,[Ca.PLATE_CARREE]:la,[Ca.WGS84]:null,[Ca.WGS84_ECEF]:Na},[Ca.GCSMARS2000]:{[Ca.CGCS2000]:null,[Ca.GCSMARS2000]:ea,[Ca.GCSMOON2000]:null,
[Ca.LON_LAT]:ea,[Ca.WGS84_COMPARABLE_LON_LAT]:null,[Ca.SPHERICAL_ECEF]:null,[Ca.SPHERICAL_MARS_PCPF]:na,[Ca.SPHERICAL_MOON_PCPF]:null,[Ca.UNKNOWN]:null,[Ca.WEB_MERCATOR]:null,[Ca.PLATE_CARREE]:null,[Ca.WGS84]:null,[Ca.WGS84_ECEF]:null},[Ca.GCSMOON2000]:{[Ca.CGCS2000]:null,[Ca.GCSMARS2000]:null,[Ca.GCSMOON2000]:ea,[Ca.LON_LAT]:ea,[Ca.WGS84_COMPARABLE_LON_LAT]:null,[Ca.SPHERICAL_ECEF]:null,[Ca.SPHERICAL_MARS_PCPF]:null,[Ca.SPHERICAL_MOON_PCPF]:ia,[Ca.UNKNOWN]:null,[Ca.WEB_MERCATOR]:null,[Ca.PLATE_CARREE]:null,
[Ca.WGS84]:null,[Ca.WGS84_ECEF]:null},[Ca.WEB_MERCATOR]:{[Ca.CGCS2000]:null,[Ca.GCSMARS2000]:null,[Ca.GCSMOON2000]:null,[Ca.LON_LAT]:oa,[Ca.WGS84_COMPARABLE_LON_LAT]:oa,[Ca.SPHERICAL_ECEF]:va,[Ca.SPHERICAL_MARS_PCPF]:null,[Ca.SPHERICAL_MOON_PCPF]:null,[Ca.UNKNOWN]:null,[Ca.WEB_MERCATOR]:ea,[Ca.PLATE_CARREE]:ua,[Ca.WGS84]:oa,[Ca.WGS84_ECEF]:W},[Ca.WGS84_ECEF]:{[Ca.CGCS2000]:Ua,[Ca.GCSMARS2000]:null,[Ca.GCSMOON2000]:null,[Ca.LON_LAT]:Ua,[Ca.WGS84_COMPARABLE_LON_LAT]:Ua,[Ca.SPHERICAL_ECEF]:Ja,[Ca.SPHERICAL_MARS_PCPF]:null,
[Ca.SPHERICAL_MOON_PCPF]:null,[Ca.UNKNOWN]:null,[Ca.WEB_MERCATOR]:rb,[Ca.PLATE_CARREE]:function(pa,wa,qa,Fa){Ua(pa,wa,qa,Fa);la(qa,Fa,qa,Fa)},[Ca.WGS84]:Ua,[Ca.WGS84_ECEF]:ea},[Ca.SPHERICAL_ECEF]:{[Ca.CGCS2000]:Qa,[Ca.GCSMARS2000]:null,[Ca.GCSMOON2000]:null,[Ca.LON_LAT]:Qa,[Ca.WGS84_COMPARABLE_LON_LAT]:Qa,[Ca.SPHERICAL_ECEF]:ea,[Ca.SPHERICAL_MARS_PCPF]:null,[Ca.SPHERICAL_MOON_PCPF]:null,[Ca.UNKNOWN]:null,[Ca.WEB_MERCATOR]:Ta,[Ca.PLATE_CARREE]:function(pa,wa,qa,Fa){Qa(pa,wa,qa,Fa);la(qa,Fa,qa,Fa)},
[Ca.WGS84]:Qa,[Ca.WGS84_ECEF]:Sa},[Ca.SPHERICAL_MARS_PCPF]:{[Ca.CGCS2000]:null,[Ca.GCSMARS2000]:Ra,[Ca.GCSMOON2000]:null,[Ca.LON_LAT]:Ra,[Ca.WGS84_COMPARABLE_LON_LAT]:null,[Ca.SPHERICAL_ECEF]:null,[Ca.SPHERICAL_MARS_PCPF]:ea,[Ca.SPHERICAL_MOON_PCPF]:null,[Ca.UNKNOWN]:null,[Ca.WEB_MERCATOR]:null,[Ca.PLATE_CARREE]:null,[Ca.WGS84]:null,[Ca.WGS84_ECEF]:null},[Ca.SPHERICAL_MOON_PCPF]:{[Ca.CGCS2000]:null,[Ca.GCSMARS2000]:null,[Ca.GCSMOON2000]:Ka,[Ca.LON_LAT]:Ka,[Ca.WGS84_COMPARABLE_LON_LAT]:null,[Ca.SPHERICAL_ECEF]:null,
[Ca.SPHERICAL_MARS_PCPF]:null,[Ca.SPHERICAL_MOON_PCPF]:ea,[Ca.UNKNOWN]:null,[Ca.WEB_MERCATOR]:null,[Ca.PLATE_CARREE]:null,[Ca.WGS84]:null,[Ca.WGS84_ECEF]:null},[Ca.UNKNOWN]:{[Ca.CGCS2000]:null,[Ca.GCSMARS2000]:null,[Ca.GCSMOON2000]:null,[Ca.LON_LAT]:null,[Ca.WGS84_COMPARABLE_LON_LAT]:null,[Ca.SPHERICAL_ECEF]:null,[Ca.SPHERICAL_MARS_PCPF]:null,[Ca.SPHERICAL_MOON_PCPF]:null,[Ca.UNKNOWN]:ea,[Ca.WEB_MERCATOR]:null,[Ca.PLATE_CARREE]:null,[Ca.WGS84]:null,[Ca.WGS84_ECEF]:null},[Ca.LON_LAT]:{[Ca.CGCS2000]:ea,
[Ca.GCSMARS2000]:ea,[Ca.GCSMOON2000]:ea,[Ca.LON_LAT]:ea,[Ca.WGS84_COMPARABLE_LON_LAT]:ea,[Ca.SPHERICAL_ECEF]:ya,[Ca.SPHERICAL_MARS_PCPF]:na,[Ca.SPHERICAL_MOON_PCPF]:ia,[Ca.UNKNOWN]:null,[Ca.WEB_MERCATOR]:ka,[Ca.PLATE_CARREE]:la,[Ca.WGS84]:ea,[Ca.WGS84_ECEF]:Na},[Ca.WGS84_COMPARABLE_LON_LAT]:{[Ca.CGCS2000]:null,[Ca.GCSMARS2000]:null,[Ca.GCSMOON2000]:null,[Ca.LON_LAT]:ea,[Ca.WGS84_COMPARABLE_LON_LAT]:ea,[Ca.SPHERICAL_ECEF]:ya,[Ca.SPHERICAL_MARS_PCPF]:null,[Ca.SPHERICAL_MOON_PCPF]:null,[Ca.UNKNOWN]:null,
[Ca.WEB_MERCATOR]:null,[Ca.PLATE_CARREE]:la,[Ca.WGS84]:ea,[Ca.WGS84_ECEF]:Na},[Ca.PLATE_CARREE]:{[Ca.CGCS2000]:ma,[Ca.GCSMARS2000]:null,[Ca.GCSMOON2000]:null,[Ca.LON_LAT]:ma,[Ca.WGS84_COMPARABLE_LON_LAT]:ma,[Ca.SPHERICAL_ECEF]:function(pa,wa,qa,Fa){ma(pa,wa,qa,Fa);ya(qa,Fa,qa,Fa)},[Ca.SPHERICAL_MARS_PCPF]:null,[Ca.SPHERICAL_MOON_PCPF]:null,[Ca.UNKNOWN]:null,[Ca.WEB_MERCATOR]:function(pa,wa,qa,Fa){ma(pa,wa,qa,Fa);ka(qa,Fa,qa,Fa)},[Ca.PLATE_CARREE]:ea,[Ca.WGS84]:ma,[Ca.WGS84_ECEF]:function(pa,wa,qa,
Fa){ma(pa,wa,qa,Fa);Na(qa,Fa,qa,Fa)}}},Qb={spatialReference:null,spatialReferenceId:Ca.UNKNOWN},kc={spatialReference:null,spatialReferenceId:Ca.UNKNOWN},Zb=O(),$b=O(),Lb=w.deg2rad(1),ub=w.rad2deg(1),mb=k.create(),wb=k.create(),Cb=k.create(),cb=k.create(),Tb=k.create();t.canProjectToWGS84ComparableLonLat=function(pa){if(y.isNone(pa))return!1;pa=S(pa,Qb);return!!Jb[pa][Ca.WGS84_COMPARABLE_LON_LAT]};t.canProjectWithoutEngine=T;t.computeENUToSphericalPCPFLocalRotation=za;t.computeSphericalPCPFToENULocalRotation=
N;t.computeTranslationToOriginAndRotation=function(pa,wa,qa,Fa){if(y.isNone(pa)||y.isNone(Fa))return!1;var Oa=S(pa,Qb),Pa=S(Fa,kc);if(Oa===Pa&&Pa!==Ca.SPHERICAL_ECEF&&Pa!==Ca.SPHERICAL_MARS_PCPF&&Pa!==Ca.SPHERICAL_MOON_PCPF&&(Oa!==Ca.UNKNOWN||r.equals(pa,Fa)))return d.fromTranslation(qa,wa),!0;if(Pa===Ca.SPHERICAL_ECEF||Pa===Ca.SPHERICAL_MARS_PCPF||Pa===Ca.SPHERICAL_MOON_PCPF){Oa=Jb[Oa][Ca.LON_LAT];Pa=Jb[Ca.LON_LAT][Pa];if(y.isNone(Oa)||y.isNone(Pa))return!1;Oa(wa,0,wb,0);Pa(wb,0,Cb,0);za(Lb*wb[0],
Lb*wb[1],qa);qa[12]=Cb[0];qa[13]=Cb[1];qa[14]=Cb[2];return!0}if((Pa===Ca.WEB_MERCATOR||Pa===Ca.PLATE_CARREE)&&(Oa===Ca.WGS84||Oa===Ca.CGCS2000&&Pa===Ca.PLATE_CARREE||Oa===Ca.SPHERICAL_ECEF||Oa===Ca.WEB_MERCATOR)){pa=Jb[Oa][Ca.LON_LAT];Pa=Jb[Ca.LON_LAT][Pa];if(y.isNone(pa)||y.isNone(Pa))return!1;pa(wa,0,wb,0);Pa(wb,0,Cb,0);Oa===Ca.SPHERICAL_ECEF?N(Lb*wb[0],Lb*wb[1],qa):d.identity(qa);qa[12]=Cb[0];qa[13]=Cb[1];qa[14]=Cb[2];return!0}return!1};t.getProjectorName=function(pa,wa){switch(hb(pa,wa,Zb)){case ea:return"copy3";
case ya:return"wgs84ToSphericalECEF";case ka:return"wgs84ToWebMercator";case la:return"wgs84ToPlateCarree";case Na:return"wgs84ToWGS84ECEF";case oa:return"webMercatorToWGS84";case va:return"webMercatorToSphericalECEF";case W:return"webMercatorToWGS84ECEF";case ua:return"webMercatorToPlateCarree";case Ua:return"wgs84ECEFToWGS84";case Ja:return"wgs84ECEFToSphericalECEF";case rb:return"wgs84ECEFToWebMercator";case Qa:return"sphericalECEFToWGS84";case Ta:return"sphericalECEFToWebMercator";case Ra:return"sphericalMarsPCPFToMars2000";
case Ka:return"sphericalMoonPCPFToMoon2000";case Sa:return"sphericalECEFToWGS84ECEF";case na:return"mars2000ToSphericalPCPF";case ia:return"moon2000ToSphericalPCPF";default:return null}};t.getTransformation=E;t.getTransformations=function(pa,wa,qa=null){if(y.isNone(eb)||y.isNone(Za))throw new Wb;pa=eb._getTransformationBySuitability(Za,pa,wa,qa,qa?.spatialReference);if(null!==pa){wa=[];for(const Fa of pa)wa.push(p.fromGE(Fa));return wa}return[]};t.initializeProjection=function(pa,wa,qa,Fa){return Y.apply(this,
arguments)};t.isLoaded=K;t.load=F;t.localLinearScaleFactors=function(pa,wa,qa,Fa){if(y.isNone(wa)||y.isNone(Fa))return!1;const Oa=S(wa,Qb);var Pa=S(Fa,kc);if(Oa===Pa&&Oa!==Ca.UNKNOWN||r.equals(wa,Fa))return qa[0]=1,qa[1]=1,qa[2]=1,!0;if(Oa===Ca.SPHERICAL_ECEF){wa=f.length(pa);pa=wa/Math.sqrt(pa[0]*pa[0]+pa[1]*pa[1]);wa/=B.earth.radius;if(Pa===Ca.WEB_MERCATOR)return qa[0]=pa*wa,qa[1]=pa*wa,qa[2]=1,!0;if(Pa===Ca.WGS84||Pa===Ca.CGCS2000)return Pa=Yb,qa[0]=Pa*pa*wa,qa[1]=Pa*wa,qa[2]=1,!0}else if(Oa===
Ca.PLATE_CARREE){if(Pa===Ca.WGS84||Pa===Ca.CGCS2000)return qa[0]=Yb,qa[1]=Yb,qa[2]=1,!0;if(Pa===Ca.WEB_MERCATOR)return Pa=pa[1]/B.earth.radius,qa[0]=1,qa[1]=1/Math.cos(Pa),qa[2]=1,!0}return!1};t.lonLatToSphericalPCPF=function(pa,wa,qa,Fa){const Oa=Math.cos(qa);pa[0]=Math.cos(wa)*Oa*Fa;pa[1]=Math.sin(wa)*Oa*Fa;pa[2]=Math.sin(qa)*Fa};t.lonLatToWebMercatorComparable=ca;t.project=A;t.projectBoundingRect=function(pa,wa,qa,Fa){if(null==pa)return!1;if(r.equals(wa,Fa))return v.copy(qa,pa),!0;mb[0]=pa[0];
mb[1]=pa[1];mb[2]=0;if(!Da(mb,wa,0,mb,Fa,0,1))return!1;qa[0]=mb[0];qa[1]=mb[1];mb[0]=pa[2];mb[1]=pa[3];mb[2]=0;if(!Da(mb,wa,0,mb,Fa,0,1))return!1;qa[2]=mb[0];qa[3]=mb[1];return!0};t.projectBoundingSphere=function(pa,wa,qa,Fa){if(y.isNone(wa)||y.isNone(Fa))return!1;wa=db(wa,Fa,$b);if(wa.projector===ea)return qa[0]=pa[0],qa[1]=pa[1],qa[2]=pa[2],qa[3]=pa[3],!0;if(y.isNone(wa.projector))return!1;const {source:Oa,dest:Pa}=wa;if(Pa.spatialReferenceId===Ca.WEB_MERCATOR){wa=Jb[Oa.spatialReferenceId][Ca.WGS84];
if(y.isNone(wa))return!1;wa(pa,0,wb,0);ka(wb,0,qa,0);qa[3]=Ea(wb[1],pa[2],pa[3],B.earth.radius);return!0}if(Oa.spatialReferenceId!==Ca.WGS84&&Oa.spatialReferenceId!==Ca.CGCS2000||Pa.spatialReferenceId!==Ca.PLATE_CARREE)wa.projector(pa,0,qa,0),qa[3]=pa[3]*(Oa.metersPerUnit??1)/(Pa.metersPerUnit??1);else{Fa=Jb[Ca.SPHERICAL_ECEF][Ca.PLATE_CARREE];let Ya=pa[3];y.isSome(Jb[Oa.spatialReferenceId][Ca.SPHERICAL_ECEF])&&y.isSome(Fa)&&(Ya=Ea(pa[1],pa[2],pa[3],B.earth.radius));wa.projector(pa,0,qa,0);qa[3]=
Ya}return!0};t.projectBuffer=Da;t.projectDirection=function(pa,wa,qa,Fa,Oa){f.copy(cb,pa);f.add(Tb,pa,wa);sa(cb,qa,cb,Oa);sa(Tb,qa,Tb,Oa);f.subtract(Fa,Tb,cb);f.normalize(Fa,Fa)};t.projectExtent=function(pa,wa,qa=wa.spatialReference,Fa=0){return y.isSome(pa.spatialReference)&&y.isSome(qa)&&y.isSome(Z(pa,pa.spatialReference,wa,qa,Fa))};t.projectMany=I;t.projectMultipoint=function(pa,wa,qa=wa.spatialReference,Fa=0){return y.isSome(pa.spatialReference)&&y.isSome(qa)&&y.isSome(U(pa,pa.spatialReference,
wa,qa,Fa))};t.projectOrLoad=function(pa,wa){pa=G([pa],wa);return y.isSome(pa.pending)?{pending:pa.pending,geometry:null}:y.isSome(pa.geometries)?{pending:null,geometry:pa.geometries[0]}:{pending:null,geometry:null}};t.projectOrLoadMany=G;t.projectPoint=function(pa,wa,qa=wa.spatialReference,Fa=0){return y.isSome(qa)&&y.isSome(pa.spatialReference)&&y.isSome(ba(pa,pa.spatialReference,wa,qa,Fa))};t.projectPointToVector=function(pa,wa,qa,Fa=0){cb[0]=pa.x;cb[1]=pa.y;const Oa=pa.z;cb[2]=void 0!==Oa?Oa:Fa;
return Da(cb,pa.spatialReference,0,wa,qa,0,1)};t.projectPointToWGS84ComparableLonLat=function(pa,wa){cb[0]=pa.x;cb[1]=pa.y;const qa=pa.z;cb[2]=void 0!==qa?qa:0;return Aa(cb,pa.spatialReference,wa)};t.projectPolygon=function(pa,wa,qa=wa.spatialReference,Fa=0){return y.isSome(pa.spatialReference)&&y.isSome(qa)&&y.isSome(Q(pa,pa.spatialReference,wa,qa,Fa))};t.projectPolygonToWGS84ComparableLonLat=function({hasZ:pa,spatialReference:wa,rings:qa},Fa,Oa=0){wa=S(wa,Qb);wa=Jb[wa][Ca.WGS84_COMPARABLE_LON_LAT];
if(y.isNone(wa))return!1;pa=pa?Pa=>Pa:Pa=>f.set(cb,Pa[0],Pa[1],Oa);for(const Pa of qa){qa=[];for(const Ya of Pa){const $a=[0,0,Oa];wa(pa(Ya),0,$a,0);qa.push($a)}Fa.push(qa)}return!0};t.projectPolyline=function(pa,wa,qa=wa.spatialReference,Fa=0){return y.isSome(pa.spatialReference)&&y.isSome(qa)&&y.isSome(P(pa,pa.spatialReference,wa,qa,Fa))};t.projectPolylineToWGS84ComparableLonLat=function({hasZ:pa,spatialReference:wa,paths:qa},Fa,Oa=0){wa=S(wa,Qb);wa=Jb[wa][Ca.WGS84_COMPARABLE_LON_LAT];if(y.isNone(wa))return!1;
pa=pa?Pa=>Pa:Pa=>f.set(cb,Pa[0],Pa[1],Oa);for(const Pa of qa){qa=[];for(const Ya of Pa){const $a=[0,0,Oa];wa(pa(Ya),0,$a,0);qa.push($a)}Fa.push(qa)}return!0};t.projectVectorToDehydratedPoint=function(pa,wa,qa){return Da(pa,wa,0,cb,qa.spatialReference,0,1)?(qa.x=cb[0],qa.y=cb[1],qa.z=cb[2],qa):null};t.projectVectorToPoint=function(pa,wa,qa){if(y.isNone(wa)||y.isNone(qa))return null;const Fa=new l({spatialReference:qa});return Da(pa,wa,0,cb,qa,0,1)?(Fa.x=cb[0],Fa.y=cb[1],Fa.z=cb[2],Fa):null};t.projectVectorToVector=
sa;t.projectVectorToWGS84ComparableLonLat=function(pa,wa,qa){return Aa(pa,wa,qa)};t.projectWithoutEngine=fa;t.projectXYZToVector=X;t.sphericalPCPFtoLonLatElevation=Ga;t.test={get loadPromise(){return pb}};t.tryProjectWithZConversion=M;t.unload=function(){pb=Za=eb=null;Ab={}};Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})})},"esri/core/accessorSupport/tracking/SimpleObservable":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../ObservableBase"],function(u,t,
H){H=function(C){function w(){return C.apply(this,arguments)||this}t._inheritsLoose(w,C);w.prototype.notify=function(){var y=this._observers;if(y&&0<y.length){y=y.slice();for(const x of y)x.onInvalidated(),x.onCommitted()}};return w}(H.ObservableBase);u.SimpleObservable=H;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/mat4":function(){define(["exports","./vec3f64","./common"],function(u,t,H){function C(N,S){N[0]=S[0];N[1]=S[1];N[2]=S[2];N[3]=S[3];N[4]=S[4];N[5]=S[5];
N[6]=S[6];N[7]=S[7];N[8]=S[8];N[9]=S[9];N[10]=S[10];N[11]=S[11];N[12]=S[12];N[13]=S[13];N[14]=S[14];N[15]=S[15];return N}function w(N,S,ea,oa,va,W,ca,ka,la,ma,ua,xa,ia,na,ya,Ga,Ka){N[0]=S;N[1]=ea;N[2]=oa;N[3]=va;N[4]=W;N[5]=ca;N[6]=ka;N[7]=la;N[8]=ma;N[9]=ua;N[10]=xa;N[11]=ia;N[12]=na;N[13]=ya;N[14]=Ga;N[15]=Ka;return N}function y(N){N[0]=1;N[1]=0;N[2]=0;N[3]=0;N[4]=0;N[5]=1;N[6]=0;N[7]=0;N[8]=0;N[9]=0;N[10]=1;N[11]=0;N[12]=0;N[13]=0;N[14]=0;N[15]=1;return N}function x(N,S){if(N===S){const ea=S[1],
oa=S[2],va=S[3],W=S[6],ca=S[7],ka=S[11];N[1]=S[4];N[2]=S[8];N[3]=S[12];N[4]=ea;N[6]=S[9];N[7]=S[13];N[8]=oa;N[9]=W;N[11]=S[14];N[12]=va;N[13]=ca;N[14]=ka}else N[0]=S[0],N[1]=S[4],N[2]=S[8],N[3]=S[12],N[4]=S[1],N[5]=S[5],N[6]=S[9],N[7]=S[13],N[8]=S[2],N[9]=S[6],N[10]=S[10],N[11]=S[14],N[12]=S[3],N[13]=S[7],N[14]=S[11],N[15]=S[15];return N}function m(N,S){h(N,S)||y(N);return N}function h(N,S){const ea=S[0],oa=S[1],va=S[2],W=S[3],ca=S[4],ka=S[5],la=S[6],ma=S[7],ua=S[8],xa=S[9],ia=S[10],na=S[11],ya=S[12],
Ga=S[13],Ka=S[14];S=S[15];const Ra=ea*ka-oa*ca,Qa=ea*la-va*ca,Ta=ea*ma-W*ca,Sa=oa*la-va*ka,Na=oa*ma-W*ka,Ua=va*ma-W*la,Ja=ua*Ga-xa*ya,rb=ua*Ka-ia*ya,hb=ua*S-na*ya,db=xa*Ka-ia*Ga,O=xa*S-na*Ga,eb=ia*S-na*Ka;let Za=Ra*eb-Qa*O+Ta*db+Sa*hb-Na*rb+Ua*Ja;if(!Za)return null;Za=1/Za;N[0]=(ka*eb-la*O+ma*db)*Za;N[1]=(va*O-oa*eb-W*db)*Za;N[2]=(Ga*Ua-Ka*Na+S*Sa)*Za;N[3]=(ia*Na-xa*Ua-na*Sa)*Za;N[4]=(la*hb-ca*eb-ma*rb)*Za;N[5]=(ea*eb-va*hb+W*rb)*Za;N[6]=(Ka*Ta-ya*Ua-S*Qa)*Za;N[7]=(ua*Ua-ia*Ta+na*Qa)*Za;N[8]=(ca*
O-ka*hb+ma*Ja)*Za;N[9]=(oa*hb-ea*O-W*Ja)*Za;N[10]=(ya*Na-Ga*Ta+S*Ra)*Za;N[11]=(xa*Ta-ua*Na-na*Ra)*Za;N[12]=(ka*rb-ca*db-la*Ja)*Za;N[13]=(ea*db-oa*rb+va*Ja)*Za;N[14]=(Ga*Qa-ya*Sa-Ka*Ra)*Za;N[15]=(ua*Sa-xa*Qa+ia*Ra)*Za;return N}function c(N,S){const ea=S[0],oa=S[1],va=S[2],W=S[3],ca=S[4],ka=S[5],la=S[6],ma=S[7],ua=S[8],xa=S[9],ia=S[10],na=S[11],ya=S[12],Ga=S[13],Ka=S[14];S=S[15];N[0]=ka*(ia*S-na*Ka)-xa*(la*S-ma*Ka)+Ga*(la*na-ma*ia);N[1]=-(oa*(ia*S-na*Ka)-xa*(va*S-W*Ka)+Ga*(va*na-W*ia));N[2]=oa*(la*
S-ma*Ka)-ka*(va*S-W*Ka)+Ga*(va*ma-W*la);N[3]=-(oa*(la*na-ma*ia)-ka*(va*na-W*ia)+xa*(va*ma-W*la));N[4]=-(ca*(ia*S-na*Ka)-ua*(la*S-ma*Ka)+ya*(la*na-ma*ia));N[5]=ea*(ia*S-na*Ka)-ua*(va*S-W*Ka)+ya*(va*na-W*ia);N[6]=-(ea*(la*S-ma*Ka)-ca*(va*S-W*Ka)+ya*(va*ma-W*la));N[7]=ea*(la*na-ma*ia)-ca*(va*na-W*ia)+ua*(va*ma-W*la);N[8]=ca*(xa*S-na*Ga)-ua*(ka*S-ma*Ga)+ya*(ka*na-ma*xa);N[9]=-(ea*(xa*S-na*Ga)-ua*(oa*S-W*Ga)+ya*(oa*na-W*xa));N[10]=ea*(ka*S-ma*Ga)-ca*(oa*S-W*Ga)+ya*(oa*ma-W*ka);N[11]=-(ea*(ka*na-ma*xa)-
ca*(oa*na-W*xa)+ua*(oa*ma-W*ka));N[12]=-(ca*(xa*Ka-ia*Ga)-ua*(ka*Ka-la*Ga)+ya*(ka*ia-la*xa));N[13]=ea*(xa*Ka-ia*Ga)-ua*(oa*Ka-va*Ga)+ya*(oa*ia-va*xa);N[14]=-(ea*(ka*Ka-la*Ga)-ca*(oa*Ka-va*Ga)+ya*(oa*la-va*ka));N[15]=ea*(ka*ia-la*xa)-ca*(oa*ia-va*xa)+ua*(oa*la-va*ka);return N}function d(N){const S=N[0],ea=N[1],oa=N[2],va=N[3],W=N[4],ca=N[5],ka=N[6],la=N[7],ma=N[8],ua=N[9],xa=N[10],ia=N[11],na=N[12],ya=N[13],Ga=N[14];N=N[15];return(S*ca-ea*W)*(xa*N-ia*Ga)-(S*ka-oa*W)*(ua*N-ia*ya)+(S*la-va*W)*(ua*Ga-
xa*ya)+(ea*ka-oa*ca)*(ma*N-ia*na)-(ea*la-va*ca)*(ma*Ga-xa*na)+(oa*la-va*ka)*(ma*ya-ua*na)}function f(N,S,ea){const oa=S[0],va=S[1],W=S[2],ca=S[3],ka=S[4],la=S[5],ma=S[6],ua=S[7],xa=S[8],ia=S[9],na=S[10],ya=S[11],Ga=S[12],Ka=S[13],Ra=S[14];S=S[15];let Qa=ea[0],Ta=ea[1],Sa=ea[2],Na=ea[3];N[0]=Qa*oa+Ta*ka+Sa*xa+Na*Ga;N[1]=Qa*va+Ta*la+Sa*ia+Na*Ka;N[2]=Qa*W+Ta*ma+Sa*na+Na*Ra;N[3]=Qa*ca+Ta*ua+Sa*ya+Na*S;Qa=ea[4];Ta=ea[5];Sa=ea[6];Na=ea[7];N[4]=Qa*oa+Ta*ka+Sa*xa+Na*Ga;N[5]=Qa*va+Ta*la+Sa*ia+Na*Ka;N[6]=Qa*
W+Ta*ma+Sa*na+Na*Ra;N[7]=Qa*ca+Ta*ua+Sa*ya+Na*S;Qa=ea[8];Ta=ea[9];Sa=ea[10];Na=ea[11];N[8]=Qa*oa+Ta*ka+Sa*xa+Na*Ga;N[9]=Qa*va+Ta*la+Sa*ia+Na*Ka;N[10]=Qa*W+Ta*ma+Sa*na+Na*Ra;N[11]=Qa*ca+Ta*ua+Sa*ya+Na*S;Qa=ea[12];Ta=ea[13];Sa=ea[14];Na=ea[15];N[12]=Qa*oa+Ta*ka+Sa*xa+Na*Ga;N[13]=Qa*va+Ta*la+Sa*ia+Na*Ka;N[14]=Qa*W+Ta*ma+Sa*na+Na*Ra;N[15]=Qa*ca+Ta*ua+Sa*ya+Na*S;return N}function k(N,S,ea){const oa=ea[0],va=ea[1];ea=ea[2];if(S===N)N[12]=S[0]*oa+S[4]*va+S[8]*ea+S[12],N[13]=S[1]*oa+S[5]*va+S[9]*ea+S[13],
N[14]=S[2]*oa+S[6]*va+S[10]*ea+S[14],N[15]=S[3]*oa+S[7]*va+S[11]*ea+S[15];else{const W=S[0],ca=S[1],ka=S[2],la=S[3],ma=S[4],ua=S[5],xa=S[6],ia=S[7],na=S[8],ya=S[9],Ga=S[10],Ka=S[11];N[0]=W;N[1]=ca;N[2]=ka;N[3]=la;N[4]=ma;N[5]=ua;N[6]=xa;N[7]=ia;N[8]=na;N[9]=ya;N[10]=Ga;N[11]=Ka;N[12]=W*oa+ma*va+na*ea+S[12];N[13]=ca*oa+ua*va+ya*ea+S[13];N[14]=ka*oa+xa*va+Ga*ea+S[14];N[15]=la*oa+ia*va+Ka*ea+S[15]}return N}function g(N,S,ea){const oa=ea[0],va=ea[1];ea=ea[2];N[0]=S[0]*oa;N[1]=S[1]*oa;N[2]=S[2]*oa;N[3]=
S[3]*oa;N[4]=S[4]*va;N[5]=S[5]*va;N[6]=S[6]*va;N[7]=S[7]*va;N[8]=S[8]*ea;N[9]=S[9]*ea;N[10]=S[10]*ea;N[11]=S[11]*ea;N[12]=S[12];N[13]=S[13];N[14]=S[14];N[15]=S[15];return N}function e(N,S,ea,oa){let va=oa[0],W=oa[1];oa=oa[2];let ca=Math.sqrt(va*va+W*W+oa*oa);var ka=void 0,la=void 0;let ma=void 0,ua=void 0,xa=void 0,ia=void 0,na=void 0,ya=void 0,Ga=void 0,Ka=void 0,Ra=void 0,Qa=void 0,Ta=void 0,Sa=void 0,Na=void 0,Ua=void 0,Ja=void 0,rb=void 0,hb=void 0,db=void 0,O=void 0,eb=void 0;la=ka=void 0;if(ca<
H.getEpsilon())return null;ca=1/ca;va*=ca;W*=ca;oa*=ca;ka=Math.sin(ea);la=Math.cos(ea);ma=1-la;ua=S[0];xa=S[1];ia=S[2];na=S[3];ya=S[4];Ga=S[5];Ka=S[6];Ra=S[7];Qa=S[8];Ta=S[9];Sa=S[10];Na=S[11];Ua=va*va*ma+la;Ja=W*va*ma+oa*ka;rb=oa*va*ma-W*ka;hb=va*W*ma-oa*ka;db=W*W*ma+la;O=oa*W*ma+va*ka;eb=va*oa*ma+W*ka;ka=W*oa*ma-va*ka;la=oa*oa*ma+la;N[0]=ua*Ua+ya*Ja+Qa*rb;N[1]=xa*Ua+Ga*Ja+Ta*rb;N[2]=ia*Ua+Ka*Ja+Sa*rb;N[3]=na*Ua+Ra*Ja+Na*rb;N[4]=ua*hb+ya*db+Qa*O;N[5]=xa*hb+Ga*db+Ta*O;N[6]=ia*hb+Ka*db+Sa*O;N[7]=na*
hb+Ra*db+Na*O;N[8]=ua*eb+ya*ka+Qa*la;N[9]=xa*eb+Ga*ka+Ta*la;N[10]=ia*eb+Ka*ka+Sa*la;N[11]=na*eb+Ra*ka+Na*la;S!==N&&(N[12]=S[12],N[13]=S[13],N[14]=S[14],N[15]=S[15]);return N}function a(N,S,ea){const oa=Math.sin(ea);ea=Math.cos(ea);const va=S[4],W=S[5],ca=S[6],ka=S[7],la=S[8],ma=S[9],ua=S[10],xa=S[11];S!==N&&(N[0]=S[0],N[1]=S[1],N[2]=S[2],N[3]=S[3],N[12]=S[12],N[13]=S[13],N[14]=S[14],N[15]=S[15]);N[4]=va*ea+la*oa;N[5]=W*ea+ma*oa;N[6]=ca*ea+ua*oa;N[7]=ka*ea+xa*oa;N[8]=la*ea-va*oa;N[9]=ma*ea-W*oa;N[10]=
ua*ea-ca*oa;N[11]=xa*ea-ka*oa;return N}function b(N,S,ea){const oa=Math.sin(ea);ea=Math.cos(ea);const va=S[0],W=S[1],ca=S[2],ka=S[3],la=S[8],ma=S[9],ua=S[10],xa=S[11];S!==N&&(N[4]=S[4],N[5]=S[5],N[6]=S[6],N[7]=S[7],N[12]=S[12],N[13]=S[13],N[14]=S[14],N[15]=S[15]);N[0]=va*ea-la*oa;N[1]=W*ea-ma*oa;N[2]=ca*ea-ua*oa;N[3]=ka*ea-xa*oa;N[8]=va*oa+la*ea;N[9]=W*oa+ma*ea;N[10]=ca*oa+ua*ea;N[11]=ka*oa+xa*ea;return N}function l(N,S,ea){const oa=Math.sin(ea);ea=Math.cos(ea);const va=S[0],W=S[1],ca=S[2],ka=S[3],
la=S[4],ma=S[5],ua=S[6],xa=S[7];S!==N&&(N[8]=S[8],N[9]=S[9],N[10]=S[10],N[11]=S[11],N[12]=S[12],N[13]=S[13],N[14]=S[14],N[15]=S[15]);N[0]=va*ea+la*oa;N[1]=W*ea+ma*oa;N[2]=ca*ea+ua*oa;N[3]=ka*ea+xa*oa;N[4]=la*ea-va*oa;N[5]=ma*ea-W*oa;N[6]=ua*ea-ca*oa;N[7]=xa*ea-ka*oa;return N}function q(N,S){N[0]=1;N[1]=0;N[2]=0;N[3]=0;N[4]=0;N[5]=1;N[6]=0;N[7]=0;N[8]=0;N[9]=0;N[10]=1;N[11]=0;N[12]=S[0];N[13]=S[1];N[14]=S[2];N[15]=1;return N}function n(N,S){N[0]=S[0];N[1]=0;N[2]=0;N[3]=0;N[4]=0;N[5]=S[1];N[6]=0;N[7]=
0;N[8]=0;N[9]=0;N[10]=S[2];N[11]=0;N[12]=0;N[13]=0;N[14]=0;N[15]=1;return N}function v(N,S,ea){if(0===S)return y(N);let oa=ea[0],va=ea[1];ea=ea[2];let W=Math.sqrt(oa*oa+va*va+ea*ea),ca=void 0,ka=void 0,la=void 0;if(W<H.getEpsilon())return null;W=1/W;oa*=W;va*=W;ea*=W;ca=Math.sin(S);ka=Math.cos(S);la=1-ka;N[0]=oa*oa*la+ka;N[1]=va*oa*la+ea*ca;N[2]=ea*oa*la-va*ca;N[3]=0;N[4]=oa*va*la-ea*ca;N[5]=va*va*la+ka;N[6]=ea*va*la+oa*ca;N[7]=0;N[8]=oa*ea*la+va*ca;N[9]=va*ea*la-oa*ca;N[10]=ea*ea*la+ka;N[11]=0;N[12]=
0;N[13]=0;N[14]=0;N[15]=1;return N}function B(N,S){const ea=Math.sin(S);S=Math.cos(S);N[0]=1;N[1]=0;N[2]=0;N[3]=0;N[4]=0;N[5]=S;N[6]=ea;N[7]=0;N[8]=0;N[9]=-ea;N[10]=S;N[11]=0;N[12]=0;N[13]=0;N[14]=0;N[15]=1;return N}function z(N,S){const ea=Math.sin(S);S=Math.cos(S);N[0]=S;N[1]=0;N[2]=-ea;N[3]=0;N[4]=0;N[5]=1;N[6]=0;N[7]=0;N[8]=ea;N[9]=0;N[10]=S;N[11]=0;N[12]=0;N[13]=0;N[14]=0;N[15]=1;return N}function p(N,S){const ea=Math.sin(S);S=Math.cos(S);N[0]=S;N[1]=ea;N[2]=0;N[3]=0;N[4]=-ea;N[5]=S;N[6]=0;N[7]=
0;N[8]=0;N[9]=0;N[10]=1;N[11]=0;N[12]=0;N[13]=0;N[14]=0;N[15]=1;return N}function r(N,S,ea){var oa=S[0],va=S[1],W=S[2],ca=S[3],ka=oa+oa,la=va+va;const ma=W+W;S=oa*ka;const ua=oa*la;oa*=ma;const xa=va*la;va*=ma;W*=ma;ka*=ca;la*=ca;ca*=ma;N[0]=1-(xa+W);N[1]=ua+ca;N[2]=oa-la;N[3]=0;N[4]=ua-ca;N[5]=1-(S+W);N[6]=va+ka;N[7]=0;N[8]=oa+la;N[9]=va-ka;N[10]=1-(S+xa);N[11]=0;N[12]=ea[0];N[13]=ea[1];N[14]=ea[2];N[15]=1;return N}function D(N,S){const ea=za,oa=-S[0],va=-S[1],W=-S[2],ca=S[3],ka=S[4],la=S[5],ma=
S[6],ua=S[7],xa=oa*oa+va*va+W*W+ca*ca;0<xa?(ea[0]=2*(ka*ca+ua*oa+la*W-ma*va)/xa,ea[1]=2*(la*ca+ua*va+ma*oa-ka*W)/xa,ea[2]=2*(ma*ca+ua*W+ka*va-la*oa)/xa):(ea[0]=2*(ka*ca+ua*oa+la*W-ma*va),ea[1]=2*(la*ca+ua*va+ma*oa-ka*W),ea[2]=2*(ma*ca+ua*W+ka*va-la*oa));r(N,S,ea);return N}function J(N,S){N[0]=S[12];N[1]=S[13];N[2]=S[14];return N}function K(N,S){const ea=S[0],oa=S[1],va=S[2],W=S[4],ca=S[5],ka=S[6],la=S[8],ma=S[9];S=S[10];N[0]=Math.sqrt(ea*ea+oa*oa+va*va);N[1]=Math.sqrt(W*W+ca*ca+ka*ka);N[2]=Math.sqrt(la*
la+ma*ma+S*S);return N}function F(N,S){const ea=S[0]+S[5]+S[10];let oa=0;0<ea?(oa=2*Math.sqrt(ea+1),N[3]=.25*oa,N[0]=(S[6]-S[9])/oa,N[1]=(S[8]-S[2])/oa,N[2]=(S[1]-S[4])/oa):S[0]>S[5]&&S[0]>S[10]?(oa=2*Math.sqrt(1+S[0]-S[5]-S[10]),N[3]=(S[6]-S[9])/oa,N[0]=.25*oa,N[1]=(S[1]+S[4])/oa,N[2]=(S[8]+S[2])/oa):S[5]>S[10]?(oa=2*Math.sqrt(1+S[5]-S[0]-S[10]),N[3]=(S[8]-S[2])/oa,N[0]=(S[1]+S[4])/oa,N[1]=.25*oa,N[2]=(S[6]+S[9])/oa):(oa=2*Math.sqrt(1+S[10]-S[0]-S[5]),N[3]=(S[1]-S[4])/oa,N[0]=(S[8]+S[2])/oa,N[1]=
(S[6]+S[9])/oa,N[2]=.25*oa);return N}function A(N,S,ea,oa){var va=S[0],W=S[1],ca=S[2],ka=S[3],la=va+va,ma=W+W,ua=ca+ca;S=va*la;const xa=va*ma;va*=ua;const ia=W*ma;W*=ua;ca*=ua;la*=ka;ma*=ka;ka*=ua;ua=oa[0];const na=oa[1];oa=oa[2];N[0]=(1-(ia+ca))*ua;N[1]=(xa+ka)*ua;N[2]=(va-ma)*ua;N[3]=0;N[4]=(xa-ka)*na;N[5]=(1-(S+ca))*na;N[6]=(W+la)*na;N[7]=0;N[8]=(va+ma)*oa;N[9]=(W-la)*oa;N[10]=(1-(S+ia))*oa;N[11]=0;N[12]=ea[0];N[13]=ea[1];N[14]=ea[2];N[15]=1;return N}function I(N,S,ea,oa,va){var W=S[0],ca=S[1],
ka=S[2],la=S[3],ma=W+W,ua=ca+ca,xa=ka+ka;S=W*ma;var ia=W*ua,na=W*xa;W=ca*ua;ca*=xa;var ya=ka*xa;ka=la*ma;ua*=la;const Ga=la*xa;var Ka=oa[0],Ra=oa[1];xa=oa[2];oa=va[0];la=va[1];va=va[2];ma=(1-(W+ya))*Ka;const Qa=(ia+Ga)*Ka;Ka*=na-ua;ia=(ia-Ga)*Ra;ya=(1-(S+ya))*Ra;Ra*=ca+ka;na=(na+ua)*xa;ca=(ca-ka)*xa;S=(1-(S+W))*xa;N[0]=ma;N[1]=Qa;N[2]=Ka;N[3]=0;N[4]=ia;N[5]=ya;N[6]=Ra;N[7]=0;N[8]=na;N[9]=ca;N[10]=S;N[11]=0;N[12]=ea[0]+oa-(ma*oa+ia*la+na*va);N[13]=ea[1]+la-(Qa*oa+ya*la+ca*va);N[14]=ea[2]+va-(Ka*oa+
Ra*la+S*va);N[15]=1;return N}function G(N,S){var ea=S[0],oa=S[1],va=S[2];S=S[3];var W=ea+ea,ca=oa+oa;const ka=va+va;ea*=W;const la=oa*W;oa*=ca;const ma=va*W,ua=va*ca;va*=ka;W*=S;ca*=S;S*=ka;N[0]=1-oa-va;N[1]=la+S;N[2]=ma-ca;N[3]=0;N[4]=la-S;N[5]=1-ea-va;N[6]=ua+W;N[7]=0;N[8]=ma+ca;N[9]=ua-W;N[10]=1-ea-oa;N[11]=0;N[12]=0;N[13]=0;N[14]=0;N[15]=1;return N}function E(N,S,ea,oa,va,W,ca){const ka=1/(ea-S),la=1/(va-oa),ma=1/(W-ca);N[0]=2*W*ka;N[1]=0;N[2]=0;N[3]=0;N[4]=0;N[5]=2*W*la;N[6]=0;N[7]=0;N[8]=(ea+
S)*ka;N[9]=(va+oa)*la;N[10]=(ca+W)*ma;N[11]=-1;N[12]=0;N[13]=0;N[14]=ca*W*2*ma;N[15]=0;return N}function M(N,S,ea,oa,va){S=1/Math.tan(S/2);let W=void 0;N[0]=S/ea;N[1]=0;N[2]=0;N[3]=0;N[4]=0;N[5]=S;N[6]=0;N[7]=0;N[8]=0;N[9]=0;N[11]=-1;N[12]=0;N[13]=0;N[15]=0;null!=va&&Infinity!==va?(W=1/(oa-va),N[10]=(va+oa)*W,N[14]=2*va*oa*W):(N[10]=-1,N[14]=-2*oa);return N}function T(N,S,ea,oa){const va=Math.tan(S.upDegrees*Math.PI/180),W=Math.tan(S.downDegrees*Math.PI/180),ca=Math.tan(S.leftDegrees*Math.PI/180);
S=Math.tan(S.rightDegrees*Math.PI/180);const ka=2/(ca+S),la=2/(va+W);N[0]=ka;N[1]=0;N[2]=0;N[3]=0;N[4]=0;N[5]=la;N[6]=0;N[7]=0;N[8]=-((ca-S)*ka*.5);N[9]=(va-W)*la*.5;N[10]=oa/(ea-oa);N[11]=-1;N[12]=0;N[13]=0;N[14]=oa*ea/(ea-oa);N[15]=0;return N}function Y(N,S,ea,oa,va,W,ca){const ka=1/(S-ea),la=1/(oa-va),ma=1/(W-ca);N[0]=-2*ka;N[1]=0;N[2]=0;N[3]=0;N[4]=0;N[5]=-2*la;N[6]=0;N[7]=0;N[8]=0;N[9]=0;N[10]=2*ma;N[11]=0;N[12]=(S+ea)*ka;N[13]=(va+oa)*la;N[14]=(ca+W)*ma;N[15]=1;return N}function fa(N,S,ea,oa){var va=
void 0;let W=void 0;var ca=void 0,ka=void 0;let la=void 0,ma=void 0;var ua=void 0,xa=void 0;let ia=void 0,na=void 0;const ya=S[0],Ga=S[1];S=S[2];ca=oa[0];ka=oa[1];oa=oa[2];ua=ea[0];xa=ea[1];ea=ea[2];va=H.getEpsilon();if(Math.abs(ya-ua)<va&&Math.abs(Ga-xa)<va&&Math.abs(S-ea)<va)return y(N);ua=ya-ua;xa=Ga-xa;ia=S-ea;na=1/Math.sqrt(ua*ua+xa*xa+ia*ia);ua*=na;xa*=na;ia*=na;va=ka*ia-oa*xa;W=oa*ua-ca*ia;ca=ca*xa-ka*ua;(na=Math.sqrt(va*va+W*W+ca*ca))?(na=1/na,va*=na,W*=na,ca*=na):ca=W=va=0;ka=xa*ca-ia*W;
la=ia*va-ua*ca;ma=ua*W-xa*va;(na=Math.sqrt(ka*ka+la*la+ma*ma))?(na=1/na,ka*=na,la*=na,ma*=na):ma=la=ka=0;N[0]=va;N[1]=ka;N[2]=ua;N[3]=0;N[4]=W;N[5]=la;N[6]=xa;N[7]=0;N[8]=ca;N[9]=ma;N[10]=ia;N[11]=0;N[12]=-(va*ya+W*Ga+ca*S);N[13]=-(ka*ya+la*Ga+ma*S);N[14]=-(ua*ya+xa*Ga+ia*S);N[15]=1;return N}function ba(N,S,ea,oa){const va=S[0],W=S[1];S=S[2];var ca=oa[0];const ka=oa[1];var la=oa[2];oa=va-ea[0];let ma=W-ea[1];ea=S-ea[2];let ua=oa*oa+ma*ma+ea*ea;0<ua&&(ua=1/Math.sqrt(ua),oa*=ua,ma*=ua,ea*=ua);let xa=
ka*ea-la*ma;la=la*oa-ca*ea;ca=ca*ma-ka*oa;ua=xa*xa+la*la+ca*ca;0<ua&&(ua=1/Math.sqrt(ua),xa*=ua,la*=ua,ca*=ua);N[0]=xa;N[1]=la;N[2]=ca;N[3]=0;N[4]=ma*ca-ea*la;N[5]=ea*xa-oa*ca;N[6]=oa*la-ma*xa;N[7]=0;N[8]=oa;N[9]=ma;N[10]=ea;N[11]=0;N[12]=va;N[13]=W;N[14]=S;N[15]=1;return N}function U(N){return"mat4("+N[0]+", "+N[1]+", "+N[2]+", "+N[3]+", "+N[4]+", "+N[5]+", "+N[6]+", "+N[7]+", "+N[8]+", "+N[9]+", "+N[10]+", "+N[11]+", "+N[12]+", "+N[13]+", "+N[14]+", "+N[15]+")"}function P(N){return Math.sqrt(N[0]**
2+N[1]**2+N[2]**2+N[3]**2+N[4]**2+N[5]**2+N[6]**2+N[7]**2+N[8]**2+N[9]**2+N[10]**2+N[11]**2+N[12]**2+N[13]**2+N[14]**2+N[15]**2)}function Q(N,S,ea){N[0]=S[0]+ea[0];N[1]=S[1]+ea[1];N[2]=S[2]+ea[2];N[3]=S[3]+ea[3];N[4]=S[4]+ea[4];N[5]=S[5]+ea[5];N[6]=S[6]+ea[6];N[7]=S[7]+ea[7];N[8]=S[8]+ea[8];N[9]=S[9]+ea[9];N[10]=S[10]+ea[10];N[11]=S[11]+ea[11];N[12]=S[12]+ea[12];N[13]=S[13]+ea[13];N[14]=S[14]+ea[14];N[15]=S[15]+ea[15];return N}function Z(N,S,ea){N[0]=S[0]-ea[0];N[1]=S[1]-ea[1];N[2]=S[2]-ea[2];N[3]=
S[3]-ea[3];N[4]=S[4]-ea[4];N[5]=S[5]-ea[5];N[6]=S[6]-ea[6];N[7]=S[7]-ea[7];N[8]=S[8]-ea[8];N[9]=S[9]-ea[9];N[10]=S[10]-ea[10];N[11]=S[11]-ea[11];N[12]=S[12]-ea[12];N[13]=S[13]-ea[13];N[14]=S[14]-ea[14];N[15]=S[15]-ea[15];return N}function X(N,S,ea){N[0]=S[0]*ea;N[1]=S[1]*ea;N[2]=S[2]*ea;N[3]=S[3]*ea;N[4]=S[4]*ea;N[5]=S[5]*ea;N[6]=S[6]*ea;N[7]=S[7]*ea;N[8]=S[8]*ea;N[9]=S[9]*ea;N[10]=S[10]*ea;N[11]=S[11]*ea;N[12]=S[12]*ea;N[13]=S[13]*ea;N[14]=S[14]*ea;N[15]=S[15]*ea;return N}function sa(N,S,ea,oa){N[0]=
S[0]+ea[0]*oa;N[1]=S[1]+ea[1]*oa;N[2]=S[2]+ea[2]*oa;N[3]=S[3]+ea[3]*oa;N[4]=S[4]+ea[4]*oa;N[5]=S[5]+ea[5]*oa;N[6]=S[6]+ea[6]*oa;N[7]=S[7]+ea[7]*oa;N[8]=S[8]+ea[8]*oa;N[9]=S[9]+ea[9]*oa;N[10]=S[10]+ea[10]*oa;N[11]=S[11]+ea[11]*oa;N[12]=S[12]+ea[12]*oa;N[13]=S[13]+ea[13]*oa;N[14]=S[14]+ea[14]*oa;N[15]=S[15]+ea[15]*oa;return N}function Aa(N,S){return N[0]===S[0]&&N[1]===S[1]&&N[2]===S[2]&&N[3]===S[3]&&N[4]===S[4]&&N[5]===S[5]&&N[6]===S[6]&&N[7]===S[7]&&N[8]===S[8]&&N[9]===S[9]&&N[10]===S[10]&&N[11]===
S[11]&&N[12]===S[12]&&N[13]===S[13]&&N[14]===S[14]&&N[15]===S[15]}function Da(N,S){if(N===S)return!0;const ea=N[0],oa=N[1],va=N[2],W=N[3],ca=N[4],ka=N[5],la=N[6],ma=N[7],ua=N[8],xa=N[9],ia=N[10],na=N[11],ya=N[12],Ga=N[13],Ka=N[14];N=N[15];const Ra=S[0],Qa=S[1],Ta=S[2],Sa=S[3],Na=S[4],Ua=S[5],Ja=S[6],rb=S[7],hb=S[8],db=S[9],O=S[10],eb=S[11],Za=S[12],pb=S[13],Ab=S[14];S=S[15];const ib=H.getEpsilon();return Math.abs(ea-Ra)<=ib*Math.max(1,Math.abs(ea),Math.abs(Ra))&&Math.abs(oa-Qa)<=ib*Math.max(1,Math.abs(oa),
Math.abs(Qa))&&Math.abs(va-Ta)<=ib*Math.max(1,Math.abs(va),Math.abs(Ta))&&Math.abs(W-Sa)<=ib*Math.max(1,Math.abs(W),Math.abs(Sa))&&Math.abs(ca-Na)<=ib*Math.max(1,Math.abs(ca),Math.abs(Na))&&Math.abs(ka-Ua)<=ib*Math.max(1,Math.abs(ka),Math.abs(Ua))&&Math.abs(la-Ja)<=ib*Math.max(1,Math.abs(la),Math.abs(Ja))&&Math.abs(ma-rb)<=ib*Math.max(1,Math.abs(ma),Math.abs(rb))&&Math.abs(ua-hb)<=ib*Math.max(1,Math.abs(ua),Math.abs(hb))&&Math.abs(xa-db)<=ib*Math.max(1,Math.abs(xa),Math.abs(db))&&Math.abs(ia-O)<=
ib*Math.max(1,Math.abs(ia),Math.abs(O))&&Math.abs(na-eb)<=ib*Math.max(1,Math.abs(na),Math.abs(eb))&&Math.abs(ya-Za)<=ib*Math.max(1,Math.abs(ya),Math.abs(Za))&&Math.abs(Ga-pb)<=ib*Math.max(1,Math.abs(Ga),Math.abs(pb))&&Math.abs(Ka-Ab)<=ib*Math.max(1,Math.abs(Ka),Math.abs(Ab))&&Math.abs(N-S)<=ib*Math.max(1,Math.abs(N),Math.abs(S))}function ha(N){const S=H.getEpsilon(),ea=N[0],oa=N[1],va=N[2],W=N[4],ca=N[5],ka=N[6],la=N[8],ma=N[9];N=N[10];return Math.abs(1-(ea*ea+W*W+la*la))<=S&&Math.abs(1-(oa*oa+ca*
ca+ma*ma))<=S&&Math.abs(1-(va*va+ka*ka+N*N))<=S}function Ea(N){return 1===N[0]&&0===N[1]&&0===N[2]&&0===N[4]&&1===N[5]&&0===N[6]&&0===N[8]&&0===N[9]&&1===N[10]}const za=t.create();t=Object.freeze(Object.defineProperty({__proto__:null,add:Q,adjoint:c,copy:C,determinant:d,equals:Da,exactEquals:Aa,frob:P,fromQuat:G,fromQuat2:D,fromRotation:v,fromRotationTranslation:r,fromRotationTranslationScale:A,fromRotationTranslationScaleOrigin:I,fromScaling:n,fromTranslation:q,fromXRotation:B,fromYRotation:z,fromZRotation:p,
frustum:E,getRotation:F,getScaling:K,getTranslation:J,hasIdentityRotation:Ea,identity:y,invert:h,invertOrIdentity:m,isOrthoNormal:ha,lookAt:fa,mul:f,multiply:f,multiplyScalar:X,multiplyScalarAndAdd:sa,ortho:Y,perspective:M,perspectiveFromFieldOfView:T,rotate:e,rotateX:a,rotateY:b,rotateZ:l,scale:g,set:w,str:U,sub:Z,subtract:Z,targetTo:ba,translate:k,transpose:x},Symbol.toStringTag,{value:"Module"}));u.add=Q;u.adjoint=c;u.copy=C;u.determinant=d;u.equals=Da;u.exactEquals=Aa;u.frob=P;u.fromQuat=G;u.fromQuat2=
D;u.fromRotation=v;u.fromRotationTranslation=r;u.fromRotationTranslationScale=A;u.fromRotationTranslationScaleOrigin=I;u.fromScaling=n;u.fromTranslation=q;u.fromXRotation=B;u.fromYRotation=z;u.fromZRotation=p;u.frustum=E;u.getRotation=F;u.getScaling=K;u.getTranslation=J;u.hasIdentityRotation=Ea;u.identity=y;u.invert=h;u.invertOrIdentity=m;u.isOrthoNormal=ha;u.lookAt=fa;u.mat4=t;u.mul=f;u.multiply=f;u.multiplyScalar=X;u.multiplyScalarAndAdd=sa;u.ortho=Y;u.perspective=M;u.perspectiveFromFieldOfView=
T;u.rotate=e;u.rotateX=a;u.rotateY=b;u.rotateZ=l;u.scale=g;u.set=w;u.str=U;u.sub=Z;u.subtract=Z;u.targetTo=ba;u.translate=k;u.transpose=x})},"esri/chunks/pe":function(){define(["require","exports","./_rollupPluginBabelHelpers","../assets","../core/has"],function(u,t,H,C,w){function y(){return!!t._pe}function x(){return!!w("esri-wasm")}function m(){return g?g:g=(new Promise((a,b)=>u(["./pe-wasm"],a,b))).then(a=>a.peWasm).then(({default:a})=>a({locateFile:b=>C.getAssetUrl(`esri/geometry/support/${b}`)})).then(a=>
{h(a)})}function h(a){function b(n,v,B){n[v]=B(n[v])}t._pe=a;t.PeDefs.init();t.PeGTlistExtended.init();t.PeNotationMgrs.init();t.PeNotationUtm.init();t.PePCSInfo.init();t.PeGCSExtent=function(n){function v(){return n.apply(this,arguments)||this}H._inheritsLoose(v,n);v.prototype.destroy=function(){t._pe.destroy(this)};return v}(t._pe.PeGCSExtent);a=[t._pe.PeDatum,t._pe.PeGeogcs,t._pe.PeGeogtran,t._pe.PeObject,t._pe.PeParameter,t._pe.PePrimem,t._pe.PeProjcs,t._pe.PeSpheroid,t._pe.PeUnit];for(var l of a)b(l.prototype,
"getName",n=>function(){return n.call(this,Array(t.PeDefs.PE_NAME_MAX))});for(const n of[t._pe.PeGeogtran,t._pe.PeProjcs])b(n.prototype,"getParameters",v=>function(){const B=Array(t.PeDefs.PE_PARM_MAX);let z=v.call(this);for(let p=0;p<B.length;p++){const r=t._pe.getValue(z,"*");B[p]=r?t._pe.wrapPointer(r,t._pe.PeParameter):null;z+=Int32Array.BYTES_PER_ELEMENT}return B});b(t._pe.PeHorizon.prototype,"getCoord",n=>function(){const v=this.getSize();if(!v)return null;const B=[],z=n.call(this);k(B,v,z);
return B});b(t._pe.PeGTlistExtendedEntry.prototype,"getEntries",n=>{const v=t._pe._pe_getPeGTlistExtendedGTsSize();return function(){let B=null;var z=n.call(this);if(!t._pe.compare(z,t._pe.NULL)){B=[z];const p=this.getSteps();if(1<p){z=t._pe.getPointer(z);for(let r=1;r<p;r++)B.push(t._pe.wrapPointer(z+v*r,t._pe.PeGTlistExtendedGTs))}}return B}});const q=t._pe._pe_getPeHorizonSize();l=n=>function(){let v=this._cache;v||(this._cache=v=new Map);if(v.has(n))return v.get(n);let B=null;var z=n.call(this);
if(!t._pe.compare(z,t._pe.NULL)){B=[z];const p=z.getNump();if(1<p){z=t._pe.getPointer(z);for(let r=1;r<p;r++)B.push(t._pe.wrapPointer(z+q*r,t._pe.PeHorizon))}}v.set(n,B);return B};b(t._pe.PeProjcs.prototype,"horizonGcsGenerate",l);b(t._pe.PeProjcs.prototype,"horizonPcsGenerate",l);t._pe.PeObject.prototype.toString=function(n=t.PeDefs.PE_STR_OPTS_NONE){t._pe.ensureCache.prepare();const v=t._pe.getPointer(this),B=t._pe.ensureInt8(Array(t.PeDefs.PE_BUFFER_MAX));return t._pe.UTF8ToString(t._pe._pe_object_to_string_ext(v,
n,B))}}function c(a){if(a){var b=t._pe.getClass(a);b&&(b=t._pe.getCache(b))&&(a=t._pe.getPointer(a))&&delete b[a]}}function d(a,b){const l=[];b=Array(b);for(let q=0;q<a;q++)l.push(t._pe.ensureInt8(b));return l}function f(a){let b;Array.isArray(a[0])?(b=[],a.forEach(l=>{b.push(l[0],l[1])})):b=a;return b}function k(a,b,l,q=!1){if(q)for(q=0;q<2*b;q++)a[q]=t._pe.getValue(l+q*Float64Array.BYTES_PER_ELEMENT,"double");else{q=0===a.length;for(let n=0;n<b;n++)q&&(a[n]=Array(2)),a[n][0]=t._pe.getValue(l,"double"),
a[n][1]=t._pe.getValue(l+Float64Array.BYTES_PER_ELEMENT,"double"),l+=2*Float64Array.BYTES_PER_ELEMENT}}let g;t._pe=null;t.PeCSTransformations=void 0;(function(a){function b(n,v,B){t._pe.ensureCache.prepare();var z=f(B);const p=B===z;z=t._pe.ensureFloat64(z);(n=t._pe._pe_geog_to_proj(t._pe.getPointer(n),v,z))&&k(B,v,z,p);return n}function l(n,v,B){return q(n,v,B,0)}function q(n,v,B,z){t._pe.ensureCache.prepare();var p=f(B);const r=B===p;p=t._pe.ensureFloat64(p);(n=t._pe._pe_proj_to_geog_center(t._pe.getPointer(n),
v,p,z))&&k(B,v,p,r);return n}a.geogToProj=b;a.projGeog=function(n,v,B,z){switch(z){case t.PeDefs.PE_TRANSFORM_P_TO_G:return l(n,v,B);case t.PeDefs.PE_TRANSFORM_G_TO_P:return b(n,v,B)}return 0};a.projToGeog=l;a.projToGeogCenter=q})(t.PeCSTransformations||(t.PeCSTransformations={}));t.PeDefs=void 0;(function(a){a.init=function(){a.PE_BUFFER_MAX=t._pe.PeDefs.prototype.PE_BUFFER_MAX;a.PE_NAME_MAX=t._pe.PeDefs.prototype.PE_NAME_MAX;a.PE_MGRS_MAX=t._pe.PeDefs.prototype.PE_MGRS_MAX;a.PE_USNG_MAX=t._pe.PeDefs.prototype.PE_USNG_MAX;
a.PE_DD_MAX=t._pe.PeDefs.prototype.PE_DD_MAX;a.PE_DDM_MAX=t._pe.PeDefs.prototype.PE_DDM_MAX;a.PE_DMS_MAX=t._pe.PeDefs.prototype.PE_DMS_MAX;a.PE_UTM_MAX=t._pe.PeDefs.prototype.PE_UTM_MAX;a.PE_PARM_MAX=t._pe.PeDefs.prototype.PE_PARM_MAX;a.PE_TYPE_NONE=t._pe.PeDefs.prototype.PE_TYPE_NONE;a.PE_TYPE_GEOGCS=t._pe.PeDefs.prototype.PE_TYPE_GEOGCS;a.PE_TYPE_PROJCS=t._pe.PeDefs.prototype.PE_TYPE_PROJCS;a.PE_TYPE_GEOGTRAN=t._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN;a.PE_TYPE_COORDSYS=t._pe.PeDefs.prototype.PE_TYPE_COORDSYS;
a.PE_TYPE_UNIT=t._pe.PeDefs.prototype.PE_TYPE_UNIT;a.PE_TYPE_LINUNIT=t._pe.PeDefs.prototype.PE_TYPE_LINUNIT;a.PE_STR_OPTS_NONE=t._pe.PeDefs.prototype.PE_STR_OPTS_NONE;a.PE_STR_AUTH_NONE=t._pe.PeDefs.prototype.PE_STR_AUTH_NONE;a.PE_STR_AUTH_TOP=t._pe.PeDefs.prototype.PE_STR_AUTH_TOP;a.PE_STR_NAME_CANON=t._pe.PeDefs.prototype.PE_STR_NAME_CANON;a.PE_PARM_X0=t._pe.PeDefs.prototype.PE_PARM_X0;a.PE_PARM_ND=t._pe.PeDefs.prototype.PE_PARM_ND;a.PE_TRANSFORM_1_TO_2=t._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2;
a.PE_TRANSFORM_2_TO_1=t._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1;a.PE_TRANSFORM_P_TO_G=t._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G;a.PE_TRANSFORM_G_TO_P=t._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P;a.PE_HORIZON_RECT=t._pe.PeDefs.prototype.PE_HORIZON_RECT;a.PE_HORIZON_POLY=t._pe.PeDefs.prototype.PE_HORIZON_POLY;a.PE_HORIZON_LINE=t._pe.PeDefs.prototype.PE_HORIZON_LINE;a.PE_HORIZON_DELTA=t._pe.PeDefs.prototype.PE_HORIZON_DELTA}})(t.PeDefs||(t.PeDefs={}));t.PeFactory=void 0;(function(a){function b(v,B){let z=
null,p=l[v];p||(p={},l[v]=p);p.hasOwnProperty(String(B))?z=p[B]:(v=t._pe.PeFactory.prototype.factoryByType(v,B),t._pe.compare(v,t._pe.NULL)||(z=v,p[B]=z));return z=n(z)}const l={},q={},n=v=>{if(v){const B=v.getType();switch(B){case t.PeDefs.PE_TYPE_GEOGCS:v=t._pe.castObject(v,t._pe.PeGeogcs);break;case t.PeDefs.PE_TYPE_PROJCS:v=t._pe.castObject(v,t._pe.PeProjcs);break;case t.PeDefs.PE_TYPE_GEOGTRAN:v=t._pe.castObject(v,t._pe.PeGeogtran);break;default:B&t.PeDefs.PE_TYPE_UNIT&&(v=t._pe.castObject(v,
t._pe.PeUnit))}}return v};a.initialize=function(){t._pe.PeFactory.prototype.initialize(null)};a.coordsys=function(v){return b(t.PeDefs.PE_TYPE_COORDSYS,v)};a.factoryByType=b;a.fromString=function(v,B){let z=null,p=q[v];p||(p={},q[v]=p);p.hasOwnProperty(B)?z=p[B]:(v=t._pe.PeFactory.prototype.fromString(v,B),t._pe.compare(v,t._pe.NULL)||(z=v,p[B]=z));return z=n(z)};a.geogcs=function(v){return b(t.PeDefs.PE_TYPE_GEOGCS,v)};a.geogtran=function(v){return b(t.PeDefs.PE_TYPE_GEOGTRAN,v)};a.getCode=function(v){return t._pe.PeFactory.prototype.getCode(v)};
a.projcs=function(v){return b(t.PeDefs.PE_TYPE_PROJCS,v)};a.unit=function(v){return b(t.PeDefs.PE_TYPE_UNIT,v)}})(t.PeFactory||(t.PeFactory={}));t.PeGCSExtent=null;t.PeGTlistExtended=void 0;(function(a){let b;a.init=function(){a.PE_GTLIST_OPTS_COMMON=t._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON;b=t._pe._pe_getPeGTlistExtendedEntrySize()};a.getGTlist=function(l,q,n,v,B,z){let p=null;const r=new t._pe.PeInteger(z);try{const D=t._pe.PeGTlistExtended.prototype.getGTlist(l,q,n,v,B,r);if(z=r.val)if(p=
[D],1<z){const J=t._pe.getPointer(D);for(l=1;l<z;l++)p.push(t._pe.wrapPointer(J+b*l,t._pe.PeGTlistExtendedEntry))}}finally{t._pe.destroy(r)}return p}})(t.PeGTlistExtended||(t.PeGTlistExtended={}));t.PeGTlistExtendedEntry=void 0;(function(a){a.destroy=function(b){if(b&&b.length){for(const l of b)c(l),l.getEntries().forEach(q=>{c(q);q=q.getGeogtran();c(q);q.getParameters().forEach(c);[q.getGeogcs1(),q.getGeogcs2()].forEach(n=>{c(n);const v=n.getDatum();c(v);c(v.getSpheroid());c(n.getPrimem());c(n.getUnit())})});
t._pe.PeGTlistExtendedEntry.prototype.Delete(b[0])}}})(t.PeGTlistExtendedEntry||(t.PeGTlistExtendedEntry={}));t.PeGTTransformations=void 0;(function(a){a.geogToGeog=function(b,l,q,n,v){t._pe.ensureCache.prepare();var B=f(q);const z=q===B;B=t._pe.ensureFloat64(B);let p=0;n&&(p=t._pe.ensureFloat64(n));(b=t._pe._pe_geog_to_geog(t._pe.getPointer(b),l,B,p,v))&&k(q,l,B,z);return b}})(t.PeGTTransformations||(t.PeGTTransformations={}));t.PeNotationDms=void 0;(function(a){const b=(q,n,v,B,z,p)=>{t._pe.ensureCache.prepare();
switch(q){case "dd":var r=t._pe._pe_geog_to_dd;var D=t.PeDefs.PE_DD_MAX;break;case "ddm":r=t._pe._pe_geog_to_ddm;D=t.PeDefs.PE_DDM_MAX;break;case "dms":r=t._pe._pe_geog_to_dms,D=t.PeDefs.PE_DMS_MAX}q=0;n&&(q=t._pe.getPointer(n));n=f(B);n=t._pe.ensureFloat64(n);D=d(v,D);B=t._pe.ensureInt32(D);if(z=r(q,v,n,z,B))for(r=0;r<v;r++)p[r]=t._pe.UTF8ToString(D[r]);return z},l=(q,n,v,B,z)=>{t._pe.ensureCache.prepare();switch(q){case "dd":var p=t._pe._pe_dd_to_geog;break;case "ddm":p=t._pe._pe_ddm_to_geog;break;
case "dms":p=t._pe._pe_dms_to_geog}q=0;n&&(q=t._pe.getPointer(n));n=B.map(r=>t._pe.ensureString(r));B=t._pe.ensureInt32(n);n=t._pe.ensureFloat64(Array(2*v));(p=p(q,v,B,n))&&k(z,v,n);return p};a.geogToDms=function(q,n,v,B,z){return b("dms",q,n,v,B,z)};a.dmsToGeog=function(q,n,v,B){return l("dms",q,n,v,B)};a.geogToDdm=function(q,n,v,B,z){return b("ddm",q,n,v,B,z)};a.ddmToGeog=function(q,n,v,B){return l("ddm",q,n,v,B)};a.geogToDd=function(q,n,v,B,z){return b("dd",q,n,v,B,z)};a.ddToGeog=function(q,n,
v,B){return l("dd",q,n,v,B)}})(t.PeNotationDms||(t.PeNotationDms={}));t.PeNotationMgrs=void 0;(function(a){a.init=function(){a.PE_MGRS_STYLE_NEW=t._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW;a.PE_MGRS_STYLE_OLD=t._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD;a.PE_MGRS_STYLE_AUTO=t._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO;a.PE_MGRS_180_ZONE_1_PLUS=t._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS;a.PE_MGRS_ADD_SPACES=t._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES};a.geogToMgrsExtended=
function(b,l,q,n,v,B,z){t._pe.ensureCache.prepare();let p=0;b&&(p=t._pe.getPointer(b));b=f(q);q=t._pe.ensureFloat64(b);b=d(l,t.PeDefs.PE_MGRS_MAX);const r=t._pe.ensureInt32(b);if(n=t._pe._pe_geog_to_mgrs_extended(p,l,q,n,v,B,r))for(v=0;v<l;v++)z[v]=t._pe.UTF8ToString(b[v]);return n};a.mgrsToGeogExtended=function(b,l,q,n,v){t._pe.ensureCache.prepare();let B=0;b&&(B=t._pe.getPointer(b));b=q.map(z=>t._pe.ensureString(z));q=t._pe.ensureInt32(b);b=t._pe.ensureFloat64(Array(2*l));(n=t._pe._pe_mgrs_to_geog_extended(B,
l,q,n,b))&&k(v,l,b);return n}})(t.PeNotationMgrs||(t.PeNotationMgrs={}));t.PeNotationUsng=void 0;(function(a){a.geogToUsng=function(b,l,q,n,v,B,z){t._pe.ensureCache.prepare();let p=0;b&&(p=t._pe.getPointer(b));b=f(q);q=t._pe.ensureFloat64(b);b=d(l,t.PeDefs.PE_MGRS_MAX);const r=t._pe.ensureInt32(b);if(n=t._pe._pe_geog_to_usng(p,l,q,n,v,B,r))for(v=0;v<l;v++)z[v]=t._pe.UTF8ToString(b[v]);return n};a.usngToGeog=function(b,l,q,n){t._pe.ensureCache.prepare();var v=0;b&&(v=t._pe.getPointer(b));b=q.map(B=>
t._pe.ensureString(B));q=t._pe.ensureInt32(b);b=t._pe.ensureFloat64(Array(2*l));(v=t._pe._pe_usng_to_geog(v,l,q,b))&&k(n,l,b);return v}})(t.PeNotationUsng||(t.PeNotationUsng={}));t.PeNotationUtm=void 0;(function(a){a.init=function(){a.PE_UTM_OPTS_NONE=t._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE;a.PE_UTM_OPTS_ADD_SPACES=t._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES;a.PE_UTM_OPTS_NS=t._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS};a.geogToUtm=function(b,l,q,n,v){t._pe.ensureCache.prepare();var B=
0;b&&(B=t._pe.getPointer(b));b=f(q);q=t._pe.ensureFloat64(b);b=d(l,t.PeDefs.PE_UTM_MAX);const z=t._pe.ensureInt32(b);if(n=t._pe._pe_geog_to_utm(B,l,q,n,z))for(B=0;B<l;B++)v[B]=t._pe.UTF8ToString(b[B]);return n};a.utmToGeog=function(b,l,q,n,v){t._pe.ensureCache.prepare();let B=0;b&&(B=t._pe.getPointer(b));b=q.map(z=>t._pe.ensureString(z));q=t._pe.ensureInt32(b);b=t._pe.ensureFloat64(Array(2*l));(n=t._pe._pe_utm_to_geog(B,l,q,n,b))&&k(v,l,b);return n}})(t.PeNotationUtm||(t.PeNotationUtm={}));t.PePCSInfo=
void 0;(function(a){const b=new Map;a.init=function(){a.PE_PCSINFO_OPTION_NONE=t._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE;a.PE_PCSINFO_OPTION_DOMAIN=t._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN;a.PE_POLE_OUTSIDE_BOUNDARY=t._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY;a.PE_POLE_POINT=t._pe.PePCSInfo.prototype.PE_POLE_POINT};a.generate=function(l,q=a.PE_PCSINFO_OPTION_DOMAIN){let n=null,v=null;b.has(l)&&(v=b.get(l),v[q]&&(n=v[q]));n||(n=t._pe.PePCSInfo.prototype.generate(l,q),v||(v=
[],b.set(l,v)),v[q]=n);return n}})(t.PePCSInfo||(t.PePCSInfo={}));t.PeVersion=void 0;(function(a){a.versionString=function(){return t._pe.PeVersion.prototype.version_string()}})(t.PeVersion||(t.PeVersion={}));const e=Object.freeze(Object.defineProperty({__proto__:null,get PeCSTransformations(){return t.PeCSTransformations},get PeDefs(){return t.PeDefs},get PeFactory(){return t.PeFactory},get PeGCSExtent(){return t.PeGCSExtent},get PeGTTransformations(){return t.PeGTTransformations},get PeGTlistExtended(){return t.PeGTlistExtended},
get PeGTlistExtendedEntry(){return t.PeGTlistExtendedEntry},get PeNotationDms(){return t.PeNotationDms},get PeNotationMgrs(){return t.PeNotationMgrs},get PeNotationUsng(){return t.PeNotationUsng},get PeNotationUtm(){return t.PeNotationUtm},get PePCSInfo(){return t.PePCSInfo},get PeVersion(){return t.PeVersion},_init:h,get _pe(){return t._pe},isLoaded:y,isSupported:x,load:m},Symbol.toStringTag,{value:"Module"}));t._init=h;t.isLoaded=y;t.isSupported=x;t.load=m;t.pe=e})},"esri/geometry/support/geodesicConstants":function(){define(["exports",
"./Ellipsoid"],function(u,t){const H=Math.PI/180;var C=t.earth.radius;const w=t.earth.eccentricitySquared;C={a1:C*w,a2:C*w*C*w,a3:C*w*w/2,a4:C*w*C*w*2.5,a5:C*w+C*w*w/2,a6:1-w};t={4267:{a:6378206.4,f:1/294.9786982},4269:{a:6378137,f:1/298.257222101},4326:{a:t.earth.radius,f:t.earth.flattening},104900:{a:2439700,f:0},104901:{a:6051E3,f:0},104902:{a:6051800,f:0},104903:{a:t.moon.radius,f:t.moon.flattening},104904:{a:3393400,f:.005207166853303471},104905:{a:t.mars.radius,f:t.mars.flattening},104906:{a:6200,
f:0},104907:{a:11100,f:0},104908:{a:71492E3,f:.06487439154031222},104909:{a:8200,f:0},104910:{a:83500,f:0},104911:{a:1E4,f:0},104912:{a:2409300,f:0},104913:{a:15E3,f:0},104914:{a:4E4,f:0},104915:{a:1562090,f:0},104916:{a:2632345,f:0},104917:{a:85E3,f:0},104918:{a:1821460,f:0},104919:{a:5E3,f:0},104920:{a:12E3,f:0},104921:{a:3E4,f:3},104922:{a:18E3,f:0},104923:{a:14E3,f:0},104924:{a:49300,f:0},104925:{a:60268E3,f:.09796243445941462},104926:{a:16E3,f:0},104927:{a:9500,f:0},104928:{a:56E4,f:0},104929:{a:249400,
f:0},104930:{a:59500,f:0},104931:{a:16E3,f:0},104932:{a:133E3,f:0},104933:{a:718E3,f:0},104934:{a:888E3,f:0},104935:{a:1986300,f:0},104936:{a:1E4,f:0},104937:{a:41900,f:0},104938:{a:11E4,f:0},104939:{a:50100,f:0},104940:{a:764E3,f:0},104941:{a:11E3,f:0},104942:{a:529800,f:0},104943:{a:2575E3,f:0},104944:{a:25559E3,f:.022927344575296365},104945:{a:578900,f:0},104946:{a:33E3,f:0},104947:{a:21E3,f:0},104948:{a:13E3,f:0},104949:{a:31E3,f:0},104950:{a:27E3,f:0},104951:{a:42E3,f:0},104952:{a:235800,f:0},
104953:{a:761400,f:0},104954:{a:15E3,f:0},104955:{a:54E3,f:0},104956:{a:77E3,f:0},104957:{a:27E3,f:0},104958:{a:788900,f:0},104959:{a:584700,f:0},104960:{a:24764E3,f:.01708124697141011},104961:{a:74E3,f:0},104962:{a:79E3,f:0},104963:{a:104E3,f:.14423076923076922},104964:{a:29E3,f:0},104965:{a:17E4,f:0},104966:{a:208E3,f:0},104967:{a:4E4,f:0},104968:{a:1352600,f:0},104969:{a:1195E3,f:0},104970:{a:593E3,f:0},104971:{a:t.mars.radius,f:0},104972:{a:47E4,f:0},104973:{a:255E3,f:0},104974:{a:2439400,f:0}};
u.WKT_SPHEROID_REGEX=/SPHEROID\[([^\]]+)]/i;u.earthEllipsoidConstants=C;u.spheroids=t;u.toRadians=H;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/GeographicTransformation":function(){define(["./GeographicTransformationStep"],function(u){return function(){function t(C){this.steps=[];this._cachedProjection={};this._chain="";this._gtlistentry=null;if(C&&C.steps)for(const w of C.steps)w instanceof u?this.steps.push(w):this.steps.push(new u({wkid:w.wkid,wkt:w.wkt,
isInverse:w.isInverse}))}t.cacheKey=function(C,w){return[void 0!==C.wkid&&null!==C.wkid?C.wkid.toString():"-1",void 0!==C.wkt&&null!==C.wkt?C.wkt.toString():"",void 0!==w.wkid&&null!==w.wkid?w.wkid.toString():"-1",void 0!==w.wkt&&null!==w.wkt?w.wkt.toString():""].join()};t.fromGE=function(C){const w=new t;let y="";for(const x of C.steps)C=u.fromGE(x),w.steps.push(C),y+=C.uid.toString()+",";w._cachedProjection={};w._gtlistentry=null;w._chain=y;return w};var H=t.prototype;H.getInverse=function(){const C=
new t;C.steps=[];for(let w=this.steps.length-1;0<=w;w--)C.steps.push(this.steps[w].getInverse());return C};H.getGTListEntry=function(){let C="";for(const w of this.steps)C+=w.uid.toString()+",";C!==this._chain&&(this._gtlistentry=null,this._cachedProjection={},this._chain=C);return this._gtlistentry};H.assignCachedGe=function(C,w,y){this._cachedProjection[t.cacheKey(C,w)]=y};H.getCachedGeTransformation=function(C,w){let y="";for(const x of this.steps)y+=x.uid.toString()+",";y!==this._chain&&(this._gtlistentry=
null,this._cachedProjection={},this._chain=y);C=this._cachedProjection[t.cacheKey(C,w)];return void 0===C?null:C};return t}()})},"esri/geometry/support/GeographicTransformationStep":function(){define(["../../chunks/_rollupPluginBabelHelpers"],function(u){let t=0;return function(){function H(C){this.uid=t++;C?(this._wkt=null!=C.wkt?C.wkt:null,this._wkid=null!=C.wkid?C.wkid:-1,this._isInverse=null!=C.isInverse?!0===C.isInverse:!1):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}H.fromGE=function(C){const w=
new H;w._wkt=C.wkt;w._wkid=C.wkid;w._isInverse=C.isInverse;return w};H.prototype.getInverse=function(){const C=new H;C._wkt=this.wkt;C._wkid=this._wkid;C._isInverse=!this.isInverse;return C};u._createClass(H,[{key:"wkt",get:function(){return this._wkt},set:function(C){this._wkt=C;this.uid=t++}},{key:"wkid",get:function(){return this._wkid},set:function(C){this._wkid=C;this.uid=t++}},{key:"isInverse",get:function(){return this._isInverse},set:function(C){this._isInverse=C;this.uid=t++}}]);return H}()})},
"esri/geometry/support/zscale":function(){define(["exports","../../core/maybe","../../core/unitUtils","./spatialReferenceUtils"],function(u,t,H,C){u.getGeometryZScaler=function(w,y,x){if(t.isNone(y)||t.isNone(x)||x.vcsWkid||C.equals(y,x))return null;y=H.getMetersPerVerticalUnitForSR(y);x=H.getMetersPerVerticalUnitForSR(x);const m=y/x;if(1===m)return null;switch(w){case "point":case "esriGeometryPoint":return h=>{h&&null!=h.z&&(h.z*=m)};case "polyline":case "esriGeometryPolyline":return h=>{if(h)for(const c of h.paths)for(const d of c)2<
d.length&&(d[2]*=m)};case "polygon":case "esriGeometryPolygon":return h=>{if(h)for(const c of h.rings)for(const d of c)2<d.length&&(d[2]*=m)};case "multipoint":case "esriGeometryMultipoint":return h=>{if(h)for(const c of h.points)2<c.length&&(c[2]*=m)};case "extent":case "esriGeometryExtent":return h=>{h&&null!=h.zmin&&null!=h.zmax&&(h.zmin*=m,h.zmax*=m)};default:return null}};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/geometryAdapters/json":function(){define(["exports"],
function(u){let t=function(x,m,h){this.x=x;this.y=m;this.spatialReference=h;this.m=this.z=void 0},H=function(x,m,h,c){this.rings=x;this.spatialReference=m;this.hasM=this.hasZ=void 0;h&&(this.hasZ=h);c&&(this.hasM=c)},C=function(x,m,h,c){this.paths=x;this.spatialReference=m;this.hasM=this.hasZ=void 0;h&&(this.hasZ=h);c&&(this.hasM=c)},w=function(x,m,h,c){this.points=x;this.spatialReference=m;this.hasM=this.hasZ=void 0;h&&(this.hasZ=h);c&&(this.hasM=c)},y=function(x,m,h,c,d){this.xmin=x;this.ymin=m;
this.xmax=h;this.ymax=c;this.spatialReference=d;this.mmax=this.mmin=this.zmax=this.zmin=void 0};u.jsonAdapter={convertToGEGeometry:function(x,m){return null==m?null:x.convertJSONToGeometry(m)},exportPoint:function(x,m,h){h=new t(x.getPointX(m),x.getPointY(m),h);const c=x.hasZ(m),d=x.hasM(m);c&&(h.z=x.getPointZ(m));d&&(h.m=x.getPointM(m));return h},exportPolygon:function(x,m,h){return new H(x.exportPaths(m),h,x.hasZ(m),x.hasM(m))},exportPolyline:function(x,m,h){return new C(x.exportPaths(m),h,x.hasZ(m),
x.hasM(m))},exportMultipoint:function(x,m,h){return new w(x.exportPoints(m),h,x.hasZ(m),x.hasM(m))},exportExtent:function(x,m,h){var c=x.hasZ(m);const d=x.hasM(m);h=new y(x.getXMin(m),x.getYMin(m),x.getXMax(m),x.getYMax(m),h);c&&(c=x.getZExtent(m),h.zmin=c.vmin,h.zmax=c.vmax);d&&(x=x.getMExtent(m),h.mmin=x.vmin,h.mmax=x.vmax);return h}};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngineCapabilities":function(){define(["exports"],function(u){u.queryCapabilities=
{supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,
supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../geometry/support/centroid ../../../geometry/support/extentUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ./AttributesBuilder ./projectionSupport ./SnappingCandidate ./utils ../../support/fieldUtils ../../../statistics/utils ../../../support/arcadeOnDemand".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f,k,g,e){function a(n,v,B,z){const p=z.x-B.x;z=z.y-B.y;v=Math.min(1,Math.max(0,((v.x-B.x)*p+(v.y-B.y)*z)/(p*p+z*z)));n.x=B.x+p*v;n.y=B.y+z*v}function b(n,v){return n?v?4:3:v?3:2}let l=function(){function n(B,z,p){this.items=B;this.query=z;this.geometryType=p.geometryType;this.hasM=p.hasM;this.hasZ=p.hasZ;this.fieldsIndex=p.fieldsIndex;this.objectIdField=p.objectIdField;this.spatialReference=p.spatialReference;this.featureAdapter=p.featureAdapter}var v=n.prototype;v.createQueryResponseForCount=
function(){const B=new h(this.query,this.featureAdapter,this.fieldsIndex);if(!this.query.outStatistics)return B.countDistinctValues(this.items);const {groupByFieldsForStatistics:z,having:p,outStatistics:r}=this.query;if(!z?.length)return 1;const D=new Map,J=new Map,K=new Set;for(const I of r){var {statisticType:F}=I;F="exceedslimit"!==F?I.onStatisticField:void 0;if(!J.has(F)){var A=[];for(const G of z){const E=this._getAttributeValues(B,G,D);A.push(E)}J.set(F,this._calculateUniqueValues(A,B.returnDistinctValues))}F=
J.get(F);for(const G in F){const {data:E,items:M}=F[G];A=E.join(",");p&&!B.validateItems(M,p)||K.add(A)}}return K.size};v.createQueryResponse=function(){var B=H._asyncToGenerator(function*(){let z;z=this.query.outStatistics?this.query.outStatistics.some(p=>"exceedslimit"===p.statisticType)?this._createExceedsLimitQueryResponse(this.query):yield this._createStatisticsQueryResponse(this.query):this._createFeatureQueryResponse(this.query);if(this.query.returnQueryGeometry){const p=this.query.geometry;
m.isValid(this.query.outSR)&&!m.equals(p.spatialReference,this.query.outSR)?z.queryGeometry=f.cleanFromGeometryEngine({spatialReference:this.query.outSR,...c.project(p,p.spatialReference,this.query.outSR)}):z.queryGeometry=f.cleanFromGeometryEngine({spatialReference:this.query.outSR,...p})}return z});return function(){return B.apply(this,arguments)}}();v.createSnappingResponse=function(B,z){const p=this.featureAdapter,r=b(this.hasZ,this.hasM),{point:D,mode:J}=B,K="number"===typeof B.distance?B.distance:
B.distance.x,F="number"===typeof B.distance?B.distance:B.distance.y,A={candidates:[]},I="esriGeometryPolygon"===this.geometryType;z=this._getPointCreator(J,this.spatialReference,z);const G=new q(null,0),E=new q(null,0),M={x:0,y:0,z:0};for(const Q of this.items){var T=p.getGeometry(Q);if(C.isNone(T))continue;const {coords:Z,lengths:X}=T;G.coords=Z;E.coords=Z;if(B.types&t.SnappingTypes.EDGE){T=0;for(var Y=0;Y<X.length;Y++){var fa=X[Y];for(var ba=0;ba<fa;ba++,T+=r){var U=G;U.coordsIndex=T;if(ba!==fa-
1){const sa=E;sa.coordsIndex=T+r;const Aa=M;a(M,D,U,sa);var P=(D.x-Aa.x)/K;const Da=(D.y-Aa.y)/F;P=P*P+Da*Da;1>=P&&A.candidates.push(d.makeEdgeCandidate(p.getObjectId(Q),z(Aa),Math.sqrt(P),z(U),z(sa)))}}}}if(B.types&t.SnappingTypes.VERTEX)for(T=I?Z.length-r:Z.length,Y=0;Y<T;Y+=r)fa=G,fa.coordsIndex=Y,ba=(D.x-fa.x)/K,U=(D.y-fa.y)/F,ba=ba*ba+U*U,1>=ba&&A.candidates.push(d.makeVertexCandidate(p.getObjectId(Q),z(fa),Math.sqrt(ba)))}A.candidates.sort((Q,Z)=>Q.distance-Z.distance);return A};v._getPointCreator=
function(B,z,p){const r=C.isSome(p)&&!m.equals(z,p)?J=>c.project(J,z,p):J=>J,{hasZ:D}=this;return"3d"===B?D?({x:J,y:K,z:F})=>r({x:J,y:K,z:F}):({x:J,y:K})=>r({x:J,y:K,z:0}):({x:J,y:K})=>r({x:J,y:K})};v.createSummaryStatisticsResponse=function(){var B=H._asyncToGenerator(function*(z){const {field:p,valueExpression:r,normalizationField:D,normalizationType:J,normalizationTotal:K,minValue:F,maxValue:A,scale:I}=z;z=this.fieldsIndex.isDateField(p);var G=yield this._getDataValues({field:p,valueExpression:r,
normalizationField:D,normalizationType:J,normalizationTotal:K,scale:I});const E=g.isNullCountSupported({normalizationType:J,normalizationField:D,minValue:F,maxValue:A}),M=this.fieldsIndex.get(p),T={value:.5,fieldType:M?.type};G=k.isStringField(M)?g.calculateStringStatistics({values:G,supportsNullCount:E,percentileParams:T}):g.calculateStatistics({values:G,minValue:F,maxValue:A,useSampleStdDev:!J,supportsNullCount:E,percentileParams:T});return g.processSummaryStatisticsResult(G,z)});return function(z){return B.apply(this,
arguments)}}();v.createUniqueValuesResponse=function(){var B=H._asyncToGenerator(function*(z){const {field:p,valueExpression:r,domains:D,returnAllCodedValues:J,scale:K}=z;var F=yield this._getDataValues({field:p,field2:z.field2,field3:z.field3,fieldDelimiter:z.fieldDelimiter,valueExpression:r,scale:K});F=g.calculateUniqueValuesCount(F);return g.createUVResult(F,D,J,z.fieldDelimiter)});return function(z){return B.apply(this,arguments)}}();v.createClassBreaksResponse=function(){var B=H._asyncToGenerator(function*(z){const {field:p,
valueExpression:r,normalizationField:D,normalizationType:J,normalizationTotal:K,classificationMethod:F,standardDeviationInterval:A,minValue:I,maxValue:G,numClasses:E,scale:M}=z;z=yield this._getDataValues({field:p,valueExpression:r,normalizationField:D,normalizationType:J,normalizationTotal:K,scale:M});z=g.calculateClassBreaks(z,{field:p,normalizationField:D,normalizationType:J,normalizationTotal:K,classificationMethod:F,standardDeviationInterval:A,minValue:I,maxValue:G,numClasses:E});return g.resolveCBResult(z,
F)});return function(z){return B.apply(this,arguments)}}();v.createHistogramResponse=function(){var B=H._asyncToGenerator(function*(z){const {field:p,valueExpression:r,normalizationField:D,normalizationType:J,normalizationTotal:K,classificationMethod:F,standardDeviationInterval:A,minValue:I,maxValue:G,numBins:E,scale:M}=z;z=yield this._getDataValues({field:p,valueExpression:r,normalizationField:D,normalizationType:J,normalizationTotal:K,scale:M});return g.calculateHistogram(z,{field:p,normalizationField:D,
normalizationType:J,normalizationTotal:K,classificationMethod:F,standardDeviationInterval:A,minValue:I,maxValue:G,numBins:E})});return function(z){return B.apply(this,arguments)}}();v._sortFeatures=function(B,z,p){if(1<B.length&&z&&z.length)for(const r of z.reverse()){z=r.split(" ");const D=z[0],J=this.fieldsIndex.get(D);z=z[1]?"desc"===z[1].toLowerCase():!1;const K=g.getAttributeComparator(J?.type,z);B.sort((F,A)=>{F=p(F,D,J);A=p(A,D,J);return K(F,A)})}};v._createFeatureQueryResponse=function(B){const z=
this.items,{geometryType:p,hasM:r,hasZ:D,objectIdField:J,spatialReference:K}=this,{outFields:F,outSR:A,quantizationParameters:I,resultRecordCount:G,resultOffset:E,returnZ:M,returnM:T}=B,Y=null!=G?z.length>(E||0)+G:!1,fa=F&&(F.includes("*")?[...this.fieldsIndex.fields]:F.map(ba=>this.fieldsIndex.get(ba)));return{exceededTransferLimit:Y,features:this._createFeatures(B,z),fields:fa,geometryType:p,hasM:r&&T,hasZ:D&&M,objectIdFieldName:J,spatialReference:f.cleanFromGeometryEngine(A?A:K),transform:I&&x.toQuantizationTransform(I)||
null}};v._createFeatures=function(B,z){const p=new h(B,this.featureAdapter,this.fieldsIndex),{hasM:r,hasZ:D}=this,{orderByFields:J,quantizationParameters:K,returnGeometry:F,returnCentroid:A,maxAllowableOffset:I,resultOffset:G,resultRecordCount:E,returnZ:M=!1,returnM:T=!1}=B,Y=D&&M,fa=r&&T;B=[];var ba=0;z=[...z];this._sortFeatures(z,J,(Q,Z,X)=>p.getFieldValue(Q,Z,X));if(F||A){var U=x.toQuantizationTransform(K)??void 0;if(F&&!A)for(var P of z)B[ba++]={attributes:p.getAttributes(P),geometry:f.getGeometry(this.geometryType,
this.hasZ,this.hasM,this.featureAdapter.getGeometry(P),I,U,Y,fa)};else if(!F&&A)for(const Q of z)B[ba++]={attributes:p.getAttributes(Q),centroid:f.transformCentroid(this,this.featureAdapter.getCentroid(Q,this),U)};else for(const Q of z)B[ba++]={attributes:p.getAttributes(Q),centroid:f.transformCentroid(this,this.featureAdapter.getCentroid(Q,this),U),geometry:f.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(Q),I,U,Y,fa)}}else for(U of z)(P=p.getAttributes(U))&&(B[ba++]=
{attributes:P});ba=G||0;null!=E&&(B=B.slice(ba,Math.min(B.length,ba+E)));return B};v._createExceedsLimitQueryResponse=function(B){var z=!1;let p=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY;z=Number.POSITIVE_INFINITY;for(const D of B.outStatistics??[])if("exceedslimit"===D.statisticType){p=null!=D.maxPointCount?D.maxPointCount:Number.POSITIVE_INFINITY;r=null!=D.maxRecordCount?D.maxRecordCount:Number.POSITIVE_INFINITY;z=null!=D.maxVertexCount?D.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===
this.geometryType)z=this.items.length>p;else if(this.items.length>r)z=!0;else{B=b(this.hasZ,this.hasM);const D=this.featureAdapter;z=this.items.reduce((J,K)=>{K=D.getGeometry(K);return J+(C.isSome(K)&&K.coords.length||0)},0)/B>z}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(z)}}]}};v._createStatisticsQueryResponse=function(){var B=H._asyncToGenerator(function*(z){var p=
{attributes:{}};const r=[],D=new Map,J=new Map,K=new Map,F=new Map,A=new h(z,this.featureAdapter,this.fieldsIndex);var I=z.outStatistics;const {groupByFieldsForStatistics:G,having:E,orderByFields:M}=z;z=G&&G.length;const T=!!z,Y=T?G[0]:null,fa=T&&!this.fieldsIndex.get(Y);for(const Z of I??[]){const {outStatisticFieldName:X,statisticType:sa}=Z;I=Z;var ba="exceedslimit"!==sa?Z.onStatisticField:void 0;const Aa="percentile_disc"===sa||"percentile_cont"===sa,Da="EnvelopeAggregate"===sa||"CentroidAggregate"===
sa||"ConvexHullAggregate"===sa,ha=T&&1===z&&(ba===Y||fa)&&"count"===sa;if(T){if(!K.has(ba)){var U=[];for(const Ea of G){var P=this._getAttributeValues(A,Ea,D);U.push(P)}K.set(ba,this._calculateUniqueValues(U,Da?!1:A.returnDistinctValues))}U=K.get(ba);for(const Ea in U){const {count:za,data:N,items:S,itemPositions:ea}=U[Ea];P=N.join(",");if(!E||A.validateItems(S,E)){const oa=F.get(P)||{attributes:{}};if(Da){oa.aggregateGeometries||(oa.aggregateGeometries={});const {aggregateGeometries:W,outStatisticFieldName:ca}=
yield this._getAggregateGeometry(I,S);oa.aggregateGeometries[ca]=W}else{var Q=null;if(ha)Q=za;else{const W=this._getAttributeValues(A,ba,D);Q=ea.map(ca=>W[ca]);Q=Aa&&"statisticParameters"in I?this._getPercentileValue(I,Q):this._getStatisticValue(I,Q,null,A.returnDistinctValues)}oa.attributes[X]=Q}let va=0;G.forEach((W,ca)=>oa.attributes[this.fieldsIndex.get(W)?W:`EXPR_${++va}`]=N[ca]);F.set(P,oa)}}}else if(Da){p.aggregateGeometries||(p.aggregateGeometries={});const {aggregateGeometries:Ea,outStatisticFieldName:za}=
yield this._getAggregateGeometry(I,this.items);p.aggregateGeometries[za]=Ea}else ba=this._getAttributeValues(A,ba,D),p.attributes[X]=Aa&&"statisticParameters"in I?this._getPercentileValue(I,ba):this._getStatisticValue(I,ba,J,A.returnDistinctValues);r.push({name:X,alias:X,type:"esriFieldTypeDouble"})}p=T?Array.from(F.values()):[p];this._sortFeatures(p,M,(Z,X)=>Z.attributes[X]);return{fields:r,features:p}});return function(z){return B.apply(this,arguments)}}();v._getAggregateGeometry=function(){var B=
H._asyncToGenerator(function*(z,p){var r=yield new Promise((M,T)=>u(["../../../geometry/geometryEngineJSON"],M,T));const {statisticType:D,outStatisticFieldName:J}=z,{featureAdapter:K,spatialReference:F,geometryType:A,hasZ:I,hasM:G}=this;p=p.map(M=>f.getGeometry(A,I,G,K.getGeometry(M)));const E=r.convexHull(F,p,!0)[0];z={aggregateGeometries:null,outStatisticFieldName:null};"EnvelopeAggregate"===D?(r=E?y.getPolygonExtent(E):y.getGeometryExtent(r.union(F,p)),z.aggregateGeometries={...r,spatialReference:F},
z.outStatisticFieldName=J||"extent"):"CentroidAggregate"===D?(r=E?w.polygonCentroid(E):w.extentCentroid(y.getGeometryExtent(r.union(F,p))),z.aggregateGeometries={x:r[0],y:r[1],spatialReference:F},z.outStatisticFieldName=J||"centroid"):"ConvexHullAggregate"===D&&(z.aggregateGeometries=E,z.outStatisticFieldName=J||"convexHull");return z});return function(z,p){return B.apply(this,arguments)}}();v._getStatisticValue=function(B,z,p,r){const {onStatisticField:D,statisticType:J}=B;B=null;B=p?.has(D)?p.get(D):
k.isStringField(this.fieldsIndex.get(D))?g.calculateStringStatistics({values:z,returnDistinct:r}):g.calculateStatistics({values:r?[...(new Set(z))]:z,minValue:null,maxValue:null,useSampleStdDev:!0});p&&p.set(D,B);return B["var"===J?"variance":J]};v._getPercentileValue=function(B,z){const {onStatisticField:p,statisticParameters:r,statisticType:D}=B,{value:J,orderBy:K}=r;B=this.fieldsIndex.get(p);return g.calculatePercentile(z,{value:J,orderBy:K,fieldType:B?.type,isDiscrete:"percentile_disc"===D})};
v._getAttributeValues=function(B,z,p){if(p.has(z))return p.get(z);const r=this.fieldsIndex.get(z),D=this.items.map(J=>B.getFieldValue(J,z,r));p.set(z,D);return D};v._getAttributeDataValues=function(B,z){return this.items.map(p=>B.getDataValue(p,{field:z.field,field2:z.field2,field3:z.field3,fieldDelimiter:z.fieldDelimiter,normalizationField:z.normalizationField,normalizationType:z.normalizationType,normalizationTotal:z.normalizationTotal}))};v._getAttributeExpressionValues=function(){var B=H._asyncToGenerator(function*(z,
p,r){const {arcadeUtils:D}=yield e.loadArcade();p=D.createFunction(p);r=r&&D.getViewInfo(r);return z.getExpressionValues(this.items,p,r,D)});return function(z,p,r){return B.apply(this,arguments)}}();v._calculateUniqueValues=function(B,z){const p={},r=this.items,D=r.length;for(let J=0;J<D;J++){const K=r[J],F=[];for(const I of B)F.push(I[J]);const A=F.join(",");null==p[A]?p[A]={count:1,data:F,items:[K],itemPositions:[J]}:(z||p[A].count++,p[A].items.push(K),p[A].itemPositions.push(J))}return p};v._getDataValues=
function(){var B=H._asyncToGenerator(function*(z){const p=new h(this.query,this.featureAdapter,this.fieldsIndex),{valueExpression:r,field:D,normalizationField:J,normalizationType:K,normalizationTotal:F,scale:A}=z,I=r?{viewingMode:"map",scale:A,spatialReference:this.query.outSR||this.spatialReference}:null;return r?this._getAttributeExpressionValues(p,r,I):this._getAttributeDataValues(p,{field:D,field2:z.field2,field3:z.field3,fieldDelimiter:z.fieldDelimiter,normalizationField:J,normalizationType:K,
normalizationTotal:F})});return function(z){return B.apply(this,arguments)}}();H._createClass(n,[{key:"size",get:function(){return this.items.length}}]);return n}();t.SnappingTypes=void 0;(function(n){n[n.NONE=0]="NONE";n[n.EDGE=1]="EDGE";n[n.VERTEX=2]="VERTEX"})(t.SnappingTypes||(t.SnappingTypes={}));let q=function(){function n(v,B){this.coords=v;this.coordsIndex=B}H._createClass(n,[{key:"x",get:function(){return this.coords[this.coordsIndex]}},{key:"y",get:function(){return this.coords[this.coordsIndex+
1]}},{key:"z",get:function(){return this.coords[this.coordsIndex+2]}}]);return n}();t.QueryEngineResult=l;Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/quantizationUtils":function(){define(["exports","../../core/maybe","./jsonUtils"],function(u,t,H){function C({scale:J,translate:K},F){return Math.round((F-K[0])/J[0])}function w({scale:J,translate:K},F){return Math.round((K[1]-F)/J[1])}function y(J,K,F){const A=[];let I,G,E,M;for(let T=0;T<F.length;T++){const Y=
F[T];if(0<T){if(E=C(J,Y[0]),M=w(J,Y[1]),E!==I||M!==G)A.push(K(Y,E-I,M-G)),I=E,G=M}else I=C(J,Y[0]),G=w(J,Y[1]),A.push(K(Y,I,G))}return 0<A.length?A:null}function x(J,K,F,A){return y(J,F?A?D:r:A?r:p,K)}function m(J,K,F,A){const I=[];F=F?A?D:r:A?r:p;for(A=0;A<K.length;A++){const G=y(J,F,K[A]);G&&3<=G.length&&I.push(G)}return I.length?I:null}function h(J,K,F,A){const I=[];F=F?A?D:r:A?r:p;for(A=0;A<K.length;A++){const G=y(J,F,K[A]);G&&2<=G.length&&I.push(G)}return I.length?I:null}function c({scale:J,
translate:K},F){return F*J[0]+K[0]}function d({scale:J,translate:K},F){return K[1]-F*J[1]}function f(J,K,F){const A=Array(F.length);if(!F.length)return A;const [I,G]=J.scale;let E=c(J,F[0][0]);J=d(J,F[0][1]);A[0]=K(F[0],E,J);for(let M=1;M<F.length;M++){const T=F[M];E+=T[0]*I;J-=T[1]*G;A[M]=K(T,E,J)}return A}function k(J,K,F){const A=Array(F.length);for(let I=0;I<F.length;I++)A[I]=f(J,K,F[I]);return A}function g(J,K,F,A){return f(J,F?A?D:r:A?r:p,K)}function e(J,K,F,A){return k(J,F?A?D:r:A?r:p,K)}function a(J,
K,F,A){return k(J,F?A?D:r:A?r:p,K)}function b(J,K,F){let [A,I]=F[0],G=Math.min(A,K[0]),E=Math.min(I,K[1]),M=Math.max(A,K[2]);K=Math.max(I,K[3]);for(let T=1;T<F.length;T++){const [Y,fa]=F[T];A+=Y;I+=fa;0>Y&&(G=Math.min(G,A));0<Y&&(M=Math.max(M,A));0>fa?E=Math.min(E,I):0<fa&&(K=Math.max(K,I))}J[0]=G;J[1]=E;J[2]=M;J[3]=K;return J}function l(J,K){if(!K.length)return null;J[0]=J[1]=Number.POSITIVE_INFINITY;J[2]=J[3]=Number.NEGATIVE_INFINITY;for(let F=0;F<K.length;F++)b(J,J,K[F]);return J}function q(J,
K,F,A,I){K.xmin=C(J,F.xmin);K.ymin=w(J,F.ymin);K.xmax=C(J,F.xmax);K.ymax=w(J,F.ymax);K!==F&&(A&&(K.zmin=F.zmin,K.zmax=F.zmax),I&&(K.mmin=F.mmin,K.mmax=F.mmax));return K}function n(J,K,F,A,I){K.points=x(J,F.points,A,I)??[];return K}function v(J,K,F,A,I){K.x=C(J,F.x);K.y=w(J,F.y);K!==F&&(A&&(K.z=F.z),I&&(K.m=F.m));return K}function B(J,K,F,A,I){J=m(J,F.rings,A,I);if(!J)return null;K.rings=J;return K}function z(J,K,F,A,I){J=h(J,F.paths,A,I);if(!J)return null;K.paths=J;return K}const p=(J,K,F)=>[K,F],
r=(J,K,F)=>[K,F,J[2]],D=(J,K,F)=>[K,F,J[2],J[3]];u.equals=function(J,K){if(J===K||null==J&&null==K)return!0;if(null==J||null==K)return!1;let F,A,I,G;J&&"upperLeft"===J.originPosition?(F=J.translate[0],A=J.translate[1],J=J.scale[0]):(F=t.isSome(J.extent)?J.extent.xmin:0,A=t.isSome(J.extent)?J.extent.ymax:0,J=J.tolerance);K&&"upperLeft"===K.originPosition?(I=K.translate[0],G=K.translate[1],K=K.scale[0]):(I=t.isSome(K.extent)?K.extent.xmin:0,G=t.isSome(K.extent)?K.extent.ymax:0,K=K.tolerance);return F===
I&&A===G&&J===K};u.getQuantizedBoundsCoordsArray=b;u.getQuantizedBoundsCoordsArrayArray=l;u.getQuantizedBoundsPaths=function(J){return l([0,0,0,0],J)};u.getQuantizedBoundsPoints=function(J){const K=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return b(K,K,J)};u.getQuantizedBoundsRings=function(J){return l([0,0,0,0],J)};u.quantizeBounds=function(J,K,F){K[0]=C(J,F[0]);K[3]=w(J,F[1]);K[2]=C(J,F[2]);K[1]=w(J,F[3]);return K};u.quantizeExtent=q;u.quantizeGeometry=
function(J,K){return J&&K?H.isPoint(K)?v(J,{},K,!1,!1):H.isPolyline(K)?z(J,{},K,!1,!1):H.isPolygon(K)?B(J,{},K,!1,!1):H.isMultipoint(K)?n(J,{},K,!1,!1):H.isExtent(K)?q(J,{},K,!1,!1):null:null};u.quantizeMultipoint=n;u.quantizePaths=h;u.quantizePoint=v;u.quantizePoints=x;u.quantizePolygon=B;u.quantizePolyline=z;u.quantizeRings=m;u.quantizeX=C;u.quantizeY=w;u.toQuantizationTransform=function(J){return J?{originPosition:"upper-left"===J.originPosition?"upperLeft":"lower-left"===J.originPosition?"lowerLeft":
J.originPosition,scale:J.tolerance?[J.tolerance,J.tolerance]:[1,1],translate:t.isSome(J.extent)?[J.extent.xmin,J.extent.ymax]:[0,0]}:null};u.unquantizeBounds=function(J,K,F){return F?(K[0]=c(J,F[0]),K[1]=d(J,F[3]),K[2]=c(J,F[2]),K[3]=d(J,F[1]),K):[c(J,K[0]),d(J,K[3]),c(J,K[2]),d(J,K[1])]};u.unquantizeCoordsArray=f;u.unquantizeCoordsArrayArray=k;u.unquantizeExtent=function(J,K,F,A,I){K.xmin=c(J,F.xmin);K.ymin=d(J,F.ymin);K.xmax=c(J,F.xmax);K.ymax=d(J,F.ymax);K!==F&&(A&&(K.zmin=F.zmin,K.zmax=F.zmax),
I&&(K.mmin=F.mmin,K.mmax=F.mmax));return K};u.unquantizeMultipoint=function(J,K,F,A,I){t.isSome(F)&&(K.points=g(J,F.points,A,I));return K};u.unquantizePaths=e;u.unquantizePoint=function(J,K,F,A,I){if(t.isNone(F))return K;K.x=c(J,F.x);K.y=d(J,F.y);K!==F&&(A&&(K.z=F.z),I&&(K.m=F.m));return K};u.unquantizePoints=g;u.unquantizePolygon=function(J,K,F,A,I){t.isSome(F)&&(K.rings=a(J,F.rings,A,I));return K};u.unquantizePolyline=function(J,K,F,A,I){t.isSome(F)&&(K.paths=e(J,F.paths,A,I));return K};u.unquantizeRings=
a;u.unquantizeX=c;u.unquantizeY=d;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/AttributesBuilder":function(){define(["../../../core/maybe","./attributeSupport","../../../statistics/utils"],function(u,t,H){return function(){function C(y,x,m){this._fieldDataCache=new Map;this._returnDistinctMap=new Map;this.returnDistinctValues=y.returnDistinctValues??!1;this.fieldsIndex=m;this.featureAdapter=x;if((x=y.outFields)&&!x.includes("*")){this.outFields=x;y=0;
for(const c of x){var h=t.getExpressionFromFieldName(c);h=(x=this.fieldsIndex.get(h))?null:t.getWhereClause(h,m);x=x?x.name:t.getAliasFromFieldName(c)||`FIELD_EXP_${y++}`;this._fieldDataCache.set(c,{alias:x,clause:h})}}}var w=C.prototype;w.countDistinctValues=function(y){if(!this.returnDistinctValues)return y.length;y.forEach(x=>this.getAttributes(x));return this._returnDistinctMap.size};w.getAttributes=function(y){y=this._processAttributesForOutFields(y);return this._processAttributesForDistinctValues(y)};
w.getFieldValue=function(y,x,m){const h=m?m.name:x;let c=null;this._fieldDataCache.has(h)?c=this._fieldDataCache.get(h)?.clause:m||(c=t.getWhereClause(x,this.fieldsIndex),this._fieldDataCache.set(h,{alias:h,clause:c}));return m?this.featureAdapter.getAttribute(y,h):c?.calculateValue(y,this.featureAdapter)};w.getDataValue=function(y,x){const m=x.normalizationType,h=x.normalizationTotal;let c=x.field&&this.getFieldValue(y,x.field,this.fieldsIndex.get(x.field));x.field2&&(c=`${H.processNullValue(c)}${x.fieldDelimiter}${H.processNullValue(this.getFieldValue(y,
x.field2,this.fieldsIndex.get(x.field2)))}`,x.field3&&(c=`${c}${x.fieldDelimiter}${H.processNullValue(this.getFieldValue(y,x.field3,this.fieldsIndex.get(x.field3)))}`));m&&Number.isFinite(c)&&(y="field"===m&&x.normalizationField?this.getFieldValue(y,x.normalizationField,this.fieldsIndex.get(x.normalizationField)):null,c=H.getNormalizedValue(c,m,y,h));return c};w.getExpressionValue=function(y,x,m,h){y={attributes:this.featureAdapter.getAttributes(y),layer:{fields:this.fieldsIndex.fields}};m=h.createExecContext(y,
m);return h.executeFunction(x,m)};w.getExpressionValues=function(y,x,m,h){const c={fields:this.fieldsIndex.fields};return y.map(d=>{d={attributes:this.featureAdapter.getAttributes(d),layer:c};d=h.createExecContext(d,m);return h.executeFunction(x,d)})};w.validateItem=function(y,x){this._fieldDataCache.has(x)||this._fieldDataCache.set(x,{alias:x,clause:t.getWhereClause(x,this.fieldsIndex)});return this._fieldDataCache.get(x)?.clause?.testFeature(y,this.featureAdapter)??!1};w.validateItems=function(y,
x){this._fieldDataCache.has(x)||this._fieldDataCache.set(x,{alias:x,clause:t.getWhereClause(x,this.fieldsIndex)});return this._fieldDataCache.get(x)?.clause?.testSet(y,this.featureAdapter)??!1};w._processAttributesForOutFields=function(y){const x=this.outFields;if(!x||!x.length)return this.featureAdapter.getAttributes(y);const m={};for(const h of x){const {alias:c,clause:d}=this._fieldDataCache.get(h);m[c]=d?d.calculateValue(y,this.featureAdapter):this.featureAdapter.getAttribute(y,c)}return m};w._processAttributesForDistinctValues=
function(y){if(u.isNone(y)||!this.returnDistinctValues)return y;var x=this.outFields,m=[];if(x)for(const c of x){var {alias:h}=this._fieldDataCache.get(c);m.push(y[h])}else for(h in y)m.push(y[h]);x=`${(x||["*"]).join(",")}=${m.join(",")}`;m=this._returnDistinctMap.get(x)||0;this._returnDistinctMap.set(x,++m);return 1<m?null:y};return C}()})},"esri/statistics/utils":function(){define(["exports","../rest/support/ClassBreaksDefinition","../rest/support/generateRendererUtils"],function(u,t,H){function C(z){return null==
z||"string"===typeof z&&!z?"\x3cNull\x3e":z}function w(z){const p=null!=z.minValue||null!=z.maxValue,r=!!z.sqlExpression&&z.supportsSQLExpression;return!(null!=z.normalizationField||null!=z.normalizationType)&&!p&&!r}function y(z){const {values:p,useSampleStdDev:r,supportsNullCount:D}=z;var J=Number.POSITIVE_INFINITY;let K=Number.NEGATIVE_INFINITY,F=null,A=null;var I=null;let G=null,E=0;const M=null==z.minValue?-Infinity:z.minValue,T=null==z.maxValue?Infinity:z.maxValue;for(const Y of p)Number.isFinite(Y)?
Y>=M&&Y<=T&&(F=null===F?Y:F+Y,J=Math.min(J,Y),K=Math.max(K,Y),E++):"string"===typeof Y&&E++;if(E&&null!=F){A=F/E;I=0;for(const Y of p)Number.isFinite(Y)&&Y>=M&&Y<=T&&(I+=(Y-A)**2);G=r?1<E?I/(E-1):0:0<E?I/E:0;I=Math.sqrt(G)}else K=J=null;J={avg:A,count:E,max:K,min:J,stddev:I,sum:F,variance:G};D&&(J.nullcount=p.length-E);z.percentileParams&&(J.median=x(p,z.percentileParams));return J}function x(z,p){const {fieldType:r,value:D,orderBy:J,isDiscrete:K}=p,F=m(r,"desc"===J);z=[...z].filter(E=>null!=E).sort((E,
M)=>F(E,M));if(0===z.length)return null;if(0>=D)return z[0];if(1<=D)return z[z.length-1];var A=(z.length-1)*D,I=Math.floor(A);p=I+1;A%=1;I=z[I];const G=z[p];return p>=z.length||K||"string"===typeof I||"string"===typeof G?I:I*(1-A)+G*A}function m(z,p){const r=p?1:-1,D=d(p),J=c(p);if(!z||!["esriFieldTypeDate","esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID",...v].includes(z))return(K,F)=>"number"===typeof K&&"number"===typeof F?D(K,F):"string"===typeof K&&"string"===typeof F?J(K,F):
r;if("esriFieldTypeDate"===z)return(K,F)=>{K=(new Date(K)).getTime();F=(new Date(F)).getTime();return isNaN(K)||isNaN(F)?r:D(K,F)};if(v.has(z))return(K,F)=>D(K,F);if("esriFieldTypeString"===z)return(K,F)=>J(K,F);if("esriFieldTypeGUID"===z||"esriFieldTypeGlobalID"===z){const K=c(p);return(F,A)=>K(f(F),f(A))}return p?(K,F)=>1:(K,F)=>-1}function h(z,p,r){if(r){if(null==z)return null==p?0:1;if(null==p)return-1}else{if(null==z)return null==p?0:-1;if(null==p)return 1}return null}function c(z){return z?
(p,r)=>{const D=h(p,r,!0);if(null!=D)return D;p=p.toUpperCase();r=r.toUpperCase();return p>r?-1:p<r?1:0}:(p,r)=>{const D=h(p,r,!1);if(null!=D)return D;p=p.toUpperCase();r=r.toUpperCase();return p<r?-1:p>r?1:0}}function d(z){return z?(p,r)=>{const D=h(p,r,!0);return null!=D?D:r-p}:(p,r)=>{const D=h(p,r,!1);return null!=D?D:p-r}}function f(z){return z.substr(24,12)+z.substr(19,4)+z.substr(16,2)+z.substr(14,2)+z.substr(11,2)+z.substr(9,2)+z.substr(6,2)+z.substr(4,2)+z.substr(2,2)+z.substr(0,2)}function k(z){return"coded-value"!==
z?.type?[]:z.codedValues.map(p=>p.code)}function g(z,p){const r=a({field:p.field,normalizationType:p.normalizationType,normalizationField:p.normalizationField,classificationMethod:p.classificationMethod,standardDeviationInterval:p.standardDeviationInterval,breakCount:p.numClasses||5});z=e(z,p.minValue,p.maxValue);return H.createGenerateRendererClassBreaks({definition:r,values:z,normalizationTotal:p.normalizationTotal})}function e(z,p,r){const D=null==p?-Infinity:p,J=null==r?Infinity:r;return z.filter(K=>
Number.isFinite(K)&&K>=D&&K<=J)}function a(z){const {breakCount:p,field:r,normalizationField:D,normalizationType:J}=z,K=z.classificationMethod||"equal-interval";return new t({breakCount:p,classificationField:r,classificationMethod:K,normalizationField:"field"===J?D:void 0,normalizationType:J,standardDeviationInterval:"standard-deviation"===K?z.standardDeviationInterval||1:void 0})}function b(z,p){const {field:r,classificationMethod:D,standardDeviationInterval:J,normalizationType:K,normalizationField:F,
normalizationTotal:A,minValue:I,maxValue:G}=p,E=p.numBins||10;let M=p=null,T=null;D&&"equal-interval"!==D||K?({classBreaks:z}=g(z,{field:r,normalizationType:K,normalizationField:F,normalizationTotal:A,classificationMethod:D,standardDeviationInterval:J,minValue:I,maxValue:G,numClasses:E}),p=z[0].minValue,M=z[z.length-1].maxValue,T=z.map(Y=>[Y.minValue,Y.maxValue])):(null!=I&&null!=G?(p=I,M=G):(z=y({values:z,minValue:I,maxValue:G,useSampleStdDev:!K,supportsNullCount:w({normalizationType:K,normalizationField:F,
minValue:I,maxValue:G})}),p=z.min??null,M=z.max??null),T=q(p??0,M??0,E));return{min:p,max:M,intervals:T}}function l(z,p){let r=-1;for(let D=z.length-1;0<=D;D--)if(p>=z[D][0]){r=D;break}return r}function q(z,p,r){const D=(p-z)/r,J=[];let K;for(let F=1;F<=r;F++)K=z+D,K=Number(K.toFixed(16)),J.push([z,F===r?p:K]),z=K;return J}const n=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,v=new Set(["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]),B="min max avg stddev count sum variance nullcount median".split(" ");
u.calculateClassBreaks=g;u.calculateHistogram=function(z,p){var r=b(z,p);const D=r.intervals,J=r.min??0;r=r.max??0;const K=D.map((F,A)=>({minValue:D[A][0],maxValue:D[A][1],count:0}));for(const F of z)null!=F&&F>=J&&F<=r&&(z=l(D,F),-1<z&&K[z].count++);return{bins:K,minValue:J,maxValue:r,normalizationTotal:p.normalizationTotal}};u.calculatePercentile=x;u.calculateStatistics=y;u.calculateStringStatistics=function(z){const p=z.returnDistinct?[...(new Set(z.values))]:z.values,r=p.filter(J=>null!=J).length,
D={count:r};z.supportsNullCount&&(D.nullcount=p.length-r);z.percentileParams&&(D.median=x(p,z.percentileParams));return D};u.calculateUniqueValuesCount=function(z){const p={};for(let r of z){if(null==r||"string"===typeof r&&""===r.trim())r=null;null==p[r]?p[r]={count:1,data:r}:p[r].count++}return{count:p}};u.createClassBreaksDefinition=a;u.createUVResult=function(z,p,r,D){z=z.count;const J=[];if(r&&p){r=[];var K=k(p[0]);for(const F of K)if(p[1]){K=k(p[1]);for(const A of K)if(p[2]){K=k(p[2]);for(const I of K)r.push(`${C(F)}${D}${C(A)}${D}${C(I)}`)}else r.push(`${C(F)}${D}${C(A)}`)}else r.push(F);
for(const F of r)z.hasOwnProperty(F)||(z[F]={data:F,count:0})}for(const F in z)p=z[F],J.push({value:p.data,count:p.count,label:p.label});return{uniqueValueInfos:J}};u.getAttributeComparator=m;u.getEqualIntervalBins=q;u.getNormalizedValue=function(z,p,r,D){let J=null;switch(p){case "log":0!==z&&(J=Math.log(z)*Math.LOG10E);break;case "percent-of-total":Number.isFinite(D)&&0!==D&&(J=z/D*100);break;case "field":Number.isFinite(r)&&0!==r&&(J=z/r);break;case "natural-log":0<z&&(J=Math.log(z));break;case "square-root":0<
z&&(J=z**.5)}return J};u.isNullCountSupported=w;u.processNullValue=C;u.processSummaryStatisticsResult=function(z,p){let r;for(r in z)B.includes(r)&&(Number.isFinite(z[r])||(z[r]=null));if(!p)return z;["avg","stddev","variance"].forEach(D=>{null!=z[D]&&(z[D]=Math.ceil(z[D]))});return z};u.resolveCBResult=function(z,p){let r=z.classBreaks;const D=r[0].minValue,J=r[r.length-1].maxValue,K="standard-deviation"===p;r=r.map(F=>{const A=F.label;F={minValue:F.minValue,maxValue:F.maxValue,label:A};if(K&&A){const I=
A.match(n)?.map(G=>+G.trim())??[];2===I.length?(F.minStdDev=I[0],F.maxStdDev=I[1],0>I[0]&&0<I[1]&&(F.hasAvg=!0)):1===I.length&&(A.includes("\x3c")?(F.minStdDev=null,F.maxStdDev=I[0]):A.includes("\x3e")&&(F.minStdDev=I[0],F.maxStdDev=null))}return F});return{minValue:D,maxValue:J,classBreakInfos:r,normalizationTotal:z.normalizationTotal}};u.statisticTypes=B;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/ClassBreaksDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),
function(u,t,H,C,w,y,x,m,h){y=new H.JSONMap({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"});H=new H.JSONMap({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});C=function(c){function d(f){f=c.call(this,f)||this;f.type="class-breaks-definition";f.breakCount=
null;f.classificationField=null;f.classificationMethod=null;f.normalizationField=null;f.normalizationType=null;return f}u._inheritsLoose(d,c);u._createClass(d,[{key:"standardDeviationInterval",set:function(f){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",f)}},{key:"definedInterval",set:function(f){"defined-interval"===this.classificationMethod&&this._set("definedInterval",f)}}]);return d}(C.JSONSupport);t.__decorate([m.enumeration({classBreaksDef:"class-breaks-definition"})],
C.prototype,"type",void 0);t.__decorate([w.property({json:{write:!0}})],C.prototype,"breakCount",void 0);t.__decorate([w.property({json:{write:!0}})],C.prototype,"classificationField",void 0);t.__decorate([w.property({type:String,json:{read:y.read,write:y.write}})],C.prototype,"classificationMethod",void 0);t.__decorate([w.property({json:{write:!0}})],C.prototype,"normalizationField",void 0);t.__decorate([w.property({json:{read:H.read,write:H.write}})],C.prototype,"normalizationType",void 0);t.__decorate([w.property({value:null,
json:{write:!0}})],C.prototype,"standardDeviationInterval",null);t.__decorate([w.property({value:null,json:{write:!0}})],C.prototype,"definedInterval",null);return C=t.__decorate([h.subclass("esri.rest.support.ClassBreaksDefinition")],C)})},"esri/core/accessorSupport/decorators/enumeration":function(){define(["exports","../../jsonMap","./property"],function(u,t,H){u.enumeration=function(C,w={}){C=C instanceof t.JSONMap?C:new t.JSONMap(C,w);C={type:w?.ignoreUnknown??!0?C.apiValues:String,json:{type:C.jsonValues,
read:w?.readOnly?!1:{reader:C.read},write:{writer:C.write}}};void 0!==w?.readOnly&&(C.readOnly=!!w.readOnly);void 0!==w?.default&&(C.json.default=w.default);void 0!==w?.name&&(C.json.name=w.name);void 0!==w?.nonNullable&&(C.nonNullable=w.nonNullable);return H.property(C)};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/generateRendererUtils":function(){define(["exports","../../core/Logger"],function(u,t){function H(k){var g=k.definition;const {classificationMethod:e,
normalizationType:a,definedInterval:b}=g;g=g.breakCount??1;const l=[];var q=k.values;if(0===q.length)return[];q=q.sort((r,D)=>r-D);var n=q[0],v=q[q.length-1];if("equal-interval"===e)if(q.length>=g){q=(v-n)/g;k=n;for(var B=1;B<g;B++){var z=Number((n+B*q).toFixed(6));l.push({minValue:k,maxValue:z,label:C(k,z,a)});k=z}l.push({minValue:k,maxValue:v,label:C(k,v,a)})}else q.forEach(r=>{l.push({minValue:r,maxValue:r,label:C(r,r,a)})});else if("natural-breaks"===e){q=w(q);k=y(q.uniqueValues,k.valueFrequency||
q.valueFrequency,g);for(B=1;B<g;B++)q.uniqueValues.length>B&&(z=Number(q.uniqueValues[k[B]].toFixed(6)),l.push({minValue:n,maxValue:z,label:C(n,z,a)}),n=z);l.push({minValue:n,maxValue:v,label:C(n,v,a)})}else if("quantile"===e)if(q.length>=g&&n!==v){k=Math.ceil(q.length/g);B=0;for(z=1;z<g;z++){var p=k+B-1;p>q.length&&(p=q.length-1);0>p&&(p=0);l.push({minValue:n,maxValue:q[p],label:C(n,q[p],a)});n=q[p];B+=k;k=Math.ceil((q.length-B)/(g-z))}l.push({minValue:n,maxValue:v,label:C(n,v,a)})}else for(g=-1,
v=0;v<q.length;v++)n=q[v],n!==g&&(g=n,l.push({minValue:g,maxValue:n,label:C(g,n,a)}),g=n);else if("standard-deviation"===e)if(k=h(q),B=c(q,k),0===B)l.push({minValue:q[0],maxValue:q[0],label:C(q[0],q[0],a)});else{q=m(n,v,g,k,B)*B;B=0;for(z=g;1<=z;z--)p=Number((k-(z-.5)*q).toFixed(6)),l.push({minValue:n,maxValue:p,label:C(n,p,a)}),n=p,B++;z=Number((k+.5*q).toFixed(6));l.push({minValue:n,maxValue:z,label:C(n,z,a)});n=z;B++;for(p=1;p<=g;p++)z=B===2*g?v:Number((k+(p+.5)*q).toFixed(6)),l.push({minValue:n,
maxValue:z,label:C(n,z,a)}),n=z,B++}else if("defined-interval"===e){if(!b)return l;g=q[0];v=q[q.length-1];q=Math.ceil((v-g)/b);n=g;for(k=1;k<q;k++)B=Number((g+k*b).toFixed(6)),l.push({minValue:n,maxValue:B,label:C(n,B,a)}),n=B;l.push({minValue:n,maxValue:v,label:C(n,v,a)})}return l}function C(k,g,e){let a=null;return a=k===g?e&&"percent-of-total"===e?k+"%":k.toString():e&&"percent-of-total"===e?k+"% - "+g+"%":k+" - "+g}function w(k){const g=[],e=[];let a=Number.MIN_VALUE,b=1,l=-1;for(let q=0;q<k.length;q++){const n=
k[q];n===a?(b++,e[l]=b):null!==n&&(g.push(n),a=n,b=1,e.push(b),l++)}return{uniqueValues:g,valueFrequency:e}}function y(k,g,e){var a=k.length;const b=[];e>a&&(e=a);for(var l=0;l<e;l++)b.push(Math.round(l*a/e-1));b.push(a-1);l=x(b,k,g,e);a=l.mean;l=l.sdcm;var q=e,n=0,v=0;let B=0,z=0,p=!0;for(let D=0;2>D&&p;D++){0===D&&(p=!1);for(var r=0;r<q-1;r++)for(;b[r+1]+1!==b[r+2];)if(b[r+1]+=1,n=d(r,b,k,g),B=n.sbMean,n=n.sbSdcm,v=d(r+1,b,k,g),z=v.sbMean,v=v.sbSdcm,n+v<l[r]+l[r+1])l[r]=n,l[r+1]=v,a[r]=B,a[r+1]=
z,p=!0;else{--b[r+1];break}for(r=q-1;0<r;r--)for(;b[r]!==b[r-1]+1;)if(--b[r],n=d(r-1,b,k,g),B=n.sbMean,n=n.sbSdcm,v=d(r,b,k,g),z=v.sbMean,v=v.sbSdcm,n+v<l[r-1]+l[r])l[r-1]=n,l[r]=v,a[r-1]=B,a[r]=z,p=!0;else{b[r]+=1;break}}p&&(l=x(b,k,g,e));return b}function x(k,g,e,a){let b=[];var l=[],q=[];let n=0;const v=[],B=[];for(var z=0;z<a;z++){var p=d(z,k,g,e);v.push(p.sbMean);B.push(p.sbSdcm);n+=B[z]}p=n;for(z=!0;z||n<p;){z=!1;b=[];for(l=0;l<a;l++)b.push(k[l]);for(q=0;q<a;q++)for(p=k[q]+1;p<=k[q+1];p++)if(l=
g[p],0<q&&p!==k[q+1]&&Math.abs(l-v[q])>Math.abs(l-v[q-1]))k[q]=p;else if(q<a-1&&k[q]!==p-1&&Math.abs(l-v[q])>Math.abs(l-v[q+1])){k[q+1]=p-1;break}p=n;n=0;l=[];q=[];for(let r=0;r<a;r++){l.push(v[r]);q.push(B[r]);const D=d(r,k,g,e);v[r]=D.sbMean;B[r]=D.sbSdcm;n+=B[r]}}if(n>p){for(g=0;g<a;g++)k[g]=b[g],v[g]=l[g],B[g]=q[g];n=p}return{mean:v,sdcm:B}}function m(k,g,e,a,b){k=Math.max(a-k,g-a)/b/e;return 1<=k?1:.5<=k?.5:.25}function h(k){let g=0;for(let e=0;e<k.length;e++)g+=k[e];return g/=k.length}function c(k,
g){let e=0;for(let a=0;a<k.length;a++){const b=k[a];e+=(b-g)*(b-g)}e/=k.length;return Math.sqrt(e)}function d(k,g,e,a){var b=0,l=0;for(var q=g[k]+1;q<=g[k+1];q++){const n=a[q];b+=e[q]*n;l+=n}0>=l&&f.warn("Exception in Natural Breaks calculation");b/=l;l=0;for(q=g[k]+1;q<=g[k+1];q++)l+=a[q]*(e[q]-b)**2;return{sbMean:b,sbSdcm:l}}const f=t.getLogger("esri.rest.support.generateRendererUtils");u.createGenerateRendererClassBreaks=function(k){const {normalizationTotal:g}=k;return{classBreaks:H(k),normalizationTotal:g}};
u.createGenerateRendererUniqueValues=function(k){k=w(k);const g=[],e=k.uniqueValues.length;for(let a=0;a<e;a++){const b=k.uniqueValues[a];g.push({value:b,count:k.valueFrequency[a],label:b.toString()})}return{uniqueValues:g}};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/SnappingCandidate":function(){define(["exports"],function(u){u.makeEdgeCandidate=function(t,H,C,w,y,x=!1){return{objectId:t,target:H,distance:C,type:"edge",start:w,end:y,draped:x}};u.makeVertexCandidate=
function(t,H,C){return{objectId:t,target:H,distance:C,type:"vertex"}};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/utils":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/jsonMap ../../../core/maybe ../../../core/unitUtils ../../../geometry/projection ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ../OptimizedGeometry ./projectionSupport".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f,k,g){function e(){e=H._asyncToGenerator(function*(A,I,G){const {outFields:E,orderByFields:M,groupByFieldsForStatistics:T,outStatistics:Y}=A;if(E)for(var fa=0;fa<E.length;fa++)E[fa]=E[fa].trim();if(M)for(fa=0;fa<M.length;fa++)M[fa]=M[fa].trim();if(T)for(fa=0;fa<T.length;fa++)T[fa]=T[fa].trim();if(Y)for(fa=0;fa<Y.length;fa++)Y[fa].onStatisticField&&(Y[fa].onStatisticField=Y[fa].onStatisticField.trim());A.geometry&&!A.outSR&&(A.outSR=A.geometry.spatialReference);return a(A,
I,G)});return e.apply(this,arguments)}function a(A,I,G){return b.apply(this,arguments)}function b(){b=H._asyncToGenerator(function*(A,I,G){if(!A)return null;var {where:E}=A;A.where=E=E&&E.trim();if(!E||/^1 *= *1$/.test(E)||I&&I===E)A.where=null;if(!A.geometry)return A;I=yield q(A);A.distance=0;A.units=null;"esriSpatialRelEnvelopeIntersects"===A.spatialRel&&({spatialReference:E}=A.geometry,I=m.getGeometryExtent(I),I.spatialReference=E);if(I){yield g.checkProjectionSupport(I.spatialReference,G);E=I.spatialReference;
I=l(I,G)&&h.isExtent(I)?{spatialReference:E,rings:[[[I.xmin,I.ymin],[I.xmin,I.ymax],[I.xmax,I.ymax],[I.xmax,I.ymin],[I.xmin,I.ymin]]]}:I;E=(yield c.normalizeCentralMeridian(h.fromJSON(I)))[0];if(w.isNone(E))throw p;const M="quantizationParameters"in A&&A.quantizationParameters?.tolerance||"maxAllowableOffset"in A&&A.maxAllowableOffset||0;I=M&&l(I,G)?{densificationStep:8*M}:void 0;E=E.toJSON();I=yield g.project(E,E.spatialReference,G,I);if(!I)throw p;I.spatialReference=G;A.geometry=I}return A});return b.apply(this,
arguments)}function l(A,I){if(!A)return!1;const G=A.spatialReference;return(h.isExtent(A)||h.isPolygon(A)||h.isPolyline(A))&&!d.equals(G,I)&&!x.canProjectWithoutEngine(G,I)}function q(A){return n.apply(this,arguments)}function n(){n=H._asyncToGenerator(function*(A){const {distance:I,units:G}=A,E=A.geometry;if(null==I||"vertexAttributes"in E)return E;var M=E.spatialReference;A=G?z.fromJSON(G):y.getUnitString(M);M=M&&(d.isGeographic(M)||d.isWebMercator(M))?E:yield g.checkProjectionSupport(M,d.WGS84).then(()=>
g.project(E,d.WGS84));return(yield v())(M.spatialReference,M,I,A)});return n.apply(this,arguments)}function v(){return B.apply(this,arguments)}function B(){B=H._asyncToGenerator(function*(){return(yield new Promise((A,I)=>u(["../../../geometry/geometryEngineJSON"],A,I))).geodesicBuffer});return B.apply(this,arguments)}const z=new C.JSONMap({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),
p=Object.freeze({}),r=new k,D=new k,J=new k,K={esriGeometryPoint:f.convertToPoint,esriGeometryPolyline:f.convertToPolyline,esriGeometryPolygon:f.convertToPolygon,esriGeometryMultipoint:f.convertToMultipoint},F=(A,I)=>"_geVersion"!==A?I:void 0;t.QUERY_ENGINE_EMPTY_RESULT=p;t.cleanFromGeometryEngine=function(A){return A&&"_geVersion"in A?JSON.parse(JSON.stringify(A,F)):A};t.getGeometry=function(A,I,G,E,M,T,Y=I,fa=G){const ba=I&&Y,U=G&&fa;E=w.isSome(E)?"coords"in E?E:E.geometry:null;if(w.isNone(E))return null;
if(M)return I=f.generalizeOptimizedGeometry(D,E,I,G,A,M,Y,fa),T&&(I=f.quantizeOptimizedGeometry(J,I,ba,U,A,T)),K[A]?.(I,ba,U)??null;if(T)return T=f.quantizeOptimizedGeometry(J,E,I,G,A,T,Y,fa),K[A]?.(T,ba,U)??null;f.removeZMValues(r,E,I,G,Y,fa);return K[A]?.(r,ba,U)??null};t.normalizeQuery=function(A,I,G){return e.apply(this,arguments)};t.normalizeQueryLike=a;t.transformCentroid=function(A,I,G,E=A.hasZ,M=A.hasM){if(w.isNone(I))return null;const T=A.hasZ&&E,Y=A.hasM&&M;return G?(A=f.quantizeOptimizedGeometry(J,
I,A.hasZ,A.hasM,"esriGeometryPoint",G,E,M),f.convertToPoint(A,T,Y)):f.convertToPoint(I,T,Y)};Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/fieldUtils":function(){define("require exports ../../chunks/_rollupPluginBabelHelpers ../../core/Error ../../core/maybe ../../core/object ./domainUtils ../../support/arcadeOnDemand".split(" "),function(u,t,H,C,w,y,x,m){function h(ia,na,ya){if(ia)for(const Ga of ia)(ia=(ia=y.getDeepValue(Ga,na))&&"function"!==typeof ia&&ya.get(ia))&&
y.setDeepValue(Ga,ia.name,na)}function c(ia,na){if(!ia||!na)return[];va.clear();d(va,ia,na);return Array.from(va).sort()}function d(ia,na,ya){if(ya)if(na?.fields?.length)if(ya.includes("*"))for(const {name:Ga}of na.fields)ia.add(Ga);else for(const Ga of ya)f(ia,na,Ga);else if(ya.includes("*"))ia.clear(),ia.add("*");else for(const Ga of ya)null!=Ga&&ia.add(Ga)}function f(ia,na,ya){"string"===typeof ya&&(na?(na=na.get(ya))&&ia.add(na.name):ia.add(ya))}function k(ia,na,ya){return g.apply(this,arguments)}
function g(){g=H._asyncToGenerator(function*(ia,na,ya){if(ya){var {arcadeUtils:Ga}=yield m.loadArcade();ya=Ga.extractFieldNames(ya,na?.fields?.map(Ka=>Ka.name));for(const Ka of ya)f(ia,na,Ka)}});return g.apply(this,arguments)}function e(ia,na,ya){return a.apply(this,arguments)}function a(){a=H._asyncToGenerator(function*(ia,na,ya){if(ya&&"1\x3d1"!==ya){const Ga=(yield new Promise((Ka,Ra)=>u(["../../core/sql/WhereClause"],Ka,Ra))).WhereClause.create(ya,na);if(!Ga.isStandardized)throw new C("fieldUtils:collectFilterFields",
"Where clause is not standardized",{where:ya});d(ia,na,Ga.fieldNames)}});return a.apply(this,arguments)}function b(ia,na){for(const ya of ia)if(ya&&ya.valueType&&ya.valueType===na)return ya.name;return null}function l(){l=H._asyncToGenerator(function*(ia){if(!ia)return[];const na=new Set;yield q(na,ia);return Array.from(na).sort()});return l.apply(this,arguments)}function q(ia,na){return n.apply(this,arguments)}function n(){n=H._asyncToGenerator(function*(ia,na){if(na){var ya=na.elevationInfo?.featureExpressionInfo;
if(ya)return ya.collectRequiredFields(ia,na.fieldsIndex)}});return n.apply(this,arguments)}function v(){v=H._asyncToGenerator(function*(ia,na,ya){if(na&&ya&&"fields"in ya){var Ga=[];Ga.push(B(ia,na,ya.popupTemplate));ya.fields&&Ga.push(...ya.fields.map(function(){var Ka=H._asyncToGenerator(function*(Ra){Ra.onStatisticExpression?k(ia,na.fieldsIndex,Ra.onStatisticExpression.expression):ia.add(Ra.onStatisticField)});return function(Ra){return Ka.apply(this,arguments)}}()));yield Promise.all(Ga)}});return v.apply(this,
arguments)}function B(ia,na,ya){return z.apply(this,arguments)}function z(){z=H._asyncToGenerator(function*(ia,na,ya){const Ga=[];ya?.expressionInfos&&Ga.push(...ya.expressionInfos.map(Ka=>k(ia,na.fieldsIndex,Ka.expression)));ya=ya?.content;if(Array.isArray(ya))for(const Ka of ya)"expression"===Ka.type&&Ka.expressionInfo&&Ga.push(k(ia,na.fieldsIndex,Ka.expressionInfo.expression));yield Promise.all(Ga)});return z.apply(this,arguments)}function p(){p=H._asyncToGenerator(function*(ia,na,ya){na&&(na.timeInfo&&
w.isSome(ya)&&ya.timeExtent&&d(ia,na.fieldsIndex,[na.timeInfo.startField,na.timeInfo.endField]),na.floorInfo&&d(ia,na.fieldsIndex,[na.floorInfo.floorField]),w.isSome(ya)&&w.isSome(ya.where)&&(yield e(ia,na.fieldsIndex,ya.where)))});return p.apply(this,arguments)}function r(){r=H._asyncToGenerator(function*(ia,na,ya){na&&ya&&(yield Promise.all(ya.map(Ga=>D(ia,na,Ga))))});return r.apply(this,arguments)}function D(ia,na,ya){return J.apply(this,arguments)}function J(){J=H._asyncToGenerator(function*(ia,
na,ya){na&&ya&&(ya.valueExpression?yield k(ia,na.fieldsIndex,ya.valueExpression):ya.field&&f(ia,na.fieldsIndex,ya.field))});return J.apply(this,arguments)}function K(){K=H._asyncToGenerator(function*(ia){if(!ia)return[];const na="timeInfo"in ia&&ia.timeInfo;return na?c(ia.fieldsIndex,[ia.trackIdField,na.startField,na.endField]):[]});return K.apply(this,arguments)}function F(){F=H._asyncToGenerator(function*(ia){if(!ia)return[];const na=new Set;yield A(na,ia);return Array.from(na).sort()});return F.apply(this,
arguments)}function A(ia,na){return I.apply(this,arguments)}function I(){I=H._asyncToGenerator(function*(ia,na){const {labelingInfo:ya,fieldsIndex:Ga}=na;ya&&ya.length&&(yield Promise.all(ya.map(Ka=>G(ia,Ga,Ka))))});return I.apply(this,arguments)}function G(ia,na,ya){return E.apply(this,arguments)}function E(){E=H._asyncToGenerator(function*(ia,na,ya){if(ya){var Ga=ya.getLabelExpression();ya=ya.where;"arcade"===Ga.type?yield k(ia,na,Ga.expression):(Ga=Ga.expression.match(/{[^}]*}/g))&&Ga.forEach(Ka=>
{f(ia,na,Ka.slice(1,-1))});yield e(ia,na,ya)}});return E.apply(this,arguments)}function M(ia){return"number"===typeof ia&&!isNaN(ia)&&isFinite(ia)}function T(ia){return null===ia||M(ia)}function Y(ia){return null===ia||W(ia)}function fa(ia){return null!=ia&&"string"===typeof ia}function ba(ia){return null===ia||fa(ia)}function U(){return!0}function P(ia,na){let ya;switch(ia.type){case "date":case "integer":case "long":case "small-integer":case "esriFieldTypeDate":case "esriFieldTypeInteger":case "esriFieldTypeLong":case "esriFieldTypeSmallInteger":ya=
ia.nullable?Y:W;break;case "double":case "single":case "esriFieldTypeSingle":case "esriFieldTypeDouble":ya=ia.nullable?T:M;break;case "string":case "esriFieldTypeString":ya=ia.nullable?ba:fa;break;default:ya=U}return 1===arguments.length?ya:ya(na)}function Q(ia){return null!=ia&&ka.has(ia.type)}function Z(ia,na){return null==ia||ia.nullable&&null===na?null:Q(ia)&&!X(ia.type,Number(na))?t.NumericRangeValidationError.OUT_OF_RANGE:P(ia,na)?ia.domain?x.validateDomainValue(ia.domain,na):null:t.TypeValidationError.INVALID_TYPE}
function X(ia,na){ia="string"===typeof ia?sa(ia):ia;if(!ia)return!1;const ya=ia.min,Ga=ia.max;return ia.isInteger?W(na)&&na>=ya&&na<=Ga:na>=ya&&na<=Ga}function sa(ia){switch(ia){case "esriFieldTypeSmallInteger":case "small-integer":return la;case "esriFieldTypeInteger":case "integer":return ma;case "esriFieldTypeSingle":case "single":return ua;case "esriFieldTypeDouble":case "double":return xa}}function Aa(ia,na,ya){if(!na||!na.attributes||!ia){if(w.isSome(ya))for(var Ga of ia??[])ya.add(Ga);return!0}na=
na.attributes;Ga=!1;for(const Ka of ia)if(!(Ka in na))if(Ga=!0,w.isSome(ya))ya.add(Ka);else break;return Ga}function Da(){Da=H._asyncToGenerator(function*(ia,na){const ya=new Set;for(const Ga of na)yield k(ya,ia.fieldsIndex,Ga);return Array.from(ya).sort()});return Da.apply(this,arguments)}const ha=/^([0-9])/,Ea=/[^a-z0-9_\u0080-\uffff]/gi,za=/_{2,}/g,N=/^_/,S=/_$/,ea="field field2 field3 normalizationField rotationInfo.field proportionalSymbolInfo.field proportionalSymbolInfo.normalizationField colorInfo.field colorInfo.normalizationField".split(" "),
oa=["field","normalizationField"],va=new Set,W=(()=>"isInteger"in Number?Number.isInteger:ia=>"number"===typeof ia&&isFinite(ia)&&Math.floor(ia)===ia)(),ca=["integer","small-integer","single","double"],ka=new Set([...ca,"esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]);t.NumericRangeValidationError=void 0;(t.NumericRangeValidationError||(t.NumericRangeValidationError={})).OUT_OF_RANGE="numeric-range-validation-error::out-of-range";t.TypeValidationError=
void 0;(t.TypeValidationError||(t.TypeValidationError={})).INVALID_TYPE="type-validation-error::invalid-type";const la={min:-32768,max:32767,isInteger:!0},ma={min:-2147483648,max:2147483647,isInteger:!0},ua={min:-3.4E38,max:1.2E38,isInteger:!1},xa={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1};t.collectArcadeFieldNames=k;t.collectElevationFields=q;t.collectFeatureReductionFields=function(ia,na,ya){return v.apply(this,arguments)};t.collectField=f;t.collectFields=d;t.collectFilterFields=
function(ia,na,ya){return p.apply(this,arguments)};t.collectLabelingFields=A;t.collectOrderByInfos=function(ia,na,ya){return r.apply(this,arguments)};t.collectPopupTemplateFields=B;t.doubleRange=xa;t.featureHasFields=function(ia,na){return!Aa(ia,na,null)};t.fixFields=c;t.fixRendererFields=function(ia,na){if(null!=ia&&null!=na)for(const ya of Array.isArray(ia)?ia:[ia])if(h(ea,ya,na),"visualVariables"in ya&&ya.visualVariables)for(const Ga of ya.visualVariables)h(oa,Ga,na)};t.fixTimeInfoFields=function(ia,
na){if(null!=ia&&na?.fields?.length)if("startField"in ia){var ya=na.get(ia.startField);na=na.get(ia.endField);ia.startField=ya?.name??null;ia.endField=na?.name??null}else ya=na.get(ia.startTimeField),na=na.get(ia.endTimeField),ia.startTimeField=ya?.name??null,ia.endTimeField=na?.name??null};t.getDisplayFieldName=function({displayField:ia,fields:na}){if(ia)return ia;if(!na||!na.length)return null;if(!(ia=b(na,"name-or-title")||b(na,"unique-identifier")||b(na,"type-or-category")))a:{for(const ya of na)if(ya&&
ya.name&&(na=ya.name.toLowerCase(),na.includes("name")||na.includes("title"))){ia=ya.name;break a}ia=null}return ia};t.getElevationFields=function(ia){return l.apply(this,arguments)};t.getExpressionFields=function(ia,na){return Da.apply(this,arguments)};t.getFeatureEditFields=function(ia){if(!ia)return[];const na="editFieldsInfo"in ia&&ia.editFieldsInfo;return na?c(ia.fieldsIndex,[na&&na.creatorField,na&&na.creationDateField,na&&na.editorField,na&&na.editDateField]):[]};t.getFeatureGeometryFields=
function(ia){if(!ia)return[];const na=ia.geometryFieldsInfo;return na?c(ia.fieldsIndex,[na.shapeAreaField,na.shapeLengthField]):[]};t.getFieldDefaultValue=function(ia){const na=ia.defaultValue;if(void 0!==na&&P(ia,na))return na;if(ia.nullable)return null};t.getFieldRange=function(ia){const na=x.getDomainRange(ia.domain);if(na)return na;if(Q(ia))return sa(ia.type)};t.getLabelingFields=function(ia){return F.apply(this,arguments)};t.getNumericTypeForValue=function(ia){if(!M(ia))return null;if(W(ia)){if(ia>=
la.min&&ia<=la.max)return"esriFieldTypeSmallInteger";if(ia>=ma.min&&ia<=ma.max)return"esriFieldTypeInteger"}return ia>=ua.min&&ia<=ua.max?"esriFieldTypeSingle":"esriFieldTypeDouble"};t.getTimeFields=function(ia){return K.apply(this,arguments)};t.integerRange=ma;t.isDateField=function(ia){return null!=ia&&("date"===ia.type||"esriFieldTypeDate"===ia.type)};t.isNumberInRange=X;t.isNumericField=Q;t.isRasterPixelValueField=function(ia){return ia?["raster.itempixelvalue","raster.servicepixelvalue"].some(na=>
ia.toLowerCase().startsWith(na)):!1};t.isStringField=function(ia){return null!=ia&&("string"===ia.type||"esriFieldTypeString"===ia.type)};t.isValidFieldValue=function(ia,na){return null===Z(ia,na)};t.isValueMatchingFieldType=P;t.normalizeFieldName=function(ia){return null==ia?null:(ia=ia.trim().replace(Ea,"_").replace(za,"_").replace(N,"").replace(S,"").replace(ha,"F$1"))?ia:null};t.numericTypes=ca;t.packFields=function(ia,na,ya=1){if(!na||!ia)return[];if(na.includes("*"))return["*"];na=c(ia,na);
return na.length/ia.fields.length>=ya?["*"]:na};t.populateMissingFields=Aa;t.rendererFields=ea;t.sanitizeNullFieldValue=function(ia){return null==ia||"number"===typeof ia&&isNaN(ia)?null:ia};t.singleRange=ua;t.smallIntegerRange=la;t.unpackFieldNames=function(ia,na){return w.isNone(na)||w.isNone(ia)?[]:na.includes("*")?(ia.fields??[]).map(ya=>ya.name):na};t.validateFieldValue=Z;t.validationErrorToString=function(ia,na,ya){switch(ia){case x.DomainValidationError.INVALID_CODED_VALUE:return`Value ${ya} is not in the coded domain - field: ${na.name}, domain: ${JSON.stringify(na.domain)}`;
case x.DomainValidationError.VALUE_OUT_OF_RANGE:return`Value ${ya} is out of the range of valid values - field: ${na.name}, domain: ${JSON.stringify(na.domain)}`;case t.TypeValidationError.INVALID_TYPE:return`Value ${ya} is not a valid value for the field type - field: ${na.name}, type: ${na.type}, nullable: ${na.nullable}`;case t.NumericRangeValidationError.OUT_OF_RANGE:const {min:Ga,max:Ka}=sa(na.type);return`Value ${ya} is out of range for the number type - field: ${na.name}, type: ${na.type}, value range is ${Ga} to ${Ka}`}};
t.visualVariableFields=oa;Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/domainUtils":function(){define(["exports"],function(u){u.DomainValidationError=void 0;(function(t){t.VALUE_OUT_OF_RANGE="domain-validation-error::value-out-of-range";t.INVALID_CODED_VALUE="domain-validation-error::invalid-coded-value"})(u.DomainValidationError||(u.DomainValidationError={}));u.getDomainRange=function(t){if(t&&"range"===t.type)return{min:"range"in t?t.range[0]:t.minValue,max:"range"in
t?t.range[1]:t.maxValue}};u.validateDomainValue=function(t,H){switch(t.type){case "range":const C="range"in t?t.range[0]:t.minValue;t="range"in t?t.range[1]:t.maxValue;if(null!=C&&+H<C||null!=t&&+H>t)return u.DomainValidationError.VALUE_OUT_OF_RANGE;break;case "coded-value":if(null==t.codedValues||t.codedValues.every(w=>null==w||w.code!==H))return u.DomainValidationError.INVALID_CODED_VALUE;break;case "codedValue":if(null==t.codedValues||t.codedValues.every(w=>null==w||w.code!==H))return u.DomainValidationError.INVALID_CODED_VALUE}return null};
Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/support/arcadeOnDemand":function(){define("require exports ../chunks/_rollupPluginBabelHelpers ../geometry ../core/Error ../core/Logger ../core/maybe ../geometry/SpatialReference".split(" "),function(u,t,H,C,w,y,x,m){function h(){d||(d=H._asyncToGenerator(function*(){const k=yield new Promise((g,e)=>u(["./arcadeUtils"],g,e));return{arcade:k.arcade,arcadeUtils:k,Dictionary:k.Dictionary,Feature:k.arcadeFeature}})());return d}const c=
y.getLogger("esri.support.arcadeOnDemand");let d;C=(k,g,e)=>f.create(k,g,e,null,["$feature","$view"]);let f=function(){function k(e,a,b,l,q,n,v){this.script=e;this.evaluate=l;this.fields=Array.isArray(n)?n:n.fields;this._syntaxTree=b;this._arcade=a;this._arcadeFeature=q;this._spatialReference=v;this._referencesGeometry=a.scriptTouchesGeometry(this._syntaxTree);this._referencesScale=this._arcade.referencesMember(this._syntaxTree,"scale")}k.create=function(){var e=H._asyncToGenerator(function*(a,b,
l,q,n,v){const {arcade:B,Feature:z,Dictionary:p}=yield h(),r=m.fromJSON(b);let D;try{D=B.parseScript(a,v)}catch(G){return c.error(new w("arcade-bad-expression","Failed to parse arcade script",{script:a,error:G})),null}n=n.reduce((G,E)=>({...G,[E]:null}),{});let J=null;x.isSome(q)&&(J=new p(q),J.immutable=!0,n.$config=null);v=(q=B.scriptUsesGeometryEngine(D))&&B.enableGeometrySupport();const K=B.scriptUsesFeatureSet(D)&&B.enableFeatureSetSupport(),F=(b=B.scriptIsAsync(D))&&B.enableAsyncSupport();n=
{vars:n,spatialReference:r,useAsync:!!F};yield Promise.all([v,K,F]);v=new Set;yield B.loadDependentModules(v,D,null,b,q);const A=new p;A.immutable=!1;A.setField("scale",0);const I=B.compileScript(D,n);return new k(a,B,D,G=>{"$view"in G&&G.$view&&(A.setField("scale","object"===typeof G.$view?G.$view.scale:void 0),G.$view=A);J&&(G.$config=J);return I({vars:G,spatialReference:r})},new z,l,r)});return function(a,b,l,q,n,v){return e.apply(this,arguments)}}();var g=k.prototype;g.repurposeFeature=function(e){e.geometry&&
!e.geometry.spatialReference&&(e.geometry.spatialReference=this._spatialReference);this._arcadeFeature.repurposeFromGraphicLikeObject(e.geometry,e.attributes,{fields:this.fields});return this._arcadeFeature};g.referencesGeometry=function(){return this._referencesGeometry};g.referencesScale=function(){return this._referencesScale};return k}();t.ArcadeExpression=f;t.createDictionaryExpression=(k,g,e,a)=>f.create(k,g,e,a,["$feature","$view"]);t.createLabelExpression=(k,g,e)=>f.create(k,g,e,null,["$feature"]);
t.createRendererExpression=C;t.createVVExpression=C;t.loadArcade=h;Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/spatialQuerySupport":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/Error ../../../geometry/support/contains ../../../geometry/support/intersects ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ../contains ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./utils".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f,k){function g(){return new Promise((l,q)=>u(["../../../geometry/geometryEngineJSON"],l,q))}function e(){e=H._asyncToGenerator(function*(l,q,n){const {spatialRel:v,geometry:B}=l;if(B){if(null==v||!0!==b.spatialRelationship[v])throw new C("feature-store:unsupported-query","Unsupported query spatial relationship",{query:l});if(m.isValid(B.spatialReference)&&m.isValid(n)){if(null==B||!0!==b.queryGeometry[x.getJsonType(B)])throw new C("feature-store:unsupported-query",
"Unsupported query geometry type",{query:l});if(null==q||!0!==b.layerGeometry[q])throw new C("feature-store:unsupported-query","Unsupported layer geometry type",{query:l});if(l.outSR)return f.checkProjectionSupport(l.geometry&&l.geometry.spatialReference,l.outSR)}}});return e.apply(this,arguments)}const a={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,
esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},b={spatialRelationship:{esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},queryGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,
esriGeometryPolygon:!0,esriGeometryEnvelope:!0},layerGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1}};t.canQueryWithRBush=function(l){if(x.isExtent(l))return!0;if(x.isPolygon(l)){for(const q of l.rings)if(5!==q.length||q[0][0]!==q[1][0]||q[0][0]!==q[4][0]||q[2][0]!==q[3][0]||q[0][1]!==q[3][1]||q[0][1]!==q[4][1]||q[1][1]!==q[2][1])return!1;return!0}return!1};t.checkSpatialQuerySupport=function(l,q,n){return e.apply(this,
arguments)};t.getSpatialQueryOperator=function(l,q,n,v,B){if(x.isPolygon(q)&&"esriGeometryPoint"===n&&("esriSpatialRelIntersects"===l||"esriSpatialRelContains"===l)){const z=c.convertFromPolygon(new d,q,!1,!1);return Promise.resolve(p=>h.polygonContainsPoint(z,!1,!1,p))}if(x.isPolygon(q)&&"esriGeometryMultipoint"===n){const z=c.convertFromPolygon(new d,q,!1,!1);if("esriSpatialRelContains"===l)return Promise.resolve(p=>h.polygonContainsMultipoint(z,!1,!1,p,v,B))}if(x.isExtent(q)&&"esriGeometryPoint"===
n&&("esriSpatialRelIntersects"===l||"esriSpatialRelContains"===l))return Promise.resolve(z=>w.extentContainsPoint(q,k.getGeometry(n,v,B,z)));if(x.isExtent(q)&&"esriGeometryMultipoint"===n&&"esriSpatialRelContains"===l)return Promise.resolve(z=>w.extentContainsMultipoint(q,k.getGeometry(n,v,B,z)));if(x.isExtent(q)&&"esriSpatialRelIntersects"===l){const z=y.getExtentIntersector(n);return Promise.resolve(p=>z(q,k.getGeometry(n,v,B,p)))}return g().then(z=>{const p=z[a[l]].bind(null,q.spatialReference,
q);return r=>p(k.getGeometry(n,v,B,r))})};Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/intersects":function(){define(["exports","./intersectsBase"],function(u,t){u.extentIntersectsExtent=t.extentIntersectsExtent;u.extentIntersectsMultipoint=t.extentIntersectsMultipoint;u.extentIntersectsPoint=t.extentIntersectsPoint;u.extentIntersectsPolygon=t.extentIntersectsPolygon;u.extentIntersectsPolyline=t.extentIntersectsPolyline;u.extentIntersectsRings=t.extentIntersectsRings;
u.getFeatureExtentIntersector=t.getFeatureExtentIntersector;u.isSelfIntersecting=t.isSelfIntersecting;u.segmentIntersects=t.segmentIntersects;u.getExtentIntersector=function(H){return"mesh"===H?t.extentIntersectsExtent:t.getFeatureExtentIntersector(H)};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/contains":function(){define(["exports"],function(u){function t(H,C,w,y,x){if(!H)return!1;C=C?w?4:3:w?3:2;const {coords:m,lengths:h}=H;w=!1;H=0;for(const d of h){var c=
H;for(let f=H,k=H+d*C;f<k;f+=C){c=f+C;c===k&&(c=H);const g=m[f],e=m[f+1],a=m[c];c=m[c+1];(e<x&&c>=x||c<x&&e>=x)&&g+(x-e)/(c-e)*(a-g)<y&&(w=!w)}H+=d*C}return w}u.polygonContainsCoords=t;u.polygonContainsMultipoint=function(H,C,w,y,x,m){x=x?m?4:3:m?3:2;const {coords:h,lengths:c}=y;if(!c)return!1;for(let d=0,f=0;d<c.length;d++,f+=x)if(!t(H,C,w,h[f],h[f+1]))return!1;return!0};u.polygonContainsPoint=function(H,C,w,y){return t(H,C,w,y.coords[0],y.coords[1])};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/graphics/data/timeSupport":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers"],function(u,t){function H(){H=t._asyncToGenerator(function*(x,m){if(!x)return null;const h=m.featureAdapter,{startTimeField:c,endTimeField:d}=x;let f=Number.POSITIVE_INFINITY,k=Number.NEGATIVE_INFINITY;if(c&&d)yield m.forEach(g=>{const e=h.getAttribute(g,c);g=h.getAttribute(g,d);null==e||isNaN(e)||(f=Math.min(f,e));null==g||isNaN(g)||(k=Math.max(k,g))});else{const g=c||d;yield m.forEach(e=>
{e=h.getAttribute(e,g);null==e||isNaN(e)||(f=Math.min(f,e),k=Math.max(k,e))})}return{start:f,end:k}});return H.apply(this,arguments)}function C(x,m,h,c,d){if(null!=c&&null!=d)return f=>{const k=x.getAttribute(f,m);f=x.getAttribute(f,h);return(null==k||k<=d)&&(null==f||f>=c)};if(null!=c)return f=>{f=x.getAttribute(f,h);return null==f||f>=c};if(null!=d)return f=>{f=x.getAttribute(f,m);return null==f||f<=d}}function w(x,m,h,c){if(null!=h&&null!=c&&h===c)return d=>x.getAttribute(d,m)===h;if(null!=h&&
null!=c)return d=>{d=x.getAttribute(d,m);return d>=h&&d<=c};if(null!=h)return d=>x.getAttribute(d,m)>=h;if(null!=c)return d=>x.getAttribute(d,m)<=c}function y(){return()=>!1}u.getTimeExtent=function(x,m){return H.apply(this,arguments)};u.getTimeOperator=function(x,m,h){if(!m||!x)return null;const {startTimeField:c,endTimeField:d}=x;if(!c&&!d)return null;const {start:f,end:k}=m;return null===f&&null===k?null:void 0===f&&void 0===k?y():c&&d?C(h,c,d,f,k):w(h,c||d,f,k)};Object.defineProperty(u,Symbol.toStringTag,
{value:"Module"})})},"esri/layers/support/FieldsIndex":function(){define(["../../chunks/_rollupPluginBabelHelpers","./fieldUtils"],function(u,t){function H(w){return"oid"===w.type||"esriFieldTypeOID"===w.type}function C(w){return"global-id"===w.type||"esriFieldTypeGlobalID"===w.type}return function(){function w(x=[]){this.fields=[];this._fieldsMap=new Map;this._normalizedFieldsMap=new Map;this._dateFieldsSet=new Set;this._numericFieldsSet=new Set;this.dateFields=[];this.numericFields=[];this._requiredFields=
null;if(x){this.fields=x;var m=[];for(const h of x){x=h?.name;const c=t.normalizeFieldName(h?.name)?.toLowerCase()??"";if(x&&c){const d=x.trim().toLowerCase();this._fieldsMap.set(x,h);this._fieldsMap.set(d,h);this._normalizedFieldsMap.set(c,h);m.push(d);"date"===h.type||"esriFieldTypeDate"===h.type?(this.dateFields.push(h),this._dateFieldsSet.add(h)):t.isNumericField(h)&&(this._numericFieldsSet.add(h),this.numericFields.push(h));H(h)||C(h)||(h.editable=null==h.editable?!0:!!h.editable,h.nullable=
null==h.nullable?!0:!!h.nullable)}}m.sort();this.uid=m.join(",")}}var y=w.prototype;y.destroy=function(){this._fieldsMap.clear()};y.has=function(x){return null!=this.get(x)};y.get=function(x){if(x){var m=this._fieldsMap.get(x);if(m)return m;(m=this._fieldsMap.get(x.trim().toLowerCase())??this._normalizedFieldsMap.get(t.normalizeFieldName(x)?.toLowerCase()??""))&&this._fieldsMap.set(x,m);return m}};y.isDateField=function(x){return this._dateFieldsSet.has(this.get(x))};y.isNumericField=function(x){return this._numericFieldsSet.has(this.get(x))};
y.normalizeFieldName=function(x){if(x=this.get(x))return x.name??void 0};u._createClass(w,[{key:"requiredFields",get:function(){if(!this._requiredFields){this._requiredFields=[];for(const x of this.fields)H(x)||C(x)||x.nullable||void 0!==t.getFieldDefaultValue(x)||this._requiredFields.push(x)}return this._requiredFields}}]);return w}()})},"esri/views/support/Scheduler":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/Handles ../../core/has ../../core/Logger ../../core/maybe ../../core/PerformanceSampler ../../core/PooledArray ../../core/promiseUtils ../../core/reactiveUtils ../../core/time ../../core/accessorSupport/tracking/ObservableValue ../../layers/support/PromiseQueue ./debugFlags ./RenderState".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f,k,g,e){function a(D){return b.has(D)?b.get(D):"number"===typeof D?D:1}u.Task=void 0;(function(D){D[D.YIELD=1]="YIELD"})(u.Task||(u.Task={}));u.TaskPriority=void 0;(function(D){D.RESOURCE_CONTROLLER_IMMEDIATE="immediate";D.RESOURCE_CONTROLLER="schedule";D.SLIDE="slide";D.STREAM_DATA_LOADER="stream loader";D.ELEVATION_QUERY="elevation query";D.TERRAIN_SURFACE="terrain";D.SURFACE_GEOMETRY_UPDATES="surface geometry updates";D.LOD_RENDERER="LoD renderer";D.GRAPHICS_CORE=
"Graphics3D";D.I3S_CONTROLLER="I3S";D.POINT_CLOUD_LAYER="point cloud";D.FEATURE_TILE_FETCHER="feature fetcher";D.OVERLAY="overlay";D.STAGE="stage";D.GRAPHICS_DECONFLICTOR="graphics deconflictor";D.FILTER_VISIBILITY="Graphics3D filter visibility";D.SCALE_VISIBILITY="Graphics3D scale visibility";D.FRUSTUM_VISIBILITY="Graphics3D frustum visibility";D.POINT_OF_INTEREST_FREQUENT="POI frequent";D.POINT_OF_INTEREST_INFREQUENT="POI infrequent";D.LABELER="labeler";D.FEATURE_QUERY_ENGINE="feature query";D.FEATURE_TILE_TREE=
"feature tile tree";D.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree";D.ELEVATION_ALIGNMENT="elevation alignment";D.TEXT_TEXTURE_ATLAS="text texture atlas";D.TEXTURE_UNLOAD="texture unload";D.LINE_OF_SIGHT_TOOL="line of sight tool";D.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool";D.ELEVATION_PROFILE="elevation profile";D.SNAPPING="snapping";D.SHADOW_ACCUMULATOR="shadow accumulator";D.CLOUDS_GENERATOR="clouds generator";D[D.TEST_PRIO=1]="TEST_PRIO"})(u.TaskPriority||(u.TaskPriority=
{}));const b=new Map([[u.TaskPriority.RESOURCE_CONTROLLER_IMMEDIATE,0],[u.TaskPriority.RESOURCE_CONTROLLER,4],[u.TaskPriority.SLIDE,0],[u.TaskPriority.STREAM_DATA_LOADER,0],[u.TaskPriority.ELEVATION_QUERY,0],[u.TaskPriority.TERRAIN_SURFACE,1],[u.TaskPriority.SURFACE_GEOMETRY_UPDATES,1],[u.TaskPriority.LOD_RENDERER,2],[u.TaskPriority.GRAPHICS_CORE,2],[u.TaskPriority.I3S_CONTROLLER,2],[u.TaskPriority.POINT_CLOUD_LAYER,2],[u.TaskPriority.FEATURE_TILE_FETCHER,2],[u.TaskPriority.OVERLAY,4],[u.TaskPriority.STAGE,
4],[u.TaskPriority.GRAPHICS_DECONFLICTOR,4],[u.TaskPriority.FILTER_VISIBILITY,4],[u.TaskPriority.SCALE_VISIBILITY,4],[u.TaskPriority.FRUSTUM_VISIBILITY,4],[u.TaskPriority.CLOUDS_GENERATOR,4],[u.TaskPriority.POINT_OF_INTEREST_FREQUENT,6],[u.TaskPriority.POINT_OF_INTEREST_INFREQUENT,30],[u.TaskPriority.LABELER,8],[u.TaskPriority.FEATURE_QUERY_ENGINE,8],[u.TaskPriority.FEATURE_TILE_TREE,16],[u.TaskPriority.FEATURE_TILE_TREE_ACTIVE,0],[u.TaskPriority.ELEVATION_ALIGNMENT,12],[u.TaskPriority.TEXT_TEXTURE_ATLAS,
12],[u.TaskPriority.TEXTURE_UNLOAD,12],[u.TaskPriority.LINE_OF_SIGHT_TOOL,16],[u.TaskPriority.LINE_OF_SIGHT_TOOL_INTERACTIVE,0],[u.TaskPriority.SNAPPING,0],[u.TaskPriority.SHADOW_ACCUMULATOR,30]]),l=d.Milliseconds(6.5),q=d.Milliseconds(1),n=d.Milliseconds(30),v=d.Milliseconds(1E3/30),B=d.Milliseconds(100);var z;(function(D){let J=function(){function A(){this._updating=new f.ObservableValue(!0);this._microTaskQueued=!1;this._frameNumber=0;this.performanceInfo={total:new x("total"),tasks:new Map};this._frameTaskTimes=
new Map;this._budget=new F;this._state=e.RenderState.INTERACTING;this._tasks=new m;this._runQueue=new m;this._load=0;this._idleStateCallbacks=new m;this._debug=this._forceTask=this._idleUpdatesStartFired=!1;this._debugHandle=c.watch(()=>g.SCHEDULER_LOG_SLOW_TASKS,E=>this._debug=E,c.initial);for(const E of Object.keys(u.TaskPriority))this.performanceInfo.tasks.set(u.TaskPriority[E],new x(u.TaskPriority[E]));const G=this;this._test={FRAME_SAFETY_BUDGET:l,INTERACTING_BUDGET:v,IDLE_BUDGET:B,get availableBudget(){return G._budget.budget},
usedBudget:0,getBudget:()=>G._budget,setBudget:E=>G._budget=E,updateTask:E=>this._updateTask(E),getState:E=>this._getState(E),getRuntime:E=>this._getRuntime(E),frameTaskTimes:this._frameTaskTimes,resetRuntimes:()=>this._resetRuntimes(),getRunning:()=>this._getRunning()}}var I=A.prototype;I._updatingChanged=function(){this._updating.set(this._tasks.some(G=>G.needsUpdate))};I.destroy=function(){this._tasks.toArray().forEach(G=>G.remove());this._tasks.clear();y.removeMaybe(this._debugHandle);this._microTaskQueued=
!1;this._updatingChanged()};I.taskRunningChanged=function(G){this._updatingChanged();G&&0<this._budget.remaining&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask(()=>{this._microTaskQueued&&(this._microTaskQueued=!1,0<this._budget.remaining&&this._schedule()&&this.frame())}))};I.registerTask=function(G,E){const M=a(G);E=new K(this,G,E,M);this._tasks.push(E);this._updatingChanged();this.performanceInfo.tasks.has(G)||this.performanceInfo.tasks.set(G,new x(G));return E};I.registerIdleStateCallbacks=
function(G,E){const M={idleBegin:G,idleEnd:E};this._idleStateCallbacks.push(M);this.state===e.RenderState.IDLE&&this._idleUpdatesStartFired&&M.idleBegin();const T=this;return{remove:()=>this._removeIdleStateCallbacks(M),set idleBegin(Y){T._idleUpdatesStartFired&&(M.idleEnd(),T._state===e.RenderState.IDLE&&Y());M.idleBegin=Y},set idleEnd(Y){M.idleEnd=Y}}};I.updateBudget=function(G){this._test.usedBudget=0;++this._frameNumber;let E=l,M=G.frameDuration,T=q;switch(this.state){case e.RenderState.IDLE:E=
d.Milliseconds(0);M=d.Milliseconds(Math.max(B,G.frameDuration));T=n;break;case e.RenderState.INTERACTING:M=d.Milliseconds(Math.max(v,G.frameDuration))}M=d.Milliseconds(M-G.elapsedFrameTime-E);if(this.state!==e.RenderState.IDLE&&M<q&&!this._forceTask)return this._forceTask=!0,!1;M=d.Milliseconds(Math.max(M,T));this._budget.reset(M,this.state);this._updateLoad();return this._schedule()};I.frame=function(){this._microTaskQueued=this._forceTask=!1;switch(this.state){case e.RenderState.IDLE:this._idleUpdatesStartFired||
(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll(G=>G.idleBegin()));this._runIdle();break;case e.RenderState.INTERACTING:this._runInteracting();break;default:this._runAnimating()}this._test.usedBudget=this._budget.elapsed};I.stopFrame=function(){this._budget.reset(d.Milliseconds(0),this._state);this._budget.madeProgress()};I._removeIdleStateCallbacks=function(G){this._idleUpdatesStartFired&&G.idleEnd();this._idleStateCallbacks.removeUnordered(G)};I.removeTask=function(G){this._tasks.removeUnordered(G);
this._runQueue.removeUnordered(G);this._updatingChanged()};I._updateTask=function(G){this._tasks.forAll(E=>{E.name===G&&E.setPriority(G)})};I._getState=function(G){if(this._runQueue.some(M=>M.name===G))return u.TaskState.SCHEDULED;let E=u.TaskState.IDLE;this._tasks.forAll(M=>{M.name===G&&M.needsUpdate&&(1>=M.schedulePriority?E=u.TaskState.READY:E!==u.TaskState.READY&&(E=u.TaskState.WAITING))});return E};I._getRuntime=function(G){let E=0;this._tasks.forAll(M=>{M.name===G&&(E+=M.runtime)});return E};
I._resetRuntimes=function(){this._tasks.forAll(G=>G.runtime=0)};I._getRunning=function(){const G=new Map;this._tasks.forAll(M=>{M.needsUpdate&&G.set(M.name,(G.get(M.name)||0)+1)});if(0===G.size)return null;let E="";G.forEach((M,T)=>{E=1<M?E+` ${M}x ${T}`:E+` ${T}`});return E};I._runIdle=function(){this._run()};I._runInteracting=function(){this._run()};I._runAnimating=function(){this._run()};I._updateLoad=function(){const G=this._tasks.reduce((E,M)=>M.needsUpdate?++E:E,0);this._load=.9*this._load+
G*(1-.9)};I._schedule=function(){this._runQueue.filterInPlace(G=>{if(G.needsUpdate)return!0;G.schedulePriority=G.basePriority;return!1});for(this._tasks.forAll(G=>{0===G.basePriority&&G.needsUpdate&&!this._runQueue.includes(G)&&G.blockFrame!==this._frameNumber&&this._runQueue.unshift(G)});0===this._runQueue.length;){let G=!1;this._tasks.forAll(E=>{if(E.needsUpdate&&0!==E.schedulePriority&&0!==E.basePriority&&E.blockFrame!==this._frameNumber)switch(G=!0,E.schedulePriority){case 1:E.schedulePriority=
0;this._runQueue.push(E);break;default:--E.schedulePriority}});if(!G)return this._updatingChanged(),!1}this._updatingChanged();return!0};I._run=function(){const G=this._budget.now();this._startFrameTaskTimes();do for(;0<this._runQueue.length;){var E=this._budget.now();const M=this._runQueue.pop();this._budget.resetProgress();try{M.task.runTask(this._budget)===u.Task.YIELD&&(M.blockFrame=this._frameNumber)}catch(T){w.getLogger("esri.views.support.Scheduler").error(`Exception in task "${M.name}"`,T)}!this._budget.hasProgressed&&
M.blockFrame!==this._frameNumber&&M.needsUpdate&&(M.blockFrame=this._frameNumber);M.schedulePriority=M.basePriority;E=this._budget.now()-E;M.runtime+=E;this._frameTaskTimes.set(M.priority,this._frameTaskTimes.get(M.priority)+E);this._debug&&E>2*this._budget.budget&&console.log("Task",M.name,"used",E,"of max",this._budget.budget,"ms");if(0>=this._budget.remaining){this._updatingChanged();this._recordFrameTaskTimes(this._budget.now()-G);return}}while(this._schedule());this._updatingChanged();this._recordFrameTaskTimes(this._budget.now()-
G)};I._startFrameTaskTimes=function(){for(const G of Object.keys(u.TaskPriority))this._frameTaskTimes.set(u.TaskPriority[G],0)};I._recordFrameTaskTimes=function(G){this._frameTaskTimes.forEach((E,M)=>this.performanceInfo.tasks.get(M).record(E));this.performanceInfo.total.record(G)};t._createClass(A,[{key:"updating",get:function(){return this._updating.get()}},{key:"load",get:function(){return this._load}},{key:"state",get:function(){return this._state},set:function(G){this._state!==G&&(this._state=
G,this.state!==e.RenderState.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll(E=>E.idleEnd())))}},{key:"test",get:function(){return this._test}}]);return A}();D.Scheduler=J;let K=function(){function A(G,E,M,T){this._scheduler=G;this.name=E;this._basePriority=T;this.runtime=this.blockFrame=0;this._queue=new k.PromiseQueue;this._handles=new H;this.schedulePriority=this._basePriority;this._task=new f.ObservableValue(y.isSome(M)?M:this._queue);this._handles.add(c.when(()=>
this.task.running,Y=>G.taskRunningChanged(Y)))}var I=A.prototype;I.remove=function(){this.processQueue(p);this._scheduler.removeTask(this);this.schedule=r.schedule;this.reschedule=r.reschedule;this._handles.destroy()};I.setPriority=function(G){this.name=G;G=a(G);if(0===this._basePriority||0!==this.schedulePriority)this.schedulePriority=G;this._basePriority=G};I.schedule=function(G,E,M){return this._queue.push(G,E,M)};I.reschedule=function(G,E,M){return this._queue.unshift(G,E,M)};I.processQueue=function(G){this._queue.runTask(G)};
t._createClass(A,[{key:"task",get:function(){return this._task.get()}},{key:"updating",get:function(){return this._queue.running}},{key:"basePriority",get:function(){return this._basePriority}},{key:"priority",get:function(){return this.name},set:function(G){this.setPriority(G)}},{key:"needsUpdate",get:function(){return this.updating||this.task.running}}]);return A}(),F=function(){function A(){this._begin="undefined"!==typeof performance?performance.now():0;this._budget=0;this._state=e.RenderState.IDLE;
this._progressed=this._done=!1;this._enabled=!0}var I=A.prototype;I.run=function(G){if(this.done)return!1;!0===G()&&this.madeProgress();return!0};I.madeProgress=function(){this._progressed=!0;return this._done=this.elapsed>=this._budget&&this._enabled};I.reset=function(G,E){this._begin=this.now();this._budget=G;this._state=E;this.resetProgress()};I.now=function(){return performance.now()};I.resetProgress=function(){this._done=this._progressed=!1};t._createClass(A,[{key:"done",get:function(){return this._done}},
{key:"budget",get:function(){return this._budget}},{key:"state",get:function(){return this._state}},{key:"enabled",get:function(){return this._enabled},set:function(G){this._enabled=G}},{key:"remaining",get:function(){return Math.max(this._budget-this.elapsed,0)}},{key:"elapsed",get:function(){return performance.now()-this._begin}},{key:"hasProgressed",get:function(){return this._progressed}}]);return A}();D.Budget=F})(z||(z={}));u.TaskState=void 0;(function(D){D.SCHEDULED="s";D.READY="r";D.WAITING=
"w";D.IDLE="i"})(u.TaskState||(u.TaskState={}));const p=(()=>{const D=new z.Budget;D.enabled=!1;return D})(),r=new (function(){function D(){}var J=D.prototype;J.remove=function(){};J.processQueue=function(){};J.schedule=function(K,F,A){try{if(h.isAborted(F)){const I=h.createAbortError();return A?Promise.resolve(A(I)):Promise.reject(I)}return h.when(K(p))}catch(I){return Promise.reject(I)}};J.reschedule=function(K,F,A){return this.schedule(K,F,A)};return D}());u.ImmediateTask=r;u.getTaskPriority=a;
u.newScheduler=function(){return new z.Scheduler};u.noBudget=p;u.taskPriorities=b;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/core/accessorSupport/tracking/ObservableValue":function(){define(["exports","../tracking","./SimpleObservable"],function(u,t,H){let C=function(){function w(x){this._observable=new H.SimpleObservable;this._value=x}var y=w.prototype;y.get=function(){t.trackAccess(this._observable);return this._value};y.set=function(x){x!==this._value&&(this._value=x,
this._observable.notify())};return w}();u.ObservableValue=C;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/PromiseQueue":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../core/promiseUtils","../../core/accessorSupport/tracking/ObservableValue"],function(u,t,H,C){let w=function(){function x(){this._tasks=[];this._running=new C.ObservableValue(!1)}var m=x.prototype;m.destroy=function(){this.cancelAll()};m.runTask=function(h){for(;!h.done&&
this._process(h);)h.madeProgress()};m.push=function(h,c,d){this._running.set(!0);return new Promise((f,k)=>this._tasks.push(new y(f,k,h,c,d)))};m.unshift=function(h,c,d){this._running.set(!0);return new Promise((f,k)=>this._tasks.unshift(new y(f,k,h,c,d)))};m._process=function(h){if(0===this._tasks.length)return!1;const c=this._tasks.shift();try{const d=H.isAborted(c.signal);if(d&&!c.abortCallback)c.reject(H.createAbortError());else{const f=d?c.abortCallback?.(H.createAbortError()):c.callback(h);
H.isPromiseLike(f)?f.then(c.resolve,c.reject):c.resolve(f)}}catch(d){c.reject(d)}this._running.set(0<this._tasks.length);return!0};m.cancelAll=function(){const h=H.createAbortError();for(const c of this._tasks)if(c.abortCallback){const d=c.abortCallback(h);c.resolve(d)}else c.reject(h);this._tasks.length=0;this._running.set(!1)};t._createClass(x,[{key:"length",get:function(){return this._tasks.length}},{key:"running",get:function(){return this._running.get()}}]);return x}(),y=function(x,m,h,c,d){this.resolve=
x;this.reject=m;this.callback=h;this.signal=c;this.abortCallback=d};u.PromiseQueue=w;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/debugFlags":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass".split(" "),function(u,t,H,C,w,y,x){H=function(m){function h(){var c=
m.apply(this,arguments)||this;c.SCHEDULER_LOG_SLOW_TASKS=!1;c.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1;return c}u._inheritsLoose(h,m);return h}(H);t.__decorate([C.property()],H.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0);t.__decorate([C.property()],H.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0);H=t.__decorate([x.subclass("esri.views.support.DebugFlags")],H);return new H})},"esri/views/support/RenderState":function(){define(["exports"],function(u){u.RenderState=
void 0;var t=u.RenderState||(u.RenderState={});t[t.ANIMATING=0]="ANIMATING";t[t.INTERACTING=1]="INTERACTING";t[t.IDLE=2]="IDLE";Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/FeatureStore2D":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/CircularArray ../../../../core/Evented ../../../../core/has ../../../../core/maybe ../../../../chunks/rbush ../../../../geometry/support/aaBoundingBox ./Store2D ./support/FeatureSetReaderPBFIndirect".split(" "),
function(u,t,H,C,w,y,x,m,h,c){const d=m.create(),f={getObjectId(k){return k.getObjectId()},getAttributes(k){return k.readAttributes()},getAttribute(k,g){return k.readAttribute(g)},cloneWithGeometry(k,g){return k},getGeometry(k){return k.readHydratedGeometry()},getCentroid(k,g){return k.readCentroid()}};w=function(k){function g(a,b,l){var q=k.call(this,a,b)||this;q.featureAdapter=f;q.events=new C;q._featureSetsByInstance=new Map;q._objectIdToDisplayId=new Map;q._spatialIndexInvalid=!0;q._indexSearchCache=
new H(50);q._index=x.rbush(9,n=>({minX:q._storage.getXMin(n),minY:q._storage.getYMin(n),maxX:q._storage.getXMax(n),maxY:q._storage.getYMax(n)}));q.mode=l;return q}t._inheritsLoose(g,k);var e=g.prototype;e.hasInstance=function(a){return this._featureSetsByInstance.has(a)};e.onTileData=function(a,b){if(y.isNone(b.addOrUpdate))return b;b.addOrUpdate.attachStorage(this._storage);if("snapshot"===this.mode){for(var l=b.addOrUpdate.getCursor();l.next();){const q=l.getDisplayId();this.setComputedAttributes(this._storage,
l,q,a.scale)}return b}this._featureSetsByInstance.set(b.addOrUpdate.instance,b.addOrUpdate);for(l=b.addOrUpdate.getCursor();l.next();)this._insertFeature(l,a.scale);this._spatialIndexInvalid=!0;this.events.emit("changed");return b};e.search=function(a){this._rebuildIndex();const b=a.id;var l=this._indexSearchCache.find(v=>v.tileId===b);if(y.isSome(l))return l.readers;l=new Map;a=this._searchIndex(a.bounds);const q=[];for(const v of a){var n=this._storage.getInstanceId(v);a=(4294901760&n)>>>16;n&=
65535;l.has(a)||l.set(a,[]);l.get(a).push(n)}l.forEach((v,B)=>{B=this._featureSetsByInstance.get(B);q.push(c.FeatureSetReaderIndirect.from(B,v))});this._indexSearchCache.enqueue({tileId:b,readers:q});return q};e.insert=function(a){const b=a.getCursor(),l=this._storage;for(;b.next();){var q=b.getIndex();q|=b.instance<<16;const n=b.getObjectId(),v=this._objectIdToDisplayId.get(n)??this._storage.createDisplayId();b.setDisplayId(v);l.setInstanceId(v,q);this._objectIdToDisplayId.set(n,v)}this._featureSetsByInstance.set(a.instance,
a);this._spatialIndexInvalid=!0};e.remove=function(a){const b=this._objectIdToDisplayId.get(a);if(b){var l=this._storage.getInstanceId(b),q=65535&l;l=(4294901760&l)>>>16;var n=this._featureSetsByInstance.get(l);this._objectIdToDisplayId.delete(a);this._storage.releaseDisplayId(b);n.removeAtIndex(q);n.isEmpty&&this._featureSetsByInstance.delete(l);this._spatialIndexInvalid=!0}};e.forEach=function(a){this._objectIdToDisplayId.forEach(b=>{b=this._storage.getInstanceId(b);b=this._lookupFeature(b);a(b)})};
e.forEachUnsafe=function(a){this._objectIdToDisplayId.forEach(b=>{var l=this._storage.getInstanceId(b);b=65535&l;l=this._getFeatureSet((4294901760&l)>>>16);l.setIndex(b);a(l)})};e.forEachInBounds=function(a,b){a=this._searchIndex(a);for(const l of a)a=this.lookupFeatureByDisplayId(l,this._storage),b(y.unwrap(a))};e.forEachBounds=function(a,b){this._rebuildIndex();for(const l of a)l.readGeometry()&&(a=l.getDisplayId(),m.fromRectValues(d,this._storage.getXMin(a),this._storage.getYMin(a),this._storage.getXMax(a),
this._storage.getYMax(a)),b(d))};e.sweepFeatures=function(a,b,l){this._spatialIndexInvalid=!0;this._objectIdToDisplayId.forEach((q,n)=>{a.has(q)||(b.releaseDisplayId(q),l&&l.unsetAttributeData(q),this._objectIdToDisplayId.delete(n))});this.events.emit("changed")};e.sweepFeatureSets=function(a){this._spatialIndexInvalid=!0;this._featureSetsByInstance.forEach((b,l)=>{a.has(l)||this._featureSetsByInstance.delete(l)})};e.lookupObjectId=function(a,b){a=this.lookupFeatureByDisplayId(a,b);return y.isNone(a)?
null:a.getObjectId()};e.lookupDisplayId=function(a){return this._objectIdToDisplayId.get(a)};e.lookupFeatureByDisplayId=function(a,b){a=b.getInstanceId(a);return this._lookupFeature(a)};e.lookupByDisplayIdUnsafe=function(a){var b=this._storage.getInstanceId(a);a=65535&b;b=this._getFeatureSet((4294901760&b)>>>16);if(!b)return null;b.setIndex(a);return b};e._insertFeature=function(a,b){const l=this._storage,q=a.getObjectId();var n=a.getIndex();n|=a.instance<<16;l.getInstanceId(a.getDisplayId());let v=
this._objectIdToDisplayId.get(q);v||(v=l.createDisplayId(),this._objectIdToDisplayId.set(q,v),this._spatialIndexInvalid=!0);a.setDisplayId(v);l.setInstanceId(v,n);this.setComputedAttributes(l,a,v,b)};e._searchIndex=function(a){this._rebuildIndex();return this._index.search({minX:a[0],minY:a[1],maxX:a[2],maxY:a[3]})};e._rebuildIndex=function(){if(this._spatialIndexInvalid){var a=[];"snapshot"===this.mode?this._featureSetsByInstance.forEach(b=>{for(b=b.getCursor();b.next();){const l=b.getDisplayId();
this._storage.setBounds(l,b)&&a.push(l)}}):this._objectIdToDisplayId.forEach(b=>{const l=this._storage.getInstanceId(b);this._storage.setBounds(b,this._lookupFeature(l))&&a.push(b)});this._index.clear();this._index.load(a);this._indexSearchCache.clear();this._spatialIndexInvalid=!1}};e._lookupFeature=function(a){var b=this._getFeatureSet((4294901760&a)>>>16);if(b)return b=b.getCursor(),b.setIndex(65535&a),b};e._getFeatureSet=function(a){return this._featureSetsByInstance.get(a)};t._createClass(g,
[{key:"storeStatistics",get:function(){let a=0,b=0,l=0;this.forEach(q=>{if(q=q.readGeometry())b+=q.isPoint?1:q.lengths.reduce((n,v)=>n+v,0),l+=q.isPoint?1:q.lengths.length,a+=1});return{featureCount:a,vertexCount:b,ringCount:l}}}]);return g}(h.Store2D);u.FeatureStore2D=w;u.featureAdapter=f;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/core/CircularArray":function(){define(["../chunks/_rollupPluginBabelHelpers","./maybe"],function(u,t){return function(){function H(w){this._start=
this.size=0;this.maxSize=w;this._buffer=Array(w)}var C=H.prototype;C.enqueue=function(w){if(this.size===this.maxSize){const y=this._buffer[this._start];this._buffer[this._start]=w;this._start=(this._start+1)%this.maxSize;return y}this._buffer[(this._start+this.size++)%this.maxSize]=w;return null};C.dequeue=function(){if(0===this.size)return null;const w=this._buffer[this._start];this._buffer[this._start]=null;this.size--;this._start=(this._start+1)%this.maxSize;return w};C.peek=function(){return 0===
this.size?null:this._buffer[this._start]};C.find=function(w){if(0===this.size)return null;for(const y of this._buffer)if(t.isSome(y)&&w(y))return y;return null};C.clear=function(w){let y=this.dequeue();for(;t.isSome(y);)w&&w(y),y=this.dequeue()};u._createClass(H,[{key:"entries",get:function(){return this._buffer}}]);return H}()})},"esri/core/Evented":function(){define(["../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","./Accessor","./handleUtils","./accessorSupport/decorators/subclass"],
function(u,t,H,C,w){let y=function(){function x(){this._emitter=new x.EventEmitter(this)}var m=x.prototype;m.emit=function(h,c){return this._emitter.emit(h,c)};m.on=function(h,c){return this._emitter.on(h,c)};m.once=function(h,c){return this._emitter.once(h,c)};m.hasEventListener=function(h){return this._emitter.hasEventListener(h)};return x}();(function(x){let m=function(){function c(f=null){this._target=f;this._listenersMap=null}var d=c.prototype;d.clear=function(){this._listenersMap&&this._listenersMap.clear();
this._listenersMap=null};d.emit=function(f,k){f=this._listenersMap&&this._listenersMap.get(f);if(!f)return!1;const g=this._target||this;[...f].forEach(e=>{e.call(g,k)});return 0<f.length};d.on=function(f,k){if(Array.isArray(f)){var g=f.map(e=>this.on(e,k));return C.handlesGroup(g)}if(f.includes(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap||(this._listenersMap=new Map);g=this._listenersMap.get(f)||[];g.push(k);this._listenersMap.set(f,
g);return{remove:()=>{const e=this._listenersMap&&this._listenersMap.get(f)||[],a=e.indexOf(k);0<=a&&e.splice(a,1)}}};d.once=function(f,k){const g=this.on(f,e=>{g.remove();k.call(null,e)});return g};d.hasEventListener=function(f){f=this._listenersMap&&this._listenersMap.get(f);return null!=f&&0<f.length};return c}();x.EventEmitter=m;x.EventedMixin=c=>{c=function(d){function f(){var g=d.apply(this,arguments)||this;g._emitter=new m;return g}u._inheritsLoose(f,d);var k=f.prototype;k.destroy=function(){this._emitter.clear()};
k.emit=function(g,e){return this._emitter.emit(g,e)};k.on=function(g,e){return this._emitter.on(g,e)};k.once=function(g,e){return this._emitter.once(g,e)};k.hasEventListener=function(g){return this._emitter.hasEventListener(g)};return f}(c);return c=t.__decorate([w.subclass("esri.core.Evented")],c)};let h=function(c){function d(){var k=c.apply(this,arguments)||this;k._emitter=new y.EventEmitter(u._assertThisInitialized(k));return k}u._inheritsLoose(d,c);var f=d.prototype;f.destroy=function(){this._emitter.clear()};
f.emit=function(k,g){return this._emitter.emit(k,g)};f.on=function(k,g){return this._emitter.on(k,g)};f.once=function(k,g){return this._emitter.once(k,g)};f.hasEventListener=function(k){return this._emitter.hasEventListener(k)};return d}(H);h=t.__decorate([w.subclass("esri.core.Evented")],h);x.EventedAccessor=h})(y||(y={}));return y})},"esri/chunks/rbush":function(){define(["exports","./quickselect"],function(u,t){function H(e,a){if(!(this instanceof H))return new H(e,a);this._maxEntries=Math.max(4,
e||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));a&&("function"===typeof a?this.toBBox=a:this._initFormat(a));this.clear()}function C(e,a){w(e,0,e.children.length,a,e)}function w(e,a,b,l,q){q||(q=k(null));q.minX=Infinity;q.minY=Infinity;q.maxX=-Infinity;q.maxY=-Infinity;for(var n;a<b;a++)n=e.children[a],y(q,e.leaf?l(n):n);return q}function y(e,a){e.minX=Math.min(e.minX,a.minX);e.minY=Math.min(e.minY,a.minY);e.maxX=Math.max(e.maxX,a.maxX);e.maxY=Math.max(e.maxY,a.maxY);return e}function x(e,
a){return e.minX-a.minX}function m(e,a){return e.minY-a.minY}function h(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function c(e){return e.maxX-e.minX+(e.maxY-e.minY)}function d(e,a){return e.minX<=a.minX&&e.minY<=a.minY&&a.maxX<=e.maxX&&a.maxY<=e.maxY}function f(e,a){return a.minX<=e.maxX&&a.minY<=e.maxY&&a.maxX>=e.minX&&a.maxY>=e.minY}function k(e){return{children:e,height:1,leaf:!0,minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity}}function g(e,a,b,l,q){for(var n=[a,b],v;n.length;)b=n.pop(),
a=n.pop(),b-a<=l||(v=a+Math.ceil((b-a)/l/2)*l,t.quickselect(e,v,a,b,q),n.push(a,v,v,b))}H.prototype={all:function(){return this._all(this.data,[])},search:function(e){var a=this.data,b=[],l=this.toBBox;if(!f(e,a))return b;for(var q=[],n,v,B,z;a;){n=0;for(v=a.children.length;n<v;n++)B=a.children[n],z=a.leaf?l(B):B,f(e,z)&&(a.leaf?b.push(B):d(e,z)?this._all(B,b):q.push(B));a=q.pop()}return b},collides:function(e){var a=this.data,b=this.toBBox;if(!f(e,a))return!1;for(var l=[],q,n,v,B;a;){q=0;for(n=a.children.length;q<
n;q++)if(v=a.children[q],B=a.leaf?b(v):v,f(e,B)){if(a.leaf||d(e,B))return!0;l.push(v)}a=l.pop()}return!1},load:function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var a=0,b=e.length;a<b;a++)this.insert(e[a]);return this}e=this._build(e.slice(),0,e.length-1,0);this.data.children.length?this.data.height===e.height?this._splitRoot(this.data,e):(this.data.height<e.height&&(a=this.data,this.data=e,e=a),this._insert(e,this.data.height-e.height-1,!0)):this.data=e;return this},insert:function(e){e&&
this._insert(e,this.data.height-1);return this},clear:function(){this.data=k([]);return this},remove:function(e,a){if(!e)return this;for(var b=this.data,l=this.toBBox(e),q=[],n=[],v,B,z,p;b||q.length;){b||(b=q.pop(),B=q[q.length-1],v=n.pop(),p=!0);if(b.leaf){a:{z=e;var r=b.children,D=a;if(D){for(var J=0;J<r.length;J++)if(D(z,r[J])){z=J;break a}z=-1}else z=r.indexOf(z)}if(-1!==z){b.children.splice(z,1);q.push(b);this._condense(q);break}}p||b.leaf||!d(b,l)?B?(v++,b=B.children[v],p=!1):b=null:(q.push(b),
n.push(v),v=0,B=b,b=b.children[0])}return this},toBBox:function(e){return e},compareMinX:x,compareMinY:m,toJSON:function(){return this.data},fromJSON:function(e){this.data=e;return this},_all:function(e,a){for(var b=[];e;)e.leaf?a.push.apply(a,e.children):b.push.apply(b,e.children),e=b.pop();return a},_build:function(e,a,b,l){var q=b-a+1,n=this._maxEntries;if(q<=n){var v=k(e.slice(a,b+1));C(v,this.toBBox);return v}l||(l=Math.ceil(Math.log(q)/Math.log(n)),n=Math.ceil(q/Math.pow(n,l-1)));v=k([]);v.leaf=
!1;v.height=l;q=Math.ceil(q/n);n=q*Math.ceil(Math.sqrt(n));var B;for(g(e,a,b,n,this.compareMinX);a<=b;a+=n){var z=Math.min(a+n-1,b);g(e,a,z,q,this.compareMinY);for(B=a;B<=z;B+=q){var p=Math.min(B+q-1,z);v.children.push(this._build(e,B,p,l-1))}}C(v,this.toBBox);return v},_chooseSubtree:function(e,a,b,l){for(var q,n,v,B,z,p,r,D;;){l.push(a);if(a.leaf||l.length-1===b)break;r=D=Infinity;q=0;for(n=a.children.length;q<n;q++)v=a.children[q],z=h(v),p=(Math.max(v.maxX,e.maxX)-Math.min(v.minX,e.minX))*(Math.max(v.maxY,
e.maxY)-Math.min(v.minY,e.minY))-z,p<D?(D=p,r=z<r?z:r,B=v):p===D&&z<r&&(r=z,B=v);a=B||a.children[0]}return a},_insert:function(e,a,b){var l=this.toBBox;b=b?e:l(e);l=[];var q=this._chooseSubtree(b,this.data,a,l);q.children.push(e);for(y(q,b);0<=a;)if(l[a].children.length>this._maxEntries)this._split(l,a),a--;else break;this._adjustParentBBoxes(b,l,a)},_split:function(e,a){var b=e[a],l=b.children.length,q=this._minEntries;this._chooseSplitAxis(b,q,l);l=this._chooseSplitIndex(b,q,l);l=k(b.children.splice(l,
b.children.length-l));l.height=b.height;l.leaf=b.leaf;C(b,this.toBBox);C(l,this.toBBox);a?e[a-1].children.push(l):this._splitRoot(b,l)},_splitRoot:function(e,a){this.data=k([e,a]);this.data.height=e.height+1;this.data.leaf=!1;C(this.data,this.toBBox)},_chooseSplitIndex:function(e,a,b){var l,q;var n=q=Infinity;for(l=a;l<=b-a;l++){var v=w(e,0,l,this.toBBox);var B=w(e,l,b,this.toBBox);var z=Math.max(0,Math.min(v.maxX,B.maxX)-Math.max(v.minX,B.minX))*Math.max(0,Math.min(v.maxY,B.maxY)-Math.max(v.minY,
B.minY));v=h(v)+h(B);if(z<n){n=z;var p=l;q=v<q?v:q}else z===n&&v<q&&(q=v,p=l)}return p},_chooseSplitAxis:function(e,a,b){var l=e.leaf?this.compareMinX:x,q=e.leaf?this.compareMinY:m,n=this._allDistMargin(e,a,b,l);a=this._allDistMargin(e,a,b,q);n<a&&e.children.sort(l)},_allDistMargin:function(e,a,b,l){e.children.sort(l);l=this.toBBox;var q=w(e,0,a,l),n=w(e,b-a,b,l),v=c(q)+c(n),B;for(B=a;B<b-a;B++){var z=e.children[B];y(q,e.leaf?l(z):z);v+=c(q)}for(B=b-a-1;B>=a;B--)z=e.children[B],y(n,e.leaf?l(z):z),
v+=c(n);return v},_adjustParentBBoxes:function(e,a,b){for(;0<=b;b--)y(a[b],e)},_condense:function(e){for(var a=e.length-1,b;0<=a;a--)0===e[a].children.length?0<a?(b=e[a-1].children,b.splice(b.indexOf(e[a]),1)):this.clear():C(e[a],this.toBBox)},_initFormat:function(e){var a=["return a"," - b",";"];this.compareMinX=new Function("a","b",a.join(e[0]));this.compareMinY=new Function("a","b",a.join(e[1]));this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+
"};")}};u.rbush=H})},"esri/chunks/quickselect":function(){define(["exports"],function(u){var t={};(function(H){(function(C){C=C();void 0!==C&&(H.exports=C)})(function(){function C(x,m,h,c,d){for(;c>h;){if(600<c-h){var f=c-h+1,k=m-h+1,g=Math.log(f),e=.5*Math.exp(2*g/3);g=.5*Math.sqrt(g*e*(f-e)/f)*(0>k-f/2?-1:1);C(x,m,Math.max(h,Math.floor(m-k*e/f+g)),Math.min(c,Math.floor(m+(f-k)*e/f+g)),d)}f=x[m];k=h;e=c;w(x,h,m);for(0<d(x[c],f)&&w(x,h,c);k<e;){w(x,k,e);k++;for(e--;0>d(x[k],f);)k++;for(;0<d(x[e],
f);)e--}0===d(x[h],f)?w(x,h,e):(e++,w(x,e,c));e<=m&&(h=e+1);m<=e&&(c=e-1)}}function w(x,m,h){var c=x[m];x[m]=x[h];x[h]=c}function y(x,m){return x<m?-1:x>m?1:0}return function(x,m,h,c,d){C(x,m,h||0,c||x.length-1,d||y)}})})({get exports(){return t},set exports(H){t=H}});u.quickselect=t})},"esri/views/2d/layers/features/Store2D":function(){define("require exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/maybe ../../../../core/accessorSupport/diffUtils ../../../../support/arcadeOnDemand ../../arcade/callExpressionWithCursor".split(" "),
function(u,t,H,C,w,y,x,m){const h=new Promise((d,f)=>u(["../../../../layers/support/labelFormatUtils"],d,f));let c=function(){function d(k,g){this._canCacheExpressionValue=!1;this._sourceInfo=k;this._storage=g;this._bitsets={computed:g.getBitset(g.createBitset())}}var f=d.prototype;f.invalidate=function(){this._bitsets.computed.clear()};f.updateSchema=function(){var k=H._asyncToGenerator(function*(g,e){var a=y.diff(this._schema,e);if((this._schema=e)&&!w.isNone(a)&&y.hasDiff(a,"attributes")){C("esri-2d-update-debug")&&
console.debug("Applying Update - Store:",a);this._bitsets.computed.clear();g.targets[e.name]=!0;g=e.attributes;e=[];a=[];for(const b in g){const l=g[b];switch(l.type){case "expression":e.push(this._createArcadeComputedField(l));break;case "label-expression":e.push(this._createLabelArcadeComputedField(l));break;case "statistic":a.push(l)}}this._computedFields=yield Promise.all(e);this._canCacheExpressionValue=!this._computedFields.some(b=>"expression"===b.type&&w.isSome(b.expression)&&b.expression.referencesScale());
this._statisticFields=a}});return function(g,e){return k.apply(this,arguments)}}();f.setComputedAttributes=function(k,g,e,a){var b=this._bitsets.computed;if(!this._canCacheExpressionValue||!b.has(e)){b.set(e);for(const l of this._computedFields)switch(b=this._evaluateField(g,l,a),l.resultType){case "numeric":k.setComputedNumericAtIndex(e,l.fieldIndex,b);break;case "string":k.setComputedStringAtIndex(e,l.fieldIndex,b)}}};f._createArcadeComputedField=function(){var k=H._asyncToGenerator(function*(g){return{...g,
expression:yield x.createRendererExpression(g.valueExpression,this._sourceInfo.spatialReference,this._sourceInfo.fieldsIndex)}});return function(g){return k.apply(this,arguments)}}();f._createLabelArcadeComputedField=function(){var k=H._asyncToGenerator(function*(g){var e=this._sourceInfo.spatialReference;const a=this._sourceInfo.fieldsIndex,{createLabelFunction:b}=yield h;e=yield b(g.label,a,e);return{...g,builder:e}});return function(g){return k.apply(this,arguments)}}();f._evaluateField=function(k,
g,e){switch(g.type){case "label-expression":return k=k.readArcadeFeature(),g.builder.evaluate(k)||"";case "expression":return{expression:g}=g,m(g,k,{$view:{scale:e}})}};H._createClass(d,[{key:"storage",get:function(){return this._storage}}]);return d}();t.Store2D=c;Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})})},"esri/core/accessorSupport/diffUtils":function(){define(["exports","../Accessor","../Collection","../maybe","./utils"],function(u,t,H,C,w){function y(g){return g instanceof
H?Object.keys(g.items):g instanceof t?w.getProperties(g).keys():g?Object.keys(g):[]}function x(g,e){return g instanceof H?g.items[e]:g[e]}function m(g,e){return Array.isArray(g)&&Array.isArray(e)?g.length!==e.length:!1}function h(g){return g?g.declaredClass:null}function c(g,e){const a=g.diff;if(a&&"function"===typeof a)return a(g,e);const b=y(g),l=y(e);if(0!==b.length||0!==l.length){if(!b.length||!l.length||m(g,e))return{type:"complete",oldValue:g,newValue:e};var q=l.filter(B=>!b.includes(B)),n=
b.filter(B=>!l.includes(B));n=b.filter(B=>l.includes(B)&&x(g,B)!==x(e,B)).concat(q,n).sort();if((q=h(g))&&k.includes(q)&&n.length)return{type:"complete",oldValue:g,newValue:e};var v;q=g instanceof t&&e instanceof t;for(const B of n){n=x(g,B);const z=x(e,B);if((q||"function"!==typeof n&&"function"!==typeof z)&&n!==z&&(null!=n||null!=z)){if(a&&a[B]&&"function"===typeof a[B])n=a[B](n,z);else if(n instanceof Date&&z instanceof Date){if(n.getTime()===z.getTime())continue;n={type:"complete",oldValue:n,
newValue:z}}else n="object"===typeof n&&"object"===typeof z&&h(n)===h(z)?c(n,z):{type:"complete",oldValue:n,newValue:z};C.isSome(n)&&(C.isSome(v)?v.diff[B]=n:v={type:"partial",diff:{[B]:n}})}}return v}}function d(g,e){if(C.isNone(g))return!1;e=e.split(".");for(const a of e){if("complete"===g.type)break;if("partial"===g.type){if(g=g.diff[a],!g)return!1}else return!1}return!0}function f(g){if(C.isNone(g))return!0;switch(g.type){case "complete":return!1;case "collection":for(const e of g.added)if(!f(e))return!1;
for(const e of g.removed)if(!f(e))return!1;for(const e of g.changed)if(!f(e))return!1;return!0;case "partial":for(const e in g.diff)if(!f(g.diff[e]))return!1;return!0}}const k=["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"];u.diff=function(g,e){if(!("function"===typeof g||"function"===typeof e||C.isNone(g)&&C.isNone(e)))return C.isNone(g)||C.isNone(e)||"object"===typeof g&&"object"===typeof e&&h(g)!==h(e)?{type:"complete",
oldValue:g,newValue:e}:c(g,e)};u.hasDiff=d;u.hasDiffAny=function(g,e){for(const a of e)if(d(g,a))return!0;return!1};u.isEmpty=f;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/core/Collection":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./ArrayPool ./Evented ./lang ./maybe ./ObjectPool ./ObservableChangesType ./scheduling ./accessorSupport/decorators/property ./accessorSupport/ensureType ./accessorSupport/decorators/shared ./accessorSupport/decorators/subclass ./accessorSupport/tracking ./accessorSupport/tracking/SimpleObservable".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f,k,g,e){function a(F){return F?F instanceof K?F.toArray():F.length?Array.prototype.slice.apply(F):[]:[]}function b(F){if(F&&F.length)return F[0]}function l(F,A,I,G){A&&A.forEach((E,M,T)=>{F.push(E);l(F,I.call(G,E,M,T),I,G)})}var q;let n=function(){function F(){this.target=null;this.defaultPrevented=this.cancellable=!1;this.type=this.item=void 0}var A=F.prototype;A.preventDefault=function(){this.cancellable&&(this.defaultPrevented=!0)};A.reset=function(I){this.defaultPrevented=
!1;this.item=I};return F}();const v=new x(n,void 0,F=>{F.item=null;F.target=null;F.defaultPrevented=!1;F.cancellable=!1}),B=()=>{},z=new Set,p=new Set,r=new Set,D=new Map;let J=0,K=q=function(F,A){function I(E){E=F.call(this,E)||this;E._chgListeners=[];E._notifications=null;E._timer=null;E._observable=new e.SimpleObservable;E.length=0;E._items=[];Object.defineProperty(u._assertThisInitialized(E),"uid",{value:J++});return E}u._inheritsLoose(I,F);I.isCollection=function(E){return null!=E&&E instanceof
q};var G=I.prototype;G.normalizeCtorArgs=function(E){return E?Array.isArray(E)||E instanceof q?{items:E}:E:{}};G.destroy=function(){this.removeAll()};G[A]=function*(){yield*this.items};G.hasEventListener=function(E){return"change"===E?0<this._chgListeners.length:this._emitter.hasEventListener(E)};G.on=function(E,M){if("change"===E){const T=this._chgListeners,Y={removed:!1,callback:M};T.push(Y);this._notifications&&this._notifications.push({listeners:T.slice(),items:this._items.slice(),changes:[]});
return{remove(){this.remove=B;Y.removed=!0;T.splice(T.indexOf(Y),1)}}}return this._emitter.on(E,M)};G.once=function(E,M){const T=this.on(E,M);return{remove(){T.remove()}}};G.add=function(E,M){g.trackAccess(this._observable);if(this._emitBeforeChanges(m.ObservableChangesType.ADD))return this;M=this.getNextIndex(M??null);this._splice(M,0,[E]);this._emitAfterChanges(m.ObservableChangesType.ADD);return this};G.addMany=function(E,M=this._items.length){g.trackAccess(this._observable);if(!E||!E.length||
this._emitBeforeChanges(m.ObservableChangesType.ADD))return this;M=this.getNextIndex(M);this._splice(M,0,a(E));this._emitAfterChanges(m.ObservableChangesType.ADD);return this};G.at=function(E){g.trackAccess(this._observable);E=Math.trunc(E)||0;0>E&&(E+=this.length);if(!(0>E||E>=this.length))return this._items[E]};G.removeAll=function(){g.trackAccess(this._observable);if(!this.length||this._emitBeforeChanges(m.ObservableChangesType.REMOVE))return[];const E=this._splice(0,this.length)||[];this._emitAfterChanges(m.ObservableChangesType.REMOVE);
return E};G.clone=function(){g.trackAccess(this._observable);return this._createNewInstance({items:this._items.map(w.clone)})};G.concat=function(...E){g.trackAccess(this._observable);E=E.map(a);return this._createNewInstance({items:this._items.concat(...E)})};G.drain=function(E,M){g.trackAccess(this._observable);if(this.length&&!this._emitBeforeChanges(m.ObservableChangesType.REMOVE)){var T=y.assumeNonNull(this._splice(0,this.length)),Y=T.length;for(let fa=0;fa<Y;fa++)E.call(M,T[fa],fa,T);this._emitAfterChanges(m.ObservableChangesType.REMOVE)}};
G.every=function(E,M){g.trackAccess(this._observable);return this._items.every(E,M)};G.filter=function(E,M){g.trackAccess(this._observable);let T;T=2===arguments.length?this._items.filter(E,M):this._items.filter(E);return this._createNewInstance({items:T})};G.find=function(E,M){g.trackAccess(this._observable);return this._items.find(E,M)};G.findIndex=function(E,M){g.trackAccess(this._observable);return this._items.findIndex(E,M)};G.flatten=function(E,M){g.trackAccess(this._observable);const T=[];
l(T,this,E,M);return new q(T)};G.forEach=function(E,M){g.trackAccess(this._observable);return this._items.forEach(E,M)};G.getItemAt=function(E){g.trackAccess(this._observable);return this._items[E]};G.getNextIndex=function(E){g.trackAccess(this._observable);const M=this.length;E=null==E?M:E;0>E?E=0:E>M&&(E=M);return E};G.includes=function(E,M=0){g.trackAccess(this._observable);return this._items.includes(E,M)};G.indexOf=function(E,M=0){g.trackAccess(this._observable);return this._items.indexOf(E,
M)};G.join=function(E=","){g.trackAccess(this._observable);return this._items.join(E)};G.lastIndexOf=function(E,M=this.length-1){g.trackAccess(this._observable);return this._items.lastIndexOf(E,M)};G.map=function(E,M){g.trackAccess(this._observable);E=this._items.map(E,M);return new q({items:E})};G.reorder=function(E,M=this.length-1){g.trackAccess(this._observable);const T=this.indexOf(E);if(-1!==T){0>M?M=0:M>=this.length&&(M=this.length-1);if(T!==M){if(this._emitBeforeChanges(m.ObservableChangesType.MOVE))return E;
this._splice(T,1);this._splice(M,0,[E]);this._emitAfterChanges(m.ObservableChangesType.MOVE)}return E}};G.pop=function(){g.trackAccess(this._observable);if(this.length&&!this._emitBeforeChanges(m.ObservableChangesType.REMOVE)){var E=b(this._splice(this.length-1,1));this._emitAfterChanges(m.ObservableChangesType.REMOVE);return E}};G.push=function(...E){g.trackAccess(this._observable);if(this._emitBeforeChanges(m.ObservableChangesType.ADD))return this.length;this._splice(this.length,0,E);this._emitAfterChanges(m.ObservableChangesType.ADD);
return this.length};G.reduce=function(E,M){g.trackAccess(this._observable);const T=this._items;return 2===arguments.length?T.reduce(E,M):T.reduce(E)};G.reduceRight=function(E,M){g.trackAccess(this._observable);const T=this._items;return 2===arguments.length?T.reduceRight(E,M):T.reduceRight(E)};G.remove=function(E){g.trackAccess(this._observable);return this.removeAt(this.indexOf(E))};G.removeAt=function(E){g.trackAccess(this._observable);if(!(0>E||E>=this.length||this._emitBeforeChanges(m.ObservableChangesType.REMOVE)))return E=
b(this._splice(E,1)),this._emitAfterChanges(m.ObservableChangesType.REMOVE),E};G.removeMany=function(E){g.trackAccess(this._observable);if(!E||!E.length||this._emitBeforeChanges(m.ObservableChangesType.REMOVE))return[];E=E instanceof q?E.toArray():E;const M=this._items,T=[],Y=E.length;for(let P=0;P<Y;P++){var fa=M.indexOf(E[P]);if(-1<fa){var ba=P+1,U=fa+1;const Q=Math.min(E.length-ba,M.length-U);let Z=0;for(;Z<Q&&E[ba+Z]===M[U+Z];)Z++;ba=1+Z;(fa=this._splice(fa,ba))&&0<fa.length&&T.push.apply(T,fa);
P+=ba-1}}this._emitAfterChanges(m.ObservableChangesType.REMOVE);return T};G.reverse=function(){g.trackAccess(this._observable);if(this._emitBeforeChanges(m.ObservableChangesType.MOVE))return this;const E=this._splice(0,this.length);E&&(E.reverse(),this._splice(0,0,E));this._emitAfterChanges(m.ObservableChangesType.MOVE);return this};G.shift=function(){g.trackAccess(this._observable);if(this.length&&!this._emitBeforeChanges(m.ObservableChangesType.REMOVE)){var E=b(this._splice(0,1));this._emitAfterChanges(m.ObservableChangesType.REMOVE);
return E}};G.slice=function(E=0,M=this.length){g.trackAccess(this._observable);return this._createNewInstance({items:this._items.slice(E,M)})};G.some=function(E,M){g.trackAccess(this._observable);return this._items.some(E,M)};G.sort=function(E){g.trackAccess(this._observable);if(!this.length||this._emitBeforeChanges(m.ObservableChangesType.MOVE))return this;const M=y.assumeNonNull(this._splice(0,this.length));arguments.length?M.sort(E):M.sort();this._splice(0,0,M);this._emitAfterChanges(m.ObservableChangesType.MOVE);
return this};G.splice=function(E,M,...T){g.trackAccess(this._observable);const Y=(M?m.ObservableChangesType.REMOVE:0)|(T.length?m.ObservableChangesType.ADD:0);if(this._emitBeforeChanges(Y))return[];E=this._splice(E,M,T)||[];this._emitAfterChanges(Y);return E};G.toArray=function(){g.trackAccess(this._observable);return this._items.slice()};G.toJSON=function(){g.trackAccess(this._observable);return this.toArray()};G.toLocaleString=function(){g.trackAccess(this._observable);return this._items.toLocaleString()};
G.toString=function(){g.trackAccess(this._observable);return this._items.toString()};G.unshift=function(...E){g.trackAccess(this._observable);if(!E.length||this._emitBeforeChanges(m.ObservableChangesType.ADD))return this.length;this._splice(0,0,E);this._emitAfterChanges(m.ObservableChangesType.ADD);return this.length};G._createNewInstance=function(E){return new this.constructor(E)};G._splice=function(E,M,T){const Y=this._items;var fa=this.itemType;let ba=void 0;!this._notifications&&this.hasEventListener("change")&&
(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._timer=h.schedule(()=>this._dispatchChange()));if(M){ba=Y.splice(E,M);if(this.hasEventListener("before-remove")){var U=v.acquire();U.target=this;U.cancellable=!0;for(let Z=0,X=ba.length;Z<X;Z++)M=ba[Z],U.reset(M),this.emit("before-remove",U),U.defaultPrevented&&(ba.splice(Z,1),Y.splice(E,0,M),E+=1,--Z,--X);v.release(U)}this.length=this._items.length;if(this.hasEventListener("after-remove")){M=
v.acquire();M.target=this;M.cancellable=!1;U=ba.length;for(let Z=0;Z<U;Z++)M.reset(ba[Z]),this.emit("after-remove",M);v.release(M)}}if(T&&T.length){if(fa){M=[];for(var P of T)T=fa.ensureType(P),null==T&&null!=P||M.push(T);T=M}fa=this.hasEventListener("before-add");P=this.hasEventListener("after-add");M=E===this.length;if(fa||P){var Q=v.acquire();Q.target=this;Q.cancellable=!0;U=v.acquire();U.target=this;U.cancellable=!1;for(const Z of T)fa?(Q.reset(Z),this.emit("before-add",Q),Q.defaultPrevented||
(M?Y.push(Z):Y.splice(E++,0,Z),this._set("length",Y.length),P&&(U.reset(Z),this.emit("after-add",U)))):(M?Y.push(Z):Y.splice(E++,0,Z),this._set("length",Y.length),U.reset(Z),this.emit("after-add",U));v.release(U);v.release(Q)}else{if(M)for(Q of T)Y.push(Q);else Y.splice(E,0,...T);this._set("length",Y.length)}}(T&&T.length||ba&&ba.length)&&this._notifyChangeEvent(T,ba);return ba};G._emitBeforeChanges=function(E){let M=!1;if(this.hasEventListener("before-changes")){const T=v.acquire();T.target=this;
T.cancellable=!0;T.type=E;this.emit("before-changes",T);M=T.defaultPrevented;v.release(T)}return M};G._emitAfterChanges=function(E){if(this.hasEventListener("after-changes")){const M=v.acquire();M.target=this;M.cancellable=!1;M.type=E;this.emit("after-changes",M);v.release(M)}this._observable.notify()};G._notifyChangeEvent=function(E,M){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-1].changes.push({added:E,removed:M})};G._dispatchChange=function(){this._timer&&
(this._timer.remove(),this._timer=null);if(this._notifications){var E=this._notifications;this._notifications=null;for(const M of E){E=M.changes;z.clear();p.clear();r.clear();for(const {added:P,removed:Q}of E){if(P)if(0===r.size&&0===p.size)for(const Z of P)z.add(Z);else for(const Z of P)p.has(Z)?(r.add(Z),p.delete(Z)):r.has(Z)||z.add(Z);if(Q)if(0===r.size&&0===z.size)for(const Z of Q)p.add(Z);else for(const Z of Q)z.has(Z)?z.delete(Z):(r.delete(Z),p.add(Z))}const T=H.acquire();z.forEach(P=>{T.push(P)});
const Y=H.acquire();p.forEach(P=>{Y.push(P)});const fa=this._items,ba=M.items,U=H.acquire();r.forEach(P=>{ba.indexOf(P)!==fa.indexOf(P)&&U.push(P)});if(M.listeners&&(T.length||Y.length||U.length)){E={target:this,added:T,removed:Y,moved:U};const P=M.listeners.length;for(let Q=0;Q<P;Q++){const Z=M.listeners[Q];Z.removed||Z.callback.call(this,E)}}H.release(T);H.release(Y);H.release(U)}z.clear();p.clear();r.clear()}};u._createClass(I,[{key:"items",get:function(){g.trackAccess(this._observable);return this._items},
set:function(E){this._emitBeforeChanges(m.ObservableChangesType.ADD)||(this._splice(0,this.length,a(E)),this._emitAfterChanges(m.ObservableChangesType.ADD))}}]);return I}(C.EventedAccessor,Symbol.iterator);K.ofType=F=>{if(!F)return q;if(D.has(F))return D.get(F);let A=null;if("function"===typeof F)A=F.prototype.declaredClass;else if(F.base)A=F.base.prototype.declaredClass;else for(var I in F.typeMap){const G=F.typeMap[I].prototype.declaredClass;A=A?A+` | ${G}`:G}I=function(G){function E(){return G.apply(this,
arguments)||this}u._inheritsLoose(E,G);return E}(q);t.__decorate([f.shared({Type:F,ensureType:"function"===typeof F?d.ensureType(F):d.ensureOneOfType(F)})],I.prototype,"itemType",void 0);I=t.__decorate([k.subclass(`esri.core.Collection<${A}>`)],I);D.set(F,I);return I};t.__decorate([c.property()],K.prototype,"length",void 0);t.__decorate([c.property()],K.prototype,"items",null);return K=q=t.__decorate([k.subclass("esri.core.Collection")],K)})},"esri/core/ObservableChangesType":function(){define(["exports"],
function(u){u.ObservableChangesType=void 0;var t=u.ObservableChangesType||(u.ObservableChangesType={});t[t.ADD=1]="ADD";t[t.REMOVE=2]="REMOVE";t[t.MOVE=4]="MOVE";Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/core/accessorSupport/decorators/shared":function(){define(["exports"],function(u){u.shared=function(t){return(H,C)=>{H[C]=t}};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/arcade/callExpressionWithCursor":function(){define(["../../../core/Logger",
"../../../core/maybe"],function(u,t){return function(H,C,w){if(t.isNone(H))return null;C=C.readArcadeFeature();try{return H.evaluate({...w,$feature:C})}catch(y){return u.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",y),null}}})},"esri/views/2d/layers/features/support/FeatureSetReaderPBFIndirect":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","./FeatureSetReader"],function(u,t,H){let C=function(w){function y(m,h){var c=w.call(this,
H.FeatureSetReader.createInstance(),m.fullSchema())||this;c._currentIndex=-1;c._reader=m;c._indices=h;return c}t._inheritsLoose(y,w);y.from=function(m,h){return new y(m.copy(),h)};var x=y.prototype;x.getSize=function(){return this._indices.length};x.getCursor=function(){return this.copy()};x.copy=function(){const m=new y(this._reader.copy(),this._indices);m._currentIndex=this._currentIndex;return m};x.next=function(){for(;this._nextIndex()&&!this._reader._getExists(););return this._currentIndex<this._indices.length};
x._nextIndex=function(){return++this._currentIndex<this._indices.length?(this._reader.setIndex(this._indices[this._currentIndex]),!0):!1};x.setArcadeSpatialReference=function(m){this._reader.setArcadeSpatialReference(m)};x.attachStorage=function(m){this._reader.attachStorage(m)};x.getStorage=function(){return this._reader.getStorage()};x.getComputedNumeric=function(m){return this._reader.getComputedNumericAtIndex(0)};x.setComputedNumeric=function(m,h){return this._reader.setComputedNumericAtIndex(h,
0)};x.getComputedString=function(m){return this._reader.getComputedStringAtIndex(0)};x.setComputedString=function(m,h){return this._reader.setComputedStringAtIndex(0,h)};x.getComputedNumericAtIndex=function(m){return this._reader.getComputedNumericAtIndex(m)};x.setComputedNumericAtIndex=function(m,h){this._reader.setComputedNumericAtIndex(m,h)};x.getComputedStringAtIndex=function(m){return this._reader.getComputedStringAtIndex(m)};x.setComputedStringAtIndex=function(m,h){return this._reader.setComputedStringAtIndex(m,
h)};x.transform=function(m,h,c,d){const f=this.copy();f._reader=this._reader.transform(m,h,c,d);return f};x.readAttribute=function(m,h=!1){return this._reader.readAttribute(m,h)};x.readAttributes=function(){return this._reader.readAttributes()};x.joinAttributes=function(m){return this._reader.joinAttributes(m)};x.readArcadeFeature=function(){return this._reader.readArcadeFeature()};x.geometry=function(){return this._reader.geometry()};x.field=function(m){return this.readAttribute(m,!0)};x.hasField=
function(m){return this._reader.hasField(m)};x.setField=function(m,h){return this._reader.setField(m,h)};x.keys=function(){return this._reader.keys()};x.castToText=function(m=!1){return this._reader.castToText(m)};x.getQuantizationTransform=function(){return this._reader.getQuantizationTransform()};x.getFieldNames=function(){return this._reader.getFieldNames()};x.getAttributeHash=function(){return this._reader.getAttributeHash()};x.getObjectId=function(){return this._reader.getObjectId()};x.getDisplayId=
function(){return this._reader.getDisplayId()};x.setDisplayId=function(m){return this._reader.setDisplayId(m)};x.getGroupId=function(){return this._reader.getGroupId()};x.setGroupId=function(m){return this._reader.setGroupId(m)};x.getXHydrated=function(){return this._reader.getXHydrated()};x.getYHydrated=function(){return this._reader.getYHydrated()};x.getX=function(){return this._reader.getX()};x.getY=function(){return this._reader.getY()};x.setIndex=function(m){return this._reader.setIndex(m)};
x.getIndex=function(){return this._reader.getIndex()};x.readLegacyFeature=function(){return this._reader.readLegacyFeature()};x.readOptimizedFeature=function(){return this._reader.readOptimizedFeature()};x.readLegacyPointGeometry=function(){return this._reader.readLegacyPointGeometry()};x.readLegacyGeometry=function(){return this._reader.readLegacyGeometry()};x.readLegacyCentroid=function(){return this._reader.readLegacyCentroid()};x.readGeometryArea=function(){return this._reader.readGeometryArea()};
x.readUnquantizedGeometry=function(){return this._reader.readUnquantizedGeometry()};x.readHydratedGeometry=function(){return this._reader.readHydratedGeometry()};x.readGeometry=function(){return this._reader.readGeometry()};x.readCentroid=function(){return this._reader.readCentroid()};x._readAttribute=function(m,h){throw Error("Error: Should not be called. Underlying _reader should be used instead");};x._readAttributes=function(){throw Error("Error: Should not be called. Underlying _reader should be used instead");
};t._createClass(y,[{key:"hasNext",get:function(){return this._currentIndex+1<this._indices.length}},{key:"geometryType",get:function(){return this._reader.geometryType}},{key:"hasFeatures",get:function(){return this._reader.hasFeatures}},{key:"exceededTransferLimit",get:function(){return this._reader.exceededTransferLimit}},{key:"hasZ",get:function(){return this._reader.hasZ}},{key:"hasM",get:function(){return this._reader.hasM}}]);return y}(H.FeatureSetReader);u.FeatureSetReaderIndirect=C;Object.defineProperty(u,
Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/FeatureSetReader":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry ../../../../../arcade/ArcadeDate ../../../../../arcade/arcadeTimeUtils ../../../../../core/has ../../../../../core/maybe ../../../../../layers/graphics/centroid ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedGeometry ./StaticBitSet ../../../../../geometry/support/jsonUtils".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f){let k=0;H=y("featurelayer-simplify-thresholds")??[.5,.5,.5,.5];const g=H[0],e=H[1],a=H[2],b=H[3];H=y("featurelayer-simplify-payload-size-factors")??[1,2,4];const l=H[0],q=H[1],n=H[2],v=y("featurelayer-simplify-mobile-factor")??2,B=y("esri-mobile");y=function(){function z(r,D){this.type="FeatureSetReader";this.arcadeDeclaredClass="esri.arcade.Feature";this.seen=!1;this._ty=this._tx=this.instance=0;this._sy=this._sx=1;this._deleted=null;this._joined=[];this._objectIdToIndex=
null;this._level=0;this.contextTimeReference=this._datetimeMetadata=null;this.instance=r;this._layerSchema=D}z.createInstance=function(){k++;return k=65535<k?0:k};var p=z.prototype;p.getAreaSimplificationThreshold=function(r,D){let J=1;const K=B?v:1;4E6<D?J=n*K:1E6<D?J=q*K:5E5<D?J=l*K:1E5<D&&(J=K);D=0;4E3<r?D=b*J:2E3<r?D=a*J:100<r?D=e:15<r&&(D=g);r=8;4>this._level?r=1:5>this._level?r=2:6>this._level&&(r=4);return D*r};p.createQuantizedExtrudedQuad=function(r,D){return new c([5],[r-1,D,1,-1,1,1,-1,
1,-1,-1])};p.setArcadeSpatialReference=function(r){this._arcadeSpatialReference=r};p.attachStorage=function(r){this._storage=r};p.getQuantizationTransform=function(){throw Error("Unable to find transform for featureSet");};p.getStorage=function(){return this._storage};p.getComputedNumeric=function(r){return this.getComputedNumericAtIndex(0)};p.setComputedNumeric=function(r,D){return this.setComputedNumericAtIndex(D,0)};p.getComputedString=function(r){return this.getComputedStringAtIndex(0)};p.setComputedString=
function(r,D){return this.setComputedStringAtIndex(0,D)};p.getComputedNumericAtIndex=function(r){return this._storage.getComputedNumericAtIndex(this.getDisplayId(),r)};p.setComputedNumericAtIndex=function(r,D){this._storage.setComputedNumericAtIndex(this.getDisplayId(),r,D)};p.getComputedStringAtIndex=function(r){return this._storage.getComputedStringAtIndex(this.getDisplayId(),r)};p.setComputedStringAtIndex=function(r,D){return this._storage.setComputedStringAtIndex(this.getDisplayId(),r,D)};p.transform=
function(r,D,J,K){const F=this.copy();F._tx+=r;F._ty+=D;F._sx*=J;F._sy*=K;return F};p.readAttribute=function(r,D=!1){var J=this._readAttribute(r,D);if(void 0!==J)return J;for(const K of this._joined)if(K.setIndex(this.getIndex()),J=K._readAttribute(r,D),void 0!==J)return J};p.readAttributes=function(){const r=this._readAttributes();for(const D of this._joined){D.setIndex(this.getIndex());const J=D._readAttributes();for(const K of Object.keys(J))r[K]=J[K]}return r};p.joinAttributes=function(r){this._joined.push(r)};
p.readArcadeFeature=function(){return this};p.geometry=function(){var r=this.readHydratedGeometry();r=h.convertToGeometry(r,this.geometryType,this.hasZ,this.hasM);if(r=f.fromJSON(r))r.spatialReference=this._arcadeSpatialReference;return r};p.autocastArcadeDate=function(r,D){return D&&D instanceof Date?this.isUnknownDateTimeField(r)?C.ArcadeDate.unknownDateJSToArcadeDate(D):C.ArcadeDate.dateJSAndZoneToArcadeDate(D,this.contextTimeReference?.timeZone??"system"):D};p.isUnknownDateTimeField=function(r){return"unknown"===
this.dateTimeReferenceFieldIndex?.fieldTimeZone(r)};p.fieldSourceTimeZone=function(r){return this.dateTimeReferenceFieldIndex?.fieldTimeZone(r)??""};p.field=function(r){if(this.hasField(r))return this.autocastArcadeDate(r,this.readAttribute(r,!0));for(var D of this._joined)if(D.setIndex(this.getIndex()),D.hasField(r))return D=D._readAttribute(r,!0),this.autocastArcadeDate(r,D);throw Error(`Field ${r} does not exist`);};p.setField=function(r,D){throw Error("Unable to update feature attribute values, feature is readonly");
};p.keys=function(){return this.getFieldNames()};p.castToText=function(r=!1){if(!r)return JSON.stringify(this.readLegacyFeature());r=this.readLegacyFeature();if(!r)return JSON.stringify(null);r={geometry:r.geometry,attributes:{...(r.attributes?r.attributes:{})}};for(const D in r.attributes){const J=r.attributes[D];J instanceof Date&&(r.attributes[D]=J.getTime())}return JSON.stringify(r)};p.gdbVersion=function(){return null};p.fullSchema=function(){return this._layerSchema};p.castAsJson=function(r=
null){return{attributes:this._readAttributes(),geometry:!0===r?.keepGeometryType?this.geometry():this.geometry()?.toJSON()??null}};p.castAsJsonAsync=function(r,D=null){return Promise.resolve(this.castAsJson(D))};p.removeIds=function(r){if(x.isNone(this._objectIdToIndex)){var D=new Map;const J=this.getCursor();for(;J.next();){const K=x.unwrapOrThrow(J.getObjectId());D.set(K,J.getIndex())}this._objectIdToIndex=D}D=this._objectIdToIndex;for(const J of r)D.has(J)&&this.removeAtIndex(D.get(J))};p.removeAtIndex=
function(r){x.isNone(this._deleted)&&(this._deleted=d.StaticBitSet.create(this.getSize()));this._deleted.set(r)};p.readGeometryForDisplay=function(){return this.readUnquantizedGeometry(!0)};p.readLegacyGeometryForDisplay=function(){return this.readLegacyGeometry(!0)};p.features=function*(){const r=this.getCursor();for(;r.next();)yield r.readOptimizedFeature()};p._getExists=function(){return x.isNone(this._deleted)||!this._deleted.has(this.getIndex())};p._computeCentroid=function(){if("esriGeometryPolygon"!==
this.geometryType)return null;const r=this.readUnquantizedGeometry();if(!r||r.hasIndeterminateRingOrder)return null;const D=x.unwrapOr(this.getQuantizationTransform(),null);return m.getCentroidOptimizedGeometry(new c,r,this.hasM,this.hasZ,D)};p.copyInto=function(r){r.seen=this.seen;r._storage=this._storage;r._arcadeSpatialReference=this._arcadeSpatialReference;r._joined=this._joined;r._tx=this._tx;r._ty=this._ty;r._sx=this._sx;r._sy=this._sy;r._deleted=this._deleted;r._objectIdToIndex=this._objectIdToIndex};
t._createClass(z,[{key:"isEmpty",get:function(){return x.isSome(this._deleted)&&this._deleted.countSet()===this.getSize()}},{key:"level",set:function(r){this._level=r}},{key:"dateTimeReferenceFieldIndex",get:function(){return this._datetimeMetadata?this._datetimeMetadata:this._datetimeMetadata=w.DateTimeReferenceFieldIndex.create(this._layerSchema.fields,this._layerSchema)}},{key:"layerPreferredTimeZone",get:function(){return this.dateTimeReferenceFieldIndex?.layerPreferredTimeZone??""}}]);return z}();
u.FeatureSetReader=y;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/ArcadeDate":function(){define(["exports","../chunks/_rollupPluginBabelHelpers","./executionError","../chunks/datetime"],function(u,t,H,C){function w(c){if(c instanceof C.Zone)return c;if("system"===c.toLowerCase())return"system";if("utc"===c.toLowerCase())return"utc";if("unknown"===c.toLowerCase())return y.instance;if(/^[\+\-]?[0-9]{1,2}([:][0-9]{2})?$/.test(c)){const d=C.FixedOffsetZone.parseSpecifier("UTC"+
(c.startsWith("+")||c.startsWith("-")?"":"+")+c);if(d)return d}c=C.IANAZone.create(c);if(!c.isValid)throw new m(u.ArcadeDateErrorCodes.TimeZoneNotRecognised);return c}let y=function(){};y.instance=new C.IANAZone("Etc/UTC");u.ArcadeDateErrorCodes=void 0;(u.ArcadeDateErrorCodes||(u.ArcadeDateErrorCodes={})).TimeZoneNotRecognised="TimeZoneNotRecognised";const x={[u.ArcadeDateErrorCodes.TimeZoneNotRecognised]:"Timezone identifier has not been recognised."};let m=function(c){function d(f,k){f=c.call(this,
H.doSubstitutions(x[f],k))||this;f.declaredRootClass="esri.arcade.arcadedate.dateerror";Error.captureStackTrace&&Error.captureStackTrace(t._assertThisInitialized(f),d);return f}t._inheritsLoose(d,c);return d}(t._wrapNativeSuper(Error)),h=function(){function c(f){this._date=f;this.declaredRootClass="esri.arcade.arcadedate"}c.fromParts=function(f=0,k=1,g=1,e=0,a=0,b=0,l=0,q){if(isNaN(f)||isNaN(k)||isNaN(g)||isNaN(e)||isNaN(a)||isNaN(b)||isNaN(l))return null;let n=0;var v=C.DateTime.local(f,k).daysInMonth;
1>g&&(n=g-1,g=1);g>v&&(n=g-v,g=v);v=0;12<k?(v=k-12,k=12):1>k&&(v=k-1,k=1);let B=0;59<a?(B=a-59,a=59):0>a&&(B=a,a=0);let z=0;59<b?(z=b-59,b=59):0>b&&(z=b,b=0);let p=0;999<l?(p=l-999,l=999):0>l&&(p=l,l=0);f=C.DateTime.fromObject({day:g,year:f,month:k,hour:e,minute:a,second:b,millisecond:l},{zone:w(q)});0!==v&&(f=f.plus({months:v}));0!==n&&(f=f.plus({days:n}));0!==B&&(f=f.plus({minutes:B}));0!==z&&(f=f.plus({seconds:z}));0!==p&&(f=f.plus({milliseconds:p}));return new c(f)};c.arcadeDateAndZoneToArcadeDate=
function(f,k){const g=w(k);return f.isUnknownTimeZone||g===y.instance?c.fromParts(f.year,f.monthJS+1,f.day,f.hour,f.minute,f.second,f.millisecond,g):new c(f._date.setZone(k))};c.dateJSToArcadeDate=function(f){return new c(C.DateTime.fromJSDate(f,{zone:"system"}))};c.dateJSAndZoneToArcadeDate=function(f,k="system"){return new c(C.DateTime.fromJSDate(f,{zone:k}))};c.unknownEpochToArcadeDate=function(f){return new c(C.DateTime.fromMillis(f,{zone:y.instance}))};c.unknownDateJSToArcadeDate=function(f){return new c(C.DateTime.fromMillis(f.getTime(),
{zone:y.instance}))};c.epochToArcadeDate=function(f,k="system"){return new c(C.DateTime.fromMillis(f,{zone:k}))};c.dateTimeToArcadeDate=function(f){return new c(f)};var d=c.prototype;d.changeTimeZone=function(f){f=w(f);return c.dateTimeToArcadeDate(this._date.setZone(f))};c.dateTimeAndZoneToArcadeDate=function(f,k){k=w(k);return f.zone===y.instance||k===y.instance?c.fromParts(f.year,f.month,f.day,f.hour,f.minute,f.second,f.millisecond,k):new c(f.setZone(k))};c.nowToArcadeDate=function(f){return new c(C.DateTime.fromJSDate(new Date,
{zone:f}))};c.nowUTCToArcadeDate=function(){return new c(C.DateTime.utc())};d.equals=function(f){return this.isSystem&&f.isSystem?this.toNumber()===f.toNumber():this.isUnknownTimeZone!==f.isUnknownTimeZone?!1:this._date.equals(f._date)};d.stringify=function(){return JSON.stringify(this.toJSDate())};d.plus=function(f){return new c(this._date.plus(f))};d.diff=function(f,k="milliseconds"){return this._date.diff(f._date,k)[k]};d.toISOString=function(f){return f?this._date.toISO({suppressMilliseconds:!0,
includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})};d.toFormat=function(f,k){return this._date.toFormat(f,k)};d.toJSDate=function(){return this._date.toJSDate()};d.toSQLString=function(){return"timestamp '"+this._date.toFormat("yyyy-LL-dd HH:mm:ss")+"'"};d.toDateTime=function(){return this._date};d.toNumber=function(){return this._date.toMillis()};d.getTime=function(){return this._date.toMillis()};d.toUTC=function(){return new c(this._date.toUTC())};
d.toLocal=function(){return new c(this._date.toLocal())};d.toString=function(){return this.toISOString(!0)};t._createClass(c,[{key:"isSystem",get:function(){return"system"===this.timeZone||this.timeZone===c.systemTimeZoneCanonicalName}},{key:"isUnknownTimeZone",get:function(){return this._date.zone===y.instance}},{key:"isValid",get:function(){return this._date.isValid}},{key:"hour",get:function(){return this._date.hour}},{key:"second",get:function(){return this._date.second}},{key:"day",get:function(){return this._date.day}},
{key:"dayOfWeekISO",get:function(){return this._date.weekday}},{key:"dayOfWeekJS",get:function(){let f=this._date.weekday;6<f&&(f=0);return f}},{key:"millisecond",get:function(){return this._date.millisecond}},{key:"monthISO",get:function(){return this._date.month}},{key:"weekISO",get:function(){return this._date.weekNumber}},{key:"yearISO",get:function(){return this._date.weekYear}},{key:"monthJS",get:function(){return this._date.month-1}},{key:"year",get:function(){return this._date.year}},{key:"minute",
get:function(){return this._date.minute}},{key:"zone",get:function(){return this._date.zone}},{key:"timeZoneOffset",get:function(){return this.isUnknownTimeZone?0:this._date.offset}},{key:"timeZone",get:function(){if(this.isUnknownTimeZone)return"unknown";if("system"===this._date.zone.type)return"system";const f=this.zone;return"fixed"===f.type?0===f.fixed?"utc":f.formatOffset(0,"short"):f.name}}],[{key:"systemTimeZoneCanonicalName",get:function(){return Intl.DateTimeFormat().resolvedOptions().timeZone??
"system"}}]);return c}();u.ArcadeDate=h;u.ArcadeDateError=m;u.ArcadeDateErrorMessages=x;u.UnknownTimeZone=y;u.createDateTimeZone=w;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/arcadeTimeUtils":function(){define("exports ../chunks/_rollupPluginBabelHelpers ./ArcadeDate ../layers/support/FieldsIndex ../time/TimeReference ../chunks/datetime ../time/timeReferenceUtils".split(" "),function(u,t,H,C,w,y,x){function m(c){return c?.timeZoneIANA?c?.timeZoneIANA:c?.timeZone?x.convertLegacyTimeZone(c,
""):""}let h=function(){function c(){this.dateTimeReferenceMetaData=null;this._fieldTimeZoneIndex={};this._ianaLayerDateFields=this._ianaEditFields=this._ianaTimeInfo=this._ianaPreferred=this._fieldIndex=null}c.create=function(f,k){const g=new c;g.dateTimeReferenceMetaData=k;g._fieldIndex=f instanceof C?f:new C(f);return g};c.createFromLayer=function(f){if(!f)return null;if(!f.fieldsIndex)return!f.declaredClass&&f.fields?c.create(f.fields,f):null;const k=new c;k._fieldIndex=f.fieldsIndex;k.dateTimeReferenceMetaData=
{timeInfo:f?.timeInfo?.toJSON()??null,editFieldsInfo:f?.editFieldsInfo?.toJSON()??null,dateFieldsTimeReference:f?.dateFieldsTimeReference?.toJSON()??null,preferredTimeReference:f?.preferredTimeReference?.toJSON()??null,datesInUnknownTimezone:!0===f?.datesInUnknownTimezone};return k};var d=c.prototype;d.fieldTimeZone=function(f){f=this._fieldIndex?.get(f);if(!f||"date"!==f.type&&"esriFieldTypeDate"!==f.type)return null;var k=this._fieldTimeZoneIndex[f.name];if(void 0!==k)return k;k=[{field:this.dateTimeReferenceMetaData?.editFieldsInfo?.creationDateField,
timeReference:this.dateTimeReferenceMetaData?.editFieldsInfo?.dateFieldsTimeReference,isunknown:!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone},{field:this.dateTimeReferenceMetaData?.editFieldsInfo?.editDateField,timeReference:this.dateTimeReferenceMetaData?.editFieldsInfo?.dateFieldsTimeReference,isunknown:!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone},{field:this.dateTimeReferenceMetaData?.timeInfo?.startTimeField,timeReference:this.dateTimeReferenceMetaData?.timeInfo?.timeReference,
isunknown:!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone},{field:this.dateTimeReferenceMetaData?.timeInfo?.endTimeField,timeReference:this.dateTimeReferenceMetaData?.timeInfo?.timeReference,isunknown:!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone}];for(var g of k)if(g.field===f.name)return g=this.convertToIANA(g.timeReference,g.isunknown),this._fieldTimeZoneIndex[f.name]=g;g=this.convertToIANA(this.dateTimeReferenceMetaData?.dateFieldsTimeReference,this.dateTimeReferenceMetaData?.datesInUnknownTimezone);
return this._fieldTimeZoneIndex[f.name]=g};d.convertToIANA=function(f,k){return k?"unknown":m(f)};t._createClass(c,[{key:"layerPreferredTimeZone",get:function(){if(null!==this._ianaPreferred)return this._ianaPreferred;this._ianaPreferred="";return this._ianaPreferred=this.convertToIANA(this.dateTimeReferenceMetaData?.preferredTimeReference,!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone)}},{key:"layerTimeInfoTimeZone",get:function(){if(null!==this._ianaTimeInfo)return this._ianaTimeInfo;
this._ianaTimeInfo="";return this._ianaTimeInfo=this.convertToIANA(this.dateTimeReferenceMetaData?.timeInfo?.timeReference,!1)}},{key:"layerEditFieldsTimeZone",get:function(){if(null!==this._ianaEditFields)return this._ianaEditFields;this._ianaEditFields="";return this._ianaEditFields=this.convertToIANA(this.dateTimeReferenceMetaData?.editFieldsInfo?.dateFieldsTimeReference,this.dateTimeReferenceMetaData?.datesInUnknownTimezone)}},{key:"layerDateFieldsTimeZone",get:function(){if(null!==this._ianaLayerDateFields)return this._ianaLayerDateFields;
this._ianaLayerDateFields="";return this._ianaLayerDateFields=this.convertToIANA(this.dateTimeReferenceMetaData?.dateFieldsTimeReference,!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone)}}]);return c}();u.DateTimeReferenceFieldIndex=h;u.convertTimeReference=function(c){if(!c)return null;c instanceof w&&(c=m(c.toJSON()));if(c instanceof y.Zone)return c;if("unknown"===c.toLowerCase())return H.UnknownTimeZone.instance;if("system"===c.toLowerCase())return y.SystemZone.instance;if("utc"===c.toLowerCase())return y.FixedOffsetZone.utcInstance;
if(/^[\+\-]?[0-9]{1,2}([:][0-9]{2})?$/.test(c)){const d=y.FixedOffsetZone.parseSpecifier("UTC"+(c.startsWith("+")||c.startsWith("-")?"":"+")+c);if(d)return d}c=y.IANAZone.create(c);if(!c.isValid)throw new H.ArcadeDateError(H.ArcadeDateErrorCodes.TimeZoneNotRecognised);return c};u.convertToIANA=m;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/time/TimeReference":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Clonable ../core/JSONSupport ../core/maybe ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../core/accessorSupport/decorators/writer ./timeReferenceUtils".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f){H=function(k){function g(a){a=k.call(this,a)||this;a.legacy=null;a.timeZone="system";return a}u._inheritsLoose(g,k);var e=g.prototype;e.readLegacy=function(a,b){const {timeZone:l,respectsDaylightSaving:q}=b;return{timeZone:l,respectsDaylightSaving:q}};e.readTimeZone=function(a,b){return"timeZoneIANA"in b?b.timeZoneIANA:f.convertLegacyTimeZone(b)};e.writeTimeZone=function(a,b){b.timeZoneIANA=a};e.equals=function(a){return w.isNone(a)||w.isNone(this.timeZone)||w.isNone(a.timeZone)?
!1:this.timeZone===a.timeZone};return g}(H.ClonableMixin(C.JSONSupport));t.__decorate([y.property()],H.prototype,"legacy",void 0);t.__decorate([h.reader("legacy",["timeZone"])],H.prototype,"readLegacy",null);t.__decorate([y.property({type:String,nonNullable:!0})],H.prototype,"timeZone",void 0);t.__decorate([h.reader("timeZone",["timeZone","timeZoneIANA","respectsDaylightSaving"])],H.prototype,"readTimeZone",null);t.__decorate([d.writer("timeZone")],H.prototype,"writeTimeZone",null);return H=t.__decorate([c.subclass("esri.time.TimeReference")],
H)})},"esri/core/Clonable":function(){define("exports ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./Accessor ./has ./lang ./Logger ./maybe ./accessorSupport/PropertyOrigin ./accessorSupport/utils ./accessorSupport/decorators/subclass".split(" "),function(u,t,H,C,w,y,x,m,h,c,d){w=f=>{f=function(k){function g(){return k.apply(this,arguments)||this}t._inheritsLoose(g,k);g.prototype.clone=function(){var e=m.unwrapOrThrow(c.getProperties(this),"unable to clone instance of non-accessor class"),
a=e.metadatas;const b=e.store,l={};e=new Map;for(var q in a){var n=a[q];const v=b?.originOf(q),B=n.clonable;if(n.readOnly||!1===B||v!==h.OriginId.USER&&v!==h.OriginId.DEFAULTS&&v!==h.OriginId.WEB_MAP&&v!==h.OriginId.WEB_SCENE)continue;n=this[q];let z=null;z="function"===typeof B?B(n):"reference"===B?n:y.tryClone(n);if(null==n||null!=z)v===h.OriginId.DEFAULTS?e.set(q,z):l[q]=z}a=new (Object.getPrototypeOf(this).constructor)(l);if(e.size&&(q=c.getProperties(a)?.store))for(const [v,B]of e)q.set(v,B,
h.OriginId.DEFAULTS);return a};return g}(f);return f=H.__decorate([d.subclass("esri.core.Clonable")],f)};u.Clonable=function(f){function k(){return f.apply(this,arguments)||this}t._inheritsLoose(k,f);return k}(w(C));u.Clonable=H.__decorate([d.subclass("esri.core.Clonable")],u.Clonable);u.ClonableMixin=w;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/time/timeReferenceUtils":function(){define(["exports","./legacyTimeZoneMap","../chunks/datetime"],function(u,t,H){u.convertLegacyTimeZone=
function(C,w="system"){if(!C||!t.legacyTimeZoneMap.has(C.timeZone))return w;w=t.legacyTimeZoneMap.get(C.timeZone);if(C.timeZone.startsWith("UTC")||C.respectsDaylightSaving)return w;C=H.DateTime.local().setZone(w);C=Math.min(C.set({month:1,day:1}).offset,C.set({month:5}).offset);C=0===C?"Etc/UTC":`Etc/GMT${H.FixedOffsetZone.instance(-C).formatOffset(0,"narrow")}`;return C};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/time/legacyTimeZoneMap":function(){define(["exports"],function(u){const t=
new Map([["AUS Central Standard Time","Australia/Darwin"],["AUS Eastern Standard Time","Australia/Sydney"],["Afghanistan Standard Time","Asia/Kabul"],["Alaskan Standard Time","America/Anchorage"],["Aleutian Standard Time","America/Adak"],["Altai Standard Time","Asia/Barnaul"],["Arab Standard Time","Asia/Riyadh"],["Arabian Standard Time","Asia/Dubai"],["Arabic Standard Time","Asia/Baghdad"],["Argentina Standard Time","America/Buenos_Aires"],["Astrakhan Standard Time","Europe/Astrakhan"],["Atlantic Standard Time",
"America/Halifax"],["Aus Central W. Standard Time","Australia/Eucla"],["Azerbaijan Standard Time","Asia/Baku"],["Azores Standard Time","Atlantic/Azores"],["Bahia Standard Time","America/Bahia"],["Bangladesh Standard Time","Asia/Dhaka"],["Belarus Standard Time","Europe/Minsk"],["Bougainville Standard Time","Pacific/Bougainville"],["Canada Central Standard Time","America/Regina"],["Cape Verde Standard Time","Atlantic/Cape_Verde"],["Caucasus Standard Time","Asia/Yerevan"],["Cen. Australia Standard Time",
"Australia/Adelaide"],["Central America Standard Time","America/Guatemala"],["Central Asia Standard Time","Asia/Almaty"],["Central Brazilian Standard Time","America/Cuiaba"],["Central Europe Standard Time","Europe/Budapest"],["Central European Standard Time","Europe/Warsaw"],["Central Pacific Standard Time","Pacific/Guadalcanal"],["Central Standard Time","America/Chicago"],["Central Standard Time (Mexico)","America/Mexico_City"],["Chatham Islands Standard Time","Pacific/Chatham"],["China Standard Time",
"Asia/Shanghai"],["Cuba Standard Time","America/Havana"],["Dateline Standard Time","Etc/GMT+12"],["E. Africa Standard Time","Africa/Nairobi"],["E. Australia Standard Time","Australia/Brisbane"],["E. Europe Standard Time","Europe/Chisinau"],["E. South America Standard Time","America/Sao_Paulo"],["Easter Island Standard Time","Pacific/Easter"],["Eastern Standard Time","America/New_York"],["Eastern Standard Time (Mexico)","America/Cancun"],["Egypt Standard Time","Africa/Cairo"],["Ekaterinburg Standard Time",
"Asia/Yekaterinburg"],["FLE Standard Time","Europe/Kiev"],["Fiji Standard Time","Pacific/Fiji"],["GMT Standard Time","Europe/London"],["GTB Standard Time","Europe/Bucharest"],["Georgian Standard Time","Asia/Tbilisi"],["Greenland Standard Time","America/Godthab"],["Greenwich Standard Time","Atlantic/Reykjavik"],["Haiti Standard Time","America/Port-au-Prince"],["Hawaiian Standard Time","Pacific/Honolulu"],["India Standard Time","Asia/Calcutta"],["Iran Standard Time","Asia/Tehran"],["Israel Standard Time",
"Asia/Jerusalem"],["Jordan Standard Time","Asia/Amman"],["Kaliningrad Standard Time","Europe/Kaliningrad"],["Korea Standard Time","Asia/Seoul"],["Libya Standard Time","Africa/Tripoli"],["Line Islands Standard Time","Pacific/Kiritimati"],["Lord Howe Standard Time","Australia/Lord_Howe"],["Magadan Standard Time","Asia/Magadan"],["Magallanes Standard Time","America/Punta_Arenas"],["Marquesas Standard Time","Pacific/Marquesas"],["Mauritius Standard Time","Indian/Mauritius"],["Middle East Standard Time",
"Asia/Beirut"],["Montevideo Standard Time","America/Montevideo"],["Morocco Standard Time","Africa/Casablanca"],["Mountain Standard Time","America/Denver"],["Mountain Standard Time (Mexico)","America/Chihuahua"],["Myanmar Standard Time","Asia/Rangoon"],["N. Central Asia Standard Time","Asia/Novosibirsk"],["Namibia Standard Time","Africa/Windhoek"],["Nepal Standard Time","Asia/Katmandu"],["New Zealand Standard Time","Pacific/Auckland"],["Newfoundland Standard Time","America/St_Johns"],["Norfolk Standard Time",
"Pacific/Norfolk"],["North Asia East Standard Time","Asia/Irkutsk"],["North Asia Standard Time","Asia/Krasnoyarsk"],["North Korea Standard Time","Asia/Pyongyang"],["Omsk Standard Time","Asia/Omsk"],["Pacific SA Standard Time","America/Santiago"],["Pacific Standard Time","America/Los_Angeles"],["Pacific Standard Time (Mexico)","America/Tijuana"],["Pakistan Standard Time","Asia/Karachi"],["Paraguay Standard Time","America/Asuncion"],["Qyzylorda Standard Time","Asia/Qyzylorda"],["Romance Standard Time",
"Europe/Paris"],["Russia Time Zone 10","Asia/Srednekolymsk"],["Russia Time Zone 11","Asia/Kamchatka"],["Russia Time Zone 3","Europe/Samara"],["Russian Standard Time","Europe/Moscow"],["SA Eastern Standard Time","America/Cayenne"],["SA Pacific Standard Time","America/Bogota"],["SA Western Standard Time","America/La_Paz"],["SE Asia Standard Time","Asia/Bangkok"],["Saint Pierre Standard Time","America/Miquelon"],["Sakhalin Standard Time","Asia/Sakhalin"],["Samoa Standard Time","Pacific/Apia"],["Sao Tome Standard Time",
"Africa/Sao_Tome"],["Saratov Standard Time","Europe/Saratov"],["Singapore Standard Time","Asia/Singapore"],["South Africa Standard Time","Africa/Johannesburg"],["South Sudan Standard Time","Africa/Juba"],["Sri Lanka Standard Time","Asia/Colombo"],["Sudan Standard Time","Africa/Khartoum"],["Syria Standard Time","Asia/Damascus"],["Taipei Standard Time","Asia/Taipei"],["Tasmania Standard Time","Australia/Hobart"],["Tocantins Standard Time","America/Araguaina"],["Tokyo Standard Time","Asia/Tokyo"],["Tomsk Standard Time",
"Asia/Tomsk"],["Tonga Standard Time","Pacific/Tongatapu"],["Transbaikal Standard Time","Asia/Chita"],["Turkey Standard Time","Europe/Istanbul"],["Turks And Caicos Standard Time","America/Grand_Turk"],["US Eastern Standard Time","America/Indianapolis"],["US Mountain Standard Time","America/Phoenix"],["UTC","Etc/GMT"],["UTC+01","Etc/GMT-1"],["UTC+02","Etc/GMT-2"],["UTC+03","Etc/GMT-3"],["UTC+04","Etc/GMT-4"],["UTC+05","Etc/GMT-5"],["UTC+06","Etc/GMT-6"],["UTC+07","Etc/GMT-7"],["UTC+08","Etc/GMT-8"],
["UTC+09","Etc/GMT-9"],["UTC+10","Etc/GMT-10"],["UTC+11","Etc/GMT-11"],["UTC+12","Etc/GMT-12"],["UTC+13","Etc/GMT-13"],["UTC+14","Etc/GMT-14"],["UTC-01","Etc/GMT+1"],["UTC-02","Etc/GMT+2"],["UTC-03","Etc/GMT+3"],["UTC-04","Etc/GMT+4"],["UTC-05","Etc/GMT+5"],["UTC-06","Etc/GMT+6"],["UTC-07","Etc/GMT+7"],["UTC-08","Etc/GMT+8"],["UTC-09","Etc/GMT+9"],["UTC-10","Etc/GMT+10"],["UTC-11","Etc/GMT+11"],["UTC-12","Etc/GMT+12"],["Ulaanbaatar Standard Time","Asia/Ulaanbaatar"],["Venezuela Standard Time","America/Caracas"],
["Vladivostok Standard Time","Asia/Vladivostok"],["Volgograd Standard Time","Europe/Volgograd"],["W. Australia Standard Time","Australia/Perth"],["W. Central Africa Standard Time","Africa/Lagos"],["W. Europe Standard Time","Europe/Berlin"],["W. Mongolia Standard Time","Asia/Hovd"],["West Asia Standard Time","Asia/Tashkent"],["West Bank Standard Time","Asia/Hebron"],["West Pacific Standard Time","Pacific/Port_Moresby"],["Yakutsk Standard Time","Asia/Yakutsk"],["Yukon Standard Time","America/Whitehorse"]]);
u.legacyTimeZoneMap=t;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/centroid":function(){define(["exports","../../core/maybe"],function(u,t){function H(w,y,x,m,h,c,d=1){c=h?c?4:3:c?3:2;let f=x,k=x+c,g=0,e=0,a=x=0,b=0;for(let l=0,q=m-1;l<q;l++,f+=c,k+=c){m=y[f];const n=y[f+1],v=y[f+2],B=y[k],z=y[k+1],p=y[k+2];let r=m*z-B*n;a+=r;g+=(m+B)*r;e+=(n+z)*r;h&&(r=m*p-B*v,x+=(v+p)*r,b+=r);m<w[0]&&(w[0]=m);m>w[1]&&(w[1]=m);n<w[2]&&(w[2]=n);n>w[3]&&(w[3]=n);h&&(v<w[4]&&
(w[4]=v),v>w[5]&&(w[5]=v))}0<a*d&&(a*=-1);0<b*d&&(b*=-1);if(!a)return null;w=[g,e,.5*a];h&&(w[3]=x,w[4]=.5*b);return w}function C(w,y,x,m,h){h=m?h?4:3:h?3:2;let c=y,d=y+h,f=0,k=0,g=0,e=0;for(let q=0,n=x-1;q<n;q++,c+=h,d+=h){var a=w[c];const v=w[c+1],B=w[c+2],z=w[d],p=w[d+1],r=w[d+2];if(m){var b=z-a;var l=p-v;const D=r-B;b=Math.sqrt(b*b+l*l+D*D)}else b=z-a,l=p-v,b=Math.sqrt(b*b+l*l);b&&(f+=b,m?(a=[a+.5*(z-a),v+.5*(p-v),B+.5*(r-B)],k+=b*a[0],g+=b*a[1],e+=b*a[2]):(a=[a+.5*(z-a),v+.5*(p-v)],k+=b*a[0],
g+=b*a[1]))}return 0<f?m?[k/f,g/f,e/f]:[k/f,g/f]:0<x?m?[w[y],w[y+1],w[y+2]]:[w[y],w[y+1]]:null}u.getCentroidOptimizedGeometry=function(w,y,x,m,h){if(t.isNone(y)||!y.lengths.length)return null;const c="upperLeft"===h?.originPosition?-1:1;w.lengths.length&&(w.lengths.length=0);w.coords.length&&(w.coords.length=0);h=w.coords;const d=[],f=x?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,
Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:k,coords:g}=y,e=x?m?4:3:m?3:2;let a=0;for(var b of k){const l=H(f,g,a,b,x,m,c);l&&d.push(l);a+=b*e}d.sort((l,q)=>{let n=c*l[2]-c*q[2];0===n&&x&&(n=l[4]-q[4]);return n});d.length&&(b=6*d[0][2],h[0]=d[0][0]/b,h[1]=d[0][1]/b,x&&(b=6*d[0][4],h[2]=0!==b?d[0][3]/b:0),h[0]<f[0]||h[0]>f[1]||h[1]<f[2]||h[1]>f[3]||x&&(h[2]<f[4]||h[2]>f[5]))&&(h.length=0);if(!h.length)if(y=y.lengths[0]?C(g,0,k[0],x,m):null)h[0]=y[0],h[1]=y[1],
x&&2<y.length&&(h[2]=y[2]);else return null;return w};u.lineCentroid=C;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/StaticBitSet":function(){define(["exports"],function(u){let t=function(){function H(w,y){this._mask=0;this._buf=w;this._mask=y}H.fromBuffer=function(w,y){return new H(w,y)};H.create=function(w,y=4294967295){w=new Uint32Array(Math.ceil(w/32));return new H(w,y)};var C=H.prototype;C._getIndex=function(w){return Math.floor(w/32)};
C.has=function(w){w&=this._mask;return!!(this._buf[this._getIndex(w)]&1<<w%32)};C.hasRange=function(w,y){for(;w%32&&w!==y;){if(this.has(w))return!0;w++}for(;y%32&&w!==y;){if(this.has(w))return!0;y--}if(w===y)return!1;for(w/=32;w!==y/32;w++)if(this._buf[w])return!0;return!1};C.set=function(w){w&=this._mask;const y=this._getIndex(w);this._buf[y]|=1<<w%32};C.setRange=function(w,y){for(;w%32&&w!==y;)this.set(w++);for(;y%32&&w!==y;)this.set(y--);if(w!==y)for(w/=32;w!==y/32;w++)this._buf[w]=4294967295};
C.unset=function(w){w&=this._mask;const y=this._getIndex(w);this._buf[y]&=4294967295^1<<w%32};C.resize=function(w){const y=this._buf;w=new Uint32Array(Math.ceil(w/32));w.set(y);this._buf=w};C.or=function(w){for(let y=0;y<this._buf.length;y++)this._buf[y]|=w._buf[y];return this};C.and=function(w){for(let y=0;y<this._buf.length;y++)this._buf[y]&=w._buf[y];return this};C.xor=function(w){for(let y=0;y<this._buf.length;y++)this._buf[y]^=w._buf[y];return this};C.ior=function(w){for(let y=0;y<this._buf.length;y++)this._buf[y]|=
~w._buf[y];return this};C.iand=function(w){for(let y=0;y<this._buf.length;y++)this._buf[y]&=~w._buf[y];return this};C.ixor=function(w){for(let y=0;y<this._buf.length;y++)this._buf[y]^=~w._buf[y];return this};C.any=function(){for(let w=0;w<this._buf.length;w++)if(this._buf[w])return!0;return!1};C.copy=function(w){for(let y=0;y<this._buf.length;y++)this._buf[y]=w._buf[y];return this};C.clone=function(){return new H(this._buf.slice(),this._mask)};C.clear=function(){for(let w=0;w<this._buf.length;w++)this._buf[w]=
0};C.forEachSet=function(w){for(let y=0;y<this._buf.length;y++){let x=this._buf[y],m=32*y;if(x)for(;x;)x&1&&w(m),x>>>=1,m++}};C.countSet=function(){let w=0;this.forEachSet(y=>{w++});return w};return H}();u.StaticBitSet=t;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/sources/createSource":function(){define("exports ../../../../../core/maybe ../../../../../layers/support/arcgisLayerUrl ./DrillDownFeatureSource ./PagedFeatureSource ./SnapshotFeatureSource ./StreamSource".split(" "),
function(u,t,H,C,w,y,x){u.createSource=function(m,h,c,d,f,k){a:{switch(m.type){case "snapshot":m={type:"feature",origin:"snapshot",featureCount:t.unwrapOr(m.featureCount,0),serviceInfo:m,onMessage:d,outSR:h,tileInfoView:c,canAcceptRequest:f,store:k};break a;case "stream":m={type:"stream",serviceInfo:m,onMessage:d,outSR:h,canAcceptRequest:f};break a;case "memory":case "on-demand":k=m.source;k=Array.isArray(k)?"local":"path"in k&&H.isHostedAgolService(k.path)?"hosted":"unknown";m={type:"feature",serviceInfo:m,
onMessage:d,outSR:h,origin:k,tileInfoView:c,canAcceptRequest:f};break a}m=void 0}switch(m.type){case "feature":switch(m.origin){case "hosted":case "local":return new w.PagedFeatureSource(m);case "snapshot":return new y.SnapshotFeatureSource(m);default:case "unknown":return new C.DrillDownFeatureSource(m)}case "stream":return new x.StreamSource(m)}};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/arcgisLayerUrl":function(){define(["exports","../../core/maybe","../../core/urlUtils",
"../../chunks/persistableUrlUtils"],function(u,t,H,C){function w(k){if(t.isNone(k))return null;k=H.urlToObject(k);k=k.path.match(c)||k.path.match(d);if(!k)return null;const [,g,e,a,b]=k;k=e.indexOf("/");return{title:x(-1!==k?e.slice(k+1):e),serverType:m[a.toLowerCase()],sublayer:null!=b&&""!==b?parseInt(b,10):null,url:{path:g}}}function y(k){return(k=H.urlToObject(k).path.match(f))?{serviceUrl:k[1],sublayerId:Number(k[2])}:null}function x(k){k=k.replace(/\s*[/_]+\s*/g," ");return k[0].toUpperCase()+
k.slice(1)}const m={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer"},h=Object.values(m),c=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${h.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),d=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(${h.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),f=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;u.cleanTitle=x;u.isArcGISUrl=
function(k){return!!c.test(k)};u.isHostedAgolService=function(k){if(!k)return!1;k=k.toLowerCase();const g=k.includes(".arcgis.com/");k=k.includes("//services")||k.includes("//tiles")||k.includes("//features");return g&&k};u.isServerOrServicesAGOLUrl=function(k){if(!k)return!1;k=(new H.Url(H.makeAbsolute(k))).authority?.toLowerCase();return"server.arcgisonline.com"===k||"services.arcgisonline.com"===k};u.isWmsServer=function(k){if(!k)return!1;var g=k.toLowerCase();k=g.includes("/services/");const e=
g.includes("/mapserver/wmsserver"),a=g.includes("/imageserver/wmsserver");g=g.includes("/wmsserver");return k&&(e||a||g)};u.parse=w;u.parseNonStandardSublayerUrl=y;u.sanitizeUrl=function(k,g){return k?H.removeTrailingSlash(H.removeQueryParameters(k,g)):k};u.sanitizeUrlWithLayerId=function(k){let {url:g}=k;if(!g)return{url:g};g=H.removeQueryParameters(g,k.logger);const e=H.urlToObject(g),a=w(e.path);let b=void 0;t.isSome(a)?(null!=a.sublayer&&null==k.layer.layerId&&(b=a.sublayer),g=a.url.path):k.nonStandardUrlAllowed&&
(k=y(e.path),t.isSome(k)&&(g=k.serviceUrl,b=k.sublayerId));return{url:H.removeTrailingSlash(g),layerId:b}};u.serverTypes=h;u.titleFromUrlAndName=function(k,g){const e=[];k&&(k=w(k),t.isSome(k)&&k.title&&e.push(k.title));g&&(g=x(g),e.push(g));if(2===e.length){if(e[0].toLowerCase().includes(e[1].toLowerCase()))return e[0];if(e[1].toLowerCase().includes(e[0].toLowerCase()))return e[1]}return e.join(" - ")};u.writeUrlWithLayerId=function(k,g,e,a,b){C.write(g,a,"url",b);a.url&&null!=k.layerId&&(a.url=
H.join(a.url,e,k.layerId.toString()))};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/persistableUrlUtils":function(){define(["exports","../core/maybe","../core/urlUtils"],function(u,t,H){function C(e,a){var b=a&&a.url&&a.url.path;e&&b&&(e=H.makeAbsolute(e,b,{preserveProtocolRelative:!0}),a.portalItem&&a.readResourcePaths&&(b=H.makeRelative(e,a.portalItem.itemUrl),null!=b&&k.test(b)&&a.readResourcePaths.push(a.portalItem.resourceFromPath(b).path)));return d(e,a&&a.portal)}
function w(e,a,b=u.MarkKeep.YES){if(null==e)return e;!H.isAbsolute(e)&&a&&a.blockedRelativeUrls&&a.blockedRelativeUrls.push(e);let l=H.makeAbsolute(e);if(a){var q=a.verifyItemRelativeUrls&&a.verifyItemRelativeUrls.rootPath||a.url&&a.url.path;if(q){q=d(q,a.portal);const n=d(l,a.portal);l=H.makeRelative(n,q,q);null!=l&&l!==n&&l!==e&&a.verifyItemRelativeUrls&&a.verifyItemRelativeUrls.writtenUrls.push(l)}}l=c(l,a?.portal);H.isAbsolute(l)&&(l=H.normalize(l));a?.resources&&a?.portalItem&&!H.isAbsolute(l)&&
!H.isDataProtocol(l)&&b===u.MarkKeep.YES&&a.resources.toKeep.push({resource:a.portalItem.resourceFromPath(l),compress:!1});return l}function y(e,a,b){return C(e,b)}function x(e,a,b,l){e=w(e,l);void 0!==e&&(a[b]=e)}function m(e){return(e?.match(f)??null)?.[1]??null}function h(e){e=e?.match(f)??null;if(null==e)return null;e=e[2];const a=e.lastIndexOf("/");if(-1===a){const {path:q,extension:n}=H.splitPathExtension(e);return{prefix:null,filename:q,extension:t.unwrap(n)}}const {path:b,extension:l}=H.splitPathExtension(e.slice(a+
1));return{prefix:e.slice(0,a),filename:b,extension:t.unwrap(l)}}function c(e,a){return a&&!a.isPortal&&a.urlKey&&a.customBaseUrl?H.changeDomain(e,`${a.urlKey}.${a.customBaseUrl}`,a.portalHostname):e}function d(e,a){if(!a||a.isPortal||!a.urlKey||!a.customBaseUrl)return e;const b=`${a.urlKey}.${a.customBaseUrl}`,l=H.getAppUrl();return H.hasSameOrigin(l,`${l.scheme}://${b}`)?H.changeDomain(e,a.portalHostname,b):H.changeDomain(e,b,a.portalHostname)}const f=/\/items\/([^\/]+)\/resources\/(.*)/,k=/^\.\/resources\//;
u.MarkKeep=void 0;(function(e){e[e.YES=0]="YES";e[e.NO=1]="NO"})(u.MarkKeep||(u.MarkKeep={}));const g=Object.freeze(Object.defineProperty({__proto__:null,get MarkKeep(){return u.MarkKeep},ensureMainOnlineDomain:c,fromJSON:C,itemIdFromResourceUrl:m,prefixAndFilenameFromResourceUrl:h,read:y,toJSON:w,write:x},Symbol.toStringTag,{value:"Module"}));u.ensureMainOnlineDomain=c;u.fromJSON=C;u.itemIdFromResourceUrl=m;u.persistableUrlUtils=g;u.prefixAndFilenameFromResourceUrl=h;u.read=y;u.toJSON=w;u.write=
x})},"esri/views/2d/layers/features/sources/DrillDownFeatureSource":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/has","../../../../../core/promiseUtils","./BaseFeatureSource"],function(u,t,H,C,w){var y=(H=H("esri-mobile"))?1:4,x=H?1:3;w=function(m){function h(c){return m.call(this,c)||this}t._inheritsLoose(h,m);h.prototype._fetchDataTile=function(){var c=t._asyncToGenerator(function*(d){var f=this;const k=this._serviceInfo.capabilities.query.supportsMaxRecordCountFactor,
g=this._subscriptions.get(d.key.id),e=g.signal,a=d.getQuantizationParameters();let b=0;const l=function(){var q=t._asyncToGenerator(function*(n,v){const B=f._queryInfo,z=f.createTileQuery(n,{maxRecordCountFactor:k?x:void 0,returnExceededLimitFeatures:!1,quantizationParameters:a});b++;try{const r=yield f._queue.push({tile:d,query:z,signal:e,depth:v});b--;C.throwIfAborted(e);if(r)if(B!==f._queryInfo)l(n,v);else if(r.exceededTransferLimit&&v<y)for(const D of n.createChildTiles())l(D,v+1);else{var p=
{id:d.id,addOrUpdate:r,end:0===b,type:"append"};g.add({query:z,message:p});f._onMessage(p)}}catch(r){C.isAbortError(r)||f._onMessage({id:d.id,addOrUpdate:null,end:!0,type:"append"})}});return function(n,v){return q.apply(this,arguments)}}();l(d,0)});return function(d){return c.apply(this,arguments)}}();return h}(w.BaseFeatureSource);u.DrillDownFeatureSource=w;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/sources/BaseFeatureSource":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../request ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/promiseUtils ../controllers/support/sourceAdapters ./DataTileSource ../../../../support/QueueProcessor".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d){c=function(f){function k(e){var a=f.call(this,e)||this;a.type="feature";a.mode="on-demand";a._adapter=h.createSourceAdapter(e.serviceInfo);a._queue=new d.QueueProcessor({concurrency:8,process:function(){var b=t._asyncToGenerator(function*(l){m.throwIfAborted(l);if(x.isSome(l.tile)){var q=l.tile.key.id,{signal:n}=l;q=w("esri-tiles-debug")?{tile:q.replace(/\//g,"."),depth:l.depth}:void 0;n=yield a._adapter.executeQuery(l.query,{signal:n,query:{...q,...a._schema?.customParameters}});
n.level=l.tile.key.level;return n}return a._adapter.executeQuery(l.query,{...l,query:a._schema?.customParameters})});return function(l){return b.apply(this,arguments)}}()});a._patchQueue=new d.QueueProcessor({concurrency:8,process:function(){var b=t._asyncToGenerator(function*(l){m.throwIfAborted(l);if(x.isSome(l.tile)){var q=l.tile.key.id,{signal:n}=l;q=w("esri-tiles-debug")?{tile:q.replace(/\//g,"."),depth:l.depth}:void 0;n=yield a._adapter.executeQuery(l.query,{signal:n,query:{...q,...a._schema?.customParameters}});
n.level=l.tile.key.level;return n}return a._adapter.executeQuery(l.query,{...l,query:a._schema?.customParameters})});return function(l){return b.apply(this,arguments)}}()});return a}t._inheritsLoose(k,f);var g=k.prototype;g.destroy=function(){f.prototype.destroy.call(this);this._adapter.destroy();this._queue.destroy();this._patchQueue.destroy()};g.enableEvent=function(e,a){};g.subscribe=function(e,a){f.prototype.subscribe.call(this,e,a);const b=this._subscriptions.get(e.id);this._fetchDataTile(e).catch(l=>
{m.isAbortError(l)||y.getLogger("esri.views.2d.layers.features.sources.BaseFeatureSource").error(new C("mapview-query-error","Encountered error when fetching tile",{tile:e,error:l}))}).then(()=>b.end())};g.unsubscribe=function(e){f.prototype.unsubscribe.call(this,e)};g.readers=function(e){return this._subscriptions.get(e).readers()};g.query=function(){var e=t._asyncToGenerator(function*(a,b={}){return this._adapter.executeQuery(a,{...b,query:{...(b.query??{}),...this._schema?.customParameters}})});
return function(a){return e.apply(this,arguments)}}();g.queryLastEditDate=function(){var e=t._asyncToGenerator(function*(){const a=this._serviceInfo.source;return(yield H(a.path,{query:{...a.query,f:"json"},responseType:"json"})).data.editingInfo.lastEditDate});return function(){return e.apply(this,arguments)}}();g.createTileQuery=function(e,a={}){const b=this._serviceInfo.geometryType,l=this.createQuery(a);l.quantizationParameters=a.quantizationParameters??e.getQuantizationParameters();l.resultType=
"tile";l.geometry=e.extent;if(this._serviceInfo.capabilities.query.supportsQuantization)"esriGeometryPolyline"===b&&(l.maxAllowableOffset=e.resolution*w("feature-polyline-generalization-factor"));else if("esriGeometryPolyline"===b||"esriGeometryPolygon"===b)l.maxAllowableOffset=e.resolution,"esriGeometryPolyline"===b&&(l.maxAllowableOffset*=w("feature-polyline-generalization-factor"));e=this._serviceInfo.capabilities.query;l.defaultSpatialReferenceEnabled=e.supportsDefaultSpatialReference;l.compactGeometryEnabled=
e.supportsCompactGeometry;return l};g._executePatchQuery=function(){var e=t._asyncToGenerator(function*(a,b,l,q){b=b.clone();b.outFields=[this._serviceInfo.objectIdField,...l];b.returnCentroid=!1;b.returnGeometry=!1;l=x.isSome(b.start)?b.start/8E3:0;return this._patchQueue.push({tile:a,query:b,signal:q.signal,depth:l})});return function(a,b,l,q){return e.apply(this,arguments)}}();g._resend=function(){var e=t._asyncToGenerator(function*(a,b){const {query:l,message:q}=a,n=x.isSome(l.outFields)?l.outFields:
[];a=this._queryInfo.outFields;const v=a.filter(B=>!n.includes(B));if(x.isNone(q.addOrUpdate))this._onMessage({...q,type:"append"});else if(v.length)try{const B=this._subscriptions.get(q.id).tile,z=yield this._executePatchQuery(B,l,v,b);m.throwIfAborted(b);l.outFields=a;q.addOrUpdate.joinAttributes(z);this._onMessage({...q,end:q.end,type:"append"})}catch(B){}else this._onMessage({...q,type:"append"})});return function(a,b){return e.apply(this,arguments)}}();g._resendSubscription=function(){var e=
t._asyncToGenerator(function*(a){w("esri-2d-update-debug")&&console.debug(a.tile.id,"Resend Subscription");if(a.empty)return this._onMessage({id:a.tile.id,addOrUpdate:null,end:!1,type:"append"});const b=a.signal;for(const l of a.requests.done)yield this._resend(l,{signal:b});if(x.isSome(a.edits))return this._onMessage(a.edits)});return function(a){return e.apply(this,arguments)}}();g.resend=function(){var e=t._asyncToGenerator(function*(){const a=Array.from(this._subscriptions.values());yield Promise.all(a.map(b=>
this._resendSubscription(b)))});return function(){return e.apply(this,arguments)}}();t._createClass(k,[{key:"updating",get:function(){return!!this._queue.length||Array.from(this._subscriptions.values()).some(e=>!e.done)}},{key:"maxRecordCountFactor",get:function(){const {query:e}=this._serviceInfo.capabilities;return e.supportsMaxRecordCountFactor?4:null}},{key:"maxPageSize",get:function(){var {query:e}=this._serviceInfo.capabilities;e=e.maxRecordCount??8E3;const a=x.unwrapOr(this.maxRecordCountFactor,
1);return e*a}},{key:"pageSize",get:function(){return Math.min(8E3,this.maxPageSize)}}]);return k}(c.DataTileSource);u.BaseFeatureSource=c;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/controllers/support/sourceAdapters":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../../../../../core/maybe ../../../../../../core/workers/Connection ../../../../../../geometry/support/quantizationUtils ../../../../../../layers/graphics/featureConversionUtils ../../../../../../layers/ogc/ogcFeatureUtils ../../../../../../rest/query/operations/query ../../support/FeatureSetReaderJSON ../../support/FeatureSetReaderPBF".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d){function f(q){return k.apply(this,arguments)}function k(){k=t._asyncToGenerator(function*(q){const n=new w;yield n.open(q,{});return n});return k.apply(this,arguments)}let g=function(){function q(n){this.service=n}q.prototype.destroy=function(){};return q}(),e=function(q){function n(B){var z=q.call(this,B)||this;z._portsOpen=f(B.source).then(p=>z.client=p);return z}t._inheritsLoose(n,q);var v=n.prototype;v.destroy=function(){this.client.close();this.client=null};v.executeQuery=
function(){var B=t._asyncToGenerator(function*(z,p){yield this._portsOpen;z=yield this.client.invoke("queryFeatures",z.toJSON(),p);return c.FeatureSetReaderJSON.fromFeatureSet(z,this.service)});return function(z,p){return B.apply(this,arguments)}}();return n}(g),a=function(q){function n(){return q.apply(this,arguments)||this}t._inheritsLoose(n,q);n.prototype.executeQuery=function(){var v=t._asyncToGenerator(function*(B,z){({data:z}=yield h.executeQueryPBFBuffer(this.service.source,B,z));return d.FeatureSetReaderPBF.fromBuffer(z,
this.service,!B.quantizationParameters)});return function(B,z){return v.apply(this,arguments)}}();return n}(g),b=function(q){function n(){return q.apply(this,arguments)||this}t._inheritsLoose(n,q);n.prototype.executeQuery=function(){var v=t._asyncToGenerator(function*(B,z){const {source:p,capabilities:r,spatialReference:D,objectIdField:J,geometryType:K}=this.service;if(C.isSome(B.quantizationParameters)&&!r.query.supportsQuantization){const F=B.clone();B=y.toQuantizationTransform(C.unwrap(F.quantizationParameters));
F.quantizationParameters=null;({data:z}=yield h.executeQuery(p,F,D,z));z=x.convertFromFeatureSet(z,J);x.quantizeOptimizedFeatureSet(B,z);return c.FeatureSetReaderJSON.fromOptimizedFeatureSet(z,this.service)}({data:B}=yield h.executeQuery(p,B,this.service.spatialReference,z));"esriGeometryPoint"===K&&(B.features=B.features?.filter(F=>C.isSome(F.geometry)?(F=F.geometry,Number.isFinite(F.x)&&Number.isFinite(F.y)):!0));return c.FeatureSetReaderJSON.fromFeatureSet(B,this.service)});return function(B,z){return v.apply(this,
arguments)}}();return n}(g),l=function(q){function n(){return q.apply(this,arguments)||this}t._inheritsLoose(n,q);n.prototype.executeQuery=function(){var v=t._asyncToGenerator(function*(B,z){var {capabilities:p}=this.service;if(B.quantizationParameters&&!p.query.supportsQuantization){const r=B.clone();p=y.toQuantizationTransform(C.unwrap(r.quantizationParameters));r.quantizationParameters=null;B=yield m.queryOptimizedFeatureSet(this.service.source,B,z);x.quantizeOptimizedFeatureSet(p,B);return c.FeatureSetReaderJSON.fromOptimizedFeatureSet(B,
this.service)}B=yield m.queryOptimizedFeatureSet(this.service.source,B,z);return c.FeatureSetReaderJSON.fromOptimizedFeatureSet(B,this.service)});return function(B,z){return v.apply(this,arguments)}}();return n}(g);u.SourceAdapter=g;u.createSourceAdapter=function(q){const {capabilities:n}=q;return"ogc-source"===q.source?.type?new l(q):Array.isArray(q.source)?new e(q):n.query.supportsFormatPBF&&H("featurelayer-pbf")?new a(q):new b(q)};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},
"esri/core/workers/Connection":function(){define("../../chunks/_rollupPluginBabelHelpers ../handleUtils ../Logger ../promiseUtils ../Queue ./RemoteClient".split(" "),function(u,t,H,C,w,y){return function(){function x(){this._inUseClients=[];this._clients=[];this._clientPromises=[];this._ongoingJobsQueue=new w}var m=x.prototype;m.destroy=function(){this.close()};m.open=function(h,c){return new Promise((d,f)=>{let k=!0;const g=e=>{C.throwIfAborted(c.signal);k&&(k=!1,e())};this._clients.length=h.length;
this._clientPromises.length=h.length;this._inUseClients.length=h.length;for(let e=0;e<h.length;++e){const a=h[e];C.isPromiseLike(a)?this._clientPromises[e]=a.then(b=>{this._clients[e]=new y(b,c,()=>this._ongoingJobsQueue.pop()??null);g(d);return this._clients[e]},()=>{g(f);return null}):(this._clients[e]=new y(a,c,()=>this._ongoingJobsQueue.pop()??null),this._clientPromises[e]=Promise.resolve(this._clients[e]),g(d))}})};m.broadcast=function(h,c,d){const f=Array(this._clientPromises.length);for(let k=
0;k<this._clientPromises.length;++k)f[k]=this._clientPromises[k].then(g=>g?.invoke(h,c,d));return f};m.close=function(){let h;for(;h=this._ongoingJobsQueue.pop();)h.deferred.reject(C.createAbortError(`Worker closing, aborting job calling '${h.methodName}'`));for(const c of this._clientPromises)c.then(d=>d?.close());this._clients.length=0;this._clientPromises.length=0};m.invoke=function(h,c,d){let f;Array.isArray(d)?(H.getLogger("esri.core.workers.Connection").warn("invoke()","The transferList parameter is deprecated, use the options object instead"),
f={transferList:d}):f=d;d=C.createDeferred();this._ongoingJobsQueue.push({methodName:h,data:c,invokeOptions:f,deferred:d});for(h=0;h<this._clientPromises.length;h++)(c=this._clients[h])?c.jobAdded():this._clientPromises[h].then(k=>k?.jobAdded());return d.promise};m.on=function(h,c){return Promise.all(this._clientPromises).then(()=>t.handlesGroup(this._clients.map(d=>d.on(h,c))))};m.openPorts=function(){return new Promise(h=>{const c=Array(this._clientPromises.length);let d=c.length;for(let f=0;f<
this._clientPromises.length;++f)this._clientPromises[f].then(k=>{k&&(c[f]=k.openPort());0===--d&&h(c)})})};u._createClass(x,[{key:"closed",get:function(){return!this._clients||!this._clients.length}},{key:"test",get:function(){return{numClients:this._clients.length}}}]);return x}()})},"esri/core/Queue":function(){define(["../chunks/_rollupPluginBabelHelpers","./maybe"],function(u,t){return function(){function H(w=y=>y.values().next().value){this._peeker=w;this._items=new Set}var C=H.prototype;C.clear=
function(){this._items.clear()};C.last=function(){if(0!==this._items.size){for(var w of this._items);return w}};C.peek=function(){if(0!==this._items.size)return this._peeker(this._items)};C.push=function(w){this.contains(w)||this._items.add(w)};C.contains=function(w){return this._items.has(w)};C.pop=function(){if(0!==this.length){var w=this.peek();this._items.delete(t.assumeNonNull(w));return w}};C.popLast=function(){if(0!==this.length){var w=this.last();this._items.delete(t.assumeNonNull(w));return w}};
C.remove=function(w){this._items.delete(w)};C.filter=function(w){this._items.forEach(y=>{w(y)||this._items.delete(y)});return this};u._createClass(H,[{key:"length",get:function(){return this._items.size}}]);return H}()})},"esri/layers/ogc/ogcFeatureUtils":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../geometry ../../request ../../core/Error ../../core/Logger ../../core/maybe ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ../graphics/featureConversionUtils ../graphics/OptimizedFeatureSet ../graphics/sources/geojson/geojson ../graphics/sources/support/clientSideDefaults ../support/FieldsIndex ../support/fieldType ../../geometry/SpatialReference".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f,k,g,e,a){function b(){b=t._asyncToGenerator(function*(E,M,T={},Y=5){var {links:fa}=E;fa=I(fa,"items","application/geo+json")||I(fa,"http://www.opengis.net/def/rel/ogc/1.0/items","application/geo+json");if(x.isNone(fa))throw new w("ogc-feature-layer:missing-items-page","Missing items url");({data:T}=yield C(fa.href,{signal:T.signal,query:{limit:Y,...T.customParameters,token:T.apiKey},headers:{accept:"application/geo+json"}}));yield f.validateGeoJSON(T);const ba=f.inferLayerProperties(T,
{geometryType:M.geometryType});T=M.fields||ba.fields||[];Y=null!=M.hasZ?M.hasZ:ba.hasZ;fa=ba.geometryType;const U=M.objectIdField||ba.objectIdFieldName||"OBJECTID";M=M.timeInfo;var P=T.find(({name:Z})=>Z===U);if(P)P.editable=!1,P.nullable=!1;else{if(!ba.objectIdFieldType)throw new w("ogc-feature-layer:missing-feature-id","Collection geojson require a feature id as a unique identifier");T.unshift({name:U,alias:U,type:"number"===ba.objectIdFieldType?"esriFieldTypeOID":"esriFieldTypeString",editable:!1,
nullable:!1})}U!==ba.objectIdFieldName&&(P=T.find(({name:Z})=>Z===ba.objectIdFieldName))&&(P.type="esriFieldTypeInteger");T===ba.fields&&0<ba.unknownFields.length&&G.warn({name:"ogc-feature-layer:unknown-field-types",message:"Some fields types couldn't be inferred from the features and were dropped",details:{unknownFields:ba.unknownFields}});for(var Q of T){null==Q.name&&(Q.name=Q.alias);null==Q.alias&&(Q.alias=Q.name);"esriFieldTypeOID"!==Q.type&&"esriFieldTypeGlobalID"!==Q.type&&(Q.editable=null==
Q.editable?!0:!!Q.editable,Q.nullable=null==Q.nullable?!0:!!Q.nullable);if(!Q.name)throw new w("ogc-feature-layer:invalid-field-name","field name is missing",{field:Q});if(!e.kebabDict.jsonValues.includes(Q.type))throw new w("ogc-feature-layer:invalid-field-type",`invalid type for field "${Q.name}"`,{field:Q});}M&&(Q=new g(T),M.startTimeField&&((P=Q.get(M.startTimeField))?(M.startTimeField=P.name,P.type="esriFieldTypeDate"):M.startTimeField=null),M.endTimeField&&((P=Q.get(M.endTimeField))?(M.endTimeField=
P.name,P.type="esriFieldTypeDate"):M.endTimeField=null),M.trackIdField&&((Q=Q.get(M.trackIdField))?M.trackIdField=Q.name:(M.trackIdField=null,G.warn({name:"ogc-feature-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:M}}))),M.startTimeField||M.endTimeField||(G.warn({name:"ogc-feature-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing",details:{timeInfo:M}}),M=null));Q=fa?k.createDrawingInfo(fa):null;E=A(E);return{drawingInfo:Q,extent:E,
geometryType:fa,fields:T,hasZ:!!Y,objectIdField:U,timeInfo:M}});return b.apply(this,arguments)}function l(){l=t._asyncToGenerator(function*(E,M={}){({links:E}=E);E=I(E,"data","application/json")||I(E,"http://www.opengis.net/def/rel/ogc/1.0/data","application/json");if(x.isNone(E))throw new w("ogc-feature-layer:missing-collections-page","Missing collections url");const {apiKey:T,customParameters:Y,signal:fa}=M;({data:M}=yield C(E.href,{signal:fa,headers:{accept:"application/json"},query:{...Y,token:T}}));
return M});return l.apply(this,arguments)}function q(){q=t._asyncToGenerator(function*(E,M={}){({links:E}=E);E=I(E,"conformance","application/json")||I(E,"http://www.opengis.net/def/rel/ogc/1.0/conformance","application/json");if(x.isNone(E))throw new w("ogc-feature-layer:missing-conformance-page","Missing conformance url");const {apiKey:T,customParameters:Y,signal:fa}=M;({data:M}=yield C(E.href,{signal:fa,headers:{accept:"application/json"},query:{...Y,token:T}}));return M});return q.apply(this,
arguments)}function n(){n=t._asyncToGenerator(function*(E,M={}){const {apiKey:T,customParameters:Y,signal:fa}=M;({data:E}=yield C(E,{signal:fa,headers:{accept:"application/json"},query:{...Y,token:T}}));return E});return n.apply(this,arguments)}function v(){v=t._asyncToGenerator(function*(E,M={}){E=I(E.links,"service-desc","application/vnd.oai.openapi+json;version\x3d3.0");if(x.isNone(E))return G.warn("ogc-feature-layer:missing-openapi-page","The OGC API-Features server does not have an OpenAPI page."),
null;const {apiKey:T,customParameters:Y,signal:fa}=M;({data:M}=yield C(E.href,{signal:fa,headers:{accept:"application/vnd.oai.openapi+json;version\x3d3.0"},query:{...Y,token:T}}));return M});return v.apply(this,arguments)}function B(){B=t._asyncToGenerator(function*(E,M,T){E=yield z(E,M,T);return c.convertToFeatureSet(E)});return B.apply(this,arguments)}function z(E,M,T){return p.apply(this,arguments)}function p(){p=t._asyncToGenerator(function*(E,M,T){const {collection:Y,layerDefinition:fa,maxRecordCount:ba,
queryParameters:{apiKey:U,customParameters:P},spatialReference:Q,supportedCrs:Z}=E;({links:E}=Y);var X=I(E,"items","application/geo+json")||I(E,"http://www.opengis.net/def/rel/ogc/1.0/items","application/geo+json");if(x.isNone(X))throw new w("ogc-feature-layer:missing-items-page","Missing items url");const {geometry:sa,num:Aa,start:Da,timeExtent:ha,where:Ea}=M;if(M.objectIds)throw new w("ogc-feature-layer:query-by-objectids-not-supported","Queries with objectids are not supported");E=a.fromJSON(Q);
M=x.unwrapOr(M.outSpatialReference,E);E=M.isWGS84?null:r(M,Z);var za=F(sa,Z);const N=J(ha),S=K(Ea);({data:X}=yield C(X.href,{...T,query:{...P,...za,crs:E,datetime:N,query:S,limit:Aa??(null!=Da&&void 0!==Da?10:ba),startindex:Da,token:U},headers:{accept:"application/geo+json"}}));T=!1;X.links&&(T=!!X.links.find(la=>"next"===la.rel));!T&&Number.isInteger(X.numberMatched)&&Number.isInteger(X.numberReturned)&&(T=X.numberReturned<X.numberMatched);const {fields:ea,geometryType:oa,hasZ:va,objectIdField:W}=
fa;X=f.createOptimizedFeatures(X,{geometryType:oa,hasZ:va,objectIdField:W});if(!E&&M.isWebMercator)for(var ca of X)x.isSome(ca.geometry)&&null!=oa&&(za=c.convertToGeometry(ca.geometry,oa,va,!1),za.spatialReference=a.WGS84,ca.geometry=c.convertFromGeometry(h.project(za,M)));for(var ka of X)ka.objectId=ka.attributes[W];ca=E||!E&&M.isWebMercator?M.toJSON():m.WGS84;ka=new d;ka.exceededTransferLimit=T;ka.features=X;ka.fields=ea;ka.geometryType=oa;ka.hasZ=va;ka.objectIdFieldName=W;ka.spatialReference=ca;
return ka});return p.apply(this,arguments)}function r(E,M){const {isWebMercator:T,wkid:Y}=E;return Y?(E=T?M[3857]??M[102100]??M[102113]??M[900913]:M[E.wkid])?`${"http://www.opengis.net/def/crs/"}${E}`:null:null}function D(E){if(x.isNone(E))return"";const {xmin:M,ymin:T,xmax:Y,ymax:fa}=E;return`${M},${T},${Y},${fa}`}function J(E){if(x.isNone(E))return null;const {start:M,end:T}=E;return`${x.isSome(M)?M.toISOString():".."}/${x.isSome(T)?T.toISOString():".."}`}function K(E){return x.isNone(E)||!E||"1\x3d1"===
E?null:E}function F(E,M){if(!x.isSome(E)||"extent"!==E.type)return null;const {spatialReference:T}=E;if(!T||T.isWGS84)return{bbox:D(E)};M=r(T,M);return x.isSome(M)?{bbox:D(E),"bbox-crs":M}:T.isWebMercator?{bbox:D(h.project(E,a.WGS84))}:null}function A(E){E=E.extent?.spatial;if(!E)return null;var M=E.bbox[0],T=4===M.length;E=M[0];const Y=M[1],fa=T?void 0:M[2],ba=T?M[2]:M[3],U=T?M[3]:M[4];M=T?void 0:M[5];T=a.WGS84.toJSON();return{xmin:E,ymin:Y,xmax:ba,ymax:U,zmin:fa,zmax:M,spatialReference:T}}function I(E,
M,T){return E.find(Y=>Y.rel===M&&Y.type===T)||E.find(Y=>Y.rel===M&&!Y.type)}const G=y.getLogger("esri.layers.graphics.sources.ogcfeature");u.crsDefault="http://www.opengis.net/def/crs/OGC/1.3/CRS84";u.crsPrefix="http://www.opengis.net/def/crs/";u.getCollectionDefinition=function(E,M){return b.apply(this,arguments)};u.getServerCollections=function(E){return l.apply(this,arguments)};u.getServerConformance=function(E){return q.apply(this,arguments)};u.getServerLandingPage=function(E){return n.apply(this,
arguments)};u.getServerOpenApi=function(E){return v.apply(this,arguments)};u.getSpatialReferenceWkid=function(E){E=/^http:\/\/www\.opengis.net\/def\/crs\/(?<authority>.*)\/(?<version>.*)\/(?<code>.*)$/i.exec(E)?.groups;if(!E)return null;const {authority:M,code:T}=E;switch(M.toLowerCase()){case "ogc":switch(T.toLowerCase()){case "crs27":return a.GCS_NAD_1927.wkid;case "crs83":return 4269;case "crs84":case "crs84h":return a.WGS84.wkid;default:return null}case "esri":case "epsg":return E=Number.parseInt(T,
10),Number.isNaN(E)?null:E;default:return null}};u.queryFeatureSetJSON=function(E,M,T){return B.apply(this,arguments)};u.queryOptimizedFeatureSet=z;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/sources/geojson/geojson":function(){define(["exports","../../../../core/Error","../../OptimizedFeature","../../OptimizedGeometry","../../../support/fieldUtils"],function(u,t,H,C,w){function*y(q){switch(q.type){case "Feature":yield q;break;case "FeatureCollection":for(const n of q.features)n&&
(yield n)}}function*x(q){if(q)switch(q.type){case "Point":yield q.coordinates;break;case "LineString":case "MultiPoint":yield*q.coordinates;break;case "MultiLineString":case "Polygon":for(const n of q.coordinates)yield*n;break;case "MultiPolygon":for(const n of q.coordinates)for(const v of n)yield*v}}function*m(q,n={}){const {geometryType:v,objectIdField:B}=n;for(const z of q){const {geometry:p,properties:r,id:D}=z;if(p&&l[p.type]!==v)continue;q=r||{};let J=void 0;B&&(J=q[B],null==D||J||(q[B]=J=D));
yield new H.OptimizedFeature(p?f(new C,p,n):null,q,null,J??void 0)}}function h(q){for(const n of q)if(2<n.length)return!0;return!1}function c(q){let n=0;for(let v=0;v<q.length;v++){const B=q[v],z=q[(v+1)%q.length];n+=B[0]*z[1]-z[0]*B[1]}return 0>=n}function d(q){const n=q[0],v=q[q.length-1];n[0]===v[0]&&n[1]===v[1]&&n[2]===v[2]||q.push(n);return q}function f(q,n,v){switch(n.type){case "LineString":return e(q,n.coordinates,v),q;case "MultiLineString":for(const z of n.coordinates)e(q,z,v);return q;
case "MultiPoint":return e(q,n.coordinates,v),q;case "MultiPolygon":for(var B of n.coordinates)for(k(q,B[0],v),n=1;n<B.length;n++)g(q,B[n],v);return q;case "Point":return b(q,n.coordinates,v),q;case "Polygon":B=n.coordinates;k(q,B[0],v);for(n=1;n<B.length;n++)g(q,B[n],v);return q}}function k(q,n,v){n=d(n);c(n)?e(q,n,v):a(q,n,v)}function g(q,n,v){n=d(n);c(n)?a(q,n,v):e(q,n,v)}function e(q,n,v){for(const B of n)b(q,B,v);q.lengths.push(n.length)}function a(q,n,v){for(let B=n.length-1;0<=B;B--)b(q,n[B],
v);q.lengths.push(n.length)}function b(q,n,v){const [B,z,p]=n;q.coords.push(B,z);v.hasZ&&q.coords.push(p||0)}const l={LineString:"esriGeometryPolyline",MultiLineString:"esriGeometryPolyline",MultiPoint:"esriGeometryMultipoint",Point:"esriGeometryPoint",Polygon:"esriGeometryPolygon",MultiPolygon:"esriGeometryPolygon"};u.createOptimizedFeatures=function(q,n){return Array.from(m(y(q),n))};u.getGeometryType=function(q){return l[q]};u.inferLayerProperties=function(q,n={}){const v=[];var B=new Set;const z=
new Set;var p=!1;let r=null,D=!1,J=void 0;({geometryType:n=null}=n);var K=!1;for(const F of y(q)){const {geometry:A,properties:I,id:G}=F;if(A&&(n||(n=l[A.type]),l[A.type]!==n))continue;p||(p=x(A),p=h(p));!D&&(D=null!=G)&&(J=typeof G,I&&(r=Object.keys(I).filter(E=>I[E]===G)));I&&r&&D&&null!=G&&(1<r.length?r=r.filter(E=>I[E]===G):1===r.length&&(r=I[r[0]]===G?r:[]));if(!K&&I){q=!0;for(const E in I){if(B.has(E))continue;K=I[E];if(null==K){q=!1;z.add(E);continue}a:switch(typeof K){case "string":K="esriFieldTypeString";
break a;case "number":K="esriFieldTypeDouble";break a;default:K="unknown"}if("unknown"===K){z.add(E);continue}z.delete(E);B.add(E);const M=w.normalizeFieldName(E);M&&v.push({name:M,alias:E,type:K})}K=q}}if(B=w.normalizeFieldName(1===r?.length&&r[0]||null)??void 0)for(const F of v)if(F.name===B&&w.isNumericField(F)){F.type="esriFieldTypeOID";break}return{fields:v,geometryType:n,hasZ:p,objectIdFieldName:B,objectIdFieldType:J,unknownFields:Array.from(z)}};u.validateGeoJSON=function(q){if(!q)throw new t("geojson-layer:empty",
"GeoJSON data is empty");if("Feature"!==q.type&&"FeatureCollection"!==q.type)throw new t("geojson-layer:unsupported-geojson-object","missing or not supported GeoJSON object type",{data:q});({crs:q}=q);if(q){var n="string"===typeof q?q:"name"===q.type?q.properties.name:"EPSG"===q.type?q.properties.code:null,v=RegExp(".*(CRS84H?|4326)$","i");if(!n||!v.test(n))throw new t("geojson-layer:unsupported-crs","unsupported GeoJSON 'crs' member",{crs:q});}};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/graphics/sources/support/clientSideDefaults":function(){define(["exports","../../../../core/has","../../../../core/lang","../../data/QueryEngineCapabilities","../../../../symbols/support/defaultsJSON"],function(u,t,H,C,w){const y=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let x=1;u.createCapabilities=function(m,h){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:m},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,
supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:h,supportsDelete:h,supportsEditing:h,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:h,supportsExceedsLimitStatistics:!0},query:C.queryCapabilities,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:h,
supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1}}};u.createDefaultAttributesFunction=function(m,h){if(t("esri-csp-restrictions"))return()=>({[h]:null,...m});try{let c=`this.${h} = null;`;for(const f in m){const k=y.test(f)?`.${f}`:`["${f}"]`;c+=`this${k} = ${JSON.stringify(m[f])};`}const d=
(new Function(`\n      return class AttributesClass$${x++} {\n        constructor() {\n          ${c};\n        }\n      }\n    `))();return()=>new d}catch(c){return()=>({[h]:null,...m})}};u.createDefaultTemplate=function(m={}){return[{name:"New Feature",description:"",prototype:{attributes:H.clone(m)}}]};u.createDrawingInfo=function(m){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===m||"esriGeometryMultipoint"===m?w.defaultPointSymbolJSON:"esriGeometryPolyline"===m?w.defaultPolylineSymbolJSON:
w.defaultPolygonSymbolJSON}}};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/defaultsJSON":function(){define(["exports"],function(u){const t=[252,146,31,255],H={type:"esriSMS",style:"esriSMSCircle",size:6,color:t,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},C={type:"esriSLS",style:"esriSLSSolid",width:.75,color:t};u.defaultColor=t;u.defaultOutlineColor=[153,153,153,255];u.defaultPointSymbolJSON=H;u.defaultPolygonSymbolJSON=
{type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}};u.defaultPolylineSymbolJSON=C;u.defaultTextSymbolJSON={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0};u.errorPointSymbolJSON={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,
size:10.5};u.errorPolygonSymbolJSON={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null};u.errorPolylineSymbolJSON={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/fieldType":function(){define(["exports","../../core/jsonMap"],function(u,t){t=new t.JSONMap({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",
esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml"});u.kebabDict=t;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/rest/query/operations/query":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../request ../../../core/maybe ../../../core/urlUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../operations/urlUtils ./pbfQueryUtils ./queryZScale".split(" "),
function(u,t,H,C,w,y,x,m,h,c){function d(b,l){if(l&&"extent"===b.type)return`${b.xmin},${b.ymin},${b.xmax},${b.ymax}`;if(l&&"point"===b.type)return`${b.x},${b.y}`;b=b.toJSON();delete b.spatialReference;return JSON.stringify(b)}function f(b,l){const q=b.geometry,n=b.toJSON();delete n.compactGeometryEnabled;delete n.defaultSpatialReferenceEnabled;let v,B,z;C.isSome(q)&&(B=q.spatialReference,z=q.spatialReference.wkid||JSON.stringify(q.spatialReference),n.geometryType=y.getJsonType(q),n.geometry=d(q,
b.compactGeometryEnabled),n.inSR=z);n.groupByFieldsForStatistics&&(n.groupByFieldsForStatistics=n.groupByFieldsForStatistics.join(","));n.objectIds&&(n.objectIds=n.objectIds.join(","));n.orderByFields&&(n.orderByFields=n.orderByFields.join(","));!n.outFields||!n.returnDistinctValues&&(l?.returnCountOnly||l?.returnExtentOnly||l?.returnIdsOnly)?delete n.outFields:n.outFields.includes("*")?n.outFields="*":n.outFields=n.outFields.join(",");n.outSR?(n.outSR=n.outSR.wkid||JSON.stringify(n.outSR),v=b.outSpatialReference):
q&&(n.returnGeometry||n.returnCentroid)&&(n.outSR=n.inSR,v=B);n.returnGeometry&&delete n.returnGeometry;n.outStatistics&&(n.outStatistics=JSON.stringify(n.outStatistics));n.fullText&&(n.fullText=JSON.stringify(n.fullText));n.pixelSize&&(n.pixelSize=JSON.stringify(n.pixelSize));n.quantizationParameters&&(b.defaultSpatialReferenceEnabled&&C.isSome(B)&&C.isSome(b.quantizationParameters)&&C.isSome(b.quantizationParameters.extent)&&B.equals(b.quantizationParameters.extent.spatialReference)&&delete n.quantizationParameters.extent.spatialReference,
n.quantizationParameters=JSON.stringify(n.quantizationParameters));n.parameterValues&&(n.parameterValues=JSON.stringify(n.parameterValues));n.rangeValues&&(n.rangeValues=JSON.stringify(n.rangeValues));n.dynamicDataSource&&(n.layer=JSON.stringify({source:n.dynamicDataSource}),delete n.dynamicDataSource);if(n.timeExtent){const {start:p,end:r}=n.timeExtent;if(null!=p||null!=r)n.time=p===r?p:`${null==p?"null":p},${null==r?"null":r}`;delete n.timeExtent}b.defaultSpatialReferenceEnabled&&C.isSome(B)&&C.isSome(v)&&
B.equals(v)&&(n.defaultSR=n.inSR,delete n.inSR,delete n.outSR);return n}function k(){k=t._asyncToGenerator(function*(b,l,q,n){b=C.isSome(l.timeExtent)&&l.timeExtent.isEmpty?{data:{features:[]}}:yield a(b,l,"json",n);c.applyFeatureSetZUnitScaling(l,q,b.data);return b});return k.apply(this,arguments)}function g(){g=t._asyncToGenerator(function*(b,l,q,n){if(C.isSome(l.timeExtent)&&l.timeExtent.isEmpty)return{data:q.createFeatureResult()};b=yield e(b,l,n);b.data=h.parsePBFFeatureQuery(b.data,q);return b});
return g.apply(this,arguments)}function e(b,l,q){return a(b,l,"pbf",q)}function a(b,l,q,n={},v={}){const B="string"===typeof b?w.urlToObject(b):b;b=l.geometry?[l.geometry]:[];n.responseType="pbf"===q?"array-buffer":"json";return x.normalizeCentralMeridian(b,null,n).then(z=>{z=z&&z[0];C.isSome(z)&&(l=l.clone(),l.geometry=z);z=m.mapParameters({...B.query,f:q,...v,...f(l,v)});return H(w.join(B.path,"query"),{...n,query:{...z,...n.query}})})}u.encodeGeometry=d;u.executeQuery=function(b,l,q,n){return k.apply(this,
arguments)};u.executeQueryForCount=function(b,l,q){return C.isSome(l.timeExtent)&&l.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):a(b,l,"json",q,{returnIdsOnly:!0,returnCountOnly:!0})};u.executeQueryForExtent=function(b,l,q){return C.isSome(l.timeExtent)&&l.timeExtent.isEmpty?Promise.resolve({data:{count:0,extent:null}}):a(b,l,"json",q,{returnExtentOnly:!0,returnCountOnly:!0}).then(n=>{const v=n.data;if(v.hasOwnProperty("extent"))return n;if(v.features)throw Error("Layer does not support extent calculation.");
if(v.hasOwnProperty("count"))throw Error("Layer does not support extent calculation.");return n})};u.executeQueryForIds=function(b,l,q){return C.isSome(l.timeExtent)&&l.timeExtent.isEmpty?Promise.resolve({data:{objectIds:[]}}):a(b,l,"json",q,{returnIdsOnly:!0})};u.executeQueryPBF=function(b,l,q,n){return g.apply(this,arguments)};u.executeQueryPBFBuffer=e;u.queryToQueryStringParameters=f;u.runQuery=a;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/rest/operations/urlUtils":function(){define(["exports"],
function(u){function t(H){const C={};for(const w in H){if("declaredClass"===w)continue;const y=H[w];if(null!=y&&"function"!==typeof y)if(Array.isArray(y)){C[w]=[];for(let x=0;x<y.length;x++)C[w][x]=t(y[x])}else"object"===typeof y?y.toJSON&&(C[w]=JSON.stringify(y)):C[w]=y}return C}u.mapParameters=t;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/rest/query/operations/pbfQueryUtils":function(){define(["exports","./pbfFeatureServiceParser"],function(u,t){u.parsePBFFeatureQuery=
function(H,C){var w=t.parseFeatureQuery(H,C);H=w.queryResult.featureResult;C=w.queryResult.queryGeometry;w=w.queryResult.queryGeometryType;if(H&&H.features&&H.features.length&&H.objectIdFieldName){const y=H.objectIdFieldName;for(const x of H.features)x.attributes&&(x.objectId=x.attributes[y])}H&&(H.queryGeometry=C,H.queryGeometryType=w);return H};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/rest/query/operations/pbfFeatureServiceParser":function(){define("exports ../../../core/Error ../../../core/maybe ../../../core/pbf ../../../layers/graphics/OptimizedGeometry ./pbfOptimizedFeatureSet".split(" "),
function(u,t,H,C,w,y){function x(r){return r>=B.length?null:B[r]}function m(r,D,J){r=r.asUnsafe();for(J=D.createPointGeometry(J);r.next();)switch(r.tag()){case 3:var K=r.getUInt32();K=r.pos()+K;let F=0;for(;r.pos()<K;)D.addCoordinatePoint(J,r.getSInt64(),F++);break;default:r.skip()}return J}function h(r,D,J){r=r.asUnsafe();const K=D.createGeometry(J);for(J=2+(J.hasZ?1:0)+(J.hasM?1:0);r.next();)switch(r.tag()){case 2:var F=r.getUInt32();F=r.pos()+F;for(var A=0;r.pos()<F;)D.addLength(K,r.getUInt32(),
A++);break;case 3:F=r.getUInt32();F=r.pos()+F;A=0;for(D.allocateCoordinates(K);r.pos()<F;)D.addCoordinate(K,r.getSInt64(),A),A++,A===J&&(A=0);break;default:r.skip()}return K}function c(r){r=r.asUnsafe();const D=new w;let J="esriGeometryPoint";for(;r.next();)switch(r.tag()){case 2:var K=r.getUInt32();for(K=r.pos()+K;r.pos()<K;)D.lengths.push(r.getUInt32());break;case 3:K=r.getUInt32();for(K=r.pos()+K;r.pos()<K;)D.coords.push(r.getSInt64());break;case 1:J=y.OPTIMIZED_GEOMETRY_TYPES[r.getEnum()];break;
default:r.skip()}return{queryGeometry:D,queryGeometryType:J}}function d(r){for(r=r.asUnsafe();r.next();)switch(r.tag()){case 1:return r.getString();case 2:return r.getFloat();case 3:return r.getDouble();case 4:return r.getSInt32();case 5:return r.getUInt32();case 6:return r.getInt64();case 7:return r.getUInt64();case 8:return r.getSInt64();case 9:return r.getBool();default:return r.skip(),null}return null}function f(r){r=r.asUnsafe();const D={type:x(0)};for(;r.next();)switch(r.tag()){case 1:D.name=
r.getString();break;case 2:D.type=x(r.getEnum());break;case 3:D.alias=r.getString();break;case 4:var J=r.getEnum();J=J>=z.length?null:z[J];D.sqlType=J;break;case 5:r.skip();break;case 6:D.defaultValue=r.getString();break;default:r.skip()}return D}function k(r){const D={};for(r=r.asUnsafe();r.next();)switch(r.tag()){case 1:D.name=r.getString();break;case 2:D.isSystemMaintained=r.getBool();break;default:r.skip()}return D}function g(r,D,J,K){const F=D.createFeature(J);let A=0;for(;r.next();)switch(r.tag()){case 1:const I=
K[A++].name;F.attributes[I]=r.processMessage(d);break;case 2:F.geometry=r.processMessageWithArgs(h,D,J);break;case 4:F.centroid=r.processMessageWithArgs(m,D,J);break;default:r.skip()}return F}function e(r){const D=[1,1,1,1];for(r=r.asUnsafe();r.next();)switch(r.tag()){case 1:D[0]=r.getDouble();break;case 2:D[1]=r.getDouble();break;case 4:D[2]=r.getDouble();break;case 3:D[3]=r.getDouble();break;default:r.skip()}return D}function a(r){const D=[0,0,0,0];for(r=r.asUnsafe();r.next();)switch(r.tag()){case 1:D[0]=
r.getDouble();break;case 2:D[1]=r.getDouble();break;case 4:D[2]=r.getDouble();break;case 3:D[3]=r.getDouble();break;default:r.skip()}return D}function b(r){const D={originPosition:0>=p.length?null:p[0]};for(r=r.asUnsafe();r.next();)switch(r.tag()){case 1:var J=r.getEnum();D.originPosition=J>=p.length?null:p[J];break;case 2:D.scale=r.processMessage(e);break;case 3:D.translate=r.processMessage(a);break;default:r.skip()}return D}function l(r){const D={};for(r=r.asUnsafe();r.next();)switch(r.tag()){case 1:D.shapeAreaFieldName=
r.getString();break;case 2:D.shapeLengthFieldName=r.getString();break;case 3:D.units=r.getString();break;default:r.skip()}return D}function q(r,D){for(D=D.createSpatialReference();r.next();)switch(r.tag()){case 1:D.wkid=r.getUInt32();break;case 5:D.wkt=r.getString();break;case 2:D.latestWkid=r.getUInt32();break;case 3:D.vcsWkid=r.getUInt32();break;case 4:D.latestVcsWkid=r.getUInt32();break;default:r.skip()}return D}function n(r,D){const J=D.createFeatureResult();r=r.asUnsafe();J.geometryType=0>=D.geometryTypes.length?
null:D.geometryTypes[0];let K=!1;for(;r.next();)switch(r.tag()){case 1:J.objectIdFieldName=r.getString();break;case 3:J.globalIdFieldName=r.getString();break;case 4:J.geohashFieldName=r.getString();break;case 5:J.geometryProperties=r.processMessage(l);break;case 7:var F=r.getEnum();J.geometryType=F>=D.geometryTypes.length?null:D.geometryTypes[F];break;case 8:J.spatialReference=r.processMessageWithArgs(q,D);break;case 10:J.hasZ=r.getBool();break;case 11:J.hasM=r.getBool();break;case 12:J.transform=
r.processMessage(b);break;case 9:F=r.getBool();J.exceededTransferLimit=F;break;case 13:D.addField(J,r.processMessage(f));break;case 15:K||(D.prepareFeatures(J),K=!0);D.addFeature(J,r.processMessageWithArgs(g,D,J,J.fields));break;case 2:J.uniqueIdField=r.processMessage(k);break;default:r.skip()}D.finishFeatureResult(J);return J}function v(r,D){const J={};let K=null;for(;r.next();)switch(r.tag()){case 4:K=r.processMessageWithArgs(c);break;case 1:J.featureResult=r.processMessageWithArgs(n,D);break;default:r.skip()}H.isSome(K)&&
J.featureResult&&D.addQueryGeometry(J,K);return J}const B="esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeString esriFieldTypeDate esriFieldTypeOID esriFieldTypeGeometry esriFieldTypeBlob esriFieldTypeRaster esriFieldTypeGUID esriFieldTypeGlobalID esriFieldTypeXML".split(" "),z="sqlTypeBigInt sqlTypeBinary sqlTypeBit sqlTypeChar sqlTypeDate sqlTypeDecimal sqlTypeDouble sqlTypeFloat sqlTypeGeometry sqlTypeGUID sqlTypeInteger sqlTypeLongNVarchar sqlTypeLongVarbinary sqlTypeLongVarchar sqlTypeNChar sqlTypeNVarchar sqlTypeOther sqlTypeReal sqlTypeSmallInt sqlTypeSqlXml sqlTypeTime sqlTypeTimestamp sqlTypeTimestamp2 sqlTypeTinyInt sqlTypeVarbinary sqlTypeVarchar".split(" "),
p=["upperLeft","lowerLeft"];u.parseFeatureQuery=function(r,D){try{const J=new C(new Uint8Array(r),new DataView(r));for(r={};J.next();)switch(J.tag()){case 2:r.queryResult=J.processMessageWithArgs(v,D);break;default:J.skip()}return r}catch(J){throw new t("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:J});}};u.parseFieldType=x;u.parseTransform=b;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/rest/query/operations/pbfOptimizedFeatureSet":function(){define("exports ../../../core/unitUtils ../../../geometry/support/spatialReferenceUtils ../../../layers/graphics/OptimizedFeature ../../../layers/graphics/OptimizedFeatureSet ../../../layers/graphics/OptimizedGeometry".split(" "),
function(u,t,H,C,w,y){const x=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"];let m=function(){function h(d){this._options=d;this.geometryTypes=x;this._vertexDimension=this._coordinatePtr=0}var c=h.prototype;c.createFeatureResult=function(){return new w};c.prepareFeatures=function(d){this._vertexDimension=2;d.hasZ&&this._vertexDimension++;d.hasM&&this._vertexDimension++};c.finishFeatureResult=function(d){if(d&&d.features&&d.hasZ&&this._options.sourceSpatialReference&&
d.spatialReference&&!H.equals(d.spatialReference,this._options.sourceSpatialReference)&&!d.spatialReference.vcsWkid){var f=t.getMetersPerVerticalUnitForSR(this._options.sourceSpatialReference),k=t.getMetersPerVerticalUnitForSR(d.spatialReference);f/=k;if(1!==f)for(const g of d.features)if(C.hasGeometry(g))for(d=g.geometry.coords,k=2;k<d.length;k+=3)d[k]*=f}};c.addFeature=function(d,f){d.features.push(f)};c.createFeature=function(){return new C.OptimizedFeature};c.createSpatialReference=function(){return{wkid:0}};
c.createGeometry=function(){return new y};c.addField=function(d,f){d.fields.push(f)};c.allocateCoordinates=function(d){d.coords.length=d.lengths.reduce((f,k)=>f+k,0)*this._vertexDimension;this._coordinatePtr=0};c.addCoordinate=function(d,f){d.coords[this._coordinatePtr++]=f};c.addCoordinatePoint=function(d,f){d.coords.push(f)};c.addLength=function(d,f){d.lengths.push(f)};c.addQueryGeometry=function(d,f){d.queryGeometry=f.queryGeometry;d.queryGeometryType=f.queryGeometryType};c.createPointGeometry=
function(){return new y};return h}();u.OPTIMIZED_GEOMETRY_TYPES=x;u.OptimizedFeatureSetParserContext=m;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/rest/query/operations/queryZScale":function(){define(["exports","../../../core/maybe","../../../geometry/support/zscale"],function(u,t,H){u.applyFeatureSetZUnitScaling=function(C,w,y){if(y&&y.features&&y.hasZ&&(C=H.getGeometryZScaler(y.geometryType,w,C.outSpatialReference),!t.isNone(C)))for(const x of y.features)C(x.geometry)};
Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/FeatureSetReaderJSON":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedFeature ./FeatureSetReader".split(" "),function(u,t,H,C,w,y){function x({coords:h,lengths:c}){let d=0;for(const f of c){for(c=1;c<f;c++)h[2*(d+c)]+=h[2*(d+c)-2],h[2*(d+c)+1]+=h[2*(d+
c)-1];d+=f}}let m=function(h){function c(f,k,g){f=h.call(this,f,g)||this;f._exceededTransferLimit=!1;f._featureIndex=-1;f._dateFields=new Set;f._geometryType=g?.geometryType;f._features=k;return f}t._inheritsLoose(c,h);c.fromFeatures=function(f,k){const {objectIdField:g,geometryType:e}=k,a=C.convertFromFeatures([],f,e,!1,!1,g);for(let b=0;b<a.length;b++)a[b].displayId=f[b].displayId;return c.fromOptimizedFeatures(a,k)};c.fromFeatureSet=function(f,k){f=C.convertFromFeatureSet(f,k.objectIdField);return c.fromOptimizedFeatureSet(f,
k)};c.fromOptimizedFeatureSet=function(f,k){const {features:g}=f;k=c.fromOptimizedFeatures(g,k);k._exceededTransferLimit=f.exceededTransferLimit;k._transform=f.transform;for(const e of f.fields)"esriFieldTypeDate"===e.type&&k._dateFields.add(e.name);return k};c.fromOptimizedFeatures=function(f,k,g){const e=y.FeatureSetReader.createInstance();f=new c(e,f,k);f._transform=g;return f};var d=c.prototype;d.removeIds=function(f){const k=new Set(f);this._features=this._features.filter(g=>!(g.objectId&&k.has(g.objectId)))};
d.append=function(f){for(const k of f)this._features.push(k)};d.getSize=function(){return this._features.length};d.getCursor=function(){return this.copy()};d.getQuantizationTransform=function(){return this._transform};d.getAttributeHash=function(){let f="";for(const k in this._current.attributes)f+=this._current.attributes[k];return f};d.getIndex=function(){return this._featureIndex};d.setIndex=function(f){this._featureIndex=f};d.getObjectId=function(){return this._current?.objectId};d.getDisplayId=
function(){return this._current.displayId};d.setDisplayId=function(f){this._current.displayId=f};d.getGroupId=function(){return this._current.groupId};d.setGroupId=function(f){this._current.groupId=f};d.copy=function(){const f=new c(this.instance,this._features,this.fullSchema());this.copyInto(f);return f};d.next=function(){for(;++this._featureIndex<this._features.length&&!this._getExists(););return this._featureIndex<this._features.length};d.readLegacyFeature=function(){return C.convertToFeature(this._current,
this.geometryType,this.hasZ,this.hasM)};d.readOptimizedFeature=function(){return this._current};d.readLegacyPointGeometry=function(){return this.readGeometry()?{x:this.getX(),y:this.getY()}:null};d.readLegacyGeometry=function(){const f=this.readGeometry();return C.convertToGeometry(f,this.geometryType,this.hasZ,this.hasM)};d.readLegacyCentroid=function(){const f=this.readCentroid();return H.isNone(f)?null:{x:f.coords[0]*this._sx+this._tx,y:f.coords[1]*this._sy+this._ty}};d.readGeometryArea=function(){return w.hasGeometry(this._current)?
C.getQuantizedArea(this._current.geometry,2):0};d.readUnquantizedGeometry=function(){var f=this.readGeometry();if("esriGeometryPoint"===this.geometryType||!f)return f;f=f.clone();x(f);return f};d.readHydratedGeometry=function(){var f=this._current.geometry;if(H.isNone(f))return null;f=f.clone();H.isSome(this._transform)&&C.unquantizeOptimizedGeometry(f,f,this.hasZ,this.hasM,this._transform);return f};d.getXHydrated=function(){if(!w.hasGeometry(this._current))return 0;const f=this._current.geometry.coords[0],
k=this.getQuantizationTransform();return H.isNone(k)?f:f*k.scale[0]+k.translate[0]};d.getYHydrated=function(){if(!w.hasGeometry(this._current))return 0;const f=this._current.geometry.coords[1],k=this.getQuantizationTransform();return H.isNone(k)?f:k.translate[1]-f*k.scale[1]};d.getX=function(){return w.hasGeometry(this._current)?this._current.geometry.coords[0]*this._sx+this._tx:0};d.getY=function(){return w.hasGeometry(this._current)?this._current.geometry.coords[1]*this._sy+this._ty:0};d.readGeometry=
function(){if(!w.hasGeometry(this._current)){if(H.isSome(this._current.centroid)){const [g,e]=this._current.centroid.coords;return this.createQuantizedExtrudedQuad(g,e)}return null}const f=this._current.geometry.clone();if(f.isPoint)return f.coords[0]=f.coords[0]*this._sx+this._tx,f.coords[1]=f.coords[1]*this._sy+this._ty,f;let k=0;for(const g of f.lengths)f.coords[2*k]=f.coords[2*k]*this._sx+this._tx,f.coords[2*k+1]=f.coords[2*k+1]*this._sy+this._ty,k+=g;return f};d.readCentroid=function(){return w.hasGeometry(this._current)?
this._computeCentroid():this._current.centroid};d.hasField=function(f){return f in this._current.attributes?!0:this.getFieldNames().map(k=>k.toLowerCase()).includes(f.toLowerCase())};d.getFieldNames=function(){return Object.keys(this._current.attributes)};d._readAttribute=function(f,k){var g=this._current.attributes[f];if(void 0!==g)return null!=g&&k&&this._dateFields.has(f)?new Date(g):g;g=this.readAttributes();f=f?.toLocaleLowerCase().trim();for(const e in g)if(e.toLocaleLowerCase().trim()===f)return f=
this._current.attributes[e],null!=f&&k&&this._dateFields.has(e)?new Date(f):f};d.copyInto=function(f){h.prototype.copyInto.call(this,f);f._featureIndex=this._featureIndex;f._transform=this._transform;f._dateFields=this._dateFields};d._readAttributes=function(){return this._current.attributes};t._createClass(c,[{key:"_current",get:function(){return this._features[this._featureIndex]}},{key:"geometryType",get:function(){return this._geometryType}},{key:"hasFeatures",get:function(){return!!this._features.length}},
{key:"hasNext",get:function(){return this._featureIndex+1<this._features.length}},{key:"exceededTransferLimit",get:function(){return this._exceededTransferLimit}},{key:"hasZ",get:function(){return!1}},{key:"hasM",get:function(){return!1}}]);return c}(y.FeatureSetReader);u.FeatureSetReaderJSON=m;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/FeatureSetReaderPBF":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/pbf ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedFeature ../../../../../layers/graphics/OptimizedGeometry ./FeatureSetReader ./FeatureSetReaderPBFHeader".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d){function f(b){if(b<=e.small.delta.length)return e.small;if(b<=e.large.delta.length)return e.large;e.large.delta=new Int32Array(Math.round(1.25*b));e.large.decoded=new Int32Array(Math.round(1.25*b));return e.large}function k(b){var l=b.getLength();for(l=b.pos()+l;b.pos()<l&&b.next();)switch(b.tag()){case 1:return b.getString();case 2:return b.getFloat();case 3:return b.getDouble();case 4:return b.getSInt32();case 5:return b.getUInt32();case 6:return b.getInt64();case 7:return b.getUInt64();
case 8:return b.getSInt64();case 9:return b.getBool();default:return b.skip(),null}return null}function g(b,l,q,n){return 0===b*n-q*l&&0<b*q+l*n}const e={small:{delta:new Int32Array(128),decoded:new Int32Array(128)},large:{delta:new Int32Array(128E3),decoded:new Int32Array(128E3)}};let a=function(b){function l(n,v,B,z){n=b.call(this,n,z)||this;n._hasNext=!1;n._isPoints=!1;n._featureIndex=-1;n._featureOffset=0;n._cache={area:0,unquantGeometry:void 0,geometry:void 0,centroid:void 0,legacyFeature:void 0,
optFeature:void 0};n._geometryType=z.geometryType;n._reader=v;n._header=B;n._hasNext=B.hasFeatures;n._isPoints="esriGeometryPoint"===z.geometryType;return n}t._inheritsLoose(l,b);l.fromBuffer=function(n,v,B=!1){var z=v.geometryType;a:{try{const D=new y(new Uint8Array(n),new DataView(n));for(;D.next();)switch(D.tag()){case 2:b:{for(var p=D.getMessage();p.next();)switch(p.tag()){case 1:var r=p.getMessage();break b;default:p.skip()}r=null}break a;default:D.skip()}}catch(D){n=new H("query:parsing-pbf",
"Error while parsing FeatureSet PBF payload",{error:D}),C.getLogger("esri.view.2d.layers.features.support.FeatureSetReaderPBF").error(n)}r=null}n=r;B=d.parseHeader(n,"esriGeometryPoint"===z,B);z=c.FeatureSetReader.createInstance();return new l(z,n,B,v)};var q=l.prototype;q.hasField=function(n){return this._header.hasField(n)||this._header.hasField(n.toLowerCase().trim())};q.getFieldNames=function(){return this._header.fields.map(n=>n.fieldName)};q.getSize=function(){return this._size};q.getQuantizationTransform=
function(){return this._header.transform};q.getCursor=function(){return this.copy()};q.getIndex=function(){return this._featureIndex};q.setIndex=function(n){this._cache.area=0;this._cache.unquantGeometry=void 0;this._cache.geometry=void 0;this._cache.centroid=void 0;this._cache.legacyFeature=void 0;this._cache.optFeature=void 0;this._featureIndex=n};q.getAttributeHash=function(){let n="";this._header.fields.forEach(({index:v})=>{n+=this._readAttributeAtIndex(v)+"."});return n};q.getObjectId=function(){return this._readAttributeAtIndex(this._header.objectIdFieldIndex)};
q.getDisplayId=function(){return this._header.displayIds[this._featureIndex]};q.setDisplayId=function(n){this._header.displayIds[this._featureIndex]=n};q.getGroupId=function(){return this._header.groupIds[this._featureIndex]};q.setGroupId=function(n){this._header.groupIds[this._featureIndex]=n};q.readLegacyFeature=function(){if(void 0===this._cache.legacyFeature){var n=this.readCentroid();n={attributes:this.readAttributes(),geometry:this._isPoints?this.readLegacyPointGeometry():this.readLegacyGeometry(),
centroid:(n&&{x:n.coords[0],y:n.coords[1]})??null};return this._cache.legacyFeature=n}return this._cache.legacyFeature};q.readOptimizedFeature=function(){if(void 0===this._cache.optFeature){const n=new m.OptimizedFeature(this.readGeometry(),this.readAttributes(),this.readCentroid());n.objectId=this.getObjectId();n.displayId=this.getDisplayId();return this._cache.optFeature=n}return this._cache.optFeature};q.getXHydrated=function(){const n=this._header.centroid[2*this._featureIndex],v=this.getQuantizationTransform();
return w.isNone(v)?n:n*v.scale[0]+v.translate[0]};q.getYHydrated=function(){const n=this._header.centroid[2*this._featureIndex+1],v=this.getQuantizationTransform();return w.isNone(v)?n:v.translate[1]-n*v.scale[1]};q.getX=function(){return this._header.centroid[2*this._featureIndex]*this._sx+this._tx};q.getY=function(){return this._header.centroid[2*this._featureIndex+1]*this._sy+this._ty};q.readLegacyPointGeometry=function(){const n=this.getX(),v=this.getY();return{x:n,y:v}};q.readLegacyGeometry=
function(n){n=this.readGeometry(n);return x.convertToGeometry(n,this.geometryType,!1,!1)};q.readLegacyCentroid=function(){const n=this.readCentroid();if(!n)return null;const [v,B]=n.coords;return{x:v,y:B}};q.readGeometryArea=function(){this._cache.area||this.readGeometry(!0);return this._cache.area};q.readUnquantizedGeometry=function(n=!1){if(void 0===this._cache.unquantGeometry){n=this.readGeometry(n);if(!n)return this._cache.unquantGeometry=void 0,null;var v=f(n.coords.length).decoded;n=n.clone(v);
v=n.coords;let B=0;for(const z of n.lengths){for(let p=1;p<z;p++){const r=2*(B+p),D=2*(B+p-1);v[r]+=v[D];v[r+1]+=v[D+1]}B+=z}return this._cache.unquantGeometry=n}return this._cache.unquantGeometry};q.readHydratedGeometry=function(){if(this._isPoints){if(268435455===this._header.centroid[2*this._featureIndex])return null;var n=this.getXHydrated(),v=this.getYHydrated();return new h([],[n,v])}n=this.readGeometry();if(!n)return null;n=n.clone();v=this.getQuantizationTransform();w.isSome(v)&&x.unquantizeOptimizedGeometry(n,
n,this.hasZ,this.hasM,v);return n};q.readGeometry=function(n=!1){if(void 0===this._cache.geometry){var v=null;if(this._isPoints){if(268435455===this._header.centroid[2*this._featureIndex])return null;n=this.getX();v=this.getY();v=new h([],[n,v])}else{const B=this._header.offsets.geometry[this._featureIndex],z=this._reader;if(0===B){n=this._readServerCentroid();if(!n)return null;const [p,r]=n.coords;return this.createQuantizedExtrudedQuad(p,r)}z.move(B);try{if(v=n?this._parseGeometryForDisplay(z):
this._parseGeometry(z),null===v){const p=this._readServerCentroid();if(!p)return null;const [r,D]=p.coords;return this.createQuantizedExtrudedQuad(r,D)}}catch(p){return console.error("Failed to parse geometry!",p),null}}return this._cache.geometry=v}return this._cache.geometry};q.readCentroid=function(){if(void 0===this._cache.centroid){let n=void 0;(n=this._computeCentroid())||(n=this._readServerCentroid());this._cache.centroid=n??void 0;return n??null}return this._cache.centroid};q.copy=function(){var n=
this._reader.clone();n=new l(this.instance,n,this._header,this.fullSchema());this.copyInto(n);return n};q.next=function(){this._cache.area=0;this._cache.unquantGeometry=void 0;this._cache.geometry=void 0;this._cache.centroid=void 0;this._cache.legacyFeature=void 0;for(this._cache.optFeature=void 0;++this._featureIndex<this._size&&!this._getExists(););return this._featureIndex<this._size};q._readAttribute=function(n,v){n=this._header.hasField(n)?n:n.toLowerCase().trim();var B=this._header.getFieldIndex(n);
if(null!=B)return B=this._readAttributeAtIndex(B),v&&null!=B?this._header.isDateField(n)?new Date(B):B:B};q._readAttributes=function(){const n={};this._header.fields.forEach(({fieldName:v,index:B})=>{n[v]=this._readAttributeAtIndex(B)});return n};q.copyInto=function(n){b.prototype.copyInto.call(this,n);n._featureIndex=this._featureIndex;n._featureOffset=this._featureOffset;n._hasNext=this._hasNext};q._readAttributeAtIndex=function(n){const v=this._reader;v.move(this._header.offsets.attributes[this._featureIndex*
this._header.fieldCount+n]);return k(v)};q._readServerCentroid=function(){const n=this._header.centroid[2*this._featureIndex]+this._tx;return 268435455===n?null:new h([],[n,this._header.centroid[2*this._featureIndex+1]+this._ty])};q._parseGeometry=function(n){n=n.asUnsafe();var v=n.getLength();v=n.pos()+v;const B=[],z=[];for(;n.pos()<v&&n.next();)switch(n.tag()){case 2:var p=n.getUInt32();for(p=n.pos()+p;n.pos()<p;)z.push(n.getUInt32());break;case 3:p=n.getUInt32();p=n.pos()+p;B.push(n.getSInt32()+
this._tx);B.push(n.getSInt32()+this._ty);this.hasZ&&n.getSInt32();for(this.hasM&&n.getSInt32();n.pos()<p;)B.push(n.getSInt32()),B.push(n.getSInt32()),this.hasZ&&n.getSInt32(),this.hasM&&n.getSInt32();break;default:n.skip()}return new h(z,B)};q._parseGeometryForDisplay=function(n){n=n.asUnsafe();var v=n.getLength();const B=n.pos()+v,z=[];v=[];let p=0,r=0;var D=null;let J=0;const K="esriGeometryPolygon"===this.geometryType;for(;n.pos()<B&&n.next();)switch(n.tag()){case 2:D=n.getUInt32();for(D=n.pos()+
D;n.pos()<D;){var F=n.getUInt32();z.push(F);p+=F}D=f(2*p).delta;break;case 3:n.getUInt32();F=2+(this.hasZ?1:0)+(this.hasM?1:0);w.assertIsSome(D);for(var A of z)if(r+F*A>D.length)for(var I=0;I<A;I++)n.getSInt32(),n.getSInt32(),this.hasZ&&n.getSInt32(),this.hasM&&n.getSInt32();else if(K){I=this.getAreaSimplificationThreshold(A,this._header.vertexCount);var G=2,E=1,M=n.getSInt32(),T=n.getSInt32();D[r++]=M;D[r++]=T;this.hasZ&&n.getSInt32();this.hasM&&n.getSInt32();var Y=n.getSInt32(),fa=n.getSInt32();
this.hasZ&&n.getSInt32();for(this.hasM&&n.getSInt32();G<A;){var ba=n.getSInt32();let U=n.getSInt32();this.hasZ&&n.getSInt32();this.hasM&&n.getSInt32();const P=M+Y,Q=T+fa,Z=P+ba,X=Q+U;.5*Math.abs(M*Q+P*X+Z*T-M*X-P*T-Z*Q)>=I?(J+=-.5*(P-M)*(Q+T),1<E&&g(D[r-2],D[r-1],Y,fa)?(D[r-2]+=Y,D[r-1]+=fa):(D[r++]=Y,D[r++]=fa,E++),M=P,T=Q):(ba+=Y,U+=fa);Y=ba;fa=U;G++}3>E?r-=2*E:(J+=-.5*(M+Y-M)*(T+fa+T),g(D[r-2],D[r-1],Y,fa)?(D[r-2]+=Y,D[r-1]+=fa,v.push(E)):(D[r++]=Y,D[r++]=fa,v.push(++E)))}else{I=0;G=n.getSInt32();
E=n.getSInt32();this.hasZ&&n.getSInt32();this.hasM&&n.getSInt32();D[r++]=G;D[r++]=E;I+=1;for(M=1;M<A;M++)T=n.getSInt32(),Y=n.getSInt32(),fa=G+T,ba=E+Y,J+=-.5*(fa-G)*(ba+E),this.hasZ&&n.getSInt32(),this.hasM&&n.getSInt32(),2<M&&g(D[r-2],D[r-1],T,Y)?(D[r-2]+=T,D[r-1]+=Y):(D[r++]=T,D[r++]=Y,I+=1),G=fa,E=ba;v.push(I)}break;default:n.skip()}this._cache.area=J;if(!v.length)return null;if(this._tx||this._ty){A=0;w.assertIsSome(D);for(const U of v)D[2*A]+=this._tx,D[2*A+1]+=this._ty,A+=U}return new h(v,D)};
t._createClass(l,[{key:"geometryType",get:function(){return this._geometryType}},{key:"_size",get:function(){return this._header.featureCount}},{key:"hasZ",get:function(){return!1}},{key:"hasM",get:function(){return!1}},{key:"stride",get:function(){return 2+(this.hasZ?1:0)+(this.hasM?1:0)}},{key:"hasFeatures",get:function(){return this._header.hasFeatures}},{key:"hasNext",get:function(){return this._hasNext}},{key:"exceededTransferLimit",get:function(){return this._header.exceededTransferLimit}}]);
return l}(c.FeatureSetReader);u.FeatureSetReaderPBF=a;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/FeatureSetReaderPBFHeader":function(){define(["exports","../../../../../core/Error","../../../../../rest/query/operations/pbfFeatureServiceParser"],function(u,t,H){let C=function(){function w(){this.fieldMap=new Map;this.fields=[];this.exceededTransferLimit=this.hasFeatures=!1;this.vertexCount=this.objectIdFieldIndex=this.featureCount=this.fieldCount=
0;this.offsets={attributes:[],geometry:[]};this.centroid=[]}var y=w.prototype;y.hasField=function(x){return this.fieldMap.has(x)};y.isDateField=function(x){return(null!=x&&this.fieldMap.get(x)?.isDate)??!1};y.getFieldIndex=function(x){return null!=x?this.fieldMap.get(x)?.index:void 0};return w}();u.FeatureSetHeader=C;u.parseHeader=function(w,y,x=!1){const m=w.asUnsafe(),h=m.pos(),c=new C;let d=0,f=0,k=null,g=null,e=null,a=!1;for(;m.next();)switch(m.tag()){case 1:k=m.getString();break;case 3:g=m.getString();
break;case 12:e=m.processMessage(H.parseTransform);break;case 9:c.exceededTransferLimit=m.getBool();if(c.exceededTransferLimit){c.offsets.geometry=x?new Float64Array(8E3):new Int32Array(8E3);c.centroid=x?new Float64Array(16E3):new Int32Array(16E3);for(var b=0;b<c.centroid.length;b++)c.centroid[b]=268435455}break;case 13:b=w.asUnsafe();var l=b.getLength();l=b.pos()+l;for(var q={name:"",isDate:!1};b.pos()<l&&b.next();)switch(b.tag()){case 1:q.name=b.getString();break;case 2:"esriFieldTypeDate"===H.parseFieldType(b.getEnum())&&
(q.isDate=!0);break;default:b.skip()}b=q;q=b.name;l=b.name.toLowerCase().trim();q={fieldName:q,index:d++,isDate:b.isDate};c.fields.push(q);c.fieldMap.set(b.name,q);c.fieldMap.set(l,q);break;case 15:b=m.getLength();b=m.pos()+b;c.exceededTransferLimit||(l=c.centroid,c.offsets.geometry.push(0),l.push(268435455),l.push(268435455));!a&&c.exceededTransferLimit&&(a=!0,c.offsets.attributes=x?new Float64Array(8E3*d):new Uint32Array(8E3*d));for(l=f*d;m.pos()<b&&m.next();)switch(m.tag()){case 1:a?c.offsets.attributes[l++]=
m.pos():c.offsets.attributes.push(m.pos());q=m.getLength();m.skipLen(q);break;case 2:if(y)for(q=m.getLength(),q=m.pos()+q;m.pos()<q&&m.next();)switch(m.tag()){case 3:m.getUInt32();var n=m.getSInt64(),v=m.getSInt64();c.centroid[2*f]=n;c.centroid[2*f+1]=v;break;default:m.skip()}else c.offsets.geometry[f]=m.pos(),q=m.getLength(),c.vertexCount+=q,m.skipLen(q);break;case 4:q=m.getLength();for(q=m.pos()+q;m.pos()<q&&m.next();)switch(m.tag()){case 3:m.getUInt32();n=m.getSInt64();v=m.getSInt64();c.centroid[2*
f]=n;c.centroid[2*f+1]=v;break;default:m.skip()}break;default:m.skip()}f++;c.hasFeatures=!0;break;default:m.skip()}w=k||g;if(!w)throw new t("FeatureSet has no objectId or globalId field name");c.featureCount=f;c.fieldCount=d;c.objectIdFieldIndex=c.getFieldIndex(w);c.transform=e;c.displayIds=new Uint32Array(c.featureCount);c.groupIds=new Uint16Array(c.featureCount);m.move(h);return c};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/sources/DataTileSource":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../TimeExtent ../../../../../core/Accessor ../../../../../core/Evented ../../../../../core/has ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/accessorSupport/diffUtils ../../../../../rest/support/Query ./DataTileSubscription ../support/UpdateToken".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f){function k(g,e){const a=new Set;g&&g.forEach(b=>a.add(b));e&&e.forEach(b=>a.add(b));return a.has("*")?["*"]:Array.from(a)}C=function(g){function e(b){var l=g.call(this)||this;l.events=new w;l._resolver=m.createResolver();l._didEdit=!1;l._subscriptions=new Map;l._outSR=b.outSR;l._serviceInfo=b.serviceInfo;l._onTileUpdateMessage=b.onMessage;return l}t._inheritsLoose(e,g);var a=e.prototype;a._onMessage=function(){var b=t._asyncToGenerator(function*(l){const q=this._subscriptions.get(l.id);
if(q)return l={...l,remove:l.remove??[],status:l.status??f.UpdateToken.empty()},m.ignoreAbortErrors(this._onTileUpdateMessage(l,q.options))});return function(l){return b.apply(this,arguments)}}();a.update=function(b,l){var q=l.fields.length;l.outFields=k(this._schema?.outFields,l.outFields);l.outFields=l.outFields.length>=.75*q?["*"]:l.outFields;l.outFields.sort();if(q=h.diff(this._schema,l)){y("esri-2d-update-debug")&&console.debug("Applying Update - Source:",q);var n={returnCentroid:"esriGeometryPolygon"===
this._serviceInfo.geometryType,returnGeometry:!0,timeReferenceUnknownClient:"stream"!==this._serviceInfo.type&&this._serviceInfo.timeReferenceUnknownClient,outFields:l.outFields,outSpatialReference:this._outSR,orderByFields:["orderByFields"in this._serviceInfo&&this._serviceInfo.orderByFields?this._serviceInfo.orderByFields:this._serviceInfo.objectIdField+" ASC"],where:l.definitionExpression||"1\x3d1",gdbVersion:l.gdbVersion,historicMoment:l.historicMoment,timeExtent:l.timeExtent?H.fromJSON(l.timeExtent):
null},v=this._schema&&h.hasDiff(q,"outFields");this._schema&&h.hasDiffAny(q,["timeExtent","definitionExpression","gdbVersion","historicMoment","customParameters"])&&(b.why.mesh.push("Layer filter and/or custom parameters changed"),b.why.source.push("Layer filter and/or custom parameters changed"),b.mesh=!0,b.source=!0,b.queryFilter=!0);v&&(b.why.source.push("Layer required fields changed"),b.source=!0);h.diff(n,this._queryInfo)&&(this._queryInfo=n);this._schema=l;this._resolver.resolve()}};a.whenInitialized=
function(){return this._resolver.promise};a.applyUpdate=function(){var b=t._asyncToGenerator(function*(l){l.queryFilter||l.source&&this._didEdit?(this.refresh(l.version),this._didEdit=!1):(this._subscriptions.forEach(q=>q.applyUpdate(l)),yield this.resend())});return function(l){return b.apply(this,arguments)}}();a.refresh=function(b,l){for(const q of this._tiles())this.unsubscribe(q),this.subscribe(q,b)};a.subscribe=function(b,l){l=new d.DataTileSubscription(b,l);this._subscriptions.set(b.id,l)};
a.unsubscribe=function(b){const l=this.getSubscription(b.id);x.isSome(l)&&l.abort();this._subscriptions.delete(b.id)};a.createQuery=function(b={}){return new c({...this._queryInfo,historicMoment:this._queryInfo.historicMoment?new Date(this._queryInfo.historicMoment):null,...b})};a.getSubscription=function(b){return this._subscriptions.has(b)?this._subscriptions.get(b):null};a.queryLastEditDate=function(){var b=t._asyncToGenerator(function*(){throw Error("Service does not support query type");});return function(){return b.apply(this,
arguments)}}();a.query=function(){var b=t._asyncToGenerator(function*(l,q){throw Error("Service does not support query");});return function(l,q){return b.apply(this,arguments)}}();a._tiles=function*(){const b=Array.from(this._subscriptions.values());for(const l of b)yield l.tile};a.edit=function(){var b=t._asyncToGenerator(function*(l,q){var n=this,v=Array.from(this._subscriptions.values());const B=v.map(({tile:z})=>z);for(const z of v)z.removeIds(q);l.length&&(v=B.map(z=>{const p=this.createTileQuery(z);
p.objectIds=l;return{tile:z,query:p}}).map(function(){var z=t._asyncToGenerator(function*({tile:p,query:r}){return{tile:p,result:yield n.query(r,{query:{tile:y("esri-tiles-debug")?p.id.replace(/\//g,"."):void 0}}),query:r}});return function(p){return z.apply(this,arguments)}}()),v=(yield m.eachAlwaysValues(v)).map(function(){var z=t._asyncToGenerator(function*({tile:p,result:r}){(r.hasFeatures||q.length||l.length)&&(p=n._subscriptions.get(p.key.id))&&p.edit(r,l)});return function(p){return z.apply(this,
arguments)}}()),yield m.eachAlways(v));this._didEdit=!0});return function(l,q){return b.apply(this,arguments)}}();return e}(C);u.DataTileSource=C;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/TimeExtent":function(){define("./chunks/_rollupPluginBabelHelpers ./chunks/tslib.es6 ./core/JSONSupport ./core/maybe ./core/timeUtils ./core/accessorSupport/decorators/property ./core/accessorSupport/ensureType ./core/arrayUtils ./core/accessorSupport/decorators/reader ./core/accessorSupport/decorators/subclass ./core/accessorSupport/decorators/writer".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d){var f;H=f=function(e){function a(l){l=e.call(this,l)||this;l.end=null;l.start=null;return l}u._inheritsLoose(a,e);var b=a.prototype;b.readEnd=function(l,q){return null!=q.end?new Date(q.end):null};b.writeEnd=function(l,q){q.end=l?l.getTime():null};b.readStart=function(l,q){return null!=q.start?new Date(q.start):null};b.writeStart=function(l,q){q.start=l?l.getTime():null};b.clone=function(){return new f({end:this.end,start:this.start})};b.equals=function(l){if(!l)return!1;
const q=C.isSome(this.start)?this.start.getTime():this.start,n=C.isSome(this.end)?this.end.getTime():this.end,v=C.isSome(l.start)?l.start.getTime():l.start;l=C.isSome(l.end)?l.end.getTime():l.end;return q===v&&n===l};b.expandTo=function(l){if(this.isEmpty||this.isAllTime)return this.clone();const q=C.applySome(this.start,v=>w.truncateDate(v,l)),n=C.applySome(this.end,v=>{const B=w.truncateDate(v,l);return v.getTime()===B.getTime()?B:w.offsetDate(B,1,l)});return new f({start:q,end:n})};b.intersection=
function(l){if(!l)return this.clone();if(this.isEmpty||l.isEmpty)return f.empty;if(this.isAllTime)return l.clone();if(l.isAllTime)return this.clone();var q=C.mapOr(this.start,-Infinity,p=>p.getTime());const n=C.mapOr(this.end,Infinity,p=>p.getTime()),v=C.mapOr(l.start,-Infinity,p=>p.getTime());l=C.mapOr(l.end,Infinity,p=>p.getTime());let B,z;v>=q&&v<=n?B=v:q>=v&&q<=l&&(B=q);n>=v&&n<=l?z=n:l>=q&&l<=n&&(z=l);return null==B||null==z||isNaN(B)||isNaN(z)?f.empty:(q=new f,q.start=-Infinity===B?null:new Date(B),
q.end=Infinity===z?null:new Date(z),q)};b.offset=function(l,q){if(this.isEmpty||this.isAllTime)return this.clone();const n=new f,{start:v,end:B}=this;C.isSome(v)&&(n.start=w.offsetDate(v,l,q));C.isSome(B)&&(n.end=w.offsetDate(B,l,q));return n};b.union=function(l){if(!l||l.isEmpty)return this.clone();if(this.isEmpty)return l.clone();if(this.isAllTime||l.isAllTime)return k.clone();const q=C.isSome(this.start)&&C.isSome(l.start)?new Date(Math.min(this.start.getTime(),l.start.getTime())):null;l=C.isSome(this.end)&&
C.isSome(l.end)?new Date(Math.max(this.end.getTime(),l.end.getTime())):null;return new f({start:q,end:l})};u._createClass(a,[{key:"isAllTime",get:function(){return this.equals(f.allTime)}},{key:"isEmpty",get:function(){return this.equals(f.empty)}}],[{key:"allTime",get:function(){return k}},{key:"empty",get:function(){return g}}]);return a}(H.JSONSupport);t.__decorate([y.property({type:Date,json:{write:{allowNull:!0}}})],H.prototype,"end",void 0);t.__decorate([h.reader("end")],H.prototype,"readEnd",
null);t.__decorate([d.writer("end")],H.prototype,"writeEnd",null);t.__decorate([y.property({readOnly:!0,json:{read:!1}})],H.prototype,"isAllTime",null);t.__decorate([y.property({readOnly:!0,json:{read:!1}})],H.prototype,"isEmpty",null);t.__decorate([y.property({type:Date,json:{write:{allowNull:!0}}})],H.prototype,"start",void 0);t.__decorate([h.reader("start")],H.prototype,"readStart",null);t.__decorate([d.writer("start")],H.prototype,"writeStart",null);H=f=t.__decorate([c.subclass("esri.TimeExtent")],
H);const k=new H,g=new H({start:void 0,end:void 0});return H})},"esri/core/timeUtils":function(){define(["exports","./has"],function(u,t){function H(y,x,m){return 0===y?0:y*C[x]/C[m]}const C={milliseconds:1,seconds:1E3,minutes:6E4,hours:36E5,days:864E5,weeks:6048E5,months:26784E5,years:31536E6,decades:31536E7,centuries:31536E8},w={milliseconds:{getter:"getMilliseconds",setter:"setMilliseconds",multiplier:1},seconds:{getter:"getSeconds",setter:"setSeconds",multiplier:1},minutes:{getter:"getMinutes",
setter:"setMinutes",multiplier:1},hours:{getter:"getHours",setter:"setHours",multiplier:1},days:{getter:"getDate",setter:"setDate",multiplier:1},weeks:{getter:"getDate",setter:"setDate",multiplier:7},months:{getter:"getMonth",setter:"setMonth",multiplier:1},years:{getter:"getFullYear",setter:"setFullYear",multiplier:1},decades:{getter:"getFullYear",setter:"setFullYear",multiplier:10},centuries:{getter:"getFullYear",setter:"setFullYear",multiplier:100}};u.convertTime=H;u.makeUTCTime=function(y,x,m=
"milliseconds"){x=new Date(H(x,m,"milliseconds"));x.setUTCFullYear(y.getUTCFullYear(),y.getUTCMonth(),y.getUTCDate());return x};u.offsetDate=function(y,x,m){y=new Date(y.getTime());if(x&&m){const {getter:c,setter:d,multiplier:f}=w[m];if("months"===m){m=y.getFullYear();var h=y.getMonth()+x;m=new Date(m,h+1,1);m.setDate(0);m=m.getDate();y.getDate()>m&&y.setDate(m)}y[d](y[c]()+x*f)}return y};u.offsetDateUTC=function(y,x,m="milliseconds"){y=y.getTime();x=H(x,m,"milliseconds");return new Date(y+x)};u.resetUTCDate=
function(y,x){y=new Date(y.getTime());y.setUTCFullYear(x.getFullYear(),x.getMonth(),x.getDate());return y};u.timeSinceUTCMidnight=function(y,x="milliseconds"){const m=H(y.getUTCHours(),"hours","milliseconds"),h=H(y.getUTCMinutes(),"minutes","milliseconds"),c=H(y.getUTCSeconds(),"seconds","milliseconds");y=y.getUTCMilliseconds();return H(m+h+c+y,"milliseconds",x)};u.truncateDate=function(y,x){switch(x){case "milliseconds":return new Date(y.getTime());case "seconds":return new Date(y.getFullYear(),
y.getMonth(),y.getDate(),y.getHours(),y.getMinutes(),y.getSeconds());case "minutes":return new Date(y.getFullYear(),y.getMonth(),y.getDate(),y.getHours(),y.getMinutes());case "hours":return new Date(y.getFullYear(),y.getMonth(),y.getDate(),y.getHours());case "days":return new Date(y.getFullYear(),y.getMonth(),y.getDate());case "weeks":return new Date(y.getFullYear(),y.getMonth(),y.getDate()-y.getDay());case "months":return new Date(y.getFullYear(),y.getMonth(),1);case "years":return new Date(y.getFullYear(),
0,1);case "decades":return new Date(y.getFullYear()-y.getFullYear()%10,0,1);case "centuries":return new Date(y.getFullYear()-y.getFullYear()%100,0,1);default:return new Date}};u.truncateLocalTime=function(y){const x=new Date(0);x.setHours(0);x.setMinutes(0);x.setSeconds(0);x.setMilliseconds(0);x.setFullYear(y.getUTCFullYear(),y.getUTCMonth(),y.getUTCDate());return x};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/Query":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../TimeExtent ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../core/accessorSupport/ensureType ../../geometry/support/jsonUtils ../../layers/support/source/DataLayerSource ./FullTextSearch ./QuantizationParameters ./StatisticDefinition ../../geometry/SpatialReference ../../geometry/Point".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f,k,g,e,a,b,l,q,n,v){var B;const z=new w.JSONMap({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"});w=new w.JSONMap({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",
esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});y=B=function(p){function r(J){J=p.call(this,J)||this;J.aggregateIds=null;J.cacheHint=void 0;J.compactGeometryEnabled=!1;J.datumTransformation=null;J.defaultSpatialReferenceEnabled=!1;J.distance=void 0;J.dynamicDataSource=void 0;J.formatOf3DObjects=null;J.fullText=null;J.gdbVersion=null;J.geometry=null;J.geometryPrecision=void 0;J.groupByFieldsForStatistics=
null;J.having=null;J.historicMoment=null;J.maxAllowableOffset=void 0;J.maxRecordCountFactor=1;J.multipatchOption=null;J.num=void 0;J.objectIds=null;J.orderByFields=null;J.outFields=null;J.outSpatialReference=null;J.outStatistics=null;J.parameterValues=null;J.pixelSize=null;J.quantizationParameters=null;J.rangeValues=null;J.relationParameter=null;J.resultType=null;J.returnCentroid=!1;J.returnDistinctValues=!1;J.returnExceededLimitFeatures=!0;J.returnGeometry=!1;J.returnQueryGeometry=!1;J.returnM=void 0;
J.returnZ=void 0;J.sourceSpatialReference=null;J.spatialRelationship="intersects";J.start=void 0;J.sqlFormat=null;J.text=null;J.timeExtent=null;J.timeReferenceUnknownClient=!1;J.units=null;J.where=null;return J}u._inheritsLoose(r,p);r.from=function(J){return g.ensureClass(B,J)};var D=r.prototype;D.castDatumTransformation=function(J){return"number"===typeof J||"object"===typeof J?J:null};D.writeHistoricMoment=function(J,K){K.historicMoment=J&&J.getTime()};D.writeParameterValues=function(J,K){if(J){const F=
{};for(const A in J){const I=J[A];Array.isArray(I)?F[A]=I.map(G=>G instanceof Date?G.getTime():G):F[A]=I instanceof Date?I.getTime():I}K.parameterValues=F}};D.writeStart=function(J,K){K.resultOffset=this.start;K.resultRecordCount=this.num||10;K.where="1\x3d1"};D.writeWhere=function(J,K){K.where=J||"1\x3d1"};D.clone=function(){return new B(x.clone({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,compactGeometryEnabled:this.compactGeometryEnabled,datumTransformation:this.datumTransformation,
defaultSpatialReferenceEnabled:this.defaultSpatialReferenceEnabled,distance:this.distance,fullText:this.fullText,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:m.isSome(this.historicMoment)?new Date(this.historicMoment.getTime()):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,
num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,
returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,dynamicDataSource:this.dynamicDataSource,sourceSpatialReference:this.sourceSpatialReference,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,timeReferenceUnknownClient:this.timeReferenceUnknownClient,units:this.units,where:this.where}))};return r}(y.JSONSupport);y.MAX_MAX_RECORD_COUNT_FACTOR=
5;t.__decorate([h.property({json:{write:!0}})],y.prototype,"aggregateIds",void 0);t.__decorate([h.property({type:Boolean,json:{write:!0}})],y.prototype,"cacheHint",void 0);t.__decorate([h.property({type:Boolean,json:{default:!1,write:!0}})],y.prototype,"compactGeometryEnabled",void 0);t.__decorate([h.property({json:{write:!0}})],y.prototype,"datumTransformation",void 0);t.__decorate([c.cast("datumTransformation")],y.prototype,"castDatumTransformation",null);t.__decorate([h.property({type:Boolean,
json:{default:!1,write:!0}})],y.prototype,"defaultSpatialReferenceEnabled",void 0);t.__decorate([h.property({type:Number,json:{write:{overridePolicy(p){return{enabled:0<p}}}}})],y.prototype,"distance",void 0);t.__decorate([h.property({type:a.DataLayerSource,json:{write:!0}})],y.prototype,"dynamicDataSource",void 0);t.__decorate([h.property({type:String,json:{write:!0}})],y.prototype,"formatOf3DObjects",void 0);t.__decorate([h.property({type:[b],json:{write:{enabled:!0,overridePolicy(){return{enabled:m.isSome(this.fullText)&&
0<this.fullText.length}}}}})],y.prototype,"fullText",void 0);t.__decorate([h.property({type:String,json:{write:!0}})],y.prototype,"gdbVersion",void 0);t.__decorate([h.property({types:H.geometryTypes,json:{read:e.fromJSON,write:!0}})],y.prototype,"geometry",void 0);t.__decorate([h.property({type:Number,json:{write:!0}})],y.prototype,"geometryPrecision",void 0);t.__decorate([h.property({type:[String],json:{write:!0}})],y.prototype,"groupByFieldsForStatistics",void 0);t.__decorate([h.property({type:String,
json:{write:!0}})],y.prototype,"having",void 0);t.__decorate([h.property({type:Date})],y.prototype,"historicMoment",void 0);t.__decorate([k.writer("historicMoment")],y.prototype,"writeHistoricMoment",null);t.__decorate([h.property({type:Number,json:{write:!0}})],y.prototype,"maxAllowableOffset",void 0);t.__decorate([h.property({type:Number,cast(p){return 1>p?1:p>B.MAX_MAX_RECORD_COUNT_FACTOR?B.MAX_MAX_RECORD_COUNT_FACTOR:p},json:{write:{overridePolicy(p){return{enabled:1<p}}}}})],y.prototype,"maxRecordCountFactor",
void 0);t.__decorate([h.property({type:["xyFootprint"],json:{write:!0}})],y.prototype,"multipatchOption",void 0);t.__decorate([h.property({type:Number,json:{read:{source:"resultRecordCount"}}})],y.prototype,"num",void 0);t.__decorate([h.property({json:{write:!0}})],y.prototype,"objectIds",void 0);t.__decorate([h.property({type:[String],json:{write:!0}})],y.prototype,"orderByFields",void 0);t.__decorate([h.property({type:[String],json:{write:!0}})],y.prototype,"outFields",void 0);t.__decorate([h.property({type:n,
json:{name:"outSR",write:!0}})],y.prototype,"outSpatialReference",void 0);t.__decorate([h.property({type:[q],json:{write:{enabled:!0,overridePolicy(){return{enabled:m.isSome(this.outStatistics)&&0<this.outStatistics.length}}}}})],y.prototype,"outStatistics",void 0);t.__decorate([h.property({json:{write:!0}})],y.prototype,"parameterValues",void 0);t.__decorate([k.writer("parameterValues")],y.prototype,"writeParameterValues",null);t.__decorate([h.property({type:v,json:{write:!0}})],y.prototype,"pixelSize",
void 0);t.__decorate([h.property({type:l,json:{write:!0}})],y.prototype,"quantizationParameters",void 0);t.__decorate([h.property({type:[Object],json:{write:!0}})],y.prototype,"rangeValues",void 0);t.__decorate([h.property({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy(){return{enabled:"relation"===this.spatialRelationship}}}}})],y.prototype,"relationParameter",void 0);t.__decorate([h.property({type:String,json:{write:!0}})],y.prototype,"resultType",
void 0);t.__decorate([h.property({type:Boolean,json:{default:!1,write:!0}})],y.prototype,"returnCentroid",void 0);t.__decorate([h.property({type:Boolean,json:{default:!1,write:!0}})],y.prototype,"returnDistinctValues",void 0);t.__decorate([h.property({type:Boolean,json:{default:!0,write:!0}})],y.prototype,"returnExceededLimitFeatures",void 0);t.__decorate([h.property({type:Boolean,json:{write:!0}})],y.prototype,"returnGeometry",void 0);t.__decorate([h.property({type:Boolean,json:{default:!1,write:!0}})],
y.prototype,"returnQueryGeometry",void 0);t.__decorate([h.property({type:Boolean,json:{default:!1,write:!0}})],y.prototype,"returnM",void 0);t.__decorate([h.property({type:Boolean,json:{write:{overridePolicy(p){return{enabled:p}}}}})],y.prototype,"returnZ",void 0);t.__decorate([h.property({type:n,json:{write:!0}})],y.prototype,"sourceSpatialReference",void 0);t.__decorate([d.enumeration(z,{ignoreUnknown:!1,name:"spatialRel"})],y.prototype,"spatialRelationship",void 0);t.__decorate([h.property({type:Number,
json:{read:{source:"resultOffset"}}})],y.prototype,"start",void 0);t.__decorate([k.writer("start"),k.writer("num")],y.prototype,"writeStart",null);t.__decorate([h.property({type:String,json:{write:!0}})],y.prototype,"sqlFormat",void 0);t.__decorate([h.property({type:String,json:{write:!0}})],y.prototype,"text",void 0);t.__decorate([h.property({type:C,json:{write:!0}})],y.prototype,"timeExtent",void 0);t.__decorate([h.property({type:Boolean,json:{default:!1,write:!0}})],y.prototype,"timeReferenceUnknownClient",
void 0);t.__decorate([d.enumeration(w,{ignoreUnknown:!1}),h.property({json:{write:{overridePolicy(p){return{enabled:!!p&&null!=this.distance&&0<this.distance}}}}})],y.prototype,"units",void 0);t.__decorate([h.property({type:String,json:{write:{overridePolicy(p){return{enabled:null!=p||null!=this.start&&0<this.start}}}}})],y.prototype,"where",void 0);t.__decorate([k.writer("where")],y.prototype,"writeWhere",null);return y=B=t.__decorate([f.subclass("esri.rest.support.Query")],y)})},"esri/layers/support/source/DataLayerSource":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/cast ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/extensions/serializableProperty/reader ../Field ./MapLayerSource ./QueryTableDataSource ./RasterDataSource ./TableDataSource".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f,k,g,e,a,b){function l(){B||(B=f.createTypeReader({types:q()}));return B}function q(){z||(z={key:"type",base:null,typeMap:{"data-layer":u.DataLayerSource,"map-layer":g.MapLayerSource}});return z}var n,v;C=C.strict()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"});u.JoinTableDataSource=n=function(p){function r(J){J=p.call(this,J)||this;J.type="join-table";return J}t._inheritsLoose(r,p);var D=r.prototype;D.readLeftTableSource=function(J,K,F){return l()(J,
K,F)};D.castLeftTableSource=function(J){return d.ensureOneOfType(q(),J)};D.readRightTableSource=function(J,K,F){return l()(J,K,F)};D.castRightTableSource=function(J){return d.ensureOneOfType(q(),J)};D.clone=function(){const {leftTableKey:J,rightTableKey:K,leftTableSource:F,rightTableSource:A,joinType:I}=this,G={leftTableKey:J,rightTableKey:K,leftTableSource:F?.clone()??void 0,rightTableSource:A?.clone()??void 0,joinType:I};return new n(G)};return r}(w.JSONSupport);H.__decorate([m.enumeration({joinTable:"join-table"})],
u.JoinTableDataSource.prototype,"type",void 0);H.__decorate([y.property({type:String,json:{write:!0}})],u.JoinTableDataSource.prototype,"leftTableKey",void 0);H.__decorate([y.property({type:String,json:{write:!0}})],u.JoinTableDataSource.prototype,"rightTableKey",void 0);H.__decorate([y.property({json:{write:!0}})],u.JoinTableDataSource.prototype,"leftTableSource",void 0);H.__decorate([h.reader("leftTableSource")],u.JoinTableDataSource.prototype,"readLeftTableSource",null);H.__decorate([x.cast("leftTableSource")],
u.JoinTableDataSource.prototype,"castLeftTableSource",null);H.__decorate([y.property({json:{write:!0}})],u.JoinTableDataSource.prototype,"rightTableSource",void 0);H.__decorate([h.reader("rightTableSource")],u.JoinTableDataSource.prototype,"readRightTableSource",null);H.__decorate([x.cast("rightTableSource")],u.JoinTableDataSource.prototype,"castRightTableSource",null);H.__decorate([m.enumeration(C)],u.JoinTableDataSource.prototype,"joinType",void 0);u.JoinTableDataSource=n=H.__decorate([c.subclass("esri.layers.support.source.JoinTableDataSource")],
u.JoinTableDataSource);let B=null,z=null;x={key:"type",base:null,typeMap:{"join-table":u.JoinTableDataSource,"query-table":e.QueryTableDataSource,raster:a.RasterDataSource,table:b.TableDataSource}};u.DataLayerSource=v=function(p){function r(D){D=p.call(this,D)||this;D.type="data-layer";return D}t._inheritsLoose(r,p);r.prototype.clone=function(){const {fields:D,dataSource:J}=this;return new v({fields:D,dataSource:J})};return r}(w.JSONSupport);H.__decorate([m.enumeration({dataLayer:"data-layer"})],
u.DataLayerSource.prototype,"type",void 0);H.__decorate([y.property({type:[k],json:{write:!0}})],u.DataLayerSource.prototype,"fields",void 0);H.__decorate([y.property({types:x,json:{write:!0}})],u.DataLayerSource.prototype,"dataSource",void 0);u.DataLayerSource=v=H.__decorate([c.subclass("esri.layers.support.source.DataLayerSource")],u.DataLayerSource);u.DataLayerSource.from=d.ensureType(u.DataLayerSource);Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/Field":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ./domains ./fieldType".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f){var k;const g=new H.JSONMap({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});H=k=function(e){function a(l){l=e.call(this,l)||this;
l.alias=null;l.defaultValue=void 0;l.description=null;l.domain=null;l.editable=!0;l.length=-1;l.name=null;l.nullable=!0;l.type=null;l.valueType=null;l.visible=!0;return l}u._inheritsLoose(a,e);var b=a.prototype;b.readDescription=function(l,{description:q}){l=null;try{l=q?JSON.parse(q):null}catch(n){}return l?.value??null};b.readValueType=function(l,{description:q}){l=null;try{l=q?JSON.parse(q):null}catch(n){}return l?g.fromJSON(l.fieldValueType):null};b.clone=function(){return new k({alias:this.alias,
defaultValue:this.defaultValue,description:this.description,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})};return a}(C.JSONSupport);t.__decorate([w.property({type:String,json:{write:!0}})],H.prototype,"alias",void 0);t.__decorate([w.property({type:[String,Number],json:{write:{allowNull:!0}}})],H.prototype,"defaultValue",void 0);t.__decorate([w.property()],
H.prototype,"description",void 0);t.__decorate([h.reader("description")],H.prototype,"readDescription",null);t.__decorate([w.property({types:d.types,json:{read:{reader:d.fromJSON},write:!0}})],H.prototype,"domain",void 0);t.__decorate([w.property({type:Boolean,json:{write:!0}})],H.prototype,"editable",void 0);t.__decorate([w.property({type:y.Integer,json:{write:!0}})],H.prototype,"length",void 0);t.__decorate([w.property({type:String,json:{write:!0}})],H.prototype,"name",void 0);t.__decorate([w.property({type:Boolean,
json:{write:!0}})],H.prototype,"nullable",void 0);t.__decorate([m.enumeration(f.kebabDict)],H.prototype,"type",void 0);t.__decorate([w.property()],H.prototype,"valueType",void 0);t.__decorate([h.reader("valueType",["description"])],H.prototype,"readValueType",null);t.__decorate([w.property({type:Boolean,json:{read:!1}})],H.prototype,"visible",void 0);return H=k=t.__decorate([c.subclass("esri.layers.support.Field")],H)})},"esri/layers/support/domains":function(){define("exports ../../core/has ./CodedValueDomain ./Domain ./InheritedDomain ./RangeDomain".split(" "),
function(u,t,H,C,w,y){t={key:"type",base:C,typeMap:{range:y,"coded-value":H,inherited:w}};u.CodedValueDomain=H;u.DomainBase=C;u.InheritedDomain=w;u.RangeDomain=y;u.fromJSON=function(x){if(!x||!x.type)return null;switch(x.type){case "range":return y.fromJSON(x);case "codedValue":return H.fromJSON(x);case "inherited":return w.fromJSON(x)}return null};u.types=t;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/CodedValueDomain":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./CodedValue ./Domain".split(" "),
function(u,t,H,C,w,y,x,m,h){var c;w=c=function(d){function f(g){g=d.call(this,g)||this;g.codedValues=null;g.type="coded-value";return g}u._inheritsLoose(f,d);var k=f.prototype;k.getName=function(g){let e=null;if(this.codedValues){const a=String(g);this.codedValues.some(b=>{String(b.code)===a&&(e=b.name);return!!e})}return e};k.clone=function(){return new c({codedValues:H.clone(this.codedValues),name:this.name})};return f}(h);t.__decorate([C.property({type:[m.CodedValue],json:{write:!0}})],w.prototype,
"codedValues",void 0);t.__decorate([y.enumeration({codedValue:"coded-value"})],w.prototype,"type",void 0);return w=c=t.__decorate([x.subclass("esri.layers.support.CodedValueDomain")],w)})},"esri/layers/support/CodedValue":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass".split(" "),function(u,
t,H,C,w,y,x,m){var h;u.CodedValue=h=function(c){function d(f){f=c.call(this,f)||this;f.name=null;f.code=null;return f}t._inheritsLoose(d,c);d.prototype.clone=function(){return new h({name:this.name,code:this.code})};return d}(C.JSONSupport);H.__decorate([w.property({type:String,json:{write:!0}})],u.CodedValue.prototype,"name",void 0);H.__decorate([w.property({type:[String,Number],json:{write:!0}})],u.CodedValue.prototype,"code",void 0);u.CodedValue=h=H.__decorate([m.subclass("esri.layers.support.CodedValue")],
u.CodedValue);Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/Domain":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),function(u,t,H,C,w,y,x,m,h){H=new H.JSONMap({inherited:"inherited",
codedValue:"coded-value",range:"range"});C=function(c){function d(f){f=c.call(this,f)||this;f.name=null;f.type=null;return f}u._inheritsLoose(d,c);return d}(C.JSONSupport);t.__decorate([w.property({type:String,json:{write:!0}})],C.prototype,"name",void 0);t.__decorate([m.enumeration(H)],C.prototype,"type",void 0);return C=t.__decorate([h.subclass("esri.layers.support.Domain")],C)})},"esri/layers/support/InheritedDomain":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Logger ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/Error ../../core/has ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./Domain".split(" "),
function(u,t,H,C,w,y,x,m,h,c){var d;H=d=function(f){function k(g){g=f.call(this,g)||this;g.type="inherited";return g}u._inheritsLoose(k,f);k.prototype.clone=function(){return new d};return k}(c);t.__decorate([m.enumeration({inherited:"inherited"})],H.prototype,"type",void 0);return H=d=t.__decorate([h.subclass("esri.layers.support.InheritedDomain")],H)})},"esri/layers/support/RangeDomain":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./Domain".split(" "),
function(u,t,H,C,w,y,x,m){var h;C=h=function(c){function d(f){f=c.call(this,f)||this;f.maxValue=null;f.minValue=null;f.type="range";return f}u._inheritsLoose(d,c);d.prototype.clone=function(){return new h({maxValue:this.maxValue,minValue:this.minValue,name:this.name})};return d}(m);t.__decorate([H.property({type:Number,json:{type:[Number],read:{source:"range",reader(c,d){return d.range&&d.range[1]}},write:{enabled:!1,overridePolicy(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",
writer(c,d,f){d[f]=[this.minValue||0,c]}}}})],C.prototype,"maxValue",void 0);t.__decorate([H.property({type:Number,json:{type:[Number],read:{source:"range",reader(c,d){return d.range&&d.range[0]}},write:{target:"range",writer(c,d,f){d[f]=[c,this.maxValue||0]}}}})],C.prototype,"minValue",void 0);t.__decorate([y.enumeration({range:"range"})],C.prototype,"type",void 0);return C=h=t.__decorate([x.subclass("esri.layers.support.RangeDomain")],C)})},"esri/layers/support/source/MapLayerSource":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass".split(" "),
function(u,t,H,C,w,y,x,m,h){var c;u.MapLayerSource=c=function(d){function f(k){k=d.call(this,k)||this;k.type="map-layer";return k}t._inheritsLoose(f,d);f.prototype.clone=function(){const {mapLayerId:k,gdbVersion:g}=this;return new c({mapLayerId:k,gdbVersion:g})};return f}(C.JSONSupport);H.__decorate([m.enumeration({mapLayer:"map-layer"})],u.MapLayerSource.prototype,"type",void 0);H.__decorate([w.property({type:y.Integer,json:{write:!0}})],u.MapLayerSource.prototype,"mapLayerId",void 0);H.__decorate([w.property({type:String,
json:{write:!0}})],u.MapLayerSource.prototype,"gdbVersion",void 0);u.MapLayerSource=c=H.__decorate([h.subclass("esri.layers.support.source.MapLayerSource")],u.MapLayerSource);Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/source/QueryTableDataSource":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ../../../geometry/SpatialReference ../../../geometry/support/typeUtils".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f){var k;u.QueryTableDataSource=k=function(g){function e(a){a=g.call(this,a)||this;a.type="query-table";return a}t._inheritsLoose(e,g);e.prototype.clone=function(){const {workspaceId:a,query:b,oidFields:l,spatialReference:q,geometryType:n}=this,v={workspaceId:a,query:b,oidFields:l,spatialReference:q?.clone()??void 0,geometryType:n};return new k(v)};return e}(w.JSONSupport);H.__decorate([h.enumeration({queryTable:"query-table"})],u.QueryTableDataSource.prototype,"type",
void 0);H.__decorate([y.property({type:String,json:{write:!0}})],u.QueryTableDataSource.prototype,"workspaceId",void 0);H.__decorate([y.property({type:String,json:{write:!0}})],u.QueryTableDataSource.prototype,"query",void 0);H.__decorate([y.property({type:String,json:{write:!0}})],u.QueryTableDataSource.prototype,"oidFields",void 0);H.__decorate([y.property({type:d,json:{write:!0}})],u.QueryTableDataSource.prototype,"spatialReference",void 0);H.__decorate([h.enumeration(f.featureGeometryTypeKebabDictionary)],
u.QueryTableDataSource.prototype,"geometryType",void 0);u.QueryTableDataSource=k=H.__decorate([c.subclass("esri.layers.support.source.QueryTableDataSource")],u.QueryTableDataSource);Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/source/RasterDataSource":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass".split(" "),
function(u,t,H,C,w,y,x,m,h){var c;u.RasterDataSource=c=function(d){function f(k){k=d.call(this,k)||this;k.type="raster";return k}t._inheritsLoose(f,d);f.prototype.clone=function(){const {workspaceId:k,dataSourceName:g}=this;return new c({workspaceId:k,dataSourceName:g})};return f}(C.JSONSupport);H.__decorate([m.enumeration({raster:"raster"})],u.RasterDataSource.prototype,"type",void 0);H.__decorate([w.property({type:String,json:{write:!0}})],u.RasterDataSource.prototype,"dataSourceName",void 0);H.__decorate([w.property({type:String,
json:{write:!0}})],u.RasterDataSource.prototype,"workspaceId",void 0);u.RasterDataSource=c=H.__decorate([h.subclass("esri.layers.support.source.RasterDataSource")],u.RasterDataSource);Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/source/TableDataSource":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass".split(" "),
function(u,t,H,C,w,y,x,m,h){var c;u.TableDataSource=c=function(d){function f(k){k=d.call(this,k)||this;k.type="table";return k}t._inheritsLoose(f,d);f.prototype.clone=function(){const {workspaceId:k,gdbVersion:g,dataSourceName:e}=this;return new c({workspaceId:k,gdbVersion:g,dataSourceName:e})};return f}(C.JSONSupport);H.__decorate([m.enumeration({table:"table"})],u.TableDataSource.prototype,"type",void 0);H.__decorate([w.property({type:String,json:{write:!0}})],u.TableDataSource.prototype,"workspaceId",
void 0);H.__decorate([w.property({type:String,json:{write:!0}})],u.TableDataSource.prototype,"gdbVersion",void 0);H.__decorate([w.property({type:String,json:{write:!0}})],u.TableDataSource.prototype,"dataSourceName",void 0);u.TableDataSource=c=H.__decorate([h.subclass("esri.layers.support.source.TableDataSource")],u.TableDataSource);Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/FullTextSearch":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Clonable ../../core/JSONSupport ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass".split(" "),
function(u,t,H,C,w,y,x,m,h){H=function(c){function d(f){f=c.call(this,f)||this;f.onFields=null;f.operator=null;f.searchTerm=null;f.searchType=null;return f}u._inheritsLoose(d,c);return d}(H.ClonableMixin(C.JSONSupport));t.__decorate([y.property({type:[String],json:{write:{enabled:!0,overridePolicy(){return{enabled:w.isSome(this.onFields)&&0<this.onFields.length}}}}})],H.prototype,"onFields",void 0);t.__decorate([y.property({type:String,json:{write:!0}})],H.prototype,"operator",void 0);t.__decorate([y.property({type:String,
json:{write:!0}})],H.prototype,"searchTerm",void 0);t.__decorate([y.property({type:String,json:{write:!0}})],H.prototype,"searchType",void 0);return H=t.__decorate([h.subclass("esri.rest.support.FullTextSearch")],H)})},"esri/rest/support/QuantizationParameters":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../geometry/Extent".split(" "),
function(u,t,H,C,w,y,x,m,h,c){var d;H=new C.JSONMap({upperLeft:"upper-left",lowerLeft:"lower-left"});w=d=function(f){function k(g){g=f.call(this,g)||this;g.extent=null;g.mode="view";g.originPosition="upper-left";g.tolerance=1;return g}u._inheritsLoose(k,f);k.prototype.clone=function(){return new d(y.clone({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))};return k}(w.JSONSupport);t.__decorate([x.property({type:c,json:{write:{overridePolicy(){return{enabled:"view"===
this.mode}}}}})],w.prototype,"extent",void 0);t.__decorate([x.property({type:["view","edit"],json:{write:!0}})],w.prototype,"mode",void 0);t.__decorate([x.property({type:String,json:{read:H.read,write:H.write}})],w.prototype,"originPosition",void 0);t.__decorate([x.property({type:Number,json:{write:{overridePolicy(){return{enabled:"view"===this.mode}}}}})],w.prototype,"tolerance",void 0);return w=d=t.__decorate([h.subclass("esri.rest.support.QuantizationParameters")],w)})},"esri/rest/support/StatisticDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer".split(" "),
function(u,t,H,C,w,y,x,m,h){var c;H=new H.JSONMap({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete",EnvelopeAggregate:"envelope-aggregate",CentroidAggregate:"centroid-aggregate",ConvexHullAggregate:"convex-hull-aggregate"});C=c=function(d){function f(g){g=d.call(this,g)||this;g.maxPointCount=void 0;g.maxRecordCount=void 0;g.maxVertexCount=void 0;g.onStatisticField=
null;g.outStatisticFieldName=null;g.statisticType=null;g.statisticParameters=null;return g}u._inheritsLoose(f,d);var k=f.prototype;k.writeStatisticParameters=function(g,e){if("percentile-continuous"===this.statisticType||"percentile-discrete"===this.statisticType)e.statisticParameters=w.clone(g)};k.clone=function(){return new c({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,
statisticType:this.statisticType,statisticParameters:w.clone(this.statisticParameters)})};return f}(C.JSONSupport);t.__decorate([y.property({type:Number,json:{write:!0}})],C.prototype,"maxPointCount",void 0);t.__decorate([y.property({type:Number,json:{write:!0}})],C.prototype,"maxRecordCount",void 0);t.__decorate([y.property({type:Number,json:{write:!0}})],C.prototype,"maxVertexCount",void 0);t.__decorate([y.property({type:String,json:{write:!0}})],C.prototype,"onStatisticField",void 0);t.__decorate([y.property({type:String,
json:{write:!0}})],C.prototype,"outStatisticFieldName",void 0);t.__decorate([y.property({type:String,json:{read:{source:"statisticType",reader:H.read},write:{target:"statisticType",writer:H.write}}})],C.prototype,"statisticType",void 0);t.__decorate([y.property({type:Object})],C.prototype,"statisticParameters",void 0);t.__decorate([h.writer("statisticParameters")],C.prototype,"writeStatisticParameters",null);return C=c=t.__decorate([m.subclass("esri.rest.support.StatisticDefinition")],C)})},"esri/views/2d/layers/features/sources/DataTileSubscription":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/CircularArray ../../../../../core/has ../../../../../core/maybe ../support/FeatureSetReaderJSON ../support/UpdateToken".split(" "),
function(u,t,H,C,w,y,x){let m=function(){function h(d,f){this.requests={done:[],stream:new H(10)};this._edits=null;this._abortController=new AbortController;this._version=0;this.didSend=this._done=!1;this.tile=d;this._version=f}var c=h.prototype;c.end=function(){this._done=!0};c.clear=function(){this.requests.done=[]};c.applyUpdate=function(d){this.requests.done.forEach(f=>f.message.status.unset(d));this._version=d.version;w.isSome(this._edits)&&this._edits.status.unset(d)};c.add=function(d){d.message.status=
d.message.status??x.UpdateToken.empty();d.message.status.version=this._version;C("esri-2d-update-debug")&&console.debug(this.tile.id,"DataTileSubscription:add",this._version);d.message.end&&this.requests.done.forEach(f=>{w.isSome(f.message)&&f.message.end&&(f.message.end=!1)});this.requests.done.push(d)};c.edit=function(d,f){const k=d.getQuantizationTransform(),g=d.fullSchema(),e=Array.from(d.features()).filter(w.isSome),a=e.map(b=>b.objectId);f=[...f,...a];this.removeIds(f);this._invalidate();w.isNone(this._edits)?
this._edits={type:"append",addOrUpdate:y.FeatureSetReaderJSON.fromOptimizedFeatures(e,g,w.unwrap(k)),id:this.tile.id,status:x.UpdateToken.empty(),end:!0}:(this.requests.done.forEach(b=>b.message.end=!1),w.unwrap(this._edits.addOrUpdate).append(d.features()))};c.readers=function*(){for(const {message:d}of this.requests.done)w.isSome(d.addOrUpdate)&&(yield d.addOrUpdate);w.isSome(this._edits)&&w.isSome(this._edits.addOrUpdate)&&(yield this._edits.addOrUpdate)};c._invalidate=function(){for(const d of this.requests.done)d.message.status=
x.UpdateToken.empty();w.isSome(this._edits)&&(this._edits.status=x.UpdateToken.empty())};c.removeIds=function(d){this._invalidate();for(const {message:f}of this.requests.done){const k=f.addOrUpdate;w.isSome(k)&&(k.removeIds(d),k.isEmpty&&(C("esri-2d-update-debug")&&console.debug("Removing FeatureSetReader"),f.addOrUpdate=null))}w.isSome(this._edits)&&w.isSome(this._edits.addOrUpdate)&&this._edits.addOrUpdate.removeIds(d);this.requests.done=this.requests.done.filter(f=>f.message.addOrUpdate||f.message.end)};
c.abort=function(){this._abortController.abort()};t._createClass(h,[{key:"signal",get:function(){return this._abortController.signal}},{key:"options",get:function(){return{signal:this._abortController.signal}}},{key:"empty",get:function(){return!this.requests.done.length&&w.isNone(this.edits)}},{key:"edits",get:function(){return this._edits}},{key:"done",get:function(){return this._done}}]);return h}();u.DataTileSubscription=m;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/UpdateToken":function(){define(["exports"],
function(u){let t=function(){function H(){this.version=0;this.source=!1;this.targets={feature:!1,aggregate:!1};this.storage={filters:!1,data:!1};this.queryFilter=this.mesh=!1;this.why={mesh:[],source:[]}}H.create=function(w){const y=new H;for(const x in w){const m=w[x];if("object"===typeof m)for(const h in m)y[x][h]=m[h];y[x]=m}return y};H.empty=function(){return H.create({})};H.all=function(){return H.create({source:!0,targets:{feature:!0,aggregate:!0},storage:{filters:!0,data:!0},mesh:!0})};var C=
H.prototype;C.unset=function(w){this.version=w.version;w.source&&(this.source=!1);w.targets.feature&&(this.targets.feature=!1);w.targets.aggregate&&(this.targets.aggregate=!1);w.storage.filters&&(this.storage.filters=!1);w.storage.data&&(this.storage.data=!1);w.mesh&&(this.mesh=!1);w.queryFilter&&(this.queryFilter=!1)};C.any=function(){return this.source||this.mesh||this.storage.filters||this.storage.data||this.targets.feature||this.targets.aggregate||this.queryFilter};C.describe=function(){let w=
0,y="";if(this.mesh){w+=20;y+="-\x3e (20) Mesh needs update\n";for(const x of this.why.mesh)y+=`    + ${x}\n`}if(this.source){w+=10;y+="-\x3e (10) The source needs update\n";for(const x of this.why.source)y+=`    + ${x}\n`}this.targets.feature&&(w+=5,y+="-\x3e (5) Feature target parameters changed\n");this.storage.filters&&(w+=5,y+="-\x3e (5) Feature filter parameters changed\n");this.targets.aggregate&&(w+=4,y+="-\x3e (4) Aggregate target parameters changed\n");this.storage.data&&(w+=1,y+="-\x3e (1) Texture storage parameters changed");
console.debug(`Applying ${5>w?"Fastest":10>w?"Fast":15>w?"Moderate":20>w?"Slow":"Very Slow"} update of cost ${w}/45 `);console.debug(y)};C.toJSON=function(){return{queryFilter:this.queryFilter,source:this.source,targets:this.targets,storage:this.storage,mesh:this.mesh}};return H}();u.UpdateToken=t;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/QueueProcessor":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/maybe ../../core/promiseUtils ../../core/Queue ../../core/scheduling".split(" "),
function(u,t,H,C,w,y){let x=function(h,c){this.item=h;this.controller=c;this.promise=null},m=function(){function h(d){this._deferreds=new Map;this._controllers=new Map;this._processingItems=new Map;this._isPaused=!1;this._task=this._schedule=null;this.concurrency=1;d.concurrency&&(this.concurrency=d.concurrency);this._queue=new w(d.peeker);this.process=d.process;const f=d.scheduler;d.priority&&H.isSome(f)&&(this._task=f.registerTask(d.priority,this))}var c=h.prototype;c.destroy=function(){this.clear();
this._schedule&&(this._schedule.remove(),this._schedule=null);this._task&&(this._task.remove(),this._task=null)};c.abort=function(d){(d=this._controllers.get(d))&&d.abort()};c.clear=function(){this._queue.clear();const d=[];this._controllers.forEach(f=>d.push(f));this._controllers.clear();d.forEach(f=>f.abort());this._processingItems.clear();this._cancelNext()};c.forEach=function(d){this._deferreds.forEach((f,k)=>d(k))};c.get=function(d){return(d=this._deferreds.get(d))?d.promise:void 0};c.isOngoing=
function(d){return this._processingItems.has(d)};c.has=function(d){return this._deferreds.has(d)};c.pause=function(){this._isPaused||(this._isPaused=!0,this._cancelNext())};c.push=function(d,f){const k=this.get(d);if(k)return k;const g=new AbortController;let e=null;f&&(e=C.onAbort(f,()=>g.abort()));const a=()=>{b.remove();H.isSome(e)&&e.remove();this._deferreds.delete(d);this._controllers.delete(d);this._queue.remove(d);this._processingItems.delete(d);this._scheduleNext()},b=C.onAbortOrThrow(g.signal,
()=>{const q=this._processingItems.get(d);q&&q.controller.abort();a();l.reject(C.createAbortError())}),l=C.createDeferred();this._deferreds.set(d,l);this._controllers.set(d,g);l.promise.then(a,a);this._queue.push(d);this._scheduleNext();return l.promise};c.last=function(){return this._queue.last()};c.peek=function(){return this._queue.peek()};c.popLast=function(){return this._queue.popLast()};c.reset=function(){const d=[];this._processingItems.forEach(f=>d.push(f));this._processingItems.clear();for(const f of d)this._queue.push(f.item),
f.controller.abort();this._scheduleNext()};c.resume=function(){this._isPaused&&(this._isPaused=!1,this._scheduleNext())};c.takeAll=function(){const d=[];for(;this._queue.length;)d.push(this._queue.pop());this.clear();return d};c.runTask=function(d){for(;!d.done&&0<this._queue.length&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop()),d.madeProgress()};c._scheduleNext=function(){this._task||this._isPaused||this._schedule||(this._schedule=y.schedule(()=>{this._schedule=null;
this._next()}))};c._next=function(){for(;0<this._queue.length&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())};c._cancelNext=function(){this._schedule&&(this._schedule.remove(),this._schedule=null)};c._processResult=function(d,f){this._canProcessFulfillment(d)&&(this._scheduleNext(),this._deferreds.get(d.item).resolve(f))};c._processError=function(d,f){this._canProcessFulfillment(d)&&(this._scheduleNext(),this._deferreds.get(d.item).reject(f))};c._canProcessFulfillment=
function(d){return this._deferreds.get(d.item)&&this._processingItems.get(d.item)===d?!0:!1};c._process=function(d){if(!H.isNone(d)){var f=new AbortController,k=new x(d,f);this._processingItems.set(d,k);try{var g=this.process(d,f.signal)}catch(e){this._processError(k,e)}C.isPromiseLike(g)?(k.promise=g,g.then(e=>this._processResult(k,e),e=>this._processError(k,e))):this._processResult(k,g)}};t._createClass(h,[{key:"length",get:function(){return this._processingItems.size+this._queue.length}},{key:"running",
get:function(){return!this._isPaused&&0<this._queue.length&&this._processingItems.size<this.concurrency}},{key:"test",get:function(){return{update:d=>this.runTask(d)}}}]);return h}();u.QueueProcessor=m;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/sources/PagedFeatureSource":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/promiseUtils ./BaseFeatureSource".split(" "),
function(u,t,H,C,w,y,x){x=function(m){function h(d){return m.call(this,d)||this}t._inheritsLoose(h,m);var c=h.prototype;c._fetchDataTile=function(){var d=t._asyncToGenerator(function*(f){const k=this._subscriptions.get(f.key.id);let g=!1,e=0,a=0;const b=(n,v)=>{a--;y.throwIfAborted(k);const B=f.id,z=n.reader;n=n.query;z.exceededTransferLimit?(v={id:B,addOrUpdate:z,end:g&&0===a,type:"append"},k.add({message:v,query:n}),this._onMessage(v)):(g=!0,v={id:B,addOrUpdate:z,end:0===a,type:"append"},k.add({message:v,
query:n}),this._onMessage(v))};let l=0,q=0;for(;!g&&20>q++;){let n;for(let v=0;v<l+1;v++){const B=e++;a++;n=this._fetchDataTilePage(f,B,k).then(z=>z&&b(z,B)).catch(z=>{g=!0;y.isAbortError(z)||(C.getLogger("esri.views.2d.layers.features.sources.PagedFeatureSource").error(new H("mapview-query-error","Encountered error when fetching tile",{tile:f,error:z})),this._onMessage({id:f.id,addOrUpdate:null,end:g,type:"append"}))})}yield n;y.throwIfAborted(k);l=Math.min(l+2,6)}});return function(f){return d.apply(this,
arguments)}}();c._fetchDataTilePage=function(){var d=t._asyncToGenerator(function*(f,k,g){y.throwIfAborted(g);const e=this._queryInfo;var a={start:this.pageSize*k,num:this.pageSize,returnExceededLimitFeatures:!0,quantizationParameters:f.getQuantizationParameters()};w.isSome(this.maxRecordCountFactor)&&(a.maxRecordCountFactor=this.maxRecordCountFactor);a=this.createTileQuery(f,a);try{const b=yield this._queue.push({tile:f,query:a,signal:g.signal,depth:k});y.throwIfAborted(g);return b?e!==this._queryInfo?
this._fetchDataTilePage(f,k,g):{reader:b,query:a}:null}catch(b){return y.throwIfNotAbortError(b),null}});return function(f,k,g){return d.apply(this,arguments)}}();return h}(x.BaseFeatureSource);u.PagedFeatureSource=x;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/sources/SnapshotFeatureSource":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/RandomLCG ./BaseFeatureSource ../support/FeatureSetReaderPBFIndirect ../support/UpdateToken".split(" "),
function(u,t,H,C,w,y,x,m,h,c){function d(k,g,e){var a=k.getXHydrated();k=k.getYHydrated();a=g.getColumnForX(a);a=Math.floor(g.normalizeCol(a));g=Math.floor(g.getRowForY(k));return`${e}/${g}/${a}`}function f(k,g){if(w.isNone(k))return null;g=g.transform;const e=k.getQuantizationTransform();if(w.isNone(e)){const [p,r]=g.scale,[D,J]=g.translate;return k.transform(-D/p,J/r,1/p,1/-r)}const [a,b]=e.scale,[l,q]=e.translate,[n,v]=g.scale,[B,z]=g.translate;return k.transform((l-B)/n,(-q+z)/v,a/n,b/v)}H=function(k){function g(a){var b=
k.call(this,a)||this;b.mode="snapshot";b._loading=!0;b._controller=new AbortController;b._downloadPromise=null;b._didSendEnd=!1;b._queries=[];b._invalidated=!1;b._hasAggregates=!1;b._random=new x(1E3);b._store=a.store;b._markedIdsBufId=b._store.storage.createBitset();return b}t._inheritsLoose(g,k);var e=g.prototype;e.destroy=function(){k.prototype.destroy.call(this);this._controller.abort()};e.update=function(a,b){k.prototype.update.call(this,a,b);null==this._featureCount&&(this._featureCount=b.initialFeatureCount);
w.isSome(b.changedFeatureCount)&&(this._featureCount=b.changedFeatureCount);this._hasAggregates=!!a.targets?.aggregate};e.resend=function(){var a=t._asyncToGenerator(function*(b=!1){yield this._downloadPromise;this._invalidated||b?(b=w.unwrapOrThrow(this._featureCount,"Expected featureCount to be defined"),this._invalidated=!1,this._subscriptions.forEach(l=>l.clear()),this._downloadPromise=this._download(b),yield this._downloadPromise):(b=this._queries.map(({query:l,reader:q})=>this._sendPatchQuery(l,
q)),yield Promise.all(b),this._subscriptions.forEach(l=>{l.requests.done.forEach(q=>this._onMessage(q.message))}))});return function(){return a.apply(this,arguments)}}();e.refresh=function(){var a=t._asyncToGenerator(function*(b,l){l&&(this._featureCount=l.featureCount);yield this.resend(!0)});return function(b,l){return a.apply(this,arguments)}}();e._sendPatchQuery=function(){var a=t._asyncToGenerator(function*(b,l){const q=w.isSome(b.outFields)?b.outFields:[],n=this._queryInfo.outFields,v=n.filter(p=>
!q.includes(p));if(v.length){var B=b.clone(),z=this._signal;B.returnGeometry=!1;B.returnCentroid=!1;B.outFields=v;b.outFields=n;b=yield this._queue.push({query:B,depth:0,signal:z});y.throwIfAborted({signal:z});l.joinAttributes(b)}});return function(b,l){return a.apply(this,arguments)}}();e._fetchDataTile=function(){var a=t._asyncToGenerator(function*(b){if(!this._downloadPromise){var l=w.unwrapOrThrow(this._featureCount,"Expected featureCount to be defined");this._downloadPromise=this._download(l)}var q=
this._store.search(b);l=this._subscriptions.get(b.key.id);const n=q.length-1;for(let B=0;B<n;B++){var v=f(q[B],b);v={type:"append",id:b.id,addOrUpdate:v,end:!1,status:c.UpdateToken.empty()};l.add({query:null,message:v});this._hasAggregates||(yield y.after(1));this._onMessage(v)}q=f(0<=n?q[n]:null,b);b={type:"append",id:b.id,addOrUpdate:q,end:this._didSendEnd,status:c.UpdateToken.empty()};l.add({query:null,message:b});this._onMessage(b)});return function(b){return a.apply(this,arguments)}}();e._download=
function(){var a=t._asyncToGenerator(function*(b){try{yield this.whenInitialized();const l=this._store.storage.getBitset(this._markedIdsBufId),q=new Set;l.clear();const n=Array.from({length:Math.ceil(b/this.pageSize)},(v,B)=>B).sort((v,B)=>this._random.getInt()-this._random.getInt()).map(v=>this._downloadPage(v,l,q));yield Promise.all(n);this._store.sweepFeatures(l,this._store.storage);this._store.sweepFeatureSets(q)}catch(l){C.getLogger("esri.views.2d.layers.features.sources.SnapshotFeatureSource").error("mapview-snapshot-source",
"Encountered and error when downloading feature snapshot",l)}this._sendEnd();this._loading=!1});return function(b){return a.apply(this,arguments)}}();e._downloadPage=function(){var a=t._asyncToGenerator(function*(b,l,q){var n=this.pageSize;n={start:b*n,num:n,cacheHint:!0};w.isSome(this.maxRecordCountFactor)&&(n.maxRecordCountFactor=this.maxRecordCountFactor);n=this.createQuery(n);const v=this._signal;b=yield this._queue.push({query:n,depth:b,signal:v});y.throwIfAborted({signal:v});this._queries.push({query:n,
reader:b});this._store.insert(b);q.add(b.instance);for(q=b.getCursor();q.next();)l.set(q.getDisplayId());this._send(b)});return function(b,l,q){return a.apply(this,arguments)}}();e._send=function(a){if(this._subscriptions.size){var b=null,l=new Map,q=new Set,n=new Map;this._subscriptions.forEach(B=>{var z=B.tile;l.set(z.key.id,null);b=z.tileInfoView;q.add(z.level);const {row:p,col:r}=z.key;z=`${z.level}/${p}/${r}`;const D=n.get(z)??[];D.push(B);n.set(z,D)});for(const B of q){const z=b.getLODInfoAt(B),
p=a.getCursor();for(;p.next();){var v=d(p,z,B);const r=p.getIndex();if(n.has(v))for(const D of n.get(v)){v=D.tile.id;let J=l.get(v);w.isNone(J)&&(J=[],l.set(v,J));J.push(r)}}}l.forEach((B,z)=>{if(w.isSome(B)){const p=this._subscriptions.get(z);B=f(h.FeatureSetReaderIndirect.from(a,B),p.tile);z={type:"append",id:z,addOrUpdate:B,end:!1,status:c.UpdateToken.empty()};p.add({query:null,message:z});this._onMessage(z)}})}};e._sendEnd=function(){this._subscriptions.forEach(a=>{const b={type:"append",id:a.tile.id,
addOrUpdate:null,end:!0,status:c.UpdateToken.empty()};a.add({query:null,message:b});this._onMessage(b)});this._didSendEnd=!0};t._createClass(g,[{key:"loading",get:function(){return this._loading}},{key:"_signal",get:function(){return this._controller.signal}}]);return g}(m.BaseFeatureSource);u.SnapshotFeatureSource=H;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/sources/StreamSource":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/has ../../../../../core/maybe ../../../../../core/accessorSupport/decorators/property ../../../../../core/accessorSupport/ensureType ../../../../../core/arrayUtils ../../../../../core/accessorSupport/decorators/subclass ../../../../../chunks/rbush ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedGeometry ../../../../../layers/graphics/data/StreamFeatureManager ../../../../../layers/graphics/sources/connections/createConnection ./DataTileSource ../support/FeatureSetReaderJSON ../support/UpdateToken".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f,k,g,e,a,b){function l(B,z){const p=B.weakClone();if(w.isSome(B.geometry)){const r=d.quantizeX(z,B.geometry.coords[0]);B=d.quantizeY(z,B.geometry.coords[1]);p.geometry=new f([],[r,B])}return p}function q(B){switch(B){case "esriGeometryPoint":return l;default:return(z,p)=>{const r=z.weakClone(),D=new f;z=d.quantizeOptimizedGeometry(D,z.geometry,!1,!1,B,p,!1,!1);r.geometry=z;return r}}}function n(B){switch(B){case "esriGeometryPoint":return z=>w.isSome(z.geometry)?{minX:z.geometry.coords[0],
minY:z.geometry.coords[1],maxX:z.geometry.coords[0],maxY:z.geometry.coords[1]}:{minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity};default:return z=>{let p=Infinity,r=Infinity,D=-Infinity,J=-Infinity;w.isSome(z.geometry)&&z.geometry.forEachVertex((K,F)=>{p=Math.min(p,K);r=Math.min(r,F);D=Math.max(D,K);J=Math.max(J,F)});return{minX:p,minY:r,maxX:D,maxY:J}}}}let v=function(){function B(p,r){this.onUpdate=p;this._geometryType=r;this._objectIdToFeature=new Map;this._index=null}var z=B.prototype;
z.add=function(p){this._objectIdToFeature.set(p.objectId,p);this._index=null};z.get=function(p){return this._objectIdToFeature.has(p)?this._objectIdToFeature.get(p):null};z.forEach=function(p){this._objectIdToFeature.forEach(p)};z.search=function(p){if(!this._index){var r=this._features;const D=c.rbush(9,n(this._geometryType));D.load(r);this._index=D}return this._index.search({minX:p.bounds[0],minY:p.bounds[1],maxX:p.bounds[2],maxY:p.bounds[3]})};z.clear=function(){this._index=null;this._objectIdToFeature.clear()};
z.removeById=function(p){const r=this._objectIdToFeature.get(p);return r?(this._objectIdToFeature.delete(p),this._index=null,r):null};z.update=function(p,r){this.onUpdate(p,r)};t._createClass(B,[{key:"_features",get:function(){const p=[];this._objectIdToFeature.forEach(r=>p.push(r));return p}},{key:"size",get:function(){return this._objectIdToFeature.size}}]);return B}();u.StreamSource=function(B){function z(r){var D=B.call(this,r)||this;D.type="stream";D._updateIntervalId=0;D._level=0;D._updateInfo=
{websocket:0,client:0};D._isPaused=!1;D._inUpdate=!1;var {outSR:J}=r;const {geometryType:K,objectIdField:F,timeInfo:A,purgeOptions:I,source:G,spatialReference:E,serviceFilter:M,maxReconnectionAttempts:T,maxReconnectionInterval:Y,updateInterval:fa,customParameters:ba,enabledEventTypes:U}=r.serviceInfo,P=new v(D._onUpdate.bind(t._assertThisInitialized(D)),K),Q=new k.StreamFeatureManager(P,F,A,I);J=g.createConnection(G,E,J,K,M,T,Y,ba??{});D._store=P;D._manager=Q;D._connection=J;D._quantize=q(K);D._enabledEventTypes=
new Set(U);D._handles=[D._connection.on("data-received",Z=>D._onFeature(Z)),D._connection.on("message-received",Z=>D._onWebSocketMessage(Z))];D._initUpdateInterval=()=>{let Z=performance.now();D._updateIntervalId=setInterval(()=>{var X=performance.now(),sa=X-Z;2500<sa&&(Z=X,X=Math.round(D._updateInfo.client/(sa/1E3)),sa=Math.round(D._updateInfo.websocket/(sa/1E3)),D._updateInfo.client=0,D._updateInfo.websocket=0,D.events.emit("updateRate",{client:X,websocket:sa}));r.canAcceptRequest()&&!D._inUpdate&&
D._manager.checkForUpdates()},fa)};D._initUpdateInterval();return D}t._inheritsLoose(z,B);var p=z.prototype;p.destroy=function(){B.prototype.destroy.call(this);this._clearUpdateInterval();this._handles.forEach(r=>r.remove());this._connection.destroy()};p._fetchDataTile=function(){};p.updateCustomParameters=function(r){this._connection.updateCustomParameters(r)};p.pauseStream=function(){this._isPaused||(this._isPaused=!0,this._clearUpdateInterval())};p.resumeStream=function(){this._isPaused&&(this._isPaused=
!1,this._initUpdateInterval())};p.sendMessageToSocket=function(r){this._connection.sendMessageToSocket(r)};p.sendMessageToClient=function(r){this._connection.sendMessageToClient(r)};p.enableEvent=function(r,D){D?this._enabledEventTypes.add(r):this._enabledEventTypes.delete(r)};p.subscribe=function(r,D){B.prototype.subscribe.call(this,r,D);D=this._subscriptions.get(r.id);this._level=r.level;const J=this._getTileFeatures(r);this._onMessage({type:"append",id:r.key.id,addOrUpdate:J,end:!0});D.didSend=
!0};p.unsubscribe=function(r){B.prototype.unsubscribe.call(this,r)};p.readers=function*(r){r=this._subscriptions.get(r);({tile:r}=r);yield this._getTileFeatures(r)};p.createTileQuery=function(r){throw Error("Service does not support tile  queries");};p.resend=function(){var r=t._asyncToGenerator(function*(){this._subscriptions.forEach(D=>{({tile:D}=D);D={type:"append",id:D.id,addOrUpdate:this._getTileFeatures(D),end:!0};this._onMessage(D)})});return function(){return r.apply(this,arguments)}}();p._getTileFeatures=
function(r){const D=this._store.search(r).map(J=>this._quantize(J,r.transform));return a.FeatureSetReaderJSON.fromOptimizedFeatures(D,this._serviceInfo,r.transform)};p._onWebSocketMessage=function(r){this._enabledEventTypes.has("message-received")&&this.events.emit("message-received",r);if("type"in r)switch(r.type){case "delete":if(r.objectIds)for(const D of r.objectIds)this._manager.removeById(D);if(r.trackIds)for(const D of r.trackIds)this._manager.removeByTrackId(D);break;case "clear":this._store.forEach(D=>
this._manager.removeById(D.objectId))}};p._onFeature=function(r){this._updateInfo.websocket++;try{this._enabledEventTypes.has("data-received")&&this.events.emit("data-received",r);const D=d.convertFromFeature(r,this._serviceInfo.geometryType,!1,!1,this._serviceInfo.objectIdField);this._manager.add(D)}catch(D){}};p._clearUpdateInterval=function(){clearInterval(this._updateIntervalId);this._updateIntervalId=0};p._onUpdate=function(){var r=t._asyncToGenerator(function*(D,J){this._inUpdate=!0;try{w.isSome(D)&&
(this._updateInfo.client+=D.length);this._subscriptions.forEach((F,A)=>{F.didSend&&F.tile.level===this._level&&this._onMessage({type:"append",id:A,addOrUpdate:null,clear:!0,end:!1})});const K=[];this._subscriptions.forEach((F,A)=>{if(F.didSend&&F.tile.level===this._level){var I=this._getTileFeatures(F.tile);A={type:"append",id:A,addOrUpdate:I,remove:[],end:!1,status:b.UpdateToken.empty()};F.requests.stream.enqueue(A);K.push(this._onMessage(A))}});yield Promise.all(K);this._subscriptions.forEach((F,
A)=>{F.didSend&&F.tile.level===this._level&&this._onMessage({type:"append",id:A,addOrUpdate:null,end:!0})})}catch{}this._inUpdate=!1});return function(D,J){return r.apply(this,arguments)}}();t._createClass(z,[{key:"connectionStatus",get:function(){return this._isPaused?"paused":this._connection?.connectionStatus}},{key:"errorString",get:function(){return this._connection?.errorString}},{key:"updating",get:function(){return!1}}]);return z}(e.DataTileSource);H.__decorate([y.property()],u.StreamSource.prototype,
"_isPaused",void 0);H.__decorate([y.property()],u.StreamSource.prototype,"connectionStatus",null);H.__decorate([y.property()],u.StreamSource.prototype,"errorString",null);u.StreamSource=H.__decorate([h.subclass("esri.views.2d.layers.features.sources")],u.StreamSource);Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/StreamFeatureManager":function(){define(["exports","../../../core/CircularArray","../../../core/mathUtils","../../../core/maybe"],function(u,
t,H,C){let w=function(){function y(m,h,c,d,f=128){this._trackIdToObservations=new Map;this._idCounter=0;this._lastPurge=performance.now();this._addOrUpdated=new Map;this._removed=[];this._maxAge=0;this._timeInfo=c;this._purgeOptions=d;this.store=m;this.objectIdField=h;this.purgeInterval=f;this._useGeneratedIds="__esri_stream_id__"===this.objectIdField}var x=y.prototype;x.removeById=function(m){this._removed.push(m)};x.removeByTrackId=function(m){if(m=this._trackIdToObservations.get(m))for(const h of m.entries)this._removed.push(h)};
x.add=function(m){if(this._useGeneratedIds){var h=this._nextId();m.attributes[this.objectIdField]=h;m.objectId=h}else m.objectId=m.attributes[this.objectIdField];h=m.objectId;this._addOrUpdated.set(h,m);this._maxAge=Math.max(this._maxAge,m.attributes[this._timeInfo.startTimeField]);if(this._timeInfo.trackIdField){m=m.attributes[this._timeInfo.trackIdField];if(!this._trackIdToObservations.has(m)){var c=C.isSome(this._purgeOptions)&&null!=this._purgeOptions.maxObservations?this._purgeOptions.maxObservations:
1E3;c=H.clamp(c,0,1E3);this._trackIdToObservations.set(m,new t(c))}h=this._trackIdToObservations.get(m)?.enqueue(h);C.isSome(h)&&(this._addOrUpdated.has(h)?this._addOrUpdated.delete(h):this._removed.push(h))}else C.isNone(this._trackIdLessObservations)&&(this._trackIdLessObservations=new t(1E5)),this._trackIdLessObservations.enqueue(h)};x.checkForUpdates=function(){const m=this._getToAdd();var h=this._getToRemove();const c=performance.now();c-this._lastPurge>=this.purgeInterval&&(this._purge(c),this._lastPurge=
c);const d=[];if(C.isSome(h))for(var f of h){const k=this.store.removeById(f);C.isSome(k)&&d.push(k)}f=[];if(C.isSome(m)){h=new Set(C.unwrapOr(h,[]));for(const k of m)h.has(k.objectId)||(k.attributes.__esri_timestamp__=c,this.store.add(k),f.push(k))}(f.length||d?.length)&&this.store.update(f,d)};x._getToAdd=function(){if(!this._addOrUpdated.size)return null;const m=Array(this._addOrUpdated.size);let h=0;this._addOrUpdated.forEach(c=>m[h++]=c);this._addOrUpdated.clear();return m};x._getToRemove=function(){const m=
this._removed;if(!this._removed.length)return null;this._removed=[];return m};x._nextId=function(){const m=this._idCounter;this._idCounter=(this._idCounter+1)%4294967294+1;return m};x._purge=function(m){const h=this._purgeOptions;C.isSome(h)&&(this._purgeSomeByDisplayCount(h),this._purgeByAge(h),this._purgeByAgeReceived(m,h),this._purgeTracks())};x._purgeSomeByDisplayCount=function(m){if(m.displayCount){var h=this.store.size;if(h>m.displayCount){if(this._timeInfo.trackIdField)for(const c of this._trackIdToObservations.values())if(h>
m.displayCount&&c.size){const d=C.unwrap(c.dequeue());this._removed.push(d);h--}if(C.isSome(this._trackIdLessObservations))for(m=h-m.displayCount;0<m--;)h=this._trackIdLessObservations.dequeue(),C.isSome(h)&&this._removed.push(h)}}};x._purgeByAge=function(m){const h=this._timeInfo?.startTimeField;if(m.age&&h){var c=this._maxAge-6E4*m.age;this.store.forEach(d=>{d.attributes[h]<c&&this._removed.push(d.objectId)})}};x._purgeByAgeReceived=function(m,h){if(h.ageReceived){var c=m-6E4*h.ageReceived;this.store.forEach(d=>
{d.attributes.__esri_timestamp__<c&&this._removed.push(d.objectId)})}};x._purgeTracks=function(){this._trackIdToObservations.forEach((m,h)=>{0===m.size&&this._trackIdToObservations.delete(h)})};return y}();u.DEFAULT_STREAM_ID_FIELD="__esri_stream_id__";u.ESRI_TIMESTAMP="__esri_timestamp__";u.StreamFeatureManager=w;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/sources/connections/createConnection":function(){define(["exports","./GeoEventConnection","./WebSocketConnection",
"../../../support/ClientSideConnection"],function(u,t,H,C){u.createConnection=function(w,y,x,m,h,c,d,f){y={source:w,sourceSpatialReference:y,spatialReference:x,geometryType:m,filter:h,maxReconnectionAttempts:c,maxReconnectionInterval:d,customParameters:f};return w?w.path.startsWith("wss://")||w.path.startsWith("ws://")?new H.WebSocketConnection(y):new t(y):new C.ClientSideConnection(y)};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/sources/connections/GeoEventConnection":function(){define("require ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../request ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/urlUtils ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/decorators/subclass ./WebSocketConnection ../../../../rest/query/operations/query ../../../../rest/support/Query ../../../../geometry/support/jsonUtils ../../../../geometry/SpatialReference".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f,k,g,e,a,b,l,q){const n={maxQueryDepth:5,maxRecordCountFactor:3};C=function(v){function B(p){p=v.call(this,{...n,...p})||this;p._buddyServicesQuery=null;p._relatedFeatures=null;return p}t._inheritsLoose(B,v);var z=B.prototype;z._open=function(){var p=t._asyncToGenerator(function*(){var r=yield this._fetchServiceDefinition(this._config.source);r.timeInfo.trackIdField||x.getLogger(this.declaredClass).warn("GeoEvent service was configured without a TrackIdField. This may result in certain functionality being disabled. The purgeOptions.maxObservations property will have no effect.");
r=this._fetchWebSocketUrl(r.streamUrls,this._config.spatialReference);this._buddyServicesQuery||(this._buddyServicesQuery=this._queryBuddyServices());yield this._buddyServicesQuery;yield this._tryCreateWebSocket(r);const {filter:D,outFields:J}=this._config;this.destroyed||this._setFilter(D,J)});return function(){return p.apply(this,arguments)}}();z._onMessage=function(p){if("attributes"in p){let r;try{r=this._enrich(p),m.isSome(this._featureZScaler)&&this._featureZScaler(r.geometry)}catch(D){x.getLogger(this.declaredClass).error(new y("geoevent-connection",
"Failed to parse message",D));return}this.onFeature(r)}else this.onMessage(p)};z._fetchServiceDefinition=function(){var p=t._asyncToGenerator(function*(r){return this._serviceDefinition=r=(yield w(r.path,{query:{f:"json",...this._config.customParameters},responseType:"json"})).data});return function(r){return p.apply(this,arguments)}}();z._fetchWebSocketUrl=function(p,r){const {urls:D,token:J}=p[0];p=this._inferWebSocketBaseUrl(D);return c.addQueryParameters(`${p}/subscribe`,{outSR:""+r.wkid,token:J})};
z._inferWebSocketBaseUrl=function(p){if(1===p.length)return p[0];for(const r of p)if(r.includes("wss"))return r;x.getLogger(this.declaredClass).error(new y("geoevent-connection","Unable to infer WebSocket url",p));return null};z._setFilter=function(){var p=t._asyncToGenerator(function*(r,D){const J=this._websocket;if(!(m.isNone(J)||m.isNone(r)&&m.isNone(D))){r=JSON.stringify({filter:this._serializeFilter(r,D)});var K=!1,F=h.createResolver();J.onmessage=A=>{A=JSON.parse(A.data);A.filter&&(A.error&&
(x.getLogger(this.declaredClass).error(new y("geoevent-connection","Failed to set service filter",A.error)),this._set("errorString",`Could not set service filter - ${A.error}`),F.reject(A.error)),this._setWebSocketJSONParseHandler(J),K=!0,F.resolve())};J.send(r);setTimeout(()=>{K||(this.destroyed||this._websocket!==J||x.getLogger(this.declaredClass).error(new y("geoevent-connection","Server timed out when setting filter")),F.reject())},1E4);return F.promise}});return function(r,D){return p.apply(this,
arguments)}}();z._serializeFilter=function(p,r){const D={};if(m.isNone(p)&&m.isNone(r))return D;if(m.isSome(p)&&p.geometry)try{const J=l.fromJSON(p.geometry);if("extent"!==J.type)throw new y(`Expected extent but found type ${J.type}`);D.geometry=JSON.stringify(J.shiftCentralMeridian())}catch(J){x.getLogger(this.declaredClass).error(new y("geoevent-connection","Encountered an error when setting connection geometryDefinition",J))}m.isSome(p)&&p.where&&"1 \x3d 1"!==p.where&&"1\x3d1"!==p.where&&(D.where=
p.where);m.isSome(r)&&(D.outFields=r.join(","));return D};z._enrich=function(p){if(!this._relatedFeatures)return p;const r=this._relatedFeatures.get(p.attributes[this._serviceDefinition.relatedFeatures.joinField]);if(!r)return x.getLogger(this.declaredClass).warn("geoevent-connection","Feature join failed. Is the join field configured correctly?",p),p;const {attributes:D,geometry:J}=r;for(const K in D)p.attributes[K]=D[K];J&&(p.geometry=J);p.geometry||p.centroid||x.getLogger(this.declaredClass).error(new y("geoevent-connection",
"Found malformed feature - no geometry found",p));return p};z._queryBuddyServices=function(){var p=t._asyncToGenerator(function*(){try{const {relatedFeatures:r,keepLatestArchive:D}=this._serviceDefinition,J=this._queryRelatedFeatures(r),K=this._queryArchive(D);yield J;const F=yield K;if(F)for(const A of F.features)this.onFeature(this._enrich(A))}catch(r){x.getLogger(this.declaredClass).error(new y("geoevent-connection","Encountered an error when querying buddy services",{error:r}))}});return function(){return p.apply(this,
arguments)}}();z._queryRelatedFeatures=function(){var p=t._asyncToGenerator(function*(r){r&&(r=yield this._queryBuddy(r.featuresUrl),this._addRelatedFeatures(r))});return function(r){return p.apply(this,arguments)}}();z._queryArchive=function(){var p=t._asyncToGenerator(function*(r){if(r)return this._queryBuddy(r.featuresUrl)});return function(r){return p.apply(this,arguments)}}();z._queryBuddy=function(){var p=t._asyncToGenerator(function*(r){const D=new (yield new Promise((E,M)=>u(["../../../FeatureLayer"],
T=>E(Object.freeze(Object.defineProperty({__proto__:null,default:T},Symbol.toStringTag,{value:"Module"}))),M))).default({url:r});var {capabilities:J}=yield D.load();const K=J.query.supportsMaxRecordCountFactor,F=J.query.supportsPagination;J=J.query.supportsCentroid;const A=this._config.maxRecordCountFactor;var I=D.capabilities.query.maxRecordCount;I=K?I*A:I;const G=new b;G.outFields=m.unwrapOr(this._config.outFields,["*"]);G.where=m.unwrapOr(m.get(this._config.filter,"where"),"1\x3d1");G.returnGeometry=
!0;G.returnExceededLimitFeatures=!0;G.outSpatialReference=q.fromJSON(this._config.spatialReference);J&&(G.returnCentroid=!0);K&&(G.maxRecordCountFactor=A);if(F)return G.num=I,D.destroy(),this._queryPages(r,G);r=yield a.executeQuery(r,G,this._config.sourceSpatialReference);D.destroy();return r.data});return function(r){return p.apply(this,arguments)}}();z._queryPages=function(){var p=t._asyncToGenerator(function*(r,D,J=[],K=0){D.start=m.isSome(D.num)?K*D.num:null;const {data:F}=yield a.executeQuery(r,
D,this._config.sourceSpatialReference);if(F.exceededTransferLimit&&K<(this._config.maxQueryDepth??0))return F.features.forEach(A=>J.push(A)),this._queryPages(r,D,J,K+1);J.forEach(A=>F.features.push(A));return F});return function(r,D){return p.apply(this,arguments)}}();z._addRelatedFeatures=function(p){const r=new Map;p=p.features;const D=this._serviceDefinition.relatedFeatures.joinField;for(const J of p)r.set(J.attributes[D],J);this._relatedFeatures=r};return B}(e.WebSocketConnection);return C=H.__decorate([g.subclass("esri.layers.graphics.sources.connections.GeoEventConnection")],
C)})},"esri/layers/graphics/sources/connections/WebSocketConnection":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/urlUtils ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/accessorSupport/decorators/subclass ../../../../geometry/support/zscale ../../../support/StreamConnection".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f,k,g){var e;(function(a){a[a.CONNECTING=0]="CONNECTING";a[a.OPEN=1]="OPEN";a[a.CLOSING=2]="CLOSING";a[a.CLOSED=3]="CLOSED"})(e||(e={}));u.WebSocketConnection=function(a){function b(q){var n=a.call(this)||this;n._outstandingMessages=[];n.errorString=null;const {geometryType:v,spatialReference:B,sourceSpatialReference:z}=q;n._config=q;n._featureZScaler=k.getGeometryZScaler(v,z,B);n._open();return n}t._inheritsLoose(b,a);var l=b.prototype;l._open=function(){var q=t._asyncToGenerator(function*(){yield this._tryCreateWebSocket();
this.destroyed||(yield this._handshake())});return function(){return q.apply(this,arguments)}}();l.destroy=function(){a.prototype.destroy.call(this);y.isSome(this._websocket)&&(this._websocket.onopen=null,this._websocket.onclose=null,this._websocket.onerror=null,this._websocket.onmessage=null,this._websocket.close());this._websocket=null};l.sendMessageToSocket=function(q){y.isNone(this._websocket)?this._outstandingMessages.push(q):this._websocket.send(JSON.stringify(q))};l.sendMessageToClient=function(q){this._onMessage(q)};
l.updateCustomParameters=function(q){this._config.customParameters=q;y.isSome(this._websocket)&&this._websocket.close()};l._tryCreateWebSocket=function(){var q=t._asyncToGenerator(function*(n=this._config.source.path,v=1E3,B=0){try{if(!this.destroyed){var z=m.addQueryParameters(n,this._config.customParameters??{});this._websocket=yield this._createWebSocket(z);this.notifyChange("connectionStatus")}}catch(p){if(z=v/1E3,this._config.maxReconnectionAttempts&&B>=this._config.maxReconnectionAttempts)w.getLogger(this.declaredClass).error(new C("websocket-connection",
"Exceeded maxReconnectionAttempts attempts. No further attempts will be made")),this.destroy();else return w.getLogger(this.declaredClass).error(new C("websocket-connection",`Failed to connect. Attempting to reconnect in ${z}s`,p)),yield x.after(v),this._tryCreateWebSocket(n,Math.min(1.5*v,1E3*this._config.maxReconnectionInterval),B+1)}});return function(){return q.apply(this,arguments)}}();l._setWebSocketJSONParseHandler=function(q){q.onmessage=n=>{try{const v=JSON.parse(n.data);this._onMessage(v)}catch(v){w.getLogger(this.declaredClass).error(new C("websocket-connection",
"Failed to parse message, invalid JSON",{error:v}))}}};l._createWebSocket=function(q){return new Promise((n,v)=>{const B=new WebSocket(q);B.onopen=()=>{B.onopen=null;this.destroyed?(B.onclose=null,B.close()):(B.onclose=z=>this._onClose(z),B.onerror=z=>this._onError(z),this._setWebSocketJSONParseHandler(B),n(B))};B.onclose=z=>{B.onopen=B.onclose=null;v(z)}})};l._handshake=function(){var q=t._asyncToGenerator(function*(n=1E4){const v=this._websocket;if(!y.isNone(v)){var B=x.createResolver(),z=v.onmessage,
{filter:p,outFields:r,spatialReference:D}=this._config;B.timeout(n);v.onmessage=J=>{let K=null;try{K=JSON.parse(J.data)}catch(F){}K&&"object"===typeof K||(w.getLogger(this.declaredClass).error(new C("websocket-connection","Protocol violation. Handshake failed - malformed message",J.data)),B.reject(),this.destroy());K.spatialReference?.wkid!==D?.wkid&&(w.getLogger(this.declaredClass).error(new C("websocket-connection",`Protocol violation. Handshake failed - expected wkid of ${D.wkid}`,J.data)),B.reject(),
this.destroy());"json"!==K.format&&(w.getLogger(this.declaredClass).error(new C("websocket-connection","Protocol violation. Handshake failed - format is not set",J.data)),B.reject(),this.destroy());p&&K.filter!==p&&w.getLogger(this.declaredClass).error(new C("websocket-connection","Tried to set filter, but server doesn't support it"));r&&K.outFields!==r&&w.getLogger(this.declaredClass).error(new C("websocket-connection","Tried to set outFields, but server doesn't support it"));v.onmessage=z;for(const F of this._outstandingMessages)v.send(JSON.stringify(F));
this._outstandingMessages=[];B.resolve()};v.send(JSON.stringify({filter:p,outFields:r,format:"json",spatialReference:{wkid:D.wkid}}));return B.promise}});return function(){return q.apply(this,arguments)}}();l._onMessage=function(q){this.onMessage(q);if("type"in q)switch(q.type){case "features":case "featureResult":for(const n of q.features)y.isSome(this._featureZScaler)&&this._featureZScaler(n.geometry),this.onFeature(n)}};l._onError=function(q){this._set("errorString","Encountered an error over WebSocket connection");
w.getLogger(this.declaredClass).error("websocket-connection","Encountered an error over WebSocket connection")};l._onClose=function(q){this._websocket=null;this.notifyChange("connectionStatus");1E3!==q.code&&w.getLogger(this.declaredClass).error("websocket-connection",`WebSocket closed unexpectedly with error code ${q.code}`);this.destroyed||this._open()};t._createClass(b,[{key:"connectionStatus",get:function(){if(y.isNone(this._websocket))return"disconnected";switch(this._websocket.readyState){case e.CONNECTING:case e.OPEN:return"connected";
case e.CLOSING:case e.CLOSED:return"disconnected"}}}]);return b}(g);H.__decorate([h.property()],u.WebSocketConnection.prototype,"connectionStatus",null);H.__decorate([h.property()],u.WebSocketConnection.prototype,"errorString",void 0);u.WebSocketConnection=H.__decorate([f.subclass("esri.layers.graphics.sources.connections.WebSocketConnection")],u.WebSocketConnection);Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/StreamConnection":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Error ../../core/Evented ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass".split(" "),
function(u,t,H,C,w,y,x,m){C=function(h){function c(){return h.apply(this,arguments)||this}u._inheritsLoose(c,h);var d=c.prototype;d.destroy=function(){this.emit("destroy")};d.onFeature=function(f){this.emit("data-received",f)};d.onMessage=function(f){this.emit("message-received",f)};u._createClass(c,[{key:"connectionError",get:function(){return this.errorString?new H("stream-connection",this.errorString):null}}]);return c}(C.EventedAccessor);t.__decorate([w.property({readOnly:!0})],C.prototype,"connectionError",
null);return C=t.__decorate([m.subclass("esri.layers.support.StreamConnection")],C)})},"esri/layers/support/ClientSideConnection":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass ../../geometry/support/zscale ./StreamConnection".split(" "),function(u,t,H,C,w,y,x,m,h,c){u.ClientSideConnection=
function(d){function f(g){var e=d.call(this)||this;e.connectionStatus="connected";e.errorString=null;const {geometryType:a,spatialReference:b,sourceSpatialReference:l}=g;e._featureZScaler=h.getGeometryZScaler(a,l,b);return e}t._inheritsLoose(f,d);var k=f.prototype;k.updateCustomParameters=function(g){};k.sendMessageToSocket=function(g){};k.sendMessageToClient=function(g){if("type"in g)switch(g.type){case "features":case "featureResult":for(const e of g.features)C.isSome(this._featureZScaler)&&this._featureZScaler(e.geometry),
this.onFeature(e)}this.onMessage(g)};return f}(c);H.__decorate([w.property()],u.ClientSideConnection.prototype,"connectionStatus",void 0);H.__decorate([w.property()],u.ClientSideConnection.prototype,"errorString",void 0);u.ClientSideConnection=H.__decorate([m.subclass("esri.layers.support.ClientSideConnection")],u.ClientSideConnection);Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/AttributeStore":function(){define("require ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/accessorSupport/diffUtils ../../../../../layers/support/FieldsIndex ../../../engine/webgl/definitions ../../../engine/webgl/DisplayId ../../../engine/webgl/Utils ../../../engine/webgl/util/debug ../tileRenderers/support/visualVariablesUtils ../../../../webgl/enums".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f,k,g,e,a){function b(z,p){return r=>p(z(r))}const l=w.getLogger("esri.views.layers.2d.features.support.AttributeStore"),q=g.createDebugLogger(g.DEBUG_ATTR_UPDATES,l);var n=C("esri-shared-array-buffer"),v=C("esri-atomics");let B=function(){function z(r,D,J,K){this.size=0;this.texelSize=4;this.dirtyEnd=this.dirtyStart=0;const {pixelType:F,layout:A,textureOnly:I}=K;this.textureOnly=I||!1;this.pixelType=F;this._ctype=D;this.layout=A;this._resetRange();this._shared=r;this.size=
J;I||(this.data=this._initData(F,J,r,D))}var p=z.prototype;p.unsetComponentAllTexels=function(r,D){const J=x.unwrap(this.data);for(let K=0;K<this.size*this.size;K++)J[K*this.texelSize+r]&=~D;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};p.setComponentAllTexels=function(r,D){const J=x.unwrap(this.data);for(let K=0;K<this.size*this.size;K++)J[K*this.texelSize+r]|=255&D;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};p.setComponent=function(r,D,J){const K=x.unwrap(this.data);for(const F of J)K[F*
this.texelSize+r]|=D,this.dirtyStart=Math.min(this.dirtyStart,F),this.dirtyEnd=Math.max(this.dirtyEnd,F)};p.setComponentTexel=function(r,D,J){x.unwrap(this.data)[J*this.texelSize+r]|=D;this.dirtyStart=Math.min(this.dirtyStart,J);this.dirtyEnd=Math.max(this.dirtyEnd,J)};p.unsetComponentTexel=function(r,D,J){x.unwrap(this.data)[J*this.texelSize+r]&=~D;this.dirtyStart=Math.min(this.dirtyStart,J);this.dirtyEnd=Math.max(this.dirtyEnd,J)};p.getData=function(r,D){r=f.getDisplayIdTexel(r);return x.unwrap(this.data)[r*
this.texelSize+D]};p.setData=function(r,D,J){r=f.getDisplayIdTexel(r);0===(this.layout&1<<D)?l.error("mapview-attributes-store","Tried to set a value for a texel's readonly component"):x.isNone(this.data)||(this.data[r*this.texelSize+D]=J,this.dirtyStart=Math.min(this.dirtyStart,r),this.dirtyEnd=Math.max(this.dirtyEnd,r))};p.lock=function(){this.pixelType===a.PixelType.UNSIGNED_BYTE&&this._shared&&v&&"local"!==this._ctype&&Atomics.store(this.data,0,1)};p.unlock=function(){this.pixelType===a.PixelType.UNSIGNED_BYTE&&
this._shared&&v&&"local"!==this._ctype&&Atomics.store(this.data,0,0)};p.expand=function(r){this.size=r;if(!this.textureOnly){r=this._initData(this.pixelType,r,this._shared,this._ctype);const D=x.unwrap(this.data);r.set(D);this.data=r}};p.toMessage=function(){const r=this.dirtyStart,D=this.dirtyEnd;var J=this.texelSize;if(r>D)return null;this._resetRange();const K=!this._shared&&"local"!==this._ctype,F=this.pixelType,A=this.layout,I=x.unwrap(this.data);J=K&&I.slice(r*J,(D+1)*J)||null;return{start:r,
end:D,data:J,pixelType:F,layout:A}};p._initData=function(r,D,J,K){J=J&&"local"!==K?SharedArrayBuffer:ArrayBuffer;r=k.getPixelArrayCtor(r);D=new r(new J(D*D*4*r.BYTES_PER_ELEMENT));for(r=0;r<D.length;r+=4)D[r+1]=255;return D};p._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};t._createClass(z,[{key:"buffer",get:function(){return x.applySome(this.data,r=>r.buffer)}}]);return z}();return function(){function z(r,D,J=()=>{}){this._client=r;this.config=D;this._notifyChange=J;this._blocks=
[];this._filters=Array(d.MAX_FILTERS);this._attributeComputeInfo=null;this._targetType=0;this._abortController=new AbortController;this._hasScaleExpr=!1;this._size=32;this._currUpdate=this._nextUpdate=null;this._idsToHighlight=new Set;r=D.supportsTextureFloat?a.PixelType.FLOAT:a.PixelType.UNSIGNED_BYTE;q(`Creating AttributeStore ${n?"with":"without"} shared memory`);this._blockDescriptors=[{pixelType:a.PixelType.UNSIGNED_BYTE,layout:1},{pixelType:a.PixelType.UNSIGNED_BYTE,layout:15,textureOnly:!0},
{pixelType:a.PixelType.UNSIGNED_BYTE,layout:15,textureOnly:!0},{pixelType:r,layout:15},{pixelType:r,layout:15},{pixelType:r,layout:15},{pixelType:r,layout:15}];this._blocks=this._blockDescriptors.map(()=>null)}var p=z.prototype;p.destroy=function(){this._abortController.abort()};p.isUpdating=function(){return!!this._currUpdate||!!this._nextUpdate};p.update=function(r,D){this.config=D;D=D.schema.processors[0].storage;const J=h.diff(this._schema,D);if(r.targets.feature||r.targets.aggregate)r.storage.data=
!0;if(J&&(C("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:",J),r.storage.data=!0,this._schema=D,this._attributeComputeInfo=null,!x.isNone(D))){switch(D.target){case "feature":this._targetType=f.DISPLAY_ID_TYPE_FEATURE;break;case "aggregate":this._targetType=f.DISPLAY_ID_TYPE_AGGREGATE}if("subtype"===D.type){this._attributeComputeInfo={isSubtype:!0,subtypeField:D.subtypeField,map:new Map};for(const K in D.mapping)if(r=D.mapping[K],x.isSome(r)&&x.isSome(r.vvMapping))for(const F of r.vvMapping)this._bindAttribute(F,
parseInt(K,10))}else{this._attributeComputeInfo={isSubtype:!1,map:new Map};if(x.isSome(D.vvMapping))for(const K of D.vvMapping)this._bindAttribute(K);if(x.isSome(D.attributeMapping))for(const K of D.attributeMapping)this._bindAttribute(K)}}};p.onTileData=function(r,D){if(!x.isNone(D.addOrUpdate))for(r=D.addOrUpdate.getCursor();r.next();)D=r.getDisplayId(),this.setAttributeData(D,r)};p.setHighlight=function(){var r=t._asyncToGenerator(function*(D,J){const K=this._getBlock(0);J=J.map(F=>f.getDisplayIdTexel(F));
K.lock();K.unsetComponentAllTexels(0,1);K.setComponent(0,1,J);K.unlock();this._idsToHighlight.clear();for(const F of D)this._idsToHighlight.add(F);yield this.sendUpdates()});return function(D,J){return r.apply(this,arguments)}}();p.updateFilters=function(){var r=t._asyncToGenerator(function*(D,J,K){const {service:F,spatialReference:A}=K;({filters:J}=J);J=J.map((I,G)=>this._updateFilter(I,G,F,A));(yield Promise.all(J)).some(I=>I)&&(D.storage.filters=!0,C("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:",
"Filters changed"))});return function(D,J,K){return r.apply(this,arguments)}}();p.setData=function(r,D,J,K){const F=f.getDisplayIdTexel(r);this._ensureSizeForTexel(F);this._getBlock(D).setData(r,J,K)};p.getData=function(r,D,J){return this._getBlock(D).getData(r,J)};p.getHighlightFlag=function(r){return this._idsToHighlight.has(r)?d.HIGHLIGHT_FLAG:0};p.unsetAttributeData=function(r){r=f.getDisplayIdTexel(r);this._getBlock(0).setData(r,0,0)};p.setAttributeData=function(r,D){const J=f.getDisplayIdTexel(r);
this._ensureSizeForTexel(J);this._getBlock(0).setData(J,0,this.getFilterFlags(D));if(this._targetType===f.getDisplayIdType(r)){r=this._attributeComputeInfo;var K=this.config.supportsTextureFloat?1:2,F=null;r&&(F=r.isSubtype?r.map.get(D.readAttribute(r.subtypeField)):r.map)&&F.size&&F.forEach((A,I)=>{const G=I*K%4;I=this._getBlock(Math.floor(I*K/4)+d.ATTRIBUTE_DATA_VV);A=A(D);if(this.config.supportsTextureFloat)I.setData(J,G,A);else if(A===d.NAN_MAGIC_NUMBER)I.setData(J,G,255),I.setData(J,G+1,255);
else{A=y.clamp(Math.round(A),-32767,32766)+32768;const E=(A&65280)>>8;I.setData(J,G,A&255);I.setData(J,G+1,E)}})}};p.sendUpdates=function(){C("esri-2d-update-debug")&&console.debug("AttributeStore::sendUpdate");this._notifyChange();if(this._nextUpdate)return this._nextUpdate.promise;if(this._currUpdate)return this._nextUpdate=m.createResolver(),this._nextUpdate.promise;const r={blocks:this._blocks.map(D=>x.isSome(D)?D.toMessage():null)};return this._currUpdate=this._createResources().then(()=>{var D=
()=>{this._currUpdate=null;if(this._nextUpdate){const J=this._nextUpdate;this._nextUpdate=null;this.sendUpdates().then(()=>J.resolve())}else C("esri-2d-update-debug")&&console.debug("AttributeStore::sendUpdate::No additional updates queued");this._notifyChange()};C("esri-2d-update-debug")&&console.debug("AttributeStore::sendUpdate::client.update");D=this._client.update(r,this._signal).then(D).catch(D);this._client.render(this._signal);return D}).catch(D=>{if(m.isAbortError(D))return this._createResourcesPromise=
null,this._createResources();this._notifyChange();l.error(new H("mapview-attribute-store","Encountered an error during client update",D))})};p._ensureSizeForTexel=function(r){for(;r>=this._size*this._size&&!this._expand(););};p._bindAttribute=function(r,D){function J(){const {normalizationField:E}=r;return E?M=>{const T=M.readAttribute(E);return T?M.readAttribute(r.field)/T:null}:M=>M.readAttribute(r.field)}function K(){r.normalizationField&&l.warn("mapview-arcade","Ignoring normalizationField specified with an arcade expression which is not supported.");
return E=>E.getComputedNumericAtIndex(r.fieldIndex)}let F;if(null!=r.fieldIndex)F=K();else if(r.field)F=J();else return;const {valueRepresentation:A}=r;A&&(F=b(F,E=>e.getVisualVariableSizeValueRepresentationRatio(E,A)));const I=E=>null===E||isNaN(E)||Infinity===E||-Infinity===E?d.NAN_MAGIC_NUMBER:E,G=this._attributeComputeInfo;if(G.isSubtype){const E=G.map.get(D)??new Map;E.set(r.binding,b(F,I));G.map.set(D,E)}else G.map.set(r.binding,b(F,I))};p._createResources=function(){if(x.isSome(this._createResourcesPromise))return this._createResourcesPromise;
this._getBlock(d.ATTRIBUTE_DATA_ANIMATION);this._getBlock(d.ATTRIBUTE_DATA_GPGPU);q("Initializing AttributeStore");var r={shared:n&&"local"!==this._client.type,size:this._size,blocks:x.mapMany(this._blocks,D=>({textureOnly:D.textureOnly,buffer:D.buffer,pixelType:D.pixelType}))};this._createResourcesPromise=r=this._client.initialize(r,this._signal).catch(D=>{m.isAbortError(D)?this._createResourcesPromise=null:l.error(new H("mapview-attribute-store","Encountered an error during client initialization",
D))});r.then(()=>x.isNone(this._createResourcesPromise)?this._createResources():void 0);return r};p._getBlock=function(r){var D=this._blocks[r];if(x.isSome(D))return D;q(`Initializing AttributeBlock at index ${r}`);D=new B(n,this._client.type,this._size,this._blockDescriptors[r]);this._blocks[r]=D;this._createResourcesPromise=null;return D};p._expand=function(){if(this._size<this.config.maxTextureSize){const r=this._size<<=1;q("Expanding block size to",r,this._blocks);x.forEachSome(this._blocks,D=>
D.expand(r));this._createResourcesPromise=null;this._size=r;return 0}l.error(new H("mapview-limitations","Maximum number of onscreen features exceeded."));return-1};p._updateFilter=function(){var r=t._asyncToGenerator(function*(D,J,K,F){const A=this._filters[J],I=x.isSome(A)&&A.hash;if(!A&&!D||I===JSON.stringify(D))return!1;if(x.isNone(D)){if(!A)return!1;D=1<<J+1;K=this._getBlock(0);this._filters[J]=null;K.setComponentAllTexels(0,D);this.sendUpdates();return!0}yield(yield this._getFilter(J,K)).update(D,
F);return!0});return function(D,J,K,F){return r.apply(this,arguments)}}();p._getFilter=function(){var r=t._asyncToGenerator(function*(D,J){var K=this._filters[D];if(x.isSome(K))return K;({default:K}=yield new Promise((F,A)=>u(["./FeatureFilter"],I=>F(Object.freeze(Object.defineProperty({__proto__:null,default:I},Symbol.toStringTag,{value:"Module"}))),A)));J=new K({geometryType:J.geometryType,hasM:!1,hasZ:!1,timeInfo:J.timeInfo,fieldsIndex:new c(J.fields)});return this._filters[D]=J});return function(D,
J){return r.apply(this,arguments)}}();p.isVisible=function(r){return!!(this._getBlock(0).getData(r,0)&2)};p.getFilterFlags=function(r){let D=0;var J=f.getDisplayIdFilterMask(r.getDisplayId());for(let F=0;F<this._filters.length;F++){var K=this._filters[F];K=!(J&1<<F)||x.isNone(K)||K.check(r);D|=(K?1:0)<<F}J=0;this._idsToHighlight.size&&(r=r.getObjectId(),J=this.getHighlightFlag(r));return D<<1|J};t._createClass(z,[{key:"hasScaleExpr",get:function(){return this._hasScaleExpr}},{key:"_signal",get:function(){return this._abortController.signal}},
{key:"hasHighlight",get:function(){return 0<this._idsToHighlight.size}}]);return z}()})},"esri/views/2d/engine/webgl/DisplayId":function(){define(["exports"],function(u){u.AGGREGATE_VALID_FILTERS_MASK=254;u.DISPLAY_ID_TEXEL_MASK=8388607;u.DISPLAY_ID_TYPE_AGGREGATE=1;u.DISPLAY_ID_TYPE_FEATURE=0;u.DISPLAY_ID_TYPE_MASK=8388608;u.NONAGGREGATE_VALID_FILTERS_MASK=255;u.createDisplayId=function(t,H){return((H?8388608:0)|t)>>>0};u.getDisplayIdFilterMask=t=>1===(t&8388608)>>>23?254:255;u.getDisplayIdTexel=
t=>t&8388607;u.getDisplayIdType=t=>(t&8388608)>>>23;u.isAggregateId=function(t){return 1===(t&8388608)>>>23};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/Utils":function(){define("exports ../../../../core/Error ../../../../core/Logger ../../../../symbols/cim/enums ./enums ../../../webgl/enums ../../../webgl/VertexElementDescriptor".split(" "),function(u,t,H,C,w,y,x){function m(G){const E={};for(const M of G)E[M.name]=M.strideInBytes;return E}function h(G){switch(G){case w.WGLGeometryType.MARKER:return B;
case w.WGLGeometryType.FILL:return z;case w.WGLGeometryType.LINE:return p;case w.WGLGeometryType.TEXT:return r;case w.WGLGeometryType.LABEL:return D}}function c(G){switch(G%4){case 0:case 2:return 4;case 1:case 3:return 1}}function d(G){switch(G){case y.DataType.BYTE:case y.DataType.UNSIGNED_BYTE:return 1;case y.DataType.SHORT:case y.DataType.UNSIGNED_SHORT:return 2;case y.DataType.FLOAT:case y.DataType.INT:case y.DataType.UNSIGNED_INT:return 4}}function f(G){const E={};for(const M in G){let T=0;
E[M]=G[M].map(Y=>{const fa=new x.VertexElementDescriptor(Y.name,Y.count,Y.type,T,0,Y.normalized||!1);T+=Y.count*d(Y.type);return fa});E[M]?.forEach(Y=>Y.stride=T)}return E}const k=H.getLogger("esri.views.2d.engine.webgl.Utils"),g=m([{name:"geometry",strideInBytes:36}]),e=m([{name:"geometry",strideInBytes:12}]),a=m([{name:"geometry",strideInBytes:36}]),b=m([{name:"geometry",strideInBytes:24}]),l=m([{name:"geometry",strideInBytes:12}]),q=m([{name:"geometry",strideInBytes:40}]),n=m([{name:"geometry",
strideInBytes:36}]),v=m([{name:"geometry",strideInBytes:36}]),B=["geometry"],z=["geometry"],p=["geometry"],r=["geometry"],D=["geometry"];H={geometry:y.Usage.STATIC_DRAW};const J=new Map,K=G=>null!=G&&G.startsWith("data:image/gif"),F=G=>null!=G&&G.startsWith("data:image/png"),A=G=>{if(!G)return!1;G=G.trim();return/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(G)&&/[\dz]$/i.test(G)&&4<G.length?!0:!1},I=G=>"fill"===G.type&&"CIMMarkerPlacementInsidePolygon"===G?.cim?.markerPlacement?.type;u.C_VBO_INFO=
H;u.allocateTypedArrayBuffer=function(G,E){switch(E%4){case 0:case 2:return new Uint32Array(Math.floor(G*E/4));case 1:case 3:return new Uint8Array(G*E)}};u.allocateTypedArrayBufferwithData=function(G,E){switch(E%4){case 0:case 2:return new Uint32Array(G);case 1:case 3:return new Uint8Array(G)}};u.charCodes=function(G){const E=[];for(let M=0;M<G.length;M++)E.push(G.charCodeAt(M));return E};u.copyMeshData=function(G,E,M,T,Y,fa,ba){for(const Q in fa){var U=fa[Q].stride,P=c(U);const Z=fa[Q].data,X=M[Q].data;
if(null==Z||null==X)continue;const sa=U*Y.vertexCount/P,Aa=U*G/P;U=U*Y.vertexFrom/P;for(P=0;P<sa;++P)X[P+Aa]=Z[P+U]}if(null!=ba&&null!=T)for(M=Y.indexCount,fa=0;fa<M;++fa)T[fa+E]=ba[fa+Y.indexFrom]-Y.vertexFrom+G};u.createGeometryData=function(G,E){const M=[];for(let T=0;5>T;++T){const Y=h(T),fa={};for(const ba of Y)fa[ba]={data:E(T,ba)};M.push({data:G(T),buffers:fa})}return M};u.createProgramDescriptor=(G,E)=>{if(!J.has(G)){const Y=f(E);var M=Y;var T={};for(const fa in M){const ba=M[fa];T[fa]=ba?.length?
ba[0].stride:0}M=T;T=new Map;for(const fa in E)for(const ba of E[fa])T.set(ba.name,ba.location);J.set(G,{strides:M,bufferLayouts:Y,attributes:T})}return J.get(G)};u.forEachGeometryType=function(G){G(w.WGLGeometryType.FILL);G(w.WGLGeometryType.LINE);G(w.WGLGeometryType.MARKER);G(w.WGLGeometryType.TEXT);G(w.WGLGeometryType.LABEL)};u.getBytes=d;u.getCapType=function(G){switch(G){case "butt":return C.CapType.BUTT;case "round":return C.CapType.ROUND;case "square":return C.CapType.SQUARE;default:return k.error(new t("mapview-invalid-type",
`Cap type ${G} is not a valid option. Defaulting to round`)),C.CapType.ROUND}};u.getJoinType=function(G){switch(G){case "miter":return C.JoinType.MITER;case "bevel":return C.JoinType.BEVEL;case "round":return C.JoinType.ROUND;default:return k.error(new t("mapview-invalid-type",`Join type ${G} is not a valid option. Defaulting to round`)),C.JoinType.ROUND}};u.getNamedBuffers=h;u.getPMSResourceSize=function(G){const E="maxVVSize"in G&&G.maxVVSize;G="width"in G&&G.width||"size"in G&&G.size||0;return E?
E:G};u.getPixelArrayCtor=function(G){switch(G){case y.PixelType.UNSIGNED_BYTE:return Uint8Array;case y.PixelType.UNSIGNED_SHORT_4_4_4_4:return Uint16Array;case y.PixelType.FLOAT:return Float32Array;default:k.error(new t("webgl-utils",`Unable to handle type ${G}`))}};u.getPixelBytes=function(G){switch(G){case y.PixelType.UNSIGNED_BYTE:return 1;case y.PixelType.UNSIGNED_SHORT_4_4_4_4:return 2;case y.PixelType.FLOAT:return 4;default:k.error(new t("webgl-utils",`Unable to handle type ${G}`))}};u.getStrides=
function(G,E){switch(G){case w.WGLGeometryType.MARKER:switch(E){case w.WGLSymbologyType.HEATMAP:return e;default:return g}case w.WGLGeometryType.FILL:switch(E){case w.WGLSymbologyType.DOT_DENSITY:return l;case w.WGLSymbologyType.SIMPLE:case w.WGLSymbologyType.OUTLINE_FILL_SIMPLE:return b;default:return a}case w.WGLGeometryType.LINE:return q;case w.WGLGeometryType.TEXT:return n;case w.WGLGeometryType.LABEL:return v}};u.getUrl=G=>"imageData"in G&&G.imageData&&"contentType"in G&&G.contentType?`data:${G.contentType};base64,${G.imageData}`:
"url"in G?G.url:null;u.getVVType=function(G){switch(G){case "opacity":return w.VVType.OPACITY;case "color":return w.VVType.COLOR;case "rotation":return w.VVType.ROTATION;case "size":return w.VVType.SIZE;default:return k.error(`Cannot interpret unknown vv: ${G}`),null}};u.is3D=G=>G.type&&G.type.toLowerCase().includes("3d");u.isDefined=function(G){return null!=G};u.isGIF=G=>"url"in G&&G.url&&(G.url.includes(".gif")||K(G.url))||"contentType"in G&&"image/gif"===G.contentType||"imageData"in G&&K(G.imageData);
u.isGIFDataUri=K;u.isImageResource=G=>"url"in G&&G.url||"imageData"in G&&G.imageData;u.isMarkerPlacementInsidePolygon=I;u.isNumber=function(G){return"number"===typeof G};u.isPNG=G=>"url"in G&&G.url&&(G.url.includes(".png")||F(G.url))||"contentType"in G&&"image/png"===G.contentType||"imageData"in G&&F(G.imageData);u.isPNGDataUri=F;u.isSVGImage=G=>G.includes("data:image/svg+xml");u.isSVGResource=G=>"path"in G&&A(G.path);u.isSimple=function(G){switch(G.type){case "line":return"CIMSolidStroke"===G.cim.type&&
!G.dashTemplate;case "fill":return"CIMSolidFill"===G.cim.type;case "esriSFS":return"esriSFSSolid"===G.style||"esriSFSNull"===G.style;case "esriSLS":return"esriSLSSolid"===G.style||"esriSLSNull"===G.style;default:return!1}};u.isValidSVG=A;u.shouldRepeat=function(G){switch("cim"in G?G.cim.type:G.type){case "esriSMS":case "esriPMS":case "CIMPointSymbol":return!1;case "CIMVectorMarker":case "CIMCharacterMarker":case "CIMPictureMarker":return I(G);default:return!0}};u.strideToPackingFactor=c;Object.defineProperty(u,
Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/enums":function(){define(["exports"],function(u){u.WGLGeometryType=void 0;(function(t){t[t.FILL=0]="FILL";t[t.LINE=1]="LINE";t[t.MARKER=2]="MARKER";t[t.TEXT=3]="TEXT";t[t.LABEL=4]="LABEL"})(u.WGLGeometryType||(u.WGLGeometryType={}));u.WGLDrawPhase=void 0;(function(t){t[t.NONE=0]="NONE";t[t.MAP=1]="MAP";t[t.LABEL=2]="LABEL";t[t.LABEL_ALPHA=4]="LABEL_ALPHA";t[t.HITTEST=8]="HITTEST";t[t.HIGHLIGHT=16]="HIGHLIGHT";t[t.CLIP=32]="CLIP";
t[t.DEBUG=64]="DEBUG";t[t.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"})(u.WGLDrawPhase||(u.WGLDrawPhase={}));u.VVType=void 0;(function(t){t[t.SIZE=0]="SIZE";t[t.COLOR=1]="COLOR";t[t.OPACITY=2]="OPACITY";t[t.ROTATION=3]="ROTATION"})(u.VVType||(u.VVType={}));u.WGLVVFlag=void 0;(function(t){t[t.NONE=0]="NONE";t[t.OPACITY=1]="OPACITY";t[t.COLOR=2]="COLOR";t[t.ROTATION=4]="ROTATION";t[t.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE";t[t.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS";t[t.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS";
t[t.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"})(u.WGLVVFlag||(u.WGLVVFlag={}));u.WGLVVTarget=void 0;(function(t){t[t.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE";t[t.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE";t[t.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE";t[t.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"})(u.WGLVVTarget||(u.WGLVVTarget={}));u.MosaicType=void 0;(function(t){t[t.SPRITE=0]="SPRITE";t[t.GLYPH=1]="GLYPH"})(u.MosaicType||(u.MosaicType={}));u.WGLSymbologyType=void 0;
(function(t){t[t.DEFAULT=0]="DEFAULT";t[t.SIMPLE=1]="SIMPLE";t[t.DOT_DENSITY=2]="DOT_DENSITY";t[t.OUTLINE_FILL=3]="OUTLINE_FILL";t[t.OUTLINE_FILL_SIMPLE=4]="OUTLINE_FILL_SIMPLE";t[t.HEATMAP=5]="HEATMAP";t[t.PIE_CHART=6]="PIE_CHART"})(u.WGLSymbologyType||(u.WGLSymbologyType={}));Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/util/debug":function(){define(["exports"],function(u){u.DEBUG_ATTR_UPDATES=!1;u.createDebugLogger=(t,H)=>t&&((...C)=>H.warn("DEBUG:",
...C))||(()=>null);Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/tileRenderers/support/visualVariablesUtils":function(){define("exports ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../engine/webgl/color ../../../../engine/webgl/definitions ../../../../engine/webgl/enums ../../../../engine/webgl/visualVariablesUtils".split(" "),function(u,t,H,C,w,y,x){function m(e){return{value:e.value,size:H.toPt(e.size)}}function h(e){return(e??
[]).map(a=>m(a))}function c(e){return"string"===typeof e||"number"===typeof e?H.toPt(e):{type:"size",expression:e.expression,stops:h(e.stops)}}function d(e){const a={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if("string"===typeof e.field)if(e.stops){if(8<e.stops.length)return null;e=e.stops;for(var b=0;8>b;++b){const l=e[Math.min(b,e.length-1)];a.values[b]=l.value;a.opacities[b]=l.opacity}}else return null;else if(e.stops&&0<=e.stops.length)for(e=e.stops&&0<=e.stops.length?e.stops[0].opacity:
0,b=0;8>b;b++)a.values[b]=Infinity,a.opacities[b]=e;else return null;return a}function f(e,a,b){e[4*a]=b.r/255;e[4*a+1]=b.g/255;e[4*a+2]=b.b/255;e[4*a+3]=b.a}function k(e){if(t.isNone(e)||e.normalizationField)return null;const a={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};if("string"===typeof e.field)if(e.stops){if(8<e.stops.length)return null;a.field=e.field;e=e.stops;for(var b=0;8>b;++b){const l=e[Math.min(b,e.length-1)];a.values[b]=
l.value;f(a.colors,b,l.color)}}else return null;else if(e.stops&&0<=e.stops.length)for(e=e.stops&&0<=e.stops.length&&e.stops[0].color,b=0;8>b;b++)a.values[b]=Infinity,f(a.colors,b,e);else return null;for(e=0;32>e;e+=4)C.premultiplyAlpha(a.colors,e,!0);return a}const g=e=>{const a=[],b=[];e=h(e);const l=e.length;for(let q=0;6>q;q++){const n=e[Math.min(q,l-1)];a.push(n.value);b.push(null==n.size?w.NAN_MAGIC_NUMBER:H.pt2px(n.size))}return{values:new Float32Array(a),sizes:new Float32Array(b)}};u.convertColorVariable=
k;u.convertVisualVariables=function(e){const a=e&&0<e.length?{}:null,b=a?{}:null;if(!a||!b)return{vvFields:a,vvRanges:b};for(const l of e)if(l.field&&(a[l.type]=l.field),"size"===l.type)switch(b.size||(b.size={}),e=l,x.getTypeOfSizeVisualVariable(e)){case y.WGLVVFlag.SIZE_MINMAX_VALUE:b.size.minMaxValue={minDataValue:e.minDataValue,maxDataValue:e.maxDataValue,minSize:c(e.minSize),maxSize:c(e.maxSize)};break;case y.WGLVVFlag.SIZE_SCALE_STOPS:b.size.scaleStops={stops:h(e.stops)};break;case y.WGLVVFlag.SIZE_FIELD_STOPS:if(e.levels){const q=
{};for(const n in e.levels)q[n]=g(e.levels[n]);b.size.fieldStops={type:"level-dependent",levels:q}}else b.size.fieldStops={type:"static",...g(e.stops)};break;case y.WGLVVFlag.SIZE_UNIT_VALUE:b.size.unitValue={unit:e.valueUnit,valueRepresentation:e.valueRepresentation??void 0}}else"color"===l.type?b.color=k(l):"opacity"===l.type?b.opacity=d(l):"rotation"===l.type&&(b.rotation={type:l.rotationType});return{vvFields:a,vvRanges:b}};u.getVisualVariableSizeValueRepresentationRatio=function(e,a){if(!e||
!a)return e;switch(a){case "radius":case "distance":return 2*e;case "area":return Math.sqrt(e)}return e};u.normalizeSizeElement=c;u.normalizeSizeStops=h;u.stopToSizeStop=m;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/core/screenUtils":function(){define(["exports"],function(u){function t(C){return C?72*C/96:0}const H=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i;u.castRenderScreenPointArray=function(C){return C};u.castRenderScreenPointArray3=function(C){return C};u.castScreenPointArray=
function(C){return C};u.createRenderScreenPoint=function(C=0,w=0){return{x:C,y:w}};u.createRenderScreenPointArray=function(C=0,w=0){return[C,w]};u.createRenderScreenPointArray3=function(C=0,w=0,y=0){return[C,w,y]};u.createScreenPoint=function(C=0,w=0){return{x:C,y:w}};u.createScreenPointArray=function(C=0,w=0){return[C,w]};u.pt2px=function(C){return C?C/72*96:0};u.px2pt=t;u.screenPointArrayToObject=function(C,w){return w?(w.x=C[0],w.y=C[1],w):{x:C[0],y:C[1]}};u.screenPointObjectToArray=function(C,
w){return w?(w[0]=C.x,w[1]=C.y,2<w.length&&(w[2]=0),w):[C.x,C.y]};u.toPt=function(C){if("string"===typeof C){var w=C.match(H);if(w){var y=Number(w[1]);w=w[3]&&w[3].toLowerCase();C="-"===C.charAt(0);y="px"===w?t(y):y;return C?-y:y}console.warn("screenUtils.toPt: input not recognized!");return null}return C};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/color":function(){define(["exports","../../../../core/maybe","./number"],function(u,t,H){u.premultiplyAlpha=
function(C,w=0,y=!1){const x=C[w+3];C[w+0]*=x;C[w+1]*=x;C[w+2]*=x;y||(C[w+3]*=255);return C};u.premultiplyAlphaRGBA=function(C){if(!C)return 0;const {r:w,g:y,b:x,a:m}=C;return H.i8888to32(w*m,y*m,x*m,255*m)};u.premultiplyAlphaRGBAArray=function(C){if(!C)return 0;const [w,y,x,m]=C;return H.i8888to32(m/255*w,m/255*y,m/255*x,m)};u.writeColor=function(C,w,y=0){if(t.isNone(w))C[y+0]=0,C[y+1]=0,C[y+2]=0,C[y+3]=0;else{var {r:x,g:m,b:h,a:c}=w;C[y+0]=x*c/255;C[y+1]=m*c/255;C[y+2]=h*c/255;C[y+3]=c}};Object.defineProperty(u,
Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/number":function(){define(["exports"],function(u){function t(w,y,x){return Math.round(Math.max(Math.min(w,x),y))}const H=new Float32Array(1),C=new Uint32Array(H.buffer);u.i16=function(w){return t(w,-32768,32767)};u.i1616to32=function(w,y){return 65535&w|y<<16};u.i32=function(w){return t(w,-2147483648,2147483647)};u.i8=function(w){return t(w,-128,127)};u.i8816to32=function(w,y,x){return w&255|(y&255)<<8|x<<16};u.i8888to32=function(w,
y,x,m){return w&255|(y&255)<<8|(x&255)<<16|m<<24};u.numTo32=function(w){return w|0};u.toFloat32=function(w){C[0]=w;return H[0]};u.toUint32=function(w){H[0]=w;return C[0]};u.u16=function(w){return t(w,0,65535)};u.u32=function(w){return t(w,0,4294967295)};u.u32to4Xu8=function(w){return[w&255,(w&65280)>>>8,(w&16711680)>>>16,(w&4278190080)>>>24]};u.u4u4to8=function(w,y){return 15&w|(15&y)<<4};u.u8=function(w){return t(w,0,255)};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/visualVariablesUtils":function(){define(["exports",
"../../../../core/Error","../../../../core/Logger","./enums","./Utils"],function(u,t,H,C,w){u.getTypeOfSizeVisualVariable=function(y){if(w.isNumber(y.minDataValue)&&w.isNumber(y.maxDataValue)&&null!=y.minSize&&null!=y.maxSize)return C.WGLVVFlag.SIZE_MINMAX_VALUE;if((y.expression&&"view.scale"===y.expression||y.valueExpression&&"$view.scale"===y.valueExpression)&&Array.isArray(y.stops))return C.WGLVVFlag.SIZE_SCALE_STOPS;if((null!=y.field||y.expression&&"view.scale"!==y.expression||y.valueExpression&&
"$view.scale"!==y.valueExpression)&&(Array.isArray(y.stops)||"levels"in y&&y.levels))return C.WGLVVFlag.SIZE_FIELD_STOPS;if((null!=y.field||y.expression&&"view.scale"!==y.expression||y.valueExpression&&"$view.scale"!==y.valueExpression)&&null!=y.valueUnit)return C.WGLVVFlag.SIZE_UNIT_VALUE;H.getLogger("esri.views.2d.engine.webgl").error(new t("mapview-bad-type","Found invalid size VisualVariable",y));return C.WGLVVFlag.NONE};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/BinStore":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry ../../../../../core/Evented ../../../../../core/has ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/accessorSupport/diffUtils ../../../../../geohash/GeohashTree ../../../../../geohash/geohashUtils ../../../../../geometry/support/aaBoundingBox ../../../../../geometry/support/Ellipsoid ../../../../../geometry/support/spatialReferenceUtils ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedFeature ../../../../../layers/graphics/OptimizedGeometry ../../../../../layers/graphics/data/projectionSupport ../../../engine/webgl/DisplayId ../FeatureStore2D ../Store2D ./FeatureSetReaderJSON ../../../../../geometry/SpatialReference ../../../../../geometry/Polygon ../../../../../geometry/Extent".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f,k,g,e,a,b,l,q,n,v,B,z,p){const r=y.getLogger("esri.view.2d.layers.features.support.BinStore"),D=d.create();H=function(J){function K(A,I,G,E){var M=J.call(this,A,G)||this;M.type="bin";M.events=new C;M.objectIdField="aggregateId";M.featureAdapter=q.featureAdapter;M._geohashLevel=5;M._geohashBuf=[];M._serviceInfo=E;M.geometryInfo=A.geometryInfo;M._spatialReference=I;M._projectionSupportCheck=b.checkProjectionSupport(I,B.WGS84);M._bitsets.geohash=G.getBitset(G.createBitset());
M._bitsets.inserted=G.getBitset(G.createBitset());return M}t._inheritsLoose(K,J);var F=K.prototype;F.destroy=function(){this._tree&&this._tree.destroy()};F.updateSchema=function(){var A=t._asyncToGenerator(function*(I,G){const E=this._schema;try{yield J.prototype.updateSchema.call(this,I,G),yield this._projectionSupportCheck}catch(T){}this._fields=this._schema.params.fields;const M=m.diff(E,G);if(!G||x.isNone(M)&&!I.source&&!I.storage.filters)E&&(I.mesh=!0);else{if(m.hasDiff(M,"params.fields")||m.hasDiff(M,
"params")||!this._tree||I.source)this._tree&&this._tree.destroy(),this._tree=new h.GeohashTree(this._statisticFields,this._serviceInfo),this._tree.onRelease=T=>T.displayId&&this._storage.releaseDisplayId(T.displayId),this._geohashLevel=this._schema.params.fixedBinLevel,this._rebuildTree(),w("esri-2d-update-debug")&&r.info("Aggregate mesh needs update due to tree changing");w("esri-2d-update-debug")&&r.info("Aggregate mesh needs update due to tree changing");I.targets[G.name]=!0;I.mesh=!1}});return function(I,
G){return A.apply(this,arguments)}}();F.clear=function(){this._rebuildTree()};F.sweepFeatures=function(A,I){this._bitsets.inserted.forEachSet(G=>{A.has(G)||(G=I.lookupByDisplayIdUnsafe(G),this._remove(G))})};F.sweepAggregates=function(A,I,G){};F.onTileData=function(A,I,G,E,M=!0){if(!this._schema||x.isNone(I.addOrUpdate))return I;this.events.emit("changed");var T=this._getTransforms(A,this._spatialReference);const Y=I.addOrUpdate.getCursor();for(;Y.next();)this._update(Y,E);if(I.status.mesh||!M)return I;
E=[];this._getBinsForTile(E,A,T,G);I.addOrUpdate=v.FeatureSetReaderJSON.fromOptimizedFeatures(E,{...this._serviceInfo,geometryType:"esriGeometryPolygon"});I.addOrUpdate.attachStorage(G);I.end=!0;I.isRepush||(I.clear=!0);for(T=I.addOrUpdate.getCursor();T.next();)E=T.getDisplayId(),this._bitsets.computed.unset(E),this.setComputedAttributes(G,T,E,A.scale);return I};F.forEachBin=function(A){this._tree.forEach(A)};F.forEach=function(A){this._tree.forEach(I=>{I.depth===this._geohashLevel&&(I=this._toFeatureJSON(I),
I=v.FeatureSetReaderJSON.fromFeatures([I],{objectIdField:this.objectIdField,globalIdField:null,geometryType:this.geometryInfo.geometryType,fields:this.fields}).getCursor(),I.next(),A(I))})};F.forEachInBounds=function(A,I){};F.forEachBounds=function(A,I){const {hasM:G,hasZ:E}=this.geometryInfo;for(const M of A)A=g.getBoundsOptimizedGeometry(D,M.readGeometry(),E,G),x.isNone(A)||I(A)};F.onTileUpdate=function(A){};F.getAggregate=function(A){const I=l.createDisplayId(A,!0);A=this._tree.findIf(G=>G.displayId===
I);return x.applySome(A,G=>this._toFeatureJSON(G))};F.getAggregates=function(){return this._tree.findAllIf(A=>A.depth===this._geohashLevel).map(this._toFeatureJSON.bind(this))};F.getDisplayId=function(A){const I=this._tree.findIf(G=>G.id===A);return x.applySome(I,G=>G.displayId)};F.getFeatureDisplayIdsForAggregate=function(A){const I=this._tree.findIf(G=>G.id===A);return x.mapOr(I,[],G=>Array.from(G.displayIds))};F.getDisplayIdForReferenceId=function(A){const I=this._tree.findIf(G=>1===G.displayIds.size&&
G.displayIds.has(A));return x.applySome(I,G=>G.displayId)};F._toFeatureJSON=function(A){const I=this._spatialReference;return{displayId:A.displayId,attributes:A.getAttributes(),geometry:g.convertToGeometry(A.getGeometry(I),"esriGeometryPolygon",!1,!1),centroid:null}};F._rebuildTree=function(){this._bitsets.computed.clear();this._bitsets.inserted.clear();this._tree&&this._tree.clear()};F._remove=function(A){const I=A.getDisplayId(),G=A.getXHydrated(),E=A.getYHydrated(),M=this._geohashBuf[2*I],T=this._geohashBuf[2*
I+1];this._bitsets.inserted.has(I)&&(this._bitsets.inserted.unset(I),this._tree.removeCursor(A,G,E,M,T,this._geohashLevel))};F._update=function(A,I){const G=A.getDisplayId(),E=this._bitsets.inserted;I=I.isVisible(G);var M=E.has(G);I!==M&&(I?(I=A.getXHydrated(),M=A.getYHydrated(),this._setGeohash(G,I,M)&&(this._tree.insertCursor(A,G,I,M,this._geohashBuf[2*G],this._geohashBuf[2*G+1],this._geohashLevel),E.set(G))):this._remove(A))};F._setGeohash=function(A,I,G){if(this._bitsets.geohash.has(A))return!0;
const E=this._geohashBuf;if(this._spatialReference.isWebMercator)I=I/f.earth.radius*57.29577951308232,c.setGeohashBuf(E,A,57.29577951308232*(Math.PI/2-2*Math.atan(Math.exp(-G/f.earth.radius))),I-360*Math.floor((I+180)/360),12);else{G=b.project({x:I,y:G},this._spatialReference,B.WGS84);if(!G)return!1;c.setGeohashBuf(E,A,G.y,G.x,12)}this._bitsets.geohash.set(A);return!0};F._getBinsForTile=function(A,I,G,E){try{var M=this._getGeohashBounds(I);const T=this._tree.getBins(M);for(const Y of T){Y.displayId||
(Y.displayId=E.createDisplayId(!0));M=null;const fa=Y.getGeometry(this._spatialReference,G.tile);fa||(M=Y.getGeometryCentroid(this._spatialReference,G.tile));const ba=new e.OptimizedFeature(fa,Y.getAttributes(),M);ba.objectId=Y.id;ba.displayId=Y.displayId;A.push(ba)}}catch(T){r.error("Unable to get bins for tile",I.key.id)}};F._getGeohash=function(A,I,G){const E={geohashX:0,geohashY:0};c.setGeohashXY(E,I,A,G);return E};F._getGeohashBounds=function(A){const I=this._getGeohashLevel(A.key.level),G=[A.extent.xmin,
A.extent.ymin,A.extent.xmax,A.extent.ymax];var E=z.fromExtent(p.fromBounds(G,this._spatialReference));A=b.project(E,this._spatialReference,B.WGS84,{densificationStep:64*A.resolution});A=g.convertFromPolygon(new a,A,!1,!1);var M=A.coords.filter((Y,fa)=>!(fa%2)),T=A.coords.filter((Y,fa)=>fa%2);A=Math.min(...M);E=Math.min(...T);M=Math.max(...M);T=Math.max(...T);A=this._getGeohash(A,E,I);E=this._getGeohash(M,T,I);return{bounds:G,geohashBounds:{xLL:A.geohashX,yLL:A.geohashY,xTR:E.geohashX,yTR:E.geohashY},
level:I}};F._getGeohashLevel=function(A){return this._schema.params.fixedBinLevel};F._getTransforms=function(A,I){const G={originPosition:"upperLeft",scale:[A.resolution,A.resolution],translate:[A.bounds[0],A.bounds[3]]};I=k.getInfo(I);if(!I)return{tile:G,left:null,right:null};const [E,M]=I.valid;return{tile:G,left:{...G,translate:[M,A.bounds[3]]},right:{...G,translate:[E-M+A.bounds[0],A.bounds[3]]}}};t._createClass(K,[{key:"featureSpatialReference",get:function(){return this._spatialReference}},
{key:"fields",get:function(){return this._fields}}]);return K}(n.Store2D);u.BinStore=H;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/geohash/GeohashTree":function(){define("exports ../chunks/_rollupPluginBabelHelpers ../core/CircularArray ../core/maybe ./geohashUtils ../geometry/SpatialReference ../layers/graphics/featureConversionUtils ../layers/graphics/OptimizedGeometry ../layers/graphics/data/projectionSupport ../views/2d/layers/features/support/FeatureSetReaderJSON".split(" "),
function(u,t,H,C,w,y,x,m,h,c){let d=function(){function k(e=[],a,b=8096){this.onRelease=l=>{};this._nodes=0;this._root=new f(this,0,0,0);this._statisticFields=e;this._pool=b?new H(8096):null;this._serviceInfo=a}var g=k.prototype;g.destroy=function(){this.clear()};g._acquire=function(e,a,b){this._nodes++;let l=null;C.isSome(this._pool)&&(l=this._pool.dequeue());C.isSome(l)?l.realloc(e,a,b):l=new f(this,e,a,b);return l};g._release=function(e){this.onRelease(e);this._nodes--;C.isSome(this._pool)&&this._pool.enqueue(e)};
g.dropLevels=function(e){this.forEach(a=>{if(a.depth>=e)for(let b=0;b<a.children.length;b++){const l=a.children[b];l&&this._release(l)}});this.forEach(a=>{if(a.depth>=e)for(let b=0;b<a.children.length;b++)a.children[b]=null})};g.clear=function(){this.forEach(e=>this._release(e));this._root=new f(this,0,0,0)};g.insert=function(e,a,b=0){const l=c.FeatureSetReaderJSON.fromOptimizedFeatures([e],this._serviceInfo).getCursor();l.next();const q=l.readGeometry();if(q){var [n,v]=q.coords;this.insertCursor(l,
e.displayId,n,v,e.geohashX,e.geohashY,a,b)}};g.insertCursor=function(e,a,b,l,q,n,v,B=0){let z=this._root,p=0,r=0,D=0;for(;null!==z;){z.depth>=B&&(z.count+=1,z.xTotal+=b,z.yTotal+=l,z.xGeohashTotal+=q,z.yGeohashTotal+=n,z.referenceId=a,this._updateStatisticsCursor(e,z,1));if(p>=v){z.add(a);break}var J=Math.ceil((p+1)/2),K=Math.floor((p+1)/2);const A=1-p%2;var F=30-(3*J+2*K);J=30-(2*J+3*K);F=(q&7*A+3*(1-A)<<F)>>F;J=(n&3*A+7*(1-A)<<J)>>J;K=F+J*(8*A+4*(1-A));const I=2*A+3*(1-A);r=r<<3*A+2*(1-A)|F;D=D<<
I|J;null==z.children[K]&&(z.children[K]=this._acquire(r,D,p+1));p+=1;z=z.children[K]}};g.remove=function(e,a){const b=c.FeatureSetReaderJSON.fromOptimizedFeatures([e],this._serviceInfo).getCursor();b.next();const l=b.readGeometry();if(l){var [q,n]=l.coords;this.removeCursor(b,q,n,e.geohashX,e.geohashY,a)}};g.removeCursor=function(e,a,b,l,q,n){let v=this._root,B=0;for(;null!==v;){--v.count;v.xTotal-=a;v.yTotal-=b;v.xGeohashTotal-=l;v.yGeohashTotal-=q;this._updateStatisticsCursor(e,v,-1);if(B>=n){v.remove(e.getDisplayId());
break}var z=Math.ceil((B+1)/2);const D=Math.floor((B+1)/2);var p=1-B%2,r=30-(3*z+2*D);z=30-(2*z+3*D);p=((l&7*p+3*(1-p)<<r)>>r)+((q&3*p+7*(1-p)<<z)>>z)*(8*p+4*(1-p));r=v.children[p];1===r?.count&&(this._release(r),v.children[p]=null);B+=1;v=r}};g.forEach=function(e){let a=this._root;for(;null!==a;){const b=this._linkChildren(a)||a.next;e(a);a=b}};g.find=function(e,a,b){return this._root.find(e,a,b,0,0,0)};g.findIf=function(e){let a=null;this.forEach(b=>{e(b)&&(a=b)});return a};g.findAllIf=function(e){const a=
[];this.forEach(b=>{e(b)&&a.push(b)});return a};g.findSingleOccupancyNode=function(e,a,b,l,q){let n=this._root;for(;null!==n;){var v=n.depth,B=n.xNode,z=n.yNode;const F=1-v%2;var p=n.xGeohashTotal/n.count,r=n.yGeohashTotal/n.count;if(1===n.count&&e<p&&p<=b&&a<r&&r<=l)return n;if(v>=q)n=n.next;else{r=Math.ceil((v+1)/2);v=Math.floor((v+1)/2);p=30-(3*r+2*v);var D=30-(2*r+3*v),J=~((1<<p)-1),K=~((1<<D)-1);B<<=3*F+2*(1-F);z<<=2*F+3*(1-F);v=Math.max(B,(e&J)>>p);r=Math.max(z,(a&K)>>D);p=Math.min(B+8*F+4*
(1-F),(b&J)>>p);D=Math.min(z+4*F+8*(1-F),(l&K)>>D);for(J=K=null;r<=D;r++)for(let A=v;A<=p;A++){const I=n.children[A-B+(r-z)*(8*F+4*(1-F))];I&&(K||(K=I,K.next=n.next),J&&(J.next=I),J=I,I.next=n.next)}n=K||n.next}}return null};g.getRegionDisplayIds=function(e){let a=this._root;const {bounds:b,geohashBounds:l,level:q}=e,[n,v,B,z]=b,p=[];for(;null!==a;){e=a.depth;var r=a.xNode,D=a.yNode;if(e>=q)e=a.xTotal/a.count,r=a.yTotal/a.count,e>=n&&e<=B&&r>=v&&r<=z&&a.displayIds.forEach(E=>p.push(E)),a=a.next;else{var J=
Math.ceil((e+1)/2),K=Math.floor((e+1)/2);e=1-e%2;var F=30-(3*J+2*K),A=30-(2*J+3*K),I=~((1<<F)-1),G=~((1<<A)-1);r<<=3*e+2*(1-e);D<<=2*e+3*(1-e);J=Math.max(r,(l.xLL&I)>>F);K=Math.max(D,(l.yLL&G)>>A);F=Math.min(r+8*e+4*(1-e),(l.xTR&I)>>F);A=Math.min(D+4*e+8*(1-e),(l.yTR&G)>>A);for(I=G=null;K<=A;K++)for(let E=J;E<=F;E++){const M=a.children[E-r+(K-D)*(8*e+4*(1-e))];M&&(G||(G=M,G.next=a.next),I&&(I.next=M),I=M,M.next=a.next)}a=G||a.next}}return p};g.getRegionStatistics=function(e){var a=this._root;let b=
0,l=0,q=0;const n={},{bounds:v,geohashBounds:B,level:z}=e,[p,r,D,J]=v;for(e=0;null!==a;){var K=a.depth,F=a.xNode,A=a.yNode;if(K>=z)K=a.xTotal/a.count,F=a.yTotal/a.count,K>p&&K<=D&&F>r&&F<=J&&(b+=a.count,l+=a.xTotal,q+=a.yTotal,1===a.count&&(e=a.referenceId),this._aggregateStatistics(n,a.statistics)),a=a.next;else{var I=Math.ceil((K+1)/2),G=Math.floor((K+1)/2);K=1-K%2;var E=30-(3*I+2*G),M=30-(2*I+3*G),T=~((1<<E)-1),Y=~((1<<M)-1);F<<=3*K+2*(1-K);A<<=2*K+3*(1-K);I=Math.max(F,(B.xLL&T)>>E);G=Math.max(A,
(B.yLL&Y)>>M);E=Math.min(F+8*K+4*(1-K),(B.xTR&T)>>E);M=Math.min(A+4*K+8*(1-K),(B.yTR&Y)>>M);T=Y=null;for(let fa=G;fa<=M;fa++)for(let ba=I;ba<=E;ba++){const U=a.children[ba-F+(fa-A)*(8*K+4*(1-K))];if(U)if(fa!==G&&fa!==M&&ba!==I&&ba!==E){const P=U.xTotal/U.count,Q=U.yTotal/U.count;P>p&&P<=D&&Q>r&&Q<=J&&(b+=U.count,l+=U.xTotal,q+=U.yTotal,1===U.count&&(e=U.referenceId),this._aggregateStatistics(n,U.statistics))}else Y||(Y=U,Y.next=a.next),T&&(T.next=U),T=U,U.next=a.next}a=Y||a.next}}a=this.normalizeStatistics(n,
b);return{count:b,attributes:a,xTotal:l,yTotal:q,referenceId:e}};g.getBins=function(e){const a=[],{geohashBounds:b,level:l}=e;for(e=this._root;null!==e;){var q=e.depth,n=e.xNode,v=e.yNode;if(q>=l)a.push(e),e=e.next;else{var B=Math.ceil((q+1)/2),z=Math.floor((q+1)/2);q=1-q%2;var p=30-(3*B+2*z),r=30-(2*B+3*z),D=~((1<<p)-1),J=~((1<<r)-1);n<<=3*q+2*(1-q);v<<=2*q+3*(1-q);B=Math.max(n,(b.xLL&D)>>p);z=Math.max(v,(b.yLL&J)>>r);p=Math.min(n+8*q+4*(1-q),(b.xTR&D)>>p);r=Math.min(v+4*q+8*(1-q),(b.yTR&J)>>r);
for(D=J=null;z<=r;z++)for(let K=B;K<=p;K++){const F=e.children[K-n+(z-v)*(8*q+4*(1-q))];F&&(J||(J=F,J.next=e.next),D&&(D.next=F),D=F,F.next=e.next)}e=J||e.next}}return a};g._linkChildren=function(e){let a=null,b=null;for(let l=0;l<=e.children.length;l++){const q=e.children[l];q&&(a||(a=q,a.next=e.next),b&&(b.next=q),b=q,q.next=e.next)}return a};g._updateStatisticsCursor=function(e,a,b){for(const n of this._statisticFields){const v=n.name,B=n.inField?e.readAttribute(n.inField):e.getComputedNumericAtIndex(n.inFieldIndex);
switch(n.statisticType){case "min":if(isNaN(B))break;if(!a.statistics[v]){a.statistics[v]={value:B};break}a.statistics[v].value=Math.min(a.statistics[v].value,B);break;case "max":if(isNaN(B))break;if(!a.statistics[v]){a.statistics[v]={value:B};break}a.statistics[v].value=Math.max(a.statistics[v].value,B);break;case "sum":case "avg":a.statistics[v]||(a.statistics[v]={value:0,nanCount:0});var l=a.statistics[v].value,q=a.statistics[v].nanCount??0;null==B||isNaN(B)?a.statistics[v].nanCount=q+b:a.statistics[v].value=
l+b*B;break;case "avg_angle":a.statistics[v]||(a.statistics[v]={x:0,y:0,nanCount:0});l=a.statistics[v].x;q=a.statistics[v].y;const z=a.statistics[v].nanCount??0,p=Math.PI/180;null==B||isNaN(B)?a.statistics[v].nanCount=z+b:(a.statistics[v].x=l+b*Math.cos(B*p),a.statistics[v].y=q+b*Math.sin(B*p));break;case "mode":a.statistics[v]||(a.statistics[v]={}),a.statistics[v][B]=(a.statistics[v][B]||0)+b}}};g._aggregateStatistics=function(e,a){for(const b of this._statisticFields){const l=b.name;switch(b.statisticType){case "min":if(!e[l]){e[l]=
{value:a[l].value};break}e[l].value=Math.min(e[l].value,a[l].value);break;case "max":if(!e[l]){e[l]={value:a[l].value};break}e[l].value=Math.max(e[l].value,a[l].value);break;case "sum":case "avg":case "avg_angle":case "mode":e[l]||(e[l]={});for(const q in a[l])e[l][q]=(e[l][q]||0)+a[l][q]}}};g.normalizeStatistics=function(e,a){const b={};for(const q of this._statisticFields){const n=q.name;switch(q.statisticType){case "min":case "max":var l=e[n];if(!a||!l)break;b[n]=l.value;break;case "count":if(!a)break;
b[n]=a;break;case "sum":if(!a)break;const {value:v,nanCount:B}=e[n];if(!(a-B))break;b[n]=v;break;case "avg":if(!a)break;const {value:z,nanCount:p}=e[n];if(!(a-p))break;b[n]=z/(a-p);break;case "avg_angle":if(!a)break;const {x:r,y:D,nanCount:J}=e[n];if(!(a-J))break;b[n]=180/Math.PI*Math.atan2(D/(a-J),r/(a-J));break;case "mode":l=e[n];let K=0,F=0,A=null;for(const I in l){const G=l[I];G===K?F+=1:G>K&&(K=G,F=1,A=I)}b[n]="null"===A||1<F?null:A}}return b};t._createClass(k,[{key:"count",get:function(){return this._root.count}},
{key:"size",get:function(){return this._nodes}},{key:"poolSize",get:function(){return C.mapOr(this._pool,0,e=>e.size)}},{key:"depth",get:function(){let e=0;this.forEach(a=>e=Math.max(e,a.depth));return e}}]);return k}(),f=function(){function k(e,a,b,l){this.yTotal=this.xTotal=this.count=0;this.statistics={};this.referenceId=this.displayId=0;this.displayIds=new Set;this.next=null;this.yGeohashTotal=this.xGeohashTotal=this.yNode=this.xNode=this.depth=0;this._tree=e;this.children=Array(32);for(e=0;e<
this.children.length;e++)this.children[e]=null;this.xNode=a;this.yNode=b;this.depth=l}var g=k.prototype;g.realloc=function(e,a,b){for(let l=0;l<this.children.length;l++)this.children[l]=null;this.xNode=e;this.yNode=a;this.depth=b;this.next=null;this.count=this.yTotal=this.xTotal=this.referenceId=this.displayId=this.yGeohashTotal=this.xGeohashTotal=0;this.statistics={};this.displayIds.clear();return this};g.add=function(e){this.displayIds.add(e)};g.remove=function(e){this.displayIds.delete(e)};g.getAttributes=
function(){const e=this._tree.normalizeStatistics(this.statistics,this.count);e.referenceId=null;e.aggregateId=this.id;e.aggregateCount=this.count;return e};g.getGeometry=function(e,a){const b=this.getLngLatBounds(),[l,q,n,v]=b;e=h.project({rings:[[[l,q],[l,v],[n,v],[n,q],[l,q]]]},y.WGS84,e);e=x.convertFromPolygon(new m,e,!1,!1);return C.isSome(a)?x.quantizeOptimizedGeometry(new m,e,!1,!1,"esriGeometryPolygon",a,!1,!1):e};g.getGeometryCentroid=function(e,a){const b=this.getLngLatBounds(),[l,q,n,v]=
b;e=h.project({x:(l+n)/2,y:(q+v)/2},y.WGS84,e);e=x.convertFromPoint(new m,e);return C.isSome(a)?x.quantizeOptimizedGeometry(new m,e,!1,!1,"esriGeometryPoint",a,!1,!1):e};g.getLngLatBounds=function(){var e=this.depth;const a=Math.ceil(e/2);e=Math.floor(e/2);return w.decodeGeohashXY({geohashX:this.xNode<<30-(3*a+2*e),geohashY:this.yNode<<30-(2*a+3*e)},this.depth)};g.find=function(e,a,b,l,q,n){if(l>=b)return this;var v=1-l%2;const B=3*v+2*(1-v),z=2*v+3*(1-v),p=30-q-B,r=30-n-z;v=this.children[((e&7*v+
3*(1-v)<<p)>>p)+((a&3*v+7*(1-v)<<r)>>r)*(8*v+4*(1-v))];return null==v?null:v.find(e,a,b,l+1,q+B,n+z)};t._createClass(k,[{key:"id",get:function(){return`${this.xNode}.${this.yNode}`}}]);return k}();u.GeohashNode=f;u.GeohashTree=d;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/geohash/geohashUtils":function(){define(["exports"],function(u){function t(d){return 57>=d?d-48:104>=d?d-88:107>=d?d-89:110>=d?d-90:d-91}function H(d,f,k){d[0]=f;d[1]=k;return d}function C(d,f){const k=
(d[0]+d[1])/2,g=!f;d[0]=g*d[0]+f*k;d[1]=g*k+f*d[1]}function w(d,f){f=f>(d[0]+d[1])/2;C(d,f);return f}function y(d,f){return f?1&d|(4&d)>>1|(16&d)>>2:(2&d)>>1|(8&d)>>2}function x(d,f){return f?(2&d)>>1|(8&d)>>2:1&d|(4&d)>>1|(16&d)>>2}function m(d,f,k){var g=!((d.length-1)%2);const e=d.substring(0,d.length-1);var a=t(d.charCodeAt(d.length-1)),b=0,l=0;let q=0;var n=0;g?(b=8,l=4,q=1&a|(4&a)>>1|(16&a)>>2,n=(2&a)>>1|(8&a)>>2):(b=4,l=8,n=1&a|(4&a)>>1|(16&a)>>2,q=(2&a)>>1|(8&a)>>2);f=q+f;a=n+k;k=Math.floor(f/
b);n=Math.floor(a/l);b=f-k*b;l=a-n*l;g="0123456789bcdefghjkmnpqrstuvwxyz"[g?b&1|(l&1)<<1|(b&2)<<1|(l&2)<<2|(b&4)<<2:l&1|(b&1)<<1|(l&2)<<1|(b&2)<<2|(l&4)<<2];return 1<d.length&&(k||n)?m(e,k,n)+g:e+g}const h=new Float64Array(2),c=new Float64Array(2);u.convertGeohash32ToXY=function(d,f){let k=d=0,g=30,e=30;for(let l=0;l<f.length;l++){var a=f.charCodeAt(l),b=t(a);a=0===l%2;const q=y(b,a);b=x(b,a);g-=a?3:2;e-=a?2:3;d|=q<<g;k|=b<<e}return{geohashX:d,geohashY:k}};u.decodeBase32Char=t;u.decodeGeohash=function(d,
f){const k=H(h,-90,90),g=H(c,-180,180);for(let a=0;a<f.length;a++){var e=f.charCodeAt(a);e=t(e);0===a%2?(C(g,!!(16&e)),C(g,!!(4&e)),C(g,!!(1&e)),C(k,!!(8&e)),C(k,!!(2&e))):(C(k,!!(16&e)),C(k,!!(4&e)),C(k,!!(1&e)),C(g,!!(8&e)),C(g,!!(2&e)))}d[0]=(k[0]+k[1])/2;d[1]=(g[0]+g[1])/2;return d};u.decodeGeohashXY=function(d,f){let k=-90,g=90,e=-180,a=180;for(let B=0;B<f;B++){var b=Math.ceil((B+1)/2),l=Math.floor((B+1)/2),q=1-B%2,n=30-(3*b+2*l),v=30-(2*b+3*l);l=3*q+2*(1-q);b=2*q+3*(1-q);n=(7*q+3*(1-q)<<n&d.geohashX)>>
n;q=(3*q+7*(1-q)<<v&d.geohashY)>>v;for(--l;0<=l;l--){v=(e+a)/2;const z=n&1<<l?1:0;e=(1-z)*e+z*v;a=(1-z)*v+z*a}for(--b;0<=b;b--)n=(k+g)/2,l=q&1<<b?1:0,k=(1-l)*k+l*n,g=(1-l)*n+l*g}return[e,k,a,g]};u.encodeBase32Char=function(d){return"0123456789bcdefghjkmnpqrstuvwxyz"[d]};u.encodeGeohash=function(d,f,k){let g="";const e=H(h,-90,90),a=H(c,-180,180);for(let b=0;b<k;b++){let l=0;b%2?(l|=w(e,d)<<4,l|=w(a,f)<<3,l|=w(e,d)<<2,l|=w(a,f)<<1,l|=w(e,d)<<0):(l|=w(a,f)<<4,l|=w(e,d)<<3,l|=w(a,f)<<2,l|=w(e,d)<<1,
l|=w(a,f)<<0);g+="0123456789bcdefghjkmnpqrstuvwxyz"[l]}return g};u.getRelativeGeohash=m;u.setGeohashBuf=function(d,f,k,g,e){e%2&&(e+=1);let a=0,b=0,l=-90,q=90,n=-180,v=180;for(let r=0;r<e/2;r++){for(var B=0;5>B;B++){var z=(n+v)/2,p=g>z?1:0;a|=p<<29-(B+5*r);n=(1-p)*n+p*z;v=(1-p)*z+p*v}for(B=0;5>B;B++)z=(l+q)/2,p=k>z?1:0,b|=p<<29-(B+5*r),l=(1-p)*l+p*z,q=(1-p)*z+p*q}d[2*f]=a;d[2*f+1]=b};u.setGeohashXY=function(d,f,k,g){g%2&&(g+=1);let e=0,a=0,b=-90,l=90,q=-180,n=180;for(let p=0;p<g/2;p++){for(var v=
0;5>v;v++){var B=(q+n)/2,z=k>B?1:0;e|=z<<29-(v+5*p);q=(1-z)*q+z*B;n=(1-z)*B+z*n}for(v=0;5>v;v++)B=(b+l)/2,z=f>B?1:0,a|=z<<29-(v+5*p),b=(1-z)*b+z*B,l=(1-z)*B+z*l}d.geohashX=e;d.geohashY=a};u.unpackXBits=y;u.unpackYBits=x;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/ClusterStore":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry ../../../../../core/Evented ../../../../../core/has ../../../../../core/maybe ../../../../../core/accessorSupport/diffUtils ../../../../../geohash/GeohashTree ../../../../../geohash/geohashUtils ../../../../../geometry/support/aaBoundingBox ../../../../../geometry/support/Ellipsoid ../../../../../geometry/support/spatialReferenceUtils ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedFeature ../../../../../layers/graphics/OptimizedGeometry ../../../../../layers/graphics/data/projectionSupport ../../../engine/webgl/definitions ../../../engine/webgl/DisplayId ../FeatureStore2D ../Store2D ./FeatureSetReaderJSON ../../../../../geometry/SpatialReference ../../../../../geometry/Polygon ../../../../../geometry/Extent".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f,k,g,e,a,b,l,q,n,v,B,z,p){const r=c.create();let D=function(J){function K(A,I,G,E,M){I=new e([],[I,G]);A=J.call(this,I,E,null,A)||this;A.geohashBoundsInfo=M;return A}t._inheritsLoose(K,J);K.create=function(A,I,G,E,M,T,Y,fa){I=new K(I,G,E,T,Y);I.displayId=A.createDisplayId(!0);I.referenceId=fa;I.tileLevel=M;return I};var F=K.prototype;F.update=function(A,I,G,E,M,T){this.geometry.coords[0]=A;this.geometry.coords[1]=I;this.tileLevel=G;this.attributes=E;this.geohashBoundsInfo=
M;this.referenceId=null;this.referenceId=T;return this};F.toJSON=function(){return{attributes:{...this.attributes,aggregateId:this.objectId,referenceId:1===this.attributes.cluster_count?this.referenceId:null},geometry:{x:this.geometry.coords[0],y:this.geometry.coords[1]}}};t._createClass(K,[{key:"count",get:function(){return this.attributes.cluster_count}}]);return K}(g.OptimizedFeatureWithGeometry);H=function(J){function K(A,I,G,E){var M=J.call(this,A,G)||this;M.type="cluster";M.events=new C;M.objectIdField=
"aggregateId";M.featureAdapter=q.featureAdapter;M._geohashLevel=0;M._tileLevel=0;M._aggregateValueRanges={};M._aggregateValueRangesChanged=!1;M._geohashBuf=[];M._clusters=new Map;M._tiles=new Map;M._serviceInfo=E;M.geometryInfo=A.geometryInfo;M._spatialReference=I;M._projectionSupportCheck=a.checkProjectionSupport(I,B.WGS84);M._bitsets.geohash=G.getBitset(G.createBitset());M._bitsets.inserted=G.getBitset(G.createBitset());return M}t._inheritsLoose(K,J);var F=K.prototype;F.destroy=function(){this._tree.destroy()};
F.updateSchema=function(){var A=t._asyncToGenerator(function*(I,G){const E=this._schema;try{yield J.prototype.updateSchema.call(this,I,G),yield this._projectionSupportCheck}catch(T){}this._fields=this._schema.params.fields;const M=x.diff(E,G);if(!G||y.isNone(M)&&!I.source&&!I.storage.filters)E&&(I.mesh=!0);else{if(x.hasDiff(M,"params.fields")||!this._tree||I.source)this._tree&&this._tree.destroy(),this._tree=new m.GeohashTree(this._statisticFields,this._serviceInfo),this._rebuildTree(),w("esri-2d-update-debug")&&
console.debug("Aggregate mesh needs update due to tree changing");w("esri-2d-update-debug")&&console.debug("Applying Update - ClusterStore:",M);I.targets[G.name]=!0;I.mesh=!1;this._aggregateValueRanges={}}});return function(I,G){return A.apply(this,arguments)}}();F.clear=function(){this._rebuildTree()};F.sweepFeatures=function(A,I){this._bitsets.inserted.forEachSet(G=>{A.has(G)||(G=I.lookupByDisplayIdUnsafe(G),this._remove(G))})};F.sweepAggregates=function(A,I,G){this._clusters.forEach((E,M)=>{E&&
E.tileLevel!==G&&(A.releaseDisplayId(E.displayId),I.unsetAttributeData(E.displayId),this._clusters.delete(M))})};F.onTileData=function(A,I,G,E,M=!0){if(!this._schema||y.isNone(I.addOrUpdate))return I;this.events.emit("changed");var T=this._getTransforms(A,this._spatialReference);const Y=I.addOrUpdate.getCursor();for(;Y.next();)this._update(Y,E);if(I.status.mesh||!M)return I;E=[];this._getClustersForTile(E,A,this._schema.params.clusterRadius,G,T);I.addOrUpdate=v.FeatureSetReaderJSON.fromOptimizedFeatures(E,
this._serviceInfo);I.addOrUpdate.attachStorage(G);I.clear=!0;I.end=!0;for(T=I.addOrUpdate.getCursor();T.next();)E=T.getDisplayId(),this._bitsets.computed.unset(E),this.setComputedAttributes(G,T,E,A.scale);this._aggregateValueRangesChanged&&I.end&&(this.events.emit("valueRangesChanged",{valueRanges:this._aggregateValueRanges}),this._aggregateValueRangesChanged=!1);return I};F.onTileUpdate=function({added:A,removed:I}){A.length&&(this._tileLevel=A=A[0].level,this._setGeohashLevel(A));if(this._schema){var G=
this._schema.params.clusterRadius;I.forEach(E=>{this._tiles.delete(E.key.id);this._markTileClustersForDeletion(E,G)})}};F.getAggregate=function(A){for(const I of this._clusters.values())if((I?.displayId&l.DISPLAY_ID_TEXEL_MASK)===(A&l.DISPLAY_ID_TEXEL_MASK))return I.toJSON();return null};F.getAggregates=function(){const A=[];for(const I of this._clusters.values())I?.tileLevel===this._tileLevel&&A.push(I.toJSON());return A};F.getDisplayId=function(A){return(A=this._clusters.get(A))?A.displayId:null};
F.getFeatureDisplayIdsForAggregate=function(A){return(A=this._clusters.get(A))?this._tree.getRegionDisplayIds(A.geohashBoundsInfo):[]};F.getDisplayIdForReferenceId=function(A){for(const I of this._clusters.values())if(I?.referenceId===A)return I.displayId;return null};F.getAggregateValueRanges=function(){return this._aggregateValueRanges};F.forEach=function(A){this._clusters.forEach(I=>{I&&(I=I.toJSON(),I=v.FeatureSetReaderJSON.fromFeatures([I],{objectIdField:this.objectIdField,globalIdField:null,
geometryType:this.geometryInfo.geometryType,fields:this.fields}).getCursor(),I.next(),A(I))})};F.forEachInBounds=function(A,I){};F.forEachBounds=function(A,I){const {hasM:G,hasZ:E}=this.geometryInfo;for(const M of A)A=k.getBoundsOptimizedGeometry(r,M.readGeometry(),E,G),y.isNone(A)||I(A)};F.size=function(){let A=0;this.forEach(I=>A++);return A};F._rebuildTree=function(){this._bitsets.computed.clear();this._bitsets.inserted.clear();this._tree&&this._tree.clear()};F._remove=function(A){const I=A.getDisplayId(),
G=A.getXHydrated(),E=A.getYHydrated(),M=this._geohashBuf[2*I],T=this._geohashBuf[2*I+1];this._bitsets.inserted.has(I)&&(this._bitsets.inserted.unset(I),this._tree.removeCursor(A,G,E,M,T,this._geohashLevel))};F._update=function(A,I){const G=A.getDisplayId(),E=this._bitsets.inserted;I=I.isVisible(G);var M=E.has(G);I!==M&&(I?(I=A.getXHydrated(),M=A.getYHydrated(),this._setGeohash(G,I,M)&&(this._tree.insertCursor(A,G,I,M,this._geohashBuf[2*G],this._geohashBuf[2*G+1],this._geohashLevel),E.set(G))):this._remove(A))};
F._setGeohash=function(A,I,G){if(this._bitsets.geohash.has(A))return!0;const E=this._geohashBuf;if(this._spatialReference.isWebMercator)I=I/d.earth.radius*57.29577951308232,h.setGeohashBuf(E,A,57.29577951308232*(Math.PI/2-2*Math.atan(Math.exp(-G/d.earth.radius))),I-360*Math.floor((I+180)/360),12);else{G=a.project({x:I,y:G},this._spatialReference,B.WGS84);if(!G)return!1;h.setGeohashBuf(E,A,G.y,G.x,12)}this._bitsets.geohash.set(A);return!0};F._getClustersForTile=function(A,I,G,E,M,T=!0){var Y=2*G;G=
Math.ceil(2**I.key.level*b.TILE_SIZE/Y)+1;var fa=Math.ceil(this._schema.params.clusterPixelBuffer/Y)+0,ba=Math.ceil(b.TILE_SIZE/Y);const {row:U,col:P}=I.key;var Q=Math.floor(P*b.TILE_SIZE/Y)-fa;Y=Math.floor(U*b.TILE_SIZE/Y)-fa;const Z=Q+ba+2*fa;fa=Y+ba+2*fa;for(ba=I.tileInfoView.getLODInfoAt(I.key.level);Q<=Z;Q++)for(let Aa=Y;Aa<=fa;Aa++){var X=Q;ba.wrap&&(X=0>Q?Q+G:Q%G);const Da=ba.wrap&&0>Q,ha=ba.wrap&&Q%G!==Q;X=this._lookupCluster(E,ba,I.key.level,X,Aa,I);if(y.isSome(X)){var sa=y.applySome(M,Ea=>
Da?Ea.left:ha?Ea.right:Ea.tile);if((!T||!y.isNone(sa))&&X.count&&y.isSome(sa)&&T){const Ea=X.geometry.clone();let za=X.attributes;Ea.coords[0]=k.quantizeX(sa,Ea.coords[0]);Ea.coords[1]=k.quantizeY(sa,Ea.coords[1]);1===X.count&&y.isSome(X.referenceId)&&(za={...X.attributes,referenceId:X.referenceId});sa=new g.OptimizedFeature(Ea,za);sa.displayId=X.displayId;A.push(sa)}}}};F._getGeohashLevel=function(A){return Math.min(Math.ceil(A/2+2),12)};F._setGeohashLevel=function(A){A=this._getGeohashLevel(A);
A=1*(Math.floor(A/1)+1)-1;this._geohashLevel!==A&&(this._geohashLevel=A,this._rebuildTree(),this._bitsets.geohash.clear())};F._getTransforms=function(A,I){const G={originPosition:"upperLeft",scale:[A.resolution,A.resolution],translate:[A.bounds[0],A.bounds[3]]};I=f.getInfo(I);if(!I)return{tile:G,left:null,right:null};const [E,M]=I.valid;return{tile:G,left:{...G,translate:[M,A.bounds[3]]},right:{...G,translate:[E-M+A.bounds[0],A.bounds[3]]}}};F._getClusterId=function(A,I,G){return(A&15)<<28|(I&16383)<<
14|G&16383};F._markForDeletion=function(A,I,G){A=this._getClusterId(A,I,G);this._clusters.delete(A)};F._getClusterBounds=function(A,I,G){var E=this._schema.params.clusterRadius,M=2*E;I=G%2?I*M:I*M-E;const T=G*M;E=I+M;G=2**A.level*b.TILE_SIZE;A.wrap&&0>I&&(I=0);A.wrap&&E>G&&(E=G);G=T/b.TILE_SIZE;E/=b.TILE_SIZE;M=(T-M)/b.TILE_SIZE;I=A.getXForColumn(I/b.TILE_SIZE);G=A.getYForRow(G);E=A.getXForColumn(E);A=A.getYForRow(M);return[I,G,E,A]};F._getGeohash=function(A,I,G){const E={geohashX:0,geohashY:0};h.setGeohashXY(E,
I,A,G);return E};F._getGeohashBounds=function(A,I){const G=this._getGeohashLevel(A.key.level);if(this._spatialReference.isWebMercator){const [ba,U,P,Q]=I;var E=U,M=P,T=Q,Y=A=I=0,fa=0;I=ba/d.earth.radius*57.29577951308232;I-=360*Math.floor((I+180)/360);A=57.29577951308232*(Math.PI/2-2*Math.atan(Math.exp(-E/d.earth.radius)));Y=M/d.earth.radius*57.29577951308232;Y-=360*Math.floor((Y+180)/360);fa=57.29577951308232*(Math.PI/2-2*Math.atan(Math.exp(-T/d.earth.radius)));T={geohashX:0,geohashY:0};E={geohashX:0,
geohashY:0};h.setGeohashXY(T,A,I,G);h.setGeohashXY(E,fa,Y,G);return{bounds:[ba,U,P,Q],geohashBounds:{xLL:T.geohashX,yLL:T.geohashY,xTR:E.geohashX,yTR:E.geohashY},level:G}}T=z.fromExtent(p.fromBounds(I,this._spatialReference));A=a.project(T,this._spatialReference,B.WGS84,{densificationStep:64*A.resolution});if(!A)return null;A=k.convertFromPolygon(new e,A,!1,!1);Y=A.coords.filter((ba,U)=>!(U%2));fa=A.coords.filter((ba,U)=>U%2);A=Math.min(...Y);T=Math.min(...fa);Y=Math.max(...Y);fa=Math.max(...fa);
A=this._getGeohash(A,T,G);T=this._getGeohash(Y,fa,G);return{bounds:I,geohashBounds:{xLL:A.geohashX,yLL:A.geohashY,xTR:T.geohashX,yTR:T.geohashY},level:G}};F._lookupCluster=function(A,I,G,E,M,T){const Y=this._getClusterId(G,E,M),fa=this._clusters.get(Y);I=this._getClusterBounds(I,E,M);T=this._getGeohashBounds(T,I);if(y.isNone(T))return null;var ba=this._tree.getRegionStatistics(T);const {count:U,xTotal:P,yTotal:Q,referenceId:Z}=ba;E=U?P/U:0;M=U?Q/U:0;if(0===U)return this._clusters.set(Y,null),null;
ba={cluster_count:U,...ba.attributes};A=y.isSome(fa)?fa.update(E,M,G,ba,T,Z):D.create(A,Y,E,M,G,ba,T,Z);if(0===U){const [X,sa,Aa,Da]=I;A.geometry.coords[0]=(X+Aa)/2;A.geometry.coords[1]=(sa+Da)/2}this._clusters.set(Y,A);this._updateAggregateValueRangeForCluster(A,A.tileLevel);return A};F._updateAggregateValueRangeForCluster=function(A,I){const G=this._aggregateValueRanges[I]||{minValue:Infinity,maxValue:0},E=G.minValue,M=G.maxValue;G.minValue=Math.min(E,A.count);G.maxValue=Math.max(M,A.count);this._aggregateValueRanges[I]=
G;if(E!==G.minValue||M!==G.maxValue)this._aggregateValueRangesChanged=!0};F._markTileClustersForDeletion=function(A,I){var G=2*I;I=Math.ceil(b.TILE_SIZE/G);const {row:E,col:M}=A.key,T=Math.floor(M*b.TILE_SIZE/G);G=Math.floor(E*b.TILE_SIZE/G);for(let Y=T;Y<T+I;Y++)for(let fa=G;fa<G+I;fa++)this._markForDeletion(A.key.level,Y,fa)};t._createClass(K,[{key:"featureSpatialReference",get:function(){return this._spatialReference}},{key:"fields",get:function(){return this._fields}}]);return K}(n.Store2D);u.ClusterInfo=
D;u.ClusterStore=H;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/ComputedAttributeStorage":function(){define(["exports","../../../engine/webgl/DisplayId","./DisplayIdGenerator","./StaticBitSet"],function(u,t,H,C){function w(x,m,h){if(!(x.length>m))for(;x.length<=m;)x.push(h)}let y=function(){function x(){this._numerics=[];this._strings=[];this._idGenerator=new H.DisplayIdGenerator;this._allocatedSize=256;this._bitsets=[];this._instanceIds=[];
this._bounds=[]}var m=x.prototype;m.createBitset=function(){const h=this._bitsets.length;this._bitsets.push(C.StaticBitSet.create(this._allocatedSize,t.DISPLAY_ID_TEXEL_MASK));return h+1};m.getBitset=function(h){return this._bitsets[h-1]};m._expand=function(){this._allocatedSize<<=1;for(const h of this._bitsets)h.resize(this._allocatedSize)};m._ensureNumeric=function(h,c){this._numerics[h]||(this._numerics[h]=[]);w(this._numerics[h],c,0)};m._ensureInstanceId=function(h){w(this._instanceIds,h,0)};
m._ensureString=function(h,c){this._strings[h]||(this._strings[h]=[]);w(this._strings[h],c,null)};m.createDisplayId=function(h=!1){const c=this._idGenerator.createId();c>this._allocatedSize&&this._expand();return t.createDisplayId(c,h)};m.releaseDisplayId=function(h){for(const c of this._bitsets)c.unset(h);return this._idGenerator.releaseId(h&t.DISPLAY_ID_TEXEL_MASK)};m.getComputedNumeric=function(h,c){return this.getComputedNumericAtIndex(h&t.DISPLAY_ID_TEXEL_MASK,0)};m.setComputedNumeric=function(h,
c,d){return this.setComputedNumericAtIndex(h&t.DISPLAY_ID_TEXEL_MASK,d,0)};m.getComputedString=function(h,c){return this.getComputedStringAtIndex(h&t.DISPLAY_ID_TEXEL_MASK,0)};m.setComputedString=function(h,c,d){return this.setComputedStringAtIndex(h&t.DISPLAY_ID_TEXEL_MASK,0,d)};m.getComputedNumericAtIndex=function(h,c){h&=t.DISPLAY_ID_TEXEL_MASK;this._ensureNumeric(c,h);return this._numerics[c][h]};m.setComputedNumericAtIndex=function(h,c,d){h&=t.DISPLAY_ID_TEXEL_MASK;this._ensureNumeric(c,h);this._numerics[c][h]=
d};m.getInstanceId=function(h){h&=t.DISPLAY_ID_TEXEL_MASK;this._ensureInstanceId(h);return this._instanceIds[h]};m.setInstanceId=function(h,c){h&=t.DISPLAY_ID_TEXEL_MASK;this._ensureInstanceId(h);this._instanceIds[h]=c};m.getComputedStringAtIndex=function(h,c){h&=t.DISPLAY_ID_TEXEL_MASK;this._ensureString(c,h);return this._strings[c][h]};m.setComputedStringAtIndex=function(h,c,d){h&=t.DISPLAY_ID_TEXEL_MASK;this._ensureString(c,h);this._strings[c][h]=d};m.getXMin=function(h){return this._bounds[4*
(h&t.DISPLAY_ID_TEXEL_MASK)]};m.getYMin=function(h){return this._bounds[4*(h&t.DISPLAY_ID_TEXEL_MASK)+1]};m.getXMax=function(h){return this._bounds[4*(h&t.DISPLAY_ID_TEXEL_MASK)+2]};m.getYMax=function(h){return this._bounds[4*(h&t.DISPLAY_ID_TEXEL_MASK)+3]};m.setBounds=function(h,c){c=c.readHydratedGeometry();if(!c||!c.coords.length)return!1;let d=Infinity,f=Infinity,k=-Infinity,g=-Infinity;c.forEachVertex((e,a)=>{d=Math.min(d,e);f=Math.min(f,a);k=Math.max(k,e);g=Math.max(g,a)});h&=t.DISPLAY_ID_TEXEL_MASK;
w(this._bounds,4*h+4,0);this._bounds[4*h]=d;this._bounds[4*h+1]=f;this._bounds[4*h+2]=k;this._bounds[4*h+3]=g;return!0};return x}();u.ComputedAttributeStorage=y;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/DisplayIdGenerator":function(){define(["exports","../../../engine/webgl/DisplayId"],function(u,t){let H=function(){function C(){this._freeIds=[];this._idCounter=1}var w=C.prototype;w.createId=function(y=!1){return t.createDisplayId(this._getFreeId(),
y)};w.releaseId=function(y){this._freeIds.push(y)};w._getFreeId=function(){return this._freeIds.length?this._freeIds.pop():this._idCounter++};return C}();u.DisplayIdGenerator=H;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/TileStore":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Evented ../../../../../core/has ../../../../../chunks/rbush ./Tile ../../../tiling/TileCoverage ../../../tiling/TileKey".split(" "),
function(u,t,H,C,w,y,x){const m={added:[],removed:[]},h=new Set,c=new x(0,0,0,0);return function(d){function f(g){var e=d.call(this)||this;e._tiles=new Map;e._index=C.rbush(9,H("esri-csp-restrictions")?a=>({minX:a.bounds[0],minY:a.bounds[1],maxX:a.bounds[2],maxY:a.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]);e.tiles=[];e.tileScheme=g;return e}u._inheritsLoose(f,d);var k=f.prototype;k.destroy=function(){this.clear()};k.clear=function(){this.tiles.length=0;this._tiles.clear();
this._index.clear()};k.has=function(g){return this._tiles.has(g)};k.get=function(g){return this._tiles.get(g)};k.boundsIntersections=function(g){return this._index.search({minX:g[0],minY:g[1],maxX:g[2],maxY:g[3]})};k.updateTiles=function(g){const e={added:[],removed:[]};for(const a of g.added)if(!this.has(a)){const b=new w.Tile(this.tileScheme,a);this._tiles.set(a,b);this._index.insert(b);e.added.push(b)}for(const a of g.removed)this.has(a)&&(g=this.get(a),this._tiles.delete(a),this._index.remove(g),
e.removed.push(g));this.tiles.length=0;this._tiles.forEach(a=>this.tiles.push(a));(e.added.length||e.removed.length)&&this.emit("update",e)};k.setViewState=function(g){if(g=this.tileScheme.getTileCoverage(g,0)){var {spans:e,lodInfo:a}=g,{level:b}=a;if(0<e.length)for(const {row:q,colFrom:n,colTo:v}of e)for(var l=n;l<=v;l++){const B=c.set(b,q,a.normalizeCol(l),a.getWorldForColumn(l)).id;h.add(B);if(!this.has(B)){const z=new w.Tile(this.tileScheme,B);this._tiles.set(B,z);this._index.insert(z);this.tiles.push(z);
m.added.push(z)}}for(b=this.tiles.length-1;0<=b;b--)l=this.tiles[b],h.has(l.id)||(this._tiles.delete(l.id),this.tiles.splice(b,1),this._index.remove(l),m.removed.push(l));(m.added.length||m.removed.length)&&this.emit("update",m);y.pool.release(g);h.clear();m.added.length=0;m.removed.length=0}};return f}(t)})},"esri/views/2d/layers/features/support/Tile":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/ArrayPool ../../../../../geometry/Extent ../../../../../geometry/support/aaBoundingRect ../../../../../rest/support/QuantizationParameters ../../../tiling/TileKey".split(" "),
function(u,t,H,C,w,y,x){let m=function(){function h(d,f){this.key=new x(0,0,0,0);this.bounds=w.create();this.objectIds=new Set;this.key.set(f);f=d.getLODInfoAt(this.key);this.tileInfoView=d;this.tileInfoView.getTileBounds(this.bounds,this.key,!0);this.resolution=f.resolution;this.scale=f.scale;this.level=f.level}var c=h.prototype;c.createChildTiles=function(){const d=this.key.getChildKeys(),f=H.acquire();for(let k=0;k<d.length;k++)f[k]=new h(this.tileInfoView,d[k]);return f};c.getQuantizationParameters=
function(){return y.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})};t._createClass(h,[{key:"id",get:function(){return this.key.id}},{key:"extent",get:function(){return C.fromBounds(this.bounds,this.tileInfoView.tileInfo.spatialReference)}},{key:"transform",get:function(){return{originPosition:"upperLeft",scale:[this.resolution,
this.resolution],translate:[this.bounds[0],this.bounds[3]]}}}]);return h}();u.Tile=m;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/tiling/TileKey":function(){define(["../../../chunks/_rollupPluginBabelHelpers","../../../core/ObjectPool"],function(u,t){let H=function(){function C(y,x,m,h){this.set(y,x,m,h)}C.getId=function(y,x,m,h){return"object"===typeof y?`${y.level}/${y.row}/${y.col}/${y.world}`:`${y}/${x}/${m}/${h}`};var w=C.prototype;w.acquire=function(y,x,m,h){this.set(y,
x,m,h)};w.contains=function(y){const x=y.level-this.level;return 0<=x&&this.row===y.row>>x&&this.col===y.col>>x&&this.world===y.world};w.equals=function(y){return this.level===y.level&&this.row===y.row&&this.col===y.col&&this.world===y.world};w.clone=function(){return new C(this)};w.release=function(){this.world=this.col=this.row=this.level=0};w.set=function(y,x,m,h){if(null==y)this.world=this.col=this.row=this.level=0;else if("object"===typeof y)this.level=y.level||0,this.row=y.row||0,this.col=y.col||
0,this.world=y.world||0;else if("string"===typeof y){const [c,d,f,k]=y.split("/");this.level=parseFloat(c);this.row=parseFloat(d);this.col=parseFloat(f);this.world=parseFloat(k)}else this.level=+y,this.row=+x,this.col=+m,this.world=+h||0;return this};w.toString=function(){return`${this.level}/${this.row}/${this.col}/${this.world}`};w.getParentKey=function(){return 0>=this.level?null:new C(this.level-1,this.row>>1,this.col>>1,this.world)};w.getChildKeys=function(){const y=this.level+1,x=this.row<<
1,m=this.col<<1,h=this.world;return[new C(y,x,m,h),new C(y,x,m+1,h),new C(y,x+1,m,h),new C(y,x+1,m+1,h)]};w.compareRowMajor=function(y){return this.row<y.row?-1:this.row>y.row?1:this.col<y.col?-1:this.col>y.col?1:0};u._createClass(C,[{key:"key",get:function(){return this}},{key:"id",get:function(){return this.toString()},set:function(y){this.set(y)}},{key:"hash",get:function(){return(this.world&3)<<30|(this.col&4095)<<22|(this.row&4095)<<8|this.level&63}}]);return C}();H.pool=new t(H,null,null,25,
50);return H})},"esri/views/2d/tiling/TileCoverage":function(){define(["../../../core/ObjectPool"],function(u){let t=function(){function H(){this.spans=[]}var C=H.prototype;C.acquire=function(w){this.lodInfo=w};C.release=function(){this.lodInfo=null;this.spans.length=0};C.forEach=function(w,y){const {spans:x,lodInfo:m}=this,{level:h}=m;if(0!==x.length)for(const {row:c,colFrom:d,colTo:f}of x)for(let k=d;k<=f;k++)w.call(y,h,c,m.normalizeCol(k),m.getWorldForColumn(k))};return H}();t.pool=new u(t);return t})},
"esri/views/2d/tiling/TileInfoView":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../geometry/support/spatialReferenceUtils ./LODInfo ./TileCoverage ./TileKey ./TileSpan".split(" "),function(u,t,H,C,w,y){const x=new w("0/0/0/0");let m=function(){function c(f,k,g,e,a,b,l,q){this.x=f;this.ymin=k;this.ymax=g;this.invM=e;this.leftAdjust=a;this.rightAdjust=b;this.leftBound=l;this.rightBound=q}c.create=function(f,k){f[1]>k[1]&&([f,k]=[k,f]);const [g,e]=f,[a,b]=k;f=a-g;k=b-e;k=0!==k?
f/k:0;const l=(Math.ceil(e)-e)*k,q=(Math.floor(e)-e)*k;return new c(g,Math.floor(e),Math.ceil(b),k,0>f?l:q,0>f?q:l,0>f?a:g,0>f?g:a)};var d=c.prototype;d.incrRow=function(){this.x+=this.invM};d.getLeftCol=function(){return Math.max(this.x+this.leftAdjust,this.leftBound)};d.getRightCol=function(){return Math.min(this.x+this.rightAdjust,this.rightBound)};return c}();const h=[[0,0],[0,0],[0,0],[0,0]];return function(){function c(f,k=null){this.tileInfo=f;this.fullExtent=k;this.scales=[];this._infoByScale=
{};this._infoByLevel={};const g=f.lods.slice();g.sort((a,b)=>b.scale-a.scale);const e=this._lodInfos=g.map(a=>H.create(f,a,k));g.forEach((a,b)=>{this._infoByLevel[a.level]=e[b];this._infoByScale[a.scale]=e[b];this.scales[b]=a.scale},this);this._wrap=f.isWrappable}var d=c.prototype;d.getLODInfoAt=function(f){return this._infoByLevel["number"===typeof f?f:f.level]};d.getTileBounds=function(f,k,g=!1){x.set(k);return(k=this._infoByLevel[x.level])?k.getTileBounds(f,x,g):f};d.getTileCoords=function(f,k,
g=!1){x.set(k);return(k=this._infoByLevel[x.level])?k.getTileCoords(f,x,g):f};d.getTileCoverage=function(f,k=192,g="closest"){g="closest"===g?this.getClosestInfoForScale(f.scale):this.getSmallestInfoForScale(f.scale);const e=C.pool.acquire(g),a=this._wrap;var b=Infinity;let l=-Infinity;const q=e.spans;h[0][0]=h[0][1]=h[1][1]=h[3][0]=-k;h[1][0]=h[2][0]=f.size[0]+k;h[2][1]=h[3][1]=f.size[1]+k;for(n of h)f.toMap(n,n),n[0]=g.getColumnForX(n[0]),n[1]=g.getRowForY(n[1]);f=[];var n=3;for(k=0;4>k;k++)h[k][1]===
h[n][1]?n=k:(n=m.create(h[k],h[n]),b=Math.min(n.ymin,b),l=Math.max(n.ymax,l),void 0===f[n.ymin]&&(f[n.ymin]=[]),f[n.ymin].push(n),n=k);if(null==b||null==l||100<l-b)return null;for(k=[];b<l;){null!=f[b]&&(k=k.concat(f[b]));n=Infinity;var v=-Infinity;for(var B=k.length-1;0<=B;B--){var z=k[B];n=Math.min(n,z.getLeftCol());v=Math.max(v,z.getRightCol())}n=Math.floor(n);v=Math.floor(v);if(b>=g.first[1]&&b<=g.last[1])if(a)if(g.size[0]<g.worldSize[0])for(B=Math.floor(v/g.worldSize[0]),z=Math.floor(n/g.worldSize[0]);z<=
B;z++)q.push(new y(b,Math.max(g.getFirstColumnForWorld(z),n),Math.min(g.getLastColumnForWorld(z),v)));else q.push(new y(b,n,v));else n>g.last[0]||v<g.first[0]||(n=Math.max(n,g.first[0]),v=Math.min(v,g.last[0]),q.push(new y(b,n,v)));b+=1;for(n=k.length-1;0<=n;n--)v=k[n],v.ymax>=b?v.incrRow():k.splice(n,1)}return e};d.getTileParentId=function(f){x.set(f);f=this._lodInfos.indexOf(this._infoByLevel[x.level])-1;if(0>f)return null;this._getTileIdAtLOD(x,this._lodInfos[f],x);return x.id};d.getTileResolution=
function(f){return(f=this._infoByLevel["object"===typeof f?f.level:f])?f.resolution:-1};d.getTileScale=function(f){return(f=this._infoByLevel[f.level])?f.scale:-1};d.intersects=function(f,k){x.set(k);k=this._infoByLevel[x.level];const g=f.lodInfo;if(g.resolution>k.resolution){this._getTileIdAtLOD(x,g,x);var e=g.denormalizeCol(x.col,x.world);for(var a of f.spans)if(a.row===x.row&&a.colFrom<=e&&a.colTo>=e)return!0}if(g.resolution<k.resolution){const [l,q,n,v]=f.spans.reduce((B,z)=>{B[0]=Math.min(B[0],
z.row);B[1]=Math.max(B[1],z.row);B[2]=Math.min(B[2],z.colFrom);B[3]=Math.max(B[3],z.colTo);return B},[Infinity,-Infinity,Infinity,-Infinity]);e=k.denormalizeCol(x.col,x.world);f=g.getColumnForX(k.getXForColumn(e));a=g.getRowForY(k.getYForRow(x.row));e=g.getColumnForX(k.getXForColumn(e+1))-1;k=g.getRowForY(k.getYForRow(x.row+1))-1;return!(f>v||e<n||a>q||k<l)}const b=g.denormalizeCol(x.col,x.world);return f.spans.some(l=>l.row===x.row&&l.colFrom<=b&&l.colTo>=b)};d.normalizeBounds=function(f,k,g){f[0]=
k[0];f[1]=k[1];f[2]=k[2];f[3]=k[3];this._wrap&&(k=t.getInfo(this.tileInfo.spatialReference),g=-g*(k.valid[1]-k.valid[0]),f[0]+=g,f[2]+=g);return f};d.getSmallestInfoForScale=function(f){const k=this.scales;if(this._infoByScale[f])return this._infoByScale[f];if(f>k[0])return this._infoByScale[k[0]];for(let g=1;g<k.length-1;g++)if(f>k[g]+1E-6)return this._infoByScale[k[g-1]];return this._infoByScale[k[k.length-1]]};d.getClosestInfoForScale=function(f){const k=this.scales;if(this._infoByScale[f])return this._infoByScale[f];
f=k.reduce((g,e)=>Math.abs(e-f)<Math.abs(g-f)?e:g,k[0]);return this._infoByScale[f]};d.scaleToLevel=function(f){const k=this.scales;if(this._infoByScale[f])return this._infoByScale[f].level;for(let g=k.length-1;0<=g;g--)if(f<k[g])return g===k.length-1?this._infoByScale[k[k.length-1]].level:this._infoByScale[k[g]].level+(k[g]-f)/(k[g]-k[g+1]);return this._infoByScale[k[0]].level};d.scaleToZoom=function(f){return this.tileInfo.scaleToZoom(f)};d._getTileIdAtLOD=function(f,k,g){const e=this._infoByLevel[g.level];
f.set(g);if(k.resolution<e.resolution)return null;if(k.resolution===e.resolution)return f;f.level=k.level;f.col=Math.floor(g.col*e.resolution/k.resolution+.01);f.row=Math.floor(g.row*e.resolution/k.resolution+.01);return f};u._createClass(c,[{key:"spatialReference",get:function(){return this.tileInfo.spatialReference}}]);return c}()})},"esri/views/2d/tiling/LODInfo":function(){define(["../../../core/maybe","../../../geometry/support/spatialReferenceUtils","./TileKey"],function(u,t,H){function C(y,
x,m){y[0]=x;y[1]=m;return y}const w=new H("0/0/0/0");return function(){function y(m,h,c,d,f,k,g,e,a,b,l,q){this.level=m;this.resolution=h;this.scale=c;this.origin=d;this.first=f;this.last=k;this.size=g;this.norm=e;this.worldStart=a;this.worldEnd=b;this.worldSize=l;this.wrap=q}y.create=function(m,h,c=null){var d=t.getInfo(m.spatialReference);const f=h.origin||[m.origin.x,m.origin.y],k=[m.size[0]*h.resolution,m.size[1]*h.resolution],g=[-Infinity,-Infinity],e=[Infinity,Infinity],a=[Infinity,Infinity];
u.isSome(c)&&(C(g,Math.max(0,Math.floor((c.xmin-f[0])/k[0])),Math.max(0,Math.floor((f[1]-c.ymax)/k[1]))),C(e,Math.max(0,Math.floor((c.xmax-f[0])/k[0])),Math.max(0,Math.floor((f[1]-c.ymin)/k[1]))),C(a,e[0]-g[0]+1,e[1]-g[1]+1));const {cols:b,rows:l}=h;!c&&b&&l&&(C(g,b[0],l[0]),C(e,b[1],l[1]),C(a,b[1]-b[0]+1,l[1]-l[0]+1));let q;m.isWrappable?(m=[Math.ceil(Math.round((d.valid[1]-d.valid[0])/h.resolution)/m.size[0]),a[1]],d=[Math.floor((d.origin[0]-f[0])/k[0]),g[1]],c=[m[0]+d[0]-1,e[1]],q=!0):(d=g,c=e,
m=a,q=!1);return new y(h.level,h.resolution,h.scale,f,g,e,a,k,d,c,m,q)};var x=y.prototype;x.normalizeCol=function(m){if(!this.wrap)return m;const h=this.worldSize[0];return 0>m?h-1-Math.abs((m+1)%h):m%h};x.denormalizeCol=function(m,h){return this.wrap?this.worldSize[0]*h+m:m};x.getWorldForColumn=function(m){return this.wrap?Math.floor(m/this.worldSize[0]):0};x.getFirstColumnForWorld=function(m){return m*this.worldSize[0]+this.first[0]};x.getLastColumnForWorld=function(m){return m*this.worldSize[0]+
this.first[0]+this.size[0]-1};x.getColumnForX=function(m){return(m-this.origin[0])/this.norm[0]};x.getXForColumn=function(m){return this.origin[0]+m*this.norm[0]};x.getRowForY=function(m){return(this.origin[1]-m)/this.norm[1]};x.getYForRow=function(m){return this.origin[1]-m*this.norm[1]};x.getTileBounds=function(m,h,c=!1){w.set(h);var d=c?w.col:this.denormalizeCol(w.col,w.world),f=w.row;h=this.getXForColumn(d);c=this.getYForRow(f+1);d=this.getXForColumn(d+1);f=this.getYForRow(f);m[0]=h;m[1]=c;m[2]=
d;m[3]=f;return m};x.getTileCoords=function(m,h,c=!1){w.set(h);h=c?w.col:this.denormalizeCol(w.col,w.world);Array.isArray(m)?C(m,this.getXForColumn(h),this.getYForRow(w.row)):(m.x=this.getXForColumn(h),m.y=this.getYForRow(w.row));return m};return y}()})},"esri/views/2d/tiling/TileSpan":function(){define(function(){return function(u,t,H){this.row=u;this.colFrom=t;this.colTo=H}})},"esri/views/2d/layers/features/processors/SymbolProcessor":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/BidiText ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/accessorSupport/ensureType ../../../../../core/arrayUtils ../../../../../core/accessorSupport/decorators/subclass ../../../../../core/accessorSupport/diffUtils ../../../../../geometry/SpatialReference ../../../engine/webgl/DisplayId ../../../engine/webgl/enums ../../../engine/webgl/mesh/MeshData ../../../engine/webgl/mesh/factories/WGLMeshFactory ../../../engine/webgl/mesh/templates/WGLTemplateStore ../../../engine/webgl/util/Matcher ../textUtils ./BaseProcessor ../support/ResourceManagerProxy".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f,k,g,e,a,b,l,q,n,v,B){function z(r,D){return(!r.minScale||r.minScale>=D)&&(!r.maxScale||r.maxScale<=D)}function p(r){r=r.message;const D={message:{data:{},tileKey:r.tileKey,tileKeyOrigin:r.tileKeyOrigin,version:r.version},transferList:[]};for(const F in r.data){var J=r.data[F];D.message.data[F]=null;if(x.isSome(J)){var K=J.stride;const A=J.indices.slice(0),I=J.vertices.slice(0),G=J.records.slice(0);J=x.applySome(J.metrics,E=>E.slice(0));K={stride:K,indices:A,vertices:I,
records:G,metrics:J};D.transferList.push(A,I,G);D.message.data[F]=K}}return D}C=function(r){function D(){var K=r.apply(this,arguments)||this;K.type="symbol";K._matchers={feature:null,aggregate:null};K._bufferData=new Map;K._bufferIds=new Map;return K}u._inheritsLoose(D,r);var J=D.prototype;J.initialize=function(){this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this))]);this._resourceManagerProxy=new B(this.remoteClient)};J.destroy=function(){this._resourceManagerProxy.destroy()};
J.forEachBufferId=function(K){this._bufferIds.forEach(F=>{F.forEach(K)})};J.update=function(){var K=u._asyncToGenerator(function*(F,A){A=A.schema.processors[0];if("symbol"===A.type){var I=f.diff(this._schema,A);if(f.hasDiff(I,"mesh")||f.hasDiff(I,"target"))F.mesh=!0,F.why?.mesh.push("Symbology changed"),this._schema=A,this._factory=this._createFactory(A),this._factory.update(A,this.tileStore.tileScheme.tileInfo)}});return function(F,A){return K.apply(this,arguments)}}();J.onTileMessage=function(K,
F,A,I){m.throwIfAborted(I);return this._onTileData(K,F,A,I)};J.onTileClear=function(K){this._bufferData.delete(K.key.id);this._bufferIds.delete(K.key.id);return this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:K.id,data:{clear:!0}})};J.onTileError=function(K,F,A){return this.remoteClient.invoke("tileRenderer.onTileError",{tileKey:K.id,error:F},{signal:A.signal})};J.onTileUpdate=function(K){for(const F of K.removed)this._bufferData.has(F.key.id)&&this._bufferData.delete(F.key.id),this._bufferIds.has(F.key.id)&&
this._bufferIds.delete(F.key.id);for(const F of K.added)this._bufferData.forEach(A=>{for(const I of A)I.message.tileKey===F.id&&this._updateTileMesh("append",F,p(I),[],!1,!1,null)})};J._addBufferData=function(K,F){this._bufferData.has(K)||this._bufferData.set(K,[]);this._bufferData.get(K)?.push(p(F))};J._createFactory=function(K){const {geometryType:F,objectIdField:A,fields:I}=this.service,G=k.fromJSON(this.spatialReference),E={geometryType:F,fields:I,spatialReference:G},M=new l.WGLTemplateStore((fa,
ba)=>this.remoteClient.invoke("tileRenderer.getMaterialItems",fa,ba),this.tileStore.tileScheme.tileInfo),{matcher:T,aggregateMatcher:Y}=K.mesh;this._store=M;this._matchers.feature=q.createMatcher(T,M,E,this._resourceManagerProxy);this._matchers.aggregate=x.applySome(Y,fa=>q.createMatcher(fa,M,E,this._resourceManagerProxy));return new b.WGLMeshFactory(F,A,M)};J._onTileData=function(){var K=u._asyncToGenerator(function*(F,A,I,G){m.throwIfAborted(G);const {type:E,addOrUpdate:M,remove:T,clear:Y,end:fa}=
A;var ba=!!this._schema.mesh.sortKey;if(!M)return this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:F.id,data:{type:E,addOrUpdate:null,remove:T,clear:Y,end:fa,sort:ba}},G);I=this._processFeatures(F,M,I,G,A.status?.version);try{var U=yield I;if(x.isNone(U))return this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:F.id,data:{type:E,addOrUpdate:null,remove:T,clear:Y,end:fa,sort:ba}},G);ba=[];for(const P of U){U=!1;const Q=P.message.bufferIds,Z=F.key.id,X=P.message.tileKey;if(Z!==X&&
x.isSome(Q)){if(!this.tileStore.get(X)){this._addBufferData(Z,P);ba.push(P);continue}let sa=this._bufferIds.get(X);sa||(sa=new Set,this._bufferIds.set(X,sa));const Aa=Array.from(Q);for(const Da of Aa)if(sa.has(Da)){U=!0;break}else sa.add(Da)}U||(this._addBufferData(Z,P),ba.push(P))}yield Promise.all(ba.map(P=>{const Q=F.key.id===P.message.tileKey;return this._updateTileMesh(E,F,P,Q?A.remove:[],Q&&A.end,!!A.clear,G.signal)}))}catch(P){this._handleError(F,P,G)}});return function(F,A,I,G){return K.apply(this,
arguments)}}();J._updateTileMesh=function(){var K=u._asyncToGenerator(function*(F,A,I,G,E,M,T){const Y=I.message.tileKey,fa=!!this._schema.mesh.sortKey;Y!==A.key.id&&(E=!1);A=x.applySome(I,ba=>ba.message);I=x.applySome(I,ba=>ba.transferList)||[];F={type:F,addOrUpdate:A,remove:G,clear:M,end:E,sort:fa};T={transferList:x.unwrap(I)||[],signal:T};m.throwIfAborted(T);return this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:Y,data:F},T)});return function(F,A,I,G,E,M,T){return K.apply(this,arguments)}}();
J._processFeatures=function(){var K=u._asyncToGenerator(function*(F,A,I,G,E){if(x.isNone(A)||!A.hasFeatures)return null;const M={transform:F.transform,hasZ:!1,hasM:!1},T=this._factory,Y={viewingMode:"",scale:F.scale},fa=yield this._matchers.feature,ba=yield this._matchers.aggregate;m.throwIfAborted(G);const U=this._getLabelInfos(F,A);yield T.analyze(A.getCursor(),this._resourceManagerProxy,fa,ba,M,Y);m.throwIfAborted(G);return this._writeFeatureSet(F,A,M,U,T,I,E)});return function(F,A,I,G,E){return K.apply(this,
arguments)}}();J._writeFeatureSet=function(K,F,A,I,G,E,M){const T=F.getSize(),Y=this._schema.mesh.matcher.symbologyType;E=new a.MeshData(K.key.id,{features:T,records:T,metrics:0},Y,E,Y!==e.WGLSymbologyType.HEATMAP,M);M={viewingMode:"",scale:K.scale};for(F=F.getCursor();F.next();)try{const fa=F.getDisplayId(),ba=x.isSome(I)?I.get(fa):null;G.writeCursor(E,F,A,M,K.level,ba,this._resourceManagerProxy)}catch(fa){}return E.serialize(K.tileInfoView.tileInfo.isWrappable)};J._handleError=function(K,F,A){return m.isAbortError(F)?
Promise.resolve():this.remoteClient.invoke("tileRenderer.onTileError",{tileKey:K.id,error:F.message},{signal:A.signal})};J._getLabelingSchemaForScale=function(K){var F=this._schema.mesh.labels;if(x.isNone(F))return null;if("subtype"===F.type){const A={type:"subtype",classes:{}};let I=!1;for(const G in F.classes){const E=F.classes[G].filter(M=>z(M,K.scale));I=I||!!E.length;A.classes[G]=E}return I?A:null}F=F.classes.filter(A=>z(A,K.scale));return F.length?{type:"simple",classes:F}:null};J._getLabels=
function(K,F){if("subtype"===F.type){const A=x.unwrapOrThrow(this.service.subtypeField,"Expected to find subtype Field");K=K.readAttribute(A);return null==K?[]:F.classes[K]??[]}return F.classes};J._getLabelInfos=function(K,F){K=this._getLabelingSchemaForScale(K);if(x.isNone(K))return null;const A=new Map;for(F=F.getCursor();F.next();){const G=F.getDisplayId(),E=[],M=g.isAggregateId(G),T=M&&1!==F.readAttribute("cluster_count")?"aggregate":"feature";var I=this._getLabels(F,K);for(const Y of I){if(Y.target!==
T)continue;I=F.getStorage();I=M&&"feature"===T?I.getComputedStringAtIndex(F.readAttribute("referenceId"),Y.fieldIndex):I.getComputedStringAtIndex(G,Y.fieldIndex);if(!I)continue;I=H.bidiText(I.toString());const fa=I[1];this._store.getMosaicItem(Y.symbol,n.codepoints(I[0])).then(ba=>{E[Y.index]={glyphs:ba.glyphMosaicItems??[],rtl:fa,index:Y.index}})}A.set(G,E)}return A};u._createClass(D,[{key:"supportsTileUpdates",get:function(){return!0}}]);return D}(v);return C=t.__decorate([d.subclass("esri.views.2d.layers.features.processors.SymbolProcessor")],
C)})},"esri/core/BidiText":function(){define(["exports","./BidiEngine"],function(u,t){const H=new t;u.bidiText=function(C){if(null==C)return["",!1];if(!H.hasBidiChar(C))return[C,!1];let w;w="rtl"===H.checkContextual(C)?"IDNNN":"ICNNN";return[H.bidiTransform(C,w,"VLYSN"),!0]};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/MeshData":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../tiling/PagedTileQueue ../../../tiling/TileInfoView ../../../tiling/TileKey ../../../tiling/TileQueue ../../../tiling/TileStrategy ../definitions ../DisplayId ../enums ../Utils ./VertexDataWriter ../../../layers/features/support/tileUtils".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f,k){function g(a){switch(a){case 1:case 8:case 32:return-1;case 2:case 64:return 0;case 4:case 16:case 128:return 1}}function e(a){switch(a){case 1:case 2:case 4:return-1;case 8:case 16:return 0;case 32:case 64:case 128:return 1}}H=function(){function a(l,q,n,v,B,z=0){this.hasRecords=this._hasAggregate=!1;this._data={self:new Map,neighbors:[]};this._version=0;this._current={geometryType:0,writer:null,overlaps:0,start:0,insertAfter:0,sortKey:0,id:0,materialKey:0,indexStart:0,
vertStart:0,isDotDensity:!1,bufferingEnabled:!1,metricBoxLenPointer:0};this.hint=q;this.tileKey=l;this._hasAggregate=v;this._pixelBufferEnabled=B;this._version=z;this._symbologyType=n}var b=a.prototype;b.serialize=function(l){const q=[];q.push(this._serializeTileVertexData(this.tileKey,this.tileKey,this._data.self));this._data.neighbors.forEach((n,v)=>{var B=1<<v;v=g(B);B=e(B);v=k.getPow2NeighborKey(new w(this.tileKey),v,B,l);v=this._serializeTileVertexData(this.tileKey,v.id,n.vertexData);v.message.bufferIds=
n.displayIds;q.push(v)});return q};b._serializeTileVertexData=function(l,q,n){const v=[];n={[c.WGLGeometryType.MARKER]:n.get(c.WGLGeometryType.MARKER)?.serialize(v),[c.WGLGeometryType.FILL]:n.get(c.WGLGeometryType.FILL)?.serialize(v),[c.WGLGeometryType.LINE]:n.get(c.WGLGeometryType.LINE)?.serialize(v),[c.WGLGeometryType.TEXT]:n.get(c.WGLGeometryType.TEXT)?.serialize(v),[c.WGLGeometryType.LABEL]:n.get(c.WGLGeometryType.LABEL)?.serialize(v)};return{message:{tileKeyOrigin:l,tileKey:q,data:n,version:this._version},
transferList:v}};b.featureStart=function(l,q){this._current.insertAfter=l;this._current.sortKey=q};b.featureEnd=function(){};b.recordStart=function(l,q,n,v){this._current.writer=this._getVertexWriter(n);this._current.overlaps=0;this._current.indexStart=this._current.writer.indexCount;this._current.vertStart=this._current.writer.vertexCount;this._current.bufferingEnabled=v;this._current.id=l;this._current.materialKey=q;this._current.geometryType=n;this._current.isDotDensity=!1;this._current.writer.recordStart()};
b.recordCount=function(){return this._current.writer.recordCount};b.vertexCount=function(){return this._current.writer.vertexCount};b.indexCount=function(){return this._current.writer.indexCount};b.vertexEnsureSize=function(l){this._current.writer.vertexEnsureSize(l)};b.indexEnsureSize=function(l){this._current.writer.indexEnsureSize(l)};b.vertexBounds=function(l,q,n,v){this._current.bufferingEnabled&&this._addOverlap(l,q,n,v)};b.vertexWrite=function(l){this._current.writer.writeVertex(l)};b.vertexWriteF32=
function(l){this._current.writer.writeVertexF32(l)};b.vertexEnd=function(){};b.vertexWriter=function(){return this._current.writer.vertexWriter};b.indexWrite=function(l){this._current.writer.writeIndex(l)};b.indexWriter=function(){return this._current.writer.indexWriter};b.metricWriter=function(){return this._current.writer.metricWriter};b.metricStart=function(l,q,n,v,B,z,p,r){this._current.writer=this._getVertexWriter(c.WGLGeometryType.LABEL);const D=this._current.writer.metricWriter;D.push(h.getDisplayIdTexel(l));
D.push(q);D.push(n);D.push(v);D.push(B);D.push(z);D.push(p);D.push(r);D.push(255);this._current.metricBoxLenPointer=D.push(0)};b.metricEnd=function(){const l=this._current.writer.metricWriter;0===l.getValue(this._current.metricBoxLenPointer)&&l.seek(l.length-10)};b.metricBoxWrite=function(l,q,n,v){const B=this._current.writer.metricWriter;B.incr(this._current.metricBoxLenPointer);B.push(0);B.push(0);B.push(l);B.push(q);B.push(n);B.push(v)};b.recordEnd=function(){var l=this._current.vertStart,q=this._current.writer.vertexCount-
l;if(!q)return!1;this.hasRecords=!0;var n=this._current.indexStart;this._current.writer.recordEnd(this._current.id,this._current.materialKey,this._current.insertAfter,n,this._current.writer.indexCount-n,l,q,this._current.sortKey);if(!this._pixelBufferEnabled||this._hasAggregate||0===this._current.overlaps||this._current.geometryType===c.WGLGeometryType.LABEL)return!0;l=this._current.writer;for(q=0;8>q;q++){var v=1<<q;if(this._current.overlaps&v){this._data.neighbors[q]||(this._data.neighbors[q]={vertexData:new Map,
displayIds:new Set});n=this._data.neighbors[q];var B=this._current.geometryType;if(!n.vertexData.has(B)){var z=d.getStrides(B,this._symbologyType).geometry;z=new f.VertexDataWriter(B,z,m.PATCH_PIXEL_BUFFER_ALLOC_SIZE);n.vertexData.set(B,z)}B=n.vertexData.get(this._current.geometryType);z=4096*-g(v);v=4096*-e(v);B?.copyLastFrom(l,z,v);n.displayIds.add(this._current.id)}}return!0};b._addOverlap=function(l,q,n,v){this._current.overlaps|=255^((l<0+n?148:l>=m.TILE_SIZE-n?41:189)|(q<0+v?224:q>=m.TILE_SIZE-
v?7:231))};b._getVertexWriter=function(l){if(!this._data.self.has(l)){const q=this._data.self,n=d.getStrides(l,this._symbologyType).geometry;q.set(l,new f.VertexDataWriter(l,n,this.hint.records))}return this._data.self.get(l)};t._createClass(a,[{key:"hasAggregates",get:function(){return this._hasAggregate}},{key:"hasPixelBufferEnabled",get:function(){return this._pixelBufferEnabled}}]);return a}();u.MeshData=H;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/tiling/PagedTileQueue":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ../../../chunks/vec2 ../../support/QueueProcessor".split(" "),
function(u,t,H,C,w,y,x,m,h,c){function d(a,b){a.length=0;b.forEach(l=>a.push(l));return a}const f=new Set,k=[],g=new Map,e=[0,0];H=function(a){function b(q){q=a.call(this,q)||this;q._keyToItem=new Map;q.concurrency=6;q.strategy="scale-first";q.tileInfoView=null;return q}u._inheritsLoose(b,a);var l=b.prototype;l.initialize=function(){const {concurrency:q,process:n}=this;this._queue=new c.QueueProcessor({concurrency:q,process:(v,B)=>{v=this._keyToItem.get(v);return n(v,{signal:B})},peeker:v=>v.values().next().value})};
l.destroy=function(){this.clear();this._queue=C.destroyMaybe(this._queue)};l.abort=function(q){this._queue.abort("string"===typeof q?q:q.id)};l.clear=function(){this._queue.clear();this._keyToItem.clear();this.notifyChange("updating")};l.has=function(q){return"string"===typeof q?this._keyToItem.has(q):this._keyToItem.has(q.id)};l.isOngoing=function(q){q="string"===typeof q?q:q.id;return this.has(q)&&this._queue.isOngoing(q)};l.pause=function(){this._queue.pause()};l.push=function(q,n){const v=q.key.id+
"-"+n;if(this.has(v))return this.get(v);n=this._queue.push(v);const B=()=>{this._keyToItem.delete(v);this.notifyChange("updating")};this._keyToItem.set(v,q);n.then(B,B);this.notifyChange("updating");return n};l.reset=function(){this._queue.reset();this.notifyChange("updating")};l.resume=function(){this._queue.resume()};l._peekByScaleFirst=function(q){if(!this.state)return q.values().next().value;const n=this.tileInfoView;let v=Number.NEGATIVE_INFINITY,B=Number.POSITIVE_INFINITY;q.forEach(J=>{J=this._keyToItem.get(J);
const K=this.tileInfoView.getTileScale(J.key);g.has(K)||(g.set(K,[]),v=Math.max(K,v),B=Math.min(K,B));g.get(K).push(J.key);f.add(K)});let z=this.state.scale;g.has(z)||(d(k,f),k.sort((J,K)=>J-K),z=k.reduce((J,K)=>Math.abs(K-z)<Math.abs(J-z)?K:J,k[0]));z=Math.min(z,v);z=Math.max(z,B);q=g.get(z);const p=n.getClosestInfoForScale(z),r=p.getColumnForX(this.state.center[0]),D=p.getRowForY(this.state.center[1]);q.sort((J,K)=>{const F=p.denormalizeCol(J.col,J.world),A=p.denormalizeCol(K.col,K.world);return Math.sqrt((r-
F)*(r-F)+(D-J.row)*(D-J.row))-Math.sqrt((r-A)*(r-A)+(D-K.row)*(D-K.row))});f.clear();g.clear();return q[0].id};l._peekByCenterFirst=function(q){if(!this.state)return q.values().next().value;const n=this.tileInfoView,v=this.state.center;let B=Number.POSITIVE_INFINITY,z;q.forEach(p=>{p=this._keyToItem.get(p);n.getTileCoords(e,p.key);const r=h.distance(e,v);r<B&&(B=r,z=p.key)});return z.id};u._createClass(b,[{key:"length",get:function(){return this._queue?this._queue.length:0}},{key:"onGoingCount",get:function(){return this._keyToItem.size}},
{key:"updating",get:function(){return 0<this.length||0<this.onGoingCount}}]);return b}(H);t.__decorate([w.property({constructOnly:!0})],H.prototype,"concurrency",void 0);t.__decorate([w.property({constructOnly:!0})],H.prototype,"process",void 0);t.__decorate([w.property()],H.prototype,"state",void 0);t.__decorate([w.property({constructOnly:!0})],H.prototype,"strategy",void 0);t.__decorate([w.property({constructOnly:!0})],H.prototype,"tileInfoView",void 0);t.__decorate([w.property({readOnly:!0})],
H.prototype,"updating",null);return H=t.__decorate([m.subclass("esri.views.2d.tiling.PagedTileQueue")],H)})},"esri/chunks/vec2":function(){define(["exports","./common"],function(u,t){function H(ba,U){ba[0]=U[0];ba[1]=U[1];return ba}function C(ba,U,P){ba[0]=U;ba[1]=P;return ba}function w(ba,U,P){ba[0]=U[0]+P[0];ba[1]=U[1]+P[1];return ba}function y(ba,U,P){ba[0]=U[0]-P[0];ba[1]=U[1]-P[1];return ba}function x(ba,U,P){ba[0]=U[0]*P[0];ba[1]=U[1]*P[1];return ba}function m(ba,U,P){ba[0]=U[0]/P[0];ba[1]=
U[1]/P[1];return ba}function h(ba,U){ba[0]=Math.ceil(U[0]);ba[1]=Math.ceil(U[1]);return ba}function c(ba,U){ba[0]=Math.floor(U[0]);ba[1]=Math.floor(U[1]);return ba}function d(ba,U,P){ba[0]=Math.min(U[0],P[0]);ba[1]=Math.min(U[1],P[1]);return ba}function f(ba,U,P){ba[0]=Math.max(U[0],P[0]);ba[1]=Math.max(U[1],P[1]);return ba}function k(ba,U){ba[0]=Math.round(U[0]);ba[1]=Math.round(U[1]);return ba}function g(ba,U,P){ba[0]=U[0]*P;ba[1]=U[1]*P;return ba}function e(ba,U,P,Q){ba[0]=U[0]+P[0]*Q;ba[1]=U[1]+
P[1]*Q;return ba}function a(ba,U){const P=U[0]-ba[0];ba=U[1]-ba[1];return Math.sqrt(P*P+ba*ba)}function b(ba,U){const P=U[0]-ba[0];ba=U[1]-ba[1];return P*P+ba*ba}function l(ba){const U=ba[0];ba=ba[1];return Math.sqrt(U*U+ba*ba)}function q(ba){const U=ba[0];ba=ba[1];return U*U+ba*ba}function n(ba,U){ba[0]=-U[0];ba[1]=-U[1];return ba}function v(ba,U){ba[0]=1/U[0];ba[1]=1/U[1];return ba}function B(ba,U){var P=U[0];const Q=U[1];P=P*P+Q*Q;0<P&&(P=1/Math.sqrt(P),ba[0]=U[0]*P,ba[1]=U[1]*P);return ba}function z(ba,
U){return ba[0]*U[0]+ba[1]*U[1]}function p(ba,U,P){U=U[0]*P[1]-U[1]*P[0];ba[0]=ba[1]=0;ba[2]=U;return ba}function r(ba,U,P,Q){const Z=U[0];U=U[1];ba[0]=Z+Q*(P[0]-Z);ba[1]=U+Q*(P[1]-U);return ba}function D(ba,U){U=U||1;const P=2*t.RANDOM()*Math.PI;ba[0]=Math.cos(P)*U;ba[1]=Math.sin(P)*U;return ba}function J(ba,U,P){const Q=U[0];U=U[1];ba[0]=P[0]*Q+P[2]*U;ba[1]=P[1]*Q+P[3]*U;return ba}function K(ba,U,P){const Q=U[0];U=U[1];ba[0]=P[0]*Q+P[2]*U+P[4];ba[1]=P[1]*Q+P[3]*U+P[5];return ba}function F(ba,U,
P){const Q=U[0];U=U[1];ba[0]=P[0]*Q+P[3]*U+P[6];ba[1]=P[1]*Q+P[4]*U+P[7];return ba}function A(ba,U,P){const Q=U[0];U=U[1];ba[0]=P[0]*Q+P[4]*U+P[12];ba[1]=P[1]*Q+P[5]*U+P[13];return ba}function I(ba,U,P,Q){const Z=U[0]-P[0];U=U[1]-P[1];const X=Math.sin(Q);Q=Math.cos(Q);ba[0]=Z*Q-U*X+P[0];ba[1]=Z*X+U*Q+P[1];return ba}function G(ba,U){var P=ba[0];ba=ba[1];const Q=U[0];U=U[1];let Z=P*P+ba*ba;0<Z&&(Z=1/Math.sqrt(Z));let X=Q*Q+U*U;0<X&&(X=1/Math.sqrt(X));P=(P*Q+ba*U)*Z*X;return 1<P?0:-1>P?Math.PI:Math.acos(P)}
function E(ba){return"vec2("+ba[0]+", "+ba[1]+")"}function M(ba,U){return ba[0]===U[0]&&ba[1]===U[1]}function T(ba,U){const P=ba[0];ba=ba[1];const Q=U[0];U=U[1];const Z=t.getEpsilon();return Math.abs(P-Q)<=Z*Math.max(1,Math.abs(P),Math.abs(Q))&&Math.abs(ba-U)<=Z*Math.max(1,Math.abs(ba),Math.abs(U))}function Y(ba,U,P,Q,Z){let X=U[0]-P[0];P=U[1]-P[1];Z=(Q[0]*X+Q[1]*P)*(Z-1);X=Q[0]*Z;P=Q[1]*Z;ba[0]=U[0]+X;ba[1]=U[1]+P;return ba}const fa=Object.freeze(Object.defineProperty({__proto__:null,add:w,angle:G,
ceil:h,copy:H,cross:p,dist:a,distance:a,div:m,divide:m,dot:z,equals:T,exactEquals:M,floor:c,inverse:v,len:l,length:l,lerp:r,max:f,min:d,mul:x,multiply:x,negate:n,normalize:B,projectAndScale:Y,random:D,rotate:I,round:k,scale:g,scaleAndAdd:e,set:C,sqrDist:b,sqrLen:q,squaredDistance:b,squaredLength:q,str:E,sub:y,subtract:y,transformMat2:J,transformMat2d:K,transformMat3:F,transformMat4:A},Symbol.toStringTag,{value:"Module"}));u.add=w;u.angle=G;u.ceil=h;u.copy=H;u.cross=p;u.dist=a;u.distance=a;u.div=m;
u.divide=m;u.dot=z;u.equals=T;u.exactEquals=M;u.floor=c;u.inverse=v;u.len=l;u.length=l;u.lerp=r;u.max=f;u.min=d;u.mul=x;u.multiply=x;u.negate=n;u.normalize=B;u.projectAndScale=Y;u.random=D;u.rotate=I;u.round=k;u.scale=g;u.scaleAndAdd=e;u.set=C;u.sqrDist=b;u.sqrLen=q;u.squaredDistance=b;u.squaredLength=q;u.str=E;u.sub=y;u.subtract=y;u.transformMat2=J;u.transformMat2d=K;u.transformMat3=F;u.transformMat4=A;u.vec2=fa})},"esri/views/2d/tiling/TileQueue":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ../../../chunks/vec2 ../../support/QueueProcessor".split(" "),
function(u,t,H,C,w,y,x,m,h,c){function d(a,b){a.length=0;b.forEach(l=>a.push(l));return a}const f=new Set,k=[],g=new Map,e=[0,0];H=function(a){function b(q){q=a.call(this,q)||this;q._keyToItem=new Map;q.concurrency=6;q.strategy="scale-first";q.tileInfoView=null;return q}u._inheritsLoose(b,a);var l=b.prototype;l.initialize=function(){const {concurrency:q,process:n,strategy:v}=this;this._queue=new c.QueueProcessor({concurrency:q,process:(B,z)=>{B=this._keyToItem.get(B);return n(B,{signal:z})},peeker:"scale-first"===
v?B=>this._peekByScaleFirst(B):B=>this._peekByCenterFirst(B)})};l.destroy=function(){this.clear();this._queue=C.destroyMaybe(this._queue)};l.abort=function(q){this._queue.abort("string"===typeof q?q:q.id)};l.clear=function(){this._queue.clear();this._keyToItem.clear();this.notifyChange("updating")};l.has=function(q){return"string"===typeof q?this._keyToItem.has(q):this._keyToItem.has(q.id)};l.isOngoing=function(q){q="string"===typeof q?q:q.id;return this.has(q)&&this._queue.isOngoing(q)};l.pause=
function(){this._queue.pause()};l.push=function(q){const n=q.key.id;if(this._queue.has(n))return this._queue.get(n);const v=this._queue.push(n),B=()=>{this._keyToItem.delete(n);this.notifyChange("updating")};this._keyToItem.set(n,q);v.then(B,B);this.notifyChange("updating");return v};l.reset=function(){this._queue.reset()};l.resume=function(){this._queue.resume()};l._peekByScaleFirst=function(q){if(!this.state)return q.values().next().value;const n=this.tileInfoView;let v=Number.NEGATIVE_INFINITY,
B=Number.POSITIVE_INFINITY;q.forEach(J=>{J=this._keyToItem.get(J);const K=this.tileInfoView.getTileScale(J.key);g.has(K)||(g.set(K,[]),v=Math.max(K,v),B=Math.min(K,B));g.get(K).push(J.key);f.add(K)});let z=this.state.scale;g.has(z)||(d(k,f),k.sort((J,K)=>J-K),z=k.reduce((J,K)=>Math.abs(K-z)<Math.abs(J-z)?K:J,k[0]));z=Math.min(z,v);z=Math.max(z,B);q=g.get(z);const p=n.getClosestInfoForScale(z),r=p.getColumnForX(this.state.center[0]),D=p.getRowForY(this.state.center[1]);q.sort((J,K)=>{const F=p.denormalizeCol(J.col,
J.world),A=p.denormalizeCol(K.col,K.world);return Math.sqrt((r-F)*(r-F)+(D-J.row)*(D-J.row))-Math.sqrt((r-A)*(r-A)+(D-K.row)*(D-K.row))});f.clear();g.clear();return q[0].id};l._peekByCenterFirst=function(q){if(!this.state)return q.values().next().value;const n=this.tileInfoView,v=this.state.center;let B=Number.POSITIVE_INFINITY,z;q.forEach(p=>{p=this._keyToItem.get(p);n.getTileCoords(e,p.key);const r=h.distance(e,v);r<B&&(B=r,z=p.key)});return z.id};u._createClass(b,[{key:"length",get:function(){return this._queue?
this._queue.length:0}},{key:"onGoingCount",get:function(){return this._keyToItem.size}},{key:"updating",get:function(){return 0<this.length||0<this.onGoingCount}}]);return b}(H);t.__decorate([w.property({constructOnly:!0})],H.prototype,"concurrency",void 0);t.__decorate([w.property({constructOnly:!0})],H.prototype,"process",void 0);t.__decorate([w.property()],H.prototype,"state",void 0);t.__decorate([w.property({constructOnly:!0})],H.prototype,"strategy",void 0);t.__decorate([w.property({constructOnly:!0})],
H.prototype,"tileInfoView",void 0);t.__decorate([w.property({readOnly:!0})],H.prototype,"updating",null);return H=t.__decorate([m.subclass("esri.views.2d.tiling.TileQueue")],H)})},"esri/views/2d/tiling/TileStrategy":function(){define(["../../../geometry/support/aaBoundingRect","./TileCache","./TileCoverage","./TileKey"],function(u,t,H,C){const w=new C(0,0,0,0),y=new Map,x=[],m=[];return function(){function h(d){this._previousScale=Number.POSITIVE_INFINITY;this.cachePolicy="keep";this.coveragePolicy=
"closest";this.resampling=!0;this.tileIndex=new Map;this.tiles=[];this.buffer=192;this.acquireTile=d.acquireTile;this.releaseTile=d.releaseTile;this.tileInfoView=d.tileInfoView;this.resampling=null==d.resampling||!!d.resampling;d.cachePolicy&&(this.cachePolicy=d.cachePolicy);d.coveragePolicy&&(this.coveragePolicy=d.coveragePolicy);null!=d.buffer&&(this.buffer=d.buffer);d.cacheSize&&(this._tileCache=new t(d.cacheSize,this.tileInfoView,f=>{this.releaseTile(f)}))}var c=h.prototype;c.destroy=function(){this.tileIndex.clear()};
c.update=function(d){const {resampling:f,tileIndex:k}=this,g=this.tileInfoView.getTileCoverage(d.state,this.buffer,this.coveragePolicy);m.length=0;x.length=0;y.clear();if(g){var {minScale:e,maxScale:a}=this.tileInfoView.tileInfo,{spans:b,lodInfo:l}=g,{level:q}=l,{scale:n,center:v,resolution:B}=d.state,z=!d.stationary&&n>this._previousScale;this._previousScale=n;this.tiles.length=0;if(!f&&(n>e||n<a))return this.tiles.length=0,y.clear(),k.forEach(K=>{this.releaseTile(K)}),k.clear(),m.length=0,x.length=
0,y.clear(),H.pool.release(g),!0;k.forEach(K=>K.visible=!0);var p=d=0;if(0<b.length)for(const {row:K,colFrom:F,colTo:A}of b)for(let I=F;I<=A;I++){d++;const G=w.set(q,K,l.normalizeCol(I),l.getWorldForColumn(I)).id;if(k.has(G)){var r=k.get(G);r.isReady?(y.set(G,r),p++):z||this._addParentTile(G,y)}else{if(this._tileCache&&this._tileCache.has(G)){if(r=this._tileCache.pop(G),this.tileIndex.set(G,r),r.isReady){y.set(G,r);p++;continue}}else r=this.acquireTile(w),this.tileIndex.set(G,r);z||this._addParentTile(G,
y)}}var D=p===d;k.forEach((K,F)=>{w.set(F);if(!y.has(F)){var A=this.tileInfoView.intersects(g,w),I="purge"===this.cachePolicy?w.level!==q:w.level>q;!A||!z&&D?!I&&A||x.push(F):K.isReady?I&&"purge"===this.cachePolicy&&this._hasReadyAncestor(w,q)?x.push(F):m.push(F):I&&x.push(F)}});for(var J of m)(d=k.get(J))&&d.isReady&&y.set(J,d);for(const K of x)J=k.get(K),this._tileCache?this._tileCache.add(J):this.releaseTile(J),k.delete(K);y.forEach(K=>this.tiles.push(K));k.forEach(K=>{y.has(K.key.id)||(K.visible=
!1)});this._tileCache&&this._tileCache.prune(q,v,B);H.pool.release(g);y.clear();return D}};c.clear=function(d=!0){const {tileIndex:f}=this;d&&f.forEach(k=>{this.releaseTile(k)});f.clear()};c.updateCacheSize=function(d){this._tileCache&&(this._tileCache.maxSize=d)};c._addParentTile=function(d,f){let k=null;for(;;){d=this.tileInfoView.getTileParentId(d);if(!d)break;if(this.tileIndex.has(d)){if((k=this.tileIndex.get(d))&&k.isReady){f.has(k.key.id)||f.set(k.key.id,k);break}}else if(this._tileCache&&this._tileCache.has(d)&&
(k=this._tileCache.pop(d),this.tileIndex.set(d,k),k&&k.isReady)){f.has(k.key.id)||f.set(k.key.id,k);break}}};c._hasReadyAncestor=function(d,f){const k=u.create();this.tileInfoView.getTileBounds(k,d,!0);for(const g of this.tileIndex.values())if(g.isReady&&g.key.level>=f&&g.key.level<d.level){const e=u.create();this.tileInfoView.getTileBounds(e,g.key,!0);if(u.contains(e,k))return!0}return!1};return h}()})},"esri/views/2d/tiling/TileCache":function(){define(["../../../chunks/vec2"],function(u){return function(){function t(C,
w,y){this.maxSize=C;this._tileInfoView=w;this._removedFunc=y;this._tilePerId=new Map;this._tileKeysPerLevel=[]}var H=t.prototype;H.has=function(C){return this._tilePerId.has(C)};H.get=function(C){return this._tilePerId.get(C)};H.pop=function(C){const w=this._tilePerId.get(C);if(w){var y=this._tileKeysPerLevel[w.key.level];this._tilePerId["delete"](C);for(let x=0;x<y.length;x++)if(y[x].id===C){y.splice(x,1);break}w.visible=!0;return w}};H.add=function(C){C.visible=!1;const w=C.key,y=w.id;this._tilePerId.has(y)||
(this._tilePerId.set(y,C),C=w.level,this._tileKeysPerLevel[C]||(this._tileKeysPerLevel[C]=[]),this._tileKeysPerLevel[C].push(w))};H.prune=function(C,w,y){let x=this._tilePerId.size;if(!(x<=this.maxSize)){for(var m=this._tileKeysPerLevel.length-1;x>this.maxSize&&0<=m;)m!==C&&(x=this._pruneAroundCenterTile(x,w,y,m)),m--;x>this.maxSize&&(x=this._pruneAroundCenterTile(x,w,y,C))}};H._pruneAroundCenterTile=function(C,w,y,x){x=this._tileKeysPerLevel[x];if(!x||0===x.length)return C;const {size:m,origin:h}=
this._tileInfoView.tileInfo,c=y*m[0],d=y*m[1],f=[0,0],k=[0,0];for(x.sort((g,e)=>{f[0]=h.x+c*(g.col+.5);f[1]=h.y-d*(g.row+.5);k[0]=h.x+c*(e.col+.5);k[1]=h.y-d*(e.row+.5);return u.squaredDistance(f,w)-u.squaredDistance(k,w)});0<x.length&&(y=x.pop(),this._removeTile(y.id),C--,C!==this.maxSize););return C};H._removeTile=function(C){const w=this._tilePerId.get(C);this._removedFunc&&w&&this._removedFunc(w);this._tilePerId["delete"](C)};return t}()})},"esri/views/2d/engine/webgl/mesh/VertexDataWriter":function(){define(["exports",
"../../../../../chunks/_rollupPluginBabelHelpers","../definitions","./heuristics","../util/Writer"],function(u,t,H,C,w){let y=function(){function x(h,c,d){this._start={index:0,vertex:0};d=C.getMeshSizeHint(h,c,d);c/=4;this.geometryType=h;this._records=new w(Int32Array,d.recordBytes);this._indices=new w(Uint32Array,d.indexBytes);this._vertices=new w(Uint32Array,d.vertexBytes);this._metrics=new w(Float32Array,0);this._strideInt=c}var m=x.prototype;m.serialize=function(h){const c=this._records.buffer(),
d=this._indices.buffer(),f=this._vertices.buffer(),k=this._metrics.length?this._metrics.buffer():null,g=4*this._strideInt;h.push(c,d,f);return{stride:g,records:c,indices:d,vertices:f,metrics:k}};m.vertexEnsureSize=function(h){this._vertices.ensureSize(h)};m.indexEnsureSize=function(h){this._indices.ensureSize(h)};m.recordStart=function(){this._start.index=this._indices.length;this._start.vertex=this._vertices.length};m.recordEnd=function(h,c,d,f,k,g,e,a){this._records.push(h);this._records.push(c??
0);this._records.push(d);this._records.push(f);this._records.push(k);this._records.push(g);this._records.push(e);this._records.writeF32(a)};m.writeIndex=function(h){this._indices.push(h)};m.writeVertex=function(h){this._vertices.push(h)};m.writeVertexF32=function(h){this._vertices.writeF32(h)};m.copyLastFrom=function(h,c,d){var f=h._records.length-H.DISPLAY_RECORD_INT_PER_ELEMENT;const k=h._records.getValue(f),g=h._records.getValue(f+1),e=h._records.getValue(f+2),a=h._records.getValue(f+4),b=h._records.getValue(f+
6);f=h._records.getValue(f+7);const l=this._vertices.length;var q=(h._start.vertex-this._vertices.length)/this._strideInt;const n=this._indices.length,v=this.vertexCount;for(var B=h._start.index;B!==h._indices.length;B++){const z=h._indices.getValue(B);this._indices.push(z-q)}for(q=h._start.vertex;q!==h._vertices.length;q++)B=h._vertices.getValue(q),this._vertices.push(B);for(h=l;h<=this._vertices.length;h+=this._strideInt)this._vertices.i1616Add(h,c,d);this._records.push(k);this._records.push(g);
this._records.push(e);this._records.push(n);this._records.push(a);this._records.push(v);this._records.push(b);this._records.push(f)};t._createClass(x,[{key:"strideInt",get:function(){return this._strideInt}},{key:"recordCount",get:function(){return this._records.length/H.DISPLAY_RECORD_INT_PER_ELEMENT}},{key:"vertexCount",get:function(){return this._vertices.length/this._strideInt}},{key:"indexCount",get:function(){return this._indices.length}},{key:"indexWriter",get:function(){return this._indices}},
{key:"vertexWriter",get:function(){return this._vertices}},{key:"metricWriter",get:function(){return this._metrics}}]);return x}();u.VertexDataWriter=y;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/heuristics":function(){define(["exports","../definitions","../enums"],function(u,t,H){const C=new Map;C.set(H.WGLGeometryType.MARKER,{multiplier:1,indicesPerRecord:6,verticesPerRecord:4});C.set(H.WGLGeometryType.LINE,{multiplier:1,indicesPerRecord:24,verticesPerRecord:8});
C.set(H.WGLGeometryType.FILL,{multiplier:1,indicesPerRecord:10,verticesPerRecord:10});C.set(H.WGLGeometryType.TEXT,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});C.set(H.WGLGeometryType.LABEL,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});u.getMeshSizeHint=function(w,y,x){const {indicesPerRecord:m,multiplier:h,verticesPerRecord:c}=C.get(w);return{recordBytes:x*t.DISPLAY_RECORD_INT_PER_ELEMENT*Uint32Array.BYTES_PER_ELEMENT,indexBytes:h*m*x*Uint32Array.BYTES_PER_ELEMENT,vertexBytes:h*
c*x*y}};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/util/Writer":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers"],function(u){return function(){function t(C,w){this._pos=0;w=w?this._roundToNearest(w,C.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(w);this._buffer=new C(this._array);this._ctor=C;this._i16View=new Int16Array(this._array)}var H=t.prototype;H._roundToNearest=function(C,w){C=Math.round(C);return C+(w-C%w)};H._ensureSize=
function(C){if(this._pos+C>=this._buffer.length){C=this._roundToNearest(1.25*(this._array.byteLength+C*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT);C=new ArrayBuffer(C);const w=new this._ctor(C);w.set(this._buffer,0);this._array=C;this._buffer=w;this._i16View=new Int16Array(this._array)}};H.ensureSize=function(C){this._ensureSize(C)};H.writeF32=function(C){this._ensureSize(1);const w=this._pos;(new Float32Array(this._array,4*this._pos,1))[0]=C;this._pos++;return w};H.push=function(C){this._ensureSize(1);
const w=this._pos;this._buffer[this._pos++]=C;return w};H.writeFixed=function(C){this._buffer[this._pos++]=C};H.setValue=function(C,w){this._buffer[C]=w};H.i1616Add=function(C,w,y){this._i16View[2*C]+=w;this._i16View[2*C+1]+=y};H.getValue=function(C){return this._buffer[C]};H.incr=function(C){if(this._buffer.length<C)throw Error("Increment index overflows the target buffer");this._buffer[C]++};H.decr=function(C){this._buffer[C]--};H.writeRegion=function(C){this._ensureSize(C.length);const w=this._pos;
this._buffer.set(C,this._pos);this._pos+=C.length;return w};H.writeManyFrom=function(C,w,y){for(this._ensureSize(y-w);w!==y;w++)this.writeFixed(C._buffer[w])};H.buffer=function(){const C=this._array.slice(0,4*this._pos);this.destroy();return C};H.toArray=function(){const C=this._array,w=[];for(let y=0;y<C.byteLength/4;y++)w.push(C[y]);return w};H.seek=function(C){this._pos=C};H.destroy=function(){this._buffer=this._array=null};u._createClass(t,[{key:"length",get:function(){return this._pos}}]);return t}()})},
"esri/views/2d/layers/features/support/tileUtils":function(){define(["exports"],function(u){u.getPow2NeighborKey=function(t,H,C,w){t=t.clone();const y=1<<t.level;H=t.col+H;C=t.row+C;w&&0>H?(t.col=H+y,--t.world):H>=y?(t.col=H-y,t.world+=1):t.col=H;t.row=C;return t};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/factories/WGLMeshFactory":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../../../../../core/maybe ../../../../../../core/promiseUtils ../../../../../../geometry/libtess ../../DisplayId ../templates/WGLLabelTemplate ../templates/WGLMarkerTemplate ../templates/WGLTemplateStore".split(" "),
function(u,t,H,C,w,y,x,m,h,c){H=function(){function d(k,g,e){this._loadPromise=y.loadLibtess();this._geometryType=k;this._idField=g;this._templateStore=e}var f=d.prototype;f.update=function(k,g){C.isSome(k.mesh.labels)&&(this._labelTemplates=this._createLabelTemplates(k.mesh.labels,g));this._schema=k};f._createLabelTemplates=function(k,g){const e=new Map;if("simple"===k.type){for(var a of k.classes)k=m.fromLabelClass(a,g),e.set(a.index,k);return e}for(const b in k.classes){a=k.classes[b];for(const l of a)a=
m.fromLabelClass(l,g),e.set(l.index,a)}return e};f.analyze=function(){var k=t._asyncToGenerator(function*(g,e,a,b,l,q,n){if(!w.isAborted(n)){var v;"dictionary"===a?.type&&(v=yield a.analyze(this._idField,g.copy(),e,l,q,n));for(e=0;g.next();){var B=null;B=v?v[e++]:C.isSome(b)&&x.isAggregateId(g.getDisplayId())&&1!==g.readAttribute("cluster_count")?b.match(this._idField,g,this._geometryType,l,q):a.match(this._idField,g,this._geometryType,l,q);g.setGroupId(B);if(c.isDynamicId(B)){B=this._templateStore.getDynamicTemplateGroup(B).templates;
for(const z of B)z&&z.analyze&&z.analyze(this._templateStore,g,l,q)}}yield this._loadPromise;return this._templateStore.finalize(n)}});return function(g,e,a,b,l,q,n){return k.apply(this,arguments)}}();f.analyzeGraphics=function(){var k=t._asyncToGenerator(function*(g,e,a,b,l,q){if(!w.isAborted(q)){g=g.getCursor();for(a&&(yield a.analyze(this._idField,g.copy(),e,b,l,q));g.next();){e=g.getGroupId();if(null==e||-1===e)e=a?.match(this._idField,g,g.geometryType,b,l),g.setGroupId(e);if(c.isDynamicId(e)){const n=
this._templateStore.getDynamicTemplateGroup(e).templates;for(const v of n)v&&v.analyze&&v.analyze(this._templateStore,g,b,l)}g.setGroupId(e)}yield this._loadPromise;return this._templateStore.finalize(q)}});return function(g,e,a,b,l,q){return k.apply(this,arguments)}}();f.writeGraphic=function(k,g,e,a){const b=g.getGroupId(),l=g.getDisplayId(),q=this._templateStore.getTemplateGroup(b);k.featureStart(g.insertAfter,0);if(null!=l){if(c.isDynamicId(b))for(const n of q.templates)n&&n.bindFeature(g,null,
null);if(q){for(const n of q.templates)n&&n.write(k,g,e,a);k.featureEnd()}}};f.writeCursor=function(k,g,e,a,b,l,q){const n=g.getGroupId(),v=g.getDisplayId();var B=this._templateStore.getTemplateGroup(n);const z=B.templates;B=this._getSortKeyValue(g,B);k.featureStart(0,B);if(null!=v&&z){if(c.isDynamicId(n))for(const p of z)p.bindFeature(g,e,a);for(const p of z)p.write(k,g,b,q);C.isSome(l)&&k.hasRecords&&(e=l&&this._findLabelRef(z),this._writeLabels(k,g,l,e,b,q));k.featureEnd()}};f._getSortKeyValue=
function(k,g){const e=this._schema.mesh.sortKey;if(C.isNone(e))return 0;let a=0;a=!0===e.byRenderer&&null!=g.sortKey?g.sortKey:null!=e.fieldIndex?k.getComputedNumericAtIndex(e.fieldIndex):null!=e.field?k.readAttribute(e.field):k.readAttribute(this._idField);a*="asc"===e.order?1:-1;return null==a||isNaN(a)?0:a};f._findLabelRef=function(k){for(const g of k)if(g instanceof h)return g;return null};f._writeLabels=function(k,g,e,a,b,l){for(const q of e)if(C.isSome(q)&&q){const {glyphs:n,rtl:v,index:B}=
q;if(e=this._labelTemplates.get(B))e.setZoomLevel(b),e.bindReferenceTemplate(a),e.bindTextInfo(n,v),e.write(k,g,null,l)}};t._createClass(d,[{key:"templates",get:function(){return this._templateStore}}]);return d}();u.WGLMeshFactory=H;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/WGLLabelTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../symbols/cim/enums ../../alignmentUtils ../../color ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./segmentUtils ./WGLTextTemplate".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f,k,g,e,a,b){const l=H.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate"),q=(v,B="mapview-labeling")=>l.error(new t(B,v)),n=function(v){const B=new Map;return z=>{B.has(z)||B.set(z,v(z));return B.get(z)}}(v=>{let B=0;if(0===v)return Infinity;for(;!(v%2);)B++,v/=2;return B});return function(v){function B(p,r,D,J){var K=v.call(this,p,D.font?.size,D.haloSize||0,D.font?.size,D.color&&d.premultiplyAlphaRGBAArray(D.color)||0,D.haloColor&&d.premultiplyAlphaRGBAArray(D.haloColor)||
0,D.horizontalAlignment,D.verticalAlignment,c.isMapAligned(r.labelPlacement)?h.Alignment.MAP:h.Alignment.SCREEN,D.font?.decoration,!1,D.angle||0,D.xoffset,D.yoffset,D.lineWidth,D.lineHeight,null,null,!1,null,null,D.backgroundColor&&d.premultiplyAlphaRGBAArray(D.backgroundColor),D.borderLineColor&&d.premultiplyAlphaRGBAArray(D.borderLineColor),D.borderLineSize)||this;K._outLineLabelAngle=0;K._refPlacementPadding=0;K._refPlacementDirX=0;K._refPlacementDirY=0;K._refOffsetX=0;K._refOffsetY=0;K._zoomLevel=
0;K.geometryType=k.WGLGeometryType.LABEL;K._allowOverrun=r.allowOverrun??!1;K._repeatLabel=r.repeatLabel??!0;K._labelPosition=r.labelPosition??"curved";var F=!!r.minScale&&J.scaleToZoom(r.minScale)||0;F=C.clamp(F,0,25.5);J=!!r.maxScale&&J.scaleToZoom(r.maxScale)||255;J=C.clamp(J,0,25.5);const [A,I]=c.getAlignmentFromPlacement(r.labelPlacement);K._xAlignD=A;K._yAlignD=I;K._minZoom=F;K._maxZoom=J;K._minBackgroundZoom=F;K._maxBackgroundZoom=J;K._refPlacementPadding=y.pt2px(D.haloSize)+f.TEXT_PLACEMENT_PADDING;
K._repeatLabelDistance=r.repeatLabelDistance?y.pt2px(r.repeatLabelDistance):128;p=e.LabelMaterialKey.load(p);p.sdf=!0;K._materialKey=p.data;return K}u._inheritsLoose(B,v);B.fromLabelClass=function(p,r){if("esriServerLinePlacementCenterAlong"===p.labelPlacement){const D=p.symbol;D.xoffset=0;D.yoffset=0;D.angle=0;D.font.decoration="none"}return new B(p.materialKey,p,p.symbol,r)};var z=B.prototype;z.setZoomLevel=function(p){this._zoomLevel=p};z.bindReferenceTemplate=function(p){let r=c.getXDirection(this._xAlignD),
D=c.getYDirection(this._yAlignD);this._refOffsetY=this._refOffsetX=0;if(w.isNone(p))this._refSymbolAndPlacementOffset=g.i8888to32(0,0,Math.floor(127*r+127),Math.floor(127*D+127));else{if("circle"===p.boundsType&&(r||D)){var J=Math.sqrt(r*r+D*D);r/=J;D/=J}J=Math.max(p.height,p.width);this._refSymbolAndPlacementOffset=g.i8888to32(4*this._refPlacementPadding,J,Math.floor(127*r+127),Math.floor(127*D+127));this._referenceSize=J;this._refPlacementDirX=r;this._refPlacementDirY=D;this._refOffsetX=p.xOffset;
this._refOffsetY=p.yOffset}};z._write=function(p,r){if(!w.isNone(this._shapingInfo)){var D=this._shapingInfo,J=r.getDisplayId(),K="esriGeometryPolygon"===r.geometryType?r.readLegacyCentroid():r.readLegacyGeometry();if(K)switch(this._current={out:p,inId:J,inShaping:D,zoomLevel:this._zoomLevel},"esriGeometryPolyline"===r.geometryType&&"curved"===this._labelPosition&&(this._borderLineColor||this._backgroundColor)&&l.warnOnce("TextSymbol properties 'borderLineColor', 'borderLineSize', and 'backgroundColor' are not supported in curved labels"),
r.geometryType){case "esriGeometryPolyline":this._placeLineLabels(K);break;case "esriGeometryPoint":case "esriGeometryPolygon":this._placePointLabels(K);break;default:q(`Geometry of type ${r.geometryType} is not supported`)}}};z._isVisible=function(p,r){const D=Math.floor(10*this._current.zoomLevel);return Math.floor(10*p)<=D&&D<=Math.floor(10*r)};z._placePointLabels=function(p){const {out:r,inId:D,inShaping:J}=this._current;this._writeGlyphs(r,D,p,J)};z._placeLineLabels=function(p){p=a.smoothPaths(p.paths,
this._current.inShaping.bounds.width);const r=this._placeSubdivGlyphs.bind(this),D=(this._shapedBox.width+this._repeatLabelDistance)/2;for(const J of p)a.pathDivide(J,D,r,this._repeatLabel)};z._placeSubdivGlyphs=function(p,r,D,J){var K=n(r),F=this._shapedBox.width/2,A=Math.sqrt(this._repeatLabelDistance)/2;D=Math.min(D,J-D);F=this._current.inShaping.isMultiline?25:Math.log2(D/(A+F/2));K=Math.max(this._minZoom,this._current.zoomLevel+1-(0===r?F:Math.min(K,F)));F=this._current.zoomLevel-K;A=this._shapedBox.width/
2*2**F;this._current.inShaping.isMultiline?0===r&&this._placeStraight(p,K):this._allowOverrun&&0>F?this._placeStraightAlong(p,this._minZoom):"parallel"===this._labelPosition?this._placeStraightAlong(p,K):"curved"===this._labelPosition&&this._placeCurved(p,K,A)};z._placeStraight=function(p,r){const {out:D,inId:J,inShaping:K}=this._current,F=Math.ceil((180/Math.PI*p.angle+180)%360);this._outLineLabelAngle=Math.round(254/360*Math.ceil(180/Math.PI*p.angle%360));this._writeGlyphs(D,J,p,K,r);this._outLineLabelAngle=
Math.round(254/360*F);this._writeGlyphs(D,J,p,K,r)};z._placeCurved=function(p,r,D){const {out:J,inId:K}=this._current;J.metricStart(K,r,p.x,p.y,0,0,0,0);const F=p.clone(),A=(180/Math.PI*p.angle+180)%360;this._outLineLabelAngle=Math.round(180/Math.PI*p.angle%360*(254/360));this._placeFirst(F,r,1);this._placeBack(p,F,r,D,1);this._placeForward(p,F,r,D,1);this._outLineLabelAngle=Math.round(254/360*A);this._placeFirst(F,r,0);this._placeBack(p,F,r,D,0);this._placeForward(p,F,r,D,0);J.metricEnd()};z._placeStraightAlong=
function(p,r){const {out:D,inId:J,inShaping:K}=this._current;D.metricStart(J,r,p.x,p.y,0,0,0,0);const F=p.clone(),A=180/Math.PI*p.angle%360,I=(180/Math.PI*p.angle+180)%360;var G=0<K.glyphs.length&&(this._borderLineColor||this._backgroundColor);this._maxBackgroundZoom=25;this._minBackgroundZoom=Math.max(r,0);if(G){G=e.LabelMaterialKey.load(this._materialKey);G.textureBinding=K.glyphs[0].textureBinding;const E=x.fromRotation(m.create(),-p.angle),[M,T]=K.shapeBackground(E);this._outLineLabelAngle=Math.round(254/
360*A);D.recordStart(J,G.data,this.geometryType,!0);this._writeBackgroundGeometry(D,J,p,M,T);D.recordEnd();this._outLineLabelAngle=Math.round(254/360*I);D.recordStart(J,G.data,this.geometryType,!0);this._writeBackgroundGeometry(D,J,p,M,T);D.recordEnd()}this._outLineLabelAngle=Math.round(254/360*A);this._placeFirst(F,r,1,!0);this._outLineLabelAngle=Math.round(254/360*I);this._placeFirst(F,r,0,!0);D.metricEnd()};z._placeBack=function(p,r,D,J,K){const F=p.clone();for(p=p.backwardLength+0;F.prev()&&!(p>=
J);)this._placeOnSegment(F,r,p,D,-1,K),p+=F.length+0};z._placeForward=function(p,r,D,J,K){const F=p.clone();for(p=p.remainingLength+0;F.next()&&!(p>=J);)this._placeOnSegment(F,r,p,D,1,K),p+=F.length+0};z._placeFirst=function(p,r,D,J=!1){const K=this._current.inShaping;var F=K.glyphs;const A=this._current.zoomLevel,{out:I,inId:G}=this._current;for(const E of F)F=E.x>K.bounds.x?D:1-D,F=Math.max(0,A+Math.log2(Math.abs(E.x+E.width/2-K.bounds.x)/(F*p.remainingLength+(1-F)*p.backwardLength))),F=Math.max(r,
J?0:F),E.maxZoom=25,E.angle=p.angle+(1-D)*Math.PI,E.minZoom=F,this._writeGlyph(I,G,p.x,p.y,E),D&&this._isVisible(E.minZoom,E.maxZoom)&&(F=E.bounds,I.metricBoxWrite(F.center[0],F.center[1],F.width,F.height))};z._placeOnSegment=function(p,r,D,J,K,F){var A=this._current.inShaping.glyphs;const {out:I,inId:G}=this._current,E=this._current.inShaping,M=this._current.zoomLevel;var T=p.x+p.dx/p.length*-K*D,Y=p.y+p.dy/p.length*-K*D;for(const ba of A)if((A=ba.x>E.bounds.x?F:1-F)&&1===K||!A&&-1===K){var fa=Math.abs(ba.x+
ba.width/2-E.bounds.x);A=Math.max(0,M+Math.log2(fa/D)-.1);fa=Math.max(J,M+Math.log2(fa/(D+p.length+0)));0!==A&&(ba.angle=p.angle+(1-F)*Math.PI,ba.minZoom=fa,ba.maxZoom=A,this._writeGlyph(I,G,T,Y,ba),F&&this._isVisible(ba.minZoom,ba.maxZoom)&&(A=ba.bounds,I.metricBoxWrite(A.center[0]+(p.x-r.x),A.center[1]+(p.y-r.y),A.width,A.height)))}};z._writeGlyphs=function(p,r,D,J,K=this._minZoom){if(!(0>D.x||512<=D.x||0>D.y||512<=D.y)){if(0<J.glyphs.length&&(this._borderLineColor||this._backgroundColor)){var F=
e.LabelMaterialKey.load(this._materialKey);F.textureBinding=J.glyphs[0].textureBinding;p.recordStart(r,F.data,this.geometryType,!0);this._writeBackgroundGeometry(p,r,D,J.bounds,J.background);p.recordEnd()}F=D.x+this._refOffsetX;D=D.y-this._refOffsetY;for(const A of J.glyphs)A.minZoom=K,A.maxZoom=this._maxZoom,this._writeGlyph(p,r,F,D,A);J=J.boundsT;p.metricStart(r,K,F,D,this._refPlacementDirX,this._refPlacementDirY,this._referenceSize,this._materialKey);p.metricBoxWrite(J.center[0],J.center[1],J.width,
J.height);p.metricEnd()}};z._writeVertexCommon=function(p,r,D,J){const K=this._color,F=this._haloColor,A=g.i8888to32(0,0,this._size,this._haloSize);J=g.i8888to32(Math.floor(10*Math.max(J.minZoom,this._minZoom)),Math.floor(10*Math.min(J.maxZoom,this._maxZoom)),this._outLineLabelAngle,0);p.vertexWrite(D);p.vertexWrite(r);p.vertexWrite(K);p.vertexWrite(F);p.vertexWrite(A);p.vertexWrite(this._refSymbolAndPlacementOffset);p.vertexWrite(J)};z._writeBackgroundVertex=function(p,r,D,J,K,F){const A=g.i8888to32(0,
0,this._size,this._haloSize),I=g.i8888to32(0,0,0,0),G=g.i8888to32(Math.floor(10*this._minBackgroundZoom),Math.floor(10*this._maxBackgroundZoom),this._outLineLabelAngle,1);p.vertexWrite(D);p.vertexWrite(r);p.vertexWrite(J);p.vertexWrite(I);p.vertexWrite(A);p.vertexWrite(this._refSymbolAndPlacementOffset);p.vertexWrite(G);p.vertexWrite(K);p.vertexWrite(F);p.vertexEnd()};u._createClass(B,[{key:"_shapedBox",get:function(){return w.unwrap(this._shapingInfo).bounds}}]);return B}(b)})},"esri/chunks/mat2d":function(){define(["exports",
"./common"],function(u,t){function H(p,r){p[0]=r[0];p[1]=r[1];p[2]=r[2];p[3]=r[3];p[4]=r[4];p[5]=r[5];return p}function C(p){p[0]=1;p[1]=0;p[2]=0;p[3]=1;p[4]=0;p[5]=0;return p}function w(p,r,D,J,K,F,A){p[0]=r;p[1]=D;p[2]=J;p[3]=K;p[4]=F;p[5]=A;return p}function y(p,r){const D=r[0],J=r[1],K=r[2],F=r[3],A=r[4];r=r[5];let I=D*F-J*K;if(!I)return null;I=1/I;p[0]=F*I;p[1]=-J*I;p[2]=-K*I;p[3]=D*I;p[4]=(K*r-F*A)*I;p[5]=(J*A-D*r)*I;return p}function x(p){return p[0]*p[3]-p[1]*p[2]}function m(p,r,D){const J=
r[0],K=r[1],F=r[2],A=r[3],I=r[4];r=r[5];const G=D[0],E=D[1],M=D[2],T=D[3],Y=D[4];D=D[5];p[0]=J*G+F*E;p[1]=K*G+A*E;p[2]=J*M+F*T;p[3]=K*M+A*T;p[4]=J*Y+F*D+I;p[5]=K*Y+A*D+r;return p}function h(p,r,D){const J=r[0],K=r[1],F=r[2],A=r[3],I=r[4];r=r[5];const G=Math.sin(D);D=Math.cos(D);p[0]=J*D+F*G;p[1]=K*D+A*G;p[2]=J*-G+F*D;p[3]=K*-G+A*D;p[4]=I;p[5]=r;return p}function c(p,r,D){const J=r[1],K=r[2],F=r[3],A=r[4],I=r[5],G=D[0];D=D[1];p[0]=r[0]*G;p[1]=J*G;p[2]=K*D;p[3]=F*D;p[4]=A;p[5]=I;return p}function d(p,
r,D){const J=r[0],K=r[1],F=r[2],A=r[3],I=r[4];r=r[5];const G=D[0];D=D[1];p[0]=J;p[1]=K;p[2]=F;p[3]=A;p[4]=J*G+F*D+I;p[5]=K*G+A*D+r;return p}function f(p,r){const D=Math.sin(r);r=Math.cos(r);p[0]=r;p[1]=D;p[2]=-D;p[3]=r;p[4]=0;p[5]=0;return p}function k(p,r){p[0]=r[0];p[1]=0;p[2]=0;p[3]=r[1];p[4]=0;p[5]=0;return p}function g(p,r){p[0]=1;p[1]=0;p[2]=0;p[3]=1;p[4]=r[0];p[5]=r[1];return p}function e(p){return"mat2d("+p[0]+", "+p[1]+", "+p[2]+", "+p[3]+", "+p[4]+", "+p[5]+")"}function a(p){return Math.sqrt(p[0]**
2+p[1]**2+p[2]**2+p[3]**2+p[4]**2+p[5]**2+1)}function b(p,r,D){p[0]=r[0]+D[0];p[1]=r[1]+D[1];p[2]=r[2]+D[2];p[3]=r[3]+D[3];p[4]=r[4]+D[4];p[5]=r[5]+D[5];return p}function l(p,r,D){p[0]=r[0]-D[0];p[1]=r[1]-D[1];p[2]=r[2]-D[2];p[3]=r[3]-D[3];p[4]=r[4]-D[4];p[5]=r[5]-D[5];return p}function q(p,r,D){p[0]=r[0]*D;p[1]=r[1]*D;p[2]=r[2]*D;p[3]=r[3]*D;p[4]=r[4]*D;p[5]=r[5]*D;return p}function n(p,r,D,J){p[0]=r[0]+D[0]*J;p[1]=r[1]+D[1]*J;p[2]=r[2]+D[2]*J;p[3]=r[3]+D[3]*J;p[4]=r[4]+D[4]*J;p[5]=r[5]+D[5]*J;return p}
function v(p,r){return p[0]===r[0]&&p[1]===r[1]&&p[2]===r[2]&&p[3]===r[3]&&p[4]===r[4]&&p[5]===r[5]}function B(p,r){const D=p[0],J=p[1],K=p[2],F=p[3],A=p[4];p=p[5];const I=r[0],G=r[1],E=r[2],M=r[3],T=r[4];r=r[5];const Y=t.getEpsilon();return Math.abs(D-I)<=Y*Math.max(1,Math.abs(D),Math.abs(I))&&Math.abs(J-G)<=Y*Math.max(1,Math.abs(J),Math.abs(G))&&Math.abs(K-E)<=Y*Math.max(1,Math.abs(K),Math.abs(E))&&Math.abs(F-M)<=Y*Math.max(1,Math.abs(F),Math.abs(M))&&Math.abs(A-T)<=Y*Math.max(1,Math.abs(A),Math.abs(T))&&
Math.abs(p-r)<=Y*Math.max(1,Math.abs(p),Math.abs(r))}const z=Object.freeze(Object.defineProperty({__proto__:null,add:b,copy:H,determinant:x,equals:B,exactEquals:v,frob:a,fromRotation:f,fromScaling:k,fromTranslation:g,identity:C,invert:y,mul:m,multiply:m,multiplyScalar:q,multiplyScalarAndAdd:n,rotate:h,scale:c,set:w,str:e,sub:l,subtract:l,translate:d},Symbol.toStringTag,{value:"Module"}));u.add=b;u.copy=H;u.determinant=x;u.equals=B;u.exactEquals=v;u.frob=a;u.fromRotation=f;u.fromScaling=k;u.fromTranslation=
g;u.identity=C;u.invert=y;u.mat2d=z;u.mul=m;u.multiply=m;u.multiplyScalar=q;u.multiplyScalarAndAdd=n;u.rotate=h;u.scale=c;u.set=w;u.str=e;u.sub=l;u.subtract=l;u.translate=d})},"esri/chunks/mat2df32":function(){define(["exports"],function(u){function t(){const h=new Float32Array(6);h[0]=1;h[3]=1;return h}function H(h){const c=new Float32Array(6);c[0]=h[0];c[1]=h[1];c[2]=h[2];c[3]=h[3];c[4]=h[4];c[5]=h[5];return c}function C(h,c,d,f,k,g){const e=new Float32Array(6);e[0]=h;e[1]=c;e[2]=d;e[3]=f;e[4]=
k;e[5]=g;return e}function w(h,c){return new Float32Array(h,c,6)}function y(h,c,d,f){const k=c[f];c=c[f+1];h[f]=d[0]*k+d[2]*c+d[4];h[f+1]=d[1]*k+d[3]*c+d[5]}function x(h,c,d,f=0,k=0,g=2){for(k=k||c.length/g;f<k;f++)y(h,c,d,f*g)}const m=Object.freeze(Object.defineProperty({__proto__:null,clone:H,create:t,createView:w,fromValues:C,transform:y,transformMany:x},Symbol.toStringTag,{value:"Module"}));u.clone=H;u.create=t;u.createView=w;u.fromValues=C;u.mat2df32=m;u.transform=y;u.transformMany=x})},"esri/views/2d/engine/webgl/alignmentUtils":function(){define(["exports"],
function(u){u.HAlign=void 0;(function(t){t[t.Left=-1]="Left";t[t.Center=0]="Center";t[t.Right=1]="Right"})(u.HAlign||(u.HAlign={}));u.VAlign=void 0;(function(t){t[t.Top=1]="Top";t[t.Center=0]="Center";t[t.Bottom=-1]="Bottom";t[t.Baseline=2]="Baseline"})(u.VAlign||(u.VAlign={}));u.getAlignmentFromPlacement=function(t){switch(t){case "above-left":case "esriServerPointLabelPlacementAboveLeft":return[u.HAlign.Right,u.VAlign.Bottom];case "above-center":case "above-along":case "esriServerPointLabelPlacementAboveCenter":case "esriServerLinePlacementAboveAlong":return[u.HAlign.Center,
u.VAlign.Bottom];case "above-right":case "esriServerPointLabelPlacementAboveRight":return[u.HAlign.Left,u.VAlign.Bottom];case "center-left":case "esriServerPointLabelPlacementCenterLeft":return[u.HAlign.Right,u.VAlign.Center];case "center-center":case "center-along":case "esriServerPointLabelPlacementCenterCenter":case "esriServerLinePlacementCenterAlong":return[u.HAlign.Center,u.VAlign.Center];case "center-right":case "esriServerPointLabelPlacementCenterRight":return[u.HAlign.Left,u.VAlign.Center];
case "below-left":case "esriServerPointLabelPlacementBelowLeft":return[u.HAlign.Right,u.VAlign.Top];case "below-center":case "below-along":case "esriServerPointLabelPlacementBelowCenter":case "esriServerLinePlacementBelowAlong":return[u.HAlign.Center,u.VAlign.Top];case "below-right":case "esriServerPointLabelPlacementBelowRight":return[u.HAlign.Left,u.VAlign.Top];case "always-horizontal":case "esriServerPolygonPlacementAlwaysHorizontal":return[u.HAlign.Center,u.VAlign.Center];default:return console.debug(`Found invalid placement type ${t}`),
[u.HAlign.Center,u.VAlign.Center]}};u.getJustification=function(t){switch(t){case "left":return u.HAlign.Left;case "right":return u.HAlign.Right;case "center":return u.HAlign.Center}};u.getXAnchorDirection=function(t){switch(t){case "left":return u.HAlign.Left;case "right":return u.HAlign.Right;case "center":return u.HAlign.Center}};u.getXDirection=function(t){switch(t){case u.HAlign.Right:return-1;case u.HAlign.Center:return 0;case u.HAlign.Left:return 1;default:return console.debug(`Found invalid horizontal alignment ${t}`),
0}};u.getYAnchorDirection=function(t){switch(t){case "top":return u.VAlign.Top;case "middle":return u.VAlign.Center;case "baseline":return u.VAlign.Baseline;case "bottom":return u.VAlign.Bottom}};u.getYDirection=function(t){switch(t){case u.VAlign.Top:return 1;case u.VAlign.Center:return 0;case u.VAlign.Bottom:case u.VAlign.Baseline:return-1;default:return console.debug(`Found invalid vertical alignment ${t}`),0}};u.isMapAligned=function(t){switch(t){case "above-along":case "below-along":case "center-along":case "esriServerLinePlacementAboveAlong":case "esriServerLinePlacementBelowAlong":case "esriServerLinePlacementCenterAlong":return!0;
default:return!1}};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/materialKey/MaterialKey":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/Error","../alignmentUtils","../enums"],function(u,t,H,C,w){function y(q){return q===w.WGLSymbologyType.SIMPLE||q===w.WGLSymbologyType.OUTLINE_FILL_SIMPLE}function x(q){return q===w.WGLSymbologyType.OUTLINE_FILL||q===w.WGLSymbologyType.OUTLINE_FILL_SIMPLE}const m=Object.keys(w.WGLSymbologyType).filter(q=>
"number"===typeof w.WGLSymbologyType[q]).reduce((q,n)=>({...q,[n]:w.WGLSymbologyType[n]}),{});let h=function(){function q(v){this._data=0;this._data=v}q.load=function(v){const B=this.shared;B.data=v;return B};var n=q.prototype;n.setBit=function(v,B){v=1<<v;this._data=B?this._data|v:this._data&~v};n.bit=function(v){return(this._data&1<<v)>>v};n.setBits=function(v,B,z){for(let p=B,r=0;p<z;p++,r++)this.setBit(p,0!==(v&1<<r))};n.bits=function(v,B){let z=0;for(let p=v,r=0;p<B;p++,r++)z|=this.bit(p)<<r;
return z};n.hasVV=function(){return!1};n.setVV=function(v,B){};n.getVariation=function(){return{mapAligned:this.mapAligned,pattern:this.pattern,sdf:this.sdf,symbologyType:{value:w.WGLSymbologyType[this.symbologyType],options:m,namespace:"SYMBOLOGY_TYPE"}}};n.getVariationHash=function(){return this._data&~(7&this.textureBinding)};t._createClass(q,[{key:"data",get:function(){return this._data},set:function(v){this._data=v??0}},{key:"geometryType",get:function(){return this.bits(8,11)},set:function(v){this.setBits(v,
8,11)}},{key:"mapAligned",get:function(){return!!this.bit(20)},set:function(v){this.setBit(20,v)}},{key:"sdf",get:function(){return!!this.bit(11)},set:function(v){this.setBit(11,v??!1)}},{key:"pattern",get:function(){return!!this.bit(12)},set:function(v){this.setBit(12,v)}},{key:"textureBinding",get:function(){return this.bits(0,8)},set:function(v){this.setBits(v,0,8)}},{key:"symbologyType",get:function(){return this.bits(21,26)},set:function(v){this.setBits(v,21,26)}},{key:"geometryTypeString",get:function(){switch(this.geometryType){case w.WGLGeometryType.FILL:return"fill";
case w.WGLGeometryType.MARKER:return"marker";case w.WGLGeometryType.LINE:return"line";case w.WGLGeometryType.TEXT:return"text";case w.WGLGeometryType.LABEL:return"label";default:throw new H(`Unable to handle unknown geometryType: ${this.geometryType}`);}}}]);return q}();h.shared=new h(0);const c=q=>function(n){function v(){return n.apply(this,arguments)||this}t._inheritsLoose(v,n);var B=v.prototype;B.hasVV=function(){return n.prototype.hasVV.call(this)||this.vvSizeMinMaxValue||this.vvSizeScaleStops||
this.vvSizeFieldStops||this.vvSizeUnitValue};B.setVV=function(z,p){n.prototype.setVV.call(this,z,p);{var r=this.geometryType;const D=w.WGLVVFlag.SIZE_FIELD_STOPS|w.WGLVVFlag.SIZE_MINMAX_VALUE|w.WGLVVFlag.SIZE_SCALE_STOPS|w.WGLVVFlag.SIZE_UNIT_VALUE,J=(z&(w.WGLVVTarget.FIELD_TARGETS_OUTLINE|w.WGLVVTarget.MINMAX_TARGETS_OUTLINE|w.WGLVVTarget.SCALE_TARGETS_OUTLINE|w.WGLVVTarget.UNIT_TARGETS_OUTLINE))>>>4;p=r===w.WGLGeometryType.LINE&&p.isOutline||r===w.WGLGeometryType.FILL&&x(p.symbologyType)?D&J:D&
~J}z&=p;this.vvSizeMinMaxValue=!!(z&w.WGLVVFlag.SIZE_MINMAX_VALUE);this.vvSizeFieldStops=!!(z&w.WGLVVFlag.SIZE_FIELD_STOPS);this.vvSizeUnitValue=!!(z&w.WGLVVFlag.SIZE_UNIT_VALUE);this.vvSizeScaleStops=!!(z&w.WGLVVFlag.SIZE_SCALE_STOPS)};t._createClass(v,[{key:"vvSizeMinMaxValue",get:function(){return 0!==this.bit(16)},set:function(z){this.setBit(16,z)}},{key:"vvSizeScaleStops",get:function(){return 0!==this.bit(17)},set:function(z){this.setBit(17,z)}},{key:"vvSizeFieldStops",get:function(){return 0!==
this.bit(18)},set:function(z){this.setBit(18,z)}},{key:"vvSizeUnitValue",get:function(){return 0!==this.bit(19)},set:function(z){this.setBit(19,z)}}]);return v}(q),d=q=>function(n){function v(){return n.apply(this,arguments)||this}t._inheritsLoose(v,n);var B=v.prototype;B.hasVV=function(){return n.prototype.hasVV.call(this)||this.vvRotation};B.setVV=function(z,p){n.prototype.setVV.call(this,z,p);this.vvRotation=!p.isOutline&&!!(z&w.WGLVVFlag.ROTATION)};t._createClass(v,[{key:"vvRotation",get:function(){return 0!==
this.bit(15)},set:function(z){this.setBit(15,z)}}]);return v}(q),f=q=>function(n){function v(){return n.apply(this,arguments)||this}t._inheritsLoose(v,n);var B=v.prototype;B.hasVV=function(){return n.prototype.hasVV.call(this)||this.vvColor};B.setVV=function(z,p){n.prototype.setVV.call(this,z,p);this.vvColor=!p.isOutline&&!!(z&w.WGLVVFlag.COLOR)};t._createClass(v,[{key:"vvColor",get:function(){return 0!==this.bit(13)},set:function(z){this.setBit(13,z)}}]);return v}(q),k=q=>function(n){function v(){return n.apply(this,
arguments)||this}t._inheritsLoose(v,n);var B=v.prototype;B.hasVV=function(){return n.prototype.hasVV.call(this)||this.vvOpacity};B.setVV=function(z,p){n.prototype.setVV.call(this,z,p);this.vvOpacity=!p.isOutline&&!!(z&w.WGLVVFlag.OPACITY)};t._createClass(v,[{key:"vvOpacity",get:function(){return 0!==this.bit(14)},set:function(z){this.setBit(14,z)}}]);return v}(q);let g=function(q){function n(){return q.apply(this,arguments)||this}t._inheritsLoose(n,q);n.load=function(v){const B=this.shared;B.data=
v;return B};n.from=function(v){const {symbologyType:B,vvFlags:z}=v,p=this.load(0);p.geometryType=w.WGLGeometryType.FILL;p.symbologyType=B;B!==w.WGLSymbologyType.DOT_DENSITY&&p.setVV(z,v);return p.data};n.prototype.getVariation=function(){return{...q.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return n}(f(k(c(h))));
g.shared=new g(0);let e=function(q){function n(){return q.apply(this,arguments)||this}t._inheritsLoose(n,q);n.load=function(v){const B=this.shared;B.data=v;return B};n.from=function(v){const {symbologyType:B,vvFlags:z}=v,p=this.load(0);p.geometryType=w.WGLGeometryType.MARKER;p.symbologyType=B;B!==w.WGLSymbologyType.HEATMAP&&p.setVV(z,v);return p.data};n.prototype.getVariation=function(){return{...q.prototype.getVariation.call(this),vvColor:this.vvColor,vvRotation:this.vvRotation,vvOpacity:this.vvOpacity,
vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return n}(f(k(d(c(h)))));e.shared=new e(0);let a=function(q){function n(){return q.apply(this,arguments)||this}t._inheritsLoose(n,q);n.load=function(v){const B=this.shared;B.data=v;return B};n.from=function(v){const B=this.load(0);B.geometryType=w.WGLGeometryType.LINE;B.symbologyType=v.symbologyType;B.setVV(v.vvFlags,v);return B.data};n.prototype.getVariation=
function(){return{...q.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return n}(f(k(c(h))));a.shared=new a(0);let b=function(q){function n(){return q.apply(this,arguments)||this}t._inheritsLoose(n,q);n.load=function(v){const B=this.shared;B.data=v;return B};n.from=function(v){const B=this.load(0);B.geometryType=
w.WGLGeometryType.TEXT;B.symbologyType=v.symbologyType;B.setVV(v.vvFlags,v);return B.data};n.prototype.getVariation=function(){return{...q.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvRotation:this.vvRotation,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return n}(f(k(d(c(h)))));b.shared=new b(0);let l=function(q){function n(){return q.apply(this,arguments)||
this}t._inheritsLoose(n,q);n.load=function(v){const B=this.shared;B.data=v;return B};n.from=function(v){const B=this.load(0);B.geometryType=w.WGLGeometryType.LABEL;B.symbologyType=v.symbologyType;B.setVV(v.vvFlags,v);B.mapAligned=C.isMapAligned(v.placement);return B.data};n.prototype.getVariation=function(){return{...q.prototype.getVariation.call(this),vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};
return n}(c(h));l.shared=new l(0);u.FillMaterialKey=g;u.LabelMaterialKey=l;u.LineMaterialKey=a;u.MarkerMaterialKey=e;u.MaterialKeyBase=h;u.TextMaterialKey=b;u.createMaterialKey=function(q,n){switch(q){case w.WGLGeometryType.FILL:return g.from(n);case w.WGLGeometryType.LINE:return a.from(n);case w.WGLGeometryType.MARKER:return e.from(n);case w.WGLGeometryType.TEXT:return b.from(n);case w.WGLGeometryType.LABEL:return l.from(n);default:throw Error(`Unable to createMaterialKey for unknown geometryType ${q}`);
}};u.hasOutlineFillSymbology=function(q){return x(q.symbologyType)};u.hasSimpleSymbology=function(q){return y(q.symbologyType)};u.hydrateMaterialKey=function(q){switch(h.load(q).geometryType){case w.WGLGeometryType.MARKER:return new e(q);case w.WGLGeometryType.FILL:return new g(q);case w.WGLGeometryType.LINE:return new a(q);case w.WGLGeometryType.TEXT:return new b(q);case w.WGLGeometryType.LABEL:return new l(q)}};u.isOutlineFillSymbology=x;u.isSimpleSymbology=y;Object.defineProperty(u,Symbol.toStringTag,
{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/segmentUtils":function(){define(["exports","../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/maybe","./util"],function(u,t,H,C){function w(c){return c.length-1}function y(c){let d=0;for(let f=0;f<w(c);f++)d+=x(c,f);return d}function x(c,d,f=1){const [k,g]=c[d+1];return Math.sqrt(k*k+g*g)*f}function m(c,d,f,k,g){if(!(f<d)){var e=k.clone().seek(f/2);H.isNone(e)||(c(e.clone(),f,g),f=(f-d)/2,e=H.unwrap(e.seek(d/
2)),m(c,d,f,k,g+1),m(c,d,f,e,g+1))}}let h=function(){function c(f,k,g,e,a){this._segments=f;this._index=k;this._distance=g;this._xStart=e;this._yStart=a;this._done=!1}c.create=function(f){return new c(f,0,0,f[0][0],f[0][1])};var d=c.prototype;d.clone=function(){return new c(this._segments,this._index,this._distance,this.xStart,this.yStart)};d.equals=function(f){return this._index===f._index||f._index===this._index-1&&(0===this._distance||1===f._distance)||f._index===this._index+1&&(1===this._distance||
0===f._distance)};d.leq=function(f){return this._index<f._index||this._index===f._index&&this._distance<=f._distance};d.geq=function(f){return this._index>f._index||this._index===f._index&&this._distance>=f._distance};d.hasPrev=function(){return 0<=this._index-1};d.hasNext=function(){return this._index+1<w(this._segments)};d.next=function(){if(!this.hasNext())return null;this._xStart+=this.dx;this._yStart+=this.dy;this._distance=0;this._index+=1;return this};d.prev=function(){if(!this.hasPrev())return this._done=
!0,null;--this._index;this._xStart-=this.dx;this._yStart-=this.dy;this._distance=1;return this};d._seekBackwards=function(f,k){var g=this.backwardLength;if(f<=g)return this._distance=(g-f)/this.length,this;for(g=this.backwardLength;this.prev();){if(g+this.length>f)return this._seekBackwards(f-g);g+=this.length}this._distance=0;return k?this:null};d.seek=function(f,k=!1){if(0>f)return this._seekBackwards(Math.abs(f),k);if(f<=this.remainingLength)return this._distance=(this.backwardLength+f)/this.length,
this;let g=this.remainingLength;for(;this.next();){if(g+this.length>f)return this.seek(f-g,k);g+=this.length}this._distance=1;return k?this:null};t._createClass(c,[{key:"_segment",get:function(){return this._segments[this._index+1]}},{key:"angle",get:function(){const f=this.dy;let k=Math.acos((0*f+-1*-this.dx)/(1*this.length));0<f&&(k=2*Math.PI-k);return k}},{key:"xStart",get:function(){return this._xStart}},{key:"yStart",get:function(){return this._yStart}},{key:"x",get:function(){return this.xStart+
this.distance*this.dx}},{key:"y",get:function(){return this.yStart+this.distance*this.dy}},{key:"dx",get:function(){return this._segment[0]}},{key:"dy",get:function(){return this._segment[1]}},{key:"xMidpoint",get:function(){return this.xStart+.5*this.dx}},{key:"yMidpoint",get:function(){return this.yStart+.5*this.dy}},{key:"xEnd",get:function(){return this.xStart+this.dx}},{key:"yEnd",get:function(){return this.yStart+this.dy}},{key:"length",get:function(){const {dx:f,dy:k}=this;return Math.sqrt(f*
f+k*k)}},{key:"remainingLength",get:function(){return this.length*(1-this._distance)}},{key:"backwardLength",get:function(){return this.length*this._distance}},{key:"distance",get:function(){return this._distance}},{key:"done",get:function(){return this._done}}]);return c}();u.SegmentCursor=h;u.pathDivide=function(c,d,f,k=!0){const g=y(c);c=h.create(c);const e=g/2;if(k){k=Math.floor(Math.max((g-d)/2,0)/d);c.seek(e-k*d);for(let a=-k;a<=k;a++)512>c.x&&0<=c.x&&512>c.y&&0<=c.y&&f(c.clone(),a,e+a*d,g),
c.seek(d)}else c.seek(e),f(c.clone(),0,e+0*d,g)};u.pathLength=y;u.pathSubdivide=function(c,d,f){m(f,d,y(c),h.create(c),0)};u.segmentAt=function(c,d){return c[d+1]};u.segmentCount=w;u.segmentLength=x;u.smoothPaths=function(c,d){for(let J=0;J<c.length;J++){var f=c[J];const K=[];K.push(f[0]);for(var k=1;k<f.length;k++){let [F,A]=K[k-1];F+=f[k][0];A+=f[k][1];K.push([F,A])}a:{f=K;k=d;if(0>=k)break a;const F=f.length;if(3>F)break a;const A=[];var g=0;A.push(0);for(var e=1;e<F;e++)g+=C.dist(f[e],f[e-1]),
A.push(g);k=Math.min(k,.2*g);g=[];g.push(f[0][0]);g.push(f[0][1]);e=f[F-1][0];const I=f[F-1][1];var a=C.sub([0,0],f[0],f[1]);C.normalize(a);f[0][0]+=k*a[0];f[0][1]+=k*a[1];C.sub(a,f[F-1],f[F-2]);C.normalize(a);f[F-1][0]+=k*a[0];f[F-1][1]+=k*a[1];for(a=1;a<F;a++)A[a]+=k;A[F-1]+=k;a=.5*k;for(let G=1;G<F-1;G++){let E=0,M=0,T=0;for(var b=G-1;0<=b&&!(A[b+1]<A[G]-a);b--){var l=a+A[b+1]-A[G],q=A[b+1]-A[b],n=A[G]-A[b]<a?1:l/q;if(1E-6>Math.abs(n))break;var v=n*n,B=n*l-.5*v*q,z=n*q/k,p=f[b+1],r=f[b][0]-p[0],
D=f[b][1]-p[1];E+=z/B*(p[0]*n*l+.5*v*(l*r-q*p[0])-v*n*q*r/3);M+=z/B*(p[1]*n*l+.5*v*(l*D-q*p[1])-v*n*q*D/3);T+=z}for(b=G+1;b<F&&!(A[b-1]>A[G]+a);b++){l=a-A[b-1]+A[G];q=A[b]-A[b-1];n=A[b]-A[G]<a?1:l/q;if(1E-6>Math.abs(n))break;v=n*n;B=n*l-.5*v*q;z=n*q/k;p=f[b-1];r=f[b][0]-p[0];D=f[b][1]-p[1];E+=z/B*(p[0]*n*l+.5*v*(l*r-q*p[0])-v*n*q*r/3);M+=z/B*(p[1]*n*l+.5*v*(l*D-q*p[1])-v*n*q*D/3);T+=z}g.push(E/T);g.push(M/T)}g.push(e);g.push(I);for(let G=0,E=0;G<F;G++)f[G][0]=g[E++],f[G][1]=g[E++]}f=[];f.push(K[0]);
for(k=1;k<K.length;k++){const [F,A]=K[k-1],[I,G]=K[k];f.push([Math.round(I-F),Math.round(G-A)])}c[J]=f}return c};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/util":function(){define(["exports"],function(u){function t(H,C){return Math.sqrt(H*H+C*C)}u.DEFAULT_MAX_ZOOM=100;u.DEFAULT_MIN_ZOOM=0;u.dist=function(H,C){return t(H[0]-C[0],H[1]-C[1])};u.getLimitCosine=function(H=2){return 1/Math.max(H,1)};u.getMinMaxZoom=function(H,C){const w=!!H?.minScale&&
C.scaleToZoom(H.minScale)||0;H=!!H?.maxScale&&C.scaleToZoom(H.maxScale)||100;return[w,H]};u.isExtent=function(H){return void 0!==H.xmin&&void 0!==H.ymin&&void 0!==H.xmax&&void 0!==H.ymax};u.isFunction=function(H){return"function"===typeof H};u.isMultipoint=function(H){return void 0!==H.points};u.isPoint=function(H){return void 0!==H.x&&void 0!==H.y};u.isPolygon=function(H){return void 0!==H.rings};u.isPolyline=function(H){return void 0!==H.paths};u.len=t;u.normalize=function(H){const C=t(H[0],H[1]);
H[0]/=C;H[1]/=C};u.sub=function(H,C,w){H[0]=C[0]-w[0];H[1]=C[1]-w[1];return H};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/WGLTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/BidiText ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../alignmentUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLMeshTemplate".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f){return function(k){function g(e,a,b,l,q,n,v,B,z,p,r,D,J,K,F,A,I,G,E,M,T,Y,fa,ba){var U=k.call(this)||this;U._xOffset=H.pt2px(J);U._yOffset=H.pt2px(K);U._decoration=p||"none";U._backgroundColor=Y;U._borderLineColor=fa;U._borderLineSize=ba;U._color=q;U._haloColor=n;U._haloSize=Math.min(Math.floor(5*H.pt2px(H.toPt(b))),127);U._size=Math.min(Math.round(H.pt2px(a)),127);a=Math.min(Math.round(H.pt2px(l||a)),127);U._referenceSize=Math.round(Math.sqrt(256*a));U._scale=U._size/
x.GLYPH_SIZE;U._angle=D;U._justify=w.getJustification(v||"center");U._xAlignD=w.getXAnchorDirection(v||"center");U._yAlignD=w.getYAnchorDirection(B||"baseline");U._baseline="baseline"===(B||"baseline");U._bitset=(z===C.Alignment.MAP?1:0)|(r?1:0)<<1;e=h.MaterialKeyBase.load(e);e.sdf=!0;U._materialKey=e.data;U._lineWidth=H.pt2px(F)||512;U._lineHeight=A||1;U._textPlacement=I;U._effects=G;U._isCIM=E??!1;U._minMaxZoom=m.i1616to32(Math.round(M*x.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(T*x.MIN_MAX_ZOOM_PRECISION_FACTOR));
return U}u._inheritsLoose(g,k);g.fromText=function(e,a){const b=e.font?.size,l=new g(e.materialKey,b,e.haloSize||0,b,e.color&&y.premultiplyAlphaRGBAArray(e.color)||0,e.haloColor&&y.premultiplyAlphaRGBAArray(e.haloColor)||0,e.horizontalAlignment,e.verticalAlignment,C.Alignment.SCREEN,e.font?.decoration,!1,e.angle||0,e.xoffset||0,e.yoffset||0,e.lineWidth||0,e.lineHeight||0,null,null,!1,c.DEFAULT_MIN_ZOOM,c.DEFAULT_MAX_ZOOM,e.backgroundColor&&y.premultiplyAlphaRGBAArray(e.backgroundColor),e.borderLineColor&&
y.premultiplyAlphaRGBAArray(e.borderLineColor),e.borderLineSize),[,q]=t.bidiText(e.text);l.bindTextInfo(a??[],q);l._vertexBoundsScale=e.maxVVSize&&b?e.maxVVSize/b:1;return l};g.fromCIMText=function(e,a,b){var l=e.scaleFactor||1;const q=e.size*e.sizeRatio*l,[n,v]=c.getMinMaxZoom(e.scaleInfo,b);b=new g(e.materialKey,q,e.outlineSize*e.sizeRatio,e.referenceSize,y.premultiplyAlphaRGBA(e.color),y.premultiplyAlphaRGBA(e.outlineColor),e.horizontalAlignment,e.verticalAlignment,e.alignment,e.decoration,e.colorLocked??
!1,e.angle,e.offsetX*e.sizeRatio*l,e.offsetY*e.sizeRatio*l,512,1,e.markerPlacement,e.effects,!0,n,v,e.backgroundColor?y.premultiplyAlphaRGBA(e.backgroundColor):void 0,e.borderLineColor?y.premultiplyAlphaRGBA(e.borderLineColor):void 0,e.borderLineWidth);[,l]=t.bidiText(e.text);b.bindTextInfo(a,l);b._vertexBoundsScale=e.maxVVSize?e.maxVVSize/q:1;return b};return g}(d(f))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../layers/graphics/featureConversionUtils ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./shapingUtils".split(" "),
function(u,t,H,C,w,y,x,m,h,c){const d=m.i1616to32(4,4),f=m.i1616to32(4,2),k=m.i1616to32(4,6),g=[f,f,k,k],e=[f,k,f,k],a=[k,k,d,d],b=[d,d,k,k],l=[k,d,k,d],q=[d,k,d,k];return n=>function(v){function B(...p){p=v.call(this,...p)||this;p._isCIM=!1;p._vertexBoundsScale=1;p.geometryType=x.WGLGeometryType.TEXT;p._aux=m.i8888to32(0,0,p._referenceSize,p._bitset);return p}u._inheritsLoose(B,v);var z=B.prototype;z.bindTextInfo=function(p,r){this._shapingInfo=p&&p.length?t.applySome(p,D=>c.shapeGlyphs(D,r,{scale:this._scale,
angle:this._angle,xOffset:this._xOffset,yOffset:this._yOffset,hAlign:this._xAlignD,vAlign:this._yAlignD,maxLineWidth:Math.max(32,Math.min(this._lineWidth,512)),lineHeight:y.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(this._lineHeight,4)),decoration:this._decoration,isCIM:this._isCIM,hasBackground:!!this._backgroundColor,borderLineSize:this._borderLineSize})):null};z._write=function(p,r,D,J){const K=r.getDisplayId();this._writeGeometry(p,r,K,D,J)};z._writeGeometry=function(p,r,D,J,K){const F=this._shapingInfo;
if(!t.isNone(F)){if(t.isSome(this._textPlacement))return r=K??r.readLegacyGeometryForDisplay(),this._writePlacedText(p,D,r,F,J);J=K?C.deltaDecodeGeometry(C.convertFromGeometry(K),2):"esriGeometryPolygon"===r.geometryType?r.readCentroid():r.readGeometryForDisplay();if(!t.isNone(J)){if(J.isPoint){const [A,I]=J.coords;return!p.hasAggregates&&p.hasPixelBufferEnabled&&(0>A||512<=A||0>I||512<=I)?void 0:this._writeGlyphs(p,D,{x:A,y:I},F)}J.forEachVertex((A,I)=>this._writeGlyphs(p,D,{x:A,y:I},F))}}};z._writePlacedText=
function(p,r,D,J,K){var F=t.unwrap(this._textPlacement);if(D=w.CIMMarkerPlacementHelper.getPlacement(D,F,H.pt2px(1),p.tileKey,K.geometryEngine))for(var A=D.next();null!=A;)K=-A.getAngle(),J.setRotation(K),F=A.tx,A=-A.ty,0>F||512<=F||0>A||512<=A||(this._writeGlyphs(p,r,{x:F,y:A},J),J.setRotation(-K)),A=D.next()};z._writeGlyphs=function(p,r,D,J){const K=h.MaterialKeyBase.load(this._materialKey),F=m.i1616to32(Math.round(8*D.x),Math.round(8*D.y)),A=this._vertexBoundsScale,{bounds:I,background:G,glyphs:E}=
J;0<E.length&&(this._borderLineColor||this._backgroundColor)&&(K.textureBinding=E[0].textureBinding,p.recordStart(r,K.data,this.geometryType,!0),this._writeBackgroundGeometry(p,r,D,I,G),p.recordEnd());const M=2*Math.max(I.width,I.height);for(const T of J.glyphs)K.textureBinding=T.textureBinding,p.recordStart(r,K.data,this.geometryType,!0),p.vertexBounds(D.x+I.x+this._xOffset,D.y+I.y-this._yOffset,M*A,M*A),this._writeVertices(p,r,F,T),p.recordEnd()};z._writeGlyph=function(p,r,D,J,K){var F=h.MaterialKeyBase.load(this._materialKey);
const A=m.i1616to32(Math.round(8*D),Math.round(8*J));F.textureBinding=K.textureBinding;p.recordStart(r,F.data,this.geometryType,!0);F=K.bounds;const I=this._vertexBoundsScale;p.vertexBounds(D+F.x*I,J+F.y*I,F.width*I,F.height*I);this._writeVertices(p,r,A,K);p.recordEnd()};z._writeVertices=function(p,r,D,J){const K=p.vertexCount();this._writeVertexCommon(p,r,D,J);p.vertexWrite(J.offsets.upperLeft);p.vertexWrite(J.texcoords.upperLeft);p.vertexEnd();this._writeVertexCommon(p,r,D,J);p.vertexWrite(J.offsets.upperRight);
p.vertexWrite(J.texcoords.upperRight);p.vertexEnd();this._writeVertexCommon(p,r,D,J);p.vertexWrite(J.offsets.lowerLeft);p.vertexWrite(J.texcoords.lowerLeft);p.vertexEnd();this._writeVertexCommon(p,r,D,J);p.vertexWrite(J.offsets.lowerRight);p.vertexWrite(J.texcoords.lowerRight);p.vertexEnd();p.indexWrite(K+0);p.indexWrite(K+1);p.indexWrite(K+2);p.indexWrite(K+1);p.indexWrite(K+3);p.indexWrite(K+2)};z._writeVertexCommon=function(p,r,D,J){J=this._color;const K=this._haloColor,F=m.i8888to32(0,0,this._referenceSize,
this._bitset),A=m.i8888to32(0,0,this._size,this._haloSize);p.vertexWrite(D);p.vertexWrite(r);p.vertexWrite(J);p.vertexWrite(K);p.vertexWrite(A);p.vertexWrite(F);p.vertexWrite(this._minMaxZoom)};z._writeBackgroundVertex=function(p,r,D,J,K,F){const A=m.i8888to32(0,1,this._referenceSize,this._bitset),I=m.i8888to32(0,0,this._size,this._haloSize),G=m.i8888to32(0,0,0,0);p.vertexWrite(D);p.vertexWrite(r);p.vertexWrite(J);p.vertexWrite(G);p.vertexWrite(I);p.vertexWrite(A);p.vertexWrite(this._minMaxZoom);
p.vertexWrite(K);p.vertexWrite(F);p.vertexEnd()};z._writeBackgroundQuad=function(p,r,D,J,K,F){const A=p.vertexCount();this._writeBackgroundVertex(p,r,D,J,K.upperLeft,F[0]);this._writeBackgroundVertex(p,r,D,J,K.upperRight,F[1]);this._writeBackgroundVertex(p,r,D,J,K.lowerLeft,F[2]);this._writeBackgroundVertex(p,r,D,J,K.lowerRight,F[3]);p.indexWrite(A+0);p.indexWrite(A+1);p.indexWrite(A+2);p.indexWrite(A+1);p.indexWrite(A+3);p.indexWrite(A+2)};z._writeBackgroundGeometry=function(p,r,D,J,K){const F=m.i1616to32(Math.round(8*
D.x),Math.round(8*D.y)),{x:A,y:I,width:G,height:E}=J;J=2*Math.max(G,E);p.vertexBounds(D.x+A+this._xOffset,D.y+I-this._yOffset,J*this._vertexBoundsScale,J*this._vertexBoundsScale);this._backgroundColor&&this._writeBackgroundQuad(p,r,F,this._backgroundColor,K.main,[d,d,d,d]);if(this._borderLineColor||this._backgroundColor){const [M,T,Y,fa,ba]=this._borderLineColor&&this._borderLineSize&&0<this._borderLineSize?[g,g,e,e,this._borderLineColor]:[a,b,l,q,this._backgroundColor];this._writeBackgroundQuad(p,
r,F,ba,K.top,M);this._writeBackgroundQuad(p,r,F,ba,K.bot,T);this._writeBackgroundQuad(p,r,F,ba,K.left,Y);this._writeBackgroundQuad(p,r,F,ba,K.right,fa)}};return B}(n)})},"esri/symbols/cim/placements/CIMMarkerPlacementHelper":function(){define(["exports","../CIMCursor","../CIMOperators"],function(u,t,H){let C=function(){function w(){}w.getPlacement=function(y,x,m,h,c){const d=H.getPlacementOperator(x);if(!d)return null;y=t.cloneAndDecodeGeometry(y);return d.execute(y,x,m,h,c)};return w}();u.CIMMarkerPlacementHelper=
C;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/CIMCursor":function(){define(["exports","../../core/lang","../../geometry/support/jsonUtils","./CIMPlacements"],function(u,t,H,C){function w(b){b&&(H.isPoint(b)?b.y=-b.y:H.isPolygon(b)?x(b.rings):H.isPolyline(b)?x(b.paths):H.isMultipoint(b)&&y(b.points))}function y(b){if(b){const l=b.length;for(let q=0;q<l;q++)b[q][1]=-b[q][1]}}function x(b){if(b)for(const l of b)y(l)}function m(b){if(b){var l=b.length;for(--l;0<l;--l)b[l][0]-=
b[l-1][0],b[l][1]-=b[l-1][1]}}function h(b){if(b)for(const l of b)m(l)}function c(b){if(b){const l=b.length;for(let q=1;q<l;++q)b[q][0]+=b[q-1][0],b[q][1]+=b[q-1][1]}}function d(b){if(b)for(const l of b)c(l)}function f(b){b&&(H.isPolygon(b)?d(b.rings):H.isPolyline(b)?d(b.paths):H.isMultipoint(b)&&c(b.points),w(b))}function k(b){b&&b.reverse()}function g(b){return{rings:[[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]]]}}let e=function(){function b(l,q,n,v=0){this.isClosed=
!1;this.multiPath=null;this.acceptPolygon=q;this.acceptPolyline=n;this.geomUnitsPerPoint=v;this.pathIndex=this.pathCount=-1;this.iteratePath=!1;l&&(H.isPolygon(l)?q&&(this.multiPath=l.rings,this.isClosed=!0):H.isPolyline(l)?n&&(this.multiPath=l.paths,this.isClosed=!1):H.isExtent(l)&&q&&(this.multiPath=g(l).rings,this.isClosed=!0),this.multiPath&&(this.pathCount=this.multiPath.length));this.internalPlacement=new C.Placement}b.prototype.next=function(){if(!this.multiPath)return null;for(;this.iteratePath||
this.pathIndex<this.pathCount-1;){this.iteratePath||this.pathIndex++;const l=this.processPath(this.multiPath[this.pathIndex]);if(l)return l}this.pathIndex=this.pathCount=-1;return this.multiPath=null};return b}(),a=function(){function b(l,q,n,v=0){this.isClosed=!1;this.multiPath=null;this.inputGeometries=l;this.acceptPolygon=q;this.acceptPolyline=n;this.geomUnitsPerPoint=v;this.pathIndex=this.pathCount=-1;this.iteratePath=!1}b.prototype.next=function(){for(;;){if(!this.multiPath){for(var l=this.inputGeometries.next();l;)if(H.isPolygon(l)?
this.acceptPolygon&&(this.multiPath=l.rings,this.isClosed=!0):H.isPolyline(l)?this.acceptPolyline&&(this.multiPath=l.paths,this.isClosed=!1):H.isExtent(l)&&this.acceptPolygon&&(this.multiPath=g(l).rings,this.isClosed=!0),this.multiPath){this.pathCount=this.multiPath.length;this.pathIndex=-1;break}else l=this.inputGeometries.next();if(!this.multiPath)return null}for(;this.iteratePath||this.pathIndex<this.pathCount-1;)if(this.iteratePath||this.pathIndex++,l=this.processPath(this.multiPath[this.pathIndex]))return l;
this.pathIndex=this.pathCount=-1;this.multiPath=null}};return b}();u.PathGeometryCursor=a;u.PathTransformationCursor=e;u.cloneAndDecodeGeometry=function(b){b=t.clone(b);f(b);return b};u.deltaDecodeGeometry=f;u.deltaEncodeGeometry=function(b){b&&(w(b),H.isPolygon(b)?h(b.rings):H.isPolyline(b)?h(b.paths):H.isMultipoint(b)&&m(b.points))};u.getCoord2D=function(b,l,q){return[b[0]+(l[0]-b[0])*q,b[1]+(l[1]-b[1])*q]};u.getId=function(b){return b[4]};u.isClosedPath=function(b){return b&&0!==b.length?b[0][0]===
b[b.length-1][0]&&b[0][1]===b[b.length-1][1]:!1};u.reverseMultipath=function(b){if(b)for(const l of b)k(l)};u.reversePath=k;u.setId=function(b,l){b[4]=l};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/CIMPlacements":function(){define(["exports"],function(u){let t=function(){function C(){this.setIdentity()}var w=C.prototype;w.getAngle=function(){if(null==this.rz||0===this.rz&&1!==this.rzCos&&0!==this.rzSin)this.rz=Math.atan2(this.rzSin,this.rzCos);return this.rz};
w.setIdentity=function(){this.tz=this.ty=this.tx=0;this.s=1;this.rz=this.ry=this.rx=0;this.rzCos=1;this.rzSin=0};w.setTranslate=function(y,x){this.tx=y;this.ty=x};w.setTranslateZ=function(y){this.tz=y};w.setRotateCS=function(y,x){this.rz=void 0;this.rzCos=y;this.rzSin=x};w.setRotate=function(y){this.rz=y;this.rzSin=this.rzCos=void 0};w.setRotateY=function(y){this.ry=y};w.setScale=function(y){this.s=y};w.setMeasure=function(y){this.m=y};return C}(),H=function(){function C(){}C.prototype.next=function(){return null};
return C}();u.EmptyPlacementCursor=H;u.Placement=t;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/CIMOperators":function(){define("exports ./effects/EffectAddControlPoints ./effects/EffectArrow ./effects/EffectBuffer ./effects/EffectControlMeasureLine ./effects/EffectCut ./effects/EffectDashes ./effects/EffectDonut ./effects/EffectJog ./effects/EffectMove ./effects/EffectOffset ./effects/EffectReverse ./effects/EffectRotate ./effects/EffectScale ./effects/EffectWave ./placements/PlacementAlongLineSameSize ./placements/PlacementAtExtremities ./placements/PlacementAtRatioPositions ./placements/PlacementInsidePolygon ./placements/PlacementOnLine ./placements/PlacementOnVertices ./placements/PlacementPolygonCenter".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f,k,g,e,a,b,l,q,n,v,B){u.getEffectOperator=function(z){if(!z)return null;switch(z.type){case "CIMGeometricEffectAddControlPoints":return t.EffectAddControlPoints.local();case "CIMGeometricEffectArrow":return H.EffectArrow.local();case "CIMGeometricEffectBuffer":return C.EffectBuffer.local();case "CIMGeometricEffectControlMeasureLine":return w.EffectControlMeasureLine.local();case "CIMGeometricEffectCut":return y.EffectCut.local();case "CIMGeometricEffectDashes":return x.EffectDashes.local();
case "CIMGeometricEffectDonut":return m.EffectDonut.local();case "CIMGeometricEffectJog":return h.EffectJog.local();case "CIMGeometricEffectMove":return c.EffectMove.local();case "CIMGeometricEffectOffset":return d.EffectOffset.local();case "CIMGeometricEffectReverse":return f.EffectReverse.local();case "CIMGeometricEffectRotate":return k.EffectRotate.local();case "CIMGeometricEffectScale":return g.EffectScale.local();case "CIMGeometricEffectWave":return e.EffectWave.local()}return null};u.getPlacementOperator=
function(z){if(!z)return null;switch(z.type){case "CIMMarkerPlacementAlongLineSameSize":return a.PlacementAlongLineSameSize.local();case "CIMMarkerPlacementAtExtremities":return b.PlacementAtExtremities.local();case "CIMMarkerPlacementAtRatioPositions":return l.PlacementAtRatioPositions.local();case "CIMMarkerPlacementInsidePolygon":return q.PlacementInsidePolygon.local();case "CIMMarkerPlacementOnLine":return n.PlacementOnLine.local();case "CIMMarkerPlacementOnVertices":return v.PlacementOnVertices.local();
case "CIMMarkerPlacementPolygonCenter":return B.PlacementPolygonCenter.local()}return null};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectAddControlPoints":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(u,t,H,C){let w=function(){function x(){}x.local=function(){null===x.instance&&(x.instance=new x);return x.instance};x.prototype.execute=function(m,h,c,d,f){return new y(m,h,c)};return x}();
w.instance=null;let y=function(){function x(h,c,d){this._inputGeometries=h;this._angleTolerance=void 0!==c.angleTolerance?c.angleTolerance:120;this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI)}var m=x.prototype;m.next=function(){for(var h=this._inputGeometries.next();h;){if(H.isPolygon(h))return this._isClosed=!0,h=t.clone(h),this._processMultipath(h.rings),h;if(H.isPolyline(h))return this._isClosed=!1,h=t.clone(h),this._processMultipath(h.paths),h;if(H.isExtent(h)){if(this._maxCosAngle)return h;
this._isClosed=!0;h=[[h.xmin,h.ymin],[h.xmin,h.ymax],[h.xmax,h.ymax],[h.xmax,h.ymin],[h.xmin,h.ymin]];this._processPath(h);return{rings:[h]}}h=this._inputGeometries.next()}return null};m._processMultipath=function(h){if(h)for(const c of h)this._processPath(c)};m._processPath=function(h){if(h){let c=h.length,d=h[0],f,k,g,e,a,b;this._isClosed&&++c;for(let l=1;l<c;++l){let q;q=this._isClosed&&l===c-1?h[0]:h[l];const n=q[0]-d[0],v=q[1]-d[1],B=Math.sqrt(n*n+v*v);1<l&&0<B&&0<g&&(f*n+k*v)/B/g<=this._maxCosAngle&&
C.setId(d,1);1===l&&(e=n,a=v,b=B);0<B&&(d=q,f=n,k=v,g=B)}this._isClosed&&0<g&&0<b&&(f*e+k*a)/b/g<=this._maxCosAngle&&C.setId(h[0],1)}};return x}();u.EffectAddControlPoints=w;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectArrow":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper","../enums"],function(u,t,H,C,w){const y=w.GeometricEffectArrowType.OpenEnded;let x=function(){function h(){}h.local=function(){null===
h.instance&&(h.instance=new h);return h.instance};h.prototype.execute=function(c,d,f,k,g){return new m(c,d,f)};return h}();x.instance=null;let m=function(h){function c(f,k,g){f=h.call(this,f,!1,!0)||this;f._curveHelper=new C.CurveHelper;f._width=(void 0!==k.width?k.width:5)*g;f._arrowType=void 0!==k.geometricEffectArrowType?k.geometricEffectArrowType:void 0!==k.arrowType?k.arrowType:y;f._offsetFlattenError=C.PIXEL_TOLERANCE*g;return f}t._inheritsLoose(c,h);var d=c.prototype;d.processPath=function(f){switch(this._arrowType){default:return this._constructSimpleArrow(f,
!0);case w.GeometricEffectArrowType.Block:return this._constructSimpleArrow(f,!1);case w.GeometricEffectArrowType.Crossed:return this._constructCrossedArrow(f)}};d._constructSimpleArrow=function(f,k){var g=this._curveHelper.calculatePathLength(f),e=this._width;g<2*e&&(e=g/2);g=this._curveHelper.getSubCurve(f,0,g-e);if(!g)return null;var a=e/2;if(this._curveHelper.isEmpty(g,!1))return null;e=this._constructOffset(g,-a);if(!e)return null;g=this._constructOffset(g,a);if(!g)return null;const b=this._constructArrowBasePoint(e,
-a/2);if(!b)return null;a=this._constructArrowBasePoint(g,a/2);if(!a)return null;f=f[f.length-1];k||(this._makeControlPoint(g,!0),this._makeControlPoint(e,!0));const l=new C.PathHelper;l.addPath(g,!0);l.lineTo(a);this._makeControlPoint(l.path());l.lineTo(f);this._makeControlPoint(l.path());l.lineTo(b);this._makeControlPoint(l.path());l.addPath(e,!1);return k?{paths:[l.path()]}:(l.close(),{rings:[l.path()]})};d._constructCrossedArrow=function(f){var k=this._curveHelper.calculatePathLength(f),g=this._width;
k<3.732050807568877*g&&(g=k/3.732050807568877);var e=this._curveHelper.getSubCurve(f,0,k-2.732050807568877*g);if(!e)return null;var a=g/2;if(this._curveHelper.isEmpty(e,!1))return null;const b=this._constructOffset(e,a);if(!b)return null;e=this._constructOffset(e,-a);if(!e)return null;k=this._curveHelper.getSubCurve(f,0,k-g);if(!k||this._curveHelper.isEmpty(k,!1))return null;g=this._constructOffset(k,a);if(!g)return null;var l=this._constructOffset(k,-a);if(!l)return null;k=g[g.length-1];g=this._constructArrowBasePoint(g,
a/2);if(!g)return null;const q=l[l.length-1];a=this._constructArrowBasePoint(l,-a/2);if(!a)return null;f=f[f.length-1];this._makeControlPoint(b,!1);this._makeControlPoint(e,!1);l=new C.PathHelper;l.addPath(b,!0);this._makeControlPoint(l.path());l.lineTo(q);l.lineTo(a);this._makeControlPoint(l.path());l.lineTo(f);this._makeControlPoint(l.path());l.lineTo(g);this._makeControlPoint(l.path());l.lineTo(k);this._makeControlPoint(l.path());l.addPath(e,!1);return{paths:[l.path()]}};d._constructOffset=function(f,
k){return this._curveHelper.offset(f,k,w.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError)};d._constructArrowBasePoint=function(f,k){if(!f||2>f.length)return null;var g=f[f.length-2];f=f[f.length-1];g=[f[0]-g[0],f[1]-g[1]];this._curveHelper.normalize(g);return[f[0]+g[1]*k,f[1]-g[0]*k]};d._makeControlPoint=function(f,k=!1){k?H.setId(f[0],1):H.setId(f[f.length-1],1)};return c}(H.PathGeometryCursor);u.EffectArrow=x;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/CurveHelper":function(){define(["exports",
"./enums"],function(u,t){let H=function(){function w(){this._path=[]}var y=w.prototype;y.path=function(){return this._path};y.addPath=function(x,m){m||x.reverse();Array.prototype.push.apply(this._path,x);m||x.reverse()};w.mergePath=function(x,m){m&&Array.prototype.push.apply(x,m)};y.startPath=function(x){this._path.push(x)};y.lineTo=function(x){this._path.push(x)};y.close=function(){const x=this._path;1<x.length&&(x[0][0]!==x[x.length-1][0]||x[0][1]!==x[x.length-1][1])&&x.push([x[0][0],x[0][1]])};
return w}(),C=function(){function w(x,m){}var y=w.prototype;y.normalize=function(x){const m=Math.sqrt(x[0]*x[0]+x[1]*x[1]);0!==m&&(x[0]/=m,x[1]/=m)};y.calculateLength=function(x,m){const h=m[0]-x[0];x=m[1]-x[1];return Math.sqrt(h*h+x*x)};y.calculateSegLength=function(x,m){return this.calculateLength(x[m],x[m+1])};y.calculatePathLength=function(x){let m=0;const h=x?x.length:0;for(let c=0;c<h-1;++c)m+=this.calculateSegLength(x,c);return m};y.calculatePathArea=function(x){let m=0;const h=x?x.length:
0;for(let c=0;c<h-1;++c)m+=(x[c+1][0]-x[c][0])*(x[c+1][1]+x[c][1]);return m/2};y.getCoord2D=function(x,m,h){return[x[0]+(m[0]-x[0])*h,x[1]+(m[1]-x[1])*h]};y.getSegCoord2D=function(x,m,h){return this.getCoord2D(x[m],x[m+1],h)};y.getAngle=function(x,m,h){return Math.atan2(m[1]-x[1],m[0]-x[0])};y.getSegAngle=function(x,m,h){return this.getAngle(x[m],x[m+1],h)};y.getAngleCS=function(x,m,h){h=m[0]-x[0];x=m[1]-x[1];m=Math.sqrt(h*h+x*x);return 0<m?[h/m,x/m]:[1,0]};y.getSegAngleCS=function(x,m,h){return this.getAngleCS(x[m],
x[m+1],h)};y.cut=function(x,m,h,c){h=0>=h?x[m]:this.getSegCoord2D(x,m,h);x=1<=c?x[m+1]:this.getSegCoord2D(x,m,c);return[h,x]};y.addSegment=function(x,m,h){h&&x.push(m[0]);x.push(m[1])};y.getSubCurve=function(x,m,h){const c=[];return this.appendSubCurve(c,x,m,h)?c:null};y.appendSubCurve=function(x,m,h,c){const d=m?m.length-1:0;let f=0,k=!0,g=0;for(;g<d;){const a=this.calculateSegLength(m,g);if(0!==a){if(k){if(f+a>h){var e=(h-f)/a;let b=1,l=!1;f+a>=c&&(b=(c-f)/a,l=!0);(e=this.cut(m,g,e,b))&&this.addSegment(x,
e,k);if(l)break;k=!1}}else{if(f+a>c){(m=this.cut(m,g,0,(c-f)/a))&&this.addSegment(x,m,k);break}this.addSegment(x,[m[g],m[g+1]],k)}f+=a}++g}return!0};y.getCIMPointAlong=function(x,m){const h=x?x.length-1:0;let c=0,d=-1;for(;d<h;){++d;const f=this.calculateSegLength(x,d);if(0!==f){if(c+f>m)return this.getCoord2D(x[d],x[d+1],(m-c)/f);c+=f}}return null};y.isEmpty=function(x,m){if(!x||1>=x.length)return!0;const h=x?x.length-1:0;let c=-1;for(;c<h;)if(++c,x[c+1][0]!==x[c][0]||x[c+1][1]!==x[c][1]||m&&x[c+
1][2]!==x[c][2])return!1;return!0};y.offset=function(x,m,h,c,d){if(!x||2>x.length)return null;var f=0,k=x[f++];for(d=f;f<x.length;){var g=x[f];if(g[0]!==k[0]||g[1]!==k[1])f!==d&&(x[d]=x[f]),k=x[d++];f++}(f=x[0][0]===x[d-1][0]&&x[0][1]===x[d-1][1])&&--d;if(d<(f?3:2))return null;g=[];k=f?x[d-1]:null;let e=x[0];for(let n=0;n<d;n++){const v=n===d-1?f?x[0]:null:x[n+1];if(k)if(v){var a=[v[0]-e[0],v[1]-e[1]];this.normalize(a);var b=[e[0]-k[0],e[1]-k[1]];this.normalize(b);var l=b[0]*a[1]-b[1]*a[0],q=b[0]*
a[0]+b[1]*a[1];if(0===l&&1===q){e=v;continue}if(0<=l===0>=m)1>q&&(a=[a[0]-b[0],a[1]-b[1]],this.normalize(a),b=Math.sqrt((1+q)/2),b>1/c&&(b=-Math.abs(m)/b,g.push([e[0]-a[0]*b,e[1]-a[1]*b])));else switch(h){case t.GeometricEffectOffsetMethod.Mitered:if(k=Math.sqrt((1+q)/2),0<k&&1/k<c){a=[a[0]-b[0],a[1]-b[1]];this.normalize(a);b=Math.abs(m)/k;g.push([e[0]-a[0]*b,e[1]-a[1]*b]);break}case t.GeometricEffectOffsetMethod.Bevelled:g.push([e[0]+b[1]*m,e[1]-b[0]*m]);g.push([e[0]+a[1]*m,e[1]-a[0]*m]);break;case t.GeometricEffectOffsetMethod.Rounded:if(1>
q){g.push([e[0]+b[1]*m,e[1]-b[0]*m]);k=Math.floor(2.5*(1-q));if(0<k){l=q=1/k;for(let B=1;B<k;B++,l+=q){const z=[b[1]*(1-l)+a[1]*l,-b[0]*(1-l)-a[0]*l];this.normalize(z);g.push([e[0]+z[0]*m,e[1]+z[1]*m])}}g.push([e[0]+a[1]*m,e[1]-a[0]*m])}break;default:0>l?(g.push([e[0]+(b[1]+b[0])*m,e[1]+(b[1]-b[0])*m]),g.push([e[0]+(a[1]-a[0])*m,e[1]-(a[0]+a[1])*m])):(k=Math.sqrt((1+Math.abs(q))/2),a=[a[0]-b[0],a[1]-b[1]],this.normalize(a),b=m/k,g.push([e[0]-a[0]*b,e[1]-a[1]*b]))}}else a=[e[0]-k[0],e[1]-k[1]],this.normalize(a),
g.push([e[0]+a[1]*m,e[1]-a[0]*m]);else a=[v[0]-e[0],v[1]-e[1]],this.normalize(a),g.push([e[0]+a[1]*m,e[1]-a[0]*m]);k=e;e=v}if(g.length<(f?3:2))return null;f&&g.push([g[0][0],g[0][1]]);return g};return w}();u.CurveHelper=C;u.PIXEL_TOLERANCE=.03;u.PathHelper=H;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectBuffer":function(){define("exports ../../../geometry ../../../core/maybe ../../../geometry/support/jsonUtils ../CIMEffects ../CurveHelper ../enums ../../../geometry/SpatialReference".split(" "),
function(u,t,H,C,w,y,x,m){t=function(){function c(){}c.local=function(){null===c.instance&&(c.instance=new c);return c.instance};c.prototype.execute=function(d,f,k,g,e){return new h(d,f,k,g,e)};return c}();t.instance=null;let h=function(){function c(d,f,k,g,e){this._inputGeometries=d;this._tileKey=g;this._geometryEngine=e;this._curveHelper=new y.CurveHelper;this._size=(void 0!==f.size?f.size:1)*k;this._offsetFlattenError=y.PIXEL_TOLERANCE*k}c.prototype.next=function(){let d;for(;d=this._inputGeometries.next();){if(0===
this._size)return d;if(C.isExtent(d))if(0<this._size){var f=this._curveHelper.offset([[d.xmin,d.ymin],[d.xmin,d.ymax],[d.xmax,d.ymax],[d.xmax,d.ymin],[d.xmin,d.ymin]],this._size,x.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError);if(f)return{rings:[f]}}else if(0>this._size&&0<Math.min(d.xmax-d.xmin,d.ymax-d.ymin)+2*this._size)return{xmin:d.xmin-this._size,xmax:d.xmax+this._size,ymin:d.ymin-this._size,ymax:d.ymax+this._size};f=this._geometryEngine;if(H.isNone(f))break;let k=d;if(C.isPolygon(d)&&
this._tileKey&&(k=w.clipPolygonToTileExtent(d,Math.abs(this._size)+1),!k||!k.rings||0===k.rings.length))continue;if(C.isPolyline(d)&&this._tileKey&&(k=w.clipPolylineToTileExtent(d,Math.abs(this._size)+1),!k||!k.paths||0===k.paths.length))continue;return f.buffer(m.WebMercator,k,this._size,1)}return null};return c}();u.EffectBuffer=t;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/CIMEffects":function(){define(["exports","../../core/lang","../../geometry/support/TileClipper"],
function(u,t,H){let C,w=function(){function y(x){this._geometry=x}y.prototype.next=function(){const x=this._geometry;this._geometry=null;return x};return y}();u.SimpleGeometryCursor=w;u.clipPolygonToTileExtent=function(y,x){C||(C=new H.TileClipper(0,0,0,1));C.reset(H.GeometryType.Polygon);C.setPixelMargin(x+1);C.setExtent(512);for(var m of y.rings)if(m&&!(3>m.length)){y=m[0][0];x=-m[0][1];C.moveTo(y,x);for(let h=1;h<m.length;h++)y=m[h][0],x=-m[h][1],C.lineTo(y,x);C.close()}if(y=C.result(!1)){m=[];
for(const h of y){y=[];m.push(y);for(const c of h)y.push([c.x,-c.y])}return{rings:m}}return{rings:[]}};u.clipPolylineToTileExtent=function(y,x){C||(C=new H.TileClipper(0,0,0,1));C.reset(H.GeometryType.LineString);C.setPixelMargin(x+1);C.setExtent(512);for(var m of y.paths)if(m&&!(2>m.length)){y=m[0][0];x=-m[0][1];C.moveTo(y,x);for(let h=1;h<m.length;h++)y=m[h][0],x=-m[h][1],C.lineTo(y,x)}if(y=C.result(!1)){m=[];for(const h of y){y=[];m.push(y);for(const c of h)y.push([c.x,-c.y])}return{paths:m}}return{paths:[]}};
u.clone=function(y){return t.clone(y)};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectControlMeasureLine":function(){define(["exports","../../../geometry/support/jsonUtils","../CIMCursor","../enums"],function(u,t,H,C){let w=function(){function x(){}x.local=function(){null===x.instance&&(x.instance=new x);return x.instance};x.prototype.execute=function(m,h,c,d,f){return new y(m,h,c)};return x}();w.instance=null;let y=function(){function x(h,c,d){this._defaultPointSize=
20;this._inputGeometries=h;this._geomUnitsPerPoint=d;this._rule=c.rule??C.GeometricEffectControlMeasureLineRule.FullGeometry;this._defaultSize=this._defaultPointSize*d}var m=x.prototype;m.next=function(){let h;for(;h=this._inputGeometries.next();){let c;t.isPoint(h)?c=this._processGeom([[[h.x,h.y]]]):t.isMultipoint(h)?c=this._processGeom([h.points]):t.isPolyline(h)?c=this._processGeom(h.paths):t.isPolygon(h)&&(c=this._processGeom(h.rings));if(c&&c.length)return{paths:c}}return null};m._clone=function(h){return[h[0],
h[1]]};m._mid=function(h,c){return[(h[0]+c[0])/2,(h[1]+c[1])/2]};m._mix=function(h,c,d,f){return[h[0]*c+d[0]*f,h[1]*c+d[1]*f]};m._add=function(h,c){return[h[0]+c[0],h[1]+c[1]]};m._add2=function(h,c,d){return[h[0]+c,h[1]+d]};m._sub=function(h,c){return[h[0]-c[0],h[1]-c[1]]};m._dist=function(h,c){return Math.sqrt((h[0]-c[0])*(h[0]-c[0])+(h[1]-c[1])*(h[1]-c[1]))};m._norm=function(h){return Math.sqrt(h[0]*h[0]+h[1]*h[1])};m._normalize=function(h,c=1){c/=this._norm(h);h[0]*=c;h[1]*=c};m._leftPerpendicular=
function(h){const c=h[0];h[0]=-h[1];h[1]=c};m._leftPerp=function(h){return[-h[1],h[0]]};m._rightPerpendicular=function(h){const c=-h[0];h[0]=h[1];h[1]=c};m._rightPerp=function(h){return[h[1],-h[0]]};m._dotProduct=function(h,c){return h[0]*c[0]+h[1]*c[1]};m._crossProduct=function(h,c){return h[0]*c[1]-h[1]*c[0]};m._rotateDirect=function(h,c,d){const f=h[0]*d+h[1]*c;h[0]=h[0]*c-h[1]*d;h[1]=f};m._makeCtrlPt=function(h){h=[h[0],h[1]];H.setId(h,1);return h};m._addAngledTicks=function(h,c,d,f){const k=
this._sub(d,c);this._normalize(k);var g=this._crossProduct(k,this._sub(f,c));f=0<g?this._rightPerp(k):this._leftPerp(k);g=Math.abs(g)/2;const e=[];e.push([c[0]+(f[0]-k[0])*g,c[1]+(f[1]-k[1])*g]);e.push(c);e.push(d);e.push([d[0]+(f[0]+k[0])*g,d[1]+(f[1]+k[1])*g]);h.push(e)};m._addBezier2=function(h,c,d,f,k){if(0===k--)h.push(f);else{var g=this._mid(c,d);d=this._mid(d,f);var e=this._mid(g,d);this._addBezier2(h,c,g,e,k);this._addBezier2(h,e,d,f,k)}};m._addBezier3=function(h,c,d,f,k,g){if(0===g--)h.push(k);
else{var e=this._mid(c,d),a=this._mid(d,f);f=this._mid(f,k);d=this._mid(e,a);a=this._mid(a,f);var b=this._mid(d,a);this._addBezier3(h,c,e,d,b,g);this._addBezier3(h,b,a,f,k,g)}};m._add90DegArc=function(h,c,d,f,k){f=k??0<this._crossProduct(this._sub(d,c),this._sub(f,c));k=this._mid(c,d);const g=this._sub(k,c);f?this._leftPerpendicular(g):this._rightPerpendicular(g);k[0]+=g[0];k[1]+=g[1];this._addBezier3(h,c,this._mix(c,.33333,k,.66667),this._mix(d,.33333,k,.66667),d,4)};m._addArrow=function(h,c,d){var f=
c[0],k=c[1],g=c[c.length-1],e=this._sub(f,k);this._normalize(e);const a=this._crossProduct(e,this._sub(g,k));k=.5*a;var b=this._leftPerp(e);const l=[g[0]-b[0]*a,g[1]-b[1]*a];var q=c.length-1;g=[];g.push(d?[-b[0],-b[1]]:b);var n=[-e[0],-e[1]];for(d=1;d<q-1;d++){e=this._sub(c[d+1],c[d]);this._normalize(e);var v=this._dotProduct(e,n);b=this._crossProduct(e,n);v=Math.sqrt((1+v)/2);n=this._sub(e,n);this._normalize(n);n[0]/=v;n[1]/=v;g.push(0>b?[-n[0],-n[1]]:n);n=e}g.push(this._rightPerp(n));for(q=g.length-
1;0<q;q--)h.push([c[q][0]+g[q][0]*k,c[q][1]+g[q][1]*k]);h.push([l[0]+g[0][0]*k,l[1]+g[0][1]*k]);h.push([l[0]+g[0][0]*a,l[1]+g[0][1]*a]);h.push(f);h.push([l[0]-g[0][0]*a,l[1]-g[0][1]*a]);h.push([l[0]-g[0][0]*k,l[1]-g[0][1]*k]);for(f=1;f<g.length;f++)h.push([c[f][0]-g[f][0]*k,c[f][1]-g[f][1]*k])};m._cp2=function(h,c,d){return 2<=h.length?h[1]:this._add2(h[0],c*this._defaultSize,d*this._defaultSize)};m._cp3=function(h,c,d,f){if(3<=h.length)return h[2];d=this._mix(h[0],1-d,c,d);h=this._sub(c,h[0]);this._normalize(h);
this._rightPerpendicular(h);return[d[0]+h[0]*f*this._defaultSize,d[1]+h[1]*f*this._defaultSize]};m._arrowPath=function(h){if(2<h.length)return h;const c=h[0];h=this._cp2(h,-4,0);const d=this._sub(c,h);this._normalize(d);const f=this._rightPerp(d);return[c,h,[c[0]+(f[0]-d[0])*this._defaultSize,c[1]+(f[1]-d[1])*this._defaultSize]]};m._arrowLastSeg=function(h){var c=h[0];const d=this._cp2(h,-4,0);if(3<=h.length)c=h[h.length-1];else{h=this._sub(c,d);this._normalize(h);const f=this._rightPerp(h);c=[c[0]+
(f[0]-h[0])*this._defaultSize,c[1]+(f[1]-h[1])*this._defaultSize]}return[d,c]};m._processGeom=function(h){if(!h)return null;const c=[];for(const d of h){if(!d||0===d.length)continue;const f=d.length;let k=d[0];switch(this._rule){case C.GeometricEffectControlMeasureLineRule.PerpendicularFromFirstSegment:const g=this._cp2(d,0,-1),e=this._cp3(d,g,.5,4),a=[];a.push(e);a.push(this._mid(k,g));c.push(a);break;case C.GeometricEffectControlMeasureLineRule.ReversedFirstSegment:const b=this._cp2(d,0,-1);c.push([b,
k]);break;case C.GeometricEffectControlMeasureLineRule.PerpendicularToSecondSegment:const l=this._cp2(d,-4,1),q=this._cp3(d,l,.882353,-1.94),n=[];n.push(this._mid(l,q));n.push(k);c.push(n);break;case C.GeometricEffectControlMeasureLineRule.SecondSegmentWithTicks:const v=this._cp2(d,-4,1),B=this._cp3(d,v,.882353,-1.94),z=this._sub(B,v);let p;p=0<this._crossProduct(z,this._sub(k,v))?this._rightPerp(p):this._leftPerp(z);const r=[];r.push([v[0]+(p[0]-z[0])/3,v[1]+(p[1]-z[1])/3]);r.push(v);r.push(B);r.push([B[0]+
(p[0]+z[0])/3,B[1]+(p[1]+z[1])/3]);c.push(r);break;case C.GeometricEffectControlMeasureLineRule.DoublePerpendicular:const D=this._cp2(d,0,-1),J=this._cp3(d,D,.5,3),K=this._mid(k,D),F=this._sub(K,J);this._normalize(F);const A=this._crossProduct(F,this._sub(k,J));this._leftPerpendicular(F);const I=[];I.push(k);I.push([J[0]+F[0]*A,J[1]+F[1]*A]);c.push(I);const G=[];G.push([J[0]-F[0]*A,J[1]-F[1]*A]);G.push(D);c.push(G);break;case C.GeometricEffectControlMeasureLineRule.OppositeToFirstSegment:const E=
this._cp2(d,0,-1),M=this._cp3(d,E,.5,3),T=this._mid(k,E),Y=this._sub(T,M);this._normalize(Y);const fa=this._crossProduct(Y,this._sub(k,M));this._leftPerpendicular(Y);const ba=[];ba.push([M[0]+Y[0]*fa,M[1]+Y[1]*fa]);ba.push([M[0]-Y[0]*fa,M[1]-Y[1]*fa]);c.push(ba);break;case C.GeometricEffectControlMeasureLineRule.TriplePerpendicular:const U=this._cp2(d,0,-1),P=this._cp3(d,U,.5,4),Q=this._mid(k,U),Z=this._sub(Q,P);this._normalize(Z);const X=this._crossProduct(Z,this._sub(k,P));this._leftPerpendicular(Z);
const sa=[];sa.push([P[0]+Z[0]*X*.8,P[1]+Z[1]*X*.8]);sa.push([Q[0]+.8*(k[0]-Q[0]),Q[1]+.8*(k[1]-Q[1])]);c.push(sa);c.push([P,Q]);const Aa=[];Aa.push([P[0]-Z[0]*X*.8,P[1]-Z[1]*X*.8]);Aa.push([Q[0]+.8*(U[0]-Q[0]),Q[1]+.8*(U[1]-Q[1])]);c.push(Aa);break;case C.GeometricEffectControlMeasureLineRule.HalfCircleFirstSegment:const Da=this._cp2(d,0,-1),ha=this._cp3(d,Da,.5,4),Ea=this._mid(k,Da);let za=this._sub(Da,k);const N=Math.cos(Math.PI/18),S=Math.sin(Math.PI/18),ea=Math.sqrt((1+N)/2),oa=Math.sqrt((1-
N)/2),va=[];let W;0<this._crossProduct(za,this._sub(ha,k))?(va.push(k),za=this._sub(k,Ea),W=Da):(va.push(Da),za=this._sub(Da,Ea),W=k);this._rotateDirect(za,ea,oa);za[0]/=ea;za[1]/=ea;for(let fb=1;18>=fb;fb++)va.push(this._add(Ea,za)),this._rotateDirect(za,N,S);va.push(W);c.push(va);break;case C.GeometricEffectControlMeasureLineRule.HalfCircleSecondSegment:const ca=this._cp2(d,0,-1),ka=this._cp3(d,ca,1,-1);let la=this._sub(k,ca);this._normalize(la);const ma=this._crossProduct(la,this._sub(ka,ca))/
2;this._leftPerpendicular(la);const ua=[ca[0]+la[0]*ma,ca[1]+la[1]*ma];la=this._sub(ca,ua);const xa=Math.cos(Math.PI/18);let ia=Math.sin(Math.PI/18);0<ma&&(ia=-ia);const na=[ca];for(let fb=1;18>=fb;fb++)this._rotateDirect(la,xa,ia),na.push(this._add(ua,la));c.push(na);break;case C.GeometricEffectControlMeasureLineRule.HalfCircleExtended:const ya=this._cp2(d,0,-2),Ga=this._cp3(d,ya,1,-1);let Ka;if(4<=f)Ka=d[3];else{const fb=this._sub(k,ya);Ka=this._add(Ga,fb)}const Ra=this._dist(ya,Ga)/2/.75,Qa=this._sub(ya,
k);this._normalize(Qa,Ra);const Ta=this._sub(Ga,Ka);this._normalize(Ta,Ra);c.push([Ka,Ga]);const Sa=[this._clone(Ga)];this._addBezier3(Sa,Ga,this._add(Ga,Ta),this._add(ya,Qa),ya,4);Sa.push(k);c.push(Sa);break;case C.GeometricEffectControlMeasureLineRule.OpenCircle:const Na=this._cp2(d,-2,0),Ua=this._sub(Na,k),Ja=Math.cos(Math.PI/18),rb=-Math.sin(Math.PI/18),hb=[Na];for(let fb=1;33>=fb;fb++)this._rotateDirect(Ua,Ja,rb),hb.push(this._add(k,Ua));c.push(hb);break;case C.GeometricEffectControlMeasureLineRule.CoverageEdgesWithTicks:const db=
this._cp2(d,0,-1);let O;if(3<=f)O=d[2];else{const fb=this._sub(db,k),Fb=this._leftPerp(fb);O=[k[0]+Fb[0]-.25*fb[0],k[1]+Fb[1]-.25*fb[1]]}let eb;if(4<=f)eb=d[3];else{const fb=this._mid(k,db),Fb=this._sub(k,db);this._normalize(Fb);this._leftPerpendicular(Fb);const Mb=this._crossProduct(Fb,this._sub(O,fb));this._rightPerpendicular(Fb);eb=[O[0]+Fb[0]*Mb*2,O[1]+Fb[1]*Mb*2]}const Za=this._sub(db,k);let pb,Ab;pb=0<this._crossProduct(Za,this._sub(O,k))?this._rightPerp(Za):this._leftPerp(Za);Ab=[];Ab.push(O);
Ab.push(k);Ab.push([k[0]+(pb[0]-Za[0])/3,k[1]+(pb[1]-Za[1])/3]);c.push(Ab);pb=0<this._crossProduct(Za,this._sub(eb,db))?this._rightPerp(pb):this._leftPerp(Za);Ab=[];Ab.push([db[0]+(pb[0]+Za[0])/3,db[1]+(pb[1]+Za[1])/3]);Ab.push(db);Ab.push(eb);c.push(Ab);break;case C.GeometricEffectControlMeasureLineRule.GapExtentWithDoubleTicks:const ib=this._cp2(d,0,2),Wb=this._cp3(d,ib,0,1);let Ca;if(4<=f)Ca=d[3];else{const fb=this._sub(ib,k);Ca=this._add(Wb,fb)}this._addAngledTicks(c,k,ib,this._mid(Wb,Ca));this._addAngledTicks(c,
Wb,Ca,this._mid(k,ib));break;case C.GeometricEffectControlMeasureLineRule.GapExtentMidline:const Xb=this._cp2(d,2,0),Yb=this._cp3(d,Xb,0,1);let Jb;if(4<=f)Jb=d[3];else{const fb=this._sub(Xb,k);Jb=this._add(Yb,fb)}const Qb=[];Qb.push(this._mid(k,Yb));Qb.push(this._mid(Xb,Jb));c.push(Qb);break;case C.GeometricEffectControlMeasureLineRule.Chevron:const kc=this._cp2(d,-1,-1);let Zb;if(3<=f)Zb=d[2];else{const fb=this._sub(kc,k);this._leftPerpendicular(fb);Zb=this._add(k,fb)}c.push([kc,this._makeCtrlPt(k),
Zb]);break;case C.GeometricEffectControlMeasureLineRule.PerpendicularWithArc:const $b=this._cp2(d,0,-2),Lb=this._cp3(d,$b,.5,-1);let ub=this._sub($b,k);const mb=this._norm(ub);ub[0]/=mb;ub[1]/=mb;const wb=this._crossProduct(ub,this._sub(Lb,k));let Cb=this._dotProduct(ub,this._sub(Lb,k));Cb<.05*mb?Cb=.05*mb:Cb>.95*mb&&(Cb=.95*mb);const cb=[k[0]+ub[0]*Cb,k[1]+ub[1]*Cb];this._leftPerpendicular(ub);let Tb=[];Tb.push([cb[0]-ub[0]*wb,cb[1]-ub[1]*wb]);Tb.push([cb[0]+ub[0]*wb,cb[1]+ub[1]*wb]);c.push(Tb);
const pa=[$b[0]+ub[0]*wb,$b[1]+ub[1]*wb];ub=this._sub($b,pa);const wa=Math.cos(Math.PI/18);let qa=Math.sin(Math.PI/18);0>wb&&(qa=-qa);Tb=[k,$b];for(let fb=1;9>=fb;fb++)this._rotateDirect(ub,wa,qa),Tb.push(this._add(pa,ub));c.push(Tb);break;case C.GeometricEffectControlMeasureLineRule.ClosedHalfCircle:const Fa=this._cp2(d,2,0),Oa=this._mid(k,Fa),Pa=this._sub(Fa,Oa),Ya=Math.cos(Math.PI/18),$a=Math.sin(Math.PI/18),sb=[k,Fa];for(let fb=1;18>=fb;fb++)this._rotateDirect(Pa,Ya,$a),sb.push(this._add(Oa,Pa));
c.push(sb);break;case C.GeometricEffectControlMeasureLineRule.TripleParallelExtended:const ob=this._cp2(d,0,-2),qb=this._cp3(d,ob,1,-2),vb=this._mid(k,ob),Db=this._sub(qb,ob);this._normalize(Db);const vd=Math.abs(this._crossProduct(Db,this._sub(vb,ob)))/2,rc=this._dist(ob,qb),wd=[ob,k];wd.push([k[0]+Db[0]*rc*.5,k[1]+Db[1]*rc*.5]);c.push(wd);const sc=[];sc.push([vb[0]-Db[0]*vd,vb[1]-Db[1]*vd]);sc.push([vb[0]+Db[0]*rc*.375,vb[1]+Db[1]*rc*.375]);H.setId(sc[sc.length-1],1);sc.push([vb[0]+Db[0]*rc*.75,
vb[1]+Db[1]*rc*.75]);c.push(sc);c.push([ob,qb]);break;case C.GeometricEffectControlMeasureLineRule.ParallelWithTicks:const Bc=this._cp2(d,3,0),gd=this._cp3(d,Bc,.5,-1),Cc=this._sub(gd,Bc);this._normalize(Cc);const xd=this._crossProduct(Cc,this._sub(gd,k));this._leftPerpendicular(Cc);this._addAngledTicks(c,k,Bc,gd);this._addAngledTicks(c,this._mix(k,1,Cc,xd),this._mix(Bc,1,Cc,xd),this._mid(k,Bc));break;case C.GeometricEffectControlMeasureLineRule.Parallel:const Dc=this._cp2(d,3,0),ne=this._cp3(d,Dc,
.5,-1),hd=this._sub(Dc,k);this._normalize(hd);const Qc=this._leftPerp(hd),Rc=this._crossProduct(hd,this._sub(ne,k));let Ec=[k,Dc];c.push(Ec);Ec=[];Ec.push([k[0]+Qc[0]*Rc,k[1]+Qc[1]*Rc]);Ec.push([Dc[0]+Qc[0]*Rc,Dc[1]+Qc[1]*Rc]);c.push(Ec);break;case C.GeometricEffectControlMeasureLineRule.PerpendicularToFirstSegment:const nc=this._cp2(d,3,0),yd=this._cp3(d,nc,.5,-1),qc=this._mid(k,nc),ac=this._sub(nc,k);this._normalize(ac);const id=this._crossProduct(ac,this._sub(yd,k));this._leftPerpendicular(ac);
const Fc=[];Fc.push([qc[0]-ac[0]*id*.25,qc[1]-ac[1]*id*.25]);Fc.push([qc[0]+ac[0]*id*1.25,qc[1]+ac[1]*id*1.25]);c.push(Fc);break;case C.GeometricEffectControlMeasureLineRule.ParallelOffset:const Pb=this._cp2(d,3,0),Fd=this._cp3(d,Pb,.5,-1),Rb=this._sub(Pb,k);this._normalize(Rb);const Vb=this._crossProduct(Rb,this._sub(Fd,k));this._leftPerpendicular(Rb);const Mc=[];Mc.push([k[0]-Rb[0]*Vb,k[1]-Rb[1]*Vb]);Mc.push([Pb[0]-Rb[0]*Vb,Pb[1]-Rb[1]*Vb]);c.push(Mc);const Gc=[];Gc.push([k[0]+Rb[0]*Vb,k[1]+Rb[1]*
Vb]);Gc.push([Pb[0]+Rb[0]*Vb,Pb[1]+Rb[1]*Vb]);c.push(Gc);break;case C.GeometricEffectControlMeasureLineRule.OffsetOpposite:const jd=this._cp2(d,3,0),oe=this._cp3(d,jd,.5,-1),tc=this._sub(jd,k);this._normalize(tc);const tb=this._crossProduct(tc,this._sub(oe,k));this._leftPerpendicular(tc);const Sc=[];Sc.push([k[0]-tc[0]*tb,k[1]-tc[1]*tb]);Sc.push([jd[0]-tc[0]*tb,jd[1]-tc[1]*tb]);c.push(Sc);break;case C.GeometricEffectControlMeasureLineRule.OffsetSame:const Kb=this._cp2(d,3,0),Gd=this._cp3(d,Kb,.5,
-1),pc=this._sub(Kb,k);this._normalize(pc);const Tc=this._crossProduct(pc,this._sub(Gd,k));this._leftPerpendicular(pc);const kd=[];kd.push([k[0]+pc[0]*Tc,k[1]+pc[1]*Tc]);kd.push([Kb[0]+pc[0]*Tc,Kb[1]+pc[1]*Tc]);c.push(kd);break;case C.GeometricEffectControlMeasureLineRule.CircleWithArc:let bc=this._cp2(d,3,0);const ld=this._cp3(d,bc,.5,-1);let uc,Uc;if(4<=f)uc=d[3],Uc=0<this._crossProduct(this._sub(uc,bc),this._sub(ld,bc));else{uc=bc;Uc=0<this._crossProduct(this._sub(uc,k),this._sub(ld,k));const fb=
24*this._geomUnitsPerPoint,Fb=this._sub(uc,k);this._normalize(Fb,fb);const Mb=Math.sqrt(2)/2;this._rotateDirect(Fb,Mb,Uc?Mb:-Mb);bc=this._add(k,Fb)}const Gb=this._sub(bc,k),Id=Math.cos(Math.PI/18),Hd=Math.sin(Math.PI/18),yc=[bc];for(let fb=1;36>=fb;fb++)this._rotateDirect(Gb,Id,Hd),yc.push(this._add(k,Gb));this._add90DegArc(yc,bc,uc,ld,Uc);H.setId(yc[yc.length-8],1);c.push(yc);break;case C.GeometricEffectControlMeasureLineRule.DoubleJog:let ic=this._cp2(d,-3,1),hc;hc=3<=f?d[2]:this._add(k,this._sub(k,
ic));let gc;if(4<=f)gc=d[3];else{const fb=k;k=ic;gc=hc;const Fb=this._dist(k,fb),Mb=this._dist(gc,fb);let ab=30*this._geomUnitsPerPoint;.5*Fb<ab&&(ab=.5*Fb);.5*Mb<ab&&(ab=.5*Mb);ic=this._mix(k,ab/Fb,fb,(Fb-ab)/Fb);hc=this._mix(gc,ab/Mb,fb,(Mb-ab)/Mb)}const zd=this._mid(k,ic),Jd=this._mid(gc,hc),le=this._dist(k,ic),sd=this._dist(hc,gc);let Hc=Math.min(le,sd)/8;Hc=Math.min(Hc,24*this._geomUnitsPerPoint);const Bb=Math.cos(Math.PI/4);let zb=this._sub(k,ic);this._normalize(zb,Hc);0<this._crossProduct(zb,
this._sub(gc,ic))?this._rotateDirect(zb,Bb,-Bb):this._rotateDirect(zb,Bb,Bb);let Sb=[];Sb.push(ic);Sb.push(this._add(zd,zb));Sb.push(this._sub(zd,zb));Sb.push(k);c.push(Sb);zb=this._sub(gc,hc);this._normalize(zb,Hc);0>this._crossProduct(zb,this._sub(k,hc))?this._rotateDirect(zb,Bb,Bb):this._rotateDirect(zb,Bb,-Bb);Sb=[];Sb.push(hc);Sb.push(this._add(Jd,zb));Sb.push(this._sub(Jd,zb));Sb.push(gc);c.push(Sb);break;case C.GeometricEffectControlMeasureLineRule.PerpendicularOffset:const Vc=this._cp2(d,
-4,1),md=this._cp3(d,Vc,.882353,-1.94),Ic=this._sub(md,Vc);0<this._crossProduct(Ic,this._sub(k,Vc))?this._rightPerpendicular(Ic):this._leftPerpendicular(Ic);const Ad=[Ic[0]/8,Ic[1]/8],Ld=this._sub(this._mid(Vc,md),Ad);c.push([Ld,k]);break;case C.GeometricEffectControlMeasureLineRule.LineExcludingLastSegment:const Md=this._arrowPath(d),nd=[];let Bd=Md.length-2;for(;Bd--;)nd.push(Md[Bd]);c.push(nd);break;case C.GeometricEffectControlMeasureLineRule.MultivertexArrow:const pe=this._arrowPath(d),Nd=[];
this._addArrow(Nd,pe,!1);c.push(Nd);break;case C.GeometricEffectControlMeasureLineRule.CrossedArrow:const me=this._arrowPath(d),Od=[];this._addArrow(Od,me,!0);c.push(Od);break;case C.GeometricEffectControlMeasureLineRule.ChevronArrow:const [Pd,Wc]=this._arrowLastSeg(d),od=10*this._geomUnitsPerPoint,vc=this._sub(k,Pd);this._normalize(vc);const Qd=this._crossProduct(vc,this._sub(Wc,Pd)),Rd=this._leftPerp(vc),Sd=[Wc[0]-Rd[0]*Qd*2,Wc[1]-Rd[1]*Qd*2],Xc=[];Xc.push([Wc[0]+vc[0]*od,Wc[1]+vc[1]*od]);Xc.push(k);
Xc.push([Sd[0]+vc[0]*od,Sd[1]+vc[1]*od]);c.push(Xc);break;case C.GeometricEffectControlMeasureLineRule.ChevronArrowOffset:const [Td,Cd]=this._arrowLastSeg(d),lc=this._sub(k,Td);this._normalize(lc);const Jc=this._crossProduct(lc,this._sub(Cd,Td));this._leftPerpendicular(lc);const Yc=[Cd[0]-lc[0]*Jc,Cd[1]-lc[1]*Jc],pd=[];pd.push([Yc[0]+lc[0]*Jc*.5,Yc[1]+lc[1]*Jc*.5]);pd.push(this._mid(Yc,k));pd.push([Yc[0]-lc[0]*Jc*.5,Yc[1]-lc[1]*Jc*.5]);c.push(pd);break;case C.GeometricEffectControlMeasureLineRule.PartialFirstSegment:const [Dd,
qd]=this._arrowLastSeg(d),Zc=this._sub(k,Dd);this._normalize(Zc);const Ud=this._crossProduct(Zc,this._sub(qd,Dd));this._leftPerpendicular(Zc);c.push([Dd,[qd[0]-Zc[0]*Ud,qd[1]-Zc[1]*Ud]]);break;case C.GeometricEffectControlMeasureLineRule.Arch:const mc=this._cp2(d,0,-1),ed=this._cp3(d,mc,.5,1),nb=this._sub(k,mc),Eb=this._mix(ed,1,nb,.55),$c=this._mix(ed,1,nb,-.55),Nc=[k];this._addBezier2(Nc,k,Eb,ed,4);this._addBezier2(Nc,ed,$c,mc,4);c.push(Nc);break;case C.GeometricEffectControlMeasureLineRule.CurvedParallelTicks:const jc=
this._cp2(d,-4,1),Oc=this._cp3(d,jc,.882353,-1.94),oc=this._sub(Oc,jc);0<this._crossProduct(oc,this._sub(k,jc))?this._rightPerpendicular(oc):this._leftPerpendicular(oc);const Pc=[oc[0]/8,oc[1]/8],Kd=this._sub(this._mid(jc,Oc),Pc),td=this._sub(this._mix(jc,.75,Oc,.25),Pc),ud=this._sub(this._mix(jc,.25,Oc,.75),Pc),Ac=[jc];this._addBezier2(Ac,jc,td,Kd,3);this._addBezier2(Ac,Kd,ud,Oc,3);c.push(Ac);for(let fb=0;8>fb;fb++){const Fb=Ac[2*fb+1],Mb=[this._clone(Fb)];Mb.push(this._add(Fb,[oc[0]/4,oc[1]/4]));
c.push(Mb)}break;case C.GeometricEffectControlMeasureLineRule.Arc90Degrees:const fd=this._cp2(d,0,-1),qe=this._cp3(d,fd,.5,1),Vd=[fd];this._add90DegArc(Vd,fd,k,qe);c.push(Vd);break;default:c.push(d)}}return c};return x}();u.EffectControlMeasureLine=w;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectCut":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(u,t,H,C){let w=function(){function x(){}
x.local=function(){null===x.instance&&(x.instance=new x);return x.instance};x.prototype.execute=function(m,h,c,d,f){return new y(m,h,c)};return x}();w.instance=null;let y=function(x){function m(h,c,d){h=x.call(this,h,!0,!0)||this;h._curveHelper=new C.CurveHelper;h._beginCut=(void 0!==c.beginCut?c.beginCut:1)*d;h._endCut=(void 0!==c.endCut?c.endCut:1)*d;h._middleCut=(void 0!==c.middleCut?c.middleCut:0)*d;h._invert=void 0!==c.invert?c.invert:!1;0>h._beginCut&&(h._beginCut=0);0>h._endCut&&(h._endCut=
0);0>h._middleCut&&(h._middleCut=0);return h}t._inheritsLoose(m,x);m.prototype.processPath=function(h){var c=this._beginCut;const d=this._endCut,f=this._middleCut,k=this._curveHelper.calculatePathLength(h),g=[];if(!this._invert)0===c&&0===d&&0===f?g.push(h):c+d+f>=k||(0===f?(h=this._curveHelper.getSubCurve(h,c,k-d))&&g.push(h):((c=this._curveHelper.getSubCurve(h,c,.5*(k-f)))&&g.push(c),(c=this._curveHelper.getSubCurve(h,.5*(k+f),k-d))&&g.push(c)));else if(0!==c||0!==d||0!==f)c+d+f>=k?g.push(h):((c=
this._curveHelper.getSubCurve(h,0,c))&&g.push(c),(c=this._curveHelper.getSubCurve(h,.5*(k-f),.5*(k+f)))&&g.push(c),(c=this._curveHelper.getSubCurve(h,k-d,d))&&g.push(c));return 0===g.length?null:{paths:g}};return m}(H.PathGeometryCursor);u.EffectCut=w;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectDashes":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../CIMCursor ../CurveHelper ../enums ../GeometryWalker".split(" "),function(u,
t,H,C,w,y){let x=function(){function h(){}h.local=function(){null===h.instance&&(h.instance=new h);return h.instance};h.prototype.execute=function(c,d,f,k,g){return new m(c,d,f)};return h}();x.instance=null;let m=function(h){function c(d,f,k){d=h.call(this,d,!0,!0)||this;d._firstCurve=null;d._walker=new y.GeometryWalker;d._walker.updateTolerance(k);d._endings=f.lineDashEnding;d._customDashPos=-(f.offsetAlongLine??0)*k;d._offsetAtEnd=(f.customEndingOffset??0)*k;d._pattern=new y.DashPattern;d._pattern.init(f.dashTemplate,
!0);d._pattern.scale(k);return d}t._inheritsLoose(c,h);c.prototype.processPath=function(d){if(0===this._pattern.length())return this.iteratePath=!1,{paths:[d]};if(!this.iteratePath){var f=!0;switch(this._endings){default:this._pattern.extPtGap=0;break;case w.LineDashEnding.FullPattern:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.firstValue());break;case w.LineDashEnding.FullGap:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.lastValue());break;case w.LineDashEnding.NoConstraint:this.isClosed||
(f=!1);break;case w.LineDashEnding.Custom:this.isClosed||(this._pattern.extPtGap=.5*this._offsetAtEnd)}var k=this._walker.calculatePathLength(d);if(this._pattern.isEmpty()||k<.1*this._pattern.length()||!this._walker.init(d,this._pattern,f))return{paths:[d]}}if(this.iteratePath)d=this._pattern.nextValue();else{switch(this._endings){default:f=.5*this._pattern.firstValue();break;case w.LineDashEnding.HalfGap:f=.5*-this._pattern.lastValue();break;case w.LineDashEnding.FullGap:f=-this._pattern.lastValue();
break;case w.LineDashEnding.FullPattern:f=0;break;case w.LineDashEnding.NoConstraint:case w.LineDashEnding.Custom:f=-this._customDashPos}d=f/this._pattern.length();d-=Math.floor(d);f=d*this._pattern.length();this._pattern.reset();d=this._pattern.nextValue();for(k=!1;f>=d;)f-=d,d=this._pattern.nextValue(),k=!k;d-=f;k?(this._walker.nextPosition(d),d=this._pattern.nextValue()):this.isClosed&&(this._firstCurve=this._walker.nextCurve(d),d=this._pattern.nextValue(),this._walker.nextPosition(d),d=this._pattern.nextValue())}(f=
this._walker.nextCurve(d))?this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(this._firstCurve.splice(0,1),C.PathHelper.mergePath(f,this._firstCurve),this._firstCurve=null)):(d=this._pattern.nextValue(),!this._walker.nextPosition(d)||this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(f=this._firstCurve,this._firstCurve=null)):this.iteratePath=!0):(this.iteratePath=!1,f=this._firstCurve,this._firstCurve=null);return{paths:[f]}};return c}(H.PathGeometryCursor);u.EffectDashes=
x;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/GeometryWalker":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","./CIMCursor","./CurveHelper"],function(u,t,H,C){let w=function(){function m(){this._values=[];this._currentValue=this._length=this.ctrlPtGap=this.extPtGap=0}var h=m.prototype;h.isEmpty=function(){return 0===this._values.length};h.size=function(){return this._values.length};h.init=function(c,d,f=!0){this._setEmpty();if(!c||0===c.length)return!1;
for(let k=0;k<c.length;k++){let g=Math.abs(c[k]);f&&1E-7>g&&(g=1E-7);this._values.push(g);this._length+=g}d&&c.length&1&&(this._length*=2);if(0===this._length)return!1;this.ctrlPtGap=this.extPtGap=0;this._currentValue=-1;return!0};h.scale=function(c){const d=this._values?this._values.length:0;for(let f=0;f<d;++f)this._values[f]*=c;this._length*=c;this.extPtGap*=c;this.ctrlPtGap*=c};h.addValue=function(c){this._length+=c;this._values.push(c)};h.firstValue=function(){return this._values[0]};h.lastValue=
function(){return this._values[this._values.length-1]};h.nextValue=function(){this._currentValue++;this._currentValue===this._values.length&&(this._currentValue=0);return this._values[this._currentValue]};h.reset=function(){this._currentValue=-1};h.length=function(){return this._length};h._setEmpty=function(){this.extPtGap=this.ctrlPtGap=this._length=0;this._currentValue=-1;this._values.length=0};return m}();u.EndType=void 0;(function(m){m[m.FAIL=0]="FAIL";m[m.END=1]="END";m[m.CONTINUE=2]="CONTINUE"})(u.EndType||
(u.EndType={}));let y=function(){function m(){this.reset()}var h=m.prototype;h.reset=function(){this.segment=-1;this.abscissa=this.segmentLength=0;this.isPartEnd=this.isPathEnd=!1};h.isValid=function(){return-1!==this.segment};h.copyTo=function(c){c.segment=this.segment;c.segmentLength=this.segmentLength;c.abscissa=this.abscissa;c.isPathEnd=this.isPathEnd;c.isPartEnd=this.isPartEnd};return m}(),x=function(m){function h(d=0,f=!1){d=m.call(this,d,f)||this;d._tolerance=C.PIXEL_TOLERANCE;d._currentPosition=
new y;return d}t._inheritsLoose(h,m);var c=h.prototype;c.updateTolerance=function(d){this._tolerance=C.PIXEL_TOLERANCE*d};c.init=function(d,f,k=!0){k?(this._patternLength=f.length(),this._partExtPtGap=f.extPtGap,this._partCtrlPtGap=f.ctrlPtGap):this._partCtrlPtGap=this._partExtPtGap=this._patternLength=0;this._currentPosition.reset();this._partSegCount=0;this._path=d;this._seg=-1;return this._setPosAtNextPart()};c.curPositionIsValid=function(){return this._currentPosition.isValid()};c.nextPosition=
function(d,f=u.EndType.FAIL){const k=new y;if(!this._nextPosition(d,k,null,f))return!1;k.copyTo(this._currentPosition);return!0};c.curPointAndAngle=function(d){d.pt=this._getPoint(this._currentPosition);const [f,k]=this._getAngle(this._currentPosition);d.ca=f;d.sa=k};c.nextPointAndAngle=function(d,f,k=u.EndType.FAIL){const g=new y;if(!this._nextPosition(d,g,null,k))return!1;g.copyTo(this._currentPosition);f.pt=this._getPoint(g);const [e,a]=this._getAngle(g);f.ca=e;f.sa=a;return!0};c.nextCurve=function(d){if(0===
d)return null;const f=[],k=new y;if(!this._nextPosition(d,k,f,u.EndType.END))return null;k.copyTo(this._currentPosition);return f};c.isPathEnd=function(){return this._currentPosition.isPathEnd};c.getPathEnd=function(){if(-1===this._currentPosition.segment)throw Error("missing segment");return this._path[this._currentPosition.segment+1]};c._nextPosition=function(d,f,k,g){if(this._currentPosition.isPathEnd)return!1;var e=this._currentPosition.abscissa;0<this._currentPosition.segmentLength&&(e/=this._currentPosition.segmentLength);
for(this._currentPosition.copyTo(f);f.abscissa+d*this._partLengthRatio>f.segmentLength+this._tolerance;)if(k&&(0===k.length&&(0===e?(e=this._path[f.segment],k.push([e[0],e[1]])):k.push(this.getSegCoord2D(this._path,f.segment,e))),e=this._path[f.segment+1],k.push([e[0],e[1]])),e=0,d-=(f.segmentLength-f.abscissa)/this._partLengthRatio,this._partSegCount)f.segment=this._nextSegment(),f.segmentLength=this.calculateSegLength(this._path,f.segment),f.abscissa=0,this._partSegCount--;else{if(!this._setPosAtNextPart()){if(g===
u.EndType.FAIL)return!1;f.segmentLength=this.calculateSegLength(this._path,f.segment);f.isPartEnd=!0;g===u.EndType.END?(f.abscissa=f.segmentLength,f.isPathEnd=!0):f.abscissa=f.segmentLength+d;return!0}this._currentPosition.copyTo(f)}f.abscissa+=d*this._partLengthRatio;k&&(0===k.length&&(0===e?(d=this._path[f.segment],k.push([d[0],d[1]])):k.push(this.getSegCoord2D(this._path,f.segment,e))),d=f.abscissa/f.segmentLength,1===d?(d=this._path[f.segment+1],k.push([d[0],d[1]])):k.push(this.getSegCoord2D(this._path,
f.segment,d)));!this._partSegCount&&Math.abs(f.abscissa-f.segmentLength)<this._tolerance&&(f.isPathEnd=this._partIsLast,f.isPartEnd=!0);return!0};c._getPoint=function(d){if(-1===d.segment)throw Error("missing segment");return this.getSegCoord2D(this._path,d.segment,0>=d.segmentLength?0:d.abscissa/d.segmentLength)};c._getAngle=function(d){if(-1===d.segment)throw Error("missing segment");return this.getSegAngleCS(this._path,d.segment,0>=d.segmentLength?0:d.abscissa/d.segmentLength)};c._setPosAtNextPart=
function(){for(;this._partSegCount;)this._hasNextSegment()&&this._nextSegment(),this._partSegCount--;if(!this._hasNextSegment())return!1;this._partLength=0;this._partIsLast=!0;for(this._partSegCount=0;this._hasNextSegment();)if(this._partLength+=this.calculateSegLength(this._path,this._nextSegment()),this._partSegCount++,1===H.getId(this._path[this._getEndPointIndex()])){this._partIsLast=!this._hasNextSegment();break}for(var d=this._partSegCount;d;)this._previousSegment(),--d;this._currentPosition.segment=
this._nextSegment();this._currentPosition.segmentLength=this.calculateSegLength(this._path,this._currentPosition.segment);this._currentPosition.abscissa=0;this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1;--this._partSegCount;d=this._getStartPointIndex();this._ctrlPtBegin=1===H.getId(this._path[d]);d=d+this._partSegCount+1;d>=this._path.length&&(d=0);this._ctrlPtEnd=1===H.getId(this._path[d]);if(0<this._patternLength){d=this._ctrlPtBegin?this._partCtrlPtGap:this._partExtPtGap;const f=
this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap;let k=Math.round((this._partLength-(d+f))/this._patternLength);0>=k&&(k=0<d+f?0:1);this._partLengthRatio=this._partLength/(d+f+k*this._patternLength);.01>this._partLengthRatio&&(this._partLengthRatio=1)}else this._partLengthRatio=1;return!0};c._hasNextSegment=function(){return this._seg<this._path.length-2};c._previousSegment=function(){return--this._seg};c._nextSegment=function(){return++this._seg};c._getStartPointIndex=function(){return this._seg};
c._getEndPointIndex=function(){return this._seg+1};return h}(C.CurveHelper);u.DashPattern=w;u.GeometryWalker=x;u.Pos=function(){this.pt=null;this.sa=this.ca=0};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectDonut":function(){define("exports ../../../geometry ../../../core/maybe ../../../geometry/support/jsonUtils ../CIMEffects ../enums ../../../geometry/SpatialReference".split(" "),function(u,t,H,C,w,y,x){t=function(){function h(){}h.local=function(){null===
h.instance&&(h.instance=new h);return h.instance};h.prototype.execute=function(c,d,f,k,g){return new m(c,d,f,k,g)};return h}();t.instance=null;let m=function(){function h(c,d,f,k,g){this._inputGeometries=c;this._tileKey=k;this._geometryEngine=g;this._width=(void 0!==d.width?d.width:2)*f;this._option=d.option}h.prototype.next=function(){let c;for(;c=this._inputGeometries.next();){if(C.isExtent(c)&&0<this._width){if(0>Math.min(c.xmax-c.xmin,c.ymax-c.ymin)-2*this._width)return c;var d=[];d.push([[c.xmin,
c.ymin],[c.xmin,c.ymax],[c.xmax,c.ymax],[c.xmax,c.ymin],[c.xmin,c.ymin]]);d.push([[c.xmin+this._width,c.ymin+this._width],[c.xmax-this._width,c.ymin+this._width],[c.xmax-this._width,c.ymax-this._width],[c.xmin+this._width,c.ymax-this._width],[c.xmin+this._width,c.ymin+this._width]]);return{rings:d}}if(C.isPolygon(c)){d=null;var f=this._geometryEngine;let k=c;if(this._tileKey&&(k=w.clipPolygonToTileExtent(c,Math.abs(this._width)+1),!k||!k.rings||0===k.rings.length))continue;H.isSome(f)&&(d=f.buffer(x.WebMercator,
k,-this._width,1));if(0<this._width){f=[];for(const g of c.rings)g&&f.push(g);if(d)for(const g of d.rings)g&&f.push(g.reverse());if(f.length)return{rings:f}}}}return null};return h}();u.EffectDonut=t;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectJog":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(u,t,H,C){let w=function(){function x(){}x.local=function(){null===x.instance&&(x.instance=
new x);return x.instance};x.prototype.execute=function(m,h,c,d,f){return new y(m,h,c)};return x}();w.instance=null;let y=function(x){function m(h,c,d){h=x.call(this,h,!1,!0)||this;h._curveHelper=new C.CurveHelper;h._length=(void 0!==c.length?c.length:20)*d;h._angle=void 0!==c.angle?c.angle:225;h._position=void 0!==c.position?c.position:50;0>h._length&&(h._length=-h._length);20>h._position&&(h._position=20);80<h._position&&(h._position=80);h._mirror=!1;return h}t._inheritsLoose(m,x);m.prototype.processPath=
function(h){if(this._curveHelper.isEmpty(h,!1))return null;const c=h[0];h=h[h.length-1];this._curveHelper.normalize([h[0]-c[0],h[1]-c[1]]);const d=[c[0]+(h[0]-c[0])*this._position/100,c[1]+(h[1]-c[1])*this._position/100],f=Math.cos((90-this._angle)/180*Math.PI);let k=Math.sin((90-this._angle)/180*Math.PI);this._mirror&&(k=-k);this._mirror=!this._mirror;return{paths:[[c,[d[0]-this._length/2*f,d[1]-this._length/2*k],[d[0]+this._length/2*f,d[1]+this._length/2*k],h]]}};return m}(H.PathGeometryCursor);
u.EffectJog=w;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectMove":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils"],function(u,t,H){let C=function(){function y(){}y.local=function(){null===y.instance&&(y.instance=new y);return y.instance};y.prototype.execute=function(x,m,h,c,d){return new w(x,m,h)};return y}();C.instance=null;let w=function(){function y(m,h,c){this._inputGeometries=m;this._offsetX=void 0!==h.offsetX?
h.offsetX*c:0;this._offsetY=void 0!==h.offsetY?-h.offsetY*c:0}var x=y.prototype;x.next=function(){for(var m=this._inputGeometries.next();m;){if(H.isExtent(m))return{xmin:m.xmin+this._offsetX,xmax:m.xmax+this._offsetX,ymin:m.ymin+this._offsetY,ymax:m.ymax+this._offsetY};if(H.isPolygon(m))return m=t.clone(m),this._moveMultipath(m.rings,this._offsetX,this._offsetY),m;if(H.isPolyline(m))return m=t.clone(m),this._moveMultipath(m.paths,this._offsetX,this._offsetY),m;if(H.isMultipoint(m))return m=t.clone(m),
this._movePath(m.points,this._offsetX,this._offsetY),m;if(H.isPoint(m))return{x:m.x+this._offsetX,y:m.y+this._offsetY};m=this._inputGeometries.next()}return null};x._moveMultipath=function(m,h,c){if(m)for(const d of m)this._movePath(d,h,c)};x._movePath=function(m,h,c){if(m)for(const d of m)d[0]+=h,d[1]+=c};return y}();u.EffectMove=C;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectOffset":function(){define("exports ../../../geometry ../../../core/maybe ../../../geometry/support/jsonUtils ../CIMEffects ../CurveHelper ../enums ../../../geometry/SpatialReference".split(" "),
function(u,t,H,C,w,y,x,m){t=function(){function c(){}c.local=function(){null===c.instance&&(c.instance=new c);return c.instance};c.prototype.execute=function(d,f,k,g,e){return new h(d,f,k,g,e)};return c}();t.instance=null;let h=function(){function c(d,f,k,g,e){this._inputGeometries=d;this._tileKey=g;this._geometryEngine=e;this._curveHelper=new y.CurveHelper;this._offset=(f.offset??1)*k;this._method=f.method;this._option=f.option;this._offsetFlattenError=y.PIXEL_TOLERANCE*k}c.prototype.next=function(){for(var d;d=
this._inputGeometries.next();){if(0===this._offset)return d;if(C.isExtent(d)){if(this._method===x.GeometricEffectOffsetMethod.Rounded&&0<this._offset)return(d=this._curveHelper.offset([[d.xmin,d.ymin],[d.xmin,d.ymax],[d.xmax,d.ymax],[d.xmax,d.ymin],[d.xmin,d.ymin]],-this._offset,this._method,4,this._offsetFlattenError))?{rings:[d]}:null;if(0<Math.min(d.xmax-d.xmin,d.ymax-d.ymin)+2*this._offset)return{xmin:d.xmin-this._offset,xmax:d.xmax+this._offset,ymin:d.ymin-this._offset,ymax:d.ymax+this._offset}}const f=
this._geometryEngine;if(H.isNone(f))break;let k=d;if(C.isPolygon(d)){if(this._tileKey&&(k=w.clipPolygonToTileExtent(d,Math.abs(this._offset)+1),!k||!k.rings||0===k.rings.length))continue}else if(C.isPolyline(d)&&this._tileKey&&(k=w.clipPolylineToTileExtent(d,Math.abs(this._offset)+1),!k||!k.paths||0===k.paths.length))continue;return f.offset(m.WebMercator,k,-this._offset,1,this._method,4,this._offsetFlattenError)}return null};return c}();u.EffectOffset=t;Object.defineProperty(u,Symbol.toStringTag,
{value:"Module"})})},"esri/symbols/cim/effects/EffectReverse":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(u,t,H,C){let w=function(){function x(){}x.local=function(){null===x.instance&&(x.instance=new x);return x.instance};x.prototype.execute=function(m,h,c,d,f){return new y(m,h,c)};return x}();w.instance=null;let y=function(){function x(m,h,c){this._inputGeometries=m;this._reverse=void 0!==h.reverse?h.reverse:!0}x.prototype.next=
function(){for(var m=this._inputGeometries.next();m;){if(!this._reverse)return m;if(H.isPolyline(m))return m=t.clone(m),C.reverseMultipath(m.paths),m;m=this._inputGeometries.next()}return null};return x}();u.EffectReverse=w;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectRotate":function(){define(["exports","../../../core/lang","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../../../geometry/support/jsonUtils"],function(u,
t,H,C,w){let y=function(){function m(){}m.local=function(){null===m.instance&&(m.instance=new m);return m.instance};m.prototype.execute=function(h,c,d,f,k){return new x(h,c,d)};return m}();y.instance=null;let x=function(){function m(c,d,f){this._inputGeometries=c;this._rotateAngle=void 0!==d.angle?d.angle*Math.PI/180:0}var h=m.prototype;h.next=function(){for(var c=this._inputGeometries.next();c;){if(0===this._rotateAngle)return c;var d=H.create();C.getBoundsXY(d,c);const f=(d[2]+d[0])/2;d=(d[3]+d[1])/
2;if(w.isExtent(c))return c={rings:[[[c.xmin,c.ymin],[c.xmin,c.ymax],[c.xmax,c.ymax],[c.xmax,c.ymin],[c.xmin,c.ymin]]]},this._rotateMultipath(c.rings,f,d),c;if(w.isPolygon(c))return c=t.clone(c),this._rotateMultipath(c.rings,f,d),c;if(w.isPolyline(c))return c=t.clone(c),this._rotateMultipath(c.paths,f,d),c;if(w.isMultipoint(c))return c=t.clone(c),this._rotatePath(c.points,f,d),c;if(w.isPoint(c))return c;c=this._inputGeometries.next()}return null};h._rotateMultipath=function(c,d,f){if(c)for(const k of c)this._rotatePath(k,
d,f)};h._rotatePath=function(c,d,f){if(c){const k=Math.cos(this._rotateAngle),g=Math.sin(this._rotateAngle);for(const e of c){c=e[0]-d;const a=e[1]-f;e[0]=d+c*k-a*g;e[1]=f+c*g+a*k}}};return m}();u.EffectRotate=y;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectScale":function(){define(["exports","../../../core/lang","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../../../geometry/support/jsonUtils"],function(u,t,H,
C,w){let y=function(){function m(){}m.local=function(){null===m.instance&&(m.instance=new m);return m.instance};m.prototype.execute=function(h,c,d,f,k){return new x(h,c,d)};return m}();y.instance=null;let x=function(){function m(c,d,f){this._inputGeometries=c;this._xFactor=void 0!==d.xScaleFactor?d.xScaleFactor:1.15;this._yFactor=void 0!==d.yScaleFactor?d.yScaleFactor:1.15}var h=m.prototype;h.next=function(){for(var c=this._inputGeometries.next();c;){if(1===this._xFactor&&1===this._yFactor)return c;
var d=H.create();C.getBoundsXY(d,c);const f=(d[2]+d[0])/2;d=(d[3]+d[1])/2;if(w.isExtent(c))return c={rings:[[[c.xmin,c.ymin],[c.xmin,c.ymax],[c.xmax,c.ymax],[c.xmax,c.ymin],[c.xmin,c.ymin]]]},this._scaleMultipath(c.rings,f,d),c;if(w.isPolygon(c))return c=t.clone(c),this._scaleMultipath(c.rings,f,d),c;if(w.isPolyline(c))return c=t.clone(c),this._scaleMultipath(c.paths,f,d),c;if(w.isMultipoint(c))return c=t.clone(c),this._scalePath(c.points,f,d),c;if(w.isPoint(c))return c;c=this._inputGeometries.next()}return null};
h._scaleMultipath=function(c,d,f){if(c)for(const k of c)this._scalePath(k,d,f)};h._scalePath=function(c,d,f){if(c)for(const k of c)c=(k[1]-f)*this._yFactor,k[0]=d+(k[0]-d)*this._xFactor,k[1]=f+c};return m}();u.EffectScale=y;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectWave":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../enums","../GeometryWalker"],function(u,t,H,C,w){let y=function(){function m(){}m.local=
function(){null===m.instance&&(m.instance=new m);return m.instance};m.prototype.execute=function(h,c,d,f,k){return new x(h,c,d)};return m}();y.instance=null;let x=function(){function m(c,d,f){this._inputGeometries=c;this._height=(void 0!==d.amplitude?d.amplitude:2)*f;this._period=(void 0!==d.period?d.period:3)*f;this._style=d.waveform;0>=this._height&&(this._height=Math.abs(this._height));0>=this._period&&(this._period=Math.abs(this._period));this._pattern=new w.DashPattern;this._pattern.addValue(this._period);
this._pattern.addValue(this._period);this._walker=new w.GeometryWalker;this._walker.updateTolerance(f)}var h=m.prototype;h.next=function(){for(var c=this._inputGeometries.next();c;){if(0===this._height||0===this._period)return c;if(t.isPolyline(c)){const d=this._processGeom(c.paths);if(d.length)return{paths:d}}if(t.isPolygon(c)&&(c=this._processGeom(c.rings),c.length))return{rings:c};c=this._inputGeometries.next()}return null};h._processGeom=function(c){const d=[];for(const f of c)if(this._walker.init(f,
this._pattern))switch(this._style){default:d.push(this._constructCurve(f,!1));break;case C.GeometricEffectWaveform.Square:d.push(this._constructSquare(f));break;case C.GeometricEffectWaveform.Triangle:d.push(this._constructTriangle(f));break;case C.GeometricEffectWaveform.Random:d.push(this._constructCurve(f,!0))}else d.push(f);return d};h._constructCurve=function(c,d){const f=new H.PathHelper;var k=this._walker.calculatePathLength(c),g=Math.round(k/this._period);0===g&&(g=1);const e=this._period/
16,a=1/(16*g+1);k=2*Math.PI*k/(k/g);g=2*Math.PI*Math.random();const b=2*Math.PI*Math.random(),l=2*Math.PI*Math.random(),q=.75-Math.random()/2,n=.75-Math.random()/2,v=new w.Pos;this._walker.curPointAndAngle(v);f.startPath(v.pt);let B=0;for(;;)if(this._walker.nextPointAndAngle(e,v)){const z=B;B+=a;let p;if(d){const r=this._height/2*(1+.3*Math.sin(q*k*z+g));p=r*Math.sin(k*z+b);p+=r*Math.sin(n*k*z+l);p/=2}else p=.5*this._height*Math.sin(.5*k*z);f.lineTo([v.pt[0]-p*v.sa,v.pt[1]+p*v.ca])}else{f.lineTo(c[c.length-
1]);break}return f.path()};h._constructSquare=function(c){const d=new H.PathHelper;c=this._walker.calculatePathLength(c);Math.round(c/this._period);for(c=!0;;){let f=!1;if(this._walker.curPositionIsValid()){const k=new w.Pos;this._walker.curPointAndAngle(k);const g=new w.Pos;if(this._walker.nextPointAndAngle(this._period,g)){const e=new w.Pos;this._walker.nextPointAndAngle(this._period,e)&&(c?(d.startPath(k.pt),c=!1):d.lineTo(k.pt),d.lineTo([k.pt[0]-this._height/2*k.sa,k.pt[1]+this._height/2*k.ca]),
d.lineTo([g.pt[0]-this._height/2*g.sa,g.pt[1]+this._height/2*g.ca]),d.lineTo([g.pt[0]+this._height/2*g.sa,g.pt[1]-this._height/2*g.ca]),d.lineTo([e.pt[0]+this._height/2*e.sa,e.pt[1]-this._height/2*e.ca]),f=!0)}}if(!f){d.lineTo(this._walker.getPathEnd());break}}return d.path()};h._constructTriangle=function(c){const d=new H.PathHelper;c=this._walker.calculatePathLength(c);Math.round(c/this._period);for(c=!0;;){let f=!1;if(this._walker.curPositionIsValid()){const k=new w.Pos;this._walker.curPointAndAngle(k);
const g=new w.Pos;if(this._walker.nextPointAndAngle(this._period/2,g)){const e=new w.Pos;this._walker.nextPointAndAngle(this._period,e)&&(this._walker.nextPosition(this._period/2)&&(c?(d.startPath(k.pt),c=!1):d.lineTo(k.pt),d.lineTo([g.pt[0]-this._height/2*g.sa,g.pt[1]+this._height/2*g.ca]),d.lineTo([e.pt[0]+this._height/2*e.sa,e.pt[1]-this._height/2*e.ca])),f=!0)}}if(!f){d.lineTo(this._walker.getPathEnd());break}}return d.path()};return m}();u.EffectWave=y;Object.defineProperty(u,Symbol.toStringTag,
{value:"Module"})})},"esri/symbols/cim/placements/PlacementAlongLineSameSize":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../enums","../GeometryWalker"],function(u,t,H,C,w){let y=function(){function m(){}m.local=function(){null===m.instance&&(m.instance=new m);return m.instance};m.prototype.execute=function(h,c,d,f,k){return new x(h,c,d)};return m}();y.instance=null;let x=function(m){function h(d,f,k){d=m.call(this,d,!0,!0)||this;d._geometryWalker=new w.GeometryWalker;
d._geometryWalker.updateTolerance(k);d._angleToLine=f.angleToLine??!0;d._offset=(f.offset?f.offset:0)*k;d._originalEndings=f.endings;d._offsetAtEnd=(f.customEndingOffset?f.customEndingOffset:0)*k;d._position=-(f.offsetAlongLine?f.offsetAlongLine:0)*k;d._pattern=new w.DashPattern;d._pattern.init(f.placementTemplate,!1);d._pattern.scale(k);d._endings=d._originalEndings;return d}t._inheritsLoose(h,m);var c=h.prototype;c.processPath=function(d){if(this._pattern.isEmpty())return null;if(this.iteratePath)var f=
this._pattern.nextValue();else{this._endings=this._originalEndings===C.PlacementEndings.WithFullGap&&this.isClosed?C.PlacementEndings.WithMarkers:this._originalEndings;this._pattern.extPtGap=0;let k=!0;switch(this._endings){case C.PlacementEndings.NoConstraint:f=-this._position;f=this._adjustPosition(f);k=!1;break;default:f=-this._pattern.lastValue()/2;break;case C.PlacementEndings.WithFullGap:f=-this._pattern.lastValue();this._pattern.extPtGap=this._pattern.lastValue();break;case C.PlacementEndings.WithMarkers:f=
0;break;case C.PlacementEndings.Custom:f=-this._position,f=this._adjustPosition(f),this._pattern.extPtGap=.5*this._offsetAtEnd}if(!this._geometryWalker.init(d,this._pattern,k))return null;this._pattern.reset();for(d=0;f>d;)f-=d,d=this._pattern.nextValue();f=d-f;this.iteratePath=!0}d=new w.Pos;if(!this._geometryWalker.nextPointAndAngle(f,d)||this._endings===C.PlacementEndings.WithFullGap&&this._geometryWalker.isPathEnd())return this.iteratePath=!1,null;if(this._endings===C.PlacementEndings.WithMarkers&&
this._geometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed))return null;this.internalPlacement.setTranslate(d.pt[0]-this._offset*d.sa,d.pt[1]+this._offset*d.ca);this._angleToLine&&this.internalPlacement.setRotateCS(d.ca,d.sa);return this.internalPlacement};c._adjustPosition=function(d){d/=this._pattern.length();d-=Math.floor(d);return d*this._pattern.length()};return h}(H.PathTransformationCursor);u.PlacementAlongLineSameSize=y;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},
"esri/symbols/cim/placements/PlacementAtExtremities":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper","../enums"],function(u,t,H,C,w){let y=function(){function m(){}m.local=function(){null===m.instance&&(m.instance=new m);return m.instance};m.prototype.execute=function(h,c,d,f,k){return new x(h,c,d)};return m}();y.instance=null;let x=function(m){function h(d,f,k){d=m.call(this,d,!1,!0)||this;d._curveHelper=new C.CurveHelper;d._angleToLine=void 0!==
f.angleToLine?f.angleToLine:!0;d._offset=void 0!==f.offset?f.offset*k:0;d._type=f.extremityPlacement;d._position=void 0!==f.offsetAlongLine?f.offsetAlongLine*k:0;d._beginProcessed=!1;return d}t._inheritsLoose(h,m);var c=h.prototype;c.processPath=function(d){let f;switch(this._type){default:this._beginProcessed?(f=this._atExtremities(d,this._position,!1),this.iteratePath=this._beginProcessed=!1):(f=this._atExtremities(d,this._position,!0),this.iteratePath=this._beginProcessed=!0);break;case w.ExtremityPlacement.JustBegin:f=
this._atExtremities(d,this._position,!0);break;case w.ExtremityPlacement.JustEnd:f=this._atExtremities(d,this._position,!1);case w.ExtremityPlacement.None:}return f};c._atExtremities=function(d,f,k){var g=d.length;if(2>g)return null;var e=k?1:g-2;const a=k?g:-1,b=k?1:-1;let l=0;k=k?d[0]:d[g-1];for(g=e;g!==a;g+=b){e=k;k=d[g];const q=this._curveHelper.calculateLength(e,k);if(l+q>f){d=(f-l)/q;const [n,v]=this._curveHelper.getAngleCS(e,k,d);d=H.getCoord2D(e,k,d);this.internalPlacement.setTranslate(d[0]-
this._offset*v,d[1]+this._offset*n);this._angleToLine&&this.internalPlacement.setRotateCS(-n,-v);return this.internalPlacement}l+=q}return null};return h}(H.PathTransformationCursor);u.PlacementAtExtremities=y;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/placements/PlacementAtRatioPositions":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../GeometryWalker"],function(u,t,H,C){let w=function(){function x(){}x.local=function(){null===
x.instance&&(x.instance=new x);return x.instance};x.prototype.execute=function(m,h,c,d,f){return new y(m,h,c)};return x}();w.instance=null;let y=function(x){function m(h,c,d){h=x.call(this,h,!0,!0)||this;h._walker=new C.GeometryWalker;h._walker.updateTolerance(d);h._angleToLine=void 0!==c.angleToLine?c.angleToLine:!0;h._offset=void 0!==c.offset?c.offset*d:0;h._beginGap=void 0!==c.beginPosition?c.beginPosition*d:0;h._endGap=void 0!==c.endPosition?c.endPosition*d:0;h._flipFirst=void 0!==c.flipFirst?
c.flipFirst:!0;h._pattern=new C.DashPattern;h._pattern.init(c.positionArray,!1,!1);h._subPathLen=0;h._posCount=h._pattern.size();h._isFirst=!0;h._prevPos=0;return h}t._inheritsLoose(m,x);m.prototype.processPath=function(h){if(this._pattern.isEmpty())return null;if(this.iteratePath){h=this._pattern.nextValue()*this._subPathLen;var c=this._beginGap+h;h=c-this._prevPos;this._prevPos=c}else{this._posCount=this._pattern.size();this._isFirst=!0;this._prevPos=0;this._subPathLen=this._walker.calculatePathLength(h)-
this._beginGap-this._endGap;if(0>this._subPathLen)return this.iteratePath=!1,null;if(!this._walker.init(h,this._pattern,!1))return null;this._pattern.reset();h=this._pattern.nextValue()*this._subPathLen;c=this._beginGap+h;h=c-this._prevPos;this._prevPos=c;this.iteratePath=!0}c=new C.Pos;if(!this._walker.nextPointAndAngle(h,c,C.EndType.END))return this.iteratePath=!1,null;this.internalPlacement.setTranslate(c.pt[0]-this._offset*c.sa,c.pt[1]+this._offset*c.ca);h=this._isFirst&&this._flipFirst;let d;
this._angleToLine?(d=c.ca,c=c.sa):(d=1,c=0);h&&(d=-d,c=-c);this.internalPlacement.setRotateCS(d,c);this._isFirst=!1;this._posCount--;0===this._posCount&&(this.iteratePath=!1);return this.internalPlacement};return m}(H.PathTransformationCursor);u.PlacementAtRatioPositions=w;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/placements/PlacementInsidePolygon":function(){define(["exports","../../../core/maybe","../../../core/RandomLCG","../CIMPlacements","../enums"],function(u,
t,H,C,w){function y(h,c,d,f){let k=f.get(h);k||(k=[],f.set(h,k));k.push([c,d])}let x=function(){function h(){}h.local=function(){null===h.instance&&(h.instance=new h);return h.instance};h.prototype.execute=function(c,d,f,k,g){return new m(c,d,f,k,g)};return h}();x.instance=null;let m=function(){function h(d,f,k,g,e){this._currentY=this._currentX=this._yMax=this._yMin=this._xMax=this._xMin=0;this._accelerationMap=null;this._testInsidePolygon=!1;this._verticalSubdivision=!0;this._stepX=Math.abs(f.stepX??
16)*k;this._stepY=Math.abs(f.stepY??16)*k;if(0!==this._stepX&&0!==this._stepY&&d&&void 0!==d.rings&&d.rings){this._gridType=f.gridType??w.PlacementGridType.Fixed;if(this._gridType===w.PlacementGridType.Random)this._randomLCG=new H(1*(f.seed??13)),this._randomness=(f.randomness??100)/100,this._gridAngle=0,this._shiftOddRows=!1,this._cosAngle=1,this._offsetY=this._offsetX=this._sinAngle=0,this._buildRandomValues();else{this._randomness=0;this._gridAngle=f.gridAngle??0;this._shiftOddRows=f.shiftOddRows??
!1;this._offsetX=(f.offsetX??0)*k;this._offsetY=(f.offsetY??0)*k;this._cosAngle=Math.cos(this._gridAngle/180*Math.PI);this._sinAngle=-Math.sin(this._gridAngle/180*Math.PI);if(this._stepX)if(0>this._offsetX)for(;this._offsetX<-.5*this._stepX;)this._offsetX+=this._stepX;else for(;this._offsetX>=.5*this._stepX;)this._offsetX-=this._stepX;if(this._stepY)if(0>this._offsetY)for(;this._offsetY<-.5*this._stepY;)this._offsetY+=this._stepY;else for(;this._offsetY>=.5*this._stepY;)this._offsetY-=this._stepY}this._graphicOriginY=
this._graphicOriginX=0;if(null!=g){const [,a,b]=g.split("/");f=parseFloat(a);this._graphicOriginX=512*-parseFloat(b);this._graphicOriginY=512*f;this._testInsidePolygon=!0}this._internalPlacement=new C.Placement;this._calculateMinMax(d);this._geometry=d}}var c=h.prototype;c.next=function(){return this._geometry?this._nextInside():null};c._buildRandomValues=function(){if(!h._randValues){h._randValues=[];for(let d=0;24>d;d++)for(let f=0;24>f;f++)h._randValues.push(this._randomLCG.getFloat()),h._randValues.push(this._randomLCG.getFloat())}};
c._calculateMinMax=function(d){this._yMax=this._yMin=this._xMax=this._xMin=0;let f;let k,g,e,a,b,l,q,n;k=g=q=b=Number.MAX_VALUE;e=a=n=l=-Number.MAX_VALUE;var v=1!==this._cosAngle;let B=0;for(var z of d.rings){var p=z?z.length:0;for(var r=0;r<p;r++){var D=z[r][0];var J=z[r][1];var K=D-this._graphicOriginX-this._offsetX;f=J-this._graphicOriginY-this._offsetY;if(v){var F=this._cosAngle*K-this._sinAngle*f;K=this._sinAngle*K+this._cosAngle*f}else F=K,K=f;k=Math.min(k,F);e=Math.max(e,F);g=Math.min(g,K);
a=Math.max(a,K);b=Math.min(b,J);l=Math.max(l,J);q=Math.min(q,D);n=Math.max(n,D);B++}}b=b!==Number.MAX_VALUE?b:-512-this._stepY;l=l!==-Number.MAX_VALUE?l:this._stepY;q=q!==Number.MAX_VALUE?q:-this._stepX;n=n!==-Number.MAX_VALUE?n:512+this._stepX;F=l-b;J=n-q;this._polygonMin=(this._verticalSubdivision=F>=J)?b:q;if(this._testInsidePolygon){D=0-this._graphicOriginX-this._offsetX-this._stepX;z=512-this._graphicOriginX-this._offsetX+this._stepX;p=-512-this._graphicOriginY-this._offsetY-this._stepY;r=0-
this._graphicOriginY-this._offsetY+this._stepY;if(v){v=[[D,p],[D,r],[z,p],[z,r]];D=p=Number.MAX_VALUE;z=r=-Number.MAX_VALUE;for(const A of v)v=this._cosAngle*A[0]-this._sinAngle*A[1],K=this._sinAngle*A[0]+this._cosAngle*A[1],D=Math.min(D,v),z=Math.max(z,v),p=Math.min(p,K),r=Math.max(r,K)}k=k!==Number.MAX_VALUE?Math.max(k,D):D;g=g!==Number.MAX_VALUE?Math.max(g,p):p;e=e!==-Number.MAX_VALUE?Math.min(e,z):z;a=a!==-Number.MAX_VALUE?Math.min(a,r):r}this._xMin=Math.round(k/this._stepX);this._xMax=Math.round(e/
this._stepX);this._yMin=Math.round(g/this._stepY);this._yMax=Math.round(a/this._stepY);this._currentX=this._xMax+1;this._currentY=this._yMin-1;this._testInsidePolygon&&12<B&&(25<F||25<J)&&this._buildAccelerationMap(d,q,n,b,l)};c._buildAccelerationMap=function(d,f,k,g,e){({rings:d}=d);const a=new Map,b=this._verticalSubdivision;k=b?e-g:k-f;e=Math.ceil(k/10);if(!(1>=e)){k=Math.floor(k/e);e++;this._delta=k;if(b){e=-512-this._stepY;var l=this._stepY}else e=-this._stepX,l=512+this._stepX,g=f;for(let z=
0;z<d.length;z++)if(f=d[z],!(2>f.length))for(let p=1;p<f.length;p++){var q=f[p-1];var n=f[p];if(b){if(q[1]===n[1]||q[1]<e&&n[1]<e||q[1]>l&&n[1]>l)continue;var v=Math.min(q[1],n[1]);q=Math.max(q[1],n[1])}else{if(q[0]===n[0]||q[0]<e&&n[0]<e||q[0]>l&&n[0]>l)continue;v=Math.min(q[0],n[0]);q=Math.max(q[0],n[0])}for(;v<q;){var B=Math.floor((v-g)/k);y(B,z,p,a);v+=k}v=Math.floor((q-g)/k);v>B&&y(v,z,p,a)}this._accelerationMap=a}};c._nextInside=function(){for(;;){if(this._currentX>this._xMax){this._currentY++;
if(this._currentY>this._yMax)return null;this._currentX=this._xMin;this._shiftOddRows&&this._currentY%2&&this._currentX--}var d=this._currentX*this._stepX+this._offsetX;this._shiftOddRows&&this._currentY%2&&(d+=.5*this._stepX);const f=this._currentY*this._stepY+this._offsetY;this._currentX++;let k;if(this._gridType===w.PlacementGridType.Random){const g=(this._currentX%24+24)%24,e=(this._currentY%24+24)%24;k=this._graphicOriginX+d+this._stepX*this._randomness*(.5-h._randValues[24*e+g])*2/3;d=this._graphicOriginY+
f+this._stepY*this._randomness*(.5-h._randValues[24*e+g+1])*2/3}else k=this._graphicOriginX+this._cosAngle*d+this._sinAngle*f,d=this._graphicOriginY-this._sinAngle*d+this._cosAngle*f;if(!this._testInsidePolygon||this._isInsidePolygon(k,d,this._geometry))return this._internalPlacement.setTranslate(k,d),this._internalPlacement}};c._isInsidePolygon=function(d,f,k){var {rings:g}=k;if(t.isNone(this._accelerationMap)){var {rings:e}=k;g=0;for(var a of e){e=a.length;for(var b=1;b<e;++b){k=a[b-1];var l=a[b];
k[1]>f!==l[1]>f&&(0<(l[0]-k[0])*(f-k[1])-(l[1]-k[1])*(d-k[0])?g++:g--)}}return 0!==g}a=this._verticalSubdivision;l=this._accelerationMap.get(Math.floor(((a?f:d)-this._polygonMin)/this._delta));if(!l)return!1;k=0;for(e of l){l=e[0];const q=g[l];b=e[1];l=q[b-1];b=q[b];if(a){if(l[1]>f===b[1]>f)continue;l=(b[0]-l[0])*(f-l[1])-(b[1]-l[1])*(d-l[0])}else{if(l[0]>d===b[0]>d)continue;l=(b[1]-l[1])*(d-l[0])-(b[0]-l[0])*(f-l[1])}0<l?k++:k--}return 0!==k};return h}();u.PlacementInsidePolygon=x;Object.defineProperty(u,
Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/placements/PlacementOnLine":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper","../enums"],function(u,t,H,C,w){let y=function(){function m(){}m.local=function(){null===m.instance&&(m.instance=new m);return m.instance};m.prototype.execute=function(h,c,d,f,k){return new x(h,c,d)};return m}();y.instance=null;let x=function(m){function h(d,f,k){d=m.call(this,d,!0,!0)||this;d._curveHelper=new C.CurveHelper;
d._angleToLine=void 0!==f.angleToLine?f.angleToLine:!0;d._offset=void 0!==f.offset?f.offset*k:0;d._relativeTo=f.relativeTo;d._position=void 0!==f.startPointOffset?f.startPointOffset*k:0;d._epsilon=.001*k;return d}t._inheritsLoose(h,m);var c=h.prototype;c.processPath=function(d){var f=this._position;if(this._relativeTo===w.PlacementOnLineRelativeTo.SegmentMidpoint){this.iteratePath||(this._segmentCount=d.length,this._curSegment=1,this.iteratePath=!0);for(;this._curSegment<this._segmentCount;){var k=
this._curSegment;this._curSegment++;f=d[k-1];k=d[k];const g=this._curveHelper.calculateLength(f,k);if(g<this._epsilon)continue;d=.5+this._position/g;const [e,a]=this._curveHelper.getAngleCS(f,k,d);d=H.getCoord2D(f,k,d);this.internalPlacement.setTranslate(d[0]-this._offset*a,d[1]+this._offset*e);this._angleToLine&&this.internalPlacement.setRotateCS(e,a);return this.internalPlacement}this.iteratePath=!1;return null}this._relativeTo===w.PlacementOnLineRelativeTo.LineEnd&&H.reversePath(d);f=this.onLine(d,
f);this._relativeTo===w.PlacementOnLineRelativeTo.LineEnd&&H.reversePath(d);return f};c.onLine=function(d,f){let k,g=!1;switch(this._relativeTo){default:k=this._curveHelper.calculatePathLength(d)/2+f;break;case w.PlacementOnLineRelativeTo.LineBeginning:k=f;break;case w.PlacementOnLineRelativeTo.LineEnd:k=f,g=!0}const e=d.length;let a=0,b=d[0];for(let l=1;l<e;++l){f=b;b=d[l];const q=this._curveHelper.calculateLength(f,b);if(a+q>k){d=(k-a)/q;const [n,v]=this._curveHelper.getAngleCS(f,b,d);d=H.getCoord2D(f,
b,d);f=g?-this._offset:this._offset;this.internalPlacement.setTranslate(d[0]-f*v,d[1]+f*n);this._angleToLine&&(g?this.internalPlacement.setRotateCS(-n,-v):this.internalPlacement.setRotateCS(n,v));return this.internalPlacement}a+=q}return null};return h}(H.PathTransformationCursor);u.PlacementOnLine=y;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/placements/PlacementOnVertices":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor",
"../CurveHelper"],function(u,t,H,C){function w(m,h){const c=Math.PI;for(;Math.abs(h-m)>c+2E-15;)h=h-m>c?h-2*c:h+2*c;return(m+h)/2}let y=function(){function m(){}m.local=function(){null===m.instance&&(m.instance=new m);return m.instance};m.prototype.execute=function(h,c,d,f,k){return new x(h,c,d)};return m}();y.instance=null;let x=function(m){function h(d,f,k){d=m.call(this,d,!0,!0)||this;d._curveHelper=new C.CurveHelper;d._angleToLine=void 0!==f.angleToLine?f.angleToLine:!0;d._offset=void 0!==f.offset?
f.offset*k:0;d._endPoints=void 0!==f.placeOnEndPoints?f.placeOnEndPoints:!0;d._controlPoints=void 0!==f.placeOnControlPoints?f.placeOnControlPoints:!0;d._regularVertices=void 0!==f.placeOnRegularVertices?f.placeOnRegularVertices:!0;d._tags=[];d._tagIterator=0;return d}t._inheritsLoose(h,m);var c=h.prototype;c.processPath=function(d){this.iteratePath||(this._preparePath(d),this.iteratePath=!0);if(this._tagIterator>=this._tags.length)return this._tagIterator=this._tags.length=0,this.iteratePath=!1,
null;d=this._tags[this._tagIterator];this._angleToLine&&this.internalPlacement.setRotate(d[2]);let f=d[0],k=d[1];if(0!==this._offset){const g=Math.cos(d[2]);f-=this._offset*Math.sin(d[2]);k+=this._offset*g}this.internalPlacement.setTranslate(f,k);this._tagIterator++;return this.internalPlacement};c._preparePath=function(d){this._tagIterator=this._tags.length=0;const f=H.isClosedPath(d),k=d.length-1;let g=0,e=0,a=0,b=0,l=0,q,n;for(;g<k;){g++;q=d[g-1];n=d[g];const v=H.getId(q),B=H.getId(n);if(this._angleToLine||
0!==this._offset)b=this._curveHelper.getAngle(q,n,0);1===g?f?(e=b,a=v):(this._endPoints||this._controlPoints&&1===v)&&this._tags.push([q[0],q[1],b]):1===v?this._controlPoints&&this._tags.push([q[0],q[1],w(l,b)]):this._regularVertices&&this._tags.push([q[0],q[1],w(l,b)]);if(this._angleToLine||0!==this._offset)l=this._curveHelper.getAngle(q,n,1);g===k&&(f?1===B||1===a?this._controlPoints&&this._tags.push([n[0],n[1],w(l,e)]):this._regularVertices&&this._tags.push([n[0],n[1],w(l,e)]):(this._endPoints||
this._controlPoints&&1===B)&&this._tags.push([n[0],n[1],l]))}this._tagIterator=0};return h}(H.PathTransformationCursor);u.PlacementOnVertices=y;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/placements/PlacementPolygonCenter":function(){define("exports ../../../core/has ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/centroid ../../../geometry/support/labelPoint ../CIMPlacements ../enums".split(" "),function(u,
t,H,C,w,y,x,m){let h=function(){function d(){}d.local=function(){null===d.instance&&(d.instance=new d);return d.instance};d.prototype.execute=function(f,k,g,e,a){return new c(f,k,g)};return d}();h.instance=null;let c=function(){function d(k,g,e){this._geometry=k;this._offsetX=void 0!==g.offsetX?g.offsetX*e:0;this._offsetY=void 0!==g.offsetY?g.offsetY*e:0;this._method=void 0!==g.method?g.method:m.PlacementPolygonCenterMethod.OnPolygon;this._internalPlacement=new x.Placement}var f=d.prototype;f.next=
function(){const k=this._geometry;this._geometry=null;return k&&void 0!==k.rings?this._polygonCenter(k):null};f._polygonCenter=function(k){let g=!1;switch(this._method){case m.PlacementPolygonCenterMethod.CenterOfMass:if(k=w.weightedAreaCentroid(k))this._internalPlacement.setTranslate(k[0]+this._offsetX,k[1]+this._offsetY),g=!0;break;case m.PlacementPolygonCenterMethod.BoundingBoxCenter:const e=H.create();C.getBoundsXY(e,k);e&&(this._internalPlacement.setTranslate((e[2]+e[0])/2+this._offsetX,(e[3]+
e[1])/2+this._offsetY),g=!0);break;default:k=t("polylabel-placement-enabled")?y.getPolylabelPoint(k):y.getLabelPoint(k),null!==k&&(this._internalPlacement.setTranslate(k[0]+this._offsetX,k[1]+this._offsetY),g=!0)}return g?this._internalPlacement:null};return d}();u.PlacementPolygonCenter=h;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/labelPoint":function(){define("exports ../../core/maybe ../../core/PriorityQueue ./aaBoundingRect ./boundsUtils ./centroid ./coordsUtils ./intersectsBase".split(" "),
function(u,t,H,C,w,y,x,m){function h(a,b){var {rings:l}=b;b=0;for(const q of l){l=q.length;for(let n=1;n<l;++n){const v=q[n-1],B=q[n];v[1]>a[1]!==B[1]>a[1]&&(0<(B[0]-v[0])*(a[1]-v[1])-(B[1]-v[1])*(a[0]-v[0])?b++:b--)}}return 0!==b}function c(a,b,l){if(l&&h(a,b))return{coord:a,distance:0};l=Infinity;let q=0,n=0;const v=[0,0];({rings:b}=b);for(const B of b)if(!(2>B.length))for(b=0;b<B.length-1;b++){x.projectPointOnLine(v,a,B,b);const z=k(a,v);z<l&&(l=z,q=v[0],n=v[1])}return{coord:[q,n],distance:Math.sqrt(l)}}
function d(a,b,l,q){l=[b,0];let n=Infinity,v=Infinity,B=!1,z=!1;b=[[b,q[1]-1],[b,q[3]+1]];q=[0,0];const p=[0,0],r=[0,0],D=[[0,0],[0,0]],J=C.create();({rings:a}=a);for(const I of a)if(!(2>I.length))for(a=1;a<I.length;a++){D[0][0]=I[a-1][0];D[0][1]=I[a-1][1];D[1][0]=I[a][0];D[1][1]=I[a][1];a:{var K=J;var F=D;if(2>F.length){K=null;break a}K||(K=C.create());const [G,E]=F[0],[M,T]=F[1];K[0]=Math.min(G,M);K[1]=Math.min(E,T);K[2]=Math.max(G,M);K[3]=Math.max(E,T)}if(null!==K){p[0]=b[0][0];p[1]=b[0][1];r[0]=
b[1][0];r[1]=b[1][1];a:{K=J;F=p;var A=r;let G=f(F,K),E=f(A,K);const M=K[0],T=K[1],Y=K[2],fa=K[3];if(G&E){K=0;break a}if(!(G|E)){K=4;break a}const ba=(G?1:0)|(E?2:0);do{const U=A[0]-F[0],P=A[1]-F[1];if(U>P)G&3?(G&1?(F[1]+=P*(M-F[0])/U,F[0]=M):(F[1]+=P*(Y-F[0])/U,F[0]=Y),G=f(F,K)):E&3?(E&1?(A[1]+=P*(M-A[0])/U,A[0]=M):(A[1]+=P*(Y-A[0])/U,A[0]=Y),E=f(A,K)):G?(G&4?(F[0]+=U*(T-F[1])/P,F[1]=T):(F[0]+=U*(fa-F[1])/P,F[1]=fa),G=f(F,K)):(E&4?(A[0]+=U*(T-A[1])/P,A[1]=T):(A[0]+=U*(fa-A[1])/P,A[1]=fa),E=f(A,K));
else if(G&12?(G&4?(F[0]+=U*(T-F[1])/P,F[1]=T):(F[0]+=U*(fa-F[1])/P,F[1]=fa),G=f(F,K)):E&12?(E&4?(A[0]+=U*(T-A[1])/P,A[1]=T):(A[0]+=U*(fa-A[1])/P,A[1]=fa),E=f(A,K)):G?(G&1?(F[1]+=P*(M-F[0])/U,F[0]=M):(F[1]+=P*(Y-F[0])/U,F[0]=Y),G=f(F,K)):(E&1?(A[1]+=P*(M-A[0])/U,A[0]=M):(A[1]+=P*(Y-A[0])/U,A[0]=Y),E=f(A,K)),G&E){K=0;break a}}while(G|E);K=ba}0!==K&&m.segmentIntersects(b[0],b[1],D[0],D[1],q)&&(K=q[1],n>v?K<n&&(n=K,B=!0):K<v&&(v=K,z=!0))}}B&&z?l[1]=(n+v)/2:l[0]=l[1]=NaN;return l}function f(a,b){return(a[0]<
b[0]?1:0)|(a[0]>b[2]?1:0)<<1|(a[1]<b[1]?1:0)<<2|(a[1]>b[3]?1:0)<<3}function k(a,b){return(a[0]-b[0])*(a[0]-b[0])+(a[1]-b[1])*(a[1]-b[1])}function g(a,b){if(a<b)return-1;if(a>b)return 1;if(a===b)return 0;a=isNaN(a);b=isNaN(b);return a<b?-1:a>b?1:0}let e=function(a,b,l,q){this.x=a;this.y=b;this.cellSize=l;this.distancefromCellCenter=x.distanceFromPointToPolygon(a,b,q);this.maxDistanceToPolygon=this.distancefromCellCenter+this.cellSize*Math.SQRT2};u.getLabelPoint=function(a){var {rings:b}=a;if(!b||0===
b.length)return null;var l=w.getBoundsXY(C.create(),a);if(!l)return null;var q=8.8818E-14*(Math.abs(l[0])+Math.abs(l[2])+Math.abs(l[1])+Math.abs(l[3])+1),n=0,v=0;for(var B=0;B<b.length;B++){var z=x.getRingArea(b[B]);z>v&&(v=z,n=B)}if(Math.abs(v)<=2*q*q)return v=w.getPointsBounds(C.create(),b[n]),[(v[0]+v[2])/2,(v[1]+v[3])/2];var p=y.ringCentroid(b[n],!1,C.create());if(null===p)return null;if(1===b.length&&4>b[0].length)return p;v=[[NaN,NaN],[NaN,NaN],[NaN,NaN],[NaN,NaN]];B=[NaN,NaN,NaN,NaN];z=[NaN,
NaN,NaN,NaN];var r=!1,D=c(p,a,!0);0===D.distance&&(r=!0,v[0][0]=p[0],v[0][1]=p[1],D=c(p,a,!1));B[0]=D.distance;z[0]=0;var J=[NaN,NaN],K=!1;let F=.25,A=-1;b=w.getPointsBounds(C.create(),b[n]);n=NaN;do if(n=NaN,D=b[0],v[1]=d(a,D+(b[2]-D)*F,q,l),isNaN(v[1][0])||isNaN(v[1][1])||(D=c(v[1],a,!1),n=D.distance),!isNaN(n)&&n>q&&h(v[1],a))K=!0,B[1]=n,z[1]=k(v[1],p);else if(!isNaN(n)&&n>A&&(A=n,J[0]=v[1][0],J[1]=v[1][1]),F-=.01,.1>F)if(0<=A)K=!0,B[1]=A,v[1][0]=J[0],v[1][1]=J[1],z[1]=k(v[1],p);else break;while(!K);
K=!1;F=.5;A=-1;let I=.01,G=1;do if(n=NaN,D=b[0],v[2]=d(a,D+(b[2]-D)*F,q,l),isNaN(v[2][0])||isNaN(v[2][1])||(D=c(v[2],a,!1),n=D.distance),!isNaN(n)&&n>q&&h(v[2],a))K=!0,B[2]=n,z[2]=k(v[2],p);else if(!isNaN(n)&&n>A)A=n,J[0]=v[2][0],J[1]=v[2][1];else if(n>A&&(A=n,J[0]=v[2][0],J[1]=v[2][1]),F=.5+I*G,I+=.01,G*=-1,.3>F||.7<F)if(0<=A)K=!0,B[2]=A,v[2][0]=J[0],v[2][1]=J[1],z[2]=k(v[2],p);else break;while(!K);K=!1;F=.75;A=-1;do if(n=NaN,D=b[0],v[3]=d(a,D+(b[2]-D)*F,q,l),isNaN(v[3][0])||isNaN(v[3][1])||(D=c(v[3],
a,!1),n=D.distance),!isNaN(n)&&n>q&&h(v[3],a))K=!0,B[3]=n,z[3]=k(v[3],p);else if(n>A&&(A=n,J[0]=v[3][0],J[1]=v[3][1]),F+=.01,.9<F)if(0<=A)K=!0,B[3]=A,v[3][0]=J[0],v[3][1]=J[1],z[3]=k(v[3],p);else break;while(!K);a=[0,1,2,3];l=r?0:1;for(r=l;4>r;r++)for(p=l;3>p;p++)J=z[p],K=z[p+1],0<g(J,K)&&(q=a[p],a[p]=a[p+1],a[p+1]=q,z[p]=K,z[p+1]=J);z=l;for(r=q=0;4>l;l++){switch(l){case 0:r=2*B[a[l]];break;case 1:r=1.66666666*B[a[l]];break;case 2:r=1.33333333*B[a[l]];break;case 3:r=B[a[l]]}r>q&&(q=r,z=a[l])}return v[z]};
u.getPolylabelPoint=function(a){if(!a||!a.rings||0===a.rings.length)return null;var b=w.getPointsBounds(C.create(),a.rings[0]);if(!b)return null;var l=b[2]-b[0],q=b[3]-b[1];if(0===l||0===q)return[b[0]+l/2,b[1]+q/2];const n=Math.max(Math.min(l,q)/100,1),v=new H((p,r)=>r.maxDistanceToPolygon-p.maxDistanceToPolygon);q=Math.min(l,q);l=q/2;let B=0,z=0;for(B=b[0];B<b[2];B+=q)for(z=b[1];z<b[3];z+=q)v.enqueue(new e(B+l,z+l,l,a));b=y.ringsCentroid(a.rings,!1);if(null===b)return null;for(b=new e(b[0],b[1],
0,a);0<v.size;)q=t.unwrap(v.dequeue()),q.distancefromCellCenter>b.distancefromCellCenter&&(b=q),q.maxDistanceToPolygon-b.distancefromCellCenter<=n||(l=q.cellSize/2,v.enqueue(new e(q.x-l,q.y-l,l,a)),v.enqueue(new e(q.x+l,q.y-l,l,a)),v.enqueue(new e(q.x-l,q.y+l,l,a)),v.enqueue(new e(q.x+l,q.y+l,l,a)));return[b.x,b.y]};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/core/PriorityQueue":function(){define(["../chunks/_rollupPluginBabelHelpers"],function(u){const t=(H,C)=>H<C?-1:H>
C?1:0;return function(){function H(w=t){this._data=[];this._compare=w}var C=H.prototype;C.enqueue=function(w){if(null!=w){var {_data:y,_compare:x}=this;y.push(w);w=y.length-1>>>0;for(var m=y[w];0<w;){const h=w-1>>1,c=y[h];if(0>=x(c,m))y[h]=m,y[w]=c,w=h;else break}}};C.dequeue=function(){const {_data:w,_compare:y}=this,x=w[0];var m=w.pop();if(0===w.length)return x;w[0]=m;m=0;const h=w.length,c=w[0];let d;let f=null;for(;;){var k=2*m+1;const g=2*m+2;f=null;k<h&&(d=w[k],0<y(d,c)&&(f=k));g<h&&(k=w[g],
null===f&&0>=y(k,c)||null!==f&&0>=y(k,d))&&(f=g);if(null===f)break;w[m]=w[f];w[f]=c;m=f}return x};u._createClass(H,[{key:"size",get:function(){return this._data.length}}]);return H}()})},"esri/views/2d/engine/webgl/mesh/templates/shapingUtils":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2 ../../../../../../chunks/vec2f32 ../../alignmentUtils ../../number ../../Rect ../../collisions/BoundingBox".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d){function f(b,l){b.forEach(q=>y.transformMat2d(q,q,l));return{upperLeft:h.i1616to32(8*b[0][0],8*b[0][1]),upperRight:h.i1616to32(8*b[1][0],8*b[1][1]),lowerLeft:h.i1616to32(8*b[2][0],8*b[2][1]),lowerRight:h.i1616to32(8*b[3][0],8*b[3][1])}}const k=Math.PI/180;let g=function(){function b(q,n,v,B){this._rotationT=w.create();this.minZoom=this._yBounds=this._xBounds=0;this.maxZoom=255;this._bounds=null;const z=v.rect,p=new Float32Array(8);q*=B;n*=B;const r=v.code?z.width*B:
v.metrics.width,D=v.code?z.height*B:v.metrics.height;this.width=r;this.height=D;p[0]=q;p[1]=n;p[2]=q+r;p[3]=n;p[4]=q;p[5]=n+D;p[6]=q+r;p[7]=n+D;this._data=p;this._setTextureCoords(z);this._scale=B;this._mosaic=v;this.x=q;this.y=n;this.maxOffset=Math.max(q+r,n+D)}var l=b.prototype;l.setTransform=function(q){this._transform=q;this._offsets=null};l._setOffsets=function(q){this._offsets||(this._offsets={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0});const n=this._offsets,v=new Float32Array(8),B=
C.multiply(w.create(),this._rotationT,this._transform);w.transformMany(v,q,B);n.upperLeft=h.i1616to32(8*v[0],8*v[1]);n.upperRight=h.i1616to32(8*v[2],8*v[3]);n.lowerLeft=h.i1616to32(8*v[4],8*v[5]);n.lowerRight=h.i1616to32(8*v[6],8*v[7])};l._setTextureCoords=function({x:q,y:n,width:v,height:B}){this._texcoords={upperLeft:h.i1616to32(q,n),upperRight:h.i1616to32(q+v,n),lowerLeft:h.i1616to32(q,n+B),lowerRight:h.i1616to32(q+v,n+B)}};t._createClass(b,[{key:"mosaic",get:function(){return this._mosaic}},{key:"angle",
get:function(){return this._angle},set:function(q){this._angle=q;C.fromRotation(this._rotationT,-q);this._setOffsets(this._data)}},{key:"xTopLeft",get:function(){return this._data[0]}},{key:"yTopLeft",get:function(){return this._data[1]}},{key:"xBottomRight",get:function(){return this._data[6]}},{key:"yBottomRight",get:function(){return this._data[7]}},{key:"texcoords",get:function(){return this._texcoords}},{key:"textureBinding",get:function(){return this._mosaic.textureBinding}},{key:"offsets",
get:function(){this._offsets||this._setOffsets(this._data);return this._offsets}},{key:"char",get:function(){return String.fromCharCode(this._mosaic.code)}},{key:"code",get:function(){return this._mosaic.code}},{key:"bounds",get:function(){if(!this._bounds){const {height:z,width:p}=this._mosaic.metrics;var q=p*this._scale,n=Math.abs(z)*this._scale,v=new Float32Array(8);v[0]=this.x;v[1]=this.y;v[2]=this.x+q;v[3]=this.y;v[4]=this.x;v[5]=this.y+n;v[6]=this.x+q;v[7]=this.y+n;q=C.multiply(w.create(),this._rotationT,
this._transform);w.transformMany(v,v,q);n=q=Infinity;let r=0;var B=0;for(let D=0;4>D;D++){const J=v[2*D],K=v[2*D+1];q=Math.min(q,J);n=Math.min(n,K);r=Math.max(r,J);B=Math.max(B,K)}v=r-q;B-=n;this._bounds=new d(q+v/2,n+B/2,v,B)}return this._bounds}}]);return b}(),e=function(){function b(q,n,v){this._rotation=0;this._decorate(q,n,v);this.glyphs=q;this.bounds=this._createBounds(q);this.isMultiline=1<n.length;this._hasRotation=0!==v.angle;this._transform=this._createGlyphTransform(this.bounds,v);if((this._borderLineSize=
v.borderLineSize)||v.hasBackground)[this.bounds,this.background]=this.shapeBackground(this._transform);for(const B of q)B.setTransform(this._transform)}var l=b.prototype;l.setRotation=function(q){if(0!==q||0!==this._rotation){this._rotation=q;var n=this._transform;q=C.fromRotation(w.create(),q);C.multiply(n,q,n);for(const v of this.glyphs)v.setTransform(this._transform)}};l._decorate=function(q,n,v){if(v.decoration&&"none"!==v.decoration&&q.length){var B=v.scale;v="underline"===v.decoration?30:20;
var z=q[0].textureBinding;for(const J of n){const K=J.startX*B,F=J.startY*B;n=q;var p=n.push;var r=(J.width+J.glyphWidthEnd)*B;var D=z;r={code:0,page:0,sdf:!0,rect:new c(0,0,11,8),textureBinding:D,metrics:{advance:0,height:4,width:r,left:0,top:0}};p.call(n,new g(K,F+v*B,r,1))}}};l.shapeBackground=function(q){const n=(1.5+H.pt2px(this._borderLineSize||0))/2;var v=this._borderLineSize?n:0;const {xmin:B,ymin:z,xmax:p,ymax:r,x:D,y:J,width:K,height:F}=this.bounds,A=[B-8,z-8],I=[p+8,z-8],G=[B-8,r+8],E=
[p+8,r+8],M=f([[A[0]-n,A[1]-n],[I[0]+n,I[1]-n],[A[0]+v,A[1]+v],[I[0]-v,I[1]+v]],q),T=f([[G[0]+v,G[1]-v],[E[0]-v,E[1]-v],[G[0]-n,G[1]+n],[E[0]+n,E[1]+n]],q),Y=f([[A[0]-n,A[1]-n],[A[0]+v,A[1]+v],[G[0]-n,G[1]+n],[G[0]+v,G[1]-v]],q);v=f([[I[0]-v,I[1]+v],[I[0]+n,I[1]-n],[E[0]-v,E[1]-v],[E[0]+n,E[1]+n]],q);q={main:f([A,I,G,E],q),top:M,bot:T,left:Y,right:v};return[new d(D,J,K+2*n,F+2*n),q]};l._createBounds=function(q){let n=Infinity,v=Infinity,B=0;var z=0;for(const p of q)n=Math.min(n,p.xTopLeft),v=Math.min(v,
p.yTopLeft),B=Math.max(B,p.xBottomRight),z=Math.max(z,p.yBottomRight);q=B-n;z-=v;return new d(n+q/2,v+z/2,q,z)};l._createGlyphTransform=function(q,n){const v=k*n.angle,B=w.create(),z=x.create();C.translate(B,B,y.set(z,n.xOffset,-n.yOffset));n.isCIM?C.rotate(B,B,v):(C.translate(B,B,y.set(z,q.x,q.y)),C.rotate(B,B,v),C.translate(B,B,y.set(z,-q.x,-q.y)));return B};t._createClass(b,[{key:"boundsT",get:function(){var q=this.bounds;const n=y.set(x.create(),q.x,q.y);y.transformMat2d(n,n,this._transform);
return this._hasRotation?(q=Math.max(q.width,q.height),new d(n[0],n[1],q,q)):new d(n[0],n[1],q.width,q.height)}}]);return b}(),a=function(b,l,q,n,v,B){this.startY=this.startX=this.glyphWidthEnd=0;this.start=Math.max(0,Math.min(l,q));this.end=Math.max(0,Math.max(l,q));this.end<b.length&&(this.glyphWidthEnd=b[this.end].metrics.width);this.width=n;this.yMin=v;this.yMax=B};u.ShapedGlyph=g;u.ShapingInfo=e;u.shapeGlyphs=function(b,l,q){const n=q.scale,v=[],B=[];var z=1/q.scale*q.maxLineWidth;var p=l?b.length-
1:0,r=l?-1:b.length;l=l?-1:1;var D=p,J=0,K=0;let F=D,A=F,I=0,G=Infinity,E=0;for(;D!==r;){const {code:fa,metrics:ba}=b[D];var M=Math.abs(ba.top);10!==fa&&32!==fa&&(G=Math.min(G,M),E=Math.max(E,M+ba.height));10===fa?(D!==p&&(B.push(new a(b,F,D-l,J,G,E)),G=Infinity,E=0),J=0,F=D+l,A=D+l,K=0):32===fa?(A=D+l,K=0,I=ba.advance,J+=ba.advance):(J>z&&(A!==F?(M=A-2*l,J-=I,B.push(new a(b,F,M,J-K,G,E)),G=Infinity,E=0,F=A,J=K):(B.push(new a(b,F,D-l,J,G,E)),G=Infinity,E=0,A=F=D,J=0)),J+=ba.advance,K+=ba.advance);
D+=l}z=new a(b,F,D-l,J,G,E);0<=z.start&&z.end<b.length&&B.push(z);for(z=0;z<B.length;z++);p=B[0].yMin;z=B[B.length-1].yMax+q.lineHeight*(B.length-1)+("underline"===q.decoration?4:0)-p;const {vAlign:T,hAlign:Y}=q;r=T===m.VAlign.Baseline?1:0;z=(1-r)*-p+z/2*(r?0:T-1)+-26*(r?1:0);for(p=0;p<B.length;p++){const {start:fa,end:ba,width:U}=B[p];r=U/2*(Y+1)*-1-3;l=p*q.lineHeight+z-3;B[p].startX=r;B[p].startY=l;for(D=fa;D<=ba;D++)J=b[D],10!==J.code&&(K=new g(r+J.metrics.left,l-J.metrics.top,J,n),r+=J.metrics.advance,
v.push(K))}return new e(v,B,q)};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/vec2f32":function(){define(["exports"],function(u){function t(){return new Float32Array(2)}function H(e){const a=new Float32Array(2);a[0]=e[0];a[1]=e[1];return a}function C(e,a){const b=new Float32Array(2);b[0]=e;b[1]=a;return b}function w(e,a){return new Float32Array(e,a,2)}function y(){return t()}function x(){return C(1,1)}function m(){return C(1,0)}function h(){return C(0,1)}const c=t(),
d=x(),f=m(),k=h(),g=Object.freeze(Object.defineProperty({__proto__:null,ONES:d,UNIT_X:f,UNIT_Y:k,ZEROS:c,clone:H,create:t,createView:w,fromValues:C,ones:x,unitX:m,unitY:h,zeros:y},Symbol.toStringTag,{value:"Module"}));u.ONES=d;u.UNIT_X=f;u.UNIT_Y=k;u.ZEROS=c;u.clone=H;u.create=t;u.createView=w;u.fromValues=C;u.ones=x;u.unitX=m;u.unitY=h;u.vec2f32=g;u.zeros=y})},"esri/views/2d/engine/webgl/collisions/BoundingBox":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../../../../../chunks/vec2f32"],
function(u,t){return function(){function H(w,y,x,m){this.center=t.fromValues(w,y);this.centerT=t.create();this.halfWidth=x/2;this.halfHeight=m/2;this.width=x;this.height=m}var C=H.prototype;C.clone=function(){return new H(this.x,this.y,this.width,this.height)};C.serialize=function(w){w.writeF32(this.center[0]);w.writeF32(this.center[1]);w.push(this.width);w.push(this.height);return w};C.findCollisionDelta=function(w,y=4){return Math.log2(Math.min((w.halfWidth+this.halfWidth+y)/Math.abs(w.centerT[0]-
this.centerT[0]),(w.halfHeight+this.halfHeight+y)/Math.abs(w.centerT[1]-this.centerT[1])))};C.extend=function(w){const y=Math.min(this.xmin,w.xmin),x=Math.min(this.ymin,w.ymin),m=Math.max(this.xmax,w.xmax)-y;w=Math.max(this.ymax,w.ymax)-x;this.width=m;this.height=w;this.halfWidth=m/2;this.halfHeight=w/2;this.x=y+m/2;this.y=x+w/2};H.deserialize=function(w){const y=w.readF32(),x=w.readF32(),m=w.readInt32();w=w.readInt32();return new H(y,x,m,w)};u._createClass(H,[{key:"x",get:function(){return this.center[0]},
set:function(w){this.center[0]=w}},{key:"y",get:function(){return this.center[1]},set:function(w){this.center[1]=w}},{key:"blX",get:function(){return this.center[0]+this.halfWidth}},{key:"blY",get:function(){return this.center[1]+this.halfHeight}},{key:"trX",get:function(){return this.center[0]-this.halfWidth}},{key:"trY",get:function(){return this.center[1]-this.halfHeight}},{key:"xmin",get:function(){return this.x-this.halfWidth}},{key:"xmax",get:function(){return this.x+this.halfWidth}},{key:"ymin",
get:function(){return this.y-this.halfHeight}},{key:"ymax",get:function(){return this.y+this.halfHeight}}]);return H}()})},"esri/views/2d/engine/webgl/mesh/templates/WGLMeshTemplate":function(){define(["../../../../../../core/maybe","../../../../../../symbols/cim/effects/CIMEffectHelper"],function(u,t){return function(){function H(){this._materialKey=null}var C=H.prototype;C.bindFeature=function(w,y,x){};C.write=function(w,y,x,m){if(u.isNone(this._effects)||0===this._effects?.length)return this._write(w,
y,m);x=t.CIMEffectHelper.executeEffects(this._effects,y.readLegacyGeometryForDisplay(),w.tileKey,m.geometryEngine);let h=t.CIMEffectHelper.next(x);for(;h;)this._write(w,y,m,h),h=t.CIMEffectHelper.next(x)};C._write=function(w,y,x,m){};return H}()})},"esri/symbols/cim/effects/CIMEffectHelper":function(){define(["exports","../../../geometry/support/jsonUtils","../CIMCursor","../CIMEffects","../CIMOperators"],function(u,t,H,C,w){const y=96/72;let x=function(){function m(){}m.executeEffects=function(h,
c,d,f){c=H.cloneAndDecodeGeometry(c);c=new C.SimpleGeometryCursor(c);for(const k of h)(h=w.getEffectOperator(k))&&(c=h.execute(c,k,y,d,f));return c};m.next=function(h){h=h.next();H.deltaEncodeGeometry(h);return h};m.applyEffects=function(h,c,d){if(!h)return c;c=new C.SimpleGeometryCursor(c);for(var f of h)(h=w.getEffectOperator(f))&&(c=h.execute(c,f,1,null,d));for(d=null;f=c.next();)d?t.isPolyline(d)?t.isPolyline(f)&&d.paths.push(...f.paths):t.isPolygon(d)&&t.isPolygon(f)&&d.rings.push(...f.rings):
d=f;return d};return m}();u.CIMEffectHelper=x;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/WGLMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLMeshTemplate".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f,k,g){return function(e){function a(b,l,q,n,v,B,z,p,r,D,J,K,F,A,I,G,E,M,T,Y,fa,ba,U){var P=e.call(this)||this;P.angle=n;P.height=z;P.width=B;P.xOffset=l*T;P.yOffset=q*T;P._markerPlacement=Y;P._effects=fa;P._anchorX=G;P._anchorY=E;P._minMaxZoom=c.i1616to32(Math.round(ba*m.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(U*m.MIN_MAX_ZOOM_PRECISION_FACTOR));l=(A===y.Alignment.MAP?m.BITSET_MARKER_ALIGNMENT_MAP:m.BITSET_MARKER_ALIGNMENT_SCREEN)|(J?m.BITSET_GENERIC_LOCK_COLOR:0)|
(F?m.BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE:0)|(K?m.BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY:0);q=I&&I.sdf;b=d.MarkerMaterialKey.load(b);b.sdf=q;b.pattern=!0;b.textureBinding=I.textureBinding;P._materialKey=b.data;P._fillColor=v;P._outlineColor=r;P._sizeOutlineWidth=c.i8888to32(Math.round(Math.min(Math.sqrt(128*B),255)),Math.round(Math.min(Math.sqrt(128*z),255)),Math.round(Math.min(Math.sqrt(128*D),255)),Math.round(Math.min(Math.sqrt(128*p),255)));v=I.rect.x+m.SPRITE_PADDING;p=I.rect.y+m.SPRITE_PADDING;
r=v+I.width;I=p+I.height;P._offsets.xUpperLeft=v;P._offsets.yUpperLeft=p;P._offsets.xUpperRight=r;P._offsets.yUpperRight=p;P._offsets.xBottomLeft=v;P._offsets.yBottomLeft=I;P._offsets.xBottomRight=r;P._offsets.yBottomRight=I;b.symbologyType===h.WGLSymbologyType.PIE_CHART?(P._texUpperLeft=c.i1616to32(0,1),P._texUpperRight=c.i1616to32(1,1),P._texBottomLeft=c.i1616to32(0,0),P._texBottomRight=c.i1616to32(1,0)):(P._texUpperLeft=c.i1616to32(v,p),P._texUpperRight=c.i1616to32(r,p),P._texBottomLeft=c.i1616to32(v,
I),P._texBottomRight=c.i1616to32(r,I));B=B*M*T;z=z*M*T;P._bitestAndDistRatio=c.i1616to32(l,Math.round(64*M));P._computedWidth=B;P._computedHeight=z;B=w.create();z=C.create();P._applyTransformation(z,B);return P}u._inheritsLoose(a,e);a.fromCIMMarker=function(b,l,q){const n=b.size,v=(l&&l.width||1)/(l&&l.height||1)*b.scaleX;var B=b.scaleSymbolsProportionally&&b.frameHeight?n/b.frameHeight:1;const z=x.premultiplyAlphaRGBA(b.color),p=x.premultiplyAlphaRGBA(b.outlineColor),r=H.pt2px(n),D=r*v,J=H.pt2px(b.offsetX||
0),K=H.pt2px(b.offsetY||0);B*=H.pt2px(b.outlineWidth||0);const F=b.alignment||y.Alignment.SCREEN,A=H.pt2px(b.referenceSize),[I,G]=f.getMinMaxZoom(b.scaleInfo,q);q=b.rotation||0;b.rotateClockwise||(q=-q);let E=0,M=0;const T=b.anchorPoint;T&&(b.isAbsoluteAnchorPoint?n&&(E=T.x/(n*v),M=T.y/n):(E=T.x,M=T.y));l=new a(b.materialKey,J,K,q,z,D,r,A,p,B,b.colorLocked,b.scaleSymbolsProportionally,!1,F,l,E,M,b.sizeRatio,t.unwrapOr(b.scaleFactor,1),b.markerPlacement,b.effects,I,G);l._vertexBoundsScaleX=b.maxVVSize?
b.maxVVSize/D:1;l._vertexBoundsScaleY=b.maxVVSize?b.maxVVSize/r:1;return l};a.fromPictureMarker=function(b,l){const q=Math.round(H.pt2px(b.width)),n=Math.round(H.pt2px(b.height)),v=m.PICTURE_FILL_COLOR,B=Math.round(H.pt2px(b.xoffset||0)),z=Math.round(H.pt2px(b.yoffset||0));l=new a(b.materialKey,B,z,b.angle,v,q,n,n,0,0,!1,!1,!1,y.Alignment.SCREEN,l,0,0,1,1,null,null,f.DEFAULT_MIN_ZOOM,f.DEFAULT_MAX_ZOOM);l._vertexBoundsScaleX=b.maxVVSize?b.maxVVSize/b.width:1;l._vertexBoundsScaleY=b.maxVVSize?b.maxVVSize/
b.height:1;return l};a.fromSimpleMarker=function(b,l){const q=x.premultiplyAlphaRGBAArray(b.color),n=Math.round(H.pt2px(b.size)),v=Math.round(H.pt2px(b.xoffset||0)),B=Math.round(H.pt2px(b.yoffset||0)),z=b.style;var p=b.outline;const r=(p?.color&&x.premultiplyAlphaRGBAArray(p.color))|0;p=(p?.width&&Math.round(H.pt2px(p.width)))|0;l=new a(b.materialKey,v,B,b.angle,q,n,n,n,r,p,!1,!1,"esriSMSCross"===z||"esriSMSX"===z,y.Alignment.SCREEN,l,0,0,1.96875,1,null,null,f.DEFAULT_MIN_ZOOM,f.DEFAULT_MAX_ZOOM);
l.boundsType="esriSMSCircle"===z?"circle":"square";l._vertexBoundsScaleX=b.maxVVSize?b.maxVVSize/b.size:1;l._vertexBoundsScaleY=b.maxVVSize?b.maxVVSize/b.size:1;return l};a.fromLineSymbolMarker=function(b,l){const q=x.premultiplyAlphaRGBAArray(b.color),n=Math.round(H.pt2px(6*b.lineWidth)),v="cross"===b.style||"x"===b.style;switch(b.placement){case "begin-end":var B=y.ExtremityPlacement.Both;break;case "begin":B=y.ExtremityPlacement.JustBegin;break;case "end":B=y.ExtremityPlacement.JustEnd;break;default:B=
y.ExtremityPlacement.None}B={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:B,offsetAlongLine:0};l=new a(b.materialKey,0,0,0,q,n,n,n/6,q,v?Math.round(H.pt2px(b.lineWidth)):0,!1,!1,v,y.Alignment.MAP,l,0,0,1.96875,1,B,null,f.DEFAULT_MIN_ZOOM,f.DEFAULT_MAX_ZOOM);l.boundsType="circle"===b.style?"circle":"square";return l};return a}(k(g))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2 ../../../../../../chunks/vec2f32 ../../../../../../layers/graphics/featureConversionUtils ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper ../../definitions ../../enums ../../number ../../materialKey/MaterialKey".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f,k){const g=3.14159265359/180;return e=>function(a){function b(...q){q=a.call(this,...q)||this;q.angle=0;q.xOffset=0;q.yOffset=0;q.width=0;q.height=0;q.boundsType="square";q._anchorX=0;q._anchorY=0;q._computedWidth=0;q._computedHeight=0;q._allowBorrowing=!0;q._vertexBoundsScaleX=1;q._vertexBoundsScaleY=1;q._offsets={xUpperLeft:0,yUpperLeft:0,xUpperRight:0,yUpperRight:0,xBottomLeft:0,yBottomLeft:0,xBottomRight:0,yBottomRight:0};q.geometryType=d.WGLGeometryType.MARKER;
return q}u._inheritsLoose(b,a);var l=b.prototype;l._write=function(q,n,v,B){const z=n.getDisplayId();q.recordStart(z,this._materialKey,this.geometryType,!0);this._writeGeometry(q,n,z,v,B);q.recordEnd()};l._writeGeometry=function(q,n,v,B,z){if(t.isSome(this._markerPlacement))return this._writePlacedMarkers(q,n,B,z);this._allowBorrowing=!0;if(!z&&"esriGeometryPoint"===n.geometryType)return B=n.getX(),n=n.getY(),!q.hasAggregates&&q.hasPixelBufferEnabled&&(0>B||513<=B||0>n||513<=n)?void 0:this._writeVertices(q,
v,this._getPos(B,n),B,n);n=z?m.deltaDecodeGeometry(m.convertFromGeometry(z),2):"esriGeometryPolygon"===n.geometryType?n.readCentroid():n.readGeometryForDisplay();if(!t.isNone(n)){if(n.isPoint){const [p,r]=n.coords;return!q.hasAggregates&&q.hasPixelBufferEnabled&&(0>p||512<=p||0>r||512<=r)?void 0:this._writeVertices(q,v,this._getPos(p,r),p,r)}n.forEachVertex((p,r)=>{const D=2*c.TILE_SIZE;p<-D||p>=D||r<-D||r>=D||this._writeVertices(q,v,this._getPos(p,r),p,r)})}};l._writePlacedMarkers=function(q,n,v,
B){B=B??n.readLegacyGeometryForDisplay();if(v=h.CIMMarkerPlacementHelper.getPlacement(B,t.unwrap(this._markerPlacement),H.pt2px(1),q.tileKey,v.geometryEngine)){this._allowBorrowing="esriGeometryPolygon"===n.geometryType?!1:!0;n=n.getDisplayId();B=x.create();for(var z=w.create(),p=v.next();null!=p;){const r=p.tx,D=-p.ty;-128<=r&&640>=r&&-128<=D&&640>=D&&(this._applyTransformation(z,B,-p.getAngle()/g),this._writeVertices(q,n,this._getPos(r,D),r,D));p=v.next()}}};l._writeVertices=function(q,n,v,B,z){const p=
k.MarkerMaterialKey.load(this._materialKey);switch(p.symbologyType){case d.WGLSymbologyType.HEATMAP:return this._writeHeatmapVertices(q,n,v);default:return this._writeMarkerVertices(q,n,p,v,B,z)}};l._writeMarkerVertices=function(q,n,v,B,z,p){var r=v.vvRotation;v=q.vertexCount();let D=this._computedWidth*this._vertexBoundsScaleX;var J=this._computedHeight*this._vertexBoundsScaleY;this.angle&&(D=J=Math.max(D,J));r&&(r=Math.max(this.xOffset,this.yOffset),D+=r,J+=r);this._allowBorrowing&&q.vertexBounds(z+
this.xOffset,p-this.yOffset,D,J);q.vertexWrite(B);q.vertexWrite(this._offsetUpperLeft);q.vertexWrite(this._texUpperLeft);q.vertexWrite(this._bitestAndDistRatio);q.vertexWrite(n);q.vertexWrite(this._fillColor);q.vertexWrite(this._outlineColor);q.vertexWrite(this._sizeOutlineWidth);q.vertexWrite(this._minMaxZoom);q.vertexEnd();q.vertexWrite(B);q.vertexWrite(this._offsetUpperRight);q.vertexWrite(this._texUpperRight);q.vertexWrite(this._bitestAndDistRatio);q.vertexWrite(n);q.vertexWrite(this._fillColor);
q.vertexWrite(this._outlineColor);q.vertexWrite(this._sizeOutlineWidth);q.vertexWrite(this._minMaxZoom);q.vertexEnd();q.vertexWrite(B);q.vertexWrite(this._offsetBottomLeft);q.vertexWrite(this._texBottomLeft);q.vertexWrite(this._bitestAndDistRatio);q.vertexWrite(n);q.vertexWrite(this._fillColor);q.vertexWrite(this._outlineColor);q.vertexWrite(this._sizeOutlineWidth);q.vertexWrite(this._minMaxZoom);q.vertexEnd();q.vertexWrite(B);q.vertexWrite(this._offsetBottomRight);q.vertexWrite(this._texBottomRight);
q.vertexWrite(this._bitestAndDistRatio);q.vertexWrite(n);q.vertexWrite(this._fillColor);q.vertexWrite(this._outlineColor);q.vertexWrite(this._sizeOutlineWidth);q.vertexWrite(this._minMaxZoom);q.vertexEnd();this._writeIndices(q,v)};l._writeHeatmapVertices=function(q,n,v){const B=q.vertexCount();q.vertexWrite(v);q.vertexWrite(this._offsetUpperLeft);q.vertexWrite(n);q.vertexEnd();q.vertexWrite(v);q.vertexWrite(this._offsetUpperRight);q.vertexWrite(n);q.vertexEnd();q.vertexWrite(v);q.vertexWrite(this._offsetBottomLeft);
q.vertexWrite(n);q.vertexEnd();q.vertexWrite(v);q.vertexWrite(this._offsetBottomRight);q.vertexWrite(n);q.vertexEnd();this._writeIndices(q,B)};l._writeIndices=function(q,n){q.indexWrite(n+0);q.indexWrite(n+1);q.indexWrite(n+2);q.indexWrite(n+1);q.indexWrite(n+3);q.indexWrite(n+2)};l._applyTransformation=function(q,n,v=0){C.fromTranslation(q,x.fromValues(this.xOffset,-this.yOffset));null!=this.angle&&0!==this.angle+v&&C.rotate(q,q,g*(this.angle+v));v=this._computedWidth;const B=this._computedHeight,
z=-(.5+this._anchorX)*v,p=-(.5-this._anchorY)*B;y.set(n,z,p);y.transformMat2d(n,n,q);this._offsetUpperLeft=f.i1616to32(16*n[0],16*n[1]);this._offsets.xUpperLeft=n[0];this._offsets.yUpperLeft=n[1];y.set(n,z+v,p);y.transformMat2d(n,n,q);this._offsetUpperRight=f.i1616to32(16*n[0],16*n[1]);this._offsets.xUpperRight=n[0];this._offsets.yUpperRight=n[1];y.set(n,z,p+B);y.transformMat2d(n,n,q);this._offsetBottomLeft=f.i1616to32(16*n[0],16*n[1]);this._offsets.xBottomLeft=n[0];this._offsets.yBottomLeft=n[1];
y.set(n,z+v,p+B);y.transformMat2d(n,n,q);this._offsetBottomRight=f.i1616to32(16*n[0],16*n[1]);this._offsets.xBottomRight=n[0];this._offsets.yBottomRight=n[1]};l._getPos=function(q,n){return f.i1616to32(Math.round(8*q),Math.round(8*n))};return b}(e)})},"esri/views/2d/engine/webgl/mesh/templates/WGLTemplateStore":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/promiseUtils ../../../../../../symbols/support/defaultsJSON ../../enums ../../materialKey/MaterialKey ./WGLDynamicFillTemplate ./WGLDynamicLineTemplate ./WGLDynamicMarkerTemplate ./WGLDynamicTextTemplate ./WGLFillTemplate ./WGLLineTemplate ./WGLMarkerTemplate ./WGLTextTemplate ../../util/Lock ../../util/Result ../../../../layers/features/textUtils ../../../../layers/support/cimSymbolUtils".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f,k,g,e,a,b,l,q,n){function v(K,F){const A=K.length;K.push(null);F.then(I=>K[A]=I);return K}function B(K){return null!=K&&!!(K&1)}const z=C.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),p={sortKey:null,templates:[]};C={isOutline:!1,placement:null,symbologyType:x.WGLSymbologyType.DEFAULT,vvFlags:0};const r={...y.errorPointSymbolJSON,hash:JSON.stringify(y.errorPointSymbolJSON),materialKey:m.createMaterialKey(x.WGLGeometryType.MARKER,C)},D={...y.errorPolylineSymbolJSON,
hash:JSON.stringify(y.errorPolylineSymbolJSON),materialKey:m.createMaterialKey(x.WGLGeometryType.LINE,C)},J={...y.errorPolygonSymbolJSON,hash:JSON.stringify(y.errorPolygonSymbolJSON),materialKey:m.createMaterialKey(x.WGLGeometryType.FILL,C)};y=function(){function K(A,I){this._templateIdCounter=this._idCounter=1;this._idToTemplateGroup=new Map;this._symbolToTemplate=new Map;this._fetchQueue=[];this._idToResolver=new Map;this._cimTemplateCache=new Map;this._cimAnalyses=[];this._lock=new b.Lock;this._fetchResource=
A;this._tileInfo=I}var F=K.prototype;F.createTemplateGroup=function(A,I,G=null){this._initErrorTemplates();const E=A.hash;var M=this._symbolToTemplate.get(E);if(null!=M)return M;M=[];G={sortKey:G,templates:M};I&&this._createMeshTemplates(M,I,!0);this._createMeshTemplates(M,A,!1);I=this._createGroupId;if(M="expanded-cim"===A.type)a:{if(A.layers)for(const T of A.layers)if("function"===typeof T.materialHash){M=!0;break a}M=!1}A=I.call(this,M);this._idToTemplateGroup.set(A,G);this._symbolToTemplate.set(E,
A);return A};F.getTemplateGroup=function(A){return this._idToTemplateGroup.get(A)??p};F.getDynamicTemplateGroup=function(A){if(!this._idToTemplateGroup.has(A))return p;B(A)||z.error("mapview-template-store",`Id ${A} does not refer to a dynamic template`);return this._idToTemplateGroup.get(A)};F.getMosaicItem=function(A,I){const G=this._createTemplateId(),E=new Promise(M=>this._idToResolver.set(G,M));this._fetchQueue.push({symbol:A,id:G,glyphIds:I});return E};F.finalize=function(A){return this._fetchQueue.length||
this._lock.isHeld()?b.withLock(this._lock,this._fetchAllQueuedResources.bind(this),A):Promise.resolve()};F._initErrorTemplates=function(){this._errorTemplates||(this._errorTemplates={fill:this._createMeshTemplates([],J,!1),marker:this._createMeshTemplates([],r,!1),line:this._createMeshTemplates([],D,!1)})};F._fetchAllQueuedResources=function(A){if(!this._fetchQueue.length)return Promise.resolve();const I=this._fetchQueue,G=this._cimAnalyses;this._fetchQueue=[];this._cimAnalyses=[];return Promise.all(G).then(()=>
this._fetchResource(I,A).then(E=>{for(const {id:M,mosaicItem:T}of E)this._idToResolver.get(M)(T),this._idToResolver.delete(M)})).catch(E=>{w.isAbortError(E)?this._fetchQueue=this._fetchQueue.concat(I):"worker:port-closed"!==E.name&&z.error(new H("mapview-template-store","Unable to fetch requested texture resources",E))})};F._createGroupId=function(A){return this._idCounter++<<1|(A?1:0)};F._createTemplateId=function(){return this._templateIdCounter++};F._createSMS=function(){var A=t._asyncToGenerator(function*(I){const {spriteMosaicItem:G}=
yield this.getMosaicItem(I);return l.ok(G,z)?e.fromSimpleMarker(I,G):this._markerError});return function(I){return A.apply(this,arguments)}}();F._createPMS=function(){var A=t._asyncToGenerator(function*(I){const {spriteMosaicItem:G}=yield this.getMosaicItem(I);return l.ok(G,z)?e.fromPictureMarker(I,G):this._markerError});return function(I){return A.apply(this,arguments)}}();F._createSFS=function(){var A=t._asyncToGenerator(function*(I,G){const {spriteMosaicItem:E}=yield this.getMosaicItem(I);return l.ok(E,
z)?k.fromSimpleFill(I,E,G):this._fillError});return function(I,G){return A.apply(this,arguments)}}();F._createPFS=function(){var A=t._asyncToGenerator(function*(I,G){const {spriteMosaicItem:E}=yield this.getMosaicItem(I);return l.ok(E,z)?k.fromPictureFill(I,E,G):this._fillError});return function(I,G){return A.apply(this,arguments)}}();F._createSLS=function(){var A=t._asyncToGenerator(function*(I,G){({spriteMosaicItem:G}=yield this.getMosaicItem(I));return l.ok(G,z)?g.fromSimpleLine(I,G):this._lineError});
return function(I,G){return A.apply(this,arguments)}}();F._createLMS=function(){var A=t._asyncToGenerator(function*(I){const {spriteMosaicItem:G}=yield this.getMosaicItem(I);return l.ok(G,z)?e.fromLineSymbolMarker(I,G):this._markerError});return function(I){return A.apply(this,arguments)}}();F._createTS=function(){var A=t._asyncToGenerator(function*(I){const {glyphMosaicItems:G}=yield this.getMosaicItem(I);return a.fromText(I,G??[])});return function(I){return A.apply(this,arguments)}}();F._createCIMText=
function(){var A=t._asyncToGenerator(function*(I){const {glyphMosaicItems:G}=yield this.getMosaicItem(n.cimLayerToRasterizationInfo(I),q.codepoints(I.text));return l.ok(G,z)?a.fromCIMText(I,G,this._tileInfo):this._textError});return function(I){return A.apply(this,arguments)}}();F._createCIMFill=function(){var A=t._asyncToGenerator(function*(I){const {spriteMosaicItem:G}=yield this.getMosaicItem(n.cimLayerToRasterizationInfo(I));return l.ok(G,z)?k.fromCIMFill(I,G,this._tileInfo):this._fillError});
return function(I){return A.apply(this,arguments)}}();F._createCIMLine=function(){var A=t._asyncToGenerator(function*(I){const {spriteMosaicItem:G}=yield this.getMosaicItem(n.cimLayerToRasterizationInfo(I));return l.ok(G,z)?g.fromCIMLine(I,G,this._tileInfo):this._lineError});return function(I){return A.apply(this,arguments)}}();F._createCIMMarker=function(){var A=t._asyncToGenerator(function*(I){const {spriteMosaicItem:G}=yield this.getMosaicItem(n.cimLayerToRasterizationInfo(I));return l.ok(G,z)?
e.fromCIMMarker(I,G,this._tileInfo):this._markerError});return function(I){return A.apply(this,arguments)}}();F._createCIM=function(){var A=t._asyncToGenerator(function*(I){const G=I.templateHash;let E=this._cimTemplateCache.get(G);if(null!=E)return E;switch(I.type){case "marker":E=yield this._createCIMMarker(I);break;case "line":E=yield this._createCIMLine(I);break;case "fill":E=yield this._createCIMFill(I);break;case "text":E=yield this._createCIMText(I)}this._cimTemplateCache.set(G,E);return E});
return function(I){return A.apply(this,arguments)}}();F._createDynamicCIM=function(){var A=t._asyncToGenerator(function*(I){const G=I.templateHash;let E=this._cimTemplateCache.get(G);if(null!=E)return E;switch(I.type){case "marker":E=d.fromCIMMarker(I,this._tileInfo);break;case "line":E=c.fromCIMLine(I,this._tileInfo);break;case "fill":E=h.fromCIMFill(I,this._tileInfo);break;case "text":E=f.fromCIMText(I,this._tileInfo)}this._cimTemplateCache.set(G,E);return E});return function(I){return A.apply(this,
arguments)}}();F._createPrimitiveMeshTemplates=function(A,I,G){switch(I.type){case "esriSMS":return v(A,this._createSMS(I));case "esriPMS":return v(A,this._createPMS(I));case "esriSFS":return v(A,this._createSFS(I,G));case "line-marker":return v(A,this._createLMS(I));case "esriPFS":return v(A,this._createPFS(I,G));case "esriSLS":return v(A,this._createSLS(I,!1));case "esriTS":return v(A,this._createTS(I));default:return z.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),
A}};F._createMeshTemplates=function(A,I,G){if(I.type.includes("3d"))return z.error("3D symbols are not supported with MapView"),A;if("expanded-cim"===I.type){for(const E of I.layers)"function"===typeof E.materialHash?v(A,this._createDynamicCIM(E)):v(A,this._createCIM(E));return A}if("composite-symbol"===I.type){for(const E of I.layers)this._createPrimitiveMeshTemplates(A,E,G);return A}return"cim"===I.type||"label"===I.type||"web-style"===I.type?A:this._createPrimitiveMeshTemplates(A,I,G)};t._createClass(K,
[{key:"_markerError",get:function(){return this._errorTemplates.marker[0]}},{key:"_fillError",get:function(){return this._errorTemplates.fill[0]}},{key:"_lineError",get:function(){return this._errorTemplates.line[0]}},{key:"_textError",get:function(){return this._errorTemplates.line[0]}}]);return K}();u.WGLTemplateStore=y;u.errorPointSchema2D=r;u.errorPolygonSchema2D=J;u.errorPolylineSchema2D=D;u.isDynamicId=B;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../color ../../definitions ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./util ./WGLBaseFillTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f){return function(k){function g(e,a,b){var l=k.call(this,e)||this;l._minMaxZoom=x.i1616to32(Math.round(a*w.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(b*w.MIN_MAX_ZOOM_PRECISION_FACTOR));h.isFunction(e.color)?l._dynamicPropertyMap.set("fillColor",(p,r,D)=>(p=e.color(p,r,D))&&C.premultiplyAlphaRGBA(p)||0):(a=e.color,l.fillColor=a&&C.premultiplyAlphaRGBA(a)||0);const q="CIMMarkerPlacementInsidePolygon"===e.cim.placement?.type&&e.cim.placement.shiftOddRows?2:1,n=e.height;
h.isFunction(n)?l._dynamicPropertyMap.set("_height",(p,r,D)=>n(p,r,D)*q):l._height=(n||0)*q;const v=e.offsetX;h.isFunction(v)?l._dynamicPropertyMap.set("_offsetX",(p,r,D)=>H.pt2px(v(p,r,D))):l._offsetX=H.pt2px(v||0);const B=e.offsetY;h.isFunction(B)?l._dynamicPropertyMap.set("_offsetY",(p,r,D)=>H.pt2px(-B(p,r,D))):l._offsetY=H.pt2px(-B||0);a=e.scaleX;h.isFunction(a)?l._dynamicPropertyMap.set("_scaleX",a):l._scaleX=a||1;const z=e.angle;h.isFunction(z)?l._dynamicPropertyMap.set("_angle",(p,r,D)=>y.degToByte(z(p,
r,D))):l._angle=y.degToByte(z)||0;t.isSome(e.effects)&&(a=e.effects,h.isFunction(a)?l._dynamicPropertyMap.set("_effects",a):l._effects=a);l._cimFillLayer=e;l._bitset=(e.colorLocked?w.BITSET_GENERIC_LOCK_COLOR:0)|(e.applyRandomOffset?w.BITSET_FILL_RANDOM_PATTERN_OFFSET:0)|(e.sampleAlphaOnly?w.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0)|(e.hasUnresolvedReplacementColor?w.BITSET_FILL_HAS_UNRESOLVED_REPLACEMENT_COLOR:0);l._fillMaterialKey=e.materialKey;return l}u._inheritsLoose(g,k);g.fromCIMFill=function(e,
a){const [b,l]=h.getMinMaxZoom(e.scaleInfo,a);return new g(e,b,l)};g.prototype.bindFeature=function(e,a,b){const l=e.readLegacyFeature();this._dynamicPropertyMap.forEach((v,B)=>{this[B]=v(l,a,b)});e=m.FillMaterialKey.load(this._fillMaterialKey);var q=this._materialCache,n=this._cimFillLayer.materialHash;n=n(l,a,b);n=q.get(n);q=null;n&&f.ok(n.spriteMosaicItem)&&(q=n.spriteMosaicItem);if(q){const {rect:v,width:B,height:z}=q;n=v.x+w.SPRITE_PADDING;const p=v.y+w.SPRITE_PADDING,r=n+B,D=p+z;let J=Math.round(H.pt2px(this._height));
0>=J&&(J=D-p);let K=Math.round(H.pt2px(this._height/z*B||0));0>=K&&(K=r-n);const F=this._scaleX;this.tl=x.i1616to32(n,p);this.br=x.i1616to32(r,D);this.aux21=x.i1616to32(K,J);this.aux22=x.i1616to32(this._offsetX,this._offsetY);this.aux3=x.i8888to32(128*F,128,this._angle,0);e.sdf=q.sdf;e.pattern=!0;e.textureBinding=q.textureBinding}else this.aux3=this.aux22=this.aux21=this.br=this.tl=0,e.sdf=!1,e.pattern=!1,e.textureBinding=0;this._materialKey=e.data};return g}(c(d))})},"esri/views/2d/engine/webgl/GeometryUtils":function(){define(["exports"],
function(u){function t(y,x){y%=x;return 0<=y?y:y+x}const H=128/Math.PI,C=256/360,w=1/Math.LN2;u.between=function(y,x,m){return y>=x&&y<=m||y>=m&&y<=x};u.degToByte=function(y){return t(y*C,256)};u.interpolate=function(y,x,m){return y*(1-m)+x*m};u.log2=function(y){return Math.log(y)*w};u.positiveMod=t;u.radToByte=function(y){return t(y*H,256)};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../layers/graphics/featureConversionUtils ../../enums ../../number ../../Utils ../../materialKey/MaterialKey ./templateUtils ./WGLLineTemplate".split(" "),
function(u,t,H,C,w,y,x,m,h){return c=>function(d){function f(...g){g=d.call(this,...g)||this;g.forceLibtess=!1;g._bitset=0;g._lineTemplate=null;g.geometryType=C.WGLGeometryType.FILL;return g}u._inheritsLoose(f,d);var k=f.prototype;k._maybeAddLineTemplate=function(g){this._lineTemplate=h.fromFillOutline(g)};k._write=function(g,e,a,b){a="esriGeometryPoint"===e.geometryType;const l=x.FillMaterialKey.load(this._materialKey);g.recordStart(e.getDisplayId(),this._materialKey,this.geometryType,a);this._writeGeometry(g,
e,l,b,a);x.hasOutlineFillSymbology(l)&&t.isSome(this._lineTemplate)&&this._lineTemplate.writeGeometry(g,e,b,a);g.recordEnd()};k._writeGeometry=function(g,e,a,b,l){b=this._getGeometry(e,b,l);t.isNone(b)||(l=[],100<b.maxLength||this.forceLibtess||!m.triangulate(l,b)?(b=m.triangulateLibtess(b),this._writeVertices(g,e,b,[b.length/2],a)):l.length&&this._writeVertices(g,e,b.coords,b.lengths,a,l))};k._writeVertex=function(g,e,a,b,l,q){const n=w.i1616to32(1*b,1*l);g.vertexBounds(b,l,0,0);g.vertexWrite(n);
g.vertexWrite(e);a.symbologyType===C.WGLSymbologyType.DOT_DENSITY?g.vertexWriteF32(1/Math.abs(q.readGeometryArea())):(g.vertexWrite(this.fillColor),e=x.hasSimpleSymbology(a),e||(g.vertexWrite(this.tl),g.vertexWrite(this.br)),g.vertexWrite(this.aux21),g.vertexWrite(this.aux22),g.vertexWrite(this.aux3),e||g.vertexWrite(this._minMaxZoom))};k._writeVertices=function(g,e,a,b,l,q){var n=e.getDisplayId();n|=this._bitset<<24;var v=b.reduce((z,p)=>z+p);const B=y.getStrides(l.geometryType,l.symbologyType).geometry/
4;b=g.vertexCount();g.vertexEnsureSize(B*v);v=0;if(q)for(const z of q)this._writeVertex(g,n,l,a[2*z],a[2*z+1],e),v++;else for(q=0;q<a.length;q+=2)this._writeVertex(g,n,l,Math.round(a[q]),Math.round(a[q+1]),e),v++;g.indexEnsureSize(v);for(e=0;e<v;e++)g.indexWrite(e+b)};k._getGeometry=function(g,e,a){return(g=e?H.deltaDecodeGeometry(H.convertFromGeometry(e),2):g.readGeometryForDisplay())?m.clipMarshall(g,a?256:8):null};return f}(c)})},"esri/views/2d/engine/webgl/mesh/templates/templateUtils":function(){define("exports ../../../../../../core/maybe ../../../../../../chunks/earcut ../../../../../../geometry/libtess ../../../../../../geometry/support/TileClipper ../../../../../../layers/graphics/OptimizedGeometry ../../definitions ../bufcut".split(" "),
function(u,t,H,C,w,y,x,m){function h(k,g,e){let a=0;for(let b=1;b<e;b++)a+=(k[2*(g+b)]-k[2*(g+b-1)])*(k[2*(g+b)+1]+k[2*(g+b-1)+1]);return a}function c(k,g,e,a,b){let l=0;for(;e<a;e+=3){const q=2*(k[e]-b),n=2*(k[e+1]-b),v=2*(k[e+2]-b);l+=Math.abs((g[q]-g[v])*(g[n+1]-g[q+1])-(g[q]-g[n])*(g[v+1]-g[q+1]))}return l}const d=new w.TileClipper(0,0,0,1,0),f=new w.TileClipper(0,0,0,1,0);d.setExtent(x.TILE_SIZE);f.setExtent(x.TILE_SIZE);u.area=h;u.clipLinesMarshall=function(k,g){f.setPixelMargin(g);const e=
-g;g=x.TILE_SIZE+g;let a=[];var b=!1;let l=0;for(;l<k.length;){const q=[],n=k[l];if(!n)return null;f.reset(w.GeometryType.LineString);let [v,B]=n[0];if(b)f.moveTo(v,B);else{if(v<e||v>g||B<e||B>g){b=!0;continue}q.push({x:v,y:B})}let z=!1;const p=n.length;for(let r=1;r<p;++r)if(v+=n[r][0],B+=n[r][1],b)f.lineTo(v,B);else{if(v<e||v>g||B<e||B>g){z=!0;break}q.push({x:v,y:B})}if(z)b=!0;else{if(b){if(b=f.resultWithStarts())for(const r of b)a.push(r)}else a.push({line:q,start:0});l++;b=!1}}a=a.filter(q=>1<
q.line.length);return 0===a.length?null:a};u.clipMarshall=function(k,g){if(t.isNone(k))return null;a:{var e=x.TILE_SIZE+128;var a=0;for(var b=0;b<k.lengths.length;b++){var l=k.lengths[b];for(var q=0;q<l;q++){const n=k.coords[2*(q+a)],v=k.coords[2*(q+a)+1];if(-128>n||n>e||-128>v||v>e){e=!0;break a}}a+=l}e=!1}if(!e)return k;d.setPixelMargin(g);d.reset(w.GeometryType.Polygon);g=0;for(e=0;e<k.lengths.length;e++){a=k.lengths[e];b=k.coords[2*(0+g)];l=k.coords[2*(0+g)+1];d.moveTo(b,l);for(q=1;q<a;q++)b=
k.coords[2*(q+g)],l=k.coords[2*(q+g)+1],d.lineTo(b,l);d.close();g+=a}e=d.result(!1);if(!e)return null;k=[];g=[];for(const n of e){e=0;for(const v of n)g.push(v.x),g.push(v.y),e++;k.push(e)}return new y(k,g)};u.triangleAreaArray=c;u.triangulate=function(k,g){const {coords:e,lengths:a,hasIndeterminateRingOrder:b}=g;if(b)return!1;g=0;for(var l=0;l<a.length;){let v=l,B=a[l];l=h(e,g,B);for(var q=[];++v<a.length;){var n=a[v];const z=h(e,g+B,n);if(!(0<z))break;l+=z;q.push(g+B);B+=n}n=k.length;m.bufcut(k,
e,g,g+B,q,2,0);q=c(k,e,n,k.length,0);l=Math.abs(l);if(1E-5<Math.abs((q-l)/Math.max(1E-7,l)))return k.length=0,!1;l=v;g+=B}return!0};u.triangulateEarcut=function(k,g,e){const {coords:a,lengths:b,hasIndeterminateRingOrder:l}=g;if(l)return!1;let q=0;for(var n=0;n<b.length;){let B=n,z=b[n];for(n=[];++B<b.length;){var v=b[B];if(!(0<h(a,q+z,v)))break;n.push(q+z-q);z+=v}v=g.coords.slice(2*q,2*(q+z));n=H.earcut(v,n,2);for(const p of n)k.push(p+e+q);n=B;q+=z}return!0};u.triangulateLibtess=function(k){const {coords:g,
lengths:e}=k;({buffer:k}=C.triangulate(g,e));return k};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/bufcut":function(){define(["exports"],function(u){function t(v,B,z,p,r,D,J){let K;z=0;for(let F=p,A=r-D;F<r;F+=D)z+=(v[A+B*D]-v[F+B*D])*(v[F+1+B*D]+v[A+1+B*D]),A=F;if(J===0<z)for(;p<r;p+=D)K=y(p+B*D,v[p+B*D],v[p+1+B*D],K);else for(r-=D;r>=p;r-=D)K=y(r+B*D,v[r+B*D],v[r+1+B*D],K);K&&e(K,K.next)&&(x(K),K=K.next);return K}function H(v,B=v){if(!v)return v;
let z;do if(z=!1,v.steiner||!e(v,v.next)&&0!==c(v.prev,v,v.next))v=v.next;else{x(v);v=B=v.prev;if(v===v.next)break;z=!0}while(z||v!==B);return B}function C(v,B,z,p,r,D,J,K){if(v){!K&&D&&(v=h(v,p,r,D));for(var F=v;v.prev!==v.next;){var A=v.prev,I=v.next;if(D)var G=w(v,p,r,D);else a:{G=v;var E=G.prev,M=G;const T=G.next;if(0<=c(E,M,T)){G=!1;break a}let Y=G.next.next;const fa=Y;let ba=0;for(;Y!==G.prev&&(0===ba||Y!==fa);){ba++;if(f(E.x,E.y,M.x,M.y,T.x,T.y,Y.x,Y.y)&&0<=c(Y.prev,Y,Y.next)){G=!1;break a}Y=
Y.next}G=!0}if(G)B.push(A.index/z+J),B.push(v.index/z+J),B.push(I.index/z+J),x(v),F=v=I.next;else if(v=I,v===F){if(!K)C(H(v),B,z,p,r,D,J,1);else if(1===K){K=B;F=z;A=J;I=v;do G=I.prev,E=I.next.next,!e(G,E)&&d(G,I,I.next,E)&&k(G,E)&&k(E,G)&&(K.push(G.index/F+A),K.push(I.index/F+A),K.push(E.index/F+A),x(I),x(I.next),I=v=E),I=I.next;while(I!==v);v=I;C(v,B,z,p,r,D,J,2)}else if(2===K)a:{K=v;do{for(F=K.next.next;F!==K.prev;){if(A=K.index!==F.index){G=G=G=void 0;A=K;I=F;if(G=A.next.index!==I.index&&A.prev.index!==
I.index){b:{G=A;do{if(G.index!==A.index&&G.next.index!==A.index&&G.index!==I.index&&G.next.index!==I.index&&d(G,G.next,A,I)){G=!0;break b}G=G.next}while(G!==A);G=!1}G=!G}if(G=G&&k(A,I)&&k(I,A)){G=A;E=!1;M=(A.x+I.x)/2;I=(A.y+I.y)/2;do G.y>I!==G.next.y>I&&G.next.y!==G.y&&M<(G.next.x-G.x)*(I-G.y)/(G.next.y-G.y)+G.x&&(E=!E),G=G.next;while(G!==A);G=E}A=G}if(A){v=b(K,F);K=H(K,K.next);v=H(v,v.next);C(K,B,z,p,r,D,J,0);C(v,B,z,p,r,D,J,0);break a}F=F.next}K=K.next}while(K!==v)}break}}}}function w(v,B,z,p){const r=
v.prev,D=v.next;if(0<=c(r,v,D))return!1;const J=r.x>v.x?r.x>D.x?r.x:D.x:v.x>D.x?v.x:D.x,K=r.y>v.y?r.y>D.y?r.y:D.y:v.y>D.y?v.y:D.y,F=g(r.x<v.x?r.x<D.x?r.x:D.x:v.x<D.x?v.x:D.x,r.y<v.y?r.y<D.y?r.y:D.y:v.y<D.y?v.y:D.y,B,z,p);B=g(J,K,B,z,p);z=v.prevZ;for(p=v.nextZ;z&&z.z>=F&&p&&p.z<=B;){if(z!==v.prev&&z!==v.next&&f(r.x,r.y,v.x,v.y,D.x,D.y,z.x,z.y)&&0<=c(z.prev,z,z.next))return!1;z=z.prevZ;if(p!==v.prev&&p!==v.next&&f(r.x,r.y,v.x,v.y,D.x,D.y,p.x,p.y)&&0<=c(p.prev,p,p.next))return!1;p=p.nextZ}for(;z&&z.z>=
F;){if(z!==v.prev&&z!==v.next&&f(r.x,r.y,v.x,v.y,D.x,D.y,z.x,z.y)&&0<=c(z.prev,z,z.next))return!1;z=z.prevZ}for(;p&&p.z<=B;){if(p!==v.prev&&p!==v.next&&f(r.x,r.y,v.x,v.y,D.x,D.y,p.x,p.y)&&0<=c(p.prev,p,p.next))return!1;p=p.nextZ}return!0}function y(v,B,z,p){v=l.create(v,B,z);p?(v.next=p.next,v.prev=p,p.next.prev=v,p.next=v):(v.prev=v,v.next=v);return v}function x(v){v.next.prev=v.prev;v.prev.next=v.next;v.prevZ&&(v.prevZ.nextZ=v.nextZ);v.nextZ&&(v.nextZ.prevZ=v.prevZ)}function m(v,B){let z=B;const p=
v.x,r=v.y;let D=-Infinity,J;do{if(r<=z.y&&r>=z.next.y&&z.next.y!==z.y){var K=z.x+(r-z.y)*(z.next.x-z.x)/(z.next.y-z.y);if(K<=p&&K>D){D=K;if(K===p){if(r===z.y)return z;if(r===z.next.y)return z.next}J=z.x<z.next.x?z:z.next}}z=z.next}while(z!==B);if(!J)return null;if(p===D)return J.prev;B=J;K=J.x;const F=J.y;let A=Infinity,I;for(z=J.next;z!==B;)p>=z.x&&z.x>=K&&p!==z.x&&f(r<F?p:D,r,K,F,r<F?D:p,r,z.x,z.y)&&(I=Math.abs(r-z.y)/(p-z.x),(I<A||I===A&&z.x>J.x)&&k(z,v)&&(J=z,A=I)),z=z.next;return J}function h(v,
B,z,p){for(var r;r!==v;r=r.next){r=r||v;null===r.z&&(r.z=g(r.x,r.y,B,z,p));if(r.prev.next!==r||r.next.prev!==r)return r.prev.next=r,r.next.prev=r,h(v,B,z,p);r.prevZ=r.prev;r.nextZ=r.next}v.prevZ.nextZ=null;v.prevZ=null;a:for(z=1;;){p=v;B=v=null;let D=0;for(;p;){D++;r=p;let J=0;for(;J<z&&r;J++)r=r.nextZ;let K=z;for(;0<J||0<K&&r;){let F;0===J?(F=r,r=r.nextZ,K--):0!==K&&r?p.z<=r.z?(F=p,p=p.nextZ,J--):(F=r,r=r.nextZ,K--):(F=p,p=p.nextZ,J--);B?B.nextZ=F:v=F;F.prevZ=B;B=F}p=r}B.nextZ=null;z*=2;if(2>D)break a}return v}
function c(v,B,z){return(B.y-v.y)*(z.x-B.x)-(B.x-v.x)*(z.y-B.y)}function d(v,B,z,p){return e(v,B)&&e(z,p)||e(v,p)&&e(z,B)?!0:0<c(v,B,z)!==0<c(v,B,p)&&0<c(z,p,v)!==0<c(z,p,B)}function f(v,B,z,p,r,D,J,K){return 0<=(r-J)*(B-K)-(v-J)*(D-K)&&0<=(v-J)*(p-K)-(z-J)*(B-K)&&0<=(z-J)*(D-K)-(r-J)*(p-K)}function k(v,B){return 0>c(v.prev,v,v.next)?0<=c(v,B,v.next)&&0<=c(v,v.prev,B):0>c(v,B,v.prev)||0>c(v,v.next,B)}function g(v,B,z,p,r){v=32767*(v-z)*r;B=32767*(B-p)*r;v=(v|v<<8)&16711935;v=(v|v<<4)&252645135;v=
(v|v<<2)&858993459;B=(B|B<<8)&16711935;B=(B|B<<4)&252645135;B=(B|B<<2)&858993459;return(v|v<<1)&1431655765|((B|B<<1)&1431655765)<<1}function e(v,B){return v.x===B.x&&v.y===B.y}function a(v,B){return v.x-B.x}function b(v,B){const z=l.create(v.index,v.x,v.y),p=l.create(B.index,B.x,B.y),r=v.next,D=B.prev;v.next=B;B.prev=v;z.next=r;r.prev=z;p.next=z;z.prev=p;D.next=p;p.prev=D;return p}let l=function(){function v(){this.y=this.x=this.index=0;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=
!1}v.create=function(B,z,p){const r=n<q.length?q[n++]:new v;r.index=B;r.x=z;r.y=p;r.prev=null;r.next=null;r.z=null;r.prevZ=null;r.nextZ=null;r.steiner=!1;return r};return v}();const q=[];let n=0;for(let v=0;8096>v;v++)q.push(new l);u.bufcut=function(v,B,z,p,r,D,J){n=0;var K=(p-z)*D,F=r&&r.length;const A=F?(r[0]-z)*D:K;var I=t(B,z,p,0,A,D,!0);if(I&&I.next!==I.prev){var G;if(F){const fa=[];for(let ba=0,U=r.length;ba<U;ba++){const P=t(B,z,p,r[ba]*D,ba<U-1?r[ba+1]*D:p*D,D,!1);P===P.next&&(P.steiner=!0);
F=fa;var E=F.push;let Q=P,Z=P;do{if(Q.x<Z.x||Q.x===Z.x&&Q.y<Z.y)Z=Q;Q=Q.next}while(Q!==P);E.call(F,Z)}fa.sort(a);for(var M of fa)if(p=M,r=m(p,I))p=b(r,p),H(p,p.next),I=H(r,r.next)}if(K>80*D){var T=K=B[z*D];var Y=G=B[1+z*D];for(M=D;M<A;M+=D)p=B[M+z*D],r=B[M+1+z*D],T=Math.min(T,p),Y=Math.min(Y,r),K=Math.max(K,p),G=Math.max(G,r);G=Math.max(K-T,G-Y);G=0!==G?1/G:0}C(I,v,D,T,Y,G,J,0)}};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/WGLLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Logger ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../color ../../definitions ../../number ../../Utils ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLMeshTemplate".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f){return function(k){function g(e,a,b,l,q,n,v,B,z,p,r,D,J,K,F,A,I,G,E,M){var T=k.call(this)||this;e=h.LineMaterialKey.load(e);a&&(e.sdf=a.sdf,e.pattern=!0,e.textureBinding=a.textureBinding);T._capType=l;T._joinType=q;T._miterLimitCosine=c.getLimitCosine(n);T.tessellationProperties._fillColor=v;T.tessellationProperties._tl=B;T.tessellationProperties._br=z;T._hasPattern=p;T._isDashed=r;T._zOrder=I;T._effects=G;T._minMaxZoom=x.i1616to32(Math.round(E*y.MIN_MAX_ZOOM_PRECISION_FACTOR),
Math.round(M*y.MIN_MAX_ZOOM_PRECISION_FACTOR));T._materialKey=e.data;T.tessellationProperties._bitset=(J?y.BITSET_GENERIC_LOCK_COLOR:0)|(K?y.BITSET_TYPE_FILL_OUTLINE:0)|(D?y.BITSET_LINE_SCALE_DASH:0)|(F?y.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0);T.tessellationProperties._halfWidth=.5*b;T.tessellationProperties._halfReferenceWidth=.5*A;T.tessellationProperties.offset=0;T._initializeTessellator(!1);return T}u._inheritsLoose(g,k);g.fromCIMLine=function(e,a,b){var l=e.color,q=e.scaleFactor||1;const n=!!e.dashTemplate;
let v=e.cap;n&&v===C.CapType.ROUND&&(v=C.CapType.SQUARE);const B=e.join;q*=H.pt2px(e.width);const z=H.pt2px(e.referenceWidth),p=H.pt2px(e.miterLimit);l=l&&w.premultiplyAlphaRGBA(l)||0;const [r,D]=c.getMinMaxZoom(e.scaleInfo,b);if(!a)return new g(e.materialKey,a,q,v,B,p,l,0,0,!1,n,e.scaleDash??!1,e.colorLocked??!1,!1,e.sampleAlphaOnly,z,e.zOrder,e.effects,r,D);const {rect:J,width:K,height:F}=a;var A=J.x+y.SPRITE_PADDING;const I=J.y+y.SPRITE_PADDING;b=A+K;const G=I+F;A=x.i1616to32(A,I);b=x.i1616to32(b,
G);return new g(e.materialKey,a,q,v,B,p,l,A,b,!0,n,e.scaleDash??!1,e.colorLocked??!1,!1,e.sampleAlphaOnly,z,e.zOrder,e.effects,r,D)};g.fromFillOutline=function(e){const a=h.FillMaterialKey.load(e.materialKey);return h.hasOutlineFillSymbology(a)&&e.outline&&"esriSLSSolid"===e.outline?.style?g.fromSimpleLine({hash:"",materialKey:e.materialKey,...e.outline},null,!0):null};g.fromSimpleLine=function(e,a,b=!1){var {color:l}=e;const q="esriSLSSolid"!==e.style&&"esriSLSNull"!==e.style,n=m.getCapType(e.cap||
"round"),v=m.getJoinType(e.join||"round");l=l&&"esriSLSNull"!==e.style&&w.premultiplyAlphaRGBAArray(l)||0;"esriSLSNull"===e.style&&(l=0);const B=H.pt2px(e.width),z=e.miterLimit;if(!a)return new g(e.materialKey,a,B,n,v,z,l,0,0,!1,q,!0,!1,b,!1,B,0,null,c.DEFAULT_MIN_ZOOM,c.DEFAULT_MAX_ZOOM);const {rect:p,width:r,height:D}=a;var J=p.x+y.SPRITE_PADDING;const K=p.y+y.SPRITE_PADDING;var F=J+r;const A=K+D;J=x.i1616to32(J,K);F=x.i1616to32(F,A);return new g(e.materialKey,a,B,n,v,z,l,J,F,!0,q,!0,!1,b,!1,B,
0,null,c.DEFAULT_MIN_ZOOM,c.DEFAULT_MAX_ZOOM)};g.fromPictureLineSymbol=function(e,a,b,l){t.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate").error("PictureLineSymbol support does not exist!");return null};return g}(d(f))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../definitions ../../enums ../../number ../../TurboLine ../../materialKey/MaterialKey ./templateUtils".split(" "),
function(u,t,H,C,w,y,x,m){const h=(f,k,g)=>(e,a,b,l,q,n,v,B,z,p,r)=>{b=w.i1616to32(r,Math.ceil(16*f._halfWidth));v=w.i8888to32(Math.round(16*v),Math.round(16*B),Math.round(16*z),Math.round(16*p));q=w.i8888to32(16*q,16*n,0,f._bitset);n=f.out;n.vertexBounds(e,a,k,g);n.vertexWrite(w.i1616to32(8*e,8*a));n.vertexWrite(f.id);n.vertexWrite(f._fillColor);n.vertexWrite(v);n.vertexWrite(b);n.vertexWrite(f._tl);n.vertexWrite(f._br);n.vertexWrite(q);n.vertexWrite(w.i1616to32(Math.ceil(16*f._halfReferenceWidth),
0));n.vertexWrite(f.minMaxZoom);n.vertexEnd();return f.offset+f.vertexCount++},c=(f,k,g)=>(e,a,b,l,q,n,v,B,z,p,r)=>{b=w.i1616to32(16*f._halfWidth,16*f._halfReferenceWidth);v=w.i8888to32(16*v+128,16*B+128,16*z+128,16*p+128);B=f.out;z=f._bitset<<24|f.id;B.vertexBounds(e,a,k,g);B.vertexWrite(w.i1616to32(8*e,8*a));B.vertexWrite(z);B.vertexWrite(f._fillColor);e=x.hasSimpleSymbology(f.key);e||(B.vertexWrite(0),B.vertexWrite(0));B.vertexWrite(0);B.vertexWrite(b);B.vertexWrite(v);e||B.vertexWrite(f.minMaxZoom);
B.vertexEnd();return f.offset+f.vertexCount++},d=f=>(k,g,e)=>{const a=f.out;a.indexWrite(k);a.indexWrite(g);a.indexWrite(e);f.indexCount+=3};return f=>function(k){function g(...a){a=k.call(this,...a)||this;a.tessellationProperties={};a._tessellationOptions={halfWidth:0,pixelCoordRatio:1,offset:0};a.geometryType=C.WGLGeometryType.LINE;return a}u._inheritsLoose(g,k);var e=g.prototype;e.writeGeometry=function(a,b,l,q){this._writeGeometry(a,b,l,q)};e._initializeTessellator=function(a){var b=x.LineMaterialKey.load(this._materialKey),
l=x.FillMaterialKey.load(this._materialKey),q=this._tessellationOptions;b=b.vvSizeFieldStops||b.vvSizeMinMaxValue||b.vvSizeScaleStops||b.vvSizeUnitValue;a=this.tessellationProperties._halfWidth<H.THIN_LINE_HALF_WIDTH_THRESHOLD&&!a&&!b;this.tessellationProperties.minMaxZoom=this._minMaxZoom;q.wrapDistance=65535;q.textured=this._isDashed||this._hasPattern;q.offset=this.tessellationProperties.offset;q.halfWidth=this.tessellationProperties._halfWidth;q=a?0:1;l=x.hasOutlineFillSymbology(l)?c:h;this._lineTessellator=
new y.LineTessellation(l(this.tessellationProperties,q,q),d(this.tessellationProperties),a)};e._write=function(a,b,l,q){l="esriGeometryPoint"===b.geometryType;a.recordStart(b.getDisplayId(),this._materialKey,this.geometryType,l);this._writeGeometry(a,b,q,l);a.recordEnd()};e._writeGeometry=function(a,b,l,q){l=l??b.readLegacyGeometryForDisplay();q=this._getLines(l,q);t.isNone(q)||this._writeVertices(a,b,q)};e._getLines=function(a,b){if(t.isNone(a))return null;a=a.paths||a.rings;return t.isNone(a)?null:
m.clipLinesMarshall(a,b?256:16)};e._writeVertices=function(a,b,l){const q=b.getDisplayId(),n=a.vertexCount(),v=this.tessellationProperties;b=this._tessellationOptions;v.out=a;v.id=q;v.indexCount=0;v.vertexCount=0;v.offset=n;b.capType=this._capType;b.joinType=this._joinType;a=x.FillMaterialKey.load(this._materialKey);this.tessellationProperties.key=x.hasOutlineFillSymbology(a)?a:x.LineMaterialKey.load(this._materialKey);for(const {line:B,start:z}of l)b.initialDistance=z%65535,this._lineTessellator.tessellate(B,
b)};return g}(f)})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMeshTemplate":function(){define(["../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/Logger","../../../../../../symbols/cim/cimAnalyzer","../../../../../../symbols/cim/utils","./WGLMeshTemplate"],function(u,t,H,C,w){const y=t.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate");return function(x){function m(h){var c=x.call(this)||this;c._ongoingMaterialRequestMap=new Map;c._materialCache=new Map;
c._dynamicPropertyMap=new Map;c._cimLayer=h;return c}u._inheritsLoose(m,x);m.prototype.analyze=function(h,c,d,f,k){if(k&&0===k.length)return null;const g=k&&0<k.length,e=c.readLegacyFeature();c=c.getObjectId();const a=this._materialCache;var b=this._cimLayer.materialHash;if(!b)return y.error("A Dynamic mesh template must have a material hash value or function!"),Promise.reject(null);const l="function"===typeof b?b(e,d,f,c):b;b=a.get(l);if(null!=b)return Promise.resolve(b);if(b=this._ongoingMaterialRequestMap.get(l))return b;
b=this._cimLayer;const q=H.analyzeCIMResource(b.cim,this._cimLayer.materialOverrides);q.mosaicHash=l;const {type:n,url:v}=b;c={cim:q,type:n,mosaicHash:l,url:v,size:null,dashTemplate:null,text:null,fontName:null,objectId:c,animatedSymbolProperties:null};switch(n){case "marker":c.size=C.evaluateValueOrFunction(b.size,e,d,f);c.animatedSymbolProperties=C.evaluateValueOrFunction(b.animatedSymbolProperties,e,d,f);break;case "line":c.dashTemplate=b.dashTemplate;break;case "text":c.text=C.evaluateValueOrFunction(b.text,
e,d,f),c.fontName=C.evaluateValueOrFunction(b.fontName,e,d,f)}h=h.getMosaicItem(c,k).then(B=>{g||(this._ongoingMaterialRequestMap.delete(l),a.set(l,B));return B}).catch(B=>{this._ongoingMaterialRequestMap.delete(l);y.error(".analyze()",B.message);return null});g||this._ongoingMaterialRequestMap.set(l,h);return h};return m}(w)})},"esri/symbols/cim/cimAnalyzer":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../Color ../../core/fontUtils ../../core/lang ../../core/Logger ../../core/maybe ../../core/screenUtils ../../core/string ../../support/arcadeOnDemand ./CIMSymbolHelper ./enums ./quantizeTime ./SDFHelper ./utils ./effects/CIMEffectHelper ../../views/2d/arcade/callExpressionWithFeature ../../views/2d/engine/webgl/definitions ../../views/2d/engine/webgl/grouping".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f,k,g,e,a,b,l,q){function n(ha){switch(ha){case "Butt":return f.CapType.BUTT;case "Square":return f.CapType.SQUARE;default:return f.CapType.ROUND}}function v(ha){switch(ha){case "Bevel":return f.JoinType.BEVEL;case "Miter":return f.JoinType.MITER;default:return f.JoinType.ROUND}}function B(ha,Ea,za,N){let S;ha[Ea]?S=ha[Ea]:(S={},ha[Ea]=S);S[za]=N}function z(ha){return(ha=ha.markerPlacement)&&ha.angleToLine?f.Alignment.MAP:f.Alignment.SCREEN}function p(){p=t._asyncToGenerator(function*(ha,
Ea,za,N,S){N=N??[];if(!ha)return N;let ea;const oa={};if("CIMSymbolReference"===ha.type){if(ea=ha.symbol,ha=ha.primitiveOverrides){var va=[];for(const ca of ha){var W=ca.valueExpressionInfo;W&&Ea?(W=c.createRendererExpression(W.expression,Ea.spatialReference,Ea.fields).then(ka=>{x.isNone(ka)||B(oa,ca.primitiveName,ca.propertyName,ka)}),va.push(W)):null!=ca.value&&B(oa,ca.primitiveName,ca.propertyName,ca.value)}0<va.length&&(yield Promise.all(va))}}else return Da.error("Expect cim type to be 'CIMSymbolReference'"),
N;va=[];d.CIMSymbolHelper.fetchResources(ea,za,va);0<va.length&&(yield Promise.all(va));switch(ea?.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":r(ea,ha,oa,Ea,N,za,!!S)}return N});return p.apply(this,arguments)}function r(ha,Ea,za,N,S,ea,oa){if(ha){var va=ha.symbolLayers;if(va){var W=ha.effects,ca=f.Alignment.SCREEN,ka=d.CIMSymbolHelper.getSize(ha)??0;"CIMPointSymbol"===ha.type&&"Map"===ha.angleAlignment&&(ca=f.Alignment.MAP);for(var la=va.length;la--;){var ma=va[la];if(!ma||
!1===ma.enable)continue;let Ua;W&&W.length&&(Ua=[...W]);var ua=ma.effects;ua&&ua.length&&(W?Ua.push(...ua):Ua=[...ua]);ua=[];d.OverrideHelper.findEffectOverrides(Ua,Ea,ua);ua=0<ua.length?Q(Ua,ua,za,N):Ua;var xa=[];d.OverrideHelper.findApplicableOverrides(ma,Ea,xa);switch(ma.type){case "CIMSolidFill":D(ma,ua,za,xa,N,S);break;case "CIMPictureFill":J(ma,ua,za,xa,N,ea,S);break;case "CIMHatchFill":K(ma,ua,za,xa,N,S);break;case "CIMGradientFill":var ia=za,na=N,ya=S;const [Ja,rb]=Aa(xa,ma.primitiveName,
ua,null,null);var Ga=h.numericHash(JSON.stringify(ma)+rb).toString();ya.push({type:"fill",templateHash:Ga,materialHash:Ja?sa(Ga,ia,xa,na):Ga,cim:ma,materialOverrides:null,colorLocked:!!ma.colorLocked,effects:ua,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,applyRandomOffset:!1,sampleAlphaOnly:!1});break;case "CIMSolidStroke":F(ma,ua,za,xa,N,S,"CIMPolygonSymbol"===ha.type,ka);break;case "CIMPictureStroke":A(ma,ua,za,xa,N,S,"CIMPolygonSymbol"===ha.type,ka);break;case "CIMGradientStroke":ia=
za;na=N;ya=S;Ga="CIMPolygonSymbol"===ha.type;var Ka=ka,Ra=ma.primitiveName,Qa=null!=ma.width?ma.width:4,Ta=n(ma.capStyle),Sa=v(ma.joinStyle),Na=ma.miterLimit;const [hb,db]=Aa(xa,Ra,ua,null,null),O=h.numericHash(JSON.stringify(ma)+db).toString();ya.push({type:"line",templateHash:O,materialHash:hb?sa(O,ia,xa,na):O,cim:ma,materialOverrides:null,isOutline:Ga,colorLocked:!!ma.colorLocked,effects:ua,color:{r:128,g:128,b:128,a:1},width:U(Ra,ia,"Width",na,Qa),cap:U(Ra,ia,"CapStyle",na,Ta),join:U(Ra,ia,"JoinStyle",
na,Sa),miterLimit:Na&&U(Ra,ia,"MiterLimit",na,Na),referenceWidth:Ka,zOrder:fa(ma.name),dashTemplate:null,scaleDash:!1,sampleAlphaOnly:!1});break;case "CIMCharacterMarker":I(ma,ua,za,xa,N,S);break;case "CIMPictureMarker":if(I(ma,ua,za,xa,N,S))break;"CIMLineSymbol"===ha.type&&(ca=z(ma));G(ma,ua,za,xa,N,ea,S,ca,ka);break;case "CIMVectorMarker":if(I(ma,ua,za,xa,N,S))break;"CIMLineSymbol"===ha.type&&(ca=z(ma));ia=za;na=N;ya=S;Ga=ea;Ka=ca;Ra=ka;Qa=oa;if(Sa=ma.markerGraphics){Ta=0;ma.scaleSymbolsProportionally&&
(Na=ma.frame)&&(Ta=Na.ymax-Na.ymin);Na=Z(ma.markerPlacement,xa,ia,na);for(const eb of Sa)if(eb&&(Sa=eb.symbol))switch(Sa.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":M(ma,ua,Na,null,eb,xa,ia,na,ya,Ga,Ka,Ra,Ta,!!Qa);break;case "CIMTextSymbol":E(ma,ua,Na,eb,ia,xa,na,ya,Ka,Ra,Ta)}}break;default:Da.error("Cannot analyze CIM layer",ma.type)}}}}}function D(ha,Ea,za,N,S,ea){const oa=ha.primitiveName,va=e.fromCIMColor(ha.color),[W,ca]=Aa(N,oa,Ea,null,null),ka=h.numericHash(JSON.stringify(ha)+
ca).toString();ea.push({type:"fill",templateHash:ka,materialHash:W?()=>ka:ka,cim:ha,materialOverrides:null,colorLocked:!!ha.colorLocked,color:U(oa,za,"Color",S,va,ba),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:Ea,applyRandomOffset:!1,sampleAlphaOnly:!0})}function J(ha,Ea,za,N,S,ea,oa){const va=ha.primitiveName,W=e.getTintColor(ha),[ca,ka]=Aa(N,va,Ea,null,null);N=h.numericHash(JSON.stringify(ha)+ka).toString();const la=h.numericHash(`${ha.url}${JSON.stringify(ha.colorSubstitutions)}`).toString();
let ma=e.getValue(ha.scaleX);if("width"in ha&&"number"===typeof ha.width){const ua=ha.width;let xa=1;ea=ea.getResource(ha.url);x.isSome(ea)&&(xa=ea.width/ea.height);ma/=ha.height/ua*xa}oa.push({type:"fill",templateHash:N,materialHash:ca?()=>la:la,cim:ha,materialOverrides:null,colorLocked:!!ha.colorLocked,effects:Ea,color:U(va,za,"TintColor",S,W,ba),height:U(va,za,"Height",S,ha.height),scaleX:U(va,za,"ScaleX",S,ma),angle:U(va,za,"Rotation",S,e.getValue(ha.rotation)),offsetX:U(va,za,"OffsetX",S,e.getValue(ha.offsetX)),
offsetY:U(va,za,"OffsetY",S,e.getValue(ha.offsetY)),url:ha.url,applyRandomOffset:!1,sampleAlphaOnly:!1})}function K(ha,Ea,za,N,S,ea){const oa=["Rotation","OffsetX","OffsetY"],va=N.filter(ia=>ia.primitiveName!==ha.primitiveName||!oa.includes(ia.propertyName)),W=ha.primitiveName;let [ca,ka]=Aa(N,W,Ea,null,null);N=h.numericHash(JSON.stringify(ha)+ka).toString();const la=h.numericHash(`${ha.separation}${JSON.stringify(ha.lineSymbol)}`).toString();let ma={r:255,g:255,b:255,a:1};var ua=!1;const xa=ha.lineSymbol?.symbolLayers?.find(ia=>
"CIMSolidStroke"===ia.type&&null!=za[ia.primitiveName]?.Color);xa&&(ma=e.fromCIMColor(xa.color),ma=U(xa.primitiveName,za,"Color",S,ma,ba),ua="function"===typeof ma,ca=ca||ua,ua=null!=xa.color||ua);ea.push({type:"fill",templateHash:N,materialHash:ca?sa(la,za,va,S):la,cim:ha,materialOverrides:va,colorLocked:!!ha.colorLocked,effects:Ea,color:ma,height:U(W,za,"Separation",S,ha.separation),scaleX:1,angle:U(W,za,"Rotation",S,e.getValue(ha.rotation)),offsetX:U(W,za,"OffsetX",S,e.getValue(ha.offsetX)),offsetY:U(W,
za,"OffsetY",S,e.getValue(ha.offsetY)),applyRandomOffset:!1,sampleAlphaOnly:!0,hasUnresolvedReplacementColor:!ua})}function F(ha,Ea,za,N,S,ea,oa,va){const W=ha.primitiveName,ca=e.fromCIMColor(ha.color),ka=null!=ha.width?ha.width:4,la=n(ha.capStyle),ma=v(ha.joinStyle),ua=ha.miterLimit,[xa,ia]=Aa(N,W,Ea,null,null),na=h.numericHash(JSON.stringify(ha)+ia).toString();let ya;if(Ea&&Ea instanceof Array&&0<Ea.length&&(N=Ea[Ea.length-1],"CIMGeometricEffectDashes"===N.type&&"NoConstraint"===N.lineDashEnding&&
null===N.offsetAlongLine)){Ea=[...Ea];var Ga=Ea.pop();ya=Ga.dashTemplate;Ga=Ga.scaleDash}ea.push({type:"line",templateHash:na,materialHash:xa?()=>na:na,cim:ha,materialOverrides:null,isOutline:oa,colorLocked:!!ha.colorLocked,effects:Ea,color:U(W,za,"Color",S,ca,ba),width:U(W,za,"Width",S,ka),cap:U(W,za,"CapStyle",S,la),join:U(W,za,"JoinStyle",S,ma),miterLimit:ua&&U(W,za,"MiterLimit",S,ua),referenceWidth:va,zOrder:fa(ha.name),dashTemplate:ya,scaleDash:Ga,sampleAlphaOnly:!0})}function A(ha,Ea,za,N,S,
ea,oa,va){const W=h.numericHash(`${ha.url}${JSON.stringify(ha.colorSubstitutions)}`).toString(),ca=ha.primitiveName,ka=e.getTintColor(ha),la=null!=ha.width?ha.width:4,ma=n(ha.capStyle),ua=v(ha.joinStyle),xa=ha.miterLimit,[ia,na]=Aa(N,ca,Ea,null,null);N=h.numericHash(JSON.stringify(ha)+na).toString();ea.push({type:"line",templateHash:N,materialHash:ia?()=>W:W,cim:ha,materialOverrides:null,isOutline:oa,colorLocked:!!ha.colorLocked,effects:Ea,color:U(ca,za,"TintColor",S,ka,ba),width:U(ca,za,"Width",
S,la),cap:U(ca,za,"CapStyle",S,ma),join:U(ca,za,"JoinStyle",S,ua),miterLimit:xa&&U(ca,za,"MiterLimit",S,xa),referenceWidth:va,zOrder:fa(ha.name),dashTemplate:null,scaleDash:!1,url:ha.url,sampleAlphaOnly:!1})}function I(ha,Ea,za,N,S,ea){const {markerPlacement:oa,type:va}=ha;if(!oa||"CIMMarkerPlacementInsidePolygon"!==oa.type)return!1;if("CIMVectorMarker"===va||"CIMPictureMarker"===va){var W=ha.primitiveName;if(W&&([W]=Aa(N,W,Ea,null,null),W))return!1;if(W=oa.primitiveName)if([W]=Aa(N,W,Ea,null,null),
W)return!1;if("CIMVectorMarker"===va){if({markerGraphics:W}=ha,W)for(var ca of W)if({symbol:W}=ca,"CIMPolygonSymbol"===W?.type&&W.symbolLayers){({symbolLayers:W}=W);for(var ka of W)if("CIMSolidStroke"===ka.type)return!1}}else if({animatedSymbolProperties:ca}=ha,ca)return!1}W=Math.abs(oa.stepX);var la=Math.abs(oa.stepY);if(0===W||0===la)return!0;const ma=["Rotation","OffsetX","OffsetY"];ca=N.filter(ya=>ya.primitiveName!==ha.primitiveName||!ma.includes(ya.propertyName));ka="url"in ha&&"string"===typeof ha.url?
ha.url:void 0;const [ua,xa]=Aa(N,oa.primitiveName,Ea,null,null);N=h.numericHash(JSON.stringify(ha)+xa).toString();let ia=null;if("Random"===oa.gridType){var na=m.px2pt(l.RANDOM_INSIDE_POLYGON_TEXTURE_SIZE);const ya=Math.max(Math.floor(na/W),1),Ga=Math.max(Math.floor(na/la),1);na=la*Ga;ia=Ka=>Ka?Ka*Ga:0;W=ya*W/na}else oa.shiftOddRows?(na=2*la,ia=ya=>ya?2*ya:0,W=W/la*.5):(na=la,ia=null,W/=la);la=e.getTintColor(ha);ea.push({type:"fill",templateHash:N,materialHash:ua?sa(N,za,ca,S):N,cim:ha,materialOverrides:ca,
colorLocked:!!ha.colorLocked,effects:Ea,color:U(oa.primitiveName,za,"TintColor",S,la,ba),height:U(oa.primitiveName,za,"StepY",S,na,ia),scaleX:W,angle:U(oa.primitiveName,za,"GridAngle",S,oa.gridAngle),offsetX:U(oa.primitiveName,za,"OffsetX",S,e.getValue(oa.offsetX)),offsetY:U(oa.primitiveName,za,"OffsetY",S,e.getValue(oa.offsetY)),url:ka,applyRandomOffset:"Random"===oa.gridType,sampleAlphaOnly:!ka,hasUnresolvedReplacementColor:!0});return!0}function G(ha,Ea,za,N,S,ea,oa,va,W){function ca(Sa,Na){return x.isSome(Ka)?
e.evaluateValueOrFunction(Ka,Sa,Na):null}const ka=ha.primitiveName,la=e.getValue(ha.size);let ma=e.getValue(ha.scaleX,1);const ua=e.getValue(ha.rotation),xa=e.getValue(ha.offsetX),ia=e.getValue(ha.offsetY),na=e.getTintColor(ha),ya=h.numericHash(`${ha.url}${JSON.stringify(ha.colorSubstitutions)}${JSON.stringify(ha.animatedSymbolProperties)}`).toString(),Ga=Z(ha.markerPlacement,N,za,S),Ka=X(ha.animatedSymbolProperties,N,za,S),[Ra,Qa]=Aa(N,ka,Ea,Ga,Ka);N=h.numericHash(JSON.stringify(ha)+Qa).toString();
const Ta=ha.anchorPoint??{x:0,y:0};if("width"in ha&&"number"===typeof ha.width){const Sa=ha.width;let Na=1;ea=ea.getResource(ha.url);x.isSome(ea)&&(Na=ea.width/ea.height);ma/=la/Sa*Na}oa.push({type:"marker",templateHash:N,materialHash:ha.animatedSymbolProperties&&!0===ha.animatedSymbolProperties.randomizeStartTime?(Sa,Na,Ua,Ja)=>{Ua=q.getMaterialGroup(Ja??0);Sa=ca(Sa,Na);return ya+`-MATERIALGROUP(${Ua})`+`-ASP(${JSON.stringify(Sa)})`}:Ra?(Sa,Na)=>{Sa=ca(Sa,Na);return ya+`-ASP(${JSON.stringify(Sa)})`}:
ya,cim:ha,materialOverrides:null,colorLocked:!!ha.colorLocked,effects:Ea,scaleSymbolsProportionally:!1,alignment:va,size:U(ka,za,"Size",S,la),scaleX:U(ka,za,"ScaleX",S,ma),rotation:U(ka,za,"Rotation",S,ua),offsetX:U(ka,za,"OffsetX",S,xa),offsetY:U(ka,za,"OffsetY",S,ia),color:U(ka,za,"TintColor",S,na,ba),anchorPoint:{x:Ta.x,y:-Ta.y},isAbsoluteAnchorPoint:"Relative"!==ha.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:!!ha.rotateClockwise,referenceSize:W,
sizeRatio:1,markerPlacement:Ga,url:ha.url,animatedSymbolProperties:Ka})}function E(ha,Ea,za,N,S,ea,oa,va,W,ca,ka){d.OverrideHelper.findApplicableOverrides(N,ea,[]);var la=N.geometry;if("x"in la&&"y"in la){var ma=N.symbol,ua=e.fromCIMFontDecoration(ma),xa=e.fromCIMFontStyle(ma.fontStyleName),ia=C.getFontFamily(ma.fontFamilyName);ma.font={family:ia,decoration:ua,...xa};var na=ha.frame,ya=la.x-.5*(na.xmin+na.xmax),Ga=la.y-.5*(na.ymin+na.ymax),Ka=ha.size/ka;ka=ha.primitiveName;la=e.getValue(ma.height)*
Ka;na=e.getValue(ma.angle);ya=e.getValue(ha.offsetX)+(e.getValue(ma.offsetX)+ya)*Ka;Ga=e.getValue(ha.offsetY)+(e.getValue(ma.offsetY)+Ga)*Ka;var Ra=e.fromCIMColor(e.getFillColor(ma)),Qa=e.fromCIMColor(e.getStrokeColor(ma)),Ta=e.getStrokeWidth(ma)??0;Ta||(Qa=e.fromCIMColor(e.getFillColor(ma.haloSymbol)),ma.haloSize&&(Ta=ma.haloSize*Ka));var Sa=Ka=null,Na=0;if(ma.callout&&"CIMBackgroundCallout"===ma.callout.type){var Ua=ma.callout;if(Ua.backgroundSymbol&&(Ua=Ua.backgroundSymbol.symbolLayers))for(const O of Ua)"CIMSolidFill"===
O.type?Ka=e.fromCIMColor(O.color):"CIMSolidStroke"===O.type&&(Sa=e.fromCIMColor(O.color),Na=e.getValue(O.width))}var [Ja,rb]=Aa(ea,ka,Ea,za,null);ea=JSON.stringify(ha.effects)+Number(ha.colorLocked).toString()+JSON.stringify(ha.anchorPoint)+ha.anchorPointUnits+JSON.stringify(ha.markerPlacement)+ha.size.toString();ea=h.numericHash(JSON.stringify(N)+ea+rb).toString();var hb=U(N.primitiveName,S,"TextString",oa,N.textString??"",e.adjustTextCase,ma.textCase);if(null!=hb){({fontStyleName:N}=ma);var db=
ia+(N?"-"+N.toLowerCase():"-regular");"string"===typeof hb&&hb.includes("[")&&ma.fieldMap&&(hb=e.createLabelOverrideFunction(ma.fieldMap,hb,ma.textCase));va.push({type:"text",templateHash:ea,materialHash:Ja||"function"===typeof hb||hb.match(/\[(.*?)\]/)?(O,eb,Za)=>db+"-"+e.evaluateValueOrFunction(hb,O,eb,Za):db+"-"+h.numericHash(hb),cim:ma,materialOverrides:null,colorLocked:!!ha.colorLocked,effects:Ea,alignment:W,anchorPoint:{x:ha.anchorPoint?ha.anchorPoint.x:0,y:ha.anchorPoint?ha.anchorPoint.y:0},
isAbsoluteAnchorPoint:"Relative"!==ha.anchorPointUnits,fontName:db,decoration:ua,weight:U(ka,S,"Weight",oa,xa.weight),style:U(ka,S,"Size",oa,xa.style),size:U(ka,S,"Size",oa,la),angle:U(ka,S,"Rotation",oa,na),offsetX:U(ka,S,"OffsetX",oa,ya),offsetY:U(ka,S,"OffsetY",oa,Ga),horizontalAlignment:e.fromCIMHorizontalAlignment(ma.horizontalAlignment),verticalAlignment:e.fromCIMVerticalAlignment(ma.verticalAlignment),text:hb,color:Ra,outlineColor:Qa,outlineSize:Ta,backgroundColor:Ka,borderLineColor:Sa,borderLineWidth:Na,
referenceSize:ca,sizeRatio:1,markerPlacement:za})}}}function M(ha,Ea,za,N,S,ea,oa,va,W,ca,ka,la,ma,ua){var xa=S.symbol;const ia=xa.symbolLayers;if(ia)if(ua)Y(ha,Ea,za,N,S,oa,ea,va,W,ca,ka,la,ma);else if(ua=ia.length,ia&&2===ia.length&&ia[0].enable&&ia[1].enable&&"CIMSolidStroke"===ia[0].type&&"CIMSolidFill"===ia[1].type&&!ia[0].effects&&!ia[1].effects)T(ha,Ea,za,N,S,ia,ea,oa,va,W,ka,la,ma);else if(xa=a.CIMEffectHelper.applyEffects(xa.effects,S.geometry,ca.geometryEngine))for(;ua--;){var na=ia[ua];
if(na&&!1!==na.enable)switch(na.type){case "CIMSolidFill":case "CIMSolidStroke":var ya=a.CIMEffectHelper.applyEffects(na.effects,xa,ca.geometryEngine),Ga=g.getExtent(ya);if(!Ga)continue;const Qa="Relative"!==ha.anchorPointUnits,[Ta,Sa,Na]=g.getSDFMetrics(Ga,ha.frame,ha.size,ha.anchorPoint,Qa);var Ka="CIMSolidFill"===na.type;ya={type:"sdf",geom:ya,asFill:Ka};var Ra=ha.primitiveName;Ga=e.getValue(ha.size)??10;const Ua=e.getValue(ha.rotation),Ja=e.getValue(ha.offsetX),rb=e.getValue(ha.offsetY),hb=na.path,
db=na.primitiveName,O=Ka?e.fromCIMColor(e.getFillColor(na)):e.fromCIMColor(e.getStrokeColor(na)),eb=Ka?{r:0,g:0,b:0,a:0}:e.fromCIMColor(e.getStrokeColor(na)),Za=e.getStrokeWidth(na)??0;if(!Ka&&!Za)break;Ka=!1;let pb="";for(const ib of ea)if(ib.primitiveName===db||ib.primitiveName===Ra)void 0!==ib.value?pb+=`-${ib.primitiveName}-${ib.propertyName}-${JSON.stringify(ib.value)}`:ib.valueExpressionInfo&&(Ka=!0);if(x.isSome(Ea)&&"function"===typeof Ea||x.isSome(za)&&"function"===typeof za)Ka=!0;Ra=JSON.stringify({...ha,
markerGraphics:null});const Ab=h.numericHash(JSON.stringify(ya)+hb).toString();na={type:"marker",templateHash:h.numericHash(JSON.stringify(S)+JSON.stringify(na)+Ra+pb).toString(),materialHash:Ka?()=>Ab:Ab,cim:ya,materialOverrides:null,colorLocked:!!ha.colorLocked,effects:Ea,scaleSymbolsProportionally:!!ha.scaleSymbolsProportionally,alignment:ka,anchorPoint:{x:Sa,y:Na},isAbsoluteAnchorPoint:Qa,size:U(ha.primitiveName,oa,"Size",va,Ga),rotation:U(ha.primitiveName,oa,"Rotation",va,Ua),offsetX:U(ha.primitiveName,
oa,"OffsetX",va,Ja),offsetY:U(ha.primitiveName,oa,"OffsetY",va,rb),scaleX:1,frameHeight:ma,rotateClockwise:!!ha.rotateClockwise,referenceSize:la,sizeRatio:Ta,color:U(db,oa,"Color",va,O,ba),outlineColor:U(db,oa,"Color",va,eb,ba),outlineWidth:U(db,oa,"Width",va,Za),markerPlacement:za,animatedSymbolProperties:N,path:hb};W.push(na);break;default:Y(ha,Ea,za,N,S,oa,ea,va,W,ca,ka,la,ma)}}}function T(ha,Ea,za,N,S,ea,oa,va,W,ca,ka,la,ma){var ua=S.geometry;const xa=ea[0];ea=ea[1];var ia=g.getExtent(ua);if(ia){var na=
"Relative"!==ha.anchorPointUnits,[ya,Ga,Ka]=g.getSDFMetrics(ia,ha.frame,ha.size,ha.anchorPoint,na);ua={type:"sdf",geom:ua,asFill:!0};var Ra=ha.primitiveName;ia=e.getValue(ha.size);var Qa=e.getValue(ha.rotation),Ta=e.getValue(ha.offsetX),Sa=e.getValue(ha.offsetY),Na=ea.path,Ua=ea.primitiveName,Ja=xa.primitiveName,rb=e.fromCIMColor(e.getFillColor(ea)),hb=e.fromCIMColor(e.getStrokeColor(xa)),db=e.getStrokeWidth(xa)??0,O=!1,eb="";for(const pb of oa)if(pb.primitiveName===Ua||pb.primitiveName===Ja||pb.primitiveName===
Ra)void 0!==pb.value?eb+=`-${pb.primitiveName}-${pb.propertyName}-${JSON.stringify(pb.value)}`:pb.valueExpressionInfo&&(O=!0);x.isSome(za)&&"function"===typeof za&&(O=!0);oa=JSON.stringify({...ha,markerGraphics:null});var Za=h.numericHash(JSON.stringify(ua)+Na).toString();ha={type:"marker",templateHash:h.numericHash(JSON.stringify(S)+JSON.stringify(ea)+JSON.stringify(xa)+oa+eb).toString(),materialHash:O?()=>Za:Za,cim:ua,materialOverrides:null,colorLocked:!!ha.colorLocked,effects:Ea,scaleSymbolsProportionally:!!ha.scaleSymbolsProportionally,
alignment:ka,anchorPoint:{x:Ga,y:Ka},isAbsoluteAnchorPoint:na,size:U(ha.primitiveName,va,"Size",W,ia),rotation:U(ha.primitiveName,va,"Rotation",W,Qa),offsetX:U(ha.primitiveName,va,"OffsetX",W,Ta),offsetY:U(ha.primitiveName,va,"OffsetY",W,Sa),scaleX:1,frameHeight:ma,rotateClockwise:!!ha.rotateClockwise,referenceSize:la,sizeRatio:ya,color:U(Ua,va,"Color",W,rb,ba),outlineColor:U(Ja,va,"Color",W,hb,ba),outlineWidth:U(Ja,va,"Width",W,db),markerPlacement:za,path:Na,animatedSymbolProperties:N};ca.push(ha)}}
function Y(ha,Ea,za,N,S,ea,oa,va,W,ca,ka,la,ma){S={type:ha.type,enable:!0,name:ha.name,colorLocked:ha.colorLocked,primitiveName:ha.primitiveName,anchorPoint:ha.anchorPoint,anchorPointUnits:ha.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:ha.rotateClockwise,rotation:0,size:ha.size,billboardMode3D:ha.billboardMode3D,depth3D:ha.depth3D,frame:ha.frame,markerGraphics:[S],scaleSymbolsProportionally:ha.scaleSymbolsProportionally,respectFrame:ha.respectFrame,clippingPath:ha.clippingPath};const ua=
["Rotation","OffsetX","OffsetY"],xa=oa.filter(Ta=>Ta.primitiveName!==ha.primitiveName||!ua.includes(Ta.propertyName));var ia="";for(var na of oa)void 0!==na.value&&(ia+=`-${na.primitiveName}-${na.propertyName}-${JSON.stringify(na.value)}`);const [ya,Ga,Ka]=d.CIMSymbolHelper.getTextureAnchor(S,ca);oa=ha.primitiveName;ca=e.getValue(ha.rotation);na=e.getValue(ha.offsetX);const Ra=e.getValue(ha.offsetY);ia=h.numericHash(JSON.stringify(S)+ia).toString();const Qa=0<xa.length||x.isSome(Ea)&&"function"===
typeof Ea;Ea={type:"marker",templateHash:ia,materialHash:Qa?sa(ia,ea,xa,va):ia,cim:S,materialOverrides:xa,colorLocked:!!ha.colorLocked,effects:Ea,scaleSymbolsProportionally:!!ha.scaleSymbolsProportionally,alignment:ka,anchorPoint:{x:ya,y:Ga},isAbsoluteAnchorPoint:!1,size:e.getValue(ha.size),rotation:U(oa,ea,"Rotation",va,ca),offsetX:U(oa,ea,"OffsetX",va,na),offsetY:U(oa,ea,"OffsetY",va,Ra),color:{r:255,g:255,b:255,a:1},outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:ma,rotateClockwise:!!ha.rotateClockwise,
referenceSize:la,sizeRatio:Ka/m.pt2px(ha.size),markerPlacement:za,animatedSymbolProperties:N,avoidSDFRasterization:!0};W.push(Ea)}function fa(ha){return ha&&0===ha.indexOf("Level_")&&(ha=parseInt(ha.substr(6),10),!isNaN(ha))?ha:0}function ba(ha){if(!ha||0===ha.length)return null;ha=(new H(ha)).toRgba();return{r:ha[0],g:ha[1],b:ha[2],a:ha[3]}}function U(ha,Ea,za,N,S,ea,oa){if(null==ha)return S;if(ha=Ea[ha]){const va=ha[za];if("string"===typeof va||"number"===typeof va||va instanceof Array)return ea?
ea.call(null,va,oa):va;if(null!=va&&va instanceof c.ArcadeExpression&&N?.geometryType)return(W,ca,ka)=>{W=b(va,W,{$view:ka},N.geometryType,ca);null!==W&&ea&&(W=ea.call(null,W,oa));return null!==W?W:S}}return S}function P(ha){return ha?ha.charAt(0).toLowerCase()+ha.substr(1):ha}function Q(ha,Ea,za,N){for(const S of Ea)if(S.valueExpressionInfo&&N?.geometryType){const ea=za[S.primitiveName]&&za[S.primitiveName][S.propertyName];ea instanceof c.ArcadeExpression&&(S.fn=(oa,va,W)=>b(ea,oa,{$view:W},N.geometryType,
va))}return(S,ea,oa)=>{for(var va of Ea)va.fn&&(va.value=va.fn(S,ea,oa));S=[];for(let W of ha){if(ea=W?.primitiveName){oa=!1;for(const ca of Ea)ca.primitiveName===ea&&(va=P(ca.propertyName),null!=ca.value&&ca.value!==W[va]&&(oa||(W=w.clone(W),oa=!0),W[va]=ca.value))}S.push(W)}return S}}function Z(ha,Ea,za,N){const S=[];d.OverrideHelper.findApplicableOverrides(ha,Ea,S);if(null==ha||0===S.length)return ha;for(const ea of S)if(ea.valueExpressionInfo&&N?.geometryType){const oa=za[ea.primitiveName]&&za[ea.primitiveName][ea.propertyName];
oa instanceof c.ArcadeExpression&&(ea.fn=(va,W,ca)=>b(oa,va,{$view:ca},N.geometryType,W))}return(ea,oa,va)=>{for(const W of S)W.fn&&(W.value=W.fn(ea,oa,va));ea=w.clone(ha);oa=ha.primitiveName;for(const W of S)W.primitiveName===oa&&(va=P(W.propertyName),null!=W.value&&W.value!==ea[va]&&(ea[va]=W.value));return ea}}function X(ha,Ea,za,N){const S=[];d.OverrideHelper.findApplicableOverrides(ha,Ea,S);if(null==ha||0===S.length)return ha;for(const ea of S)if(ea.valueExpressionInfo&&N?.geometryType){const oa=
za[ea.primitiveName]&&za[ea.primitiveName][ea.propertyName];oa instanceof c.ArcadeExpression&&(ea.fn=(va,W,ca)=>b(oa,va,{$view:ca},N.geometryType,W))}return(ea,oa,va)=>{for(var W of S)W.fn&&(W.value=W.fn(ea,oa,va));ea=w.clone(ha);oa=ha.primitiveName;for(const ca of S)ca.primitiveName===oa&&(va=P(ca.propertyName),null!=ca.value&&(W=k.quantizeIfNeeded(ca.value,ca.propertyName),W!==ea[va]&&(ea[va]=W)));return ea}}function sa(ha,Ea,za,N){for(const S of za)if(S.valueExpressionInfo&&N?.geometryType){const ea=
Ea[S.primitiveName]&&Ea[S.primitiveName][S.propertyName];ea instanceof c.ArcadeExpression&&(S.fn=(oa,va,W)=>b(ea,oa,{$view:W},N.geometryType,va))}return(S,ea,oa)=>{for(const va of za)va.fn&&(va.value=va.fn(S,ea,oa));return h.numericHash(ha+d.OverrideHelper.buildOverrideKey(za)).toString()}}function Aa(ha,Ea,za,N,S){let ea=!1,oa="";for(const va of ha)va.primitiveName===Ea&&(void 0!==va.value?oa+=`-${va.primitiveName}-${va.propertyName}-${JSON.stringify(va.value)}`:va.valueExpressionInfo&&(ea=!0));
x.isSome(za)&&"function"===typeof za&&(ea=!0);x.isSome(N)&&"function"===typeof N&&(ea=!0);x.isSome(S)&&"function"===typeof S&&(ea=!0);return[ea,oa]}const Da=y.getLogger("esri.symbols.cim.cimAnalyzer");u.analyzeCIMResource=function(ha,Ea){if(!Ea||0===Ea.length)return ha;ha=w.clone(ha);d.OverrideHelper.applyOverrides(ha,Ea);return ha};u.analyzeCIMSymbol=function(ha,Ea,za,N,S){return p.apply(this,arguments)};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/core/fontUtils":function(){define(["exports",
"../chunks/_rollupPluginBabelHelpers","../config"],function(u,t,H){function C(){C=t._asyncToGenerator(function*(m){const h=y(m);let c=x.get(h);if(c)return c;m=new FontFace(m.family,`url('${H.fontsUrl}/woff2/${h}.${"woff2"}') format('${"woff2"}')`);const d=document.fonts;if(d.has(m)&&"loading"===m.status)return m.loaded;c=m.load();x.set(h,c);d.add(m);return c});return C.apply(this,arguments)}function w(m){if(!m)return"arial-unicode-ms";m=m.toLowerCase().split(" ").join("-");switch(m){case "serif":return"noto-serif";
case "sans-serif":return"arial-unicode-ms";case "monospace":return"ubuntu-mono";case "fantasy":return"cabin-sketch";case "cursive":return"redressed";default:return m}}function y(m){a:{if(m.weight)switch(m.weight.toLowerCase()){case "bold":case "bolder":var h="-bold";break a}h=""}a:{if(m.style)switch(m.style.toLowerCase()){case "italic":case "oblique":var c="-italic";break a}c=""}h+=c;return w(m.family)+(0<h.length?h:"-regular")}const x=new Map;u.getFontFamily=w;u.getFullyQualifiedFontName=y;u.loadFont=
function(m){return C.apply(this,arguments)};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/CIMSymbolHelper":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../Color ../../core/BidiText ../../core/lang ../../core/Logger ../../core/maybe ../../core/RandomLCG ../../core/screenUtils ../../geometry/support/aaBoundingRect ../../geometry/support/boundsUtils ../../support/arcadeOnDemand ./CIMPlacements ./CIMSymbolDrawHelper ./enums ./utils ../../views/2d/arcade/callExpressionWithFeature ../../views/2d/engine/vectorTiles/GeometryUtils ../../views/2d/engine/webgl/definitions ../../views/2d/engine/webgl/mesh/templates/shapingUtils".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f,k,g,e,a,b,l,q,n){function v(P,Q,Z){switch(Q.type){case "CIMSymbolReference":return v(P,Q.symbol,Z);case "CIMPointSymbol":null==Z&&(Z={x:0,y:0});P.drawSymbol(Q,Z);break;case "CIMLineSymbol":null==Z&&(Z={paths:[[[0,0],[10,0]]]});P.drawSymbol(Q,Z);break;case "CIMPolygonSymbol":null==Z&&(Z={rings:[[[0,0],[0,10],[10,10],[10,0],[0,0]]]});P.drawSymbol(Q,Z);break;case "CIMTextSymbol":P.drawSymbol(Q,{x:0,y:0});break;case "CIMVectorMarker":Z=new k.Placement,P.drawMarker(Q,Z)}return P.envelope()}
function B(P){if(!P)return 0;switch(P.type){case "CIMMarkerPlacementAlongLineSameSize":return Math.abs(P.offset);case "CIMMarkerPlacementAlongLineRandomSize":return Math.abs(P.offset);case "CIMMarkerPlacementAtExtremities":return Math.abs(P.offset);case "CIMMarkerPlacementAtMeasuredUnits":return Math.abs(P.offset);case "CIMMarkerPlacementAtRatioPositions":return Math.abs(P.offset);case "CIMMarkerPlacementInsidePolygon":return 0;case "CIMMarkerPlacementOnLine":return Math.abs(P.offset);case "CIMMarkerPlacementOnVertices":return Math.abs(P.offset);
case "CIMMarkerPlacementPolygonCenter":return 0;default:return 0}}function z(P){if(!P)return 0;switch(P.type){case "CIMGeometricEffectArrow":return Math.abs(.5*P.width);case "CIMGeometricEffectBuffer":return Math.abs(P.size);case "CIMGeometricEffectExtension":return Math.abs(P.length);case "CIMGeometricEffectJog":return Math.abs(.5*P.length);case "CIMGeometricEffectMove":return Math.max(Math.abs(a.getValue(P.offsetX)),Math.abs(a.getValue(P.offsetY)));case "CIMGeometricEffectOffset":return Math.abs(P.offset);
case "CIMGeometricEffectOffsetTangent":return Math.abs(P.offset);case "CIMGeometricEffectRadial":return Math.abs(P.length);case "CIMGeometricEffectRegularPolygon":return Math.abs(P.radius);case "CIMGeometricEffectRotate":return 0;case "CIMGeometricEffectScale":return 0;case "CIMGeometricEffectTaperedPolygon":return.5*Math.max(Math.abs(P.fromWidth),Math.abs(P.toWidth));case "CIMGeometricEffectWave":return Math.abs(P.amplitude);default:return 0}}function p(P){if(!P)return 0;let Q=0;for(const Z of P)Q+=
z(Z);return Q}function r(P,Q,Z){P.effects&&!x.isSome(Q.geometryEngine)&&(Q.geometryEnginePromise?Z.push(Q.geometryEnginePromise):a.isGeometryEngineRequired(P.effects)&&(Q.geometryEnginePromise=a.importGeometryEngine(),Z.push(Q.geometryEnginePromise),Q.geometryEnginePromise.then(X=>Q.geometryEngine=X)))}const D=Math.PI,J=D/2,K=96/72,F=Math.PI/180,A=y.getLogger("esri.symbols.cim.CIMSymbolHelper");y=function(){function P(){}var Q=P.prototype;Q.getSymbolInflateSize=function(Z,X,sa,Aa,Da){Z||(Z=[0,0,0,
0]);return X?this._getInflateSize(Z,X,sa,Aa,Da):Z};P.safeSize=function(Z){const X=Math.max(Math.abs(Z[0]),Math.abs(Z[2]));Z=Math.max(Math.abs(Z[1]),Math.abs(Z[3]));return Math.sqrt(X*X+Z*Z)};Q._vectorMarkerBounds=function(Z,X,sa,Aa){let Da=!0;const ha=c.create();if(X&&X.markerGraphics)for(const Ea of X.markerGraphics)X=[0,0,0,0],Ea.geometry&&(d.getBoundsXY(ha,Ea.geometry),X[0]=0,X[1]=0,X[2]=0,X[3]=0,this.getSymbolInflateSize(X,Ea.symbol,sa,0,Aa),ha[0]+=X[0],ha[1]+=X[1],ha[2]+=X[2],ha[3]+=X[3],Da?
(Z[0]=ha[0],Z[1]=ha[1],Z[2]=ha[2],Z[3]=ha[3],Da=!1):(Z[0]=Math.min(Z[0],ha[0]),Z[1]=Math.min(Z[1],ha[1]),Z[2]=Math.max(Z[2],ha[2]),Z[3]=Math.max(Z[3],ha[3])));return Z};Q._getInflateSize=function(Z,X,sa,Aa,Da){return void 0!==X.symbolLayers?(Z=this._getLayersInflateSize(Z,X.symbolLayers,sa,Aa,Da),X=p(X.effects),0<X&&(Z[0]-=X,Z[1]-=X,Z[2]+=X,Z[3]+=X),Z):this._getTextInflatedSize(Z,X,Da)};Q._getLayersInflateSize=function(Z,X,sa,Aa,Da){let ha=!0;if(!X)return Z;for(const oa of X)if(oa){X=[0,0,0,0];switch(oa.type){case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":var Ea=
oa,za=Ea.width;null!=za&&(za=Ea.capStyle===e.LineCapStyle.Square||Ea.joinStyle===e.LineJoinStyle.Miter?za/1.4142135623730951:za/2,X[0]=-za,X[1]=-za,X[2]=za,X[3]=za);break;case "CIMCharacterMarker":case "CIMVectorMarker":case "CIMPictureMarker":Ea=oa;if("CIMVectorMarker"===oa.type){if(za=oa,X=this._vectorMarkerBounds(X,za,sa,Da),za.frame){var N=(za.frame.xmin+za.frame.xmax)/2,S=(za.frame.ymin+za.frame.ymax)/2;X[0]-=N;X[1]-=S;X[2]-=N;X[3]-=S;null!=za.size&&(za=za.size/(za.frame.ymax-za.frame.ymin),
X[0]*=za,X[1]*=za,X[2]*=za,X[3]*=za)}}else"CIMPictureMarker"===oa.type?(za=oa,S=sa.getResource(za.url),N=1,x.isSome(S)&&S.height&&(N=S.width/S.height),null!=Ea.size&&(X=Ea.size/2,za=Ea.size*N*za.scaleX/2,X=[-za,-X,za,X])):null!=Ea.size&&(X=Ea.size/2,X=[-X,-X,X,X]);Ea.anchorPoint&&("Absolute"===Ea.anchorPointUnits?(za=Ea.anchorPoint.x,N=Ea.anchorPoint.y):(za=Ea.anchorPoint.x*(X[2]-X[0]),N=Ea.anchorPoint.y*(X[3]-X[1])),X[0]-=za,X[1]-=N,X[2]-=za,X[3]-=N);za=a.getValue(Ea.rotation);Ea.rotateClockwise&&
(za=-za);Aa&&(za-=Aa);za&&(N=F*za,za=Math.cos(N),N=Math.sin(N),S=c.create([l.C_INFINITY,l.C_INFINITY,-l.C_INFINITY,-l.C_INFINITY]),c.expandPointInPlace(S,[X[0]*za-X[1]*N,X[0]*N+X[1]*za]),c.expandPointInPlace(S,[X[0]*za-X[3]*N,X[0]*N+X[3]*za]),c.expandPointInPlace(S,[X[2]*za-X[1]*N,X[2]*N+X[1]*za]),c.expandPointInPlace(S,[X[2]*za-X[3]*N,X[2]*N+X[3]*za]),X=S);za=a.getValue(Ea.offsetX);N=a.getValue(Ea.offsetY);if(Aa){var ea=F*Aa;S=Math.cos(ea);ea=Math.sin(ea);const va=za*ea+N*S;za=za*S-N*ea;N=va}X[0]+=
za;X[1]+=N;X[2]+=za;X[3]+=N;Ea=B(Ea.markerPlacement);0<Ea&&(X[0]-=Ea,X[1]-=Ea,X[2]+=Ea,X[3]+=Ea)}Ea=p(oa.effects);0<Ea&&(X[0]-=Ea,X[1]-=Ea,X[2]+=Ea,X[3]+=Ea);ha?(Z[0]=X[0],Z[1]=X[1],Z[2]=X[2],Z[3]=X[3],ha=!1):(Z[0]=Math.min(Z[0],X[0]),Z[1]=Math.min(Z[1],X[1]),Z[2]=Math.max(Z[2],X[2]),Z[3]=Math.max(Z[3],X[3]))}return Z};Q._getTextInflatedSize=function(Z,X,sa){const Aa=X.height??10;Z[0]=-Aa/2;Z[1]=-Aa/2;Z[2]=Aa/2;Z[3]=Aa/2;if(!sa)return Z;sa=sa.get(X);if(!sa)return Z;const {text:Da,mosaicItem:ha}=sa;
if(!ha?.glyphMosaicItems?.length)return Z;const {lineGapType:Ea,lineGap:za}=X;sa=Ea?g.lineGapType2LineHeight(Ea,za??0,Aa):0;const N=C.bidiText(Da)[1],S="CIMBackgroundCallout"===X.callout?.type;X=n.shapeGlyphs(ha.glyphMosaicItems,N,{scale:Aa/q.GLYPH_SIZE,angle:a.getValue(X.angle),xOffset:a.getValue(X.offsetX),yOffset:a.getValue(X.offsetY),hAlign:g.horizontalAlignment2HAlign(X.horizontalAlignment),vAlign:g.verticalAlignment2VAlign(X.verticalAlignment),maxLineWidth:512,lineHeight:q.MAGIC_LABEL_LINE_HEIGHT*
Math.max(.25,Math.min(sa||1,4)),decoration:X.font.decoration||"none",isCIM:!0,hasBackground:S}).boundsT;Z[0]=X.x-X.halfWidth;Z[1]=-X.y-X.halfHeight;Z[2]=X.x+X.halfWidth;Z[3]=-X.y+X.halfHeight;return Z};return P}();let I=function(){function P(){}P.getEnvelope=function(Q,Z,X){if(!Q)return null;X=new g.EnvDrawHelper(X);if(Array.isArray(Q)){let sa;for(const Aa of Q)sa?sa.union(v(X,Aa,Z)):sa=v(X,Aa,Z);return sa}return v(X,Q,Z)};P.getTextureAnchor=function(Q,Z){Q=this.getEnvelope(Q,null,Z);if(!Q)return[0,
0,0];Z=Q.height*K+2;return[-((Q.x+.5*Q.width)*K)/(Q.width*K+2),-((Q.y+.5*Q.height)*K)/Z,Z]};P.rasterize=function(Q,Z,X,sa,Aa=!0){var Da=X||this.getEnvelope(Z,null,sa);if(!Da)return[null,0,0,0,0];const ha=(Da.x+.5*Da.width)*K,Ea=(Da.y+.5*Da.height)*K;Q.width=Da.width*K;Q.height=Da.height*K;X||(Q.width+=2,Q.height+=2);X=Q.getContext("2d");Da=g.Transformation.createScale(K,-K);Da.translate(.5*Q.width-ha,.5*Q.height+Ea);sa=new g.CanvasDrawHelper(X,sa,Da);switch(Z.type){case "CIMPointSymbol":sa.drawSymbol(Z,
{type:"point",x:0,y:0});break;case "CIMVectorMarker":Da=new k.Placement,sa.drawMarker(Z,Da)}Z=X.getImageData(0,0,Q.width,Q.height);Z=new Uint8Array(Z.data);if(Aa)for(sa=0;sa<Z.length;sa+=4)Aa=Z[sa+3]/255,Z[sa]*=Aa,Z[sa+1]*=Aa,Z[sa+2]*=Aa;return[Z,Q.width,Q.height,-ha/Q.width,-Ea/Q.height]};P.fromTextSymbol=function(Q){const {angle:Z,color:X,font:sa,haloColor:Aa,haloSize:Da,horizontalAlignment:ha,kerning:Ea,text:za,verticalAlignment:N,xoffset:S,yoffset:ea,backgroundColor:oa,borderLineColor:va,borderLineSize:W}=
Q;let ca,ka,la;if(sa){var ma=sa.family;var ua=sa.style;var xa=sa.weight;ca=sa.size;ka=sa.decoration}Q=!1;za&&(Q=C.bidiText(za)[1]);if(oa||W)la={type:"CIMBackgroundCallout",margin:null,backgroundSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",color:fa(oa)},{type:"CIMSolidStroke",color:fa(va),width:W}]},accentBarSymbol:null,gap:null,leaderLineSymbol:null,lineStyle:null};var ia=e.BlockProgression.BTT,na=e.FontEffects.Normal,ya=e.FontEncoding.Unicode;ma=ma||"Arial";b:{if(xa)switch(xa.toLowerCase()){case "bold":case "bolder":xa=
"bold";break b}xa=""}b:{if(ua)switch(ua.toLowerCase()){case "italic":case "oblique":ua="italic";break b}ua=""}xa=xa&&ua?`${xa}-${ua}`:`${xa}${ua}`;return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPointUnits:"Relative",dominantSizeAxis3D:"Y",size:10,billboardMode3D:"FaceNearPlane",frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:{type:"CIMTextSymbol",angle:Z,blockProgression:ia,depth3D:1,extrapolateBaselines:!0,
fontEffects:na,fontEncoding:ya,fontFamilyName:ma,fontStyleName:xa,fontType:e.FontType.Unspecified,haloSize:Da,height:ca,hinting:e.GlyphHinting.Default,horizontalAlignment:T(ha??"center"),kerning:Ea,letterWidth:100,ligatures:!0,lineGapType:"Multiple",offsetX:a.getValue(S),offsetY:a.getValue(ea),strikethrough:"line-through"===ka,underline:"underline"===ka,symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:fa(X)}]},haloSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",
enable:!0,color:fa(Aa)}]},shadowColor:[0,0,0,255],shadowOffsetX:1,shadowOffsetY:1,textCase:"Normal",textDirection:Q?e.TextReadingDirection.RTL:e.TextReadingDirection.LTR,verticalAlignment:Y(N??"baseline"),verticalGlyphOrientation:e.VerticalGlyphOrientation.Right,wordSpacing:100,billboardMode3D:e.BillBoardMode.FaceNearPlane,callout:la},textString:za}],scaleSymbolsProportionally:!0,respectFrame:!0}],scaleX:1,angleAlignment:"Display"}};P.fromPictureFillSymbol=function(Q){const {height:Z,outline:X,width:sa,
xoffset:Aa,xscale:Da,yoffset:ha,yscale:Ea}=Q,za=[],N={type:"CIMPolygonSymbol",symbolLayers:za};if(X){const {cap:ea,join:oa,miterLimit:va,width:W}=X;za.push({type:"CIMSolidStroke",color:fa(X.color),capStyle:E(ea),joinStyle:M(oa),miterLimit:va,width:W})}let S=Q.url;"esriPFS"===Q.type&&Q.imageData&&(S=Q.imageData);Q="angle"in Q?Q.angle??0:0;za.push({type:"CIMPictureFill",invertBackfaceTexture:!1,scaleX:1,textureFilter:e.TextureFilter.Picture,tintColor:null,url:S,height:(Z??0)*(Ea||1),width:(sa??0)*(Da||
1),offsetX:a.getValue(Aa),offsetY:a.getValue(ha),rotation:a.getValue(-Q),colorSubstitutions:null});return N};P.fromSimpleFillSymbol=function(Q){const {color:Z,style:X,outline:sa}=Q;Q=[];const Aa={type:"CIMPolygonSymbol",symbolLayers:Q};var Da=null;if(sa){const {cap:ha,join:Ea,style:za}=sa;"solid"!==za&&"none"!==za&&"esriSLSSolid"!==za&&"esriSLSNull"!==za&&(Da=[{type:"CIMGeometricEffectDashes",dashTemplate:ba(za,ha),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]);Q.push({type:"CIMSolidStroke",
color:fa(sa.color),capStyle:E(ha),joinStyle:M(Ea),miterLimit:sa.miterLimit,width:sa.width,effects:Da})}if(X&&"solid"!==X&&"none"!==X&&"esriSFSSolid"!==X&&"esriSFSNull"!==X){Da={type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",color:fa(Z),capStyle:e.LineCapStyle.Butt,joinStyle:e.LineJoinStyle.Miter,width:.75}]};let ha=0;const Ea=h.px2pt("vertical"===X||"horizontal"===X||"cross"===X||"esriSFSCross"===X||"esriSFSVertical"===X||"esriSFSHorizontal"===X?8:10);switch(X){case "vertical":case "esriSFSVertical":ha=
90;break;case "forward-diagonal":case "esriSFSForwardDiagonal":ha=-45;break;case "backward-diagonal":case "esriSFSBackwardDiagonal":ha=45;break;case "cross":case "esriSFSCross":ha=0;break;case "diagonal-cross":case "esriSFSDiagonalCross":ha=-45}Q.push({type:"CIMHatchFill",lineSymbol:Da,offsetX:0,offsetY:0,rotation:ha,separation:Ea});"cross"===X||"esriSFSCross"===X?Q.push({type:"CIMHatchFill",lineSymbol:w.clone(Da),offsetX:0,offsetY:0,rotation:90,separation:Ea}):("diagonal-cross"===X||"esriSFSDiagonalCross"===
X)&&Q.push({type:"CIMHatchFill",lineSymbol:w.clone(Da),offsetX:0,offsetY:0,rotation:45,separation:Ea})}else!X||"solid"!==X&&"esriSFSSolid"!==X||Q.push({type:"CIMSolidFill",enable:!0,color:fa(Z)});return Aa};P.fromSimpleLineSymbol=function(Q){const {cap:Z,color:X,join:sa,marker:Aa,miterLimit:Da,style:ha,width:Ea}=Q;Q=null;"solid"!==ha&&"none"!==ha&&"esriSLSSolid"!==ha&&"esriSLSNull"!==ha&&(Q=[{type:"CIMGeometricEffectDashes",dashTemplate:ba(ha,Z),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]);
const za=[];if(Aa){let N;switch(Aa.placement){case "begin-end":N=e.ExtremityPlacement.Both;break;case "begin":N=e.ExtremityPlacement.JustBegin;break;case "end":N=e.ExtremityPlacement.JustEnd;break;default:N=e.ExtremityPlacement.None}const S=P.fromSimpleMarker(Aa,Ea,X).symbolLayers[0];S.markerPlacement={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:N,offsetAlongLine:0};za.push(S)}"none"!==ha&&"esriSLSNull"!==ha&&za.push({type:"CIMSolidStroke",color:fa(X),capStyle:E(Z),
joinStyle:M(sa),miterLimit:Da,width:Ea,effects:Q});return{type:"CIMLineSymbol",symbolLayers:za}};P.fromPictureMarker=function(Q){const {angle:Z,height:X,width:sa,xoffset:Aa,yoffset:Da}=Q;let ha=Q.url;"esriPMS"===Q.type&&Q.imageData&&(ha=Q.imageData);return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMPictureMarker",invertBackfaceTexture:!1,scaleX:1,textureFilter:e.TextureFilter.Picture,tintColor:null,url:ha,size:X,width:sa,offsetX:a.getValue(Aa),offsetY:a.getValue(Da),rotation:a.getValue(-Z)}]}};
P.fromSimpleMarker=function(Q,Z,X){var {style:sa}=Q;X=Q.color??X;if("path"===sa){Z=[];"outline"in Q&&Q.outline&&(sa=Q.outline,Z.push({type:"CIMSolidStroke",enable:!0,width:h.pt2px(Math.round(h.px2pt(sa.width))),color:fa(sa.color)}));Z.push({type:"CIMSolidFill",enable:!0,color:fa(X),path:Q.path});const [Ea,za]=U("square");return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:a.getValue(-Q.angle),size:a.getValue(Q.size||6),offsetX:a.getValue(Q.xoffset),offsetY:a.getValue(Q.yoffset),
frame:Ea,markerGraphics:[{type:"CIMMarkerGraphic",geometry:za,symbol:{type:"CIMPolygonSymbol",symbolLayers:Z}}]}]}}const [Aa,Da]=U(sa);if(Da&&Aa){sa=[];if("outline"in Q&&Q.outline){var ha=Q.outline;sa.push({type:"CIMSolidStroke",enable:!0,width:null!=ha.width&&.667<ha.width?h.pt2px(Math.round(h.px2pt(ha.width))):ha.width,color:fa(ha.color)})}else!Z||"line-marker"!==Q.type||"cross"!==Q.style&&"x"!==Q.style||sa.push({type:"CIMSolidStroke",enable:!0,width:Z,color:fa(X)});sa.push({type:"CIMSolidFill",
enable:!0,color:fa(X)});X={type:"CIMPolygonSymbol",symbolLayers:sa};ha={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:a.getValue(-Q.angle),size:a.getValue(Q.size||6*Z),offsetX:a.getValue(Q.xoffset),offsetY:a.getValue(Q.yoffset),frame:Aa,markerGraphics:[{type:"CIMMarkerGraphic",geometry:Da,symbol:X}]}]}}return ha};P.fromCIMHatchFill=function(Q,Z){const X=Z*(Q.separation??4),sa=X/2;Q=w.clone(Q.lineSymbol);Q.symbolLayers?.forEach(Da=>{switch(Da.type){case "CIMSolidStroke":null!=
Da.width&&(Da.width*=Z);Da.effects?.forEach(ha=>{"CIMGeometricEffectDashes"===ha.type&&(ha.dashTemplate=ha.dashTemplate.map(Ea=>Ea*Z))});break;case "CIMVectorMarker":null!=Da.size&&(Da.size*=Z),Da=Da.markerPlacement,null!=Da&&"placementTemplate"in Da&&(Da.placementTemplate=Da.placementTemplate.map(ha=>ha*Z))}});for(var Aa=this._getLineSymbolPeriod(Q)||4;4>Aa;)Aa*=2;Aa/=2;return{type:"CIMVectorMarker",frame:{xmin:-Aa,xmax:Aa,ymin:-sa,ymax:sa},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[-Aa,
0],[Aa,0]]]},symbol:Q}],size:X}};P.fetchResources=function(Q,Z,X){if(Q&&Z)switch(Q.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(Q=Q.symbolLayers)for(const sa of Q)switch(r(sa,Z,X),sa.type){case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMCharacterMarker":case "CIMPictureMarker":"url"in sa&&sa.url&&X.push(Z.fetchResource(sa.url,null));break;case "CIMVectorMarker":if(Q=sa.markerGraphics)for(const Aa of Q)Aa&&
(Q=Aa.symbol)&&P.fetchResources(Q,Z,X)}}};P._getLineSymbolPeriod=function(Q){if(Q){const Z=this._getEffectsRepeat(Q.effects);if(Z)return Z;if(Q.symbolLayers)for(const X of Q.symbolLayers)if(X){if(Q=this._getEffectsRepeat(X.effects))return Q;switch(X.type){case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":case "CIMObjectMarker3D":case "CIMglTFMarker3D":if(Q=this._getPlacementRepeat(X.markerPlacement))return Q}}}return 0};P._getEffectsRepeat=function(Q){if(Q)for(var Z of Q)if(Z)switch(Z.type){case "CIMGeometricEffectDashes":if((Q=
Z.dashTemplate)&&Q.length){Z=0;for(const X of Q)Z+=X;Q.length&1&&(Z*=2);return Z}break;case "CIMGeometricEffectWave":return Z.period;default:A.error(`unsupported geometric effect type ${Z.type}`)}return 0};P._getPlacementRepeat=function(Q){if(Q)switch(Q.type){case "CIMMarkerPlacementAlongLineSameSize":case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineVariableSize":if((Q=Q.placementTemplate)&&Q.length){let Z=0;for(const X of Q)Z+=+X;Q.length&1&&(Z*=2);return Z}}return 0};
P.fromCIMInsidePolygon=function(Q){var Z=Q.markerPlacement;const X={...Q,markerPlacement:null,anchorPoint:null};Q=Math.abs(Z.stepX);const sa=Math.abs(Z.stepY);var Aa=(Z.randomness??100)/100;let Da,ha;if("Random"===Z.gridType){var Ea=h.px2pt(q.RANDOM_INSIDE_POLYGON_TEXTURE_SIZE);const za=Math.max(Math.floor(Ea/Q),1),N=Math.max(Math.floor(Ea/sa),1);Ea=za*Q/2;Da=N*sa/2;ha=2*Da;Z=new m(Z.seed);const S=Aa*Q/1.5,ea=Aa*sa/1.5;Aa=[];for(let oa=0;oa<za;oa++)for(let va=0;va<N;va++){const W=oa*Q-Ea+S*(.5-Z.getFloat()),
ca=va*sa-Da+ea*(.5-Z.getFloat());Aa.push({x:W,y:ca});0===oa&&Aa.push({x:W+2*Ea,y:ca});0===va&&Aa.push({x:W,y:ca+2*Da})}}else!0===Z.shiftOddRows?(Ea=Q/2,Da=sa,ha=2*sa,Aa=[{x:-Ea,y:0},{x:Ea,y:0},{x:0,y:Da},{x:0,y:-Da}]):(Ea=Q/2,Da=sa/2,ha=sa,Aa=[{x:-Q,y:0},{x:0,y:-sa},{x:-Q,y:-sa},{x:0,y:0},{x:Q,y:0},{x:0,y:sa},{x:Q,y:sa},{x:-Q,y:sa},{x:Q,y:-sa}]);Q=Aa.map(za=>({type:"CIMMarkerGraphic",geometry:za,symbol:{type:"CIMPointSymbol",symbolLayers:[X]}}));return{type:"CIMVectorMarker",frame:{xmin:-Ea,xmax:Ea,
ymin:-Da,ymax:Da},markerGraphics:Q,size:ha}};P.getSize=function(Q){if(Q)switch(Q.type){case "CIMTextSymbol":return Q.height;case "CIMPointSymbol":var Z=0;if(Q.symbolLayers)for(var X of Q.symbolLayers)if(X)switch(X.type){case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":case "CIMObjectMarker3D":case "CIMglTFMarker3D":Q=X.size,null!=Q&&Q>Z&&(Z=Q)}return Z;case "CIMLineSymbol":case "CIMPolygonSymbol":X=0;if(Q.symbolLayers)for(Z of Q.symbolLayers)if(Z)switch(Z.type){case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":Q=
Z.width;null!=Q&&Q>X&&(X=Q);break;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":case "CIMObjectMarker3D":case "CIMglTFMarker3D":Z.markerPlacement&&a.isCIMMarkerStrokePlacement(Z.markerPlacement)&&(Q=Z.size,null!=Q&&Q>X&&(X=Q))}return X}};P.getMarkerScaleRatio=function(Q){if(Q)switch(Q.type){case "CIMVectorMarker":if(!1!==Q.scaleSymbolsProportionally&&Q.frame&&null!=Q.size)return Q.size/(Q.frame.ymax-Q.frame.ymin)}return 1};return P}(),G=function(){function P(){}P.findApplicableOverrides=
function(Q,Z,X){if(Q&&Z){if(Q.primitiveName){let sa=!1;for(const Aa of X)if(Aa.primitiveName===Q.primitiveName){sa=!0;break}if(!sa)for(const Aa of Z)Aa.primitiveName===Q.primitiveName&&X.push(Aa)}switch(Q.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(Q.effects)for(const sa of Q.effects)P.findApplicableOverrides(sa,Z,X);if(Q.symbolLayers)for(const sa of Q.symbolLayers)P.findApplicableOverrides(sa,Z,X);break;case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMSolidFill":case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMVectorMarker":case "CIMCharacterMarker":case "CIMPictureMarker":if(Q.effects)for(const sa of Q.effects)P.findApplicableOverrides(sa,
Z,X);Q.markerPlacement&&P.findApplicableOverrides(Q.markerPlacement,Z,X);if("CIMVectorMarker"===Q.type){if(Q.markerGraphics)for(const sa of Q.markerGraphics)P.findApplicableOverrides(sa,Z,X),P.findApplicableOverrides(sa.symbol,Z,X)}else"CIMCharacterMarker"===Q.type?P.findApplicableOverrides(Q.symbol,Z,X):"CIMHatchFill"===Q.type?P.findApplicableOverrides(Q.lineSymbol,Z,X):"CIMPictureMarker"===Q.type&&P.findApplicableOverrides(Q.animatedSymbolProperties,Z,X)}}};P.findEffectOverrides=function(Q,Z,X){if(Z&&
Q){var sa=Q.length;for(let Aa=0;Aa<sa;Aa++){const Da=Q[Aa]?.primitiveName;if(Da){let ha=!1;for(const Ea of X)if(Ea.primitiveName===Da){ha=!0;break}if(!ha)for(const Ea of Z)Ea.primitiveName===Da&&X.push(Ea)}}}};P.resolveSymbolOverrides=function(){var Q=t._asyncToGenerator(function*(Z,X,sa,Aa,Da,ha,Ea){if(!Z||!Z.symbol)return null;let {symbol:za,primitiveOverrides:N}=Z;Z=!!N;if(!Z&&!Aa)return za;za=w.clone(za);let S=!0;X||(X={attributes:{}},S=!1);Z&&(S||(N=N.filter(ea=>!ea.valueExpressionInfo?.expression.includes("$feature"))),
Ea||(N=N.filter(ea=>!ea.valueExpressionInfo?.expression.includes("$view"))),0<N.length&&(Z=a.attributesToFields(X.attributes),yield P.evaluateOverrides(N,X,{spatialReference:sa,fields:Z,geometryType:Da},ha,Ea)),P.applyOverrides(za,N));Aa&&P.applyDictionaryTextOverrides(za,X,Aa);return za});return function(Z,X,sa,Aa,Da,ha,Ea){return Q.apply(this,arguments)}}();P.evaluateOverrides=function(){var Q=t._asyncToGenerator(function*(Z,X,sa,Aa,Da){if(X){var ha;for(const Ea of Z)(Z=Ea.valueExpressionInfo)&&
sa&&sa.geometryType&&(ha||(ha=[]),Ea.value=void 0,Z=f.createRendererExpression(Z.expression,sa.spatialReference,sa.fields).then(za=>{Ea.value=b(za,X,{$view:Da},sa.geometryType,Aa)}),ha.push(Z));void 0!==ha&&0<ha.length&&(yield Promise.all(ha))}});return function(Z,X,sa,Aa,Da){return Q.apply(this,arguments)}}();P.applyDictionaryTextOverrides=function(Q,Z,X,sa="Normal"){if(Q&&Q.type)switch(Q.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":case "CIMTextSymbol":var Aa=Q.symbolLayers;
if(!Aa)break;for(var Da of Aa)Da&&"CIMVectorMarker"===Da.type&&P.applyDictionaryTextOverrides(Da,Z,X,"CIMTextSymbol"===Q.type?Q.textCase:sa);break;case "CIMVectorMarker":Q=Q.markerGraphics;if(!Q)break;for(Aa of Q)Aa&&P.applyDictionaryTextOverrides(Aa,Z,X);break;case "CIMMarkerGraphic":(Da=Q.textString)&&Da.includes("[")&&(X=a.analyzeTextParts(Da,X),Q.textString=a.assignTextValuesFromFeature(Z,X,sa))}};P.applyOverrides=function(Q,Z,X,sa){if(Q.primitiveName)for(const Da of Z)if(Da.primitiveName===Q.primitiveName){var Aa=
(Aa=Da.propertyName)?Aa.charAt(0).toLowerCase()+Aa.substr(1):Aa;sa&&sa.push({cim:Q,nocapPropertyName:Aa,value:Q[Aa]});Da.expression&&(Da.value=P.toValue(Da.propertyName,Da.expression));if(X){let ha=!1;for(const Ea of X)Ea.primitiveName===Q.primitiveName&&(ha=!0);ha||X.push(Da)}x.isSome(Da.value)&&(Q[Aa]=Da.value)}switch(Q.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(Q.effects)for(const Da of Q.effects)P.applyOverrides(Da,Z,X,sa);if(Q.symbolLayers)for(const Da of Q.symbolLayers)P.applyOverrides(Da,
Z,X,sa);break;case "CIMSolidStroke":case "CIMSolidFill":case "CIMVectorMarker":if(Q.effects)for(const Da of Q.effects)P.applyOverrides(Da,Z,X,sa);if("CIMVectorMarker"===Q.type&&Q.markerGraphics)for(const Da of Q.markerGraphics)P.applyOverrides(Da,Z,X,sa),P.applyOverrides(Da.symbol,Z,X,sa)}};P.restoreOverrides=function(Q){for(const Z of Q)Z.cim[Z.nocapPropertyName]=Z.value};P.buildOverrideKey=function(Q){let Z="";for(const X of Q)void 0!==X.value&&(Z+=`${X.primitiveName}${X.propertyName}${JSON.stringify(X.value)}`);
return Z};P.toValue=function(Q,Z){return"DashTemplate"===Q?Z.split(" ").map(X=>Number(X)):"Color"===Q?(Q=(new H(Z)).toRgba(),Q[3]*=255,Q):Z};return P}();const E=P=>{if(!P)return e.LineCapStyle.Butt;switch(P){case "butt":return e.LineCapStyle.Butt;case "square":return e.LineCapStyle.Square;case "round":return e.LineCapStyle.Round}},M=P=>{if(!P)return e.LineJoinStyle.Miter;switch(P){case "miter":return e.LineJoinStyle.Miter;case "round":return e.LineJoinStyle.Round;case "bevel":return e.LineJoinStyle.Bevel}},
T=P=>{if(x.isNone(P))return"Center";switch(P){case "left":return"Left";case "right":return"Right";case "center":return"Center"}},Y=P=>{if(x.isNone(P))return"Center";switch(P){case "baseline":return"Baseline";case "top":return"Top";case "middle":return"Center";case "bottom":return"Bottom"}},fa=P=>{if(!P)return[0,0,0,0];const {r:Q,g:Z,b:X,a:sa}=P;return[Q,Z,X,255*sa]},ba=(P,Q)=>{Q="butt"===Q;switch(P){case "dash":case "esriSLSDash":return Q?[4,3]:[3,4];case "dash-dot":case "esriSLSDashDot":return Q?
[4,3,1,3]:[3,4,0,4];case "dot":case "esriSLSDot":return Q?[1,3]:[0,4];case "long-dash":case "esriSLSLongDash":return Q?[8,3]:[7,4];case "long-dash-dot":case "esriSLSLongDashDot":return Q?[8,3,1,3]:[7,4,0,4];case "long-dash-dot-dot":case "esriSLSDashDotDot":return Q?[8,3,1,3,1,3]:[7,4,0,4,0,4];case "short-dash":case "esriSLSShortDash":return Q?[4,1]:[3,2];case "short-dash-dot":case "esriSLSShortDashDot":return Q?[4,1,1,1]:[3,2,0,2];case "short-dash-dot-dot":case "esriSLSShortDashDotDot":return Q?[4,
1,1,1,1,1]:[3,2,0,2,0,2];case "short-dot":case "esriSLSShortDot":return Q?[1,1]:[0,2];case "solid":case "esriSLSSolid":case "none":return A.error("Unexpected: style does not require rasterization"),[0,0];default:return A.error(`Tried to rasterize SLS, but found an unexpected style: ${P}!`),[0,0]}},U=P=>{if("circle"===P||"esriSMSCircle"===P){var Q=Math.acos(.995);P=Math.ceil(D/Q/4);0===P&&(P=1);Q=J/P;P*=4;var Z=[];Z.push([50,0]);for(let X=1;X<P;X++)Z.push([50*Math.cos(X*Q),-50*Math.sin(X*Q)]);Z.push([50,
0]);Q={rings:[Z]};Z={xmin:-50,ymin:-50,xmax:50,ymax:50}}else"cross"===P||"esriSMSCross"===P?(Q={rings:[[[0,50],[0,0],[50,0],[50,-0],[0,-0],[0,-50],[-0,-50],[-0,-0],[-50,-0],[-50,0],[-0,0],[-0,50],[0,50]]]},Z={xmin:-50,ymin:-50,xmax:50,ymax:50}):"diamond"===P||"esriSMSDiamond"===P?(Q={rings:[[[-50,0],[0,50],[50,0],[0,-50],[-50,0]]]},Z={xmin:-50,ymin:-50,xmax:50,ymax:50}):"square"===P||"esriSMSSquare"===P?(Q={rings:[[[-50,-50],[-50,50],[50,50],[50,-50],[-50,-50]]]},Z={xmin:-50,ymin:-50,xmax:50,ymax:50}):
"x"===P||"esriSMSX"===P?(Q={rings:[[[0,0],[50,50],[50,50],[0,0],[50,-50],[50,-50],[0,-0],[-50,-50],[-50,-50],[-0,0],[-50,50],[-50,50],[0,0]]]},Z={xmin:-50,ymin:-50,xmax:50,ymax:50}):"triangle"===P||"esriSMSTriangle"===P?(P=2/3*100,Z=P-100,Q={rings:[[[-57.735026918962575,Z],[0,P],[57.735026918962575,Z],[-57.735026918962575,Z]]]},Z={xmin:-57.735026918962575,ymin:Z,xmax:57.735026918962575,ymax:P}):"arrow"===P&&(Q={rings:[[[-50,50],[50,0],[-50,-50],[-33,-20],[-33,20],[-50,50]]]},Z={xmin:-50,ymin:-50,
xmax:50,ymax:50});return[Z,Q]};u.CIMSymbolHelper=I;u.CIMSymbolInflatedSizeHelper=y;u.OverrideHelper=G;u.slsDashToTemplateArray=ba;u.symbolToCIM=function(P){if(!P||!P.type)return null;let Q;switch(P.type){case "cim":return P.data;case "web-style":return P;case "simple-marker":P=I.fromSimpleMarker(P);if(!P)return null;Q=P;break;case "picture-marker":Q=I.fromPictureMarker(P);break;case "simple-line":Q=I.fromSimpleLineSymbol(P);break;case "simple-fill":Q=I.fromSimpleFillSymbol(P);break;case "picture-fill":Q=
I.fromPictureFillSymbol(P);break;case "text":Q=I.fromTextSymbol(P)}return{type:"CIMSymbolReference",symbol:Q}};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/CIMSymbolDrawHelper":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/BidiText ../../core/fontUtils ../../core/lang ../../core/Logger ../../core/maybe ../../core/ObjectPool ../../core/screenUtils ../../geometry/support/aaBoundingRect ../../geometry/support/boundsUtils ../../geometry/support/centroid ../../geometry/support/jsonUtils ./CIMEffects ./CIMImageColorSubstitutionHelper ./CIMOperators ./CIMPlacements ./enums ./imageUtils ./Rect ./TextRasterizer ./utils ../../views/2d/engine/webgl/alignmentUtils ../../views/2d/engine/webgl/definitions ../../views/2d/engine/webgl/mesh/templates/shapingUtils".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f,k,g,e,a,b,l,q,n,v,B,z,p,r){function D(fa,ba=1){const U=B.fromCIMFontDecoration(fa);var P=B.fromCIMFontStyle(fa.fontStyleName);const Q=C.getFontFamily(fa.fontFamilyName),{weight:Z,style:X}=P;P=ba*(fa.height||5);const sa=B.fromCIMHorizontalAlignment(fa.horizontalAlignment),Aa=B.fromCIMVerticalAlignment(fa.verticalAlignment),Da=B.getFillColor(fa),ha=B.getStrokeColor(fa.haloSymbol);fa=ha?ba*(fa.haloSize|0):0;return{color:Da,size:P,horizontalAlignment:sa,verticalAlignment:Aa,
font:{family:Q,style:B.getFontStyle(X),weight:B.getFontWeight(Z),decoration:U},halo:{size:fa||0,color:ha,style:X},pixelRatio:1,premultiplyColors:!0}}const J=Math.PI/180,K=y.getLogger("esri.symbols.cim.CIMSymbolDrawHelper");let F=function(){function fa(U){this._t=U}fa.createIdentity=function(){return new fa([1,0,0,0,1,0])};var ba=fa.prototype;ba.clone=function(){return new fa(this._t.slice())};ba.transform=function(U){const P=this._t;return[P[0]*U[0]+P[1]*U[1]+P[2],P[3]*U[0]+P[4]*U[1]+P[5]]};fa.createScale=
function(U,P){return new fa([U,0,0,0,P,0])};ba.scale=function(U,P){const Q=this._t;Q[0]*=U;Q[1]*=U;Q[2]*=U;Q[3]*=P;Q[4]*=P;Q[5]*=P;return this};ba.scaleRatio=function(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])};fa.createTranslate=function(U,P){return new fa([0,0,U,0,0,P])};ba.translate=function(U,P){const Q=this._t;Q[2]+=U;Q[5]+=P;return this};fa.createRotate=function(U){const P=Math.cos(U);U=Math.sin(U);return new fa([P,-U,0,U,P,0])};ba.rotate=function(U){return fa.multiply(this,
fa.createRotate(U),this)};ba.angle=function(){const U=this._t[0],P=this._t[3],Q=Math.sqrt(U*U+P*P);return[U/Q,P/Q]};fa.multiply=function(U,P,Q){U=U._t;P=P._t;const Z=U[1]*P[0]+U[4]*P[1],X=U[2]*P[0]+U[5]*P[1]+P[2],sa=U[0]*P[3]+U[3]*P[4],Aa=U[1]*P[3]+U[4]*P[4],Da=U[2]*P[3]+U[5]*P[4]+P[5],ha=Q._t;ha[0]=U[0]*P[0]+U[3]*P[1];ha[1]=Z;ha[2]=X;ha[3]=sa;ha[4]=Aa;ha[5]=Da;return Q};ba.invert=function(){const U=this._t;let P=U[0]*U[4]-U[1]*U[3];if(0===P)return new fa([0,0,0,0,0,0]);P=1/P;return new fa([U[4]*
P,-U[1]*P,(U[1]*U[5]-U[2]*U[4])*P,-U[3]*P,U[0]*P,(U[2]*U[3]-U[0]*U[5])*P])};return fa}();y=function(){function fa(U,P){this._resourceManager=U;this._transfos=[];this._sizeTransfos=[];this._geomUnitsPerPoint=1;this._placementPool=new m(b.Placement,void 0,void 0,100);this._earlyReturn=!1;this._mapRotation=0;this._transfos.push(P||F.createIdentity());this._sizeTransfos.push(P?P.scaleRatio():1)}var ba=fa.prototype;ba.setTransform=function(U,P){this._transfos=[U||F.createIdentity()];this._sizeTransfos=
[P?P:U?U.scaleRatio():1]};ba.setGeomUnitsPerPoint=function(U){this._geomUnitsPerPoint=U};ba.transformPt=function(U){return this._transfos[this._transfos.length-1].transform(U)};ba.transformSize=function(U){return U*this._sizeTransfos[this._sizeTransfos.length-1]};ba.reverseTransformPt=function(U){return this._transfos[this._transfos.length-1].invert().transform(U)};ba.reverseTransformSize=function(U){return U/this._sizeTransfos[this._sizeTransfos.length-1]};ba.getTransformAngle=function(){return this._transfos[this._transfos.length-
1].angle()};ba.geomUnitsPerPoint=function(){return this.isEmbedded()?1:this._geomUnitsPerPoint};ba.isEmbedded=function(){return 1<this._transfos.length};ba.back=function(){return this._transfos[this._transfos.length-1]};ba.push=function(U,P){P=P?U.scaleRatio():1;F.multiply(U,this.back(),U);this._transfos.push(U);this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*P)};ba.pop=function(){this._transfos.splice(-1,1);this._sizeTransfos.splice(-1,1)};ba.drawSymbol=function(U,P,Q){if(U)switch(U.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":this.drawMultiLayerSymbol(U,
P);break;case "CIMTextSymbol":this.drawTextSymbol(U,P,Q)}};ba.drawMultiLayerSymbol=function(U,P){if(U&&P){var Q=U.symbolLayers;if(Q)if((U=U.effects)&&0<U.length){if(P=this.executeEffects(U,P))for(U=P.next();U;)this.drawSymbolLayers(Q,U),U=P.next()}else this.drawSymbolLayers(Q,P)}};ba.executeEffects=function(U,P){const Q=this._resourceManager.geometryEngine;P=new g.SimpleGeometryCursor(P);for(const Z of U)(U=a.getEffectOperator(Z))&&(P=U.execute(P,Z,this.geomUnitsPerPoint(),null,Q));return P};ba.drawSymbolLayers=
function(U,P){let Q=U.length;for(;Q--;){const X=U[Q];if(X&&!1!==X.enable){var Z=X.effects;if(Z&&0<Z.length){if(Z=this.executeEffects(Z,P)){let sa=null;for(;(sa=Z.next())&&(this.drawSymbolLayer(X,sa),!this._earlyReturn););}}else this.drawSymbolLayer(X,P);if(this._earlyReturn)break}}};ba.drawSymbolLayer=function(U,P){switch(U.type){case "CIMSolidFill":this.drawSolidFill(P,U.color);break;case "CIMHatchFill":this.drawHatchFill(P,U);break;case "CIMPictureFill":this.drawPictureFill(P,U);break;case "CIMGradientFill":this.drawGradientFill(P,
U);break;case "CIMSolidStroke":this.drawSolidStroke(P,U.color,U.width,U.capStyle,U.joinStyle,U.miterLimit);break;case "CIMPictureStroke":this.drawPictureStroke(P,U);break;case "CIMGradientStroke":this.drawGradientStroke(P,U);break;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":this.drawMarkerLayer(U,P)}};ba.drawHatchFill=function(U,P){const Q=this._buildHatchPolyline(P,U,this.geomUnitsPerPoint());Q&&(this.pushClipPath(U),this.drawMultiLayerSymbol(P.lineSymbol,Q),this.popClipPath())};
ba.drawPictureFill=function(U,P){};ba.drawGradientFill=function(U,P){};ba.drawPictureStroke=function(U,P){};ba.drawGradientStroke=function(U,P){};ba.drawMarkerLayer=function(U,P){var Q=U.markerPlacement;if(Q){var Z=a.getPlacementOperator(Q);if(Z){var X="CIMMarkerPlacementInsidePolygon"===Q.type||"CIMMarkerPlacementPolygonCenter"===Q.type&&Q.clipAtBoundary;X&&this.pushClipPath(P);if(P=Z.execute(P,Q,this.geomUnitsPerPoint(),null,this._resourceManager.geometryEngine))for(Q=null;(Q=P.next())&&(this.drawMarker(U,
Q),!this._earlyReturn););X&&this.popClipPath()}}else{X=this._placementPool.acquire();if(k.isPoint(P))X.tx=P.x,X.ty=P.y,this.drawMarker(U,X);else if(k.isPolygon(P)){if(P=f.polygonCentroid(P))[X.tx,X.ty]=P,this.drawMarker(U,X)}else for(Z of P.points)if(X.tx=Z[0],X.ty=Z[1],this.drawMarker(U,X),this._earlyReturn)break;this._placementPool.release(X)}};ba.drawMarker=function(U,P){switch(U.type){case "CIMCharacterMarker":case "CIMPictureMarker":this.drawPictureMarker(U,P);break;case "CIMVectorMarker":this.drawVectorMarker(U,
P)}};ba.drawPictureMarker=function(U,P){if(U){var Q=this._resourceManager.getResource(U.url),Z=U.size??10;if(!(x.isNone(Q)||0>=Z)){var X=Q.width;Q=Q.height;if(X&&Q){Q=X/Q;var sa=U.scaleX??1;X=F.createIdentity();var Aa=U.anchorPoint;if(Aa){var Da=Aa.x;Aa=Aa.y;"Absolute"!==U.anchorPointUnits&&(Da*=Z*Q*sa,Aa*=Z);X.translate(-Da,-Aa)}Q=U.rotation??0;U.rotateClockwise&&(Q=-Q);this._mapRotation&&(Q+=this._mapRotation);Q&&X.rotate(Q*J);Q=U.offsetX??0;sa=U.offsetY??0;if(Q||sa){if(this._mapRotation){Aa=J*
this._mapRotation;Da=Math.cos(Aa);Aa=Math.sin(Aa);const ha=Q*Aa+sa*Da;Q=Q*Da-sa*Aa;sa=ha}X.translate(Q,sa)}Q=this.geomUnitsPerPoint();1!==Q&&X.scale(Q,Q);(Q=P.getAngle())&&X.rotate(Q);X.translate(P.tx,P.ty);this.push(X,!1);this.drawImage(U,Z);this.pop()}}}};ba.drawVectorMarker=function(U,P){if(U){var Q=U.markerGraphics;if(Q){var Z=U.size??10,X=U.frame,sa=X?X.ymax-X.ymin:0;sa=Z&&sa?Z/sa:1;Z=F.createIdentity();X&&Z.translate(.5*-(X.xmax+X.xmin),.5*-(X.ymax+X.ymin));var Aa=U.anchorPoint;if(Aa){var Da=
Aa.x;Aa=Aa.y;"Absolute"!==U.anchorPointUnits?X&&(Da*=X.xmax-X.xmin,Aa*=X.ymax-X.ymin):(Da/=sa,Aa/=sa);Z.translate(-Da,-Aa)}1!==sa&&Z.scale(sa,sa);X=U.rotation??0;U.rotateClockwise&&(X=-X);this._mapRotation&&(X+=this._mapRotation);X&&Z.rotate(X*J);X=U.offsetX??0;sa=U.offsetY??0;if(X||sa){if(this._mapRotation){Aa=J*this._mapRotation;Da=Math.cos(Aa);Aa=Math.sin(Aa);const ha=X*Aa+sa*Da;X=X*Da-sa*Aa;sa=ha}Z.translate(X,sa)}X=this.geomUnitsPerPoint();1!==X&&Z.scale(X,X);(X=P.getAngle())&&Z.rotate(X);Z.translate(P.tx,
P.ty);this.push(Z,U.scaleSymbolsProportionally);for(const ha of Q)if(ha&&ha.symbol&&ha.geometry||K.error("Invalid marker graphic",ha),this.drawSymbol(ha.symbol,ha.geometry,ha.textString),this._earlyReturn)break;this.pop()}}};ba.drawTextSymbol=function(U,P,Q){if(U&&k.isPoint(P)&&!(0>=(U.height??10))){var Z=F.createIdentity(),X=U.angle??0;(X=-X)&&Z.rotate(X*J);X=U.offsetX??0;var sa=U.offsetY??0;(X||sa)&&Z.translate(X,sa);X=this.geomUnitsPerPoint();1!==X&&Z.scale(X,X);Z.translate(P.x,P.y);this.push(Z,
!1);this.drawText(U,Q);this.pop()}};ba._buildHatchPolyline=function(U,P,Q){var Z=(void 0!==U.separation?U.separation:4)*Q,X=void 0!==U.rotation?U.rotation:0;if(0===Z)return null;0>Z&&(Z=-Z);for(var sa=0,Aa=.5*Z;sa>Aa;)sa-=Z;for(;sa<-Aa;)sa+=Z;sa=c.create();d.getBoundsXY(sa,P);sa[0]-=Aa;sa[1]-=Aa;sa[2]+=Aa;sa[3]+=Aa;for(var Da=[[sa[0],sa[1]],[sa[0],sa[3]],[sa[2],sa[3]],[sa[2],sa[1]]];180<X;)X-=180;for(;0>X;)X+=180;Aa=Math.cos(X*J);var ha=Math.sin(X*J);X=-Z*ha;P=Z*Aa;sa=(void 0!==U.offsetX?U.offsetX*
Q:0)*ha-(void 0!==U.offsetY?U.offsetY*Q:0)*Aa;let Ea;var za=U=Number.MAX_VALUE;Ea=Q=-Number.MAX_VALUE;for(var N of Da){var S=N[0];const ea=N[1];Da=Aa*S+ha*ea;S=-ha*S+Aa*ea;za=Math.min(za,Da);U=Math.min(U,S);Ea=Math.max(Ea,Da);Q=Math.max(Q,S)}U=Math.floor(U/Z)*Z;N=Aa*za-ha*U-X*sa/Z;za=ha*za+Aa*U-P*sa/Z;Da=Aa*Ea-ha*U-X*sa/Z;sa=ha*Ea+Aa*U-P*sa/Z;Z=1+Math.round((Q-U)/Z);Aa=[];for(ha=0;ha<Z;ha++)N+=X,za+=P,Da+=X,sa+=P,Aa.push([[N,za],[Da,sa]]);return{paths:Aa}};return fa}();let A=function(fa){function ba(P,
Q){P=fa.call(this,P,Q)||this;P.reset();return P}t._inheritsLoose(ba,fa);var U=ba.prototype;U.reset=function(){this._xmin=this._ymin=Infinity;this._xmax=this._ymax=-Infinity;this._clipCount=0};U.envelope=function(){return new n(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)};U.bounds=function(){return c.fromValues(this._xmin,this._ymin,this._xmax,this._ymax)};U.drawSolidFill=function(P){!P||0<this._clipCount||(k.isPolygon(P)?this._processPath(P.rings,0):k.isPolyline(P)?this._processPath(P.paths,
0):k.isExtent(P)?(P=E(P))&&this._processPath(P.rings,0):console.error("drawSolidFill Unexpected geometry type!"))};U.drawSolidStroke=function(P,Q,Z){!P||0<this._clipCount||(Q=.5*this.transformSize(Z??0),k.isPolygon(P)?this._processPath(P.rings,Q):k.isPolyline(P)?this._processPath(P.paths,Q):k.isExtent(P)?(P=E(P))&&this._processPath(P.rings,Q):console.error("drawSolidStroke unexpected geometry type!"))};U.drawMarkerLayer=function(P,Q){k.isPolygon(Q)&&P.markerPlacement&&("CIMMarkerPlacementInsidePolygon"===
P.markerPlacement.type||"CIMMarkerPlacementPolygonCenter"===P.markerPlacement.type&&P.markerPlacement.clipAtBoundary)?this._processPath(Q.rings,0):fa.prototype.drawMarkerLayer.call(this,P,Q)};U.drawHatchFill=function(P,Q){this.drawSolidFill(P)};U.drawPictureFill=function(P,Q){this.drawSolidFill(P)};U.drawGradientFill=function(P,Q){this.drawSolidFill(P)};U.drawPictureStroke=function(P,Q){this.drawSolidStroke(P,null,Q.width)};U.drawGradientStroke=function(P,Q){this.drawSolidStroke(P,null,Q.width)};
U.pushClipPath=function(P){this.drawSolidFill(P);this._clipCount++};U.popClipPath=function(){this._clipCount--};U.drawImage=function(P,Q){var {url:Z}=P;P=P.scaleX??1;let X=P*Q,sa=Q;Z=this._resourceManager.getResource(Z);!Q&&x.isSome(Z)&&(X=P*Z.width,sa=Z.height);this._merge(this.transformPt([-X/2,-sa/2]),0);this._merge(this.transformPt([-X/2,sa/2]),0);this._merge(this.transformPt([X/2,-sa/2]),0);this._merge(this.transformPt([X/2,sa/2]),0)};U.drawText=function(P,Q){if(Q&&0!==Q.length){this._textRasterizer||
(this._textRasterizer=new v);var Z=D(P),[X,sa]=this._textRasterizer.computeTextSize(Q,Z);Q=0;switch(P.horizontalAlignment){case "Left":Q=X/2;break;case "Right":Q=-X/2}Z=0;switch(P.verticalAlignment){case "Bottom":Z=sa/2;break;case "Top":Z=-sa/2;break;case "Baseline":Z=sa/6}this._merge(this.transformPt([-X/2+Q,-sa/2+Z]),0);this._merge(this.transformPt([-X/2+Q,sa/2+Z]),0);this._merge(this.transformPt([X/2+Q,-sa/2+Z]),0);this._merge(this.transformPt([X/2+Q,sa/2+Z]),0)}};U._processPath=function(P,Q){if(P)for(const Z of P)if(P=
Z?Z.length:0,1<P){this._merge(this.transformPt(Z[0]),Q);for(let X=1;X<P;X++)this._merge(this.transformPt(Z[X]),Q)}};U._merge=function(P,Q){P[0]-Q<this._xmin&&(this._xmin=P[0]-Q);P[0]+Q>this._xmax&&(this._xmax=P[0]+Q);P[1]-Q<this._ymin&&(this._ymin=P[1]-Q);P[1]+Q>this._ymax&&(this._ymax=P[1]+Q)};return ba}(y),I=function(fa){function ba(){var P=fa.apply(this,arguments)||this;P._searchPoint=[0,0];P._searchDistPoint=0;P._textInfo=null;return P}t._inheritsLoose(ba,fa);var U=ba.prototype;U.hitTest=function(P,
Q,Z,X,sa,Aa){Aa*=h.pt2px(1);this.setTransform();this.setGeomUnitsPerPoint(Aa);this._searchPoint=[(P[0]+P[2])/2,(P[1]+P[3])/2];this._searchDistPoint=(P[2]-P[0])/2/Aa;this._textInfo=X;this._mapRotation=Q&&("CIMPointSymbol"===Q.type&&"Map"!==Q.angleAlignment||"CIMTextSymbol"===Q.type)?sa:0;this._earlyReturn=!1;this.drawSymbol(Q,Z);return this._earlyReturn};U.drawSolidFill=function(P,Q){this._hitTestFill(P)};U.drawHatchFill=function(P,Q){this._hitTestFill(P)};U.drawPictureFill=function(P,Q){this._hitTestFill(P)};
U.drawGradientFill=function(P,Q){this._hitTestFill(P)};U.drawSolidStroke=function(P,Q,Z,X,sa,Aa){this._hitTestStroke(P,Z)};U.drawPictureStroke=function(P,Q){this._hitTestStroke(P,Q.width)};U.drawGradientStroke=function(P,Q){this._hitTestStroke(P,Q.width)};U.drawMarkerLayer=function(P,Q){P.markerPlacement&&("CIMMarkerPlacementInsidePolygon"===P.markerPlacement.type||"CIMMarkerPlacementPolygonCenter"===P.markerPlacement.type&&P.markerPlacement.clipAtBoundary)?this._hitTestFill(Q):fa.prototype.drawMarkerLayer.call(this,
P,Q)};U.pushClipPath=function(P){};U.popClipPath=function(){};U.drawImage=function(P,Q){var {url:Z}=P;P=P.scaleX??1;Z=this._resourceManager.getResource(Z);if(!x.isNone(Z)&&0!==Z.height&&0!==Q){Q*=this.geomUnitsPerPoint();P=Z.width/Z.height*P*Q;Z=this.reverseTransformPt(this._searchPoint);var X=this._searchDistPoint;Math.abs(Z[0])<P/2+X&&Math.abs(Z[1])<Q/2+X&&(this._earlyReturn=!0)}};U.drawText=function(P,Q){if(Q=this._textInfo)if(Q=Q.get(P)){var {text:Z,mosaicItem:X}=Q;if(X?.glyphMosaicItems?.length){Q=
P.height??10;var {lineGapType:sa,lineGap:Aa}=P,Da=sa?Y(sa,Aa??0,Q):0,ha=H.bidiText(Z)[1],Ea="CIMBackgroundCallout"===P.callout?.type;P=r.shapeGlyphs(X.glyphMosaicItems,ha,{scale:Q/p.GLYPH_SIZE,angle:0,xOffset:0,yOffset:0,hAlign:M(P.horizontalAlignment),vAlign:T(P.verticalAlignment),maxLineWidth:512,lineHeight:p.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(Da||1,4)),decoration:P.font.decoration||"none",isCIM:!0,hasBackground:Ea});Da=this.reverseTransformPt(this._searchPoint);Q=Da[0];Da=Da[1];for(const za of P.glyphs)if(Q>
za.xTopLeft&&Q<za.xBottomRight&&Da>-za.yBottomRight&&Da<-za.yTopLeft){this._earlyReturn=!0;break}}}};U._hitTestFill=function(P){let Q=null;if(k.isExtent(P))Q=[[[P.xmin,P.ymin],[P.xmin,P.ymax],[P.xmax,P.ymax],[P.xmax,P.ymin],[P.xmin,P.ymin]]];else if(k.isPolygon(P))Q=P.rings;else if(k.isPolyline(P))Q=P.paths;else return;P=this.reverseTransformPt(this._searchPoint);this._pointInPolygon(P,Q)&&(this._earlyReturn=!0);if(!this._earlyReturn){const Z=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();
this._nearLine(P,Q,Z)&&(this._earlyReturn=!0)}};U._hitTestStroke=function(P,Q){let Z=null;if(k.isExtent(P))Z=[[[P.xmin,P.ymin],[P.xmin,P.ymax],[P.xmax,P.ymax],[P.xmax,P.ymin],[P.xmin,P.ymin]]];else if(k.isPolygon(P))Z=P.rings;else if(k.isPolyline(P))Z=P.paths;else return;P=this.reverseTransformPt(this._searchPoint);Q=(Q??0)*this.geomUnitsPerPoint();const X=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(P,Z,Q/2+X)&&(this._earlyReturn=!0)};U._pointInPolygon=
function(P,Q){let Z=0;for(const X of Q){Q=X.length;for(let sa=1;sa<Q;sa++){const Aa=X[sa-1],Da=X[sa];Aa[1]>P[1]!==Da[1]>P[1]&&(0<(Da[0]-Aa[0])*(P[1]-Aa[1])-(Da[1]-Aa[1])*(P[0]-Aa[0])?Z++:Z--)}}return 0!==Z};U._nearLine=function(P,Q,Z){for(const sa of Q){Q=sa.length;for(let Aa=1;Aa<Q;Aa++){var X=sa[Aa-1];const Da=sa[Aa];let ha=(Da[0]-X[0])*(Da[0]-X[0])+(Da[1]-X[1])*(Da[1]-X[1]);if(0!==ha&&(ha=Math.sqrt(ha),Math.abs(((Da[0]-X[0])*(P[1]-X[1])-(Da[1]-X[1])*(P[0]-X[0]))/ha)<Z&&(X=((Da[0]-X[0])*(P[0]-X[0])+
(Da[1]-X[1])*(P[1]-X[1]))/ha,X>-Z&&X<ha+Z)))return!0}}return!1};return ba}(y),G=function(fa){function ba(P,Q,Z,X){Q=fa.call(this,Q,Z)||this;Q._applyAdditionalRenderProps=X;Q._colorSubstitutionHelper=new e;Q._ctx=P;return Q}t._inheritsLoose(ba,fa);var U=ba.prototype;U.drawSolidFill=function(P,Q){if(P){if(k.isPolygon(P))this._buildPath(P.rings,!0);else if(k.isPolyline(P))this._buildPath(P.paths,!0);else if(k.isExtent(P))this._buildPath(E(P).rings,!0);else if(k.isMultipoint(P))console.log("CanvasDrawHelper.drawSolidFill - No implementation!");
else return;P=this._ctx;P.fillStyle="string"===typeof Q?Q:"rgba("+Math.round(Q[0])+","+Math.round(Q[1])+","+Math.round(Q[2])+","+(Q[3]??255)/255+")";P.fill("evenodd")}};U.drawSolidStroke=function(P,Q,Z,X,sa,Aa){if(P&&Q&&0!==Z){if(k.isPolygon(P))this._buildPath(P.rings,!0);else if(k.isPolyline(P))this._buildPath(P.paths,!1);else if(k.isExtent(P))this._buildPath(E(P).rings,!0);else{console.log("CanvasDrawHelper.drawSolidStroke isn't implemented!");return}P=this._ctx;P.strokeStyle="string"===typeof Q?
Q:"rgba("+Math.round(Q[0])+","+Math.round(Q[1])+","+Math.round(Q[2])+","+(Q[3]??255)/255+")";P.lineWidth=Math.max(this.transformSize(Z),.5);this._setCapStyle(X);this._setJoinStyle(sa);P.miterLimit=Aa;P.stroke()}};U.pushClipPath=function(P){this._ctx.save();if(k.isPolygon(P))this._buildPath(P.rings,!0);else if(k.isPolyline(P))this._buildPath(P.paths,!0);else if(k.isExtent(P))this._buildPath(E(P).rings,!0);else return;this._ctx.clip("evenodd")};U.popClipPath=function(){this._ctx.restore()};U.drawImage=
function(P,Q){const {colorSubstitutions:Z,url:X,tintColor:sa}=P;P=P.scaleX??1;var Aa=this._resourceManager.getResource(X);if(!x.isNone(Aa)){var Da=Aa.width/Aa.height*Q,ha=Q;Q||(Da=Aa.width,ha=Aa.height);var Ea=B.isSVGImage(X)||"src"in Aa&&B.isSVGImage(Aa.src);Q="getFrame"in Aa?q.getFirstFrame(Aa):Aa;Z&&(Q=this._colorSubstitutionHelper.applyColorSubstituition(Q,Z));this._applyAdditionalRenderProps&&!Ea&&sa&&(Q=this._colorSubstitutionHelper.tintImageData(Q,sa));Aa=this.transformPt([0,0]);var [za,N]=
this.getTransformAngle();Ea=this.transformSize(1);var S=this._ctx;S.save();S.setTransform({m11:P*Ea*za,m12:P*Ea*N,m21:-Ea*N,m22:Ea*za,m41:Aa[0],m42:Aa[1]});S.drawImage(Q,-Da/2,-ha/2,Da,ha);S.restore()}};U.drawText=function(P,Q){if(Q&&0!==Q.length&&(this._textRasterizer||(this._textRasterizer=new v),P=D(P),P.size*=this.transformSize(h.px2pt(1)),Q=this._textRasterizer.rasterizeText(Q,P))){var {size:Z,anchorX:X,anchorY:sa,canvas:Aa}=Q;Q=Z[0]*(X+.5);P=Z[1]*(sa-.5);var Da=this._ctx,ha=this.transformPt([0,
0]),[Ea,za]=this.getTransformAngle();Da.save();Da.setTransform({m11:1*Ea,m12:1*za,m21:-1*za,m22:1*Ea,m41:ha[0]-1*Q,m42:ha[1]+1*P});Da.drawImage(Aa,0,0);Da.restore()}};U.drawPictureFill=function(P,Q){if(P){var {colorSubstitutions:Z,height:X,offsetX:sa,offsetY:Aa,rotation:Da,scaleX:ha,tintColor:Ea,url:za}=Q;Q=this._resourceManager.getResource(za);if(!x.isNone(Q)){if(k.isPolygon(P))this._buildPath(P.rings,!0);else if(k.isPolyline(P))this._buildPath(P.paths,!0);else if(k.isExtent(P))this._buildPath(E(P).rings,
!0);else if(k.isMultipoint(P))console.log("CanvasDrawHelper.drawPictureFill - No implementation!");else return;P=this._ctx;var N=B.isSVGImage(za)||"src"in Q&&B.isSVGImage(Q.src),S="getFrame"in Q?q.getFirstFrame(Q):Q;Z&&(S=this._colorSubstitutionHelper.applyColorSubstituition(S,Z));if(this._applyAdditionalRenderProps){if(N||Ea&&(S=this._colorSubstitutionHelper.tintImageData(S,Ea)),N=P.createPattern(S,"repeat"),S=this.transformSize(1),Da||(Da=0),sa=sa?S*sa:0,Aa=Aa?S*Aa:0,X&&(X*=S),S=X?X/Q.height:1,
Q=ha&&X?ha*X/Q.width:1,0!==Da||1!==S||1!==Q||0!==sa||0!==Aa){const ea=new DOMMatrix;ea.rotateSelf(0,0,-Da).translateSelf(sa,Aa).scaleSelf(Q,S,1);N.setTransform(ea)}}else N=P.createPattern(S,"repeat");P.save();P.fillStyle=N;P.fill("evenodd");P.restore()}}};U.drawPictureStroke=function(P,Q){if(P){var {colorSubstitutions:Z,capStyle:X,joinStyle:sa,miterLimit:Aa,tintColor:Da,url:ha,width:Ea}=Q;Q=this._resourceManager.getResource(ha);if(!x.isNone(Q)){if(k.isPolygon(P))var za=P.rings;else if(k.isPolyline(P))za=
P.paths;else if(k.isExtent(P))za=E(P).rings;else{k.isMultipoint(P)&&console.log("CanvasDrawHelper.drawPictureStroke - No implementation!");return}Ea||(Ea=Q.width);P=B.isSVGImage(ha)||"src"in Q&&B.isSVGImage(Q.src);var N="getFrame"in Q?q.getFirstFrame(Q):Q;Z&&(N=this._colorSubstitutionHelper.applyColorSubstituition(N,Z));this._applyAdditionalRenderProps&&(P||Da&&(N=this._colorSubstitutionHelper.tintImageData(N,Da)));Q=Math.max(this.transformSize(h.pt2px(Ea)),.5);P=Q/N.width;var S=this._ctx;N=S.createPattern(N,
"repeat-y");S.save();this._setCapStyle(X);this._setJoinStyle(sa);void 0!==Aa&&(S.miterLimit=Aa);S.lineWidth=Q;var ea;for(let ka of za){ka=w.clone(ka);var oa=ea=void 0,va=void 0;let la=oa=void 0;za=ka;for(var W=za[0],ca=1;ca<za.length;)la=za[ca][0]-W[0],oa=za[ca][1]-W[1],oa=0!==la?oa/la:Math.PI/2,void 0!==va&&1E-4>=oa-va?(za.splice(ca-1,1),W=ea):(ea=W,W=za[ca],ca++),va=oa;if(ka&&!(1>=ka.length))for(za=this.transformPt(ka[0]),va=1;va<ka.length;va++)ea=this.transformPt(ka[va]),W=180/Math.PI*Math.atan2(ea[1]-
za[1],ea[0]-za[0]),ca=new DOMMatrix,ca.translateSelf(0,za[1]-Q/2).scaleSelf(P,P,1).rotateSelf(0,0,90-W),N.setTransform(ca),S.strokeStyle=N,S.beginPath(),S.moveTo(za[0],za[1]),S.lineTo(ea[0],ea[1]),S.stroke(),za=ea}S.restore()}}};U._buildPath=function(P,Q){const Z=this._ctx;Z.beginPath();if(P)for(const X of P)if(P=X?X.length:0,1<P){let sa=this.transformPt(X[0]);Z.moveTo(sa[0],sa[1]);for(let Aa=1;Aa<P;Aa++)sa=this.transformPt(X[Aa]),Z.lineTo(sa[0],sa[1]);Q&&Z.closePath()}};U._setCapStyle=function(P){switch(P){case l.LineCapStyle.Butt:this._ctx.lineCap=
"butt";break;case l.LineCapStyle.Round:this._ctx.lineCap="round";break;case l.LineCapStyle.Square:this._ctx.lineCap="square"}};U._setJoinStyle=function(P){switch(P){case l.LineJoinStyle.Bevel:this._ctx.lineJoin="bevel";break;case l.LineJoinStyle.Round:this._ctx.lineJoin="round";break;case l.LineJoinStyle.Miter:this._ctx.lineJoin="miter"}};return ba}(y);const E=fa=>fa?{spatialReference:fa.spatialReference,rings:[[[fa.xmin,fa.ymin],[fa.xmin,fa.ymax],[fa.xmax,fa.ymax],[fa.xmax,fa.ymin],[fa.xmin,fa.ymin]]]}:
null,M=fa=>{switch(fa){case "Left":return z.HAlign.Left;case "Right":return z.HAlign.Right;case "Center":return z.HAlign.Center;case "Justify":return K.warnOnce("Horizontal alignment 'justify' is not implemented. Falling back to 'center'."),z.HAlign.Center}},T=fa=>{switch(fa){case "Top":return z.VAlign.Top;case "Center":return z.VAlign.Center;case "Bottom":return z.VAlign.Bottom;case "Baseline":return z.VAlign.Baseline}},Y=(fa,ba,U)=>{switch(fa){case "ExtraLeading":return 1+ba/U;case "Multiple":return ba;
case "Exact":return ba/U}};u.CIMSymbolDrawHelper=y;u.C_DEG_TO_RAD=J;u.CanvasDrawHelper=G;u.EnvDrawHelper=A;u.HittestDrawHelper=I;u.Transformation=F;u.horizontalAlignment2HAlign=M;u.lineGapType2LineHeight=Y;u.verticalAlignment2VAlign=T;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/CIMImageColorSubstitutionHelper":function(){define(function(){return function(){function u(){}var t=u.prototype;t.applyColorSubstituition=function(H,C){if(!C)return H;this._rasterizationCanvas||
(this._rasterizationCanvas=document.createElement("canvas"));const {width:w,height:y}=H,x=this._rasterizationCanvas,m=x.getContext("2d");H!==x&&(x.width=w,x.height=y,m.drawImage(H,0,0,w,y));H=m.getImageData(0,0,w,y).data;if(C)for(var h of C)if(h&&h.oldColor&&4===h.oldColor.length&&h.newColor&&4===h.newColor.length){const [c,d,f,k]=h.oldColor,[g,e,a,b]=h.newColor;if(c!==g||d!==e||f!==a||k!==b)for(C=0;C<H.length;C+=4)c===H[C]&&d===H[C+1]&&f===H[C+2]&&k===H[C+3]&&(H[C]=g,H[C+1]=e,H[C+2]=a,H[C+3]=b)}h=
new ImageData(H,w,y);m.putImageData(h,0,0);return x};t.tintImageData=function(H,C){if(!C||4>C.length)return H;this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));const {width:w,height:y}=H,x=this._rasterizationCanvas,m=x.getContext("2d");H!==x&&(x.width=w,x.height=y,m.drawImage(H,0,0,w,y));H=m.getImageData(0,0,w,y);H=new Uint8Array(H.data);C=[C[0]/255,C[1]/255,C[2]/255,C[3]/255];for(let h=0;h<H.length;h+=4)H[h+0]*=C[0],H[h+1]*=C[1],H[h+2]*=C[2],H[h+3]*=C[3];C=new ImageData(new Uint8ClampedArray(H.buffer),
w,y);m.putImageData(C,0,0);return x};return u}()})},"esri/symbols/cim/imageUtils":function(){define(["exports"],function(u){u.getFirstFrame=function(t){const H=t.getFrame(0);if(H instanceof HTMLImageElement||H instanceof HTMLCanvasElement)return H;const C=document.createElement("canvas");C.width=t.width;C.height=t.height;t=C.getContext("2d");H instanceof ImageData?t.putImageData(H,0,0):t.drawImage(H,0,0);return C};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/Rect":function(){define(["../../chunks/_rollupPluginBabelHelpers"],
function(u){return function(){function t(H=0,C=0,w=0,y=0){this.x=H;this.y=C;this.width=w;this.height=y}t.prototype.union=function(H){this.x=Math.min(this.x,H.x);this.y=Math.min(this.y,H.y);this.width=Math.max(this.width,H.width);this.height=Math.max(this.height,H.height)};u._createClass(t,[{key:"isEmpty",get:function(){return 0>=this.width||0>=this.height}}]);return t}()})},"esri/symbols/cim/TextRasterizer":function(){define(["../../core/screenUtils"],function(u){return function(){function t(C){C&&
(this._textRasterizationCanvas=C)}var H=t.prototype;H.rasterizeText=function(C,w){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const y=this._textRasterizationCanvas;var x=y.getContext("2d");this._setFontProperties(x,w);this._parameters=w;this._textLines=C.split(/\r?\n/);this._lineHeight=this._computeLineHeight();C=this._computeTextWidth(x,w);const {decoration:m,weight:h}=w.font;this._lineThroughWidthOffset=m&&"line-through"===m?.1*this._lineHeight:
0;var c=this._lineHeight*this._textLines.length;y.width=C+2*this._lineThroughWidthOffset;y.height=c;this._renderedLineHeight=Math.round(this._lineHeight*w.pixelRatio);this._renderedHaloSize=w.halo.size*w.pixelRatio;this._renderedWidth=C*w.pixelRatio;this._renderedHeight=c*w.pixelRatio;this._lineThroughWidthOffset*=w.pixelRatio;C=w.halo&&w.halo.color?w.halo.color:[0,0,0,0];c=w.color??[0,0,0,0];this._fillStyle=`rgba(${c.slice(0,3).toString()},${c[3]})`;this._haloStyle=`rgb(${C.slice(0,3).toString()})`;
C=this._renderedLineHeight;c=this._renderedHaloSize;x.save();x.clearRect(0,0,y.width,y.height);this._setFontProperties(x,w);var d=x.textAlign,f=this._renderedWidth;d=("center"===d?.5*f:"right"===d?f:0)+c;f=0<c;let k=this._lineThroughWidthOffset,g=0;f&&this._renderHalo(x,d,c,k,g,w);g+=c;k+=d;for(var e of this._textLines)f&&(x.globalCompositeOperation="destination-out",x.fillStyle="rgb(0, 0, 0)",x.fillText(e,k,g),x.globalCompositeOperation="source-over"),x.fillStyle=this._fillStyle,x.fillText(e,k,g),
m&&"none"!==m&&this._renderDecoration(x,k,g,m,h),g+=C;x.restore();e=this._renderedWidth+2*this._lineThroughWidthOffset;C=this._renderedHeight;x=x.getImageData(0,0,e,C);x=new Uint8Array(x.data);if(w.premultiplyColors)for(d=0;d<x.length;d+=4)c=x[d+3]/255,x[d]*=c,x[d+1]*=c,x[d+2]*=c;switch(w.horizontalAlignment){case "left":c=-.5;break;case "right":c=.5;break;default:c=0}switch(w.verticalAlignment){case "bottom":w=-.5;break;case "top":w=.5;break;default:w=0}return{size:[e,C],image:new Uint32Array(x.buffer),
sdf:!1,simplePattern:!1,anchorX:c,anchorY:w,canvas:y}};H._renderHalo=function(C,w,y,x,m,h){const c=this._renderedWidth,d=this._renderedHeight;this._haloRasterizationCanvas||(this._haloRasterizationCanvas=document.createElement("canvas"));this._haloRasterizationCanvas.width=c;this._haloRasterizationCanvas.height=d;const f=this._haloRasterizationCanvas,k=f.getContext("2d");k.clearRect(0,0,c,d);this._setFontProperties(k,h);const {decoration:g,weight:e}=h.font;k.fillStyle=this._haloStyle;k.strokeStyle=
this._haloStyle;k.lineJoin="round";this._renderHaloNative(k,w,y,g,e);C.globalAlpha=this._parameters.halo.color[3];C.drawImage(f,0,0,c,d,x,m,c,d);C.globalAlpha=1};H._renderHaloNative=function(C,w,y,x,m){const h=this._renderedLineHeight,c=this._renderedHaloSize;for(const d of this._textLines){const f=2*c;for(let k=0;5>k;k++){const g=(.6+.1*k)*f;C.lineWidth=g;C.strokeText(d,w,y);x&&"none"!==x&&this._renderDecoration(C,w,y,x,m,g)}y+=h}};H._setFontProperties=function(C,w){var y=w.font;y=`${y.style} ${y.weight} ${u.pt2px(Math.max(w.size,
.5)*w.pixelRatio).toFixed(1)}px ${y.family}, sans-serif`;C.font=y;C.textBaseline="top";switch(w.horizontalAlignment){case "left":w="left";break;case "right":w="right";break;case "center":w="center";break;default:w="left"}C.textAlign=w};H.computeTextSize=function(C,w){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const y=this._textRasterizationCanvas;var x=y.getContext("2d");this._setFontProperties(x,w);this._parameters=w;this._textLines=C.split(/\r?\n/);
this._lineHeight=this._computeLineHeight();C=this._computeTextWidth(x,w);x=this._lineHeight*this._textLines.length;y.width=C;y.height=x;return[C*w.pixelRatio,x*w.pixelRatio]};H._computeTextWidth=function(C,w){let y=0;for(const x of this._textLines)y=Math.max(y,C.measureText(x).width);w=w.font;if("italic"===w.style||"oblique"===w.style||"string"===typeof w.weight&&("bold"===w.weight||"bolder"===w.weight)||"number"===typeof w.weight&&600<w.weight)y+=.3*C.measureText("w").width;y+=2*this._parameters.halo.size;
return Math.round(y)};H._computeLineHeight=function(){let C=1.275*this._parameters.size;const w=this._parameters.font.decoration;w&&"underline"===w&&(C*=1.3);return Math.round(C+2*this._parameters.halo.size)};H._renderDecoration=function(C,w,y,x,m,h){const c=.9*this._lineHeight;switch(C.textAlign){case "center":w-=this._renderedWidth/2;break;case "right":w-=this._renderedWidth}const d=C.textBaseline;if("underline"===x)switch(d){case "top":y+=c;break;case "middle":y+=c/2}else if("line-through"===x)switch(d){case "top":y+=
c/1.5;break;case "middle":y+=c/3}x=h?1.5*h:Math.ceil(c*("bold"===m?.06:"bolder"===m?.09:.04));C.save();C.beginPath();C.strokeStyle=C.fillStyle;C.lineWidth=x;C.moveTo(w-this._lineThroughWidthOffset,y);C.lineTo(w+this._renderedWidth+2*this._lineThroughWidthOffset,y);C.stroke();C.restore()};return t}()})},"esri/symbols/cim/utils":function(){define(["require","exports"],function(u,t){function H(d){let f=d.length;for(;f--;)if(!" /-,\n".includes(d.charAt(f)))return!1;return!0}function C(d,f){const k=[];
var g=0;let e=-1;do e=d.indexOf("[",g),e>=g&&(e>g&&(g=d.substr(g,e-g),k.push([g,null,H(g)])),g=e+1,e=d.indexOf("]",g),e>=g&&(e>g&&(g=d.substr(g,e-g),(g=f[g])&&k.push([null,g,!1])),g=e+1));while(-1!==e);g<d.length-1&&(d=d.substr(g),k.push([d,null,H(d)]));return k}function w(d,f,k){let g="",e=null;for(const a of f){const [b,l,q]=a;if(b)q?e=b:(e&&(g+=e,e=null),g+=b);else if(f=d.attributes[l])e&&(g+=e,e=null),g+=f}return y(g,k)}function y(d,f){"string"!==typeof d&&(d=String(d));switch(f){case "LowerCase":return d.toLowerCase();
case "Allcaps":return d.toUpperCase();default:return d}}function x(d){return d?{r:d[0],g:d[1],b:d[2],a:d[3]/255}:{r:0,g:0,b:0,a:0}}function m(d){if(!d)return null;switch(d.type){case "CIMPolygonSymbol":if(d.symbolLayers)for(const f of d.symbolLayers)if(d=m(f),null!=d)return d;break;case "CIMTextSymbol":return m(d.symbol);case "CIMSolidFill":return d.color}}function h(d){if(d)switch(d.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(d=d.symbolLayers)for(const f of d)if(d=h(f),null!=d)return d;
break;case "CIMTextSymbol":return h(d.symbol);case "CIMSolidStroke":case "CIMSolidFill":return d.color}}function c(d){if(d)switch(d.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(d.symbolLayers)for(const f of d.symbolLayers)if(d=c(f),void 0!==d)return d;break;case "CIMTextSymbol":return c(d.symbol);case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return d.width}}t.adjustTextCase=y;t.analyzeTextParts=C;t.assignTextValuesFromFeature=w;t.attributesToFields=function(d){return(d?
Object.keys(d):[]).map(f=>({name:f,alias:f,type:"string"===typeof d[f]?"esriFieldTypeString":"esriFieldTypeDouble"}))};t.colorToArray=function(d){return[d.r,d.g,d.b,d.a]};t.createLabelOverrideFunction=function(d,f,k){const g=C(f,d);return e=>w(e,g,k)};t.evaluateValueOrFunction=function(d,f,k,g){return"function"===typeof d?d(f,k,g):d};t.fromCIMColor=x;t.fromCIMFontDecoration=function(d){return d.underline?"underline":d.strikethrough?"line-through":"none"};t.fromCIMFontStyle=function(d){let f="",k=
"";d&&(d=d.toLowerCase(),d.includes("italic")?f="italic":d.includes("oblique")&&(f="oblique"),d.includes("bold")?k="bold":d.includes("light")&&(k="lighter"));return{style:f,weight:k}};t.fromCIMHorizontalAlignment=function(d){switch(d){default:return"left";case "Right":return"right";case "Center":return"center";case "Justify":return"center"}};t.fromCIMVerticalAlignment=function(d){switch(d){default:return"top";case "Center":return"middle";case "Baseline":return"baseline";case "Bottom":return"bottom"}};
t.getFillColor=m;t.getFontStyle=function(d){if(!d)return"normal";switch(d.toLowerCase()){case "italic":return"italic";case "oblique":return"oblique";default:return"normal"}};t.getFontWeight=function(d){if(!d)return"normal";switch(d.toLowerCase()){case "bold":return"bold";case "bolder":return"bolder";case "lighter":return"lighter";default:return"normal"}};t.getStrokeColor=h;t.getStrokeWidth=c;t.getTintColor=d=>d.tintColor?x(d.tintColor):{r:255,g:255,b:255,a:1};t.getValue=(d,f=0)=>null==d||isNaN(d)?
f:d;t.importGeometryEngine=function(){return new Promise((d,f)=>u(["../../geometry/geometryEngineJSON"],d,f))};t.isCIMFill=function(d){return null!=d&&("CIMGradientFill"===d.type||"CIMHatchFill"===d.type||"CIMPictureFill"===d.type||"CIMSolidFill"===d.type||"CIMWaterFill"===d.type)};t.isCIMMarker=function(d){return"CIMVectorMarker"===d.type||"CIMPictureMarker"===d.type||"CIMBarChartMarker"===d.type||"CIMCharacterMarker"===d.type||"CIMPieChartMarker"===d.type||"CIMStackedBarChartMarker"===d.type};t.isCIMMarkerStrokePlacement=
function(d){return null!=d&&("CIMMarkerPlacementAlongLineRandomSize"===d.type||"CIMMarkerPlacementAlongLineSameSize"===d.type||"CIMMarkerPlacementAlongLineVariableSize"===d.type||"CIMMarkerPlacementAtExtremities"===d.type||"CIMMarkerPlacementAtMeasuredUnits"===d.type||"CIMMarkerPlacementAtRatioPositions"===d.type||"CIMMarkerPlacementOnLine"===d.type||"CIMMarkerPlacementOnVertices"===d.type)};t.isCIMStroke=function(d){return"CIMGradientStroke"===d.type||"CIMPictureStroke"===d.type||"CIMSolidStroke"===
d.type};t.isGeometryEngineRequired=d=>{if(!d)return!1;for(const f of d)switch(f.type){case "CIMGeometricEffectBuffer":case "CIMGeometricEffectOffset":case "CIMGeometricEffectDonut":return!0}return!1};t.isSVGImage=d=>d.includes("data:image/svg+xml");t.mapCIMSymbolToGeometryType=function(d){if(!d)return null;switch(d.type){case "CIMPointSymbol":case "CIMTextSymbol":return"esriGeometryPoint";case "CIMLineSymbol":return"esriGeometryPolyline";case "CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}};
t.resampleHermite=function(d,f,k,g,e,a,b=!0){const l=f/e;k/=a;const q=Math.ceil(l/2),n=Math.ceil(k/2);for(let z=0;z<a;z++)for(let p=0;p<e;p++){const r=4*(p+(b?a-z-1:z)*e);var v=0;let D=0,J=0,K=0,F=0,A=0,I=0;const G=(z+.5)*k;for(let E=Math.floor(z*k);E<(z+1)*k;E++){var B=Math.abs(G-(E+.5))/n;const M=(p+.5)*l;B*=B;for(let T=Math.floor(p*l);T<(p+1)*l;T++){let Y=Math.abs(M-(T+.5))/q;v=Math.sqrt(B+Y*Y);-1<=v&&1>=v&&(v=2*v*v*v-3*v*v+1,0<v&&(Y=4*(T+E*f),I+=v*d[Y+3],J+=v,255>d[Y+3]&&(v=v*d[Y+3]/250),K+=v*
d[Y],F+=v*d[Y+1],A+=v*d[Y+2],D+=v))}}g[r]=K/D;g[r+1]=F/D;g[r+2]=A/D;g[r+3]=I/J}};t.toCIMSymbolJSON=function(d){return d.data?.symbol??null};Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/arcade/callExpressionWithFeature":function(){define(["../../../core/Error","../../../core/Logger","../../../core/maybe","../../../geometry/support/quantizationUtils"],function(u,t,H,C){function w(x){const m={};switch(x){case "esriGeometryPoint":return(h,c,d,f)=>C.unquantizePoint(c,
m,h,d,f);case "esriGeometryPolygon":return(h,c,d,f)=>C.unquantizePolygon(c,m,h,d,f);case "esriGeometryPolyline":return(h,c,d,f)=>C.unquantizePolyline(c,m,h,d,f);case "esriGeometryMultipoint":return(h,c,d,f)=>C.unquantizeMultipoint(c,m,h,d,f);default:return t.getLogger("esri.views.2d.support.arcadeOnDemand").error(new u("mapview-arcade",`Unable to handle geometryType: ${x}`)),h=>h}}const y=new Map;return function(x,m,h,c,d){if(H.isNone(x))return null;if(x.referencesGeometry()&&d){const {transform:f,
hasZ:k,hasM:g}=d;y.has(c)||y.set(c,w(c));c=y.get(c)(m.geometry,f,k,g);m={...m,geometry:c}}m=x.repurposeFeature(m);try{return x.evaluate({...h,$feature:m})}catch(f){return t.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",f),null}}})},"esri/symbols/cim/quantizeTime":function(){define(["exports"],function(u){const t=new Set(["StartTimeOffset","Duration","RepeatDelay"]);u.quantizeIfNeeded=function(H,C){return t.has(C)?.05*Math.max(Math.round(H/.05),1):H};Object.defineProperty(u,
Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/SDFHelper":function(){define(["exports","../../core/floatRGBA","../../geometry/support/jsonUtils","./Rect"],function(u,t,H,C){function w(x){if(!x)return null;switch(x.type){case "CIMPointSymbol":x=x.symbolLayers;if(!x||1!==x.length)break;return w(x[0]);case "CIMVectorMarker":x=x.markerGraphics;if(!x||1!==x.length)break;var m=x[0];if(!m)break;x=m.geometry;if(!x)break;m=m.symbol;if(!m||"CIMPolygonSymbol"!==m.type&&"CIMLineSymbol"!==m.type||m.symbolLayers?.some(h=>
!!h.effects))break;return{geom:x,asFill:"CIMPolygonSymbol"===m.type};case "sdf":return{geom:x.geom,asFill:x.asFill}}return null}function y(x){let m=Infinity,h=-Infinity,c=Infinity,d=-Infinity;for(const f of x)for(const k of f)k[0]<m&&(m=k[0]),k[0]>h&&(h=k[0]),k[1]<c&&(c=k[1]),k[1]>d&&(d=k[1]);return[m,c,h,d]}u.buildSDF=function(x){var m=x.geom;var h=m?m.rings?m.rings:m.paths?m.paths:void 0!==m.xmin&&void 0!==m.ymin&&void 0!==m.xmax&&void 0!==m.ymax?[[[m.xmin,m.ymin],[m.xmin,m.ymax],[m.xmax,m.ymax],
[m.xmax,m.ymin],[m.xmin,m.ymin]]]:null:null;m=Infinity;var c=-Infinity;var d=Infinity,f=-Infinity;for(var k of h)for(var g of k)g[0]<m&&(m=g[0]),g[0]>c&&(c=g[0]),g[1]<d&&(d=g[1]),g[1]>f&&(f=g[1]);c=new C(m,d,c-m,f-d);d=64/Math.max(c.width,c.height);k=Math.round(c.width*d)+62;g=Math.round(c.height*d)+62;m=[];for(var e of h)if(e&&1<e.length){h=[];for(var a of e){let [D,J]=a;D-=c.x;J-=c.y;D*=d;J*=d;D+=30.5;J+=30.5;x.asFill?h.push([D,J]):h.push([Math.round(D),Math.round(J)])}x.asFill&&(f=h.length-1,h[0][0]===
h[f][0]&&h[0][1]===h[f][1]||h.push(h[0]));m.push(h)}a=k*g;e=Array(a);for(h=0;h<a;++h)e[h]=962;for(var b of m)for(h=b.length,c=1;c<h;++c){d=b[c-1];f=b[c];var l=void 0,q=void 0;d[0]<f[0]?(l=d[0],q=f[0]):(l=f[0],q=d[0]);var n=void 0,v=void 0;d[1]<f[1]?(n=d[1],v=f[1]):(n=f[1],v=d[1]);var B=Math.floor(l)-31;q=Math.floor(q)+31;n=Math.floor(n)-31;v=Math.floor(v)+31;0>B&&(B=0);q>k&&(q=k);0>n&&(n=0);v>g&&(v=g);l=f[0]-d[0];const D=f[1]-d[1],J=l*l+D*D;for(;B<q;B++)for(let K=n;K<v;K++){var z=(B-d[0])*l+(K-d[1])*
D,p=void 0;0>z?(p=d[0],z=d[1]):z>J?(p=f[0],z=f[1]):(z/=J,p=d[0]+z*l,z=d[1]+z*D);p=(B-p)*(B-p)+(K-z)*(K-z);z=(g-K-1)*k+B;p<e[z]&&(e[z]=p)}}for(b=0;b<a;++b)e[b]=Math.sqrt(e[b]);if(x.asFill)for(var r of m)for(x=r.length,b=1;b<x;++b)for(m=r[b-1],a=r[b],m[0]<a[0]?(h=m[0],c=a[0]):(h=a[0],c=m[0]),m[1]<a[1]?(f=m[1],d=a[1]):(f=a[1],d=m[1]),h=Math.floor(h),c=Math.floor(c)+1,f=Math.floor(f),d=Math.floor(d)+1,31>h&&(h=31),c>k-31&&(c=k-31),31>f&&(f=31),d>g-31&&(d=g-31);f<d;++f)if(m[1]>f!==a[1]>f){q=(g-f-1)*k;
for(n=h;n<c;++n)n<(a[0]-m[0])*(f-m[1])/(a[1]-m[1])+m[0]&&(e[q+n]=-e[q+n]);for(n=31;n<h;++n)e[q+n]=-e[q+n]}r=e.length;x=new Uint8Array(4*r);for(b=0;b<r;++b)t.packFloatRGBA(.5-e[b]/62,x,4*b);return[x,k,g]};u.getExtent=function(x){return x?x.rings?y(x.rings):x.paths?y(x.paths):H.isExtent(x)?[x.xmin,x.ymin,x.xmax,x.ymax]:null:null};u.getSDFInfo=w;u.getSDFMetrics=function(x,m,h,c,d){const [f,k,g,e]=x;if(g<f||e<k)return[0,0,0];var a=g-f,b=e-k;x=64/Math.max(a,b);const l=Math.round(a*x),q=Math.round(b*x)+
62;b=1;m&&(b=q/x/(m.ymax-m.ymin));let n=0,v=0;a=1;c&&(d?m&&h&&0<m.ymax-m.ymin&&(a=(m.xmax-m.xmin)/(m.ymax-m.ymin),n=c.x/(h*a),v=c.y/h):(n=c.x,v=c.y));m&&(n=.5*(m.xmax+m.xmin)+n*(m.xmax-m.xmin),v=.5*(m.ymax+m.ymin)+v*(m.ymax-m.ymin));n=(n-f)*x+31;v=(v-k)*x+31;m=n/(l+62)-.5;c=v/q-.5;d&&h&&(m*=h*a,c*=h);return[b,m,c]};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/core/floatRGBA":function(){define(["exports","./mathUtils"],function(u,t){function H(x,m=0){let h=0;for(let c=0;4>
c;c++)h+=x[m+c]*w[c];return h}const C=[1,256,65536,16777216],w=[1/256,1/65536,1/16777216,1/4294967296],y=H(new Uint8ClampedArray([255,255,255,255]));u.packFloatRGBA=function(x,m,h=0){x=t.clamp(x,0,y);for(let f=0;4>f;f++){var c=Math,d=x*C[f];m[h+f]=c.floor.call(c,256*(d-Math.floor(d)))}};u.unpackFloatRGBA=H;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/grouping":function(){define(["exports","../../../../core/string"],function(u,t){function H(C,w){if("string"===
typeof C)C=t.numericHash(C+`-seed(${w})`);else{let y=12;C^=w;do C=107*(C>>8^C)+y|0;while(0!==--y)}return(1+C/-2147483648)/2}u.getMaterialGroup=function(C){return Math.floor(10*H(C,53290320))};u.getRandomValue=H;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/util/Result":function(){define(["exports","../../../../../core/Error"],function(u,t){u.ok=function(H,C){return H&&"name"in H?(C&&C.error(new t(H.name,H.message,H.details)),!1):!0};Object.defineProperty(u,
Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),function(u,t,H,C,w,y,x,m,h,c,d){return function(f){function k(g,e,a){var b=f.call(this,g)||this;b._minMaxZoom=
y.i1616to32(Math.round(e*w.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(a*w.MIN_MAX_ZOOM_PRECISION_FACTOR));b._cimLineLayer=g;let l=0;m.isFunction(g.width)||(l=.5*H.pt2px(g.width));b._dynamicPropertyMap.set("_halfWidth",(v,B,z)=>m.isFunction(g.width)?.5*H.pt2px(g.width(v,B,z)):l);m.isFunction(g.cap)?b._dynamicPropertyMap.set("_capType",g.cap):b._capType=g.cap;m.isFunction(g.join)?b._dynamicPropertyMap.set("_joinType",g.join):b._joinType=g.join;const q=g.color;m.isFunction(q)?b._dynamicPropertyMap.set("_fillColor",
(v,B,z)=>C.premultiplyAlphaRGBA(q(v,B,z))):b._fillColor=q&&C.premultiplyAlphaRGBA(q)||0;const n=g.miterLimit;m.isFunction(n)?b._dynamicPropertyMap.set("_miterLimitCosine",(v,B,z)=>m.getLimitCosine(n(v,B,z))):b._miterLimitCosine=m.getLimitCosine(n);t.isSome(g.effects)&&(e=g.effects,m.isFunction(e)?b._dynamicPropertyMap.set("_effects",e):b._effects=e);b._scaleFactor=g.scaleFactor||1;b._isDashed=null!=g.dashTemplate;b.tessellationProperties._bitset=(g.colorLocked?w.BITSET_GENERIC_LOCK_COLOR:0)|(g.scaleDash?
w.BITSET_LINE_SCALE_DASH:0)|(g.sampleAlphaOnly?w.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0);b._materialKey=g.materialKey;b._initializeTessellator(!0);return b}u._inheritsLoose(k,f);k.fromCIMLine=function(g,e){const [a,b]=m.getMinMaxZoom(g.scaleInfo,e);return new k(g,a,b)};k.prototype.bindFeature=function(g,e,a){const b=g.readLegacyFeature();this._dynamicPropertyMap.forEach((q,n)=>{this[n]=q(b,e,a)});this._halfWidth*=this._scaleFactor;g=this._materialCache;var l=this._cimLineLayer.materialHash;l=l(b,e,
a);l=g.get(l);g=null;l&&d.ok(l.spriteMosaicItem)&&(g=l.spriteMosaicItem);if(g){this._hasPattern=!0;const {rect:q,width:n,height:v}=g;l=q.x+w.SPRITE_PADDING;const B=q.y+w.SPRITE_PADDING,z=l+n,p=B+v;this.tessellationProperties._tl=y.i1616to32(l,B);this.tessellationProperties._br=y.i1616to32(z,p)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=this._fillColor;this.tessellationProperties._halfWidth=this._halfWidth;this.tessellationProperties.offset=
0;this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;l=x.LineMaterialKey.load(this._materialKey);g&&(l.sdf=g.sdf,l.pattern=!0,l.textureBinding=g.textureBinding);this._materialKey=l.data};return k}(h(c))})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f,k,g,e,a){const b=x.create(),l=y.create();return function(q){function n(v,B,z){var p=q.call(this,v)||this;p._cimMarkerLayer=v;p._minMaxZoom=d.i1616to32(Math.round(B*c.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(z*c.MIN_MAX_ZOOM_PRECISION_FACTOR));const r=v.color;k.isFunction(r)?p._dynamicPropertyMap.set("_fillColor",(I,G,E)=>h.premultiplyAlphaRGBA(r(I,G,E))):p._fillColor=h.premultiplyAlphaRGBA(r);const D=v.outlineColor;k.isFunction(D)?p._dynamicPropertyMap.set("_outlineColor",
(I,G,E)=>h.premultiplyAlphaRGBA(D(I,G,E))):p._outlineColor=h.premultiplyAlphaRGBA(D);const J=v.size;k.isFunction(J)?p._dynamicPropertyMap.set("_size",(I,G,E)=>w.pt2px(J(I,G,E))):p._size=w.pt2px(J)||0;B=v.scaleX;k.isFunction(B)?p._dynamicPropertyMap.set("_scaleX",B):p._scaleX=B;const K=v.offsetX;k.isFunction(K)?p._dynamicPropertyMap.set("xOffset",(I,G,E)=>w.pt2px(K(I,G,E))):p.xOffset=w.pt2px(K)||0;const F=v.offsetY;k.isFunction(F)?p._dynamicPropertyMap.set("yOffset",(I,G,E)=>w.pt2px(F(I,G,E))):p.yOffset=
w.pt2px(F)||0;const A=v.outlineWidth;k.isFunction(A)?p._dynamicPropertyMap.set("_outlineWidth",(I,G,E)=>w.pt2px(A(I,G,E))):p._outlineWidth=w.pt2px(A)||0;B=v.rotation;k.isFunction(B)?p._dynamicPropertyMap.set("_angle",B):p._angle=B||0;C.isSome(v.effects)&&(B=v.effects,k.isFunction(B)?p._dynamicPropertyMap.set("_effects",B):p._effects=B);C.isSome(v.markerPlacement)&&(B=v.markerPlacement,k.isFunction(B)?p._dynamicPropertyMap.set("_markerPlacement",B):p._markerPlacement=B);p._scaleFactor=C.unwrapOr(v.scaleFactor,
1);p._bitSet=(v.alignment===m.Alignment.MAP?1:0)|(v.colorLocked?1:0)<<1|(v.scaleSymbolsProportionally?1:0)<<3;p._materialKey=v.materialKey;return p}u._inheritsLoose(n,q);n.fromCIMMarker=function(v,B){const [z,p]=k.getMinMaxZoom(v.scaleInfo,B);return new n(v,z,p)};n.prototype.bindFeature=function(v,B,z){const p=v.readLegacyFeature();v=v.getObjectId();this._dynamicPropertyMap.forEach((fa,ba)=>{this[ba]=fa(p,B,z)});var r=this._cimMarkerLayer.materialHash;v="function"===typeof r?r(p,B,z,v):r;if((v=this._materialCache.get(v))&&
a.ok(v.spriteMosaicItem)&&v.spriteMosaicItem){v=v.spriteMosaicItem;r=this._cimMarkerLayer.sizeRatio;var D=v.width/v.height*this._scaleX,J=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle,K=this._size,F=K*D,A=this.xOffset,I=this.yOffset;this.xOffset*=this._scaleFactor;this.yOffset*=this._scaleFactor;var G=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/w.pt2px(this._cimMarkerLayer.frameHeight):1;G*=this._outlineWidth;var E=w.pt2px(this._cimMarkerLayer.referenceSize),
M=0,T=0,Y=this._cimMarkerLayer.anchorPoint;Y&&(this._cimMarkerLayer.isAbsoluteAnchorPoint?this._size&&(M=w.pt2px(Y.x)/(this._size*D),T=w.pt2px(Y.y)/this._size):(M=Y.x,T=Y.y));this._anchorX=M;this._anchorY=T;this._sizeOutlineWidth=d.i8888to32(Math.round(Math.min(Math.sqrt(128*F),255)),Math.round(Math.min(Math.sqrt(128*K),255)),Math.round(Math.min(Math.sqrt(128*G),255)),Math.round(Math.min(Math.sqrt(128*E),255)));this.angle=J;this._bitestAndDistRatio=d.i1616to32(this._bitSet,Math.round(64*r));D=v.rect.x+
c.SPRITE_PADDING;J=v.rect.y+c.SPRITE_PADDING;G=D+v.width;E=J+v.height;this._texUpperLeft=d.i1616to32(D,J);this._texUpperRight=d.i1616to32(G,J);this._texBottomLeft=d.i1616to32(D,E);this._texBottomRight=d.i1616to32(G,E);D=f.MarkerMaterialKey.load(this._materialKey);D.sdf=v.sdf;D.pattern=!0;D.textureBinding=v.textureBinding;this._materialKey=D.data;F=F*r*this._scaleFactor;K=K*r*this._scaleFactor;F*=v.rect.width/v.width;K*=v.rect.height/v.height;this._computedWidth=F;this._computedHeight=K;this._applyTransformation(l,
b);this.xOffset=A;this.yOffset=I}else H.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate").error(new t("mapview-cim","Encountered an error when binding feature"))};return n}(g(e))})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../alignmentUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLDynamicMeshTemplate ../../../../layers/features/textUtils".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f,k){return function(g){function e(b,l,q){var n=g.call(this,b)||this;n._horizontalAlignment="center";n._verticalAlignment="middle";n._textToGlyphs=new Map;n._minMaxZoom=m.i1616to32(Math.round(l*x.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(q*x.MIN_MAX_ZOOM_PRECISION_FACTOR));l=b.scaleFactor||1;n._cimTextLayer=b;const v=b.color;c.isFunction(v)?n._dynamicPropertyMap.set("_color",(D,J,K)=>y.premultiplyAlphaRGBA(v(D,J,K))):n._color=y.premultiplyAlphaRGBA(v);const B=b.outlineColor;
c.isFunction(B)?n._dynamicPropertyMap.set("_haloColor",(D,J,K)=>y.premultiplyAlphaRGBA(B(D,J,K))):n._haloColor=y.premultiplyAlphaRGBA(B);let z;c.isFunction(b.size)||(z=Math.min(Math.round(H.pt2px(b.size*b.sizeRatio)),127));n._dynamicPropertyMap.set("_size",(D,J,K)=>c.isFunction(b.size)?Math.min(Math.round(H.pt2px(b.size(D,J,K)*b.sizeRatio)),127):z);c.isFunction(b.outlineSize)?n._dynamicPropertyMap.set("_haloSize",(D,J,K)=>Math.min(Math.floor(5*H.pt2px(b.outlineSize(D,J,K)*b.sizeRatio)),127)):n._haloSize=
Math.min(Math.floor(5*H.pt2px(b.outlineSize*b.sizeRatio)),127);let p;c.isFunction(b.offsetX)||(p=Math.round(H.pt2px(b.offsetX*b.sizeRatio)));n._dynamicPropertyMap.set("_xOffset",(D,J,K)=>c.isFunction(b.offsetX)?Math.round(H.pt2px(b.offsetX(D,J,K)*b.sizeRatio)):p);let r;c.isFunction(b.offsetY)||(r=Math.round(H.pt2px(b.offsetY*b.sizeRatio)));n._dynamicPropertyMap.set("_yOffset",(D,J,K)=>c.isFunction(b.offsetY)?Math.round(H.pt2px(b.offsetY(D,J,K)*b.sizeRatio)):r);c.isFunction(b.angle)?n._dynamicPropertyMap.set("_angle",
b.angle):n._angle=b.angle;c.isFunction(b.horizontalAlignment)?n._dynamicPropertyMap.set("_horizontalAlignment",b.horizontalAlignment):n._horizontalAlignment=b.horizontalAlignment;c.isFunction(b.verticalAlignment)?n._dynamicPropertyMap.set("_verticalAlignment",b.verticalAlignment):n._verticalAlignment=b.verticalAlignment;t.isSome(b.effects)&&(q=b.effects,c.isFunction(q)?n._dynamicPropertyMap.set("_effects",q):n._effects=q);t.isSome(b.markerPlacement)&&(q=b.markerPlacement,c.isFunction(q)?n._dynamicPropertyMap.set("_markerPlacement",
q):n._textPlacement=q);c.isFunction(b.text)?n._dynamicPropertyMap.set("_text",b.text):n._text=b.text;n._backgroundColor=b.backgroundColor&&y.premultiplyAlphaRGBA(b.backgroundColor);n._borderLineColor=b.borderLineColor&&y.premultiplyAlphaRGBA(b.borderLineColor);n._borderLineSize=b.borderLineWidth;n._scaleFactor=l;l=Math.min(Math.round(H.pt2px(b.referenceSize*b.sizeRatio)),127);n._referenceSize=Math.round(Math.sqrt(256*l));n._materialKey=b.materialKey;l=h.TextMaterialKey.load(n._materialKey);l.sdf=
!0;n._bitset=(b.alignment===C.Alignment.MAP?1:0)|(b.colorLocked?1:0)<<1;n._materialKey=l.data;n._decoration="none";n._lineHeight=1;n._lineWidth=512;n._isCIM=!0;return n}u._inheritsLoose(e,g);e.fromCIMText=function(b,l){const [q,n]=c.getMinMaxZoom(b.scaleInfo,l);return new e(b,q,n)};var a=e.prototype;a.analyze=function(){var b=u._asyncToGenerator(function*(l,q,n,v){var B=q.readLegacyFeature();var z=this._cimTextLayer;B="string"===typeof z.text?z.text:"function"===typeof z.text?z.text(B,n,v)??"":"";
(l=yield g.prototype.analyze.call(this,l,q,n,v,k.codepoints(B)))&&l.glyphMosaicItems&&this._textToGlyphs.set(B,l.glyphMosaicItems);return l});return function(l,q,n,v){return b.apply(this,arguments)}}();a.bindFeature=function(b,l,q){const n=b.readLegacyFeature();this._dynamicPropertyMap.forEach((v,B)=>{this[B]=v(n,l,q)});this._text&&0!==this._text.length?(this._size*=this._scaleFactor,this._scale=this._size/x.GLYPH_SIZE,this._xOffset*=this._scaleFactor,this._yOffset*=this._scaleFactor,this._xAlignD=
w.getXAnchorDirection(t.unwrapOr(this._horizontalAlignment,"center")),this._yAlignD=w.getYAnchorDirection(t.unwrapOr(this._verticalAlignment,"baseline")),b=this._textToGlyphs.get(this._text)??[],this.bindTextInfo(b,!1)):this._shapingInfo=null};return e}(d(f))})},"esri/views/2d/layers/features/textUtils":function(){define(["exports"],function(u){u.codepoints=function(t){if(null==t)return[];const H=Array(t.length);for(let C=0;C<t.length;C++)H[C]=t.charCodeAt(C);return H};Object.defineProperty(u,Symbol.toStringTag,
{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/WGLFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../color ../../definitions ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./util ./WGLBaseFillTemplate ./WGLMeshTemplate".split(" "),function(u,t,H,C,w,y,x,m,h,c){return function(d){function f(k,g,e,a,b,l,q,n,v,B,z,p,r,D,J,K){var F=d.call(this)||this;F._effects=D;k=x.FillMaterialKey.load(k);g&&(k.sdf=
g.sdf,k.pattern=!0,k.textureBinding=g.textureBinding);F.fillColor=e;F.tl=a;F.br=b;F.aux21=y.i1616to32(l,q);F.aux22=y.i1616to32(n,v);F.aux3=y.i8888to32(B,z,p,0);F._bitset=r;F._minMaxZoom=y.i1616to32(Math.round(J*C.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(K*C.MIN_MAX_ZOOM_PRECISION_FACTOR));F._materialKey=k.data;return F}u._inheritsLoose(f,d);f.fromCIMFill=function(k,g,e){var a=k.color;a=a&&H.premultiplyAlphaRGBA(a)||0;const b=k.materialKey,[l,q]=m.getMinMaxZoom(k.scaleInfo,e);e=(k.colorLocked?C.BITSET_GENERIC_LOCK_COLOR:
0)|(k.applyRandomOffset?C.BITSET_FILL_RANDOM_PATTERN_OFFSET:0)|(k.sampleAlphaOnly?C.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0)|(k.hasUnresolvedReplacementColor?C.BITSET_FILL_HAS_UNRESOLVED_REPLACEMENT_COLOR:0);if(!g)return new f(b,null,a,0,0,0,0,0,0,0,0,0,e,k.effects,l,q);const {rect:n,width:v,height:B}=g;var z=k.scaleX||1,p=n.x+C.SPRITE_PADDING;const r=n.y+C.SPRITE_PADDING;var D=p+v;const J=r+B;var K=t.pt2px(k.height);z*=K;"CIMHatchFill"===k.cim.type&&(z*=v/B);K=Math.round(K);0>=K&&(K=J-r);z=Math.round(z);
0>=z&&(z=D-p);const F=t.pt2px(k.offsetX||0),A=t.pt2px(-k.offsetY||0);p=y.i1616to32(p,r);D=y.i1616to32(D,J);return new f(b,g,a,p,D,z,K,F,A,128,128,w.degToByte(k.angle),e,k.effects,l,q)};f.fromSimpleFill=function(k,g,e=!1){var {color:a}=k;a=a&&"esriSFSNull"!==k.style&&H.premultiplyAlphaRGBAArray(a)||0;e=e?C.BITSET_GENERIC_LOCK_COLOR:0;const b=k.materialKey;if(g){const {rect:n,width:v,height:B,pixelRatio:z}=g;var l=n.x+C.SPRITE_PADDING;const p=n.y+C.SPRITE_PADDING;var q=l+v;const r=p+B;l=y.i1616to32(l,
p);q=y.i1616to32(q,r);g=new f(b,g,a,l,q,v/z,B/z,0,0,128,128,0,e,null,m.DEFAULT_MIN_ZOOM,m.DEFAULT_MAX_ZOOM)}else g=new f(b,null,a,0,0,0,0,0,0,0,0,0,e,null,m.DEFAULT_MIN_ZOOM,m.DEFAULT_MAX_ZOOM);g._maybeAddLineTemplate(k);return g};f.fromPictureFill=function(k,g,e=!1){const a=C.PICTURE_FILL_COLOR,{rect:b,width:l,height:q}=g;var n=b.x+C.SPRITE_PADDING,v=b.y+C.SPRITE_PADDING,B=n+l,z=v+q;n=y.i1616to32(n,v);B=y.i1616to32(B,z);z=Math.round(t.pt2px(k.width));v=Math.round(t.pt2px(k.height));const p=t.pt2px(k.xoffset),
r=t.pt2px(-k.yoffset);g=new f(k.materialKey,g,a,n,B,z,v,p,r,128*k.xscale,128*k.yscale,0,e?C.BITSET_GENERIC_LOCK_COLOR:0,null,m.DEFAULT_MIN_ZOOM,m.DEFAULT_MAX_ZOOM);g._maybeAddLineTemplate(k);return g};return f}(h(c))})},"esri/views/2d/engine/webgl/util/Lock":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/promiseUtils"],function(u,t,H){function C(){C=t._asyncToGenerator(function*(y,x,m){try{yield y.acquire(),yield x(m),y.release()}catch(h){throw y.release(),
h;}});return C.apply(this,arguments)}let w=function(){function y(){this._resolver=null}var x=y.prototype;x.isHeld=function(){return!!this._resolver};x.acquire=function(){var m=t._asyncToGenerator(function*(){this._resolver?(yield this._resolver.promise,yield this.acquire()):this._resolver=H.createResolver()});return function(){return m.apply(this,arguments)}}();x.release=function(){const m=this._resolver;this._resolver=null;m?.resolve()};return y}();u.Lock=w;u.withLock=function(y,x,m){return C.apply(this,
arguments)};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/support/cimSymbolUtils":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../symbols/cim/cimAnalyzer","../../../../symbols/cim/ExpandedCIM","./webStyleUtils"],function(u,t,H,C,w){function y(){y=t._asyncToGenerator(function*(m,h,c,d){return m?"cim"===m.type?x(m,h,c):"web-style"===m.type?(m={type:"cim",data:(yield w.fetchCIMSymbolReference(m,null,d))??void 0,rendererKey:m.rendererKey,
maxVVSize:m.maxVVSize},x(m,h,c)):m:null});return y.apply(this,arguments)}const x=function(){var m=t._asyncToGenerator(function*(h,c,d){return new C.ExpandedCIM(yield H.analyzeCIMSymbol(h.data,c,d),h.data,h.rendererKey,h.maxVVSize)});return function(h,c,d){return m.apply(this,arguments)}}();u.cimLayerToRasterizationInfo=function(m){if(!m)return null;const {avoidSDFRasterization:h,type:c,cim:d,url:f,materialHash:k}=m,g={cim:d,type:c,mosaicHash:k,url:f,size:null,dashTemplate:null,path:null,text:null,
fontName:null,animatedSymbolProperties:null,avoidSDFRasterization:h};switch(c){case "marker":g.size=m.size;g.path=m.path;g.animatedSymbolProperties=m.animatedSymbolProperties;break;case "line":g.dashTemplate=m.dashTemplate;break;case "text":g.text=m.text,g.fontName=m.fontName}return g};u.expandSymbol=function(m,h,c,d){return y.apply(this,arguments)};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/ExpandedCIM":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers",
"../../views/2d/engine/webgl/enums","../../views/2d/engine/webgl/materialKey/MaterialKey"],function(u,t,H,C){const w={marker:H.WGLGeometryType.MARKER,fill:H.WGLGeometryType.FILL,line:H.WGLGeometryType.LINE,text:H.WGLGeometryType.TEXT};let y=function(){function x(m,h,c,d){const f={minScale:h?.minScale,maxScale:h?.maxScale};var k=f.minScale||f.maxScale?f.minScale+"-"+f.maxScale:"";this.layers=m;this.data=h;this.hash=this._createHash()+k;this.rendererKey=c;h={isOutline:!1,placement:null,symbologyType:H.WGLSymbologyType.DEFAULT,
vvFlags:c};for(const g of m)m=w[g.type],h.isOutline="line"===g.type&&g.isOutline,g.materialKey=C.createMaterialKey(m,h),g.maxVVSize=d,g.scaleInfo=f,g.templateHash+=k}x.prototype._createHash=function(){let m="";for(const h of this.layers)m+=h.templateHash;return m};t._createClass(x,[{key:"type",get:function(){return"expanded-cim"}}]);return x}();u.ExpandedCIM=y;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/support/webStyleUtils":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/devEnvironmentUtils ../../../../core/Error ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/urlUtils ../../../../portal/Portal ../../../../chunks/persistableUrlUtils ../../../../symbols/support/styleUtils".split(" "),
function(u,t,H,C,w,y,x,m,h,c){function d(){d=t._asyncToGenerator(function*(a,b,l){if(!a.name)throw new C("style-symbol-reference-name-missing","Missing name in style symbol reference");if(a.styleName&&"Esri2DPointSymbolsStyle"===a.styleName)return f(a,l);try{const q=yield c.fetchStyle(a,b,l);return g(q,a.name,b,l)}catch(q){return y.throwIfAborted(q),null}});return d.apply(this,arguments)}function f(a,b){return k.apply(this,arguments)}function k(){k=t._asyncToGenerator(function*(a,b){a=c.Style2DUrlTemplate.replace(/\{SymbolName\}/gi,
a.name);try{const l=yield c.requestJSON(a,b);return c.makeCIMSymbolRef(l.data)}catch(l){return y.throwIfAborted(l),null}});return k.apply(this,arguments)}function g(a,b,l,q){return e.apply(this,arguments)}function e(){e=t._asyncToGenerator(function*(a,b,l,q){var n=a.data;a={portal:l&&w.isSome(l.portal)?l.portal:m.getDefault(),url:x.urlToObject(a.baseUrl),origin:"portal-item"};n=n.items.find(v=>v.name===b);if(!n)throw new C("symbolstyleutils:symbol-name-not-found",`The symbol name '${b}' could not be found`,
{symbolName:b});n=h.fromJSON(c.symbolUrlFromStyleItem(n,"cimRef"),a);H.isDevEnvironment()&&(n=H.adjustStaticAGOUrl(n));try{const v=yield c.requestJSON(n,q);return c.makeCIMSymbolRef(v.data)}catch(v){return y.throwIfAborted(v),null}});return e.apply(this,arguments)}u.fetchCIMSymbolReference=function(a,b,l){return d.apply(this,arguments)};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/core/devEnvironmentUtils":function(){define(["exports"],function(u){const t=/^devext.arcgis.com$/,
H=/^qaext.arcgis.com$/,C=/^[\w-]*\.mapsdevext.arcgis.com$/,w=/^[\w-]*\.mapsqa.arcgis.com$/,y=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,t,H,/^jsapps.esri.com$/,C,w];u.adjustStaticAGOUrl=function(x,m){return x?(m=m||globalThis.location.hostname)?null!=m.match(t)||null!=m.match(C)?x.replace("static.arcgis.com","staticdev.arcgis.com"):null!=m.match(H)||null!=m.match(w)?x.replace("static.arcgis.com","staticqa.arcgis.com"):x:x:x};u.isDevEnvironment=function(x){x=x||globalThis.location.hostname;return y.some(m=>
null!=x?.match(m))};u.isTelemetryDevEnvironment=function(x){x=x||globalThis.location.hostname;return[/^zrh-.+?\.esri\.com$/].concat(y).some(m=>null!=x?.match(m))};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/portal/Portal":function(){define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../config ../kernel ../request ../core/Error ../core/JSONSupport ../core/Loadable ../core/maybe ../core/promiseUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../geometry/Extent ../intl/locale ./PortalQueryParams ./PortalQueryResult ./PortalUser ../support/apiKeyUtils".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f,k,g,e,a,b,l,q,n,v,B){const z=J=>Object.freeze(Object.defineProperty({__proto__:null,default:J},Symbol.toStringTag,{value:"Module"}));var p;let r;const D={PortalGroup:()=>new Promise((J,K)=>u(["./PortalGroup"],F=>J(z(F)),K)),PortalItem:()=>new Promise((J,K)=>u(["./PortalItem"],F=>J(z(F)),K)),PortalUser:()=>new Promise((J,K)=>u(["./PortalUser"],F=>J(z(F)),K))};m=p=function(J){function K(A){A=J.call(this,A)||this;A._esriIdCredentialCreateHandle=null;A.access=null;A.allSSL=
!1;A.authMode="auto";A.authorizedCrossOriginDomains=null;A.basemapGalleryGroupQuery=null;A.bingKey=null;A.canListApps=!1;A.canListData=!1;A.canListPreProvisionedItems=!1;A.canProvisionDirectPurchase=!1;A.canSearchPublic=!0;A.canShareBingPublic=!1;A.canSharePublic=!1;A.canSignInArcGIS=!1;A.canSignInIDP=!1;A.colorSetsGroupQuery=null;A.commentsEnabled=!1;A.created=null;A.culture=null;A.customBaseUrl=null;A.defaultBasemap=null;A.defaultDevBasemap=null;A.defaultExtent=null;A.defaultVectorBasemap=null;
A.description=null;A.devBasemapGalleryGroupQuery=null;A.eueiEnabled=null;A.featuredGroups=null;A.featuredItemsGroupQuery=null;A.galleryTemplatesGroupQuery=null;A.livingAtlasGroupQuery=null;A.hasCategorySchema=!1;A.helperServices=null;A.homePageFeaturedContent=null;A.homePageFeaturedContentCount=null;A.httpPort=null;A.httpsPort=null;A.id=null;A.ipCntryCode=null;A.isPortal=!1;A.isReadOnly=!1;A.layerTemplatesGroupQuery=null;A.maxTokenExpirationMinutes=null;A.modified=null;A.name=null;A.portalHostname=
null;A.portalMode=null;A.portalProperties=null;A.region=null;A.rotatorPanels=null;A.showHomePageDescription=!1;A.sourceJSON=null;A.supportsHostedServices=!1;A.symbolSetsGroupQuery=null;A.templatesGroupQuery=null;A.units=null;A.url=C.portalUrl;A.urlKey=null;A.user=null;A.useStandardizedQuery=!1;A.useVectorBasemaps=!1;A.vectorBasemapGalleryGroupQuery=null;return A}t._inheritsLoose(K,J);var F=K.prototype;F.normalizeCtorArgs=function(A){return"string"===typeof A?{url:A}:A};F.destroy=function(){this._esriIdCredentialCreateHandle=
c.removeMaybe(this._esriIdCredentialCreateHandle)};F.readAuthorizedCrossOriginDomains=function(A){if(A)for(const I of A)C.request.trustedServers.includes(I)||C.request.trustedServers.push(I);return A};F.readDefaultBasemap=function(A){return this._readBasemap(A)};F.readDefaultDevBasemap=function(A){return this._readBasemap(A)};F.readDefaultVectorBasemap=function(A){return this._readBasemap(A)};F.readUrlKey=function(A){return A?A.toLowerCase():A};F.readUser=function(A){let I=null;A&&(I=v.fromJSON(A),
I.portal=this);return I};F.load=function(A){const I=(new Promise((G,E)=>u(["../Basemap"],M=>G(z(M)),E))).then(({default:G})=>{d.throwIfAborted(A);r=G}).then(()=>this.sourceJSON?this.sourceJSON:this.fetchSelf(this.authMode,!1,A)).then(G=>{if(w.id){const E=w.id;this.credential=E.findCredential(this.restUrl);this.credential||this.authMode!==p.AUTH_MODE_AUTO||(this._esriIdCredentialCreateHandle=E.on("credential-create",()=>{E.findCredential(this.restUrl)&&this.signIn().catch(()=>{})}))}this.sourceJSON=
G;this.read(G)});this.addResolvingPromise(I);return Promise.resolve(this)};F.createElevationLayers=function(){var A=t._asyncToGenerator(function*(){yield this.load();const I=this._getHelperService("defaultElevationLayers"),G=(yield new Promise((E,M)=>u(["../layers/ElevationLayer"],T=>E(z(T)),M))).default;return I?I.map(E=>new G({id:E.id,url:E.url})):[]});return function(){return A.apply(this,arguments)}}();F.fetchBasemaps=function(A,I){const G=new q;G.query=A||(C.apiKey&&B.supportsApiKey(this.url)?
this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery);G.disableExtraQuery=!0;return this.queryGroups(G,I).then(E=>{G.num=100;G.query='type:"Web Map" -type:"Web Application"';return E.total?(E=E.results[0],G.sortField=E.sortField||"name",G.sortOrder=E.sortOrder||"desc",E.queryItems(G,I)):null}).then(E=>E&&E.total?E.results.filter(M=>"Web Map"===M.type).map(M=>new r({portalItem:M})):[])};F.fetchCategorySchema=function(A){return this.hasCategorySchema?
this.request(this.restUrl+"/portals/self/categorySchema",A).then(I=>I.categorySchema):d.isAborted(A)?Promise.reject(d.createAbortError()):Promise.resolve([])};F.fetchFeaturedGroups=function(A){const I=this.featuredGroups,G=new q;G.num=100;G.sortField="title";if(I&&I.length){const E=[];for(const M of I)E.push(`(title:"${M.title}" AND owner:${M.owner})`);G.query=E.join(" OR ");return this.queryGroups(G,A).then(M=>M.results)}return d.isAborted(A)?Promise.reject(d.createAbortError()):Promise.resolve([])};
F.fetchRegions=function(A){const I=this.user?.culture||this.culture||l.getLocale();return this.request(this.restUrl+"/portals/regions",{...A,query:{culture:I}})};F.fetchSettings=function(A){const I=this.user?.culture||this.culture||l.getLocale();return this.request(this.restUrl+"/portals/self/settings",{...A,query:{culture:I}})};K.getDefault=function(){if(!p._default||p._default.destroyed)p._default=new p;return p._default};F.queryGroups=function(A,I){return this.queryPortal("/community/groups",A,
"PortalGroup",I)};F.queryItems=function(A,I){return this.queryPortal("/search",A,"PortalItem",I)};F.queryUsers=function(A,I){A.sortField||(A.sortField="username");return this.queryPortal("/community/users",A,"PortalUser",I)};F.fetchSelf=function(A=this.authMode,I=!1,G){const E=this.restUrl+"/portals/self";A={authMode:A,query:{culture:l.getLocale().toLowerCase()},...G};"auto"===A.authMode&&(A.authMode="no-prompt");I&&(A.query.default=!0);return this.request(E,A)};F.queryPortal=function(A,I,G,E){const M=
k.ensureType(q,I),T=Y=>this.request(this.restUrl+A,{...M.toRequestOptions(this),...E}).then(fa=>{const ba=M.clone();ba.start=fa.nextStart;return new n({nextQueryParams:ba,queryParams:M,total:fa.total,results:p._resultsToTypedArray(Y,{portal:this},fa,E)})}).then(fa=>Promise.all(fa.results.map(ba=>"function"===typeof ba.when?ba.when():fa)).then(()=>fa,ba=>{d.throwIfAbortError(ba);return fa}));return G&&D[G]?D[G]().then(({default:Y})=>{d.throwIfAborted(E);return T(Y)}):T()};F.signIn=function(){if(this.authMode===
p.AUTH_MODE_ANONYMOUS)return Promise.reject(new x("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if("failed"===this.loadStatus)return Promise.reject(this.loadError);const A=I=>Promise.resolve().then(()=>{if("not-loaded"===this.loadStatus)return I||(this.authMode="immediate"),this.load().then(()=>null);if("loading"===this.loadStatus)return this.load().then(()=>{if(this.credential)return null;this.credential=I;return this.fetchSelf("immediate")});if(this.user&&this.credential===
I)return null;this.credential=I;return this.fetchSelf("immediate")}).then(G=>{G&&(this.sourceJSON=G,this.read(G))});return w.id?w.id.getCredential(this.restUrl).then(I=>A(I)):A(this.credential)};F.normalizeUrl=function(A){const I=this.credential&&this.credential.token;return this._normalizeSSL(I?A+(A.includes("?")?"\x26":"?")+"token\x3d"+I:A)};F.requestToTypedArray=function(A,I,G){return this.request(A,I).then(E=>{const M=p._resultsToTypedArray(G,{portal:this},E);return Promise.all(M.map(T=>"function"===
typeof T.when?T.when():E)).then(()=>M,()=>M)})};F.request=function(A,I={}){const G={f:"json",...I.query},{authMode:E=this.authMode===p.AUTH_MODE_ANONYMOUS?"anonymous":"auto",body:M=null,cacheBust:T=!1,method:Y="auto",responseType:fa="json",signal:ba}=I;I={authMode:E,body:M,cacheBust:T,method:Y,query:G,responseType:fa,timeout:0,signal:ba};return y(this._normalizeSSL(A),I).then(U=>U.data)};F.toJSON=function(){throw new x("internal:not-yet-implemented","Portal.toJSON is not yet implemented");};K.fromJSON=
function(A){if(!A)return null;if(A.declaredClass)throw Error("JSON object is already hydrated");return new p({sourceJSON:A})};F._getHelperService=function(A){const I=this.helperServices&&this.helperServices[A];if(!I)throw new x("portal:service-not-found",`The \`helperServices\` do not include an entry named "${A}"`);return I};F._normalizeSSL=function(A){return A.replace(/^http:/i,"https:").replace(":7080",":7443")};F._readBasemap=function(A){return A?(A=r.fromJSON(A),A.portalItem={portal:this},A):
null};K._resultsToTypedArray=function(A,I,G,E){let M=[];if(G){const T=c.isSome(E)?E.signal:null;M=G.listings||G.notifications||G.userInvitations||G.tags||G.items||G.groups||G.comments||G.provisions||G.results||G.relatedItems||G;if(A||I)M=M.map(Y=>{Y=Object.assign(A?A.fromJSON(Y):Y,I);"function"===typeof Y.load&&Y.load(T);return Y})}else M=[];return M};t._createClass(K,[{key:"extraQuery",get:function(){const A=!(this.user&&this.user.orgId)||this.canSearchPublic;return this.id&&!A?` AND orgid:${this.id}`:
null}},{key:"isOrganization",get:function(){return!!this.access}},{key:"itemPageUrl",get:function(){return this.url?`${this.url}/home/item.html`:null}},{key:"restUrl",get:function(){let A=this.url;if(A){const I=A.indexOf("/sharing");A=0<I?A.substring(0,I):this.url.replace(/\/+$/,"");A+="/sharing/rest"}return A}},{key:"thumbnailUrl",get:function(){const A=this.restUrl,I=this.thumbnail;return A&&I?this._normalizeSSL(A+"/portals/self/resources/"+I):null}}]);return K}(m.JSONSupportMixin(h));m.AUTH_MODE_ANONYMOUS=
"anonymous";m.AUTH_MODE_AUTO="auto";m.AUTH_MODE_IMMEDIATE="immediate";H.__decorate([f.property()],m.prototype,"access",void 0);H.__decorate([f.property()],m.prototype,"allSSL",void 0);H.__decorate([f.property()],m.prototype,"authMode",void 0);H.__decorate([f.property()],m.prototype,"authorizedCrossOriginDomains",void 0);H.__decorate([e.reader("authorizedCrossOriginDomains")],m.prototype,"readAuthorizedCrossOriginDomains",null);H.__decorate([f.property()],m.prototype,"basemapGalleryGroupQuery",void 0);
H.__decorate([f.property()],m.prototype,"bingKey",void 0);H.__decorate([f.property()],m.prototype,"canListApps",void 0);H.__decorate([f.property()],m.prototype,"canListData",void 0);H.__decorate([f.property()],m.prototype,"canListPreProvisionedItems",void 0);H.__decorate([f.property()],m.prototype,"canProvisionDirectPurchase",void 0);H.__decorate([f.property()],m.prototype,"canSearchPublic",void 0);H.__decorate([f.property()],m.prototype,"canShareBingPublic",void 0);H.__decorate([f.property()],m.prototype,
"canSharePublic",void 0);H.__decorate([f.property()],m.prototype,"canSignInArcGIS",void 0);H.__decorate([f.property()],m.prototype,"canSignInIDP",void 0);H.__decorate([f.property()],m.prototype,"colorSetsGroupQuery",void 0);H.__decorate([f.property()],m.prototype,"commentsEnabled",void 0);H.__decorate([f.property({type:Date})],m.prototype,"created",void 0);H.__decorate([f.property()],m.prototype,"credential",void 0);H.__decorate([f.property()],m.prototype,"culture",void 0);H.__decorate([f.property()],
m.prototype,"currentVersion",void 0);H.__decorate([f.property()],m.prototype,"customBaseUrl",void 0);H.__decorate([f.property()],m.prototype,"defaultBasemap",void 0);H.__decorate([e.reader("defaultBasemap")],m.prototype,"readDefaultBasemap",null);H.__decorate([f.property()],m.prototype,"defaultDevBasemap",void 0);H.__decorate([e.reader("defaultDevBasemap")],m.prototype,"readDefaultDevBasemap",null);H.__decorate([f.property({type:b})],m.prototype,"defaultExtent",void 0);H.__decorate([f.property()],
m.prototype,"defaultVectorBasemap",void 0);H.__decorate([e.reader("defaultVectorBasemap")],m.prototype,"readDefaultVectorBasemap",null);H.__decorate([f.property()],m.prototype,"description",void 0);H.__decorate([f.property()],m.prototype,"devBasemapGalleryGroupQuery",void 0);H.__decorate([f.property()],m.prototype,"eueiEnabled",void 0);H.__decorate([f.property({readOnly:!0})],m.prototype,"extraQuery",null);H.__decorate([f.property()],m.prototype,"featuredGroups",void 0);H.__decorate([f.property()],
m.prototype,"featuredItemsGroupQuery",void 0);H.__decorate([f.property()],m.prototype,"galleryTemplatesGroupQuery",void 0);H.__decorate([f.property()],m.prototype,"livingAtlasGroupQuery",void 0);H.__decorate([f.property()],m.prototype,"hasCategorySchema",void 0);H.__decorate([f.property()],m.prototype,"helpBase",void 0);H.__decorate([f.property()],m.prototype,"helperServices",void 0);H.__decorate([f.property()],m.prototype,"helpMap",void 0);H.__decorate([f.property()],m.prototype,"homePageFeaturedContent",
void 0);H.__decorate([f.property()],m.prototype,"homePageFeaturedContentCount",void 0);H.__decorate([f.property()],m.prototype,"httpPort",void 0);H.__decorate([f.property()],m.prototype,"httpsPort",void 0);H.__decorate([f.property()],m.prototype,"id",void 0);H.__decorate([f.property()],m.prototype,"ipCntryCode",void 0);H.__decorate([f.property({readOnly:!0})],m.prototype,"isOrganization",null);H.__decorate([f.property()],m.prototype,"isPortal",void 0);H.__decorate([f.property()],m.prototype,"isReadOnly",
void 0);H.__decorate([f.property({readOnly:!0})],m.prototype,"itemPageUrl",null);H.__decorate([f.property()],m.prototype,"layerTemplatesGroupQuery",void 0);H.__decorate([f.property()],m.prototype,"maxTokenExpirationMinutes",void 0);H.__decorate([f.property({type:Date})],m.prototype,"modified",void 0);H.__decorate([f.property()],m.prototype,"name",void 0);H.__decorate([f.property()],m.prototype,"portalHostname",void 0);H.__decorate([f.property()],m.prototype,"portalMode",void 0);H.__decorate([f.property()],
m.prototype,"portalProperties",void 0);H.__decorate([f.property()],m.prototype,"region",void 0);H.__decorate([f.property({readOnly:!0})],m.prototype,"restUrl",null);H.__decorate([f.property()],m.prototype,"rotatorPanels",void 0);H.__decorate([f.property()],m.prototype,"showHomePageDescription",void 0);H.__decorate([f.property()],m.prototype,"sourceJSON",void 0);H.__decorate([f.property()],m.prototype,"staticImagesUrl",void 0);H.__decorate([f.property({json:{name:"2DStylesGroupQuery"}})],m.prototype,
"stylesGroupQuery2d",void 0);H.__decorate([f.property({json:{name:"stylesGroupQuery"}})],m.prototype,"stylesGroupQuery3d",void 0);H.__decorate([f.property()],m.prototype,"supportsHostedServices",void 0);H.__decorate([f.property()],m.prototype,"symbolSetsGroupQuery",void 0);H.__decorate([f.property()],m.prototype,"templatesGroupQuery",void 0);H.__decorate([f.property()],m.prototype,"thumbnail",void 0);H.__decorate([f.property({readOnly:!0})],m.prototype,"thumbnailUrl",null);H.__decorate([f.property()],
m.prototype,"units",void 0);H.__decorate([f.property()],m.prototype,"url",void 0);H.__decorate([f.property()],m.prototype,"urlKey",void 0);H.__decorate([e.reader("urlKey")],m.prototype,"readUrlKey",null);H.__decorate([f.property()],m.prototype,"user",void 0);H.__decorate([e.reader("user")],m.prototype,"readUser",null);H.__decorate([f.property()],m.prototype,"useStandardizedQuery",void 0);H.__decorate([f.property()],m.prototype,"useVectorBasemaps",void 0);H.__decorate([f.property()],m.prototype,"vectorBasemapGalleryGroupQuery",
void 0);return m=p=H.__decorate([a.subclass("esri.portal.Portal")],m)})},"esri/core/Loadable":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./Error ./Promise ./promiseUtils ./Warning ./accessorSupport/decorators/property ./accessorSupport/decorators/subclass".split(" "),function(u,t,H,C,w,y,x,m){const h=c=>{c=function(d){function f(...g){var e=d.call(this,...g)||this;e._loadController=null;e.loadError=null;e.loadStatus="not-loaded";e._set("loadWarnings",[]);e.addResolvingPromise(new Promise(a=>
{const b=e.load.bind(u._assertThisInitialized(e));e.load=l=>{const q=new Promise((n,v)=>{const B=w.onAbortOrThrow(l,v);e.destroyed&&v(new H("load:instance-destroyed",`Instance of '${e.declaredClass||e.constructor.name}' is already destroyed`,{instance:u._assertThisInitialized(e)}));e._promiseProps.when(n,v).finally(()=>{B&&B.remove()})});if("not-loaded"===e.loadStatus){e._set("loadStatus","loading");const n=e._loadController=new AbortController;b({signal:n.signal});w.onAbort(n.signal,()=>{e._promiseProps.abort()})}a();
return q}}));e.when(()=>{e._set("loadStatus","loaded");e._loadController=null},a=>{e._set("loadStatus","failed");e._set("loadError",a);e._loadController=null});return e}u._inheritsLoose(f,d);var k=f.prototype;k.load=function(){return null};k.cancelLoad=function(){if(this.isFulfilled())return this;this._set("loadError",new H("load:cancelled","Cancelled"));this._loadController?.abort();return this};u._createClass(f,[{key:"loaded",get:function(){return"loaded"===this.loadStatus}},{key:"loadWarnings",
get:function(){return this._get("loadWarnings")}}]);return f}(c);t.__decorate([x.property({readOnly:!0})],c.prototype,"loaded",null);t.__decorate([x.property({readOnly:!0})],c.prototype,"loadError",void 0);t.__decorate([x.property({clonable:!1})],c.prototype,"loadStatus",void 0);t.__decorate([x.property({type:[y],readOnly:!0})],c.prototype,"loadWarnings",null);return c=t.__decorate([m.subclass("esri.core.Loadable")],c)};C=function(c){function d(){return c.apply(this,arguments)||this}u._inheritsLoose(d,
c);return d}(h(C.EsriPromise));C=t.__decorate([m.subclass("esri.core.Loadable")],C);(function(c){c.LoadableMixin=h;c.isLoadable=function(d){return!(!d||!d.load)}})(C||(C={}));return C})},"esri/core/Promise":function(){define("exports ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./Accessor ./maybe ./promiseUtils ./accessorSupport/decorators/subclass".split(" "),function(u,t,H,C,w,y,x){var m;(function(d){d[d.PENDING=0]="PENDING";d[d.RESOLVED=1]="RESOLVED";d[d.REJECTED=2]="REJECTED"})(m||
(m={}));let h=function(){function d(k){this.instance=k;this._resolver=y.createDeferred();this._status=m.PENDING;this._resolvingPromises=[];this._resolver.promise.then(()=>{this._status=m.RESOLVED;this._cleanUp()},()=>{this._status=m.REJECTED;this._cleanUp()})}var f=d.prototype;f.addResolvingPromise=function(k){this._resolvingPromises.push(k);this._tryResolve()};f.isResolved=function(){return this._status===m.RESOLVED};f.isRejected=function(){return this._status===m.REJECTED};f.isFulfilled=function(){return this._status!==
m.PENDING};f.abort=function(){this._resolver.reject(y.createAbortError())};f.when=function(k,g){return this._resolver.promise.then(k,g)};f._cleanUp=function(){this._allPromise=this._resolvingPromises=this._allPromise=null};f._tryResolve=function(){if(!this.isFulfilled()){var k=y.createDeferred(),g=[...this._resolvingPromises,w.assumeNonNull(k.promise)],e=this._allPromise=Promise.all(g);e.then(()=>{this.isFulfilled()||this._allPromise!==e||this._resolver.resolve(this.instance)},a=>{this.isFulfilled()||
this._allPromise!==e||y.isAbortError(a)||this._resolver.reject(a)});k.resolve()}};return d}();const c=d=>{d=function(f){function k(...e){e=f.call(this,...e)||this;e._promiseProps=new h(t._assertThisInitialized(e));e.addResolvingPromise(Promise.resolve());return e}t._inheritsLoose(k,f);var g=k.prototype;g.isResolved=function(){return this._promiseProps.isResolved()};g.isRejected=function(){return this._promiseProps.isRejected()};g.isFulfilled=function(){return this._promiseProps.isFulfilled()};g.when=
function(e,a){return(new Promise((b,l)=>{this._promiseProps.when(b,l)})).then(e,a)};g.catch=function(e){return this.when(null,e)};g.addResolvingPromise=function(e){e&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in e?e.when():e)};return k}(d);return d=H.__decorate([x.subclass("esri.core.Promise")],d)};u.EsriPromise=function(d){function f(){return d.apply(this,arguments)||this}t._inheritsLoose(f,d);return f}(c(C));u.EsriPromise=H.__decorate([x.subclass("esri.core.Promise")],
u.EsriPromise);u.EsriPromiseMixin=c;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/intl/locale":function(){define(["exports"],function(u){function t(){return m??globalThis.navigator?.language??"en"}function H(){void 0===x&&(x=t());return x}function C(f=H()){return/^([a-zA-Z]{2,3})(?:[_\-]\w+)*$/.exec(f)?.[1].toLowerCase()}function w(){const f=y??t();x!==f&&(x=f,[...d].forEach(k=>{k.call(null,f)}),[...c].forEach(k=>{k.call(null,f)}))}let y=void 0,x=void 0;const m=globalThis.esriConfig?.locale??
globalThis.dojoConfig?.locale,h={he:!0,ar:!0},c=[],d=[];globalThis.addEventListener?.("languagechange",w);u.beforeLocaleChange=function(f){d.push(f);return{remove(){c.splice(d.indexOf(f),1)}}};u.getDefaultLocale=t;u.getLanguage=C;u.getLocale=H;u.onLocaleChange=function(f){c.push(f);return{remove(){c.splice(c.indexOf(f),1)}}};u.prefersRTL=function(f=H()){f=C(f);return void 0!==f&&(h[f]||!1)};u.setLocale=function(f){y=f?f:void 0;w()};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/portal/PortalQueryParams":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Accessor ../core/jsonMap ../core/lang ../core/maybe ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ../geometry/Extent ../geometry/SpatialReference ../geometry/support/webMercatorUtils".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d,f){var k;const g=new C.JSONMap({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});H=k=function(e){function a(l){l=e.call(this,l)||this;l.categories=null;l.disableExtraQuery=!1;l.extent=null;l.filter=null;l.num=10;l.query=null;l.sortField=null;l.start=1;return l}u._inheritsLoose(a,e);var b=a.prototype;b.clone=function(){return new k({categories:this.categories?w.clone(this.categories):null,disableExtraQuery:this.disableExtraQuery,
extent:this.extent?this.extent.clone():null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})};b.toRequestOptions=function(l,q){let n=[];this.categories&&(n=this.categories.map(z=>Array.isArray(z)?JSON.stringify(z):z));let v="";if(this.extent){var B=f.project(this.extent,d.WGS84);y.isSome(B)&&(v=`${B.xmin},${B.ymin},${B.xmax},${B.ymax}`)}B=this.query;!this.disableExtraQuery&&l.extraQuery&&(B="("+B+")"+l.extraQuery);l={categories:n,
bbox:v,q:B,filter:this.filter,num:this.num,sortField:null,sortOrder:null,start:this.start};this.sortField&&(l.sortField=this.sortField.split(",").map(z=>g.toJSON(z.trim())).join(","),l.sortOrder=this.sortOrder);return{query:{...q,...l}}};u._createClass(a,[{key:"sortOrder",get:function(){return this._get("sortOrder")||"asc"},set:function(l){"asc"!==l&&"desc"!==l||this._set("sortOrder",l)}}]);return a}(H);t.__decorate([x.property()],H.prototype,"categories",void 0);t.__decorate([x.property()],H.prototype,
"disableExtraQuery",void 0);t.__decorate([x.property({type:c})],H.prototype,"extent",void 0);t.__decorate([x.property()],H.prototype,"filter",void 0);t.__decorate([x.property()],H.prototype,"num",void 0);t.__decorate([x.property()],H.prototype,"query",void 0);t.__decorate([x.property()],H.prototype,"sortField",void 0);t.__decorate([x.property()],H.prototype,"sortOrder",null);t.__decorate([x.property()],H.prototype,"start",void 0);return H=k=t.__decorate([h.subclass("esri.portal.PortalQueryParams")],
H)})},"esri/portal/PortalQueryResult":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/accessorSupport/decorators/subclass".split(" "),function(u,t,H,C,w,y,x){H=function(m){function h(c){c=m.call(this,c)||this;c.nextQueryParams=null;c.queryParams=null;c.results=null;c.total=null;return c}u._inheritsLoose(h,m);return h}(H);t.__decorate([C.property()],
H.prototype,"nextQueryParams",void 0);t.__decorate([C.property()],H.prototype,"queryParams",void 0);t.__decorate([C.property()],H.prototype,"results",void 0);t.__decorate([C.property()],H.prototype,"total",void 0);return H=t.__decorate([x.subclass("esri.portal.PortalQueryResult")],H)})},"esri/portal/PortalUser":function(){define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/accessorSupport/decorators/subclass ./PortalFolder ./PortalGroup".split(" "),
function(u,t,H,C,w,y,x,m,h,c,d){var f;w=f=function(k){function g(...a){a=k.call(this,...a)||this;a.access=null;a.created=null;a.culture=null;a.description=null;a.email=null;a.fullName=null;a.modified=null;a.orgId=null;a.portal=null;a.preferredView=null;a.privileges=null;a.region=null;a.role=null;a.roleId=null;a.sourceJSON=null;a.units=null;a.username=null;a.userType=null;return a}t._inheritsLoose(g,k);var e=g.prototype;e.addItem=function(a){const b=a&&a.item;var l=a&&a.data;a=a&&a.folder;const q=
{method:"post"};b&&(q.query=b.createPostQuery(),null!=l&&("string"===typeof l?q.query.text=l:"object"===typeof l&&(q.query.text=JSON.stringify(l))));l=this.userContentUrl;a&&(l+="/"+("string"===typeof a?a:a.id));return this.portal.request(l+"/addItem",q).then(n=>{b.id=n.id;b.portal=this.portal;return b.loaded?b.reload():b.load()})};e.deleteItem=function(a){let b=this.userContentUrl;a.ownerFolder&&(b+="/"+a.ownerFolder);return this.portal.request(b+`/items/${a.id}/delete`,{method:"post"}).then(()=>
{a.id=null;a.portal=null})};e.deleteItems=function(a){const b=this.userContentUrl+"/deleteItems";var l=a.map(q=>q.id);return l.length?(l={method:"post",query:{items:l.join(",")}},this.portal.request(b,l).then(()=>{a.forEach(q=>{q.id=null;q.portal=null})})):Promise.resolve(void 0)};e.fetchFolders=function(){return this.portal.request(this.userContentUrl??"",{query:{num:1}}).then(a=>a&&a.folders?a.folders.map(b=>{b=c.fromJSON(b);b.portal=this.portal;return b}):[])};e.fetchGroups=function(){return this.portal.request(this.url??
"").then(a=>a&&a.groups?a.groups.map(b=>{b=d.fromJSON(b);b.portal=this.portal;return b}):[])};e.fetchItems=function(a){const b=a??{};let l=this.userContentUrl??"";b.folder&&(l+="/"+b.folder.id);let q;return(new Promise((n,v)=>u(["./PortalItem"],B=>n(Object.freeze(Object.defineProperty({__proto__:null,default:B},Symbol.toStringTag,{value:"Module"}))),v))).then(({default:n})=>{q=n;return this.portal.request(l,{query:{folders:!1,num:b.num||10,start:b.start||1,sortField:b.sortField||"created",sortOrder:b.sortOrder||
"asc"}})}).then(n=>{let v;return n&&n.items?(v=n.items.map(B=>{B=q.fromJSON(B);B.portal=this.portal;return B}),Promise.all(v.map(B=>B.load())).catch(B=>B).then(()=>({items:v,nextStart:n.nextStart,total:n.total}))):{items:[],nextStart:-1,total:0}})};e.fetchTags=function(){return this.portal.request(this.url+"/tags").then(a=>a.tags)};e.getThumbnailUrl=function(a){let b=this.thumbnailUrl;b&&a&&(b+=`&w=${a}`);return b};e.queryFavorites=function(a){return this.favGroupId?(this._favGroup||(this._favGroup=
new d({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(a)):Promise.reject(new C("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))};e.toJSON=function(){throw new C("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented");};g.fromJSON=function(a){if(!a)return null;if(a.declaredClass)throw Error("JSON object is already hydrated");const b=new f;b.sourceJSON=a;b.read(a);return b};t._createClass(g,[{key:"thumbnailUrl",get:function(){const a=
this.url,b=this.thumbnail;return a&&b?this.portal.normalizeUrl(`${a}/info/${b}?f=json`):null}},{key:"userContentUrl",get:function(){const a=this.get("portal.restUrl");return a?`${a}/content/users/${this.username}`:null}},{key:"url",get:function(){const a=this.get("portal.restUrl");return a?`${a}/community/users/${this.username}`:null}}]);return g}(w.JSONSupport);H.__decorate([y.property()],w.prototype,"access",void 0);H.__decorate([y.property({type:Date})],w.prototype,"created",void 0);H.__decorate([y.property()],
w.prototype,"culture",void 0);H.__decorate([y.property()],w.prototype,"description",void 0);H.__decorate([y.property()],w.prototype,"email",void 0);H.__decorate([y.property()],w.prototype,"favGroupId",void 0);H.__decorate([y.property()],w.prototype,"fullName",void 0);H.__decorate([y.property({type:Date})],w.prototype,"modified",void 0);H.__decorate([y.property()],w.prototype,"orgId",void 0);H.__decorate([y.property()],w.prototype,"portal",void 0);H.__decorate([y.property()],w.prototype,"preferredView",
void 0);H.__decorate([y.property()],w.prototype,"privileges",void 0);H.__decorate([y.property()],w.prototype,"region",void 0);H.__decorate([y.property()],w.prototype,"role",void 0);H.__decorate([y.property()],w.prototype,"roleId",void 0);H.__decorate([y.property()],w.prototype,"sourceJSON",void 0);H.__decorate([y.property()],w.prototype,"thumbnail",void 0);H.__decorate([y.property({readOnly:!0})],w.prototype,"thumbnailUrl",null);H.__decorate([y.property()],w.prototype,"units",void 0);H.__decorate([y.property({readOnly:!0})],
w.prototype,"userContentUrl",null);H.__decorate([y.property({readOnly:!0})],w.prototype,"url",null);H.__decorate([y.property()],w.prototype,"username",void 0);H.__decorate([y.property()],w.prototype,"userType",void 0);return w=f=H.__decorate([h.subclass("esri.portal.PortalUser")],w)})},"esri/portal/PortalFolder":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/accessorSupport/decorators/subclass".split(" "),
function(u,t,H,C,w,y,x,m){C=function(h){function c(d){d=h.call(this,d)||this;d.created=null;d.id=null;d.portal=null;d.title=null;d.username=null;return d}u._inheritsLoose(c,h);c.prototype.toJSON=function(){throw new H("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented");};u._createClass(c,[{key:"url",get:function(){const d=this.get("portal.restUrl");return d?`${d}/content/users/${this.username}/${this.id}`:null}}]);return c}(C.JSONSupport);t.__decorate([w.property({type:Date})],
C.prototype,"created",void 0);t.__decorate([w.property()],C.prototype,"id",void 0);t.__decorate([w.property()],C.prototype,"portal",void 0);t.__decorate([w.property()],C.prototype,"title",void 0);t.__decorate([w.property({readOnly:!0})],C.prototype,"url",null);t.__decorate([w.property()],C.prototype,"username",void 0);return C=t.__decorate([m.subclass("esri.portal.PortalFolder")],C)})},"esri/portal/PortalGroup":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/maybe ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/accessorSupport/decorators/subclass ./PortalQueryParams".split(" "),
function(u,t,H,C,w,y,x,m,h,c){C=function(d){function f(g){g=d.call(this,g)||this;g.access=null;g.created=null;g.description=null;g.id=null;g.isInvitationOnly=!1;g.modified=null;g.owner=null;g.portal=null;g.snippet=null;g.sortField=null;g.sortOrder=null;g.tags=null;g.title=null;return g}u._inheritsLoose(f,d);var k=f.prototype;k.fetchCategorySchema=function(g){return w.unwrapOrThrow(this.portal).request(this.url+"/categorySchema",g).then(e=>{e=e.categorySchema||[];return e.some(a=>"contentCategorySetsGroupQuery.LivingAtlas"===
a.source)?this._fetchCategorySchemaSet("LivingAtlas",g):e})};k.fetchMembers=function(g){return w.unwrapOrThrow(this.portal).request(this.url+"/users",g)};k.getThumbnailUrl=function(g){let e=this.thumbnailUrl;e&&g&&(e+=`&w=${g}`);return e};k.toJSON=function(){throw new H("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented");};k.queryItems=function(g,e){g=x.ensureType(c,g);const a=w.unwrapOrThrow(this.portal);if(5<parseFloat(a.currentVersion))return g=g||new c,a.queryPortal(`/content/groups/${this.id}/search`,
g,"PortalItem",e);g=g?g.clone():new c;g.query="group:"+this.id+(g.query?" "+g.query:"");return a.queryItems(g,e)};k._fetchCategorySchemaSet=function(g,e){const a=w.unwrapOrThrow(this.portal);return a.fetchSelf(a.authMode,!0,e).then(b=>{if(b=b.contentCategorySetsGroupQuery){const l=new c;l.disableExtraQuery=!0;l.num=1;l.query=b;return a.queryGroups(l,e)}throw new H("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found");}).then(b=>{if(b.total){b=b.results[0];const l=new c;
l.num=1;l.query=`typekeywords:"${g}"`;return b.queryItems(l,e)}throw new H("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found");}).then(b=>b.total?b.results[0].fetchData("json",e).then(l=>(l=l&&l.categorySchema)&&l.length?l:[]):[])};u._createClass(f,[{key:"thumbnailUrl",get:function(){const g=this.url,e=this.thumbnail;return g&&e&&this.portal?this.portal?.normalizeUrl(`${g}/info/${e}?f=json`):null}},{key:"url",get:function(){const g=this.get("portal.restUrl");return g?
g+"/community/groups/"+this.id:null}}]);return f}(C.JSONSupport);t.__decorate([y.property()],C.prototype,"access",void 0);t.__decorate([y.property({type:Date})],C.prototype,"created",void 0);t.__decorate([y.property()],C.prototype,"description",void 0);t.__decorate([y.property()],C.prototype,"id",void 0);t.__decorate([y.property()],C.prototype,"isInvitationOnly",void 0);t.__decorate([y.property({type:Date})],C.prototype,"modified",void 0);t.__decorate([y.property()],C.prototype,"owner",void 0);t.__decorate([y.property()],
C.prototype,"portal",void 0);t.__decorate([y.property()],C.prototype,"snippet",void 0);t.__decorate([y.property()],C.prototype,"sortField",void 0);t.__decorate([y.property()],C.prototype,"sortOrder",void 0);t.__decorate([y.property()],C.prototype,"tags",void 0);t.__decorate([y.property()],C.prototype,"thumbnail",void 0);t.__decorate([y.property({readOnly:!0})],C.prototype,"thumbnailUrl",null);t.__decorate([y.property()],C.prototype,"title",void 0);t.__decorate([y.property({readOnly:!0})],C.prototype,
"url",null);return C=t.__decorate([h.subclass("esri.portal.PortalGroup")],C)})},"esri/symbols/support/styleUtils":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../request ../../core/Error ../../core/maybe ../../core/promiseUtils ../../core/urlUtils ../../portal/Portal ../../portal/PortalQueryParams ../../support/featureFlags".split(" "),function(u,t,H,C,w,y,x,m,h,c){function d(a,b){return f.apply(this,arguments)}function f(){f=t._asyncToGenerator(function*(a,b){try{return{data:(yield e(a,
b)).data,baseUrl:x.removeFile(a),styleUrl:a}}catch(l){return y.throwIfAbortError(l),null}});return f.apply(this,arguments)}function k(a,b,l){b=w.isSome(b.portal)?b.portal:m.getDefault();let q;const n=`${b.url} - ${b.user&&b.user.username} - ${a}`;u.cachedStyles[n]||(u.cachedStyles[n]=g(a,b,l).then(v=>{q=v;return v.fetchData()}).then(v=>({data:v,baseUrl:q.itemUrl??"",styleName:a})));return u.cachedStyles[n]}function g(a,b,l){return b.load(l).then(()=>{const q=new h({disableExtraQuery:!0,query:`owner:${"esri_en"} AND type:${"Style"} AND typekeywords:"${a}"`});
return b.queryItems(q,l)}).then(({results:q})=>{let n=null;const v=a.toLowerCase();if(q&&Array.isArray(q))for(const B of q)if(B.typeKeywords?.some(z=>z.toLowerCase()===v)&&"Style"===B.type&&"esri_en"===B.owner){n=B;break}if(!n)throw new C("symbolstyleutils:style-not-found",`The style '${a}' could not be found`,{styleName:a});return n.load(l)})}function e(a,b){b={responseType:"json",query:{f:"json"},...b};return H(x.normalize(a),b)}u.cachedStyles={};u.Style2DUrlTemplate="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f\x3djson";
u.cleanupStyleUtilsCache=function(){u.cachedStyles&&(u.cachedStyles={})};u.fetchStyle=function(a,b,l){return a&&w.isSome(a.styleUrl)?d(a.styleUrl,l):a&&w.isSome(a.styleName)?k(a.styleName,b,l):Promise.reject(new C("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))};u.makeCIMSymbolRef=function(a){return null===a||"CIMSymbolReference"===a.type?a:{type:"CIMSymbolReference",symbol:a}};u.requestJSON=e;u.symbolUrlFromStyleItem=function(a,b){if("cimRef"===
b)return a.cimRef;if(a.formatInfos&&!c.enableWebStyleForceWOSR())for(const l of a.formatInfos)if("gltf"===l.type)return l.href;return a.webRef};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/support/featureFlags":function(){define(["exports","../core/has"],function(u,t){const H=()=>t.cache["enable-feature:direct-3d-object-feature-layer-display"]=!0;u.enableDirect3DObjectFeatureLayerDisplay=()=>!!t("enable-feature:direct-3d-object-feature-layer-display");u.enableSceneLayerEditing=
()=>{t.cache["enable-feature:SceneLayer-editing"]=!0;H()};u.enableWebStyleForceWOSR=()=>!!t("enable-feature:force-wosr");u.sceneLayerEditingEnabled=()=>!!t("enable-feature:SceneLayer-editing");u.turnOnDirect3DObjectFeatureLayerDisplay=H;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/util/Matcher":function(){define("require exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/Logger ../../../../../core/LRUCache ../../../../../core/maybe ../../../../../support/arcadeOnDemand ../../../arcade/callExpressionWithFeature ../../../layers/support/cimSymbolUtils".split(" "),
function(u,t,H,C,w,y,x,m,h,c){function d(p,r,D,J){return f.apply(this,arguments)}function f(){f=H._asyncToGenerator(function*(p,r,D,J){switch(p.type){case "simple":case "heatmap":return l.fromBasicRenderer(p,r,D,J);case "map":return v.fromUVRenderer(p,r,D,J);case "interval":return n.fromCBRenderer(p,r,D,J);case "dictionary":return z.fromDictionaryRenderer(p,r,D,J);case "pie-chart":return q.fromPieChartRenderer(p,r,D,J);case "subtype":return q.fromSubtypes(p,r,D,J)}});return f.apply(this,arguments)}
function k(p,r){return g.apply(this,arguments)}function g(){g=H._asyncToGenerator(function*(p,r){const D=p||1;if("number"===typeof D)return(K,F,A)=>D;const J=yield m.createRendererExpression(D,r.spatialReference,r.fields);return(K,F,A)=>h(J,K,{$view:A},r.geometryType,F)||1});return g.apply(this,arguments)}function e(){return a.apply(this,arguments)}function a(){a=H._asyncToGenerator(function*(){B||(B=new Promise((p,r)=>u(["../../../layers/features/createSymbolSchema"],p,r)));return B});return a.apply(this,
arguments)}const b=w.getLogger("esri/views/2d/engine/webgl/util/Matcher");let l=function(){function p(){this.type="feature";this._defaultResult=null}p.fromBasicRenderer=function(){var D=H._asyncToGenerator(function*(J,K,F,A){const I=new p;J.symbol&&(J=yield c.expandSymbol(J.symbol,F,A),K=K.createTemplateGroup(J,null),I.setDefault(K));return I});return function(J,K,F,A){return D.apply(this,arguments)}}();p.fromPieChartRenderer=function(){var D=H._asyncToGenerator(function*(J,K,F,A){const I=new p;if(J.markerSymbol){const G=
yield c.expandSymbol(J.markerSymbol,F,A);let E;J.fillSymbol&&(E=yield c.expandSymbol(J.fillSymbol,F,A));J=K.createTemplateGroup(G,E);I.setDefault(J)}return I});return function(J,K,F,A){return D.apply(this,arguments)}}();var r=p.prototype;r.size=function(){return 1};r.getDefault=function(){return this._defaultResult};r.setDefault=function(D){this._defaultResult=D};r.match=function(D,J,K,F,A){return this.getDefault()};r.analyze=function(){var D=H._asyncToGenerator(function*(J,K,F,A,I,G){return null});
return function(J,K,F,A,I,G){return D.apply(this,arguments)}}();return p}(),q=function(p){function r(D,J){var K=p.call(this)||this;K._subMatchers=D;K._subtypeField=J;return K}H._inheritsLoose(r,p);r.fromSubtypes=function(){var D=H._asyncToGenerator(function*(J,K,F,A){const I=new Map,G=[];for(const E in J.renderers){const M=parseInt(E,10),T=d(J.renderers[E],K,F,A).then(Y=>I.set(M,Y));G.push(T)}yield Promise.all(G);return new r(I,J.subtypeField)});return function(J,K,F,A){return D.apply(this,arguments)}}();
r.prototype.match=function(D,J,K,F,A){var I=J.readAttribute(this._subtypeField);return(I=this._subMatchers.get(I))?I.match(D,J,K,F,A):null};return r}(l),n=function(p){function r(J,K,F,A){var I=p.call(this)||this;I.type="interval";I._intervals=[];I._isMaxInclusive=K;I._fieldIndex=A;I._field=J;I._normalizationInfo=F;return I}H._inheritsLoose(r,p);r.fromCBRenderer=function(){var J=H._asyncToGenerator(function*(K,F,A,I){const {isMaxInclusive:G,normalizationField:E,normalizationTotal:M,normalizationType:T}=
K,Y=new r(K.field,G,{normalizationField:E,normalizationTotal:M,normalizationType:T},K.fieldIndex),fa=yield c.expandSymbol(K.backgroundFillSymbol,A,I);yield Promise.all(K.intervals.map(function(){var ba=H._asyncToGenerator(function*(U){var P=yield c.expandSymbol(U.symbol,A,I);P=yield F.createTemplateGroup(P,fa);Y.add({min:U.min,max:U.max},P)});return function(U){return ba.apply(this,arguments)}}()));if(K=yield c.expandSymbol(K.defaultSymbol,A,I))K=yield F.createTemplateGroup(K,fa),Y.setDefault(K);
return Y});return function(K,F,A,I){return J.apply(this,arguments)}}();var D=r.prototype;D.add=function(J,K){this._intervals.push({interval:J,result:K});this._intervals.sort((F,A)=>F.interval.min-A.interval.min)};D.size=function(){return p.prototype.size.call(this)+this._intervals.length};D.match=function(J,K,F,A,I){if(null==this._fieldIndex&&!this._field)return this.getDefault();J=null!=this._fieldIndex?K.getComputedNumericAtIndex(this._fieldIndex):this._getValueFromField(K);if(null===J||void 0===
J||isNaN(J)||Infinity===J||-Infinity===J)return this.getDefault();for(K=0;K<this._intervals.length;K++){const {interval:G,result:E}=this._intervals[K];F=this._isMaxInclusive?J<=G.max:J<G.max;if(J>=G.min&&F)return E}return this.getDefault()};D._needsNormalization=function(){const J=this._normalizationInfo;return J&&(J.normalizationField||J.normalizationTotal||J.normalizationType)};D._getValueFromField=function(J){const K=J.readAttribute(this._field);if(!this._needsNormalization()||null==K)return K;
const {normalizationField:F,normalizationTotal:A,normalizationType:I}=this._normalizationInfo;J=J.readAttribute(F)??1;if(I)switch(I){case "esriNormalizeByField":return(J||void 0)&&K/J;case "esriNormalizeByLog":return Math.log(K)*Math.LOG10E;case "esriNormalizeByPercentOfTotal":return K/A*100;default:b.error(`Found unknown normalization type: ${I}`)}else b.error("Normalization is required, but no type was set!")};return r}(l),v=function(p){function r(J,K,F){var A=p.call(this)||this;A.type="map";A._nullResult=
null;A._resultsMap=new Map;A._fields=[];A._fieldsIndex=F;A._fields=J;A._seperator=K||"";return A}H._inheritsLoose(r,p);r.fromUVRenderer=function(){var J=H._asyncToGenerator(function*(K,F,A,I){const G=K.fieldDelimiter,E=[K.field];K.field2&&E.push(K.field2);K.field3&&E.push(K.field3);const M=yield c.expandSymbol(K.backgroundFillSymbol,A,I),T=new r(E,G,K.fieldIndex);yield Promise.all(K.map.map(function(){var Y=H._asyncToGenerator(function*(fa,ba){const U=yield c.expandSymbol(fa.symbol,A,I);ba=yield F.createTemplateGroup(U,
M,ba+1);"\x3cNull\x3e"===fa.value?T.setNullResult(ba):T.add(fa.value,ba)});return function(fa,ba){return Y.apply(this,arguments)}}()));if(K=yield c.expandSymbol(K.defaultSymbol,A,I))K=yield F.createTemplateGroup(K,M,Number.MAX_SAFE_INTEGER),T.setDefault(K);return T});return function(K,F,A,I){return J.apply(this,arguments)}}();var D=r.prototype;D.setNullResult=function(J){this._nullResult=J};D.add=function(J,K){this._resultsMap.set(J.toString(),K)};D.size=function(){return p.prototype.size.call(this)+
this._resultsMap.size};D.match=function(J,K,F,A,I){if(null==this._fieldsIndex&&!this._fields)return this.getDefault();J=null!=this._fieldsIndex?K.getComputedStringAtIndex(this._fieldsIndex):this._getValueFromFields(K);if(null!==this._nullResult&&(null==J||""===J||"\x3cNull\x3e"===J))return this._nullResult;if(null==J)return this.getDefault();J=J.toString();return this._resultsMap.has(J)?this._resultsMap.get(J):this.getDefault()};D._getValueFromFields=function(J){const K=[];for(const F of this._fields){const A=
J.readAttribute(F);null==A||""===A?K.push("\x3cNull\x3e"):K.push(A)}return K.join(this._seperator)};return r}(l),B,z=function(p){function r(J,K,F,A,I,G){var E=p.call(this)||this;E.type="dictionary";E._groupIdCache=new y(100);E._loader=J;E._fieldMap=J.fieldMap;E._symbolFields=J.getSymbolFields();E._templates=K;E._info=F;E._scaleFn=A;E._schemaUtilsModule=I;E._symbolOptions=G;return E}H._inheritsLoose(r,p);r.fromDictionaryRenderer=function(){var J=H._asyncToGenerator(function*(K,F,A,I){const [{DictionaryLoader:G},
E]=yield Promise.all([new Promise((T,Y)=>u(["../../../../../renderers/support/DictionaryLoader"],T,Y)),e()]);I=new G(K.url,K.config,K.fieldMap);yield I.fetchResources({spatialReference:A.spatialReference,fields:A.fields});const M=yield k(K.scaleExpression,A);return new r(I,F,A,M,E,K.symbolOptions)});return function(K,F,A,I){return J.apply(this,arguments)}}();var D=r.prototype;D._analyzeFeature=function(){var J=H._asyncToGenerator(function*(K,F,A,I,G){K=K.readLegacyFeature();const E=this._scaleFn(K,
A,I);A=this._attributeHash(K)+"-"+E;const M=this._groupIdCache.get(A);if(M)return M;I=yield this._loader.getSymbolAsync(K,{...I,spatialReference:this._info.spatialReference,abortOptions:G,fields:this._info.fields});I=this._schemaUtilsModule.createSymbolSchema(I,this._symbolOptions);F=c.expandSymbol(I,this._info,F,G).then(T=>{if("expanded-cim"!==T?.type)return b.error(new C("mapview-bad-type",`Found unexpected type ${T?.type} in dictionary response`)),null;T.hash+="-"+E;for(const Y of T.layers)Y.scaleFactor=
E,Y.templateHash+="-"+E;return this._templates.createTemplateGroup(T,null)});this._groupIdCache.put(A,F,1);return F});return function(K,F,A,I,G){return J.apply(this,arguments)}}();D.analyze=function(){var J=H._asyncToGenerator(function*(K,F,A,I,G,E){K=F.getCursor();for(F=[];K.next();)F.push(this._analyzeFeature(K,A,I,G,E));return Promise.all(F).then(M=>M.filter(x.isSome))});return function(K,F,A,I,G,E){return J.apply(this,arguments)}}();D.match=function(J,K,F,A,I){return null};D._attributeHash=function(J){let K=
"";for(const F of this._symbolFields){const A=this._fieldMap?.[F];A&&(K+=J.attributes[A]+"-")}return K};return r}(l);t.DictionaryMatcher=z;t.FeatureMatcher=l;t.IntervalMatcher=n;t.MapMatcher=v;t.SubtypeMatcher=q;t.createMatcher=d;Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})})},"esri/core/LRUCache":function(){define(["../chunks/_rollupPluginBabelHelpers","./MemCache"],function(u,t){return function(){function H(w,y){this._storage=new t.MemCacheStorage;this._storage.maxSize=w;y&&this._storage.registerRemoveFunc("",
y)}var C=H.prototype;C.put=function(w,y,x){this._storage.put(w,y,x,1)};C.pop=function(w){return this._storage.pop(w)};C.get=function(w){return this._storage.get(w)};C.clear=function(){this._storage.clearAll()};C.destroy=function(){this._storage.destroy()};u._createClass(H,[{key:"maxSize",get:function(){return this._storage.maxSize},set:function(w){this._storage.maxSize=w}}]);return H}()})},"esri/views/2d/layers/features/processors/BaseProcessor":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/HandleOwner ../../../../../core/accessorSupport/decorators/property ../../../../../core/accessorSupport/ensureType ../../../../../core/arrayUtils ../../../../../core/accessorSupport/decorators/subclass".split(" "),
function(u,t,H,C,w,y,x){H=function(m){function h(){return m.apply(this,arguments)||this}u._inheritsLoose(h,m);var c=h.prototype;c.initialize=function(){};c.destroy=function(){};u._createClass(h,[{key:"supportsTileUpdates",get:function(){return!1}},{key:"spatialReference",get:function(){const d=this.get("tileStore.tileScheme.spatialReference");return d&&d.toJSON()||null}}]);return h}(H.HandleOwner);t.__decorate([C.property({readOnly:!0})],H.prototype,"supportsTileUpdates",null);t.__decorate([C.property({constructOnly:!0})],
H.prototype,"remoteClient",void 0);t.__decorate([C.property({constructOnly:!0})],H.prototype,"service",void 0);t.__decorate([C.property()],H.prototype,"spatialReference",null);t.__decorate([C.property({constructOnly:!0})],H.prototype,"tileInfo",void 0);t.__decorate([C.property({constructOnly:!0})],H.prototype,"tileStore",void 0);return H=t.__decorate([x.subclass("esri.views.2d.layers.features.processors.BaseProcessor")],H)})},"esri/views/2d/layers/features/support/ResourceManagerProxy":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers",
"../../../../../core/promiseUtils"],function(u,t){return function(){function H(w){this._remoteClient=w;this._resourceMap=new Map;this._inFlightResourceMap=new Map;this.geometryEnginePromise=this.geometryEngine=null}var C=H.prototype;C.destroy=function(){};C.fetchResource=function(){var w=u._asyncToGenerator(function*(y,x){const m=this._resourceMap;var h=m.get(y);if(h||(h=this._inFlightResourceMap.get(y)))return h;try{h=this._remoteClient.invoke("tileRenderer.fetchResource",{url:y},{...x}),this._inFlightResourceMap.set(y,
h),h.then(c=>{this._inFlightResourceMap.delete(y);m.set(y,c);return c})}catch(c){return t.isAbortError(c)?null:{width:0,height:0}}return h});return function(y,x){return w.apply(this,arguments)}}();C.getResource=function(w){return this._resourceMap.get(w)??null};return H}()})},"*noref":1}});
define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/HandleOwner ../../../../core/has ../../../../core/reactiveUtils ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/accessorSupport/decorators/subclass ../../../../geometry/support/spatialReferenceUtils ../../../../layers/support/TileInfo ./processors ./controllers/FeatureController2D ./support/TileStore ./support/UpdateToken ../../tiling/TileInfoView".split(" "),function(u,
t,H,C,w,y,x,m,h,c,d,f,k,g,e,a){H=function(b){function l(){var n=b.apply(this,arguments)||this;n.controller=null;n.processor=null;n.remoteClient=null;n.tileStore=null;n.service=null;n.viewState=null;n._paused=!1;n._pendingTileUpdates=[];return n}u._inheritsLoose(l,b);var q=l.prototype;q.initialize=function(){this.handles.add(w.watch(()=>this.updating,n=>{this.remoteClient.invoke("setUpdating",n).catch(v=>{})}))};q.destroy=function(){this.stop();this.controller?.destroy();this.processor?.destroy();
this.controller=this.processor=this.tileStore=this.remoteClient=null};q.stop=function(){this._paused=!0;Array.isArray(this.service?.source)&&(this.service.source.forEach(n=>n.close()),this.service.source.length=0);this.tileStore?.updateTiles({added:[],removed:this.tileStore.tiles.map(n=>n.id)});this.tileStore?.destroy();this.tileStore=null;this._pendingTileUpdates.length=0};q.startup=function(){var n=u._asyncToGenerator(function*({service:v,config:B,tileInfo:z,tiles:p}){this._paused=!0;Array.isArray(this.service?.source)&&
(this.service.source.forEach(r=>r.close()),this.service.source.length=0);this.service=v;this.tileStore&&c.equals(this.tileStore.tileScheme.spatialReference,z.spatialReference)||(v=new a(d.fromJSON(z)),p.added.length=p.removed.length=0,this.tileStore?.updateTiles({added:[],removed:this.tileStore.tiles.map(r=>r.id)}),this.tileStore?.destroy(),this.tileStore=new g(v),this._pendingTileUpdates.length=0);yield this._createProcessorAndController(B);yield this.update({config:B});this.controller.resume();
this.tileStore.clear();this.tileStore.updateTiles(p);for(this._paused=!1;this._pendingTileUpdates.length;)this.tileStore.updateTiles(this._pendingTileUpdates.pop())});return function(v){return n.apply(this,arguments)}}();q.updateTiles=function(){var n=u._asyncToGenerator(function*(v){this._paused?this._pendingTileUpdates.push(v):this.tileStore?.updateTiles(v)});return function(v){return n.apply(this,arguments)}}();q.update=function(){var n=u._asyncToGenerator(function*({config:v}){const B=e.UpdateToken.empty();
yield Promise.all([this.processor.update(B,v),this.controller.update(B,v)]);return B.toJSON()});return function(v){return n.apply(this,arguments)}}();q.applyUpdate=function(){var n=u._asyncToGenerator(function*(v){return this.controller.applyUpdate(e.UpdateToken.create(v))});return function(v){return n.apply(this,arguments)}}();q._createProcessorAndController=function(){var n=u._asyncToGenerator(function*(v){yield Promise.all([this._handleControllerConfig(v),this._handleProcessorConfig(v)]);this.controller.processor=
this.processor});return function(v){return n.apply(this,arguments)}}();q._handleControllerConfig=function(){var n=u._asyncToGenerator(function*(v){return this._createController(this.service,v)});return function(v){return n.apply(this,arguments)}}();q._handleProcessorConfig=function(){var n=u._asyncToGenerator(function*(v){return this._createProcessor(this.service,v)});return function(v){return n.apply(this,arguments)}}();q._createController=function(){var n=u._asyncToGenerator(function*(v,B){this.controller&&
this.controller.destroy();const {tileStore:z,remoteClient:p}=this;return this.controller=v=new k({service:v,tileStore:z,remoteClient:p})});return function(v,B){return n.apply(this,arguments)}}();q._createProcessor=function(){var n=u._asyncToGenerator(function*(v,B){const z=(yield f.loadProcessorModule(B.schema.processors[0].type)).default,{remoteClient:p,tileStore:r}=this;v=new z({service:v,config:B,tileStore:r,remoteClient:p});this.processor&&this.processor.destroy();return this.processor=v});return function(v,
B){return n.apply(this,arguments)}}();u._createClass(l,[{key:"updating",get:function(){return!this.controller||this.controller.updating}}]);return l}(H.HandleOwner);t.__decorate([y.property()],H.prototype,"controller",void 0);t.__decorate([y.property()],H.prototype,"processor",void 0);t.__decorate([y.property()],H.prototype,"updating",null);t.__decorate([y.property()],H.prototype,"viewState",void 0);return H=t.__decorate([h.subclass("esri.views.2d.layers.features.Pipeline")],H)});