// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.26/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/2d/engine/vectorTiles/TileHandler":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/promiseUtils ../../../../core/urlUtils ../../../../core/workers/workers ./GlyphMosaic ./GlyphSource ./SpriteMosaic ../../tiling/TileKey".split(" "),function(B,F,x,A,f,q,d,a,b){let c=function(){function l(p,m,h){this._layer=p;this._styleRepository=m;this.devicePixelRatio=h;this._connection=this._glyphMosaic=this._spriteMosaic=null}var u=l.prototype;
u.destroy=function(){this._connection?.close();this._glyphMosaic=this._spriteMosaic=this._layer=this._styleRepository=this._connection=null};u.start=function(){var p=F._asyncToGenerator(function*(m){this._spriteSourcePromise=this._layer.loadSpriteSource(this.devicePixelRatio,m);this._spriteSourcePromise.then(v=>{this._spriteMosaic=new a(1024,1024,250);this._spriteMosaic.setSpriteSource(v)});var h=this._layer.currentStyleInfo.glyphsUrl;h=new d(h?A.addQueryParameters(h,{...this._layer.customParameters,
token:this._layer.apiKey}):null);this._glyphMosaic=new q(1024,1024,h);this._broadcastPromise=f.open("WorkerTileHandler",{client:this,schedule:m.schedule,signal:m.signal}).then(v=>{this._connection=v;this._layer&&!this._connection.closed&&(v=v.broadcast("setStyle",this._layer.currentStyleInfo.style,m),Promise.all(v).catch(w=>x.throwIfNotAbortError(w)))})});return function(m){return p.apply(this,arguments)}}();u.updateStyle=function(){var p=F._asyncToGenerator(function*(m){yield this._broadcastPromise;
return this._broadcastPromise=Promise.all(this._connection.broadcast("updateStyle",m))});return function(m){return p.apply(this,arguments)}}();u.setSpriteSource=function(p){const m=new a(1024,1024,250);m.setSpriteSource(p);this._spriteMosaic=m;this._spriteSourcePromise=Promise.resolve(p);return m};u.setStyle=function(){var p=F._asyncToGenerator(function*(m,h){yield this._broadcastPromise;this._styleRepository=m;this._spriteSourcePromise=this._layer.loadSpriteSource(this.devicePixelRatio,null);this._spriteSourcePromise.then(v=>
{this._spriteMosaic=new a(1024,1024,250);this._spriteMosaic.setSpriteSource(v)});m=new d(this._layer.currentStyleInfo.glyphsUrl?A.addQueryParameters(this._layer.currentStyleInfo.glyphsUrl,{...this._layer.customParameters,token:this._layer.apiKey}):null);this._glyphMosaic=new q(1024,1024,m);return this._broadcastPromise=Promise.all(this._connection.broadcast("setStyle",h))});return function(m,h){return p.apply(this,arguments)}}();u.fetchTileData=function(p,m){return this._getRefKeys(p,m).then(h=>{const v=
this._layer.sourceNameToSource,w=[];for(const g in v)w.push(g);return this._getSourcesData(w,h,m)})};u.parseTileData=function(p,m){const h=p&&p.data;if(!h)return Promise.resolve(null);const {sourceName2DataAndRefKey:v,transferList:w}=h;return 0===Object.keys(v).length?Promise.resolve(null):this._broadcastPromise.then(()=>this._connection.invoke("createTileAndParse",{key:p.key.id,sourceName2DataAndRefKey:v,styleLayerUIDs:p.styleLayerUIDs},{...m,transferList:w}))};u.getSprites=function(){var p=F._asyncToGenerator(function*(m){yield this._spriteSourcePromise;
return this._spriteMosaic.getSpriteItems(m)});return function(m){return p.apply(this,arguments)}}();u.getGlyphs=function(p){return this._glyphMosaic.getGlyphItems(p.font,p.codePoints)};u._getTilePayload=function(){var p=F._asyncToGenerator(function*(m,h,v){m=b.pool.acquire(m.id);const w=this._layer.sourceNameToSource[h],{level:g,row:r,col:D}=m;b.pool.release(m);try{return{protobuff:yield w.requestTile(g,r,D,v),sourceName:h}}catch(G){if(x.isAbortError(G))throw G;return{protobuff:null,sourceName:h}}});
return function(m,h,v){return p.apply(this,arguments)}}();u._getRefKeys=function(p,m){const h=this._layer.sourceNameToSource,v=[];for(const w in h){const g=h[w].getRefKey(p,m);v.push(g)}return x.eachAlways(v)};u._getSourcesData=function(p,m,h){const v=[];for(let w=0;w<m.length;w++)if(null==m[w].value||null==p[w])v.push(null);else{const g=this._getTilePayload(m[w].value,p[w],h);v.push(g)}return x.eachAlways(v).then(w=>{const g={},r=[];for(let D=0;D<w.length;D++){const G=w[D].value;G&&G.protobuff&&
0<G.protobuff.byteLength&&(g[G.sourceName]={refKey:m[D].value.id,protobuff:G.protobuff},r.push(G.protobuff))}return{sourceName2DataAndRefKey:g,transferList:r}})};F._createClass(l,[{key:"spriteMosaic",get:function(){return this._spriteSourcePromise.then(()=>this._spriteMosaic)}},{key:"glyphMosaic",get:function(){return this._glyphMosaic}}]);return l}();B.TileHandler=c;Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/GlyphMosaic":function(){define(["./RectangleBinPack",
"../webgl/Rect","../../../webgl/enums","../../../webgl/Texture"],function(B,F,x,A){return function(){function f(d,a,b){this.height=this.width=0;this._dirties=[];this._glyphData=[];this._currentPage=0;this._glyphIndex={};this._textures=[];this._rangePromises=new Map;this.width=d;this.height=a;this._glyphSource=b;this._binPack=new B(d-4,a-4);this._glyphData.push(new Uint8Array(d*a));this._dirties.push(!0);this._textures.push(void 0)}var q=f.prototype;q.getGlyphItems=function(d,a){const b=[],c=this._glyphSource,
l=new Set,u=1/256;for(const m of a)l.add(Math.floor(m*u));const p=[];l.forEach(m=>{if(256>=m){const h=d+m;this._rangePromises.has(h)?p.push(this._rangePromises.get(h)):(m=c.getRange(d,m).then(()=>{this._rangePromises["delete"](h)},()=>{this._rangePromises["delete"](h)}),this._rangePromises.set(h,m),p.push(m))}});return Promise.all(p).then(()=>{let m=this._glyphIndex[d];m||(m={},this._glyphIndex[d]=m);for(const r of a){var h=m[r];if(h){b[r]={sdf:!0,rect:h.rect,metrics:h.metrics,page:h.page,code:r};
continue}var v=c.getGlyph(d,r);if(!v||!v.metrics)continue;h=v.metrics;let D;if(0===h.width)D=new F(0,0,0,0);else{const G=h.width+6,z=h.height+6;var w=G%4?4-G%4:4,g=z%4?4-z%4:4;1===w&&(w=5);1===g&&(g=5);D=this._binPack.allocate(G+w,z+g);D.isEmpty&&(this._dirties[this._currentPage]||(this._glyphData[this._currentPage]=null),this._currentPage=this._glyphData.length,this._glyphData.push(new Uint8Array(this.width*this.height)),this._dirties.push(!0),this._textures.push(void 0),this._binPack=new B(this.width-
4,this.height-4),D=this._binPack.allocate(G+w,z+g));w=this._glyphData[this._currentPage];v=v.bitmap;let t;if(v)for(let C=0;C<z;C++){g=G*C;t=this.width*(D.y+C+1)+D.x;for(let M=0;M<G;M++)w[t+M+1]=v[g+M]}}m[r]={rect:D,metrics:h,tileIDs:null,page:this._currentPage};b[r]={sdf:!0,rect:D,metrics:h,page:this._currentPage,code:r};this._dirties[this._currentPage]=!0}return b})};q.removeGlyphs=function(d){for(const a in this._glyphIndex){const b=this._glyphIndex[a];if(!b)continue;let c;for(const l in b)if(c=
b[l],c.tileIDs["delete"](d),0===c.tileIDs.size){const u=this._glyphData[c.page],p=c.rect;let m,h;for(let v=0;v<p.height;v++)for(m=this.width*(p.y+v)+p.x,h=0;h<p.width;h++)u[m+h]=0;delete b[l];this._dirties[c.page]=!0}}};q.bind=function(d,a,b,c=0){this._textures[b]||(this._textures[b]=new A.Texture(d,{pixelFormat:x.PixelFormat.ALPHA,dataType:x.PixelType.UNSIGNED_BYTE,width:this.width,height:this.height},new Uint8Array(this.width*this.height)));const l=this._textures[b];l.setSamplingMode(a);this._dirties[b]&&
l.setData(this._glyphData[b]);d.bindTexture(l,c);this._dirties[b]=!1};q.dispose=function(){this._binPack=null;for(const d of this._textures)d&&d.dispose();this._textures.length=0};return f}()})},"esri/views/2d/engine/vectorTiles/RectangleBinPack":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","../webgl/Rect"],function(B,F){return function(){function x(f,q){this._height=this._width=0;this._free=[];this._width=f;this._height=q;this._free.push(new F(0,0,f,q))}var A=x.prototype;A.allocate=
function(f,q){if(f>this._width||q>this._height)return new F;let d=null,a=-1;for(let b=0;b<this._free.length;++b){const c=this._free[b];f<=c.width&&q<=c.height&&(null===d||c.y<=d.y&&c.x<=d.x)&&(d=c,a=b)}if(null===d)return new F;this._free.splice(a,1);d.width<d.height?(d.width>f&&this._free.push(new F(d.x+f,d.y,d.width-f,q)),d.height>q&&this._free.push(new F(d.x,d.y+q,d.width,d.height-q))):(d.width>f&&this._free.push(new F(d.x+f,d.y,d.width-f,d.height)),d.height>q&&this._free.push(new F(d.x,d.y+q,f,
d.height-q)));return new F(d.x,d.y,f,q)};A.release=function(f){for(let q=0;q<this._free.length;++q){const d=this._free[q];if(d.y===f.y&&d.height===f.height&&d.x+d.width===f.x)d.width+=f.width;else if(d.x===f.x&&d.width===f.width&&d.y+d.height===f.y)d.height+=f.height;else if(f.y===d.y&&f.height===d.height&&f.x+f.width===d.x)d.x=f.x,d.width+=f.width;else if(f.x===d.x&&f.width===d.width&&f.y+f.height===d.y)d.y=f.y,d.height+=f.height;else continue;this._free.splice(q,1);this.release(f)}this._free.push(f)};
B._createClass(x,[{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}}]);return x}()})},"esri/views/2d/engine/vectorTiles/GlyphSource":function(){define(["../../../../request","../../../../core/pbf"],function(B,F){let x=function(){function f(d){this._metrics=[];this._bitmaps=[];if(d)for(;d.next();)switch(d.tag()){case 1:const a=d.getMessage();for(;a.next();)switch(a.tag()){case 3:const b=a.getMessage();let c,l,u,p,m,h,v;for(;b.next();)switch(b.tag()){case 1:c=
b.getUInt32();break;case 2:l=b.getBytes();break;case 3:u=b.getUInt32();break;case 4:p=b.getUInt32();break;case 5:m=b.getSInt32();break;case 6:h=b.getSInt32();break;case 7:v=b.getUInt32();break;default:b.skip()}b.release();c&&(this._metrics[c]={width:u,height:p,left:m,top:h,advance:v},this._bitmaps[c]=l);break;default:a.skip()}a.release();break;default:d.skip()}}var q=f.prototype;q.getMetrics=function(d){return this._metrics[d]};q.getBitmap=function(d){return this._bitmaps[d]};return f}(),A=function(){function f(){this._ranges=
[]}var q=f.prototype;q.getRange=function(d){return this._ranges[d]};q.addRange=function(d,a){this._ranges[d]=a};return f}();return function(){function f(d){this._glyphInfo={};this._baseURL=d}var q=f.prototype;q.getRange=function(d,a){const b=this._getFontStack(d);if(b.getRange(a))return Promise.resolve();const c=256*a,l=c+255;if(this._baseURL)return d=this._baseURL.replace("{fontstack}",d).replace("{range}",c+"-"+l),B(d,{responseType:"array-buffer"}).then(u=>{b.addRange(a,new x(new F(new Uint8Array(u.data),
new DataView(u.data))))}).catch(()=>{b.addRange(a,new x)});b.addRange(a,new x);return Promise.resolve()};q.getGlyph=function(d,a){if(d=this._getFontStack(d)){var b=Math.floor(a/256);if(!(256<b)&&(d=d.getRange(b)))return{metrics:d.getMetrics(a),bitmap:d.getBitmap(a)}}};q._getFontStack=function(d){let a=this._glyphInfo[d];a||(a=this._glyphInfo[d]=new A);return a};return f}()})},"esri/views/2d/engine/vectorTiles/SpriteMosaic":function(){define(["../../../../symbols/cim/rasterizingUtils","./RectangleBinPack",
"../webgl/Rect","../../../webgl/enums","../../../webgl/Texture"],function(B,F,x,A,f){return function(){function q(a,b,c=0){this._size=[];this._mosaicsData=[];this._textures=[];this._dirties=[];this._pageHeight=this._pageWidth=this._currentPage=this._maxItemSize=0;this._mosaicRects={};this.pixelRatio=1;(0>=a||0>=b)&&console.error("Sprites mosaic defaultWidth and defaultHeight must be greater than zero!");this._pageWidth=a;this._pageHeight=b;0<c&&(this._maxItemSize=c);this._binPack=new F(a-4,b-4)}var d=
q.prototype;d.dispose=function(){this._binPack=null;this._mosaicRects={};for(const a of this._textures)a&&a.dispose();this._textures.length=0};d.getWidth=function(a){return a>=this._size.length?-1:this._size[a][0]};d.getHeight=function(a){return a>=this._size.length?-1:this._size[a][1]};d.getPageSize=function(a){return a>=this._size.length?null:this._size[a]};d.setSpriteSource=function(a){this.dispose();this.pixelRatio=a.devicePixelRatio;if(0===this._mosaicsData.length){this._binPack=new F(this._pageWidth-
4,this._pageHeight-4);const b=new Uint32Array(Math.floor(this._pageWidth)*Math.floor(this._pageHeight));this._mosaicsData[0]=b;this._dirties.push(!0);this._size.push([this._pageWidth,this._pageHeight]);this._textures.push(void 0)}this._sprites=a};d.getSpriteItem=function(a,b=!1){var c=this._mosaicRects[a];if(c)return c;if(!this._sprites||"loaded"!==this._sprites.loadStatus)return null;let l;a&&a.startsWith("dasharray-")?([c,l]=this._rasterizeDash(a),b=!0):c=this._sprites.getSpriteInfo(a);if(!c||!c.width||
!c.height||0>c.width||0>c.height)return null;const u=c.width,p=c.height,[m,h,v]=this._allocateImage(u,p);if(0>=m.width)return null;this._copy(m,c,h,v,b,l);c={rect:m,width:u,height:p,sdf:c.sdf,simplePattern:!1,pixelRatio:c.pixelRatio,page:h};return this._mosaicRects[a]=c};d.getSpriteItems=function(a){const b={};for(const c of a)b[c.name]=this.getSpriteItem(c.name,c.repeat);return b};d.getMosaicItemPosition=function(a,b){b=(a=this.getSpriteItem(a,b))&&a.rect;if(!b)return null;b.width=a.width;b.height=
a.height;return{tl:[b.x+2,b.y+2],br:[b.x+2+a.width,b.y+2+a.height],page:a.page}};d.bind=function(a,b,c=0,l=0){if(!(c>=this._size.length||c>=this._mosaicsData.length)){this._textures[c]||(this._textures[c]=new f.Texture(a,{pixelFormat:A.PixelFormat.RGBA,dataType:A.PixelType.UNSIGNED_BYTE,wrapMode:A.TextureWrapMode.CLAMP_TO_EDGE,width:this._size[c][0],height:this._size[c][1]},new Uint8Array(this._mosaicsData[c].buffer)));var u=this._textures[c];u.setSamplingMode(b);this._dirties[c]&&u.setData(new Uint8Array(this._mosaicsData[c].buffer));
a.bindTexture(u,l);this._dirties[c]=!1}};q._copyBits=function(a,b,c,l,u,p,m,h,v,w,g){let r=l*b+c;m=h*p+m;if(g)for(m-=p,g=-1;g<=w;g++,r=((g+w)%w+l)*b+c,m+=p)for(h=-1;h<=v;h++)u[m+h]=a[r+(h+v)%v];else for(c=0;c<w;c++){for(l=0;l<v;l++)u[m+l]=a[r+l];r+=b;m+=p}};d._copy=function(a,b,c,l,u,p){if(this._sprites&&"loaded"===this._sprites.loadStatus&&!(c>=this._mosaicsData.length)){var m=new Uint32Array(p?p.buffer:this._sprites.image.buffer),h=this._mosaicsData[c];h&&m||console.error("Source or target images are uninitialized!");
q._copyBits(m,p?b.width:this._sprites.width,b.x,b.y,h,l[0],a.x+2,a.y+2,b.width,b.height,u);this._dirties[c]=!0}};d._allocateImage=function(a,b){a+=2;b+=2;var c=Math.max(a,b);if(this._maxItemSize&&this._maxItemSize<c)return c=new x(0,0,a,b),this._mosaicsData.push(new Uint32Array(a*b)),this._dirties.push(!0),this._size.push([a,b]),this._textures.push(void 0),[c,this._mosaicsData.length-1,[a,b]];c=a%4?4-a%4:4;let l=b%4?4-b%4:4;1===c&&(c=5);1===l&&(l=5);c=this._binPack.allocate(a+c,b+l);return 0>=c.width?
(this._dirties[this._currentPage]||(this._mosaicsData[this._currentPage]=null),this._currentPage=this._mosaicsData.length,this._mosaicsData.push(new Uint32Array(this._pageWidth*this._pageHeight)),this._dirties.push(!0),this._size.push([this._pageWidth,this._pageHeight]),this._textures.push(void 0),this._binPack=new F(this._pageWidth-4,this._pageHeight-4),this._allocateImage(a,b)):[c,this._currentPage,[this._pageWidth,this._pageHeight]]};d._rasterizeDash=function(a){var b=a.match(/\[(.*?)\]/);if(!b)return null;
b=b[1].split(",").map(Number);a=a.slice(a.lastIndexOf("-")+1);const [c,l,u]=B.rasterizeDash(b,a);a=new Uint8Array(c.buffer);return[{x:0,y:0,width:l,height:u,sdf:!0,pixelRatio:1},a]};return q}()})},"esri/views/2d/engine/vectorTiles/TileManager":function(){define(["exports","../../../../core/LRUCache","../../../../core/maybe","../../tiling/TileCoverage","../../tiling/TileKey"],function(B,F,x,A,f){const q=(a,b)=>a+1/(1<<2*b);let d=function(){function a(c,l){this._tiles=new Map;this._tileCache=new F(40,
u=>u.dispose());this._viewSize=[0,0];this._visibleTiles=new Map;this.acquireTile=c.acquireTile;this.releaseTile=c.releaseTile;this.tileInfoView=c.tileInfoView;this._container=l}var b=a.prototype;b.destroy=function(){for(const [,c]of this._tiles)c.dispose();this._tiles=null;this._tileCache.clear();this._tileCache=null};b.update=function(c){this._updateCacheSize(c);const l=this.tileInfoView;c=l.getTileCoverage(c.state,0,"smallest");const {spans:u,lodInfo:p}=c,{level:m}=p,h=this._tiles,v=new Set,w=new Set;
for(const {row:r,colFrom:D,colTo:G}of u)for(let z=D;z<=G;z++){const t=f.getId(m,r,p.normalizeCol(z),p.getWorldForColumn(z)),C=this._getOrAcquireTile(t);v.add(t);C.processed()?this._addToContainer(C):w.add(new f(t))}for(const [r,D]of h)D.isCoverage=v.has(r);for(var g of w)this._findPlaceholdersForMissingTiles(g,v);g=!1;for(const [r,D]of h)D.neededForCoverage=v.has(r),D.neededForCoverage||D.isHoldingForFade&&l.intersects(c,D.key)&&v.add(r),D.isFading&&(g=!0);for(const [r]of this._tiles)v.has(r)||this._releaseTile(r);
A.pool.release(c);return!g};b.clear=function(){this._tiles.clear();this._tileCache.clear();this._visibleTiles.clear()};b.clearCache=function(){this._tileCache.clear()};b._findPlaceholdersForMissingTiles=function(c,l){var u=[];for(const [,p]of this._tiles)this._addPlaceholderChild(u,p,c,l);u=u.reduce(q,0);1E-6>Math.abs(1-u)||this._addPlaceholderParent(c.id,l)};b._addPlaceholderChild=function(c,l,u,p){if(!(l.key.level<=u.level)&&l.hasData()){var m=l.key,h=m.level-u.level;u.row===m.row>>h&&u.col===m.col>>
h&&u.world===m.world&&(this._addToContainer(l),p.add(l.id),c.push(l.key.level-u.level))}};b._addPlaceholderParent=function(c,l){const u=this._tiles;for(;;){{const [m,h,v,w]=c.split("/");c=parseInt(m,10);c=0===c?null:`${c-1}/${parseInt(h,10)>>1}/${parseInt(v,10)>>1}/${parseInt(w,10)}`}if(!c||l.has(c))break;const p=u.get(c);if(p&&p.hasData()){this._addToContainer(p);l.add(p.id);break}}};b._getOrAcquireTile=function(c){let l=this._tiles.get(c);if(l)return l;(l=this._tileCache.pop(c))||(l=this.acquireTile(new f(c)));
this._tiles.set(c,l);return l};b._releaseTile=function(c){const l=this._tiles.get(c);this.releaseTile(l);this._removeFromContainer(l);this._tiles.delete(c);l.hasData()?this._tileCache.put(c,l,1):l.dispose()};b._addToContainer=function(c){let l;const u=[],p=this._container;if(!p.contains(c)){var m=this._visibleTiles;for(const [,h]of m)this._canConnectDirectly(c,h)&&u.push(h),x.isNone(l)&&this._canConnectDirectly(h,c)&&(l=h);if(x.isSome(l)){for(const h of u)l.childrenTiles.delete(h),c.childrenTiles.add(h),
h.parentTile=c;l.childrenTiles.add(c);c.parentTile=l}else for(const h of u)c.childrenTiles.add(h),h.parentTile=c;m.set(c.id,c);p.addChild(c)}};b._removeFromContainer=function(c){this._visibleTiles.delete(c.id);this._container.removeChild(c);if(x.isSome(c.parentTile)){c.parentTile.childrenTiles.delete(c);for(const l of c.childrenTiles)x.isSome(c.parentTile)&&c.parentTile.childrenTiles.add(l)}for(const l of c.childrenTiles)l.parentTile=c.parentTile;c.parentTile=null;c.childrenTiles.clear()};b._canConnectDirectly=
function(c,l){c=c.key;let {level:u,row:p,col:m,world:h}=l.key;for(l=this._visibleTiles;0<u;){u--;p>>=1;m>>=1;if(c.level===u&&c.row===p&&c.col===m&&c.world===h)return!0;if(l.has(`${u}/${p}/${m}/${h}`))break}return!1};b._updateCacheSize=function(c){c=c.state.size;if(c[0]!==this._viewSize[0]||c[1]!==this._viewSize[1]){var l=Math.ceil(c[0]/512)+1,u=Math.ceil(c[1]/512)+1;this._viewSize[0]=c[0];this._viewSize[1]=c[1];this._tileCache.maxSize=5*l*u}};return a}();B.TileManager=d;Object.defineProperty(B,Symbol.toStringTag,
{value:"Module"})})},"esri/views/2d/engine/vectorTiles/VectorTile":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../chunks/mat3 ../../../../chunks/mat3f32 ./enums ./RenderBucket ./decluttering/config ../webgl/TiledDisplayObject".split(" "),function(B,F,x,A,f,q,d,a,b){b=function(l){function u(m,h,v,w,g,r,D,G=null){h=l.call(this,m,h,v,w,g,r,4096,4096)||this;h._memCache=G;h.type="vector-tile";h._referenced=0;h._hasSymbolBuckets=!1;h._memoryUsedByLayerData=
0;h.layerData=new Map;h.layerCount=0;h.status="loading";h.allSymbolsFadingOut=!1;h.lastOpacityUpdate=0;h.symbols=new Map;h.isCoverage=!1;h.neededForCoverage=!1;h.decluttered=!1;h.invalidating=!1;h.parentTile=null;h.childrenTiles=new Set;h._processed=!1;h._referenced=1;h.styleRepository=D;h.id=m.id;return h}F._inheritsLoose(u,l);var p=u.prototype;p.setData=function(m){this.changeDataImpl(m);this.requestRender();this.ready();this.invalidating=!1;this._processed=!0};p.deleteLayerData=function(m){let h=
!1;for(const v of m)this.layerData.has(v)&&(m=this.layerData.get(v),this._memoryUsedByLayerData-=m.memoryUsed,m.type===q.BucketType.SYMBOL&&this.symbols.has(v)&&(this.symbols.delete(v),h=!0),m.destroy(),this.layerData.delete(v),this.layerCount--);x.isSome(this._memCache)&&this._memCache.updateSize(this.key.id,this,this._memoryUsedByLayerData);h&&this.emit("symbols-changed");this.requestRender()};p.processed=function(){return this._processed};p.hasData=function(){return 0<this.layerCount};p.dispose=
function(){"unloaded"!==this.status&&(c.delete(this),u._destroyRenderBuckets(this.layerData),this.layerData=null,this._memoryUsedByLayerData=this.layerCount=0,this.destroy(),this.status="unloaded")};p.release=function(){return 0===--this._referenced?(this.dispose(),this.stage=null,!0):!1};p.retain=function(){++this._referenced};p.changeDataImpl=function(m){let h=!1;if(m){const {bucketsWithData:v,emptyBuckets:w}=m;m=this._createRenderBuckets(v);if(w&&0<w.byteLength){const g=new Uint32Array(w);for(const r of g)this._deleteLayerData(r)}for(const [g,
r]of m)this._deleteLayerData(g),r.type===q.BucketType.SYMBOL&&(this.symbols.set(g,r.symbols),h=!0),this._memoryUsedByLayerData+=r.memoryUsed,this.layerData.set(g,r),this.layerCount++;x.isSome(this._memCache)&&this._memCache.updateSize(this.key.id,this,this._memoryUsedByLayerData)}this._hasSymbolBuckets=!1;for(const [,v]of this.layerData)v.type===q.BucketType.SYMBOL&&(this._hasSymbolBuckets=!0);h&&this.emit("symbols-changed")};p.attachWithContext=function(m){this.stage={context:m,trashDisplayObject(h){h.processDetach()},
untrashDisplayObject(){return!1}}};p.setTransform=function(m){l.prototype.setTransform.call(this,m);var h=this.resolution/(m.resolution*m.pixelRatio);const v=this.width/this.rangeX*h;h*=this.height/this.rangeY;const w=[0,0];m.toScreen(w,[this.x,this.y]);const g=this.transforms.tileUnitsToPixels;A.identity(g);A.translate(g,g,w);A.rotate(g,g,Math.PI*m.rotation/180);A.scale(g,g,[v,h,1])};p._createTransforms=function(){return{dvs:f.create(),tileMat3:f.create(),tileUnitsToPixels:f.create()}};u._destroyRenderBuckets=
function(m){if(m){var h=new Set;m.forEach(v=>{h.has(v)||(v.destroy(),h.add(v))});m.clear()}};p._createRenderBuckets=function(m){const h=new Map,v=new Map;for(const w of m){m=this._deserializeBucket(w,v);for(const g of m.layerUIDs)h.set(g,m)}return h};p._deserializeBucket=function(m,h){let v=h.get(m);if(v)return v;switch((new Uint32Array(m))[0]){case q.BucketType.FILL:v=new d.FillRenderBucket(m,this.styleRepository);break;case q.BucketType.LINE:v=new d.LineRenderBucket(m,this.styleRepository);break;
case q.BucketType.SYMBOL:v=new d.SymbolRenderBucket(m,this.styleRepository,this);break;case q.BucketType.CIRCLE:v=new d.CircleRenderBucket(m,this.styleRepository)}h.set(m,v);return v};p._deleteLayerData=function(m){if(this.layerData.has(m)){var h=this.layerData.get(m);this._memoryUsedByLayerData-=h.memoryUsed;h.destroy();this.layerData.delete(m);this.layerCount--}};F._createClass(u,[{key:"hasSymbolBuckets",get:function(){return this._hasSymbolBuckets}},{key:"isFading",get:function(){return this._hasSymbolBuckets&&
performance.now()-this.lastOpacityUpdate<a.FADE_DURATION}},{key:"isHoldingForFade",get:function(){return this._hasSymbolBuckets&&(!this.allSymbolsFadingOut||performance.now()-this.lastOpacityUpdate<a.FADE_DURATION)}},{key:"wasRequested",get:function(){return"errored"===this.status||"loaded"===this.status||"reloading"===this.status}},{key:"referenced",get:function(){return this._referenced}},{key:"memoryUsage",get:function(){return(this._memoryUsedByLayerData+256)/(this._referenced||1)}}]);return u}(b.TiledDisplayObject);
const c=new Map;B.VectorTile=b;B.printAllocations=function(){c.forEach((l,u)=>{console.log(`\n${u.key}:`);l[0].forEach(p=>console.log(p));console.log("\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d");l[1].forEach(p=>console.log(p))})};Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/RenderBucket":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ./enums ./decluttering/util ../../../webgl/BufferObject ../../../webgl/enums ../../../webgl/VertexArrayObject".split(" "),
function(B,F,x,A,f,q,d,a){let b=function(){function m(v,w){this.layerUIDs=[];this.isDestroyed=!1;this._data=v;this.memoryUsed=v.byteLength;let g=1;v=new Uint32Array(v);this.layerUIDs=[];const r=v[g++];for(let D=0;D<r;D++)this.layerUIDs[D]=v[g++];this.bufferDataOffset=g;w&&(this.layer=w.getStyleLayerByUID(this.layerUIDs[0]))}var h=m.prototype;h.destroy=function(){this.isDestroyed||(this.doDestroy(),this.isDestroyed=!0)};h.prepareForRendering=function(v){x.isNone(this._data)||(this.doPrepareForRendering(v,
this._data,this.bufferDataOffset),this._data=null)};F._createClass(m,[{key:"isPreparedForRendering",get:function(){return x.isNone(this._data)}},{key:"offset",get:function(){return this.bufferDataOffset}}]);return m}(),c=function(m){function h(w,g){g=m.call(this,w,g)||this;g.type=A.BucketType.LINE;g.lineIndexStart=0;g.lineIndexCount=0;w=new Uint32Array(w);let r=g.bufferDataOffset;g.lineIndexStart=w[r++];g.lineIndexCount=w[r++];const D=w[r++];if(0<D){const G=new Map;for(let z=0;z<D;z++){const t=w[r++],
C=w[r++],M=w[r++];G.set(t,[C,M])}g.patternMap=G}g.bufferDataOffset=r;return g}F._inheritsLoose(h,m);var v=h.prototype;v.hasData=function(){return 0<this.lineIndexCount};v.triangleCount=function(){return this.lineIndexCount/3};v.doDestroy=function(){x.isSome(this.lineVertexArrayObject)&&this.lineVertexArrayObject.dispose();x.isSome(this.lineVertexBuffer)&&this.lineVertexBuffer.dispose();x.isSome(this.lineIndexBuffer)&&this.lineIndexBuffer.dispose();this.lineIndexBuffer=this.lineVertexBuffer=this.lineVertexArrayObject=
null;this.memoryUsed=0};v.doPrepareForRendering=function(w,g,r){g=new Uint32Array(g);var D=new Int32Array(g.buffer);const G=g[r++];this.lineVertexBuffer=q.BufferObject.createVertex(w,d.Usage.STATIC_DRAW,new Int32Array(D.buffer,4*r,G));r+=G;D=g[r++];this.lineIndexBuffer=q.BufferObject.createIndex(w,d.Usage.STATIC_DRAW,new Uint32Array(g.buffer,4*r,D));r+=D;r=this.layer.lineMaterial;this.lineVertexArrayObject=new a.VertexArrayObject(w,r.getAttributeLocations(),r.getLayoutInfo(),{geometry:this.lineVertexBuffer},
this.lineIndexBuffer)};return h}(b),l=function(m){function h(w,g){g=m.call(this,w,g)||this;g.type=A.BucketType.FILL;g.fillIndexStart=0;g.fillIndexCount=0;g.outlineIndexStart=0;g.outlineIndexCount=0;w=new Uint32Array(w);let r=g.bufferDataOffset;g.fillIndexStart=w[r++];g.fillIndexCount=w[r++];g.outlineIndexStart=w[r++];g.outlineIndexCount=w[r++];const D=w[r++];if(0<D){const G=new Map;for(let z=0;z<D;z++){const t=w[r++],C=w[r++],M=w[r++];G.set(t,[C,M])}g.patternMap=G}g.bufferDataOffset=r;return g}F._inheritsLoose(h,
m);var v=h.prototype;v.hasData=function(){return 0<this.fillIndexCount||0<this.outlineIndexCount};v.triangleCount=function(){return(this.fillIndexCount+this.outlineIndexCount)/3};v.doDestroy=function(){x.isSome(this.fillVertexArrayObject)&&this.fillVertexArrayObject.dispose();x.isSome(this.fillVertexBuffer)&&this.fillVertexBuffer.dispose();x.isSome(this.fillIndexBuffer)&&this.fillIndexBuffer.dispose();this.fillIndexBuffer=this.fillVertexBuffer=this.fillVertexArrayObject=null;x.isSome(this.outlineVertexArrayObject)&&
this.outlineVertexArrayObject.dispose();x.isSome(this.outlineVertexBuffer)&&this.outlineVertexBuffer.dispose();x.isSome(this.outlineIndexBuffer)&&this.outlineIndexBuffer.dispose();this.outlineIndexBuffer=this.outlineVertexBuffer=this.outlineVertexArrayObject=null;this.memoryUsed=0};v.doPrepareForRendering=function(w,g,r){g=new Uint32Array(g);var D=new Int32Array(g.buffer),G=g[r++];this.fillVertexBuffer=q.BufferObject.createVertex(w,d.Usage.STATIC_DRAW,new Int32Array(D.buffer,4*r,G));r+=G;G=g[r++];
this.fillIndexBuffer=q.BufferObject.createIndex(w,d.Usage.STATIC_DRAW,new Uint32Array(g.buffer,4*r,G));r+=G;G=g[r++];this.outlineVertexBuffer=q.BufferObject.createVertex(w,d.Usage.STATIC_DRAW,new Int32Array(D.buffer,4*r,G));r+=G;D=g[r++];this.outlineIndexBuffer=q.BufferObject.createIndex(w,d.Usage.STATIC_DRAW,new Uint32Array(g.buffer,4*r,D));r+=D;g=this.layer;r=g.fillMaterial;g=g.outlineMaterial;this.fillVertexArrayObject=new a.VertexArrayObject(w,r.getAttributeLocations(),r.getLayoutInfo(),{geometry:this.fillVertexBuffer},
this.fillIndexBuffer);this.outlineVertexArrayObject=new a.VertexArrayObject(w,g.getAttributeLocations(),g.getLayoutInfo(),{geometry:this.outlineVertexBuffer},this.outlineIndexBuffer)};return h}(b),u=function(m){function h(w,g,r){g=m.call(this,w,g)||this;g.type=A.BucketType.SYMBOL;g.iconPerPageElementsMap=new Map;g.glyphPerPageElementsMap=new Map;g.symbolInstances=[];g.isIconSDF=!1;g.opacityChanged=!1;g.lastOpacityUpdate=0;g.symbols=[];const D=new Uint32Array(w),G=new Int32Array(w);w=new Float32Array(w);
let z=g.bufferDataOffset;g.isIconSDF=!!D[z++];var t=D[z++];for(var C=0;C<t;C++){var M=D[z++],O=D[z++],X=D[z++];g.iconPerPageElementsMap.set(M,[O,X])}t=D[z++];for(C=0;C<t;C++)M=D[z++],O=D[z++],X=D[z++],g.glyphPerPageElementsMap.set(M,[O,X]);t=D[z++];C=D[z++];g.iconOpacity=new Int32Array(t);g.textOpacity=new Int32Array(C);z=f.deserializeSymbols(D,G,w,z,g.symbols,r);g.bufferDataOffset=z;return g}F._inheritsLoose(h,m);var v=h.prototype;v.hasData=function(){return 0<this.iconPerPageElementsMap.size||0<
this.glyphPerPageElementsMap.size};v.triangleCount=function(){let w=0;for(const [,g]of this.iconPerPageElementsMap)w+=g[1];for(const [,g]of this.glyphPerPageElementsMap)w+=g[1];return w/3};v.doDestroy=function(){x.isSome(this.iconVertexArrayObject)&&this.iconVertexArrayObject.dispose();x.isSome(this.iconVertexBuffer)&&this.iconVertexBuffer.dispose();x.isSome(this.iconOpacityBuffer)&&this.iconOpacityBuffer.dispose();x.isSome(this.iconIndexBuffer)&&this.iconIndexBuffer.dispose();this.iconIndexBuffer=
this.iconOpacityBuffer=this.iconVertexBuffer=this.iconVertexArrayObject=null;x.isSome(this.textVertexArrayObject)&&this.textVertexArrayObject.dispose();x.isSome(this.textVertexBuffer)&&this.textVertexBuffer.dispose();x.isSome(this.textOpacityBuffer)&&this.textOpacityBuffer.dispose();x.isSome(this.textIndexBuffer)&&this.textIndexBuffer.dispose();this.textIndexBuffer=this.textOpacityBuffer=this.textVertexBuffer=this.textVertexArrayObject=null;this.memoryUsed=0};v.updateOpacityInfo=function(){if(this.opacityChanged){this.opacityChanged=
!1;var w=x.unwrap(this.iconOpacity),g=x.unwrap(this.iconOpacityBuffer);0<w.length&&w.byteLength===g.size&&g.setSubData(w,0,0,w.length);w=x.unwrap(this.textOpacity);g=x.unwrap(this.textOpacityBuffer);0<w.length&&w.byteLength===g.size&&g.setSubData(w,0,0,w.length)}};v.doPrepareForRendering=function(w,g,r){g=new Uint32Array(g);var D=new Int32Array(g.buffer),G=g[r++];this.iconVertexBuffer=q.BufferObject.createVertex(w,d.Usage.STATIC_DRAW,new Int32Array(D.buffer,4*r,G));r+=G;G=g[r++];this.iconIndexBuffer=
q.BufferObject.createIndex(w,d.Usage.STATIC_DRAW,new Uint32Array(g.buffer,4*r,G));r+=G;G=g[r++];this.textVertexBuffer=q.BufferObject.createVertex(w,d.Usage.STATIC_DRAW,new Int32Array(D.buffer,4*r,G));r+=G;D=g[r++];this.textIndexBuffer=q.BufferObject.createIndex(w,d.Usage.STATIC_DRAW,new Uint32Array(g.buffer,4*r,D));r+=D;this.iconOpacityBuffer=q.BufferObject.createVertex(w,d.Usage.STATIC_DRAW,x.unwrap(this.iconOpacity).buffer);this.textOpacityBuffer=q.BufferObject.createVertex(w,d.Usage.STATIC_DRAW,
x.unwrap(this.textOpacity).buffer);g=this.layer;r=g.iconMaterial;g=g.textMaterial;this.iconVertexArrayObject=new a.VertexArrayObject(w,r.getAttributeLocations(),r.getLayoutInfo(),{geometry:this.iconVertexBuffer,opacity:this.iconOpacityBuffer},this.iconIndexBuffer);this.textVertexArrayObject=new a.VertexArrayObject(w,g.getAttributeLocations(),g.getLayoutInfo(),{geometry:this.textVertexBuffer,opacity:this.textOpacityBuffer},this.textIndexBuffer)};return h}(b),p=function(m){function h(w,g){g=m.call(this,
w,g)||this;g.type=A.BucketType.CIRCLE;g.circleIndexStart=0;g.circleIndexCount=0;w=new Uint32Array(w);let r=g.bufferDataOffset;g.circleIndexStart=w[r++];g.circleIndexCount=w[r++];g.bufferDataOffset=r;return g}F._inheritsLoose(h,m);var v=h.prototype;v.hasData=function(){return 0<this.circleIndexCount};v.triangleCount=function(){return this.circleIndexCount/3};v.doDestroy=function(){x.isSome(this.circleVertexArrayObject)&&this.circleVertexArrayObject.dispose();x.isSome(this.circleVertexBuffer)&&this.circleVertexBuffer.dispose();
x.isSome(this.circleIndexBuffer)&&this.circleIndexBuffer.dispose();this.circleIndexBuffer=this.circleVertexBuffer=this.circleVertexArrayObject=null;this.memoryUsed=0};v.doPrepareForRendering=function(w,g,r){g=new Uint32Array(g);var D=new Int32Array(g.buffer);const G=g[r++];this.circleVertexBuffer=q.BufferObject.createVertex(w,d.Usage.STATIC_DRAW,new Int32Array(D.buffer,4*r,G));r+=G;D=g[r++];this.circleIndexBuffer=q.BufferObject.createIndex(w,d.Usage.STATIC_DRAW,new Uint32Array(g.buffer,4*r,D));r+=
D;r=this.layer.circleMaterial;this.circleVertexArrayObject=new a.VertexArrayObject(w,r.getAttributeLocations(),r.getLayoutInfo(),{geometry:this.circleVertexBuffer},this.circleIndexBuffer)};return h}(b);B.CircleRenderBucket=p;B.FillRenderBucket=l;B.LineRenderBucket=c;B.RenderBucketBase=b;B.SymbolRenderBucket=u;Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/decluttering/util":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers",
"../enums","./core"],function(B,F,x,A){let f=function(){function q(a,b,c){this._rows=Math.ceil(b/c);this._columns=Math.ceil(a/c);this._cellSize=c;this.cells=Array(this._rows);for(a=0;a<this._rows;a++)for(this.cells[a]=Array(this._columns),b=0;b<this._columns;b++)this.cells[a][b]=[]}var d=q.prototype;d.getCell=function(a,b){b=Math.min(Math.max(Math.floor(b/this._cellSize),0),this._rows-1);a=Math.min(Math.max(Math.floor(a/this._cellSize),0),this._columns-1);return this.cells[b]&&this.cells[b][a]||null};
d.getCellSpan=function(a,b,c,l){return[Math.min(Math.max(Math.floor(a/this._cellSize),0),this.columns-1),Math.min(Math.max(Math.floor(b/this._cellSize),0),this.rows-1),Math.min(Math.max(Math.floor(c/this._cellSize),0),this.columns-1),Math.min(Math.max(Math.floor(l/this._cellSize),0),this.rows-1)]};F._createClass(q,[{key:"cellSize",get:function(){return this._cellSize}},{key:"columns",get:function(){return this._columns}},{key:"rows",get:function(){return this._rows}}]);return q}();B.GridIndex=f;B.deserializeSymbols=
function(q,d,a,b,c,l){const u=d[b++];for(let h=0;h<u;h++){const v=new A.VTLSymbol(l);v.xTile=d[b++];v.yTile=d[b++];v.hash=d[b++];v.priority=d[b++];var p=d[b++];for(var m=0;m<p;m++){const w=d[b++],g=d[b++],r=d[b++],D=d[b++],G=!!d[b++],z=d[b++],t=a[b++],C=a[b++],M=d[b++],O=d[b++];v.colliders.push({xTile:w,yTile:g,dxPixels:r,dyPixels:D,hard:G,partIndex:z,width:M,height:O,minLod:t,maxLod:C})}p=q[b++];for(m=0;m<p;m++)v.textVertexRanges.push([q[b++],q[b++]]);p=q[b++];for(m=0;m<p;m++)v.iconVertexRanges.push([q[b++],
q[b++]]);c.push(v)}return b};B.tileCoordChange=function(q,d,a,b,c,l){a-=c;if(0<=a)return(d>>a)+(b-(l<<a))*(q>>a);a=-a;return d-(l-(b<<a))*(q>>a)<<a};B.writeOpacityToBuffers=function(q,d,a){for(const [h,v]of q.symbols){{var b=q,c=d,l=a,u=v;const w=b.layerData.get(h);if(w.type===x.BucketType.SYMBOL){for(const g of u){u=g.unique;var p=void 0;if(g.selectedForRendering){var m=u.parts[0];p=m.startOpacity;m=m.targetOpacity;b.allSymbolsFadingOut=b.allSymbolsFadingOut&&0===m;p=l?Math.floor(127*p)|m<<7:m?255:
0;p|=p<<24|p<<16|p<<8}else p=0;for(const [r,D]of g.iconVertexRanges)for(m=r;m<r+D;m+=4)w.iconOpacity[m/4]=p;g.selectedForRendering?(p=u.parts[1],u=p.startOpacity,p=p.targetOpacity,b.allSymbolsFadingOut=b.allSymbolsFadingOut&&0===p,u=l?Math.floor(127*u)|p<<7:p?255:0,p=u<<24|u<<16|u<<8|u):p=0;for(const [r,D]of g.textVertexRanges)for(u=r;u<r+D;u+=4)w.textOpacity[u/4]=p}w.lastOpacityUpdate=c;w.opacityChanged=!0}}}};Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/decluttering/core":function(){define(["exports"],
function(B){B.VTLSymbol=function(F){this.hash=this.yTile=this.xTile=0;this.priority=1;this.colliders=[];this.textVertexRanges=[];this.iconVertexRanges=[];this.tile=F};B.VTLUniqueSymbol=function(){this.tileSymbols=[];this.parts=[{startTime:0,startOpacity:0,targetOpacity:0,show:!1},{startTime:0,startOpacity:0,targetOpacity:0,show:!1}];this.show=!1};Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/VectorTileContainer":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/promiseUtils ../../../../geometry/support/aaBoundingRect ./decluttering/SymbolFader ./style/StyleDefinition ../webgl/enums ../webgl/RenderableTile ../webgl/TileContainer ../../tiling/TileCoverage ../../tiling/TileKey ../../../webgl/enums".split(" "),
function(B,F,x,A,f,q,d,a,b,c,l,u,p){function m(h,v){if(h){const w=h.getLayoutProperty("visibility");if(!w||w.getValue()!==d.Visibility.NONE&&(void 0===h.minzoom||h.minzoom<v+1E-6)&&(void 0===h.maxzoom||h.maxzoom>=v-1E-6))return!0}return!1}c=function(h){function v(g){g=h.call(this,g)||this;g._backgroundTiles=[];g._pointToCallbacks=new Map;return g}F._inheritsLoose(v,h);var w=v.prototype;w.destroy=function(){this.removeAllChildren();this._spriteMosaic?.dispose();this._spriteMosaic=null;this._glyphMosaic?.dispose();
this._glyphMosaic=null;x.isSome(this._symbolFader)&&(this._symbolFader.clear(),this._symbolFader=null);this._styleRepository=null;this._backgroundTiles=[];this._pointToCallbacks.clear()};w.setStyleResources=function(g,r,D){this._spriteMosaic=g;this._glyphMosaic=r;this._styleRepository=D;x.isNone(this._symbolFader)&&(g=new q.SymbolFader(this._styleRepository,this.children),g.on("fade-start",()=>{this.emit("fade-start");this.requestRender()}),g.on("fade-complete",()=>{this.emit("fade-complete");this.requestRender()}),
this._symbolFader=g);x.unwrap(this._symbolFader).styleRepository=D};w.setSpriteMosaic=function(g){this._spriteMosaic?.dispose();this._spriteMosaic=g};w.deleteStyleLayers=function(g){x.isSome(this._symbolFader)&&this._symbolFader.deleteStyleLayers(g)};w.hitTest=function(){var g=F._asyncToGenerator(function*(r){const D=A.createResolver();this._pointToCallbacks.set(r,D);this.requestRender();return D.promise});return function(r){return g.apply(this,arguments)}}();w.enterTileInvalidation=function(){for(const g of this.children)g.invalidating=
!0};w.createRenderParams=function(g){return{...h.prototype.createRenderParams.call(this,g),renderPass:null,styleLayer:null,styleLayerUID:-1,glyphMosaic:this._glyphMosaic,spriteMosaic:this._spriteMosaic,hasClipping:!!this._clippingInfos}};w.doRender=function(g){!this.visible||g.drawPhase!==a.WGLDrawPhase.MAP&&g.drawPhase!==a.WGLDrawPhase.DEBUG||void 0===this._spriteMosaic||h.prototype.doRender.call(this,g)};w.addChild=function(g){h.prototype.addChild.call(this,g);x.isSome(this._symbolFader)?this._symbolFader.addTile(g):
g.decluttered=!0;this.requestRender();return g};w.removeChild=function(g){x.isSome(this._symbolFader)&&this._symbolFader.removeTile(g);this.requestRender();return h.prototype.removeChild.call(this,g)};w.renderChildren=function(g){const {drawPhase:r}=g;if(r===a.WGLDrawPhase.DEBUG)h.prototype.renderChildren.call(this,g);else if(this._doRender(g),0<this._pointToCallbacks.size){g.drawPhase=a.WGLDrawPhase.HITTEST;const D=g.painter.effects.hittestVTL;D.bind(g);this._doRender(g);D.draw(g,this._pointToCallbacks);
D.unbind(g);g.drawPhase=r}};w.removeAllChildren=function(){for(let g=0;g<this.children.length;g++){const r=this.children[g];x.isSome(this._symbolFader)&&this._symbolFader.removeTile(r);r.dispose()}h.prototype.removeAllChildren.call(this)};w.getStencilTarget=function(){return this.children.filter(g=>g.neededForCoverage&&g.hasData())};w.restartDeclutter=function(){x.isSome(this._symbolFader)&&this._symbolFader.restartDeclutter()};w._doRender=function(g){const {context:r}=g;var D=this._styleRepository;
if(D){var G=D.layers,z=!0;g.drawPhase===a.WGLDrawPhase.HITTEST&&(z=!1);0<D.backgroundBucketIds.length&&(g.renderPass="background",this._renderBackgroundLayers(g,D.backgroundBucketIds));h.prototype.renderChildren.call(this,g);g.drawPhase===a.WGLDrawPhase.MAP&&this._fade(g.displayLevel,g.state);if((D=this.children.filter(C=>C.visible&&C.hasData()))&&0!==D.length){for(var t of D)t.triangleCount=0;r.setStencilWriteMask(0);r.setColorMask(!0,!0,!0,!0);r.setStencilOp(p.StencilOperation.KEEP,p.StencilOperation.KEEP,
p.StencilOperation.REPLACE);r.setStencilTestEnabled(!0);r.setBlendingEnabled(!1);r.setDepthTestEnabled(!0);r.setDepthWriteEnabled(!0);r.setDepthFunction(p.CompareFunction.LEQUAL);r.setClearDepth(1);r.clear(r.gl.DEPTH_BUFFER_BIT);g.renderPass="opaque";for(t=G.length-1;0<=t;t--)this._renderStyleLayer(G[t],g,D);r.setDepthWriteEnabled(!1);r.setBlendingEnabled(z);r.setBlendFunctionSeparate(p.BlendFactor.ONE,p.BlendFactor.ONE_MINUS_SRC_ALPHA,p.BlendFactor.ONE,p.BlendFactor.ONE_MINUS_SRC_ALPHA);g.renderPass=
"translucent";for(z=0;z<G.length;z++)this._renderStyleLayer(G[z],g,D)}r.bindVAO();r.setStencilTestEnabled(!0);r.setBlendingEnabled(!0)}};w._fade=function(g,r){x.isSome(this._symbolFader)&&(this._symbolFader.update(g,r)||this.requestRender())};w._renderStyleLayer=function(g,r,D){const {painter:G,renderPass:z}=r;if(void 0!==g){var t=g.getLayoutProperty("visibility");if(!t||t.getValue()!==d.Visibility.NONE){switch(g.type){case d.StyleLayerType.BACKGROUND:return;case d.StyleLayerType.FILL:if("opaque"!==
z&&"translucent"!==r.renderPass)return;var C="vtlFill";break;case d.StyleLayerType.LINE:if("translucent"!==z)return;C="vtlLine";break;case d.StyleLayerType.CIRCLE:if("translucent"!==z)return;C="vtlCircle";break;case d.StyleLayerType.SYMBOL:if("translucent"!==z)return;C="vtlSymbol"}D=g.type===d.StyleLayerType.SYMBOL?D.filter(M=>M.decluttered):D.filter(M=>M.neededForCoverage);if("vtlSymbol"!==C&&(t=r.displayLevel,0===D.length||void 0!==g.minzoom&&g.minzoom>=t+1E-6||void 0!==g.maxzoom&&g.maxzoom<t-1E-6))return;
t=g.uid;r.styleLayerUID=t;r.styleLayer=g;for(const M of D)if(M.layerData.has(t)){G.renderObjects(r,D,C);break}}}};w._renderBackgroundLayers=function(g,r){const {context:D,displayLevel:G,painter:z,state:t}=g,C=this._styleRepository;var M=!1;for(var O of r)if(C.getLayerById(O).type===d.StyleLayerType.BACKGROUND&&m(C.getLayerById(O),G)){M=!0;break}if(M){M=this._tileInfoView.getTileCoverage(g.state,0,"smallest");var {spans:X,lodInfo:Q}=M,{level:V}=Q,P=f.create();O=[];if(this._renderPasses){var L=this._renderPasses[0];
x.isSome(this._clippingInfos)&&(L.brushes[0].prepareState(g),L.brushes[0].drawMany(g,this._clippingInfos))}L=this._backgroundTiles;var K=0;for(const {row:J,colFrom:S,colTo:R}of X)for(let ba=S;ba<=R;ba++){if(K<L.length){var H=L[K];H.key.set(V,J,Q.normalizeCol(ba),Q.getWorldForColumn(ba));this._tileInfoView.getTileBounds(P,H.key,!1);H.x=P[0];H.y=P[3];H.resolution=this._tileInfoView.getTileResolution(V)}else{H=new u(V,J,Q.normalizeCol(ba),Q.getWorldForColumn(ba));const Z=this._tileInfoView.getTileBounds(f.create(),
H),Y=this._tileInfoView.getTileResolution(V);H=new b.RenderableTile(H,Y,Z[0],Z[3],512,512,4096,4096);L.push(H)}H.setTransform(t);O.push(H);K++}D.setStencilWriteMask(0);D.setColorMask(!0,!0,!0,!0);D.setStencilOp(p.StencilOperation.KEEP,p.StencilOperation.KEEP,p.StencilOperation.REPLACE);D.setStencilFunction(p.CompareFunction.EQUAL,0,255);V=!0;g.drawPhase===a.WGLDrawPhase.HITTEST&&(V=!1);D.setStencilTestEnabled(V);for(const J of r)r=C.getLayerById(J),r.type===d.StyleLayerType.BACKGROUND&&m(r,G)&&(g.styleLayerUID=
r.uid,g.styleLayer=r,z.renderObjects(g,O,"vtlBackground"));l.pool.release(M)}};return v}(c);B.VectorTileContainer=c;Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/decluttering/SymbolFader":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Evented ../../../../../core/maybe ./config ./core ./jobs ./SymbolDeclutterer ./SymbolRepository ./util ../style/StyleDefinition".split(" "),function(B,F,x,A,f,q,d,a,b,
c,l){x=function(u){function p(h,v){var w=u.call(this)||this;w.styleRepository=h;w._tileToHandle=new Map;w._viewState={scale:0,rotation:0,center:[0,0],size:[0,0]};w._declutterViewState={scale:0,rotation:0,center:[0,0],size:[0,0]};w._completed=!1;w._symbolRepository=new b.SymbolRepository(4096,v,()=>new q.VTLUniqueSymbol);w._symbolDeclutterer=new a.SymbolDeclutterer(v,w._symbolRepository,(g,r,D)=>new d.CollisionJob(g,r,D,w.styleRepository,w._zoom,w._viewState.rotation),(g,r)=>{g.allSymbolsFadingOut=
!0;g.lastOpacityUpdate=r;c.writeOpacityToBuffers(g,r,!0);g.decluttered=!0;g.requestRender()},(g,r)=>w.styleRepository.getStyleLayerByUID(g.styleLayerUID).z-w.styleRepository.getStyleLayerByUID(r.styleLayerUID).z,g=>{g=w.styleRepository.getStyleLayerByUID(g);return w._zoom+1E-6<g.minzoom||w._zoom-1E-6>=g.maxzoom?!1:(g=g.getLayoutProperty("visibility"))&&g.getValue()===l.Visibility.NONE?!1:!0});return w}F._inheritsLoose(p,u);var m=p.prototype;m.addTile=function(h){h.decluttered=!1;this._tileToHandle.set(h,
h.on("symbols-changed",()=>{this._symbolRepository.add(h);this.restartDeclutter()}));this._symbolRepository.add(h);this.restartDeclutter()};m.removeTile=function(h){const v=this._tileToHandle.get(h);v&&(this._symbolRepository.removeTile(h),this.restartDeclutter(),v.remove(),this._tileToHandle.delete(h))};m.update=function(h,v){this._zoom=h;this._viewState={scale:v.scale,rotation:v.rotation,center:[v.center[0],v.center[1]],size:[v.size[0],v.size[1]]};this._continueDeclutter();return this._completed};
m.restartDeclutter=function(){this._completed=!1;this._symbolDeclutterer.restart();this._notifyUnstable()};m.clear=function(){this._completed=!1;this._symbolRepository=null;this._symbolDeclutterer.restart();this._tileToHandle.forEach(h=>h.remove());this._tileToHandle.clear()};m.deleteStyleLayers=function(h){this._symbolRepository.deleteStyleLayers(h)};m._continueDeclutter=function(){if(!this._completed||this.stale)this._symbolDeclutterer.running||(this._declutterZoom=this._zoom,this._declutterViewState.center[0]=
this._viewState.center[0],this._declutterViewState.center[1]=this._viewState.center[1],this._declutterViewState.rotation=this._viewState.rotation,this._declutterViewState.scale=this._viewState.scale,this._declutterViewState.size[0]=this._viewState.size[0],this._declutterViewState.size[1]=this._viewState.size[1],this._symbolDeclutterer.restart()),this._symbolDeclutterer.setScreenSize(this._viewState.size[0],this._viewState.size[1]),(this._completed=this._symbolDeclutterer.continue(f.DECLUTTER_BUDGET))&&
this._scheduleNotifyStable()};m._scheduleNotifyStable=function(){A.isSome(this._stableNotificationHandle)&&clearTimeout(this._stableNotificationHandle);this._stableNotificationHandle=setTimeout(()=>{this._stableNotificationHandle=null;this.emit("fade-complete")},1.5*f.FADE_DURATION)};m._notifyUnstable=function(){A.isSome(this._stableNotificationHandle)&&(clearTimeout(this._stableNotificationHandle),this._stableNotificationHandle=null);this.emit("fade-start")};F._createClass(p,[{key:"stale",get:function(){return this._zoom!==
this._declutterZoom||this._viewState.size[0]!==this._declutterViewState.size[0]||this._viewState.size[1]!==this._declutterViewState.size[1]||this._viewState.scale!==this._declutterViewState.scale||this._viewState.rotation!==this._declutterViewState.rotation}}]);return p}(x);B.SymbolFader=x;Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/decluttering/jobs":function(){define(["exports","../../../../../chunks/mat3f32","./config","./util","../style/StyleDefinition"],
function(B,F,x,A,f){let q=function(){function d(b,c,l,u,p,m){this._symbols=b;this._styleRepository=u;this._zoom=p;this._currentSymbolCursor=this._currentLayerCursor=0;this._styleProps=new Map;this._allNeededMatrices=new Map;this._gridIndex=new A.GridIndex(c,l,x.COLLISION_GRID_CELL_SIZE);this._si=Math.sin(Math.PI*m/180);this._co=Math.cos(Math.PI*m/180);for(const h of b)for(const v of h.symbols)this._allNeededMatrices.has(v.tile)||this._allNeededMatrices.set(v.tile,F.clone(v.tile.transforms.tileUnitsToPixels))}
var a=d.prototype;a.work=function(b){const c=this._gridIndex,l=performance.now();for(;this._currentLayerCursor<this._symbols.length;this._currentLayerCursor++,this._currentSymbolCursor=0){const z=this._symbols[this._currentLayerCursor],t=this._getProperties(z.styleLayerUID);for(;this._currentSymbolCursor<z.symbols.length;this._currentSymbolCursor++){if(99===this._currentSymbolCursor%100&&performance.now()-l>b)return!1;var u=z.symbols[this._currentSymbolCursor];if(!u.unique.show)continue;var p=u,m=
this._si,h=this._co,v=this._allNeededMatrices.get(u.tile),w=this._zoom;const {iconRotationAlignment:C,textRotationAlignment:M,iconTranslate:O,iconTranslateAnchor:X,textTranslate:Q,textTranslateAnchor:V}=t;var g=0;for(const J of p.colliders){const [S,R]=0===J.partIndex?O:Q;var r=0===J.partIndex?X:V,D=J.minLod<=w&&w<=J.maxLod;g+=D?0:1;J.enabled=D;J.xScreen=J.xTile*v[0]+J.yTile*v[3]+v[6];J.yScreen=J.xTile*v[1]+J.yTile*v[4]+v[7];r===f.TranslateAnchor.MAP?(J.xScreen+=h*S-m*R,J.yScreen+=m*S+h*R):(J.xScreen+=
S,J.yScreen+=R);f.RotationAlignment.VIEWPORT===(0===J.partIndex?C:M)?(J.dxScreen=J.dxPixels,J.dyScreen=J.dyPixels):(J.dxScreen=h*(J.dxPixels+J.width/2)-m*(J.dyPixels+J.height/2)-J.width/2,J.dyScreen=m*(J.dxPixels+J.width/2)+h*(J.dyPixels+J.height/2)-J.height/2)}0<p.colliders.length&&g===p.colliders.length&&(p.unique.show=!1);p=u.unique;if(!p.show)continue;const {iconAllowOverlap:P,iconIgnorePlacement:L,textAllowOverlap:K,textIgnorePlacement:H}=t;for(const J of u.colliders)if(J.enabled&&(m=p.parts[J.partIndex],
m.show)){if(h=!(J.partIndex?K:P))a:{h=J.xScreen+J.dxScreen;v=J.yScreen+J.dyScreen;w=h+J.width;g=v+J.height;const [S,R,ba,Z]=c.getCellSpan(h,v,w,g);for(r=R;r<=Z;r++)for(D=S;D<=ba;D++){var G=c.cells[r][D];for(const Y of G){G=Y.xScreen+Y.dxScreen;const ea=Y.yScreen+Y.dyScreen,U=G+Y.width,aa=ea+Y.height;if(!(w<G||h>U||g<ea||v>aa)){h=!0;break a}}}h=!1}h&&(J.hard?p.show=!1:m.show=!1)}if(p.show)for(const J of u.colliders){if(!J.enabled)continue;if(J.partIndex?H:L)continue;if(!p.parts[J.partIndex].show)continue;
u=J.xScreen+J.dxScreen;m=J.yScreen+J.dyScreen;const [S,R,ba,Z]=this._gridIndex.getCellSpan(u,m,u+J.width,m+J.height);for(u=R;u<=Z;u++)for(m=S;m<=ba;m++)this._gridIndex.cells[u][m].push(J)}}}return!0};a._getProperties=function(b){var c=this._styleProps.get(b);if(c)return c;c=this._zoom;const l=this._styleRepository.getStyleLayerByUID(b);var u=l.getLayoutValue("symbol-placement",c)!==f.SymbolPlacement.POINT;let p=l.getLayoutValue("icon-rotation-alignment",c);p===f.RotationAlignment.AUTO&&(p=u?f.RotationAlignment.MAP:
f.RotationAlignment.VIEWPORT);let m=l.getLayoutValue("text-rotation-alignment",c);m===f.RotationAlignment.AUTO&&(m=u?f.RotationAlignment.MAP:f.RotationAlignment.VIEWPORT);u=l.getPaintValue("icon-translate",c);const h=l.getPaintValue("icon-translate-anchor",c),v=l.getPaintValue("text-translate",c),w=l.getPaintValue("text-translate-anchor",c);c={iconAllowOverlap:l.getLayoutValue("icon-allow-overlap",c),iconIgnorePlacement:l.getLayoutValue("icon-ignore-placement",c),textAllowOverlap:l.getLayoutValue("text-allow-overlap",
c),textIgnorePlacement:l.getLayoutValue("text-ignore-placement",c),iconRotationAlignment:p,textRotationAlignment:m,iconTranslateAnchor:h,iconTranslate:u,textTranslateAnchor:w,textTranslate:v};this._styleProps.set(b,c);return c};return d}();B.CollisionJob=q;Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/decluttering/SymbolDeclutterer":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe","./config"],
function(B,F,x,A){function f(d,a){if(d.priority-a.priority)return d.priority-a.priority;const b=d.tile.key,c=a.tile.key;return b.world-c.world?b.world-c.world:b.level-c.level?b.level-c.level:b.row-c.row?b.row-c.row:b.col-c.col?b.col-c.col:d.xTile-a.xTile?d.xTile-a.xTile:d.yTile-a.yTile}let q=function(){function d(b,c,l,u,p,m){this._visibleTiles=b;this._symbolRepository=c;this._createCollisionJob=l;this._assignTileSymbolsOpacity=u;this._symbolLayerSorter=p;this._isLayerVisible=m;this._selectionJob=
null;this._selectionJobCompleted=!1;this._collisionJob=null;this._collisionJobCompleted=!1;this._opacityJob=null;this._opacityJobCompleted=!1;this._running=!0}var a=d.prototype;a.setScreenSize=function(b,c){this._screenWidth===b&&this._screenHeight===c||this.restart();this._screenWidth=b;this._screenHeight=c};a.restart=function(){this._selectionJob=null;this._selectionJobCompleted=!1;this._collisionJob=null;this._collisionJobCompleted=!1;this._opacityJob=null;this._opacityJobCompleted=!1;this._running=
!0};a.continue=function(b){this._selectionJob||(this._selectionJob=this._createSelectionJob());if(!this._selectionJobCompleted){var c=performance.now();if(!this._selectionJob.work(b))return!1;this._selectionJobCompleted=!0;b=Math.max(0,b-(performance.now()-c));if(0===b)return!1}this._collisionJob||(this._collisionJob=this._createCollisionJob(this._selectionJob.sortedSymbols,this._screenWidth,this._screenHeight));if(!this._collisionJobCompleted){c=performance.now();if(!this._collisionJob.work(b))return!1;
this._collisionJobCompleted=!0;b=Math.max(0,b-(performance.now()-c));if(0===b)return!1}this._opacityJob||(this._opacityJob=this._createOpacityJob());if(!this._opacityJobCompleted){c=performance.now();if(!this._opacityJob.work(b))return!1;this._opacityJobCompleted=!0;b=Math.max(0,b-(performance.now()-c));if(0===b)return!1}this._running=!1;return!0};a._createSelectionJob=function(){const b=this._symbolRepository.uniqueSymbols;for(let h=0;h<b.length;h++){const v=b[h];for(let w=0;w<v.uniqueSymbols.length;w++){const g=
v.uniqueSymbols[w];for(const r of g.tileSymbols)r.selectedForRendering=!1}}const c=[];let l=0,u=0;const p=this._isLayerVisible,m=this._symbolLayerSorter;return{work:function(h){const v=performance.now();for(;u<b.length;u++,l=0){const g=b[u];var w=g.styleLayerUID;if(!p(w)){c[u]||(c[u]={styleLayerUID:w,symbols:[]});continue}c[u]=c[u]||{styleLayerUID:w,symbols:[]};const r=c[u];for(;l<g.uniqueSymbols.length;l++){w=g.uniqueSymbols[l];if(99===l%100&&performance.now()-v>h)return!1;let D=null,G=!1,z=!1;for(const t of w.tileSymbols)if(!z||
!G){const C=t.tile;if(!D||C.isCoverage||C.neededForCoverage&&!G){D=t;if(C.neededForCoverage||C.isCoverage)z=!0;C.isCoverage&&(G=!0)}}D.selectedForRendering=!0;if(z){r.symbols.push(D);w.show=!0;for(const t of w.parts)t.show=!0}else w.show=!1}}for(const g of c)g.symbols.sort(f);return!0},get sortedSymbols(){return c.sort(m)}}};a._createOpacityJob=function(){function b(p,m){var h=p.symbols;for(const [,w]of h){var v=w;h=m;for(const g of v){v=g.unique;for(const r of v.parts)r.startOpacity+=(h-r.startTime)/
A.FADE_DURATION*(.5<r.targetOpacity?1:-1),r.startOpacity=Math.min(Math.max(r.startOpacity,0),1),r.startTime=h,r.targetOpacity=v.show&&r.show?1:0}}c(p,m);for(const w of p.childrenTiles)b(w,m)}const c=this._assignTileSymbolsOpacity,l=this._visibleTiles;let u=0;return{work(p){const m=performance.now();for(;u<l.length;u++){if(performance.now()-m>p)return!1;const h=l[u];if(x.isSome(h.parentTile))continue;const v=performance.now();b(h,v)}return!0}}};F._createClass(d,[{key:"running",get:function(){return this._running}}]);
return d}();B.SymbolDeclutterer=q;Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/decluttering/SymbolRepository":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe","./util"],function(B,F,x,A){let f=function(){function q(a,b,c){this.tileCoordRange=a;this._visibleTiles=b;this._createUnique=c;this._tiles=new Map;this._uniqueSymbolsReferences=new Map}var d=q.prototype;d.add=function(a,b){this._uniqueSymbolLayerArray=
null;let c=this._tiles.get(a.id);c||(c={symbols:new Map},this._tiles.set(a.id,c));var l=new Map;if(b)for(var u of b)c.symbols.has(u)&&(l.set(u,c.symbols.get(u)),c.symbols.delete(u));else for(var [p]of a.layerData)c.symbols.has(p)&&(l.set(p,c.symbols.get(p)),c.symbols.delete(p));this._removeSymbols(l);b=a.symbols;l=new Map;for(const [m,h]of b)if(u=h.length,32<=u){p=this.tileCoordRange;do p/=2,u/=4;while(8<u&&64<p);u=new A.GridIndex(this.tileCoordRange,this.tileCoordRange,p);l.set(m,{flat:h,index:u});
c.symbols.set(m,{flat:h,index:u});for(const v of h)u.getCell(v.xTile,v.yTile).push(v)}else l.set(m,{flat:h}),c.symbols.set(m,{flat:h});this._addSymbols(a.key,b)};d.deleteStyleLayers=function(a){this._uniqueSymbolLayerArray=null;for(const [b,c]of this._tiles){const l=new Map;for(const u of a)c.symbols.has(u)&&(l.set(u,c.symbols.get(u)),c.symbols.delete(u));this._removeSymbols(l);0===c.symbols.size&&this._tiles.delete(b)}};d.removeTile=function(a){this._uniqueSymbolLayerArray=null;const b=this._tiles.get(a.id);
if(b){var c=new Map;for(const [l]of a.symbols)b.symbols.has(l)&&(c.set(l,b.symbols.get(l)),b.symbols.delete(l));this._removeSymbols(c);0===b.symbols.size&&this._tiles.delete(a.id)}};d._removeSymbols=function(a){for(const [c,{flat:l}]of a)for(const u of l){a=u.unique;var b=a.tileSymbols;const p=b.length-1;for(let m=0;m<p;m++)if(b[m]===u){b[m]=b[p];break}b.length=p;0===p&&(b=this._uniqueSymbolsReferences.get(c),b.delete(a),0===b.size&&this._uniqueSymbolsReferences.delete(c));u.unique=null}};d._addSymbols=
function(a,b){if(0!==b.size){var c=this._visibleTiles;for(const l of c)l.parentTile||l.key.world!==a.world||l.key.level===a.level&&!l.key.equals(a)||this._matchSymbols(l,a,b);for(const [l,u]of b)for(const p of u)x.isNone(p.unique)&&(a=this._createUnique(),p.unique=a,a.tileSymbols.push(p),b=this._uniqueSymbolsReferences.get(l),b||(b=new Set,this._uniqueSymbolsReferences.set(l,b)),b.add(a))}};d._matchSymbols=function(a,b,c){if(a.key.level>b.level){var l=a.key.level-b.level;if(a.key.row>>l!==b.row||
a.key.col>>l!==b.col)return}if(b.level>a.key.level&&(l=b.level-a.key.level,b.row>>l!==a.key.row||b.col>>l!==a.key.col))return;if(b.equals(a.key))for(var u of a.childrenTiles)this._matchSymbols(u,b,c);else{u=new Map;for(const [h,v]of c){var p=[];for(const g of v)c=A.tileCoordChange(this.tileCoordRange,g.xTile,b.level,b.col,a.key.level,a.key.col),l=A.tileCoordChange(this.tileCoordRange,g.yTile,b.level,b.row,a.key.level,a.key.row),0<=c&&c<this.tileCoordRange&&0<=l&&l<this.tileCoordRange&&p.push({symbol:g,
xTransformed:c,yTransformed:l});c=[];l=a.key.level<b.level?1:1<<a.key.level-b.level;const w=this._tiles.get(a.id).symbols.get(h);if(w){const g=w.flat;for(const r of p){var m=!1;let D;const G=r.xTransformed,z=r.yTransformed;D=x.isSome(w.index)?w.index.getCell(G,z):g;p=r.symbol;const t=p.hash;for(const C of D)if(t===C.hash&&Math.abs(G-C.xTile)<=l&&Math.abs(z-C.yTile)<=l){m=C.unique;p.unique=m;m.tileSymbols.push(p);m=!0;break}m||c.push(p)}}0<c.length&&u.set(h,c)}for(const h of a.childrenTiles)this._matchSymbols(h,
b,u)}};d._createUniqueSymbolLayerArray=function(){var a=this._uniqueSymbolsReferences;const b=Array(a.size);let c=0;for(const [l,u]of a){const p=Array(u.size);a=0;for(const m of u)p[a++]=m;b[c]={styleLayerUID:l,uniqueSymbols:p};c++}return b};F._createClass(q,[{key:"uniqueSymbols",get:function(){x.isNone(this._uniqueSymbolLayerArray)&&(this._uniqueSymbolLayerArray=this._createUniqueSymbolLayerArray());return this._uniqueSymbolLayerArray}}]);return q}();B.SymbolRepository=f;Object.defineProperty(B,
Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/RenderableTile":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/mat3f32","./TiledDisplayObject"],function(B,F,x,A){A=function(f){function q(){return f.apply(this,arguments)||this}F._inheritsLoose(q,f);q.prototype._createTransforms=function(){return{dvs:x.create(),tileMat3:x.create()}};return q}(A.TiledDisplayObject);B.RenderableTile=A;Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},
"esri/views/2d/engine/vectorTiles/style/StyleRepository":function(){define(["./StyleDefinition","./StyleLayer"],function(B,F){return function(){function x(f){this._style=f;this.backgroundBucketIds=[];this._uidToLayer=new Map;this._layerByName={};this._runningId=0;f.layers||(f.layers=[]);this.version=parseFloat(f.version);if(this.layers=f.layers.map((q,d,a)=>this._create(q,d,a)).filter(q=>!!q))for(let q=0;q<this.layers.length;q++)f=this.layers[q],this._layerByName[f.id]=f,this._uidToLayer.set(f.uid,
f),f.type===B.StyleLayerType.BACKGROUND&&this.backgroundBucketIds.push(f.id);this._identifyRefLayers()}var A=x.prototype;A.isPainterDataDriven=function(f){return(f=this._layerByName[f])?f.isPainterDataDriven():!1};A.getStyleLayerId=function(f){return f>=this.layers.length?null:this.layers[f].id};A.getStyleLayerByUID=function(f){return this._uidToLayer.get(f)??null};A.getStyleLayerIndex=function(f){return(f=this._layerByName[f])?this.layers.indexOf(f):-1};A.setStyleLayer=function(f,q){if(f&&f.id){var d=
this._style;null!=q&&q>=this.layers.length&&(q=this.layers.length-1);var a=!0,b;if(b=this._layerByName[f.id]){const c=this.layers.indexOf(b);q||(q=c);q===c?(a=!1,b=x._recreateLayer(f,b),this.layers[q]=b,d.layers[q]=f):(this.layers.splice(c,1),d.layers.splice(c,1),b=this._create(f,q,this.layers),this.layers.splice(q,0,b),d.layers.splice(q,0,f))}else b=this._create(f,q,this.layers),!q||q>=this.layers.length?(this.layers.push(b),d.layers.push(f)):(this.layers.splice(q,0,b),d.layers.splice(q,0,f));this._layerByName[f.id]=
b;this._uidToLayer.set(b.uid,b);a&&this._recomputeZValues();this._identifyRefLayers()}};A.getStyleLayer=function(f){return(f=this._layerByName[f])?{type:f.typeName,id:f.id,source:f.source,"source-layer":f.sourceLayer,minzoom:f.minzoom,maxzoom:f.maxzoom,filter:f.filter,layout:f.layout,paint:f.paint}:null};A.deleteStyleLayer=function(f){const q=this._layerByName[f];q&&(delete this._layerByName[f],this._uidToLayer.delete(q.uid),f=this.layers.indexOf(q),this.layers.splice(f,1),this._style.layers.splice(f,
1),this._recomputeZValues(),this._identifyRefLayers())};A.getLayerById=function(f){return this._layerByName[f]};A.getLayoutProperties=function(f){return(f=this._layerByName[f])?f.layout:null};A.getPaintProperties=function(f){return(f=this._layerByName[f])?f.paint:null};A.setPaintProperties=function(f,q){if(f=this._layerByName[f]){var d=x._recreateLayer({type:f.typeName,id:f.id,source:f.source,"source-layer":f.sourceLayer,minzoom:f.minzoom,maxzoom:f.maxzoom,filter:f.filter,layout:f.layout,paint:q},
f),a=this.layers.indexOf(f);this.layers[a]=d;this._style.layers[a].paint=q;this._layerByName[f.id]=d;this._uidToLayer.set(f.uid,d)}};A.setLayoutProperties=function(f,q){if(f=this._layerByName[f]){var d=x._recreateLayer({type:f.typeName,id:f.id,source:f.source,"source-layer":f.sourceLayer,minzoom:f.minzoom,maxzoom:f.maxzoom,filter:f.filter,layout:q,paint:f.paint},f),a=this.layers.indexOf(f);this.layers[a]=d;this._style.layers[a].layout=q;this._layerByName[f.id]=d;this._uidToLayer.set(f.uid,d)}};A.setStyleLayerVisibility=
function(f,q){if(f=this._layerByName[f]){var d=f.layout||{};d.visibility=q;q=x._recreateLayer({type:f.typeName,id:f.id,source:f.source,"source-layer":f.sourceLayer,minzoom:f.minzoom,maxzoom:f.maxzoom,filter:f.filter,layout:d,paint:f.paint},f);var a=this.layers.indexOf(f);this.layers[a]=q;this._style.layers[a].layout=d;this._layerByName[f.id]=q;this._uidToLayer.set(f.uid,q)}};A.getStyleLayerVisibility=function(f){return(f=this._layerByName[f])?f.layout?.visibility??"visible":"none"};A._recomputeZValues=
function(){const f=this.layers,q=1/(f.length+1);for(let d=0;d<f.length;d++)f[d].z=1-(1+d)*q};A._identifyRefLayers=function(){const f=[],q=[];let d=0;for(const c of this.layers){const l=c.layout;if(c.type===B.StyleLayerType.FILL){var a=c,b=c.source+"|"+c.sourceLayer;b+="|"+(l?.visibility??"");b+="|"+c.minzoom;b+="|"+c.maxzoom;b+="|"+JSON.stringify(c.filter);if(a.hasDataDrivenFill||a.hasDataDrivenOutline)b+="|"+d;f.push({key:b,layer:c})}else if(c.type===B.StyleLayerType.LINE){a=c;b=c.paint;b=null!=
b&&(null!=b["line-pattern"]||null!=b["line-dasharray"]);let u=c.source+"|"+c.sourceLayer;u+="|"+(l?.visibility??"");u+="|"+c.minzoom;u+="|"+c.maxzoom;u+="|"+JSON.stringify(c.filter);u+="|"+(void 0!==l?l["line-cap"]:"");u+="|"+(void 0!==l?l["line-join"]:"");if(a.hasDataDrivenLine||b)u+="|"+d;q.push({key:u,layer:c})}++d}this._assignRefLayers(f);this._assignRefLayers(q)};A._assignRefLayers=function(f){f.sort((l,u)=>l.key<u.key?-1:l.key>u.key?1:0);let q,d;const a=f.length;for(let l=0;l<a;l++){const u=
f[l];if(u.key===q)u.layer.refLayerId=d;else if(q=u.key,d=u.layer.id,u.layer.type===B.StyleLayerType.FILL){if(!u.layer.getPaintProperty("fill-outline-color"))for(var b=l+1;b<a;b++){var c=f[b];if(c.key===q){if(c.layer.getPaintProperty("fill-outline-color")){f[l]=c;f[b]=u;d=c.layer.id;break}}else break}}else if(u.layer.type===B.StyleLayerType.LINE)for(b=u.layer,c=l+1;c<a;c++){const p=f[c];if(p.key!==q)break;const m=p.layer;if(b.canUseThinTessellation&&!m.canUseThinTessellation||!b.canUseThinTessellation&&
(m.getPaintProperty("line-pattern")||m.getPaintProperty("line-dasharray")))b=m,f[l]=p,f[c]=u,d=p.layer.id}}};A._create=function(f,q,d){q=1-1/(d.length+1)*(1+q);d=this._runningId++;switch(f.type){case "background":return new F.BackgroundStyleLayer(B.StyleLayerType.BACKGROUND,f,q,d);case "fill":return new F.FillStyleLayer(B.StyleLayerType.FILL,f,q,d);case "line":return new F.LineStyleLayer(B.StyleLayerType.LINE,f,q,d);case "symbol":return new F.SymbolStyleLayer(B.StyleLayerType.SYMBOL,f,q,d);case "raster":console.warn(`Unsupported vector tile raster layer ${f.id}`);
break;case "circle":return new F.CircleStyleLayer(B.StyleLayerType.CIRCLE,f,q,d)}return null};x._recreateLayer=function(f,q){switch(f.type){case "background":return new F.BackgroundStyleLayer(B.StyleLayerType.BACKGROUND,f,q.z,q.uid);case "fill":return new F.FillStyleLayer(B.StyleLayerType.FILL,f,q.z,q.uid);case "line":return new F.LineStyleLayer(B.StyleLayerType.LINE,f,q.z,q.uid);case "symbol":return new F.SymbolStyleLayer(B.StyleLayerType.SYMBOL,f,q.z,q.uid);case "raster":console.warn(`Unsupported vector tile raster layer ${f.id}`);
break;case "circle":return new F.CircleStyleLayer(B.StyleLayerType.CIRCLE,f,q.z,q.uid)}return null};return x}()})},"esri/views/2d/engine/vectorTiles/style/StyleLayer":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../enums ../shaders/VTLBackgroundMaterial ../shaders/VTLCircleMaterial ../shaders/VTLFillMaterial ../shaders/VTLLineMaterial ../shaders/VTLSymbolMaterial ./Filter ./StyleDefinition ./StyleProperty ../../webgl/definitions".split(" "),function(B,F,x,A,f,q,d,a,b,
c,l,u){B.CapType=void 0;(function(G){G[G.BUTT=0]="BUTT";G[G.ROUND=1]="ROUND";G[G.SQUARE=2]="SQUARE";G[G.UNKNOWN=4]="UNKNOWN"})(B.CapType||(B.CapType={}));let p=function(){function G(t,C,M,O){this.type=t;this.typeName=C.type;this.id=C.id;this.source=C.source;this.sourceLayer=C["source-layer"];this.minzoom=C.minzoom;this.maxzoom=C.maxzoom;this.filter=C.filter;this.layout=C.layout;this.paint=C.paint;this.z=M;this.uid=O;switch(t){case c.StyleLayerType.BACKGROUND:this._layoutDefinition=c.StyleDefinition.backgroundLayoutDefinition;
this._paintDefinition=c.StyleDefinition.backgroundPaintDefinition;break;case c.StyleLayerType.FILL:this._layoutDefinition=c.StyleDefinition.fillLayoutDefinition;this._paintDefinition=c.StyleDefinition.fillPaintDefinition;break;case c.StyleLayerType.LINE:this._layoutDefinition=c.StyleDefinition.lineLayoutDefinition;this._paintDefinition=c.StyleDefinition.linePaintDefinition;break;case c.StyleLayerType.SYMBOL:this._layoutDefinition=c.StyleDefinition.symbolLayoutDefinition;this._paintDefinition=c.StyleDefinition.symbolPaintDefinition;
break;case c.StyleLayerType.CIRCLE:this._layoutDefinition=c.StyleDefinition.circleLayoutDefinition,this._paintDefinition=c.StyleDefinition.circlePaintDefinition}this._layoutProperties=this._parseLayout(this.layout);this._paintProperties=this._parsePaint(this.paint)}var z=G.prototype;z.getFeatureFilter=function(){return void 0!==this._featureFilter?this._featureFilter:this._featureFilter=b.createFilter(this.filter)};z.getLayoutProperty=function(t){return this._layoutProperties[t]};z.getPaintProperty=
function(t){return this._paintProperties[t]};z.getLayoutValue=function(t,C,M){let O;const X=this._layoutProperties[t];X&&(O=X.getValue(C,M));void 0===O&&(O=this._layoutDefinition[t]["default"]);return O};z.getPaintValue=function(t,C,M){let O;const X=this._paintProperties[t];X&&(O=X.getValue(C,M));void 0===O&&(O=this._paintDefinition[t]["default"]);return O};z.isPainterDataDriven=function(){const t=this._paintProperties;if(t)for(const C in t)if(t[C].isDataDriven)return!0;return!1};z._parseLayout=function(t){const C=
{};for(const M in t){const O=this._layoutDefinition[M];O&&(C[M]=new l(O,t[M]))}return C};z._parsePaint=function(t){const C={};for(const M in t){const O=this._paintDefinition[M];O&&(C[M]=new l(O,t[M]))}return C};z.computeAttributesKey=function(t,C,M,O){let X=0,Q=0;for(const V of C){C=3;if(!V||V!==O){const {isLayout:P,isOptional:L}=M[V];C=P?this.getLayoutProperty(V):this.getPaintProperty(V);C=C?.interpolator?2:C?.isDataDriven?1:L&&!C?3:0}Q|=C<<X;X+=2}return Q<<3|t};return G}(),m=function(G){function z(t,
C,M,O){t=G.call(this,t,C,M,O)||this;t.backgroundMaterial=new A.VTLBackgroundMaterial(t.computeAttributesKey(x.ShaderProgramType.BACKGROUND,A.VTLBackgroundMaterial.ATTRIBUTES,A.VTLBackgroundMaterial.ATTRIBUTES_INFO));return t}F._inheritsLoose(z,G);return z}(p),h=function(G){function z(t,C,M,O){t=G.call(this,t,C,M,O)||this;C=t.getPaintProperty("fill-color");M=t.getPaintProperty("fill-opacity");O=t.getPaintProperty("fill-pattern");t.hasDataDrivenColor=C?.isDataDriven;t.hasDataDrivenOpacity=M?.isDataDriven;
t.hasDataDrivenFill=t.hasDataDrivenColor||t.hasDataDrivenOpacity||O?.isDataDriven;M=t.getPaintProperty("fill-outline-color");t.outlineUsesFillColor=!M;t.hasDataDrivenOutlineColor=M?.isDataDriven;t.hasDataDrivenOutline=M?M.isDataDriven:C?C.isDataDriven:!1;t.hasDataDrivenOutline=(M?t.hasDataDrivenOutlineColor:t.hasDataDrivenColor)||t.hasDataDrivenOpacity;t.fillMaterial=new q.VTLFillMaterial(t.computeAttributesKey(x.ShaderProgramType.FILL,q.VTLFillMaterial.ATTRIBUTES,q.VTLFillMaterial.ATTRIBUTES_INFO));
t.outlineMaterial=new q.VTLOutlineMaterial(t.computeAttributesKey(x.ShaderProgramType.OUTLINE,t.outlineUsesFillColor?q.VTLOutlineMaterial.ATTRIBUTES_FILL:q.VTLOutlineMaterial.ATTRIBUTES_OUTLINE,t.outlineUsesFillColor?q.VTLOutlineMaterial.ATTRIBUTES_INFO_FILL:q.VTLOutlineMaterial.ATTRIBUTES_INFO_OUTLINE),t.outlineUsesFillColor);return t}F._inheritsLoose(z,G);return z}(p),v=function(G){function z(t,C,M,O){t=G.call(this,t,C,M,O)||this;C=t.getPaintProperty("line-pattern");t.lineMaterial=new d.VTLLineMaterial(t.computeAttributesKey(x.ShaderProgramType.LINE,
d.VTLLineMaterial.ATTRIBUTES,d.VTLLineMaterial.ATTRIBUTES_INFO,C?"line-dasharray":""));t.hasDataDrivenLine=t.getPaintProperty("line-blur")?.isDataDriven||t.getPaintProperty("line-color")?.isDataDriven||t.getPaintProperty("line-gap-width")?.isDataDriven||t.getPaintProperty("line-offset")?.isDataDriven||t.getPaintProperty("line-opacity")?.isDataDriven||t.getPaintProperty("line-pattern")?.isDataDriven||t.getPaintProperty("line-dasharray")?.isDataDriven||t.getLayoutProperty("line-cap")?.isDataDriven||
t.getPaintProperty("line-width")?.isDataDriven;t.canUseThinTessellation=!1;!t.hasDataDrivenLine&&(C=t.getPaintProperty("line-width"),!C||"number"===typeof C&&.5*C<u.THIN_LINE_HALF_WIDTH_THRESHOLD)&&(C=t.getPaintProperty("line-offset"),!C||"number"===typeof C&&0===C)&&(t.canUseThinTessellation=!0);return t}F._inheritsLoose(z,G);z.prototype.getDashKey=function(t,C){switch(C){case B.CapType.BUTT:C="Butt";break;case B.CapType.ROUND:C="Round";break;case B.CapType.SQUARE:C="Square";break;default:C="Butt"}return`dasharray-[${t.toString()}]-${C}`};
return z}(p),w=function(G){function z(t,C,M,O){t=G.call(this,t,C,M,O)||this;t.iconMaterial=new a.VTLIconMaterial(t.computeAttributesKey(x.ShaderProgramType.ICON,a.VTLIconMaterial.ATTRIBUTES,a.VTLIconMaterial.ATTRIBUTES_INFO));t.textMaterial=new a.VTLTextMaterial(t.computeAttributesKey(x.ShaderProgramType.TEXT,a.VTLTextMaterial.ATTRIBUTES,a.VTLTextMaterial.ATTRIBUTES_INFO));t.hasDataDrivenIcon=t.getPaintProperty("icon-color")?.isDataDriven||t.getPaintProperty("icon-halo-blur")?.isDataDriven||t.getPaintProperty("icon-halo-color")?.isDataDriven||
t.getPaintProperty("icon-halo-width")?.isDataDriven||t.getPaintProperty("icon-opacity")?.isDataDriven||t.getLayoutProperty("icon-size")?.isDataDriven;t.hasDataDrivenText=t.getPaintProperty("text-color")?.isDataDriven||t.getPaintProperty("text-halo-blur")?.isDataDriven||t.getPaintProperty("text-halo-color")?.isDataDriven||t.getPaintProperty("text-halo-width")?.isDataDriven||t.getPaintProperty("text-opacity")?.isDataDriven||t.getLayoutProperty("text-size")?.isDataDriven;return t}F._inheritsLoose(z,
G);return z}(p),g=function(G){function z(t,C,M,O){t=G.call(this,t,C,M,O)||this;t.circleMaterial=new f.VTLCircleMaterial(t.computeAttributesKey(x.ShaderProgramType.CIRCLE,f.VTLCircleMaterial.ATTRIBUTES,f.VTLCircleMaterial.ATTRIBUTES_INFO));return t}F._inheritsLoose(z,G);return z}(p),r=function(){function G(z,t,C){this.allowOverlap=z.getLayoutValue("icon-allow-overlap",t);this.ignorePlacement=z.getLayoutValue("icon-ignore-placement",t);this.keepUpright=z.getLayoutValue("icon-keep-upright",t);this.optional=
z.getLayoutValue("icon-optional",t);this.rotationAlignment=z.getLayoutValue("icon-rotation-alignment",t);this.rotationAlignment===c.RotationAlignment.AUTO&&(this.rotationAlignment=C?c.RotationAlignment.MAP:c.RotationAlignment.VIEWPORT);C=z.getLayoutProperty("icon-anchor");C?.isDataDriven?this._anchorProp=C:this.anchor=z.getLayoutValue("icon-anchor",t);C=z.getLayoutProperty("icon-offset");C?.isDataDriven?this._offsetProp=C:this.offset=z.getLayoutValue("icon-offset",t);C=z.getLayoutProperty("icon-padding");
C?.isDataDriven?this._paddingProp=C:this.padding=z.getLayoutValue("icon-padding",t);C=z.getLayoutProperty("icon-rotate");C?.isDataDriven?this._rotateProp=C:this.rotate=z.getLayoutValue("icon-rotate",t);C=z.getLayoutProperty("icon-size");C?.isDataDriven?this._sizeProp=C:this.size=z.getLayoutValue("icon-size",t)}G.prototype.update=function(z,t){this._anchorProp&&(this.anchor=this._anchorProp.getValue(z,t));this._offsetProp&&(this.offset=this._offsetProp.getValue(z,t));this._paddingProp&&(this.padding=
this._paddingProp.getValue(z,t));this._rotateProp&&(this.rotate=this._rotateProp.getValue(z,t));this._sizeProp&&(this.size=this._sizeProp.getValue(z,t))};return G}(),D=function(){function G(z,t,C){this.allowOverlap=z.getLayoutValue("text-allow-overlap",t);this.ignorePlacement=z.getLayoutValue("text-ignore-placement",t);this.keepUpright=z.getLayoutValue("text-keep-upright",t);this.optional=z.getLayoutValue("text-optional",t);this.rotationAlignment=z.getLayoutValue("text-rotation-alignment",t);this.rotationAlignment===
c.RotationAlignment.AUTO&&(this.rotationAlignment=C?c.RotationAlignment.MAP:c.RotationAlignment.VIEWPORT);C=z.getLayoutProperty("text-anchor");C?.isDataDriven?this._anchorProp=C:this.anchor=z.getLayoutValue("text-anchor",t);C=z.getLayoutProperty("text-justify");C?.isDataDriven?this._justifyProp=C:this.justify=z.getLayoutValue("text-justify",t);C=z.getLayoutProperty("text-letter-spacing");C?.isDataDriven?this._letterSpacingProp=C:this.letterSpacing=z.getLayoutValue("text-letter-spacing",t);C=z.getLayoutProperty("text-line-height");
C?.isDataDriven?this._lineHeightProp=C:this.lineHeight=z.getLayoutValue("text-line-height",t);C=z.getLayoutProperty("text-max-angle");C?.isDataDriven?this._maxAngleProp=C:this.maxAngle=z.getLayoutValue("text-max-angle",t);C=z.getLayoutProperty("text-max-width");C?.isDataDriven?this._maxWidthProp=C:this.maxWidth=z.getLayoutValue("text-max-width",t);C=z.getLayoutProperty("text-offset");C?.isDataDriven?this._offsetProp=C:this.offset=z.getLayoutValue("text-offset",t);C=z.getLayoutProperty("text-padding");
C?.isDataDriven?this._paddingProp=C:this.padding=z.getLayoutValue("text-padding",t);C=z.getLayoutProperty("text-rotate");C?.isDataDriven?this._rotateProp=C:this.rotate=z.getLayoutValue("text-rotate",t);C=z.getLayoutProperty("text-size");C?.isDataDriven?this._sizeProp=C:this.size=z.getLayoutValue("text-size",t);C=z.getLayoutProperty("text-writing-mode");C?.isDataDriven?this._writingModeProp=C:this.writingMode=z.getLayoutValue("text-writing-mode",t)}G.prototype.update=function(z,t){this._anchorProp&&
(this.anchor=this._anchorProp.getValue(z,t));this._justifyProp&&(this.justify=this._justifyProp.getValue(z,t));this._letterSpacingProp&&(this.letterSpacing=this._letterSpacingProp.getValue(z,t));this._lineHeightProp&&(this.lineHeight=this._lineHeightProp.getValue(z,t));this._maxAngleProp&&(this.maxAngle=this._maxAngleProp.getValue(z,t));this._maxWidthProp&&(this.maxWidth=this._maxWidthProp.getValue(z,t));this._offsetProp&&(this.offset=this._offsetProp.getValue(z,t));this._paddingProp&&(this.padding=
this._paddingProp.getValue(z,t));this._rotateProp&&(this.rotate=this._rotateProp.getValue(z,t));this._sizeProp&&(this.size=this._sizeProp.getValue(z,t));this._writingModeProp&&(this.writingMode=this._writingModeProp.getValue(z,t))};return G}();B.BackgroundStyleLayer=m;B.CircleStyleLayer=g;B.FillStyleLayer=h;B.IconLayout=r;B.LineStyleLayer=v;B.StyleLayer=p;B.SymbolStyleLayer=w;B.TextLayout=D;Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/shaders/VTLBackgroundMaterial":function(){define(["exports",
"../../../../../chunks/_rollupPluginBabelHelpers","./VTLMaterial","../../../../webgl/enums","../../../../webgl/VertexElementDescriptor"],function(B,F,x,A,f){x=function(q){function d(b){return q.call(this,b)||this}F._inheritsLoose(d,q);var a=d.prototype;a.geometryInfo=function(){return d.GEOMETRY_LAYOUT};a.opacityInfo=function(){return null};a.attributes=function(){return d.ATTRIBUTES};a.attributesInfo=function(){return d.ATTRIBUTES_INFO};return d}(x.VTLMaterial);x.ATTRIBUTES=[];x.GEOMETRY_LAYOUT=
[new f.VertexElementDescriptor("a_pos",2,A.DataType.BYTE,0,2)];x.ATTRIBUTES_INFO={};B.VTLBackgroundMaterial=x;Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/shaders/VTLMaterial":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../MemoryBuffer ./enums ../../../../webgl/enums ../../../../webgl/VertexElementDescriptor".split(" "),function(B,F,x,A,f,q,d){let a=function(){function l(p){this._locations=
new Map;this._key=p}var u=l.prototype;u.defines=function(){return[]};u.getStride=function(){this._layoutInfo||this._buildAttributesInfo();return this._stride};u.getAttributeLocations=function(){0===this._locations.size&&this._buildAttributesInfo();return this._locations};u.getLayoutInfo=function(){this._layoutInfo||this._buildAttributesInfo();return this._layoutInfo};u.getEncodingInfos=function(){this._propertyEncodingInfo||this._buildAttributesInfo();return this._propertyEncodingInfo};u.getUniforms=
function(){this._uniforms||this._buildAttributesInfo();return this._uniforms};u.getShaderHeader=function(){this._shaderHeader||this._buildAttributesInfo();return this._shaderHeader};u.getShaderMain=function(){this._shaderMain||this._buildAttributesInfo();return this._shaderMain};u.setDataUniforms=function(p,m,h,v,w){var g=this.getUniforms();for(const r of g){const {name:D,type:G,getValue:z}=r;g=z(h,m,v,w);if(null!==g)switch(G){case "float":p.setUniform1f(D,g);break;case "vec2":p.setUniform2fv(D,g);
break;case "vec4":p.setUniform4fv(D,g)}}};u.encodeAttributes=function(p,m,h,v){const w=this.attributesInfo(),g=this.getEncodingInfos(),r=[];let D=0,G=0;for(const t of Object.keys(g)){var z=g[t];const {type:C,precisionFactor:M,isLayout:O}=w[t],X=O?h.getLayoutProperty(t):h.getPaintProperty(t),Q=X.interpolator?.getInterpolationRange(m);let V=0;for(const P of z){const {offset:L,bufferElementsToAdd:K}=P;if(0<K){for(z=0;z<K;z++)r.push(0);D+=G;G=P.bufferElementsToAdd}z=v??X.getValue(Q?Q[V]:m,p);switch(C){case f.EncodingType.R8_SIGNED:case f.EncodingType.R8_UNSIGNED:r[D]|=
this._encodeByte(z*(M||1),8*L);break;case f.EncodingType.R16_SIGNED:case f.EncodingType.R16_UNSIGNED:r[D]|=this._encodeShort(z*(M||1),8*L);break;case f.EncodingType.R8G8_SIGNED:case f.EncodingType.R8G8_UNSIGNED:r[D]|=this._encodeByte(z*(M||1),8*L);r[D]|=this._encodeByte(z*(M||1),8*L+8);break;case f.EncodingType.R16G16_SIGNED:case f.EncodingType.R16G16_UNSIGNED:r[D]|=this._encodeShort(z*(M||1),8*L);r[D]|=this._encodeShort(z*(M||1),8*L+16);break;case f.EncodingType.R8G8B8A8_SIGNED:case f.EncodingType.R8G8B8A8_UNSIGNED:r[D]|=
this._encodeByte(z*(M||1),8*L);r[D]|=this._encodeByte(z*(M||1),8*L+8);r[D]|=this._encodeByte(z*(M||1),8*L+16);r[D]|=this._encodeByte(z*(M||1),8*L+24);break;case f.EncodingType.R8G8B8A8_COLOR:r[D]=this._encodeColor(z);break;case f.EncodingType.R16G16B16A16_DASHARRAY:case f.EncodingType.R16G16B16A16_PATTERN:this._encodePattern(D,r,z);break;default:throw Error("Unsupported encoding type");}V++}}return r};u.getAtributeState=function(p){const m=3+2*p;p=0|this._bit(m);return p|=this._bit(m+1)<<1};u._buildAttributesInfo=
function(){const p=[],m={};var h={},v=-1;const w=this.attributesInfo();var g=this.attributes();let r=-1;for(const t of g){r++;g=this.getAtributeState(r);if(g===f.AttributeStatus.UNIFORM||g===f.AttributeStatus.UNUSED)continue;var D=w[t];const C=[];m[t]=C;D=D.type;for(let M=0;M<g;M++){const {dataType:O,bytesPerElement:X,count:Q,normalized:V}=l._encodingInfo[D],P=X*Q;var G=`${O}-${!0===V}`;let L=h[G],K=0;!L||4<L.count+Q?(v++,L={dataIndex:v,count:0,offset:0},4!==Q&&(h[G]=L),p.push({location:-1,name:"a_data_"+
v,count:Q,type:O,normalized:V}),K=Math.ceil(Math.max(P/4,1))):(G=p[L.dataIndex],G.count+=Q,K=Math.ceil(Math.max(G.count*X/4,1))-Math.ceil(Math.max(L.offset/4,1)));C.push({dataIndex:L.dataIndex,offset:L.offset,bufferElementsToAdd:K});L.offset+=P;L.count+=Q}}for(const t of p)switch(t.type){case q.DataType.BYTE:case q.DataType.UNSIGNED_BYTE:t.count=4;break;case q.DataType.SHORT:case q.DataType.UNSIGNED_SHORT:t.count+=t.count%2}this._buildVertexBufferLayout(p);h=0;v=this._layoutInfo.geometry;for(var z of v)this._locations.set(z.name,
h++);if(z=this._layoutInfo.opacity)for(const t of z)this._locations.set(t.name,h++);this._buildShaderInfo(p,m);this._propertyEncodingInfo=m};u._buildVertexBufferLayout=function(p){const m={},h=this.geometryInfo();let v=h[0].stride;if(0===p.length)m.geometry=h;else{const w=[];let g=v;for(const r of p)v+=b(r.type)*r.count;for(const r of h)w.push(new d.VertexElementDescriptor(r.name,r.count,r.type,r.offset,v,r.normalized));for(const r of p)w.push(new d.VertexElementDescriptor(r.name,r.count,r.type,g,
v,r.normalized)),g+=b(r.type)*r.count;m.geometry=w}this.opacityInfo()&&(m.opacity=this.opacityInfo());this._layoutInfo=m;this._stride=v};u._buildShaderInfo=function(p,m){let h="\n",v="\n";const w=[];for(var g of p)h+=`attribute ${this._getType(g.count)} ${g.name};\n`;var r=this.attributes();p=this.attributesInfo();g=-1;for(const z of r){g++;const {name:t,type:C,precisionFactor:M,isLayout:O}=p[z];r=M&&1!==M?` * ${1/M}`:"";const {bytesPerElement:X,count:Q}=l._encodingInfo[C];var D=V=>`a_data_${V.dataIndex}${c(Q,
V.offset,X)}`;switch(this.getAtributeState(g)){case f.AttributeStatus.UNIFORM:r=this._getType(Q);var G=`u_${t}`;w.push({name:G,type:r,getValue:(P,L,K,H)=>{K=O?P.getLayoutValue(z,L):P.getPaintValue(z,L);if(C===f.EncodingType.R16G16B16A16_DASHARRAY){P=P.getDashKey(K,P.getLayoutValue("line-cap",L));H=H.getMosaicItemPosition(P,!1);if(x.isNone(H))return null;const {tl:J,br:S}=H;return[J[0],S[1],S[0],J[1]]}if(C===f.EncodingType.R16G16B16A16_PATTERN){H=H.getMosaicItemPosition(K,!z.includes("line-"));if(x.isNone(H))return null;
const {tl:J,br:S}=H;return[J[0],S[1],S[0],J[1]]}return C===f.EncodingType.R8G8B8A8_COLOR?(H=K[3],[H*K[0],H*K[1],H*K[2],H]):K}});h+=`uniform ${r} ${G};\n`;v+=`${r} ${t} = ${G};\n`;break;case f.AttributeStatus.DATA_DRIVEN:G=D(m[z][0]);v+=`${this._getType(Q)} ${t} = ${G}${r};\n`;break;case f.AttributeStatus.INTERPOLATED_DATA_DRIVEN:G=`u_t_${t}`;w.push({name:G,type:"float",getValue:(P,L,K,H)=>(O?P.getLayoutProperty(z):P.getPaintProperty(z)).interpolator.interpolationUniformValue(K,L)});h+=`uniform float ${G};\n`;
const V=D(m[z][0]);D=D(m[z][1]);v+=`${this._getType(Q)} ${t} = mix(${V}${r}, ${D}${r}, ${G});\n`}}this._shaderHeader=h;this._shaderMain=v;this._uniforms=w};u._bit=function(p){return(this._key&1<<p)>>p};u._getType=function(p){switch(p){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4"}throw Error("Invalid count");};u._encodeColor=function(p){const m=255*p[3];return A.i8888to32(p[0]*m,p[1]*m,p[2]*m,m)};u._encodePattern=function(p,m,h){if(h&&h.rect){var v=h.rect,w=h.width;
h=h.height;m[p]=this._encodeShort(v.x+2,0);m[p]|=this._encodeShort(v.y+2+h,16);m[p+1]=this._encodeShort(v.x+2+w,0);m[p+1]|=this._encodeShort(v.y+2,16)}};u._encodeByte=function(p,m){return(p&255)<<m};u._encodeShort=function(p,m){return(p&65535)<<m};F._createClass(l,[{key:"key",get:function(){return this._key}},{key:"type",get:function(){return this._key&7}}]);return l}();a._encodingInfo={[f.EncodingType.R8_SIGNED]:{dataType:q.DataType.BYTE,bytesPerElement:1,count:1,normalized:!1},[f.EncodingType.R8_UNSIGNED]:{dataType:q.DataType.UNSIGNED_BYTE,
bytesPerElement:1,count:1,normalized:!1},[f.EncodingType.R16_SIGNED]:{dataType:q.DataType.SHORT,bytesPerElement:2,count:1,normalized:!1},[f.EncodingType.R16_UNSIGNED]:{dataType:q.DataType.UNSIGNED_SHORT,bytesPerElement:2,count:1,normalized:!1},[f.EncodingType.R8G8_SIGNED]:{dataType:q.DataType.BYTE,bytesPerElement:1,count:2,normalized:!1},[f.EncodingType.R8G8_UNSIGNED]:{dataType:q.DataType.UNSIGNED_BYTE,bytesPerElement:1,count:2,normalized:!1},[f.EncodingType.R16G16_SIGNED]:{dataType:q.DataType.SHORT,
bytesPerElement:2,count:2,normalized:!1},[f.EncodingType.R16G16_UNSIGNED]:{dataType:q.DataType.UNSIGNED_SHORT,bytesPerElement:2,count:2,normalized:!1},[f.EncodingType.R8G8B8A8_SIGNED]:{dataType:q.DataType.BYTE,bytesPerElement:1,count:4,normalized:!1},[f.EncodingType.R8G8B8A8_UNSIGNED]:{dataType:q.DataType.UNSIGNED_BYTE,bytesPerElement:1,count:4,normalized:!1},[f.EncodingType.R8G8B8A8_COLOR]:{dataType:q.DataType.UNSIGNED_BYTE,bytesPerElement:1,count:4,normalized:!0},[f.EncodingType.R16G16B16A16_DASHARRAY]:{dataType:q.DataType.UNSIGNED_SHORT,
bytesPerElement:2,count:4,normalized:!1},[f.EncodingType.R16G16B16A16_PATTERN]:{dataType:q.DataType.UNSIGNED_SHORT,bytesPerElement:2,count:4,normalized:!1}};const b=l=>{switch(l){case q.DataType.FLOAT:return 4;case q.DataType.INT:return 4;case q.DataType.UNSIGNED_INT:return 4;case q.DataType.SHORT:return 2;case q.DataType.UNSIGNED_SHORT:return 2;case q.DataType.BYTE:return 1;case q.DataType.UNSIGNED_BYTE:return 1}},c=(l,u,p)=>{u/=p;if(1===l)switch(u){case 0:return".x";case 1:return".y";case 2:return".z";
case 3:return".w"}else if(2===l)switch(u){case 0:return".xy";case 1:return".yz";case 2:return".zw"}else if(3===l)switch(u){case 0:return".xyz";case 1:return".yzw"}return""};B.VTLMaterial=a;Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/MemoryBuffer":function(){define(["../../../../chunks/_rollupPluginBabelHelpers"],function(B){return function(){function F(A){this._array=[];0>=A&&console.error("strideInBytes must be positive!");this._stride=A}var x=
F.prototype;x.reset=function(){this.array.length=0};x.toBuffer=function(){return(new Uint32Array(this._array)).buffer};F.i1616to32=function(A,f){return 65535&A|f<<16};F.i8888to32=function(A,f,q,d){return A&255|(f&255)<<8|(q&255)<<16|d<<24};F.i8816to32=function(A,f,q){return A&255|(f&255)<<8|q<<16};B._createClass(F,[{key:"array",get:function(){return this._array}},{key:"index",get:function(){return 4*this._array.length/this._stride}},{key:"itemSize",get:function(){return this._stride}},{key:"sizeInBytes",
get:function(){return 4*this._array.length}}]);return F}()})},"esri/views/2d/engine/vectorTiles/shaders/enums":function(){define(["exports"],function(B){B.EncodingType=void 0;(function(F){F[F.R8_SIGNED=0]="R8_SIGNED";F[F.R8_UNSIGNED=1]="R8_UNSIGNED";F[F.R16_SIGNED=2]="R16_SIGNED";F[F.R16_UNSIGNED=3]="R16_UNSIGNED";F[F.R8G8_SIGNED=4]="R8G8_SIGNED";F[F.R8G8_UNSIGNED=5]="R8G8_UNSIGNED";F[F.R16G16_SIGNED=6]="R16G16_SIGNED";F[F.R16G16_UNSIGNED=7]="R16G16_UNSIGNED";F[F.R8G8B8A8_SIGNED=8]="R8G8B8A8_SIGNED";
F[F.R8G8B8A8_UNSIGNED=9]="R8G8B8A8_UNSIGNED";F[F.R8G8B8A8_COLOR=10]="R8G8B8A8_COLOR";F[F.R16G16B16A16_DASHARRAY=11]="R16G16B16A16_DASHARRAY";F[F.R16G16B16A16_PATTERN=12]="R16G16B16A16_PATTERN"})(B.EncodingType||(B.EncodingType={}));B.AttributeStatus=void 0;(function(F){F[F.UNIFORM=0]="UNIFORM";F[F.DATA_DRIVEN=1]="DATA_DRIVEN";F[F.INTERPOLATED_DATA_DRIVEN=2]="INTERPOLATED_DATA_DRIVEN";F[F.UNUSED=3]="UNUSED"})(B.AttributeStatus||(B.AttributeStatus={}));Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},
"esri/views/2d/engine/vectorTiles/shaders/VTLCircleMaterial":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ./enums ./VTLMaterial ../../../../webgl/enums ../../../../webgl/VertexElementDescriptor".split(" "),function(B,F,x,A,f,q){A=function(d){function a(c){return d.call(this,c)||this}F._inheritsLoose(a,d);var b=a.prototype;b.geometryInfo=function(){return a.GEOMETRY_LAYOUT};b.opacityInfo=function(){return null};b.attributes=function(){return a.ATTRIBUTES};b.attributesInfo=
function(){return a.ATTRIBUTES_INFO};return a}(A.VTLMaterial);A.ATTRIBUTES="circle-radius circle-color circle-opacity circle-stroke-width circle-stroke-color circle-stroke-opacity circle-blur".split(" ");A.GEOMETRY_LAYOUT=[new q.VertexElementDescriptor("a_pos",2,f.DataType.SHORT,0,4)];A.ATTRIBUTES_INFO={"circle-radius":{name:"radius",type:x.EncodingType.R8_UNSIGNED},"circle-color":{name:"color",type:x.EncodingType.R8G8B8A8_COLOR},"circle-opacity":{name:"opacity",type:x.EncodingType.R8_UNSIGNED,precisionFactor:100},
"circle-stroke-width":{name:"stroke_width",type:x.EncodingType.R8_UNSIGNED,precisionFactor:4},"circle-stroke-color":{name:"stroke_color",type:x.EncodingType.R8G8B8A8_COLOR},"circle-stroke-opacity":{name:"stroke_opacity",type:x.EncodingType.R8_UNSIGNED,precisionFactor:100},"circle-blur":{name:"blur",type:x.EncodingType.R8_UNSIGNED,precisionFactor:32}};B.VTLCircleMaterial=A;Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/shaders/VTLFillMaterial":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ./enums ./VTLMaterial ../../../../webgl/enums ../../../../webgl/VertexElementDescriptor".split(" "),
function(B,F,x,A,f,q){let d=function(a){function b(l){return a.call(this,l)||this}F._inheritsLoose(b,a);var c=b.prototype;c.geometryInfo=function(){return b.GEOMETRY_LAYOUT};c.opacityInfo=function(){return null};c.attributes=function(){return b.ATTRIBUTES};c.attributesInfo=function(){return b.ATTRIBUTES_INFO};return b}(A.VTLMaterial);d.ATTRIBUTES=["fill-color","fill-opacity","fill-pattern"];d.GEOMETRY_LAYOUT=[new q.VertexElementDescriptor("a_pos",2,f.DataType.SHORT,0,4)];d.ATTRIBUTES_INFO={"fill-color":{name:"color",
type:x.EncodingType.R8G8B8A8_COLOR},"fill-opacity":{name:"opacity",type:x.EncodingType.R8_UNSIGNED,precisionFactor:100},"fill-pattern":{name:"tlbr",type:x.EncodingType.R16G16B16A16_PATTERN,isOptional:!0}};A=function(a){function b(l,u){l=a.call(this,l)||this;l._usefillColor=u;return l}F._inheritsLoose(b,a);var c=b.prototype;c.geometryInfo=function(){return b.GEOMETRY_LAYOUT};c.opacityInfo=function(){return null};c.attributes=function(){return this._usefillColor?b.ATTRIBUTES_FILL:b.ATTRIBUTES_OUTLINE};
c.attributesInfo=function(){return this._usefillColor?b.ATTRIBUTES_INFO_FILL:b.ATTRIBUTES_INFO_OUTLINE};return b}(A.VTLMaterial);A.ATTRIBUTES_OUTLINE=["fill-outline-color","fill-opacity"];A.ATTRIBUTES_FILL=["fill-color","fill-opacity"];A.GEOMETRY_LAYOUT=[new q.VertexElementDescriptor("a_pos",2,f.DataType.SHORT,0,8),new q.VertexElementDescriptor("a_offset",2,f.DataType.BYTE,4,8),new q.VertexElementDescriptor("a_xnormal",2,f.DataType.BYTE,6,8)];A.ATTRIBUTES_INFO_OUTLINE={"fill-outline-color":{name:"color",
type:x.EncodingType.R8G8B8A8_COLOR},"fill-opacity":{name:"opacity",type:x.EncodingType.R8_UNSIGNED,precisionFactor:100}};A.ATTRIBUTES_INFO_FILL={"fill-color":{name:"color",type:x.EncodingType.R8G8B8A8_COLOR},"fill-opacity":{name:"opacity",type:x.EncodingType.R8_UNSIGNED,precisionFactor:100}};B.VTLFillMaterial=d;B.VTLOutlineMaterial=A;Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/shaders/VTLLineMaterial":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ./enums ./VTLMaterial ../../../../webgl/enums ../../../../webgl/VertexElementDescriptor".split(" "),
function(B,F,x,A,f,q){A=function(d){function a(c){return d.call(this,c)||this}F._inheritsLoose(a,d);var b=a.prototype;b.geometryInfo=function(){return a.GEOMETRY_LAYOUT};b.opacityInfo=function(){return null};b.attributes=function(){return a.ATTRIBUTES};b.attributesInfo=function(){return a.ATTRIBUTES_INFO};return a}(A.VTLMaterial);A.ATTRIBUTES="line-blur line-color line-gap-width line-offset line-opacity line-width line-pattern line-dasharray".split(" ");A.GEOMETRY_LAYOUT=[new q.VertexElementDescriptor("a_pos",
2,f.DataType.SHORT,0,16),new q.VertexElementDescriptor("a_extrude_offset",4,f.DataType.BYTE,4,16),new q.VertexElementDescriptor("a_dir_normal",4,f.DataType.BYTE,8,16),new q.VertexElementDescriptor("a_accumulatedDistance",2,f.DataType.UNSIGNED_SHORT,12,16)];A.ATTRIBUTES_INFO={"line-width":{name:"width",type:x.EncodingType.R8_UNSIGNED,precisionFactor:2},"line-gap-width":{name:"gap_width",type:x.EncodingType.R8_UNSIGNED,precisionFactor:2},"line-offset":{name:"offset",type:x.EncodingType.R8_SIGNED,precisionFactor:2},
"line-color":{name:"color",type:x.EncodingType.R8G8B8A8_COLOR},"line-opacity":{name:"opacity",type:x.EncodingType.R8_UNSIGNED,precisionFactor:100},"line-blur":{name:"blur",type:x.EncodingType.R8_UNSIGNED,precisionFactor:4},"line-pattern":{name:"tlbr",type:x.EncodingType.R16G16B16A16_PATTERN,isOptional:!0},"line-dasharray":{name:"tlbr",type:x.EncodingType.R16G16B16A16_DASHARRAY,isOptional:!0}};B.VTLLineMaterial=A;Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/shaders/VTLSymbolMaterial":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ./enums ./VTLMaterial ../../../../webgl/enums ../../../../webgl/VertexElementDescriptor".split(" "),
function(B,F,x,A,f,q){const d=[new q.VertexElementDescriptor("a_pos",2,f.DataType.SHORT,0,16),new q.VertexElementDescriptor("a_vertexOffset",2,f.DataType.SHORT,4,16),new q.VertexElementDescriptor("a_texAngleRange",4,f.DataType.UNSIGNED_BYTE,8,16),new q.VertexElementDescriptor("a_levelInfo",4,f.DataType.UNSIGNED_BYTE,12,16)],a=[new q.VertexElementDescriptor("a_opacityInfo",1,f.DataType.UNSIGNED_BYTE,0,1)];f=function(b){function c(u){return b.call(this,u)||this}F._inheritsLoose(c,b);var l=c.prototype;
l.geometryInfo=function(){return d};l.opacityInfo=function(){return a};l.attributes=function(){return c.ATTRIBUTES};l.attributesInfo=function(){return c.ATTRIBUTES_INFO};return c}(A.VTLMaterial);f.ATTRIBUTES="icon-color icon-opacity icon-halo-blur icon-halo-color icon-halo-width icon-size".split(" ");f.ATTRIBUTES_INFO={"icon-color":{name:"color",type:x.EncodingType.R8G8B8A8_COLOR},"icon-opacity":{name:"opacity",type:x.EncodingType.R8_UNSIGNED,precisionFactor:100},"icon-halo-color":{name:"halo_color",
type:x.EncodingType.R8G8B8A8_COLOR},"icon-halo-width":{name:"halo_width",type:x.EncodingType.R8_UNSIGNED,precisionFactor:4},"icon-halo-blur":{name:"halo_blur",type:x.EncodingType.R8_UNSIGNED,precisionFactor:4},"icon-size":{name:"size",type:x.EncodingType.R8_UNSIGNED,precisionFactor:32,isLayout:!0}};A=function(b){function c(u){return b.call(this,u)||this}F._inheritsLoose(c,b);var l=c.prototype;l.geometryInfo=function(){return d};l.opacityInfo=function(){return a};l.attributes=function(){return c.ATTRIBUTES};
l.attributesInfo=function(){return c.ATTRIBUTES_INFO};return c}(A.VTLMaterial);A.ATTRIBUTES="text-color text-opacity text-halo-blur text-halo-color text-halo-width text-size".split(" ");A.ATTRIBUTES_INFO={"text-color":{name:"color",type:x.EncodingType.R8G8B8A8_COLOR},"text-opacity":{name:"opacity",type:x.EncodingType.R8_UNSIGNED,precisionFactor:100},"text-halo-color":{name:"halo_color",type:x.EncodingType.R8G8B8A8_COLOR},"text-halo-width":{name:"halo_width",type:x.EncodingType.R8_UNSIGNED,precisionFactor:4},
"text-halo-blur":{name:"halo_blur",type:x.EncodingType.R8_UNSIGNED,precisionFactor:4},"text-size":{name:"size",type:x.EncodingType.R8_UNSIGNED,isLayout:!0}};B.VTLIconMaterial=f;B.VTLTextMaterial=A;Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/style/Filter":function(){define(["../expression/expression","../expression/types"],function(B,F){return function(){function x(A){this._expression=A}x.prototype.filter=function(A,f){if(!this._expression)return!0;
try{return this._expression.evaluate(A,f)}catch(q){return console.log(q.message),!0}};x.createFilter=function(A){if(!A)return null;this.isLegacyFilter(A)&&(A=this.convertLegacyFilter(A));try{const f=B.createExpression(A,null,F.BooleanType);return new x(f)}catch(f){return console.log(f.message),null}};x.isLegacyFilter=function(A){if(!Array.isArray(A)||0===A.length)return!0;switch(A[0]){case "\x3d\x3d":case "!\x3d":case "\x3e":case "\x3c":case "\x3e\x3d":case "\x3c\x3d":return 3===A.length&&"string"===
typeof A[1]&&!Array.isArray(A[2]);case "in":return 3<=A.length&&"string"===typeof A[1]&&!Array.isArray(A[2]);case "!in":return!0;case "any":case "all":for(let f=1;f<A.length;f++)if(this.isLegacyFilter(A[f]))return!0;return!1;case "none":return!0;case "has":return 2===A.length&&("$id"===A[1]||"$type"===A[1]);case "!has":return!0;default:return!1}};x.convertLegacyFilter=function(A){if(!Array.isArray(A)||0===A.length)return!0;const f=A[0];if(1===A.length)return"any"!==f;switch(f){case "\x3d\x3d":return x.convertComparison("\x3d\x3d",
A[1],A[2]);case "!\x3d":return x.negate(x.convertComparison("\x3d\x3d",A[1],A[2]));case "\x3e":case "\x3c":case "\x3e\x3d":case "\x3c\x3d":return x.convertComparison(f,A[1],A[2]);case "in":return x.convertIn(A[1],A.slice(2));case "!in":return x.negate(x.convertIn(A[1],A.slice(2)));case "any":case "all":case "none":return x.convertCombining(f,A.slice(1));case "has":return x.convertHas(A[1]);case "!has":return x.negate(x.convertHas(A[1]));default:throw Error("Unexpected legacy filter.");}};x.convertComparison=
function(A,f,q){switch(f){case "$type":return[A,["geometry-type"],q];case "$id":return[A,["id"],q];default:return[A,["get",f],q]}};x.convertIn=function(A,f){switch(A){case "$type":return["in",["geometry-type"],["literal",f]];case "$id":return["in",["id"],["literal",f]];default:return["in",["get",A],["literal",f]]}};x.convertHas=function(A){switch(A){case "$type":return!0;case "$id":return["has-id"];default:return["has",A]}};x.convertCombining=function(A,f){return[A].concat(f.map(this.convertLegacyFilter))};
x.negate=function(A){return["!",A]};return x}()})},"esri/views/2d/engine/vectorTiles/expression/expression":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../Color ../../../../../core/colorUtils ../../../../../geometry/support/TileClipper ../../../unitBezier ../GeometryUtils ./types".split(" "),function(B,F,x,A,f,q,d,a){function b(n,e,k){var y=typeof n;if("string"===y||"boolean"===y||"number"===y||null===n){if(k)switch(k.kind){case "string":"string"!==y&&(n=
ia.toString(n));break;case "number":"number"!==y&&(n=ia.toNumber(n));break;case "color":n=ia.toColor(n)}n=["literal",n]}if(!Array.isArray(n)||0===n.length)throw Error("Expression must be a non empty array");y=n[0];if("string"!==typeof y)throw Error("First element of expression must be a string");const E=na[y];if(void 0===E)throw Error(`Invalid expression operator "${y}"`);if(!E)throw Error(`Unimplemented expression operator "${y}"`);return E.parse(n,e,k)}let c=function(){function n(k){this._parent=
k;this._vars={}}var e=n.prototype;e.add=function(k,y){this._vars[k]=y};e.get=function(k){return this._vars[k]?this._vars[k]:this._parent?this._parent.get(k):null};return n}(),l=function(){function n(){this.type=a.ValueType}n.parse=function(e){if(1<e.length)throw Error('"id" does not expect arguments');return new n};n.prototype.evaluate=function(e,k){return e?.id};return n}(),u=function(){function n(){this.type=a.StringType}n.parse=function(e){if(1<e.length)throw Error('"geometry-type" does not expect arguments');
return new n};n.prototype.evaluate=function(e,k){if(!e)return null;switch(e.type){case f.GeometryType.Point:return"Point";case f.GeometryType.LineString:return"LineString";case f.GeometryType.Polygon:return"Polygon";default:return null}};return n}(),p=function(){function n(){this.type=a.ObjectType}n.parse=function(e){if(1<e.length)throw Error('"properties" does not expect arguments');return new n};n.prototype.evaluate=function(e,k){return e?.values};return n}(),m=function(){function n(){this.type=
a.NumberType}n.parse=function(e){if(1<e.length)throw Error('"zoom" does not expect arguments');return new n};n.prototype.evaluate=function(e,k){return k};return n}(),h=function(){function n(e,k,y){this._lhs=e;this._rhs=k;this._compare=y;this.type=a.BooleanType}n.parse=function(e,k,y){if(3!==e.length&&4!==e.length)throw Error(`"${e[0]}" expects 2 or 3 arguments`);if(4===e.length)throw Error(`"${e[0]}" collator not supported`);return new n(b(e[1],k),b(e[2],k),y)};n.prototype.evaluate=function(e,k){return this._compare(this._lhs.evaluate(e,
k),this._rhs.evaluate(e,k))};return n}(),v=function(n){function e(){return n.apply(this,arguments)||this}F._inheritsLoose(e,n);e.parse=function(k,y){return h.parse(k,y,(E,I)=>E===I)};return e}(h),w=function(n){function e(){return n.apply(this,arguments)||this}F._inheritsLoose(e,n);e.parse=function(k,y){return h.parse(k,y,(E,I)=>E!==I)};return e}(h),g=function(n){function e(){return n.apply(this,arguments)||this}F._inheritsLoose(e,n);e.parse=function(k,y){return h.parse(k,y,(E,I)=>E<I)};return e}(h),
r=function(n){function e(){return n.apply(this,arguments)||this}F._inheritsLoose(e,n);e.parse=function(k,y){return h.parse(k,y,(E,I)=>E<=I)};return e}(h),D=function(n){function e(){return n.apply(this,arguments)||this}F._inheritsLoose(e,n);e.parse=function(k,y){return h.parse(k,y,(E,I)=>E>I)};return e}(h),G=function(n){function e(){return n.apply(this,arguments)||this}F._inheritsLoose(e,n);e.parse=function(k,y){return h.parse(k,y,(E,I)=>E>=I)};return e}(h),z=function(){function n(e){this._arg=e;this.type=
a.BooleanType}n.parse=function(e,k){if(2!==e.length)throw Error('"!" expects 1 argument');return new n(b(e[1],k))};n.prototype.evaluate=function(e,k){return!this._arg.evaluate(e,k)};return n}(),t=function(){function n(e){this._args=e;this.type=a.BooleanType}n.parse=function(e,k){const y=[];for(let E=1;E<e.length;E++)y.push(b(e[E],k));return new n(y)};n.prototype.evaluate=function(e,k){for(const y of this._args)if(!y.evaluate(e,k))return!1;return!0};return n}(),C=function(){function n(e){this._args=
e;this.type=a.BooleanType}n.parse=function(e,k){const y=[];for(let E=1;E<e.length;E++)y.push(b(e[E],k));return new n(y)};n.prototype.evaluate=function(e,k){for(const y of this._args)if(y.evaluate(e,k))return!0;return!1};return n}(),M=function(){function n(e){this._args=e;this.type=a.BooleanType}n.parse=function(e,k){const y=[];for(let E=1;E<e.length;E++)y.push(b(e[E],k));return new n(y)};n.prototype.evaluate=function(e,k){for(const y of this._args)if(y.evaluate(e,k))return!1;return!0};return n}(),
O=function(){function n(e,k,y){this.type=e;this._args=k;this._fallback=y}n.parse=function(e,k,y){if(4>e.length)throw Error('"case" expects at least 3 arguments');if(1===e.length%2)throw Error('"case" expects an odd number of arguments');let E;const I=[];for(let N=1;N<e.length-1;N+=2){const W=b(e[N],k),T=b(e[N+1],k,y);E||(E=T.type);I.push({condition:W,output:T})}e=b(e[e.length-1],k,y);E||(E=e.type);return new n(E,I,e)};n.prototype.evaluate=function(e,k){for(const y of this._args)if(y.condition.evaluate(e,
k))return y.output.evaluate(e,k);return this._fallback.evaluate(e,k)};return n}(),X=function(){function n(e,k){this.type=e;this._args=k}n.parse=function(e,k){if(2>e.length)throw Error('"coalesce" expects at least 1 argument');let y;const E=[];for(let I=1;I<e.length;I++){const N=b(e[I],k);y||(y=N.type);E.push(N)}return new n(y,E)};n.prototype.evaluate=function(e,k){for(const y of this._args){const E=y.evaluate(e,k);if(null!==E)return E}return null};return n}(),Q=function(){function n(e,k,y,E,I){this.type=
e;this._input=k;this._labels=y;this._outputs=E;this._fallback=I}n.parse=function(e,k){if(3>e.length)throw Error('"match" expects at least 3 arguments');if(0===e.length%2)throw Error('"case" expects an even number of arguments');let y;const E=b(e[1],k),I=[],N={};let W;for(let da=2;da<e.length-1;da+=2){var T=e[da];Array.isArray(T)||(T=[T]);for(const ja of T){T=typeof ja;if("string"!==T&&"number"!==T)throw Error('"match" requires string or number literal as labels');if(!W)W=T;else if(T!==W)throw Error('"match" requires labels to have the same type');
N[ja]=I.length}T=b(e[da+1],k);y||(y=T.type);I.push(T)}return new n(y,E,N,I,b(e[e.length-1],k))};n.prototype.evaluate=function(e,k){const y=this._input.evaluate(e,k);return(this._outputs[this._labels[y]]||this._fallback).evaluate(e,k)};return n}(),V=function(){function n(k,y,E,I,N){this._operator=k;this.type=y;this.interpolation=E;this.input=I;this._stops=N}n.parse=function(k,y,E){const I=k[0];if(5>k.length)throw Error(`"${I}" expects at least 4 arguments`);const N=k[1];if(!Array.isArray(N)||0===N.length)throw Error(`"${N}" is not a valid interpolation`);
switch(N[0]){case "linear":if(1!==N.length)throw Error("Linear interpolation cannot have parameters");break;case "exponential":if(2!==N.length||"number"!==typeof N[1])throw Error("Exponential interpolation requires one numeric argument");break;case "cubic-bezier":if(5!==N.length)throw Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1");for(var W=1;5>W;W++){var T=N[W];if("number"!==typeof T||0>T||1<T)throw Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1");
}break;default:throw Error(`"${k[0]}" unknown interpolation type "${N[0]}"`);}if(1!==k.length%2)throw Error(`"${I}" expects an even number of arguments`);W=b(k[2],y,a.NumberType);let da;"interpolate-hcl"===I||"interpolate-lab"===I?da=a.ColorType:E&&"value"!==E.kind&&(da=E);E=[];for(T=3;T<k.length;T+=2){const ja=k[T];if("number"!==typeof ja)throw Error(`"${I}" requires stop inputs as literal numbers`);if(E.length&&E[E.length-1][0]>=ja)throw Error(`"${I}" requires strictly ascending stop inputs`);const oa=
b(k[T+1],y,da);da||(da=oa.type);E.push([ja,oa])}if(da&&da!==a.ColorType&&da!==a.NumberType&&("array"!==da.kind||da.itemType!==a.NumberType))throw Error(`"${I}" cannot interpolate type ${a.typeToString(da)}`);return new n(I,da,N,W,E)};var e=n.prototype;e.evaluate=function(k,y){var E=this._stops;if(1===E.length)return E[0][1].evaluate(k,y);var I=this.input.evaluate(k,y);if(I<=E[0][0])return E[0][1].evaluate(k,y);if(I>=E[E.length-1][0])return E[E.length-1][1].evaluate(k,y);let N=0;for(;++N<E.length&&
!(I<E[N][0]););const W=n.interpolationRatio(this.interpolation,I,E[N-1][0],E[N][0]);I=E[N-1][1].evaluate(k,y);const T=E[N][1].evaluate(k,y);if("interpolate"===this._operator){if("array"===this.type.kind&&Array.isArray(I)&&Array.isArray(T))return I.map((da,ja)=>d.interpolate(da,T[ja],W));if("color"===this.type.kind&&I instanceof x&&T instanceof x)return I=new x(I),k=new x(T),new x([d.interpolate(I.r,k.r,W),d.interpolate(I.g,k.g,W),d.interpolate(I.b,k.b,W),d.interpolate(I.a,k.a,W)]);if("number"===this.type.kind&&
"number"===typeof I&&"number"===typeof T)return d.interpolate(I,T,W);throw Error(`"${this._operator}" cannot interpolate type ${a.typeToString(this.type)}`);}if("interpolate-hcl"===this._operator)return k=A.toLCH(I),y=A.toLCH(T),E=y.h-k.h,k=A.toRGB({h:k.h+W*(180<E||-180>E?E-360*Math.round(E/360):E),c:d.interpolate(k.c,y.c,W),l:d.interpolate(k.l,y.l,W)}),new x({a:d.interpolate(I.a,T.a,W),...k});if("interpolate-lab"===this._operator)return k=A.toLAB(I),y=A.toLAB(T),k=A.toRGB({l:d.interpolate(k.l,y.l,
W),a:d.interpolate(k.a,y.a,W),b:d.interpolate(k.b,y.b,W)}),new x({a:d.interpolate(I.a,T.a,W),...k});throw Error(`Unexpected operator "${this._operator}"`);};e.interpolationUniformValue=function(k,y){const E=this._stops;if(1===E.length||k>=E[E.length-1][0])return 0;let I=0;for(;++I<E.length&&!(k<E[I][0]););return n.interpolationRatio(this.interpolation,y,E[I-1][0],E[I][0])};e.getInterpolationRange=function(k){const y=this._stops;if(1===y.length)return k=y[0][0],[k,k];var E=y[y.length-1][0];if(k>=E)return[E,
E];for(E=0;++E<y.length&&!(k<y[E][0]););return[y[E-1][0],y[E][0]]};n.interpolationRatio=function(k,y,E,I){let N=0;"linear"===k[0]?N=n._exponentialInterpolationRatio(y,1,E,I):"exponential"===k[0]?N=n._exponentialInterpolationRatio(y,k[1],E,I):"cubic-bezier"===k[0]&&(N=q.unitBezier(k[1],k[2],k[3],k[4])(n._exponentialInterpolationRatio(y,1,E,I),1E-5));0>N?N=0:1<N&&(N=1);return N};n._exponentialInterpolationRatio=function(k,y,E,I){I-=E;if(0===I)return 0;k-=E;return 1===y?k/I:(y**k-1)/(y**I-1)};return n}(),
P=function(){function n(e,k,y){this.type=e;this._input=k;this._stops=y}n.parse=function(e,k){if(5>e.length)throw Error('"step" expects at least 4 arguments');if(1!==e.length%2)throw Error('"step" expects an even number of arguments');const y=b(e[1],k,a.NumberType);let E;const I=[];I.push([-Infinity,b(e[2],k)]);for(let N=3;N<e.length;N+=2){const W=e[N];if("number"!==typeof W)throw Error('"step" requires stop inputs as literal numbers');if(I.length&&I[I.length-1][0]>=W)throw Error('"step" requires strictly ascending stop inputs');
const T=b(e[N+1],k);E||(E=T.type);I.push([W,T])}return new n(E,y,I)};n.prototype.evaluate=function(e,k){const y=this._stops;if(1===y.length)return y[0][1].evaluate(e,k);const E=this._input.evaluate(e,k);let I=0;for(;++I<y.length&&!(E<y[I][0]););return this._stops[I-1][1].evaluate(e,k)};return n}(),L=function(){function n(e,k){this.type=e;this._output=k}n.parse=function(e,k,y){if(4>e.length)throw Error('"let" expects at least 3 arguments');if(1===e.length%2)throw Error('"let" expects an odd number of arguments');
const E=new c(k);for(let I=1;I<e.length-1;I+=2){const N=e[I];if("string"!==typeof N)throw Error(`"let" requires a string to define variable names - found ${N}`);E.add(N,b(e[I+1],k))}e=b(e[e.length-1],E,y);return new n(e.type,e)};n.prototype.evaluate=function(e,k){return this._output.evaluate(e,k)};return n}(),K=function(){function n(e,k){this.type=e;this.output=k}n.parse=function(e,k,y){if(2!==e.length||"string"!==typeof e[1])throw Error('"var" requires just one literal string argument');k=k.get(e[1]);
if(!k)throw Error(`${e[1]} must be defined before being used in a "var" expression`);return new n(y||a.ValueType,k)};n.prototype.evaluate=function(e,k){return this.output.evaluate(e,k)};return n}(),H=function(){function n(e,k,y){this.type=e;this._index=k;this._array=y}n.parse=function(e,k){if(3!==e.length)throw Error('"at" expects 2 arguments');const y=b(e[1],k,a.NumberType);e=b(e[2],k);return new n(e.type.itemType,y,e)};n.prototype.evaluate=function(e,k){const y=this._index.evaluate(e,k);e=this._array.evaluate(e,
k);if(0>y||y>=e.length)throw Error('"at" index out of bounds');if(y!==Math.floor(y))throw Error('"at" index must be an integer');return e[y]};return n}(),J=function(){function n(e,k){this._key=e;this._obj=k;this.type=a.ValueType}n.parse=function(e,k){let y;switch(e.length){case 2:return y=b(e[1],k),new n(y);case 3:return y=b(e[1],k),e=b(e[2],k),new n(y,e);default:throw Error('"get" expects 1 or 2 arguments');}};n.prototype.evaluate=function(e,k){const y=this._key.evaluate(e,k);return this._obj?this._obj.evaluate(e,
k)[y]:e?.values[y]};return n}(),S=function(){function n(e,k){this._key=e;this._obj=k;this.type=a.BooleanType}n.parse=function(e,k){let y;switch(e.length){case 2:return y=b(e[1],k),new n(y);case 3:return y=b(e[1],k),e=b(e[2],k),new n(y,e);default:throw Error('"has" expects 1 or 2 arguments');}};n.prototype.evaluate=function(e,k){const y=this._key.evaluate(e,k);return this._obj?(e=this._obj.evaluate(e,k),y in e):!!e?.values[y]};return n}(),R=function(){function n(e,k){this._key=e;this._vals=k;this.type=
a.BooleanType}n.parse=function(e,k){if(3!==e.length)throw Error('"in" expects 2 arguments');return new n(b(e[1],k),b(e[2],k))};n.prototype.evaluate=function(e,k){const y=this._key.evaluate(e,k);return this._vals.evaluate(e,k).includes(y)};return n}(),ba=function(){function n(e,k,y){this._item=e;this._array=k;this._from=y;this.type=a.NumberType}n.parse=function(e,k){if(3>e.length||4<e.length)throw Error('"index-of" expects 3 or 4 arguments');const y=b(e[1],k),E=b(e[2],k);return 4===e.length?(e=b(e[3],
k,a.NumberType),new n(y,E,e)):new n(y,E)};n.prototype.evaluate=function(e,k){const y=this._item.evaluate(e,k),E=this._array.evaluate(e,k);if(this._from){e=this._from.evaluate(e,k);if(e!==Math.floor(e))throw Error('"index-of" index must be an integer');return E.indexOf(y,e)}return E.indexOf(y)};return n}(),Z=function(){function n(e){this._arg=e;this.type=a.NumberType}n.parse=function(e,k){if(2!==e.length)throw Error('"length" expects 2 arguments');e=b(e[1],k);return new n(e)};n.prototype.evaluate=
function(e,k){e=this._arg.evaluate(e,k);if("string"===typeof e||Array.isArray(e))return e.length;throw Error('"length" expects string or array');};return n}(),Y=function(){function n(e,k,y,E){this.type=e;this._array=k;this._from=y;this._to=E}n.parse=function(e,k){if(3>e.length||4<e.length)throw Error('"slice" expects 2 or 3 arguments');const y=b(e[1],k),E=b(e[2],k,a.NumberType);if(E.type!==a.NumberType)throw Error('"slice" index must return a number');if(4===e.length){e=b(e[3],k,a.NumberType);if(e.type!==
a.NumberType)throw Error('"slice" index must return a number');return new n(y.type,y,E,e)}return new n(y.type,y,E)};n.prototype.evaluate=function(e,k){const y=this._array.evaluate(e,k);if(!Array.isArray(y)&&"string"!==typeof y)throw Error('"slice" input must be an array or a string');const E=this._from.evaluate(e,k);if(0>E||E>=y.length)throw Error('"slice" index out of bounds');if(E!==Math.floor(E))throw Error('"slice" index must be an integer');if(this._to){e=this._to.evaluate(e,k);if(0>e||e>=y.length)throw Error('"slice" index out of bounds');
if(e!==Math.floor(e))throw Error('"slice" index must be an integer');return y.slice(E,e)}return y.slice(E)};return n}(),ea=function(){function n(){this.type=a.BooleanType}n.parse=function(e){if(1!==e.length)throw Error('"has-id" expects no arguments');return new n};n.prototype.evaluate=function(e,k){return e&&void 0!==e.id};return n}(),U=function(){function n(e,k){this._args=e;this._calculate=k;this.type=a.NumberType}n.parse=function(e,k,y){e=e.slice(1).map(E=>b(E,k));return new n(e,y)};n.prototype.evaluate=
function(e,k){let y;this._args&&(y=this._args.map(E=>E.evaluate(e,k)));return this._calculate(y)};return n}(),aa=function(n){function e(){return n.apply(this,arguments)||this}F._inheritsLoose(e,n);e.parse=function(k,y){switch(k.length){case 2:return U.parse(k,y,E=>-E[0]);case 3:return U.parse(k,y,E=>E[0]-E[1]);default:throw Error('"-" expects 1 or 2 arguments');}};return e}(U),fa=function(n){function e(){return n.apply(this,arguments)||this}F._inheritsLoose(e,n);e.parse=function(k,y){return U.parse(k,
y,E=>{let I=1;for(const N of E)I*=N;return I})};return e}(U),ha=function(n){function e(){return n.apply(this,arguments)||this}F._inheritsLoose(e,n);e.parse=function(k,y){if(3===k.length)return U.parse(k,y,E=>E[0]/E[1]);throw Error('"/" expects 2 arguments');};return e}(U),ka=function(n){function e(){return n.apply(this,arguments)||this}F._inheritsLoose(e,n);e.parse=function(k,y){if(3===k.length)return U.parse(k,y,E=>E[0]%E[1]);throw Error('"%" expects 2 arguments');};return e}(U),pa=function(n){function e(){return n.apply(this,
arguments)||this}F._inheritsLoose(e,n);e.parse=function(k,y){if(3===k.length)return U.parse(k,y,E=>E[0]**E[1]);throw Error('"^" expects 1 or 2 arguments');};return e}(U),qa=function(n){function e(){return n.apply(this,arguments)||this}F._inheritsLoose(e,n);e.parse=function(k,y){return U.parse(k,y,E=>{let I=0;for(const N of E)I+=N;return I})};return e}(U),ca=function(){function n(e,k){this._args=e;this._calculate=k;this.type=a.NumberType}n.parse=function(e,k){const y=e.slice(1).map(E=>b(E,k));return new n(y,
n.ops[e[0]])};n.prototype.evaluate=function(e,k){let y;this._args&&(y=this._args.map(E=>E.evaluate(e,k)));return this._calculate(y)};return n}();ca.ops={abs:n=>Math.abs(n[0]),acos:n=>Math.acos(n[0]),asin:n=>Math.asin(n[0]),atan:n=>Math.atan(n[0]),ceil:n=>Math.ceil(n[0]),cos:n=>Math.cos(n[0]),e:()=>Math.E,floor:n=>Math.floor(n[0]),ln:n=>Math.log(n[0]),ln2:()=>Math.LN2,log10:n=>Math.log(n[0])/Math.LN10,log2:n=>Math.log(n[0])/Math.LN2,max:n=>Math.max(...n),min:n=>Math.min(...n),pi:()=>Math.PI,round:n=>
Math.round(n[0]),sin:n=>Math.sin(n[0]),sqrt:n=>Math.sqrt(n[0]),tan:n=>Math.tan(n[0])};let ra=function(){function n(e){this._args=e;this.type=a.StringType}n.parse=function(e,k){return new n(e.slice(1).map(y=>b(y,k)))};n.prototype.evaluate=function(e,k){return this._args.map(y=>y.evaluate(e,k)).join("")};return n}(),ma=function(){function n(e,k){this._arg=e;this._calculate=k;this.type=a.StringType}n.parse=function(e,k){if(2!==e.length)throw Error(`${e[0]} expects 1 argument`);k=b(e[1],k);return new n(k,
n.ops[e[0]])};n.prototype.evaluate=function(e,k){return this._calculate(this._arg.evaluate(e,k))};return n}();ma.ops={downcase:n=>n.toLowerCase(),upcase:n=>n.toUpperCase()};let sa=function(){function n(k){this._args=k;this.type=a.ColorType}n.parse=function(k,y){if(4!==k.length)throw Error('"rgb" expects 3 arguments');k=k.slice(1).map(E=>b(E,y));return new n(k)};var e=n.prototype;e.evaluate=function(k,y){const E=this._validate(this._args[0].evaluate(k,y)),I=this._validate(this._args[1].evaluate(k,
y));k=this._validate(this._args[2].evaluate(k,y));return new x({r:E,g:I,b:k})};e._validate=function(k){if("number"!==typeof k||0>k||255<k)throw Error(`${k}: invalid color component`);return Math.round(k)};return n}(),ta=function(){function n(k){this._args=k;this.type=a.ColorType}n.parse=function(k,y){if(5!==k.length)throw Error('"rgba" expects 4 arguments');k=k.slice(1).map(E=>b(E,y));return new n(k)};var e=n.prototype;e.evaluate=function(k,y){const E=this._validate(this._args[0].evaluate(k,y)),I=
this._validate(this._args[1].evaluate(k,y)),N=this._validate(this._args[2].evaluate(k,y));k=this._validateAlpha(this._args[3].evaluate(k,y));return new x({r:E,g:I,b:N,a:k})};e._validate=function(k){if("number"!==typeof k||0>k||255<k)throw Error(`${k}: invalid color component`);return Math.round(k)};e._validateAlpha=function(k){if("number"!==typeof k||0>k||1<k)throw Error(`${k}: invalid alpha color component`);return k};return n}(),ua=function(){function n(e){this._color=e;this.type=a.arrayType(a.NumberType,
4)}n.parse=function(e,k){if(2!==e.length)throw Error('"to-rgba" expects 1 argument');e=b(e[1],k);return new n(e)};n.prototype.evaluate=function(e,k){return(new x(this._color.evaluate(e,k))).toRgba()};return n}(),la=function(){function n(e,k){this.type=e;this._args=k}n.parse=function(e,k){var y=e[0];if(2>e.length)throw Error(`${y} expects at least one argument`);let E=1,I;if("array"===y){if(2<e.length){switch(e[1]){case "string":I=a.StringType;break;case "number":I=a.NumberType;break;case "boolean":I=
a.BooleanType;break;default:throw Error('"array" type argument must be string, number or boolean');}E++}else I=a.ValueType;if(3<e.length){var N=e[2];if(null!==N&&("number"!==typeof N||0>N||N!==Math.floor(N)))throw Error('"array" length argument must be a positive integer literal');E++}I=a.arrayType(I,N)}else switch(y){case "string":I=a.StringType;break;case "number":I=a.NumberType;break;case "boolean":I=a.BooleanType;break;case "object":I=a.ObjectType}for(y=[];E<e.length;E++)N=b(e[E],k),y.push(N);
return new n(I,y)};n.prototype.evaluate=function(e,k){let y;for(const E of this._args){const I=E.evaluate(e,k);y=a.getType(I);if(a.matchType(y,this.type))return I}throw Error(`Expected ${a.typeToString(this.type)} but got ${a.typeToString(y)}`);};return n}(),ia=function(){function n(e,k){this.type=e;this._args=k}n.parse=function(e,k){var y=e[0];const E=n.types[y];if(E===a.BooleanType||E===a.StringType){if(2!==e.length)throw Error(`${y} expects one argument`);}else if(2>e.length)throw Error(`${y} expects at least one argument`);
y=[];for(let I=1;I<e.length;I++){const N=b(e[I],k);y.push(N)}return new n(E,y)};n.prototype.evaluate=function(e,k){if(this.type===a.BooleanType)return!!this._args[0].evaluate(e,k);if(this.type===a.StringType)return a.valueToString(this._args[0].evaluate(e,k));if(this.type===a.NumberType){for(const E of this._args){var y=Number(E.evaluate(e,k));if(!isNaN(y))return y}return null}if(this.type===a.ColorType){for(y of this._args)try{const E=n.toColor(y.evaluate(e,k));if(E instanceof x)return E}catch{}return null}};
n.toBoolean=function(e){return!!e};n.toString=function(e){return a.valueToString(e)};n.toNumber=function(e){const k=Number(e);if(isNaN(k))throw Error(`"${e}" is not a number`);return k};n.toColor=function(e){if(e instanceof x)return e;if("string"===typeof e){const k=x.fromString(e);if(k)return k;throw Error(`"${e}" is not a color`);}if(Array.isArray(e))return x.fromArray(e);throw Error(`"${e}" is not a color`);};return n}();ia.types={"to-boolean":a.BooleanType,"to-color":a.ColorType,"to-number":a.NumberType,
"to-string":a.StringType};let va=function(){function n(e){this._val=e;this.type=a.getType(e)}n.parse=function(e){if(2!==e.length)throw Error('"literal" expects 1 argument');return new n(e[1])};n.prototype.evaluate=function(e,k){return this._val};return n}(),wa=function(){function n(e){this._arg=e;this.type=a.StringType}n.parse=function(e,k){if(2!==e.length)throw Error('"typeof" expects 1 argument');return new n(b(e[1],k))};n.prototype.evaluate=function(e,k){return a.typeToString(a.getType(this._arg.evaluate(e,
k)))};return n}();const na={array:la,boolean:la,collator:null,format:null,image:null,literal:va,number:la,"number-format":null,object:la,string:la,"to-boolean":ia,"to-color":ia,"to-number":ia,"to-string":ia,typeof:wa,accumulated:null,"feature-state":null,"geometry-type":u,id:l,"line-progress":null,properties:p,at:H,get:J,has:S,in:R,"index-of":ba,length:Z,slice:Y,"!":z,"!\x3d":w,"\x3c":g,"\x3c\x3d":r,"\x3d\x3d":v,"\x3e":D,"\x3e\x3d":G,all:t,any:C,case:O,coalesce:X,match:Q,within:null,interpolate:V,
"interpolate-hcl":V,"interpolate-lab":V,step:P,let:L,var:K,concat:ra,downcase:ma,"is-supported-script":null,"resolved-locale":null,upcase:ma,rgb:sa,rgba:ta,"to-rgba":ua,"-":aa,"*":fa,"/":ha,"%":ka,"^":pa,"+":qa,abs:ca,acos:ca,asin:ca,atan:ca,ceil:ca,cos:ca,e:ca,floor:ca,ln:ca,ln2:ca,log10:ca,log2:ca,max:ca,min:ca,pi:ca,round:ca,sin:ca,sqrt:ca,tan:ca,zoom:m,"heatmap-density":null,"has-id":ea,none:M};B.ALL=t;B.ANY=C;B.Add=qa;B.Assert=la;B.At=H;B.Calculate=ca;B.Case=O;B.Coalesce=X;B.Coerce=ia;B.Concat=
ra;B.Div=ha;B.EQ=v;B.GE=G;B.GT=D;B.GeomType=u;B.Get=J;B.Has=S;B.HasID=ea;B.ID=l;B.In=R;B.IndexOf=ba;B.Interpolate=V;B.LE=r;B.LT=g;B.Length=Z;B.Let=L;B.Literal=va;B.Match=Q;B.Mod=ka;B.Mul=fa;B.NE=w;B.NONE=M;B.NOT=z;B.Pow=pa;B.Properties=p;B.Rgb=sa;B.Rgba=ta;B.Slice=Y;B.Step=P;B.String=ma;B.Sub=aa;B.ToRgba=ua;B.TypeOf=wa;B.Var=K;B.Zoom=m;B.createExpression=b;B.ops=na;Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/expression/types":function(){define(["exports",
"../../../../../Color"],function(B,F){function x(h,v){return{kind:"array",itemType:h,n:v}}function A(h){if("array"===h.kind){const v=A(h.itemType);return"number"===typeof h.n?`array<${v}, ${h.n}>`:"value"===h.itemType.kind?"array":`array<${v}>`}return h.kind}function f(h){if(null===h)return d;if("string"===typeof h)return b;if("boolean"===typeof h)return c;if("number"===typeof h)return a;if(h instanceof F)return l;if(Array.isArray(h)){let v;for(const w of h){const g=f(w);if(!v)v=g;else if(v!==g){v=
p;break}}return x(v||p,h.length)}return"object"===typeof h?u:p}function q(h,v){if("array"===v.kind)return"array"===h.kind&&(0===h.n&&"value"===h.itemType.kind||q(h.itemType,v.itemType))&&("number"!==typeof v.n||v.n===h.n);if("value"===v.kind)for(const w of m)if(q(h,w))return!0;return v.kind===h.kind}const d={kind:"null"},a={kind:"number"},b={kind:"string"},c={kind:"boolean"},l={kind:"color"},u={kind:"object"},p={kind:"value"},m=[d,a,b,c,l,u,x(p)];B.BooleanType=c;B.ColorType=l;B.NullType=d;B.NumberType=
a;B.ObjectType=u;B.StringType=b;B.ValueType=p;B.arrayType=x;B.getType=f;B.matchType=q;B.typeToString=A;B.valueToString=function(h){if(null===h)return"";const v=typeof h;return"string"===v?h:"number"===v||"boolean"===v?String(h):h instanceof F?h.toString():JSON.stringify(h)};Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/style/StyleProperty":function(){define(["../../../../../Color","../GeometryUtils","../expression/expression","../expression/types"],
function(B,F,x,A){return function(){function f(d,a){this.isDataDriven=!1;this.interpolator=null;switch(d.type){case "number":var b=!0;break;case "color":b=!0;break;case "array":b="number"===d.value;break;default:b=!1}null==a&&(a=d.default);if(Array.isArray(a)&&0<a.length&&x.ops[a[0]]){b={number:A.NumberType,color:A.ColorType,string:A.StringType,boolean:A.BooleanType,enum:A.StringType};try{var c="array"===d.type?A.arrayType(b[d.value]||A.ValueType,d.length):b[d.type];const l=x.createExpression(a,null,
c);this.getValue=this._buildExpression(l,d);this.isDataDriven=!0;l instanceof x.Interpolate&&l.input instanceof x.Zoom&&(this.interpolator=l)}catch(l){console.log(l.message),this.getValue=this._buildSimple(d.default)}}else{b&&"interval"===a.type&&(b=!1);if(c=a&&a.stops&&0<a.stops.length)for(const l of a.stops)l[1]=this._validate(l[1],d);if(this.isDataDriven=a?!!a.property:!1)if(void 0!==a.default&&(a.default=this._validate(a.default,d)),c)switch(a.type){case "identity":this.getValue=this._buildIdentity(a,
d);break;case "categorical":this.getValue=this._buildCategorical(a,d);break;default:this.getValue=b?this._buildInterpolate(a,d):this._buildInterval(a,d)}else this.getValue=this._buildIdentity(a,d);else c?this.getValue=b?this._buildZoomInterpolate(a):this._buildZoomInterval(a):(a=this._validate(a,d),this.getValue=this._buildSimple(a))}}var q=f.prototype;q._validate=function(d,a){if("number"===a.type){if(d<a.minimum)return a.minimum;if(d>a.maximum)return a.maximum}else"color"===a.type?d=f._parseColor(d):
"enum"===a.type?"string"===typeof d&&(d=a.values.indexOf(d)):"array"===a.type&&"enum"===a.value?d=d.map(b=>"string"===typeof b?a.values.indexOf(b):b):"string"===a.type&&(d=A.valueToString(d));return d};q._buildSimple=function(d){return()=>d};q._buildExpression=function(d,a){return(b,c)=>{try{const l=d.evaluate(c,b);return void 0===l?a.default:this._validate(l,a)}catch(l){return console.log(l.message),a.default}}};q._buildIdentity=function(d,a){return(b,c)=>{let l;c&&(l=c.values[d.property]);void 0!==
l&&(l=this._validate(l,a));return null!=l?l:void 0!==d.default?d.default:a.default}};q._buildCategorical=function(d,a){return(b,c)=>{let l;c&&(l=c.values[d.property]);l=this._categorical(l,d.stops);return void 0!==l?l:void 0!==d.default?d.default:a.default}};q._buildInterval=function(d,a){return(b,c)=>{let l;c&&(l=c.values[d.property]);return"number"===typeof l?this._interval(l,d.stops):void 0!==d.default?d.default:a.default}};q._buildInterpolate=function(d,a){return(b,c)=>{let l;c&&(l=c.values[d.property]);
return"number"===typeof l?this._interpolate(l,d.stops,d.base||1):void 0!==d.default?d.default:a.default}};q._buildZoomInterpolate=function(d){return a=>this._interpolate(a,d.stops,d.base||1)};q._buildZoomInterval=function(d){return a=>this._interval(a,d.stops)};q._categorical=function(d,a){const b=a.length;for(let c=0;c<b;c++)if(a[c][0]===d)return a[c][1]};q._interval=function(d,a){const b=a.length;let c=0;for(let l=0;l<b;l++)if(a[l][0]<=d)c=l;else break;return a[c][1]};q._interpolate=function(d,
a,b){const c=a.length;for(let p=0;p<c;p++){const m=a[p];if(m[0]<=d)var l=m;else{var u=m;break}}if(l&&u){a=u[0]-l[0];d-=l[0];b=1===b?d/a:(b**d-1)/(b**a-1);if(Array.isArray(l[1])){l=l[1];u=u[1];d=[];for(a=0;a<l.length;a++)d.push(F.interpolate(l[a],u[a],b));return d}return F.interpolate(l[1],u[1],b)}if(l)return l[1];if(u)return u[1]};f._isEmpty=function(d){for(const a in d)if(d.hasOwnProperty(a))return!1;return!0};f._parseColor=function(d){if(Array.isArray(d))return d;"string"===typeof d&&(d=new B(d));
if(d instanceof B&&!this._isEmpty(d))return B.toUnitRGBA(d)};return f}()})},"esri/views/2d/layers/LayerView2D":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Collection ../../../core/collectionUtils ../../../core/Error ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ../engine/Container ../support/HighlightOptions ../../layers/support/ClipRect ../../layers/support/Geometry ../../layers/support/Path".split(" "),
function(B,F,x,A,f,q,d,a,b,c,l,u,p,m,h,v){const w=A.ofType({key:"type",base:null,typeMap:{rect:m,path:v,geometry:h}});B.LayerView2DMixin=g=>{g=function(r){function D(){var z=r.apply(this,arguments)||this;z.attached=!1;z.clips=new w;z.lastUpdateId=-1;z.moving=!1;z.updateRequested=!1;z.visibleAtCurrentScale=!1;z.highlightOptions=null;return z}F._inheritsLoose(D,r);var G=D.prototype;G.initialize=function(){const z=this.view?.spatialReferenceLocked??!0;this.view?.spatialReference&&z&&!this.spatialReferenceSupported?
this.addResolvingPromise(Promise.reject(new q("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",{layer:this.layer}))):(this.container||(this.container=new u.Container),this.container.fadeTransitionEnabled=!0,this.container.visible=!1,this.container.endTransitions(),this.addHandles([d.watch(()=>this.suspended,t=>{this.container&&(this.container.visible=!t);this.view&&!t&&this.updateRequested&&this.view.requestUpdate()},d.syncAndInitial),
d.watch(()=>this.layer?.opacity??1,t=>{this.container&&(this.container.opacity=t)},d.syncAndInitial),d.watch(()=>this.layer&&"blendMode"in this.layer?this.layer.blendMode:"normal",t=>{this.container&&(this.container.blendMode=t)},d.syncAndInitial),d.watch(()=>this.layer&&"effect"in this.layer?this.layer.effect:null,t=>{this.container&&(this.container.effect=t)},d.syncAndInitial),d.watch(()=>this.highlightOptions,t=>this.container.highlightOptions=t,d.syncAndInitial),d.on(()=>this.clips,"change",()=>
{this.container&&(this.container.clips=this.clips)},d.syncAndInitial),d.watch(()=>({scale:this.view?.scale,scaleRange:this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null}),({scale:t})=>{t=null!=t?this.isVisibleAtScale(t):!1;t!==this.visibleAtCurrentScale&&this._set("visibleAtCurrentScale",t)},d.syncAndInitial)],"constructor"),this.view?.whenLayerView?this.view.whenLayerView(this.layer).then(t=>{t===this&&this.processAttach()},()=>{}):this.when().then(()=>{this.processAttach()},
()=>{}))};G.destroy=function(){this.processDetach();this.updateRequested=!1};G.processAttach=function(){this.isResolved()&&!this.attached&&!this.destroyed&&this.spatialReferenceSupported&&(this.attach(),this.attached=!0,this.requestUpdate())};G.processDetach=function(){this.attached&&(this.attached=!1,this.removeHandles("attach"),this.detach(),this.updateRequested=!1)};G.isVisibleAtScale=function(z){const t=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;if(!t)return!0;
const {minScale:C,maxScale:M}=t;return(0===C||z<=C)&&(0===M||z>=M)};G.requestUpdate=function(){this.destroyed||this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestUpdate())};G.processUpdate=function(z){this.isFulfilled()&&!this.isResolved()?this.updateRequested=!1:(this._set("updateParameters",z),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(z)))};G.hitTest=function(z,t){return Promise.resolve(null)};G.supportsSpatialReference=function(z){return!0};
G.canResume=function(){return this.spatialReferenceSupported?r.prototype.canResume.call(this)?this.visibleAtCurrentScale:!1:!1};G.getSuspendInfo=function(){const z=r.prototype.getSuspendInfo.call(this),t=!this.spatialReferenceSupported,C=this.visibleAtCurrentScale;t&&(z.spatialReferenceNotSupported=t);C&&(z.outsideScaleRange=C);return z};G.addAttachHandles=function(z){this.addHandles(z,"attach")};F._createClass(D,[{key:"spatialReferenceSupported",get:function(){const z=this.view?.spatialReference;
return null==z||this.supportsSpatialReference(z)}},{key:"updating",get:function(){return this.spatialReferenceSupported&&(!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())||!!this.updatingHandles?.updating)}}]);return D}(g);x.__decorate([a.property()],g.prototype,"attached",void 0);x.__decorate([a.property({type:w,set(r){r=f.referenceSetter(r,this._get("clips"),w);this._set("clips",r)}})],g.prototype,"clips",void 0);x.__decorate([a.property()],g.prototype,"container",void 0);
x.__decorate([a.property()],g.prototype,"moving",void 0);x.__decorate([a.property({readOnly:!0})],g.prototype,"spatialReferenceSupported",null);x.__decorate([a.property({readOnly:!0})],g.prototype,"updateParameters",void 0);x.__decorate([a.property()],g.prototype,"updateRequested",void 0);x.__decorate([a.property()],g.prototype,"updating",null);x.__decorate([a.property()],g.prototype,"view",void 0);x.__decorate([a.property({readOnly:!0})],g.prototype,"visibleAtCurrentScale",void 0);x.__decorate([a.property({type:p})],
g.prototype,"highlightOptions",void 0);return g=x.__decorate([l.subclass("esri.views.2d.layers.LayerView2D")],g)};Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/views/layers/support/ClipRect":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ./ClipArea".split(" "),function(B,
F,x,A,f,q,d){var a;A=a=function(b){function c(u){u=b.call(this,u)||this;u.type="rect";u.left=null;u.right=null;u.top=null;u.bottom=null;return u}B._inheritsLoose(c,b);var l=c.prototype;l.clone=function(){return new a({left:this.left,right:this.right,top:this.top,bottom:this.bottom})};l.commitVersionProperties=function(){this.commitProperty("left");this.commitProperty("right");this.commitProperty("top");this.commitProperty("bottom")};return c}(d);F.__decorate([x.property({type:[Number,String],json:{write:!0}})],
A.prototype,"left",void 0);F.__decorate([x.property({type:[Number,String],json:{write:!0}})],A.prototype,"right",void 0);F.__decorate([x.property({type:[Number,String],json:{write:!0}})],A.prototype,"top",void 0);F.__decorate([x.property({type:[Number,String],json:{write:!0}})],A.prototype,"bottom",void 0);return A=a=F.__decorate([q.subclass("esri.views.layers.support.ClipRect")],A)})},"esri/views/layers/support/ClipArea":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass".split(" "),
function(B,F,x,A,f,q,d){x=function(a){function b(){return a.apply(this,arguments)||this}B._inheritsLoose(b,a);B._createClass(b,[{key:"version",get:function(){this.commitVersionProperties();return(this._get("version")||0)+1}}]);return b}(x.JSONSupport);F.__decorate([A.property({readOnly:!0})],x.prototype,"version",null);return x=F.__decorate([d.subclass("esri.views.layers.support.ClipArea")],x)})},"esri/views/layers/support/Geometry":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ../../../geometry/Geometry ../../../geometry/support/jsonUtils ./ClipArea ../../../geometry/Extent ../../../geometry/Polygon".split(" "),
function(B,F,x,A,f,q,d,a,b,c,l,u){var p;x={base:a,key:"type",typeMap:{extent:l,polygon:u}};c=p=function(m){function h(w){w=m.call(this,w)||this;w.type="geometry";w.geometry=null;return w}B._inheritsLoose(h,m);var v=h.prototype;v.clone=function(){return new p({geometry:this.geometry?.clone()??null})};v.commitVersionProperties=function(){this.commitProperty("geometry")};return h}(c);F.__decorate([A.property({types:x,json:{read:b.fromJSON,write:!0}})],c.prototype,"geometry",void 0);return c=p=F.__decorate([d.subclass("esri.views.layers.support.Geometry")],
c)})},"esri/views/layers/support/Path":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ./ClipArea".split(" "),function(B,F,x,A,f,q,d){A=function(a){function b(c){c=a.call(this,c)||this;c.type="path";c.path=[];return c}B._inheritsLoose(b,a);b.prototype.commitVersionProperties=function(){this.commitProperty("path")};
return b}(d);F.__decorate([x.property({type:[[[Number]]],json:{write:!0}})],A.prototype,"path",void 0);return A=F.__decorate([q.subclass("esri.views.layers.support.Path")],A)})},"esri/views/2d/layers/support/DebugOverlay":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../chunks/mat3 ../../../../chunks/mat3f32 ../../../webgl/BufferObject ../../../webgl/FramebufferObject ../../../../core/arrayUtils ../../../../core/has ../../../webgl/checkWebGLError ../../../webgl/context-util ../../../webgl/enums ../../../../chunks/builtins ../../../webgl/Texture ../../../webgl/VertexArrayObject ../../engine/DisplayObject ../../../webgl/VertexElementDescriptor".split(" "),
function(B,F,x,A,f,q,d,a,b,c,l,u,p,m,h,v){const w={geometry:[new v.VertexElementDescriptor("a_PositionAndFlags",3,l.DataType.SHORT,0,6)]},g=new Map;g.set("a_PositionAndFlags",0);const r={vsPath:"debug/overlay",fsPath:"debug/overlay",attributes:g};return function(D){function G(t){var C=D.call(this)||this;C._conf=t;return C}B._inheritsLoose(G,D);G.makeFlags=function(t,C){return t|C<<2};var z=G.prototype;z._createTransforms=function(){return{dvs:A.create()}};z.doRender=function(t){this._updateTransforms(t);
this._ensureResources(t);const {context:C}=t;C.useProgram(this._program);this._program.setUniformMatrix3fv("u_dvsMat3",this.transforms.dvs);this._program.setUniform4fv("u_colors",this._conf.getColors(t));this._program.setUniform1fv("u_opacities",this._conf.getOpacities(t));const {vertexData:M,indexData:O}=this._conf.getMesh(t);this._vertexBuffer.setData(M);this._indexBuffer.setData(O);C.bindVAO(this._vertexArray);C.setBlendingEnabled(!0);C.setBlendFunction(l.BlendFactor.ONE,l.BlendFactor.ONE_MINUS_SRC_ALPHA);
C.setDepthTestEnabled(!1);C.setStencilTestEnabled(!1);C.setColorMask(!0,!0,!0,!0);C.drawElements(l.PrimitiveType.TRIANGLES,O.length,l.DataType.UNSIGNED_INT,0)};z.onDetach=function(){this._vertexArray=F.disposeMaybe(this._vertexArray)};z._updateTransforms=function(t){x.identity(this.transforms.dvs);x.translate(this.transforms.dvs,this.transforms.dvs,[-1,1]);x.scale(this.transforms.dvs,this.transforms.dvs,[2/t.state.size[0],-2/t.state.size[1],1])};z._ensureResources=function(t){const {context:C}=t;
this._program||(this._program=t.painter.materialManager.getProgram(r));this._vertexBuffer||(this._vertexBuffer=f.BufferObject.createVertex(C,l.Usage.STREAM_DRAW));this._indexBuffer||(this._indexBuffer=f.BufferObject.createIndex(C,l.Usage.STREAM_DRAW));this._vertexArray||(this._vertexArray=new m.VertexArrayObject(C,g,w,{geometry:this._vertexBuffer},this._indexBuffer))};return G}(h.DisplayObject)})},"esri/views/2d/tiling/TileInfoViewPOT":function(){define(["../../../chunks/_rollupPluginBabelHelpers",
"../../../layers/support/TileInfo","./TileInfoView","./TileKey"],function(B,F,x,A){return function(f){function q(){var a=f.apply(this,arguments)||this;a._fullCacheLodInfos=null;a._levelByScale={};return a}B._inheritsLoose(q,f);var d=q.prototype;d.getTileParentId=function(a){a=A.pool.acquire(a);const b=0===a.level?null:A.getId(a.level-1,a.row>>1,a.col>>1,a.world);A.pool.release(a);return b};d.getTileCoverage=function(a,b,c){a=f.prototype.getTileCoverage.call(this,a,b,c);if(!a)return a;const l=1<<a.lodInfo.level;
a.spans=a.spans.filter(u=>0<=u.row&&u.row<l);return a};d.scaleToLevel=function(a){this._fullCacheLodInfos||this._initializeFullCacheLODs(this._lodInfos);if(this._levelByScale[a])return this._levelByScale[a];var b=this._fullCacheLodInfos;if(a>b[0].scale)return b[0].level;let c;for(let l=0;l<b.length-1;l++)if(c=b[l+1],a>c.scale)return b=b[l],b.level+(b.scale-a)/(b.scale-c.scale);return b[b.length-1].level};d._initializeFullCacheLODs=function(a){a=0===a[0].level?a.map(b=>({level:b.level,resolution:b.resolution,
scale:b.scale})):F.create({size:this.tileInfo.size[0],spatialReference:this.tileInfo.spatialReference}).lods.map(b=>({level:b.level,resolution:b.resolution,scale:b.scale}));for(let b=0;b<a.length;b++)this._levelByScale[a[b].scale]=a[b].level;this._fullCacheLodInfos=a};return q}(x)})},"*noref":1}});
define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Graphic ../../../core/lang ../../../core/Logger ../../../core/maybe ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/diffUtils ../../../geometry/support/aaBoundingRect ../../../geometry/support/spatialReferenceUtils ../engine/vectorTiles/enums ../engine/vectorTiles/TileHandler ../engine/vectorTiles/TileManager ../engine/vectorTiles/VectorTile ../engine/vectorTiles/VectorTileContainer ../engine/vectorTiles/style/StyleDefinition ../engine/vectorTiles/style/StyleRepository ./LayerView2D ./support/DebugOverlay ../tiling/TileInfoViewPOT ../tiling/TileQueue ../../layers/LayerView".split(" "),function(B,
F,x,A,f,q,d,a,b,c,l,u,p,m,h,v,w,g,r,D,G,z,t,C,M,O){function X(Q){if(q.isNone(Q))return 0;switch(Q.type){case "partial":return Object.keys(Q.diff).length;case "complete":return Math.max(Object.keys(Q.oldValue).length,Object.keys(Q.newValue).length);case "collection":return Object.keys(Q.added).length+Object.keys(Q.changed).length+Object.keys(Q.removed).length}}c=function(Q){function V(){var L=Q.apply(this,arguments)||this;L._styleChanges=[];L._fetchQueue=null;L._parseQueue=null;L._tileHandlerPromise=
null;L._isTileHandlerReady=!1;L._collisionOverlay=null;L.fading=!1;L._getCollidersMesh=K=>{({pixelRatio:K}=K.state);let H=0;const J=[],S=[];for(const ba of L._vectorTileContainer.children)if(ba.symbols)for(const [,Z]of ba.symbols)for(const Y of Z)for(const ea of Y.colliders){const U=(ea.xScreen+ea.dxScreen)*K,aa=(ea.yScreen+ea.dyScreen)*K,fa=ea.width*K,ha=ea.height*K;var R=.5<Y.unique.parts[ea.partIndex].targetOpacity;if(!R&&"all"!==L.layer.showCollisionBoxes)continue;const ka=t.makeFlags(R?2:0,R?
3:0);J.push(U,aa,ka,U+fa,aa,ka,U,aa+ha,ka,U+fa,aa+ha,ka);S.push(H+0,H+1,H+2,H+1,H+3,H+2);H+=4;R=t.makeFlags(R?3:1,R?3:0);J.push(U,aa,R,U+fa,aa,R,U,aa+1,R,U+fa,aa+1,R);S.push(H+0,H+1,H+2,H+1,H+3,H+2);H+=4;J.push(U,aa+ha-1,R,U+fa,aa+ha-1,R,U,aa+ha,R,U+fa,aa+ha,R);S.push(H+0,H+1,H+2,H+1,H+3,H+2);H+=4;J.push(U,aa,R,U+1,aa,R,U,aa+ha,R,U+1,aa+ha,R);S.push(H+0,H+1,H+2,H+1,H+3,H+2);H+=4;J.push(U+fa-1,aa,R,U+fa,aa,R,U+fa-1,aa+ha,R,U+fa,aa+ha,R);S.push(H+0,H+1,H+2,H+1,H+3,H+2);H+=4}return{vertexData:new Int16Array(J),
indexData:new Uint32Array(S)}};L._getCollidersColors=()=>[1,.5,0,1,1,0,0,1,0,1,.5,1,0,.5,0,1];L._getCollidersOpacities=()=>[.05,.01,.15,.2];return L}B._inheritsLoose(V,Q);var P=V.prototype;P.hitTest=function(){var L=B._asyncToGenerator(function*(K,H){if(!this._tileHandlerPromise)return null;yield this._tileHandlerPromise;H=yield this._vectorTileContainer.hitTest(H);if(!H||0===H.length)return null;H=H[0]-1;var J=this._styleRepository;const S=J.getStyleLayerByUID(H);if(!S)return null;J=J.getStyleLayerIndex(S.id);
return[{type:"graphic",mapPoint:K,layer:this.layer,graphic:new x({attributes:{layerId:J,layerName:S.id,layerUID:H},layer:this.layer,sourceLayer:this.layer})}]});return function(K,H){return L.apply(this,arguments)}}();P.update=function(L){this._tileHandlerPromise&&this._isTileHandlerReady&&(L.pixelRatio!==this._tileHandler.devicePixelRatio?(this._start(),this._tileHandler.devicePixelRatio=L.pixelRatio):0<this._styleChanges.length?this._tileHandlerPromise=this._applyStyleChanges():(this._fetchQueue.pause(),
this._parseQueue.pause(),this._fetchQueue.state=L.state,this._parseQueue.state=L.state,this._tileManager.update(L)||this.requestUpdate(),this._parseQueue.resume(),this._fetchQueue.resume()))};P.attach=function(){const {style:L}=this.layer.currentStyleInfo;this._styleRepository=new G(L);this._tileInfoView=new C(this.layer.tileInfo,this.layer.fullExtent);this._vectorTileContainer=new r.VectorTileContainer(this._tileInfoView);this._tileHandler=new v.TileHandler(this.layer,this._styleRepository,window.devicePixelRatio||
1);this.container.addChild(this._vectorTileContainer);this._start();this.addAttachHandles([this._vectorTileContainer.on("fade-start",()=>{this.fading=!0;this.notifyChange("updating");this.requestUpdate()}),this._vectorTileContainer.on("fade-complete",()=>{this._collisionOverlay?.requestRender();this.fading=!1;this.notifyChange("updating");this.requestUpdate()}),a.watch(()=>this.layer.showCollisionBoxes,K=>{"none"!==K?this._collisionOverlay||(this._collisionOverlay=new t({getMesh:this._getCollidersMesh,
getColors:this._getCollidersColors,getOpacities:this._getCollidersOpacities}),this.container.addChild(this._collisionOverlay)):this._collisionOverlay&&(this.container.removeChild(this._collisionOverlay),this._collisionOverlay=null);this.container.requestRender()},a.initial),this.layer.on("paint-change",K=>{if(K.isDataDriven)this._styleChanges.push({type:h.StyleUpdateType.PAINTER_CHANGED,data:K}),this.notifyChange("updating"),this.requestUpdate();else{const J=this._styleRepository;var H=J.getLayerById(K.layer);
H&&(H=H.type===D.StyleLayerType.SYMBOL,J.setPaintProperties(K.layer,K.paint),H&&this._vectorTileContainer.restartDeclutter(),this._vectorTileContainer.requestRender())}}),this.layer.on("layout-change",K=>{const H=this._styleRepository,J=H.getLayerById(K.layer);if(J){var S=u.diff(J.layout,K.layout);q.isNone(S)||(u.hasDiff(S,"visibility")&&1===X(S)?(H.setLayoutProperties(K.layer,K.layout),J.type===D.StyleLayerType.SYMBOL&&this._vectorTileContainer.restartDeclutter(),this._vectorTileContainer.requestRender()):
(this._styleChanges.push({type:h.StyleUpdateType.LAYOUT_CHANGED,data:K}),this.notifyChange("updating"),this.requestUpdate()))}}),this.layer.on("style-layer-visibility-change",K=>{const H=this._styleRepository,J=H.getLayerById(K.layer);J&&(H.setStyleLayerVisibility(K.layer,K.visibility),J.type===D.StyleLayerType.SYMBOL&&this._vectorTileContainer.restartDeclutter(),this._vectorTileContainer.requestRender())}),this.layer.on("style-layer-change",K=>{this._styleChanges.push({type:h.StyleUpdateType.LAYER_CHANGED,
data:K});this.notifyChange("updating");this.requestUpdate()}),this.layer.on("delete-style-layer",K=>{this._styleChanges.push({type:h.StyleUpdateType.LAYER_REMOVED,data:K});this.notifyChange("updating");this.requestUpdate()}),this.layer.on("load-style",()=>this._loadStyle()),this.layer.on("spriteSource-change",K=>{this._newSpriteSource=K.spriteSource;this._styleChanges.push({type:h.StyleUpdateType.SPRITES_CHANGED,data:null});K=this._styleRepository.layers;for(const H of K)switch(H.type){case D.StyleLayerType.SYMBOL:H.getLayoutProperty("icon-image")&&
this._styleChanges.push({type:h.StyleUpdateType.LAYOUT_CHANGED,data:{layer:H.id,layout:H.layout}});break;case D.StyleLayerType.LINE:H.getPaintProperty("line-pattern")&&this._styleChanges.push({type:h.StyleUpdateType.PAINTER_CHANGED,data:{layer:H.id,paint:H.paint,isDataDriven:H.isPainterDataDriven()}});break;case D.StyleLayerType.FILL:H.getLayoutProperty("fill-pattern")&&this._styleChanges.push({type:h.StyleUpdateType.PAINTER_CHANGED,data:{layer:H.id,paint:H.paint,isDataDriven:H.isPainterDataDriven()}})}this.notifyChange("updating");
this.requestUpdate()})])};P.detach=function(){this._stop();this.container.removeAllChildren();this._vectorTileContainer=q.destroyMaybe(this._vectorTileContainer);this._tileHandler=q.destroyMaybe(this._tileHandler)};P.moveStart=function(){this.requestUpdate()};P.viewChange=function(){this.requestUpdate()};P.moveEnd=function(){this._collisionOverlay&&this._vectorTileContainer.restartDeclutter();this.requestUpdate()};P.supportsSpatialReference=function(L){return m.equals(this.layer.tileInfo?.spatialReference,
L)};P.canResume=function(){let L=Q.prototype.canResume.call(this);const {currentStyleInfo:K}=this.layer;if(L&&K?.layerDefinition){const H=this.view.scale,{minScale:J,maxScale:S}=K.layerDefinition;K&&K.layerDefinition&&(J&&J<H&&(L=!1),S&&S>H&&(L=!1))}return L};P.isUpdating=function(){const L=this._vectorTileContainer.children;return!this._isTileHandlerReady||!this._fetchQueue||!this._parseQueue||this._fetchQueue.updating||this._parseQueue.updating||0<L.length&&L.some(K=>K.invalidating)||this.fading};
P.acquireTile=function(L){const K=this._createVectorTile(L);this._tileHandlerPromise?.then(()=>{this._fetchQueue.push(K.key).then(H=>this._parseQueue.push({key:K.key,data:H})).then(H=>{K.once("attach",()=>this.requestUpdate());K.setData(H);this.requestUpdate();this.notifyChange("updating")}).catch(H=>{this.notifyChange("updating");d.isAbortError(H)||f.getLogger(this.declaredClass).error(H)})});return K};P.releaseTile=function(L){L=L.key.id;this._fetchQueue.abort(L);this._parseQueue.abort(L);this.requestUpdate()};
P._start=function(){this._stop();this._tileManager=new w.TileManager({acquireTile:H=>this.acquireTile(H),releaseTile:H=>this.releaseTile(H),tileInfoView:this._tileInfoView},this._vectorTileContainer);if(this.layer.currentStyleInfo){var L=new AbortController,K=this._tileHandler.start({signal:L.signal}).then(()=>{this._fetchQueue=new M({tileInfoView:this._tileInfoView,process:(H,J)=>this._getTileData(H,J),concurrency:15});this._parseQueue=new M({tileInfoView:this._tileInfoView,process:(H,J)=>this._parseTileData(H,
J),concurrency:8});this.requestUpdate();this._isTileHandlerReady=!0});this._tileHandler.spriteMosaic.then(H=>{this._vectorTileContainer.setStyleResources(H,this._tileHandler.glyphMosaic,this._styleRepository);this.requestUpdate()});this._tileHandlerAbortController=L;this._tileHandlerPromise=K}};P._stop=function(){if(this._tileHandlerAbortController&&this._vectorTileContainer){var L=this._tileHandlerAbortController;L&&L.abort();this._tileHandlerPromise=null;this._isTileHandlerReady=!1;this._fetchQueue=
q.destroyMaybe(this._fetchQueue);this._parseQueue=q.destroyMaybe(this._parseQueue);this._tileManager=q.destroyMaybe(this._tileManager);this._vectorTileContainer.removeAllChildren()}};P._getTileData=function(){var L=B._asyncToGenerator(function*(K,H){K=yield this._tileHandler.fetchTileData(K,H);this.notifyChange("updating");return K});return function(K,H){return L.apply(this,arguments)}}();P._parseTileData=function(){var L=B._asyncToGenerator(function*(K,H){return this._tileHandler.parseTileData(K,
H)});return function(K,H){return L.apply(this,arguments)}}();P._applyStyleChanges=function(){var L=B._asyncToGenerator(function*(){this._isTileHandlerReady=!1;this._fetchQueue.pause();this._parseQueue.pause();this._fetchQueue.clear();this._parseQueue.clear();this._tileManager.clearCache();var K=this._styleChanges;try{yield this._tileHandler.updateStyle(K)}catch(Z){f.getLogger(this.declaredClass).error("error applying vector-tiles style update",Z.message),this._fetchQueue.resume(),this._parseQueue.resume(),
this._isTileHandlerReady=!0}const H=this._styleRepository,J=[];K.forEach(Z=>{Z.type===h.StyleUpdateType.LAYER_REMOVED&&(Z=H.getLayerById(Z.data.layer))&&J.push(Z.uid)});const S=[];let R;K.forEach(Z=>{const Y=Z.data;switch(Z.type){case h.StyleUpdateType.PAINTER_CHANGED:H.setPaintProperties(Y.layer,Y.paint);R=Y.layer;break;case h.StyleUpdateType.LAYOUT_CHANGED:H.setLayoutProperties(Y.layer,Y.layout);R=Y.layer;break;case h.StyleUpdateType.LAYER_REMOVED:H.deleteStyleLayer(Y.layer);return;case h.StyleUpdateType.LAYER_CHANGED:H.setStyleLayer(Y.layer,
Y.index);R=Y.layer.id;break;case h.StyleUpdateType.SPRITES_CHANGED:this._vectorTileContainer.setSpriteMosaic(this._tileHandler.setSpriteSource(this._newSpriteSource)),R=this._newSpriteSource=null}(Z=H.getLayerById(R))&&S.push(Z.uid)});K=this._vectorTileContainer.children;if(0<J.length){this._vectorTileContainer.deleteStyleLayers(J);for(var ba of K)ba.deleteLayerData(J)}this._fetchQueue.resume();this._parseQueue.resume();if(0<S.length){ba=[];for(const Z of K)K=this._fetchQueue.push(Z.key).then(Y=>
this._parseQueue.push({key:Z.key,data:Y,styleLayerUIDs:S})).then(Y=>Z.setData(Y)),ba.push(K);yield Promise.all(ba)}this._styleChanges=[];this._isTileHandlerReady=!0;this.notifyChange("updating");this.requestUpdate()});return function(){return L.apply(this,arguments)}}();P._loadStyle=function(){var L=B._asyncToGenerator(function*(){var {style:K}=this.layer.currentStyleInfo;K=A.clone(K);this._isTileHandlerReady=!1;this._fetchQueue.pause();this._parseQueue.pause();this._fetchQueue.clear();this._parseQueue.clear();
this.notifyChange("updating");this._styleRepository=new G(K);this._vectorTileContainer.destroy();this._tileManager.clear();this._tileHandlerAbortController.abort();this._tileHandlerAbortController=new AbortController;const {signal:H}=this._tileHandlerAbortController;try{this._tileHandlerPromise=this._tileHandler.setStyle(this._styleRepository,K),yield this._tileHandlerPromise}catch(J){if(!d.isAbortError(J))throw J;}H.aborted||(K=yield this._tileHandler.spriteMosaic,this._vectorTileContainer.setStyleResources(K,
this._tileHandler.glyphMosaic,this._styleRepository));this._fetchQueue.resume();this._parseQueue.resume();this._isTileHandlerReady=!0;this.notifyChange("updating");this.requestUpdate()});return function(){return L.apply(this,arguments)}}();P._createVectorTile=function(L){const K=this._tileInfoView.getTileBounds(p.create(),L),H=this._tileInfoView.getTileResolution(L.level);return new g.VectorTile(L,H,K[0],K[3],512,512,this._styleRepository)};return V}(z.LayerView2DMixin(O));F.__decorate([b.property()],
c.prototype,"_fetchQueue",void 0);F.__decorate([b.property()],c.prototype,"_parseQueue",void 0);F.__decorate([b.property()],c.prototype,"_isTileHandlerReady",void 0);F.__decorate([b.property()],c.prototype,"fading",void 0);return c=F.__decorate([l.subclass("esri.views.2d.layers.VectorTileLayerView2D")],c)});