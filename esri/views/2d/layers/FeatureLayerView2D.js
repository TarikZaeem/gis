// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.26/esri/copyright.txt for details.
//>>built
require({cache:{"esri/AggregateGraphic":function(){define("./chunks/_rollupPluginBabelHelpers ./chunks/tslib.es6 ./Graphic ./core/accessorSupport/decorators/property ./core/accessorSupport/ensureType ./core/arrayUtils ./core/accessorSupport/decorators/subclass".split(" "),function(g,m,h,n,A,z,x){h=function(k){function u(){var v=k.apply(this,arguments)||this;v.isAggregate=!0;return v}g._inheritsLoose(u,k);var r=u.prototype;r.getEffectivePopupTemplate=function(v){return this.popupTemplate?this.popupTemplate:
(v=this.sourceLayer&&this.sourceLayer.featureReduction)&&"popupTemplate"in v&&v.popupEnabled?v.popupTemplate:null};r.getObjectId=function(){return this.attributes.aggregateId};return u}(h);m.__decorate([n.property({type:Boolean})],h.prototype,"isAggregate",void 0);return h=m.__decorate([x.subclass("esri.AggregateGraphic")],h)})},"esri/layers/effects/FeatureEffectView":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/has ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass ./EffectView".split(" "),
function(g,m,h,n,A,z,x,k,u,r){h=function(v){function l(c){var f=v.call(this,c)||this;f._filter=null;f.duration=n("mapview-transitions-duration");f._excludedEffectView=new r.EffectView(c);f._includedEffectView=new r.EffectView(c);return f}g._inheritsLoose(l,v);var d=l.prototype;d.transitionStep=function(c,f){this._set("scale",f);this.transitioning?(this._includedEffectView.transitionStep(c,f),this._excludedEffectView.transitionStep(c,f),this.transitioning||(this._filter=null)):(this._excludedEffectView.scale=
f,this._includedEffectView.scale=f)};d.endTransitions=function(){this._includedEffectView.endTransitions();this._excludedEffectView.endTransitions();this._filter=null};d._transitionTo=function(c){const f=this._get("featureEffect");c=A.unwrap(c);const t=A.unwrap(c?.includedEffect),D=A.unwrap(c?.excludedEffect),B=this._includedEffectView.canTransitionTo(t)&&this._excludedEffectView.canTransitionTo(D);this._includedEffectView.effect=t;this._excludedEffectView.effect=D;this._set("featureEffect",c);this._filter=
c?.filter||f?.filter||null;B||this.endTransitions()};g._createClass(l,[{key:"excludedEffects",get:function(){return this._excludedEffectView.effects}},{key:"featureEffect",set:function(c){this._get("featureEffect")!==c&&this._transitionTo(c)}},{key:"filter",get:function(){return this._filter||A.unwrap(this.featureEffect)?.filter||null}},{key:"hasEffects",get:function(){return this._excludedEffectView.hasEffects||this._includedEffectView.hasEffects}},{key:"includedEffects",get:function(){return this._includedEffectView.effects}},
{key:"scale",set:function(c){this._set("scale",c);this._excludedEffectView.scale=c;this._includedEffectView.scale=c}},{key:"transitioning",get:function(){return this._excludedEffectView.transitioning||this._includedEffectView.transitioning}}]);return l}(h);m.__decorate([z.property()],h.prototype,"_filter",void 0);m.__decorate([z.property()],h.prototype,"_excludedEffectView",void 0);m.__decorate([z.property()],h.prototype,"_includedEffectView",void 0);m.__decorate([z.property()],h.prototype,"duration",
void 0);m.__decorate([z.property()],h.prototype,"excludedEffects",null);m.__decorate([z.property()],h.prototype,"featureEffect",null);m.__decorate([z.property()],h.prototype,"filter",null);m.__decorate([z.property()],h.prototype,"hasEffects",null);m.__decorate([z.property()],h.prototype,"includedEffects",null);m.__decorate([z.property({value:0})],h.prototype,"scale",null);m.__decorate([z.property()],h.prototype,"transitioning",null);return h=m.__decorate([u.subclass("esri.layers.effects.FeatureEffectView")],
h)})},"esri/rest/support/AggregateFeatureSet":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../AggregateGraphic ../../geometry ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ./FeatureSet ../../geometry/SpatialReference".split(" "),function(g,m,h,n,A,z,x,k,u,r,v,l){n=function(d){function c(){var f=
d.apply(this,arguments)||this;f.features=[];return f}g._inheritsLoose(c,d);c.prototype.readFeatures=function(f,t){t=l.fromJSON(t.spatialReference);const D=[];for(let N=0;N<f.length;N++){var B=f[N];const E=h.fromJSON(B);var H=B.geometry&&B.geometry.spatialReference;A.isSome(E.geometry)&&!H&&(E.geometry.spatialReference=t);B=B.aggregateGeometries;H=E.aggregateGeometries;if(B&&A.isSome(H))for(const F in H){const G=H[F],K=B[F]?.spatialReference;A.isSome(G)&&!K&&(G.spatialReference=t)}D.push(E)}return D};
return c}(v);m.__decorate([z.property({type:[h],json:{write:!0}})],n.prototype,"features",void 0);m.__decorate([u.reader("features")],n.prototype,"readFeatures",null);return n=m.__decorate([r.subclass("esri.rest.support.AggregateFeatureSet")],n)})},"esri/views/2d/layers/LayerView2D":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Collection ../../../core/collectionUtils ../../../core/Error ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ../engine/Container ../support/HighlightOptions ../../layers/support/ClipRect ../../layers/support/Geometry ../../layers/support/Path".split(" "),
function(g,m,h,n,A,z,x,k,u,r,v,l,d,c,f,t){const D=n.ofType({key:"type",base:null,typeMap:{rect:c,path:t,geometry:f}});g.LayerView2DMixin=B=>{B=function(H){function N(){var F=H.apply(this,arguments)||this;F.attached=!1;F.clips=new D;F.lastUpdateId=-1;F.moving=!1;F.updateRequested=!1;F.visibleAtCurrentScale=!1;F.highlightOptions=null;return F}m._inheritsLoose(N,H);var E=N.prototype;E.initialize=function(){const F=this.view?.spatialReferenceLocked??!0;this.view?.spatialReference&&F&&!this.spatialReferenceSupported?
this.addResolvingPromise(Promise.reject(new z("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",{layer:this.layer}))):(this.container||(this.container=new l.Container),this.container.fadeTransitionEnabled=!0,this.container.visible=!1,this.container.endTransitions(),this.addHandles([x.watch(()=>this.suspended,G=>{this.container&&(this.container.visible=!G);this.view&&!G&&this.updateRequested&&this.view.requestUpdate()},x.syncAndInitial),
x.watch(()=>this.layer?.opacity??1,G=>{this.container&&(this.container.opacity=G)},x.syncAndInitial),x.watch(()=>this.layer&&"blendMode"in this.layer?this.layer.blendMode:"normal",G=>{this.container&&(this.container.blendMode=G)},x.syncAndInitial),x.watch(()=>this.layer&&"effect"in this.layer?this.layer.effect:null,G=>{this.container&&(this.container.effect=G)},x.syncAndInitial),x.watch(()=>this.highlightOptions,G=>this.container.highlightOptions=G,x.syncAndInitial),x.on(()=>this.clips,"change",()=>
{this.container&&(this.container.clips=this.clips)},x.syncAndInitial),x.watch(()=>({scale:this.view?.scale,scaleRange:this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null}),({scale:G})=>{G=null!=G?this.isVisibleAtScale(G):!1;G!==this.visibleAtCurrentScale&&this._set("visibleAtCurrentScale",G)},x.syncAndInitial)],"constructor"),this.view?.whenLayerView?this.view.whenLayerView(this.layer).then(G=>{G===this&&this.processAttach()},()=>{}):this.when().then(()=>{this.processAttach()},
()=>{}))};E.destroy=function(){this.processDetach();this.updateRequested=!1};E.processAttach=function(){this.isResolved()&&!this.attached&&!this.destroyed&&this.spatialReferenceSupported&&(this.attach(),this.attached=!0,this.requestUpdate())};E.processDetach=function(){this.attached&&(this.attached=!1,this.removeHandles("attach"),this.detach(),this.updateRequested=!1)};E.isVisibleAtScale=function(F){const G=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;if(!G)return!0;
const {minScale:K,maxScale:p}=G;return(0===K||F<=K)&&(0===p||F>=p)};E.requestUpdate=function(){this.destroyed||this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestUpdate())};E.processUpdate=function(F){this.isFulfilled()&&!this.isResolved()?this.updateRequested=!1:(this._set("updateParameters",F),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(F)))};E.hitTest=function(F,G){return Promise.resolve(null)};E.supportsSpatialReference=function(F){return!0};
E.canResume=function(){return this.spatialReferenceSupported?H.prototype.canResume.call(this)?this.visibleAtCurrentScale:!1:!1};E.getSuspendInfo=function(){const F=H.prototype.getSuspendInfo.call(this),G=!this.spatialReferenceSupported,K=this.visibleAtCurrentScale;G&&(F.spatialReferenceNotSupported=G);K&&(F.outsideScaleRange=K);return F};E.addAttachHandles=function(F){this.addHandles(F,"attach")};m._createClass(N,[{key:"spatialReferenceSupported",get:function(){const F=this.view?.spatialReference;
return null==F||this.supportsSpatialReference(F)}},{key:"updating",get:function(){return this.spatialReferenceSupported&&(!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())||!!this.updatingHandles?.updating)}}]);return N}(B);h.__decorate([k.property()],B.prototype,"attached",void 0);h.__decorate([k.property({type:D,set(H){H=A.referenceSetter(H,this._get("clips"),D);this._set("clips",H)}})],B.prototype,"clips",void 0);h.__decorate([k.property()],B.prototype,"container",void 0);
h.__decorate([k.property()],B.prototype,"moving",void 0);h.__decorate([k.property({readOnly:!0})],B.prototype,"spatialReferenceSupported",null);h.__decorate([k.property({readOnly:!0})],B.prototype,"updateParameters",void 0);h.__decorate([k.property()],B.prototype,"updateRequested",void 0);h.__decorate([k.property()],B.prototype,"updating",null);h.__decorate([k.property()],B.prototype,"view",void 0);h.__decorate([k.property({readOnly:!0})],B.prototype,"visibleAtCurrentScale",void 0);h.__decorate([k.property({type:d})],
B.prototype,"highlightOptions",void 0);return B=h.__decorate([v.subclass("esri.views.2d.layers.LayerView2D")],B)};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/views/layers/support/ClipRect":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ./ClipArea".split(" "),function(g,
m,h,n,A,z,x){var k;n=k=function(u){function r(l){l=u.call(this,l)||this;l.type="rect";l.left=null;l.right=null;l.top=null;l.bottom=null;return l}g._inheritsLoose(r,u);var v=r.prototype;v.clone=function(){return new k({left:this.left,right:this.right,top:this.top,bottom:this.bottom})};v.commitVersionProperties=function(){this.commitProperty("left");this.commitProperty("right");this.commitProperty("top");this.commitProperty("bottom")};return r}(x);m.__decorate([h.property({type:[Number,String],json:{write:!0}})],
n.prototype,"left",void 0);m.__decorate([h.property({type:[Number,String],json:{write:!0}})],n.prototype,"right",void 0);m.__decorate([h.property({type:[Number,String],json:{write:!0}})],n.prototype,"top",void 0);m.__decorate([h.property({type:[Number,String],json:{write:!0}})],n.prototype,"bottom",void 0);return n=k=m.__decorate([z.subclass("esri.views.layers.support.ClipRect")],n)})},"esri/views/layers/support/ClipArea":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass".split(" "),
function(g,m,h,n,A,z,x){h=function(k){function u(){return k.apply(this,arguments)||this}g._inheritsLoose(u,k);g._createClass(u,[{key:"version",get:function(){this.commitVersionProperties();return(this._get("version")||0)+1}}]);return u}(h.JSONSupport);m.__decorate([n.property({readOnly:!0})],h.prototype,"version",null);return h=m.__decorate([x.subclass("esri.views.layers.support.ClipArea")],h)})},"esri/views/layers/support/Geometry":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ../../../geometry/Geometry ../../../geometry/support/jsonUtils ./ClipArea ../../../geometry/Extent ../../../geometry/Polygon".split(" "),
function(g,m,h,n,A,z,x,k,u,r,v,l){var d;h={base:k,key:"type",typeMap:{extent:v,polygon:l}};r=d=function(c){function f(D){D=c.call(this,D)||this;D.type="geometry";D.geometry=null;return D}g._inheritsLoose(f,c);var t=f.prototype;t.clone=function(){return new d({geometry:this.geometry?.clone()??null})};t.commitVersionProperties=function(){this.commitProperty("geometry")};return f}(r);m.__decorate([n.property({types:h,json:{read:u.fromJSON,write:!0}})],r.prototype,"geometry",void 0);return r=d=m.__decorate([x.subclass("esri.views.layers.support.Geometry")],
r)})},"esri/views/layers/support/Path":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ./ClipArea".split(" "),function(g,m,h,n,A,z,x){n=function(k){function u(r){r=k.call(this,r)||this;r.type="path";r.path=[];return r}g._inheritsLoose(u,k);u.prototype.commitVersionProperties=function(){this.commitProperty("path")};
return u}(x);m.__decorate([h.property({type:[[[Number]]],json:{write:!0}})],n.prototype,"path",void 0);return n=m.__decorate([z.subclass("esri.views.layers.support.Path")],n)})},"esri/views/2d/layers/features/tileRenderers":function(){define(["require","exports","../../../../chunks/_rollupPluginBabelHelpers"],function(g,m,h){function n(){n=h._asyncToGenerator(function*(z,x){if(!z)return null;switch(z.type){case "symbol":return new (yield new Promise((k,u)=>g(["./tileRenderers/SymbolTileRenderer"],
r=>k(A(r)),u))).default(x);case "heatmap":return new (yield new Promise((k,u)=>g(["./tileRenderers/HeatmapTileRenderer"],r=>k(A(r)),u))).default(x)}});return n.apply(this,arguments)}const A=z=>Object.freeze(Object.defineProperty({__proto__:null,default:z},Symbol.toStringTag,{value:"Module"}));m.createOrReuseTileRenderer=function(z,x){return n.apply(this,arguments)};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/support/FeatureCommandQueue":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Accessor ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/accessorSupport/decorators/subclass ../../../support/QueueProcessor".split(" "),
function(g,m,h,n,A,z,x,k){function u(d){return d.some(c=>c.globalId)}function r(d){return d.filter(c=>!c.error).map(c=>c.objectId??c.globalId).filter(c=>null!=c)}function v(d,c){d=new Set(d);for(const f of c.values())d.add(f);return d}function l(d,c){d=new Set(d);for(const f of c.values())d.delete(f);return d}h=function(d){function c(t){var D=d.call(this,t)||this;D._hasGlobalIds=!1;D._notifyUpdating=()=>{D.notifyChange("updating")};return D}g._inheritsLoose(c,d);var f=c.prototype;f.normalizeCtorArgs=
function(t){this._queueProcessor=new k.QueueProcessor({concurrency:1,process:t.process});return{}};f.destroy=function(){this.clear()};f.clear=function(){this._queueProcessor.clear()};f.push=function(t){const D=this._queueProcessor;var B=D.last();switch(t.type){case "update":case "refresh":if(B?.type===t.type)return;D.push(t).then(this._notifyUpdating,this._notifyUpdating);break;case "edit":(B="processed-edit"===B?.type?B:null)&&D.popLast();t=this._mergeEdits(B,t);for(const H of t)H&&D.push(H).then(this._notifyUpdating,
this._notifyUpdating)}this.notifyChange("updating")};f._mergeEdits=function(t,D){const {addedFeatures:B,deletedFeatures:H,updatedFeatures:N}=D.edits;if(this._hasGlobalIds=this._hasGlobalIds||u(B)||u(N)||u(H))return D=[...B,...N],[t,{type:"processed-edit",edits:{addOrModified:D,removed:H}}];D=new Set(r(t?.edits.addOrModified??[]));t=new Set(r(t?.edits.removed??[]));const E=new Set([...r(B),...r(N)]),F=new Set(r(H));D=Array.from(v(l(D,F),E)).map(G=>({objectId:G}));t=Array.from(v(l(t,E),F)).map(G=>({objectId:G}));
return[{type:"processed-edit",edits:{addOrModified:D,removed:t}}]};g._createClass(c,[{key:"updating",get:function(){return 0<this._queueProcessor.length}}]);return c}(h);m.__decorate([n.property({readOnly:!0})],h.prototype,"updating",null);m.__decorate([n.property()],h.prototype,"process",void 0);return h=m.__decorate([x.subclass("esri.views.2d.layers.support.FeatureCommandQueue")],h)})},"esri/views/2d/layers/support/FeatureLayerProxy":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Promise ../../../../core/promiseUtils ../../../../core/workers/workers ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/accessorSupport/decorators/subclass".split(" "),
function(g,m,h,n,A,z,x,k,u){h=function(r){function v(d){d=r.call(this,d)||this;d._startupResolver=n.createResolver();d.isReady=!1;return d}g._inheritsLoose(v,r);var l=v.prototype;l.initialize=function(){this._controller=new AbortController;this.addResolvingPromise(this._startWorker(this._controller.signal))};l.destroy=function(){this._controller.abort();this._connection&&this._connection.close()};l.startup=function(){var d=g._asyncToGenerator(function*(c,f,t,D){yield this.when();var B=this._controller.signal;
B=Array.isArray(t.source)?{transferList:t.source,signal:B}:void 0;c=c.tileInfo.toJSON();yield this._connection.invoke("startup",{service:t,config:f,tileInfo:c,tiles:D},B);this._startupResolver.resolve();this._set("isReady",!0)});return function(c,f,t,D){return d.apply(this,arguments)}}();l.updateTiles=function(){var d=g._asyncToGenerator(function*(c){yield this._startupResolver.promise;return n.ignoreAbortErrors(this._connection.invoke("updateTiles",c))});return function(c){return d.apply(this,arguments)}}();
l.update=function(){var d=g._asyncToGenerator(function*(c){c={config:c};yield this._startupResolver.promise;return this._connection.invoke("update",c)});return function(c){return d.apply(this,arguments)}}();l.applyUpdate=function(){var d=g._asyncToGenerator(function*(c){yield this._startupResolver.promise;return this._connection.invoke("applyUpdate",c)});return function(c){return d.apply(this,arguments)}}();l.setHighlight=function(){var d=g._asyncToGenerator(function*(c){yield this._startupResolver.promise;
return n.ignoreAbortErrors(this._connection.invoke("controller.setHighlight",c))});return function(c){return d.apply(this,arguments)}}();l.stop=function(){var d=g._asyncToGenerator(function*(){yield this._startupResolver.promise;if(!this.closed)return n.ignoreAbortErrors(this._connection.invoke("stop"))});return function(){return d.apply(this,arguments)}}();l.refresh=function(){var d=g._asyncToGenerator(function*(c){yield this._startupResolver.promise;return n.ignoreAbortErrors(this._connection.invoke("controller.refresh",
c))});return function(c){return d.apply(this,arguments)}}();l.querySummaryStatistics=function(){var d=g._asyncToGenerator(function*(c,f,t){yield this._startupResolver.promise;return this._connection.invoke("controller.querySummaryStatistics",{query:c.toJSON(),params:f},t)});return function(c,f,t){return d.apply(this,arguments)}}();l.queryAggregateSummaryStatistics=function(){var d=g._asyncToGenerator(function*(c,f,t){yield this._startupResolver.promise;return this._connection.invoke("controller.queryAggregateSummaryStatistics",
{query:c.toJSON(),params:f},t)});return function(c,f,t){return d.apply(this,arguments)}}();l.queryUniqueValues=function(){var d=g._asyncToGenerator(function*(c,f,t){yield this._startupResolver.promise;return this._connection.invoke("controller.queryUniqueValues",{query:c.toJSON(),params:f},t)});return function(c,f,t){return d.apply(this,arguments)}}();l.queryAggregateUniqueValues=function(){var d=g._asyncToGenerator(function*(c,f,t){yield this._startupResolver.promise;return this._connection.invoke("controller.queryAggregateUniqueValues",
{query:c.toJSON(),params:f},t)});return function(c,f,t){return d.apply(this,arguments)}}();l.queryClassBreaks=function(){var d=g._asyncToGenerator(function*(c,f,t){yield this._startupResolver.promise;return this._connection.invoke("controller.queryClassBreaks",{query:c.toJSON(),params:f},t)});return function(c,f,t){return d.apply(this,arguments)}}();l.queryAggregateClassBreaks=function(){var d=g._asyncToGenerator(function*(c,f,t){yield this._startupResolver.promise;return this._connection.invoke("controller.queryAggregateClassBreaks",
{query:c.toJSON(),params:f},t)});return function(c,f,t){return d.apply(this,arguments)}}();l.queryHistogram=function(){var d=g._asyncToGenerator(function*(c,f,t){yield this._startupResolver.promise;return this._connection.invoke("controller.queryHistogram",{query:c.toJSON(),params:f},t)});return function(c,f,t){return d.apply(this,arguments)}}();l.queryAggregateHistogram=function(){var d=g._asyncToGenerator(function*(c,f,t){yield this._startupResolver.promise;return this._connection.invoke("controller.queryAggregateHistogram",
{query:c.toJSON(),params:f},t)});return function(c,f,t){return d.apply(this,arguments)}}();l.queryFeatures=function(){var d=g._asyncToGenerator(function*(c,f){yield this._startupResolver.promise;return this._connection.invoke("controller.queryFeatures",c?.toJSON(),f)});return function(c,f){return d.apply(this,arguments)}}();l.queryVisibleFeatures=function(){var d=g._asyncToGenerator(function*(c,f){yield this._startupResolver.promise;return this._connection.invoke("controller.queryVisibleFeatures",
c?.toJSON(),f)});return function(c,f){return d.apply(this,arguments)}}();l.queryObjectIds=function(){var d=g._asyncToGenerator(function*(c,f){yield this._startupResolver.promise;return this._connection.invoke("controller.queryObjectIds",c?.toJSON(),f)});return function(c,f){return d.apply(this,arguments)}}();l.queryFeatureCount=function(){var d=g._asyncToGenerator(function*(c,f){yield this._startupResolver.promise;return this._connection.invoke("controller.queryFeatureCount",c?.toJSON(),f)});return function(c,
f){return d.apply(this,arguments)}}();l.queryExtent=function(){var d=g._asyncToGenerator(function*(c,f){return this._connection.invoke("controller.queryExtent",c.toJSON(),f)});return function(c,f){return d.apply(this,arguments)}}();l.queryLatestObservations=function(){var d=g._asyncToGenerator(function*(c,f){yield this._startupResolver.promise;return this._connection.invoke("controller.queryLatestObservations",c.toJSON(),f)});return function(c,f){return d.apply(this,arguments)}}();l.queryStatistics=
function(){var d=g._asyncToGenerator(function*(c){yield this._startupResolver.promise;return this._connection.invoke("controller.queryStatistics",c)});return function(c){return d.apply(this,arguments)}}();l.queryAggregates=function(){var d=g._asyncToGenerator(function*(c,f){yield this._startupResolver.promise;return this._connection.invoke("controller.queryAggregates",c?.toJSON(),f)});return function(c,f){return d.apply(this,arguments)}}();l.queryAggregateCount=function(){var d=g._asyncToGenerator(function*(c,
f){yield this._startupResolver.promise;return this._connection.invoke("controller.queryAggregateCount",c?.toJSON(),f)});return function(c,f){return d.apply(this,arguments)}}();l.queryAggregateIds=function(){var d=g._asyncToGenerator(function*(c,f){yield this._startupResolver.promise;return this._connection.invoke("controller.queryAggregateIds",c?.toJSON(),f)});return function(c,f){return d.apply(this,arguments)}}();l.getObjectId=function(){var d=g._asyncToGenerator(function*(c){yield this._startupResolver.promise;
return this._connection.invoke("controller.getObjectId",c)});return function(c){return d.apply(this,arguments)}}();l.getDisplayId=function(){var d=g._asyncToGenerator(function*(c){yield this._startupResolver.promise;return this._connection.invoke("controller.getDisplayId",c)});return function(c){return d.apply(this,arguments)}}();l.getFeatures=function(){var d=g._asyncToGenerator(function*(c){yield this._startupResolver.promise;return this._connection.invoke("controller.getFeatures",c)});return function(c){return d.apply(this,
arguments)}}();l.getAggregates=function(){var d=g._asyncToGenerator(function*(){yield this._startupResolver.promise;return this._connection.invoke("controller.getAggregates")});return function(){return d.apply(this,arguments)}}();l.getAggregateValueRanges=function(){var d=g._asyncToGenerator(function*(){yield this._startupResolver.promise;return this._connection.invoke("controller.getAggregateValueRanges")});return function(){return d.apply(this,arguments)}}();l.mapValidDisplayIds=function(){var d=
g._asyncToGenerator(function*(c){yield this._startupResolver.promise;return this._connection.invoke("controller.mapValidDisplayIds",c)});return function(c){return d.apply(this,arguments)}}();l.onEdits=function(){var d=g._asyncToGenerator(function*(c){yield this._startupResolver.promise;return n.ignoreAbortErrors(this._connection.invoke("controller.onEdits",c))});return function(c){return d.apply(this,arguments)}}();l.enableEvent=function(){var d=g._asyncToGenerator(function*(c,f){yield this._startupResolver.promise;
return n.ignoreAbortErrors(this._connection.invoke("controller.enableEvent",{name:c,value:f}))});return function(c,f){return d.apply(this,arguments)}}();l.pauseStream=function(){var d=g._asyncToGenerator(function*(){yield this._startupResolver.promise;return n.ignoreAbortErrors(this._connection.invoke("controller.pauseStream"))});return function(){return d.apply(this,arguments)}}();l.resumeStream=function(){var d=g._asyncToGenerator(function*(){yield this._startupResolver.promise;return n.ignoreAbortErrors(this._connection.invoke("controller.resumeStream"))});
return function(){return d.apply(this,arguments)}}();l.sendMessageToSocket=function(){var d=g._asyncToGenerator(function*(c){yield this._startupResolver.promise;return n.ignoreAbortErrors(this._connection.invoke("controller.sendMessageToSocket",c))});return function(c){return d.apply(this,arguments)}}();l.sendMessageToClient=function(){var d=g._asyncToGenerator(function*(c){yield this._startupResolver.promise;return n.ignoreAbortErrors(this._connection.invoke("controller.sendMessageToClient",c))});
return function(c){return d.apply(this,arguments)}}();l.updateCustomParameters=function(){var d=g._asyncToGenerator(function*(c){yield this._startupResolver.promise;return n.ignoreAbortErrors(this._connection.invoke("controller.updateCustomParameters",c))});return function(c){return d.apply(this,arguments)}}();l._startWorker=function(){var d=g._asyncToGenerator(function*(c){try{this._connection=yield A.open("Pipeline",{client:this.client,strategy:"dedicated",signal:c})}catch(f){n.throwIfNotAbortError(f)}});
return function(c){return d.apply(this,arguments)}}();g._createClass(v,[{key:"tileRenderer",set:function(d){this.client.tileRenderer=d}},{key:"closed",get:function(){return this._connection.closed}}]);return v}(h.EsriPromise);m.__decorate([z.property()],h.prototype,"isReady",void 0);m.__decorate([z.property({constructOnly:!0})],h.prototype,"client",void 0);m.__decorate([z.property()],h.prototype,"tileRenderer",null);return h=m.__decorate([u.subclass("esri.views.2d.layers.support.FeatureLayerProxy")],
h)})},"esri/views/2d/tiling/TileManager":function(){define(["exports","../../../core/maybe","./TileCoverage","./TileKey"],function(g,m,h,n){let A=function(){function z(k){this._tiles=new Map;this.buffer=0;this.acquireTile=k.acquireTile;this.releaseTile=k.releaseTile;this.tileInfoView=k.tileInfoView;this.buffer=k.buffer}var x=z.prototype;x.destroy=function(){};x.clear=function(){this._tiles.forEach(k=>this._releaseTile(k))};x.tileKeys=function(){const k=[];this._tiles.forEach((u,r)=>k.push(r));return k};
x.update=function(k){k=this.tileInfoView.getTileCoverage(k.state,this.buffer,"closest");const {spans:u,lodInfo:r}=k,{level:v}=r,l=[],d=[],c=new Set,f=new Set;for(const {row:t,colFrom:D,colTo:B}of u)for(let H=D;H<=B;H++){const N=n.getId(v,t,r.normalizeCol(H),r.getWorldForColumn(H)),E=this._getOrAcquireTile(l,N);c.add(N);E.isReady?E.visible=!0:f.add(E.key)}f.forEach(t=>this._addPlaceholders(c,t));this._tiles.forEach(t=>{c.has(t.key.id)||(d.push(t.key.id),this._releaseTile(t))});h.pool.release(k);return{hasMissingTiles:0<
f.size,added:l,removed:d}};x._getOrAcquireTile=function(k,u){if(!this._tiles.has(u)){const r=this.acquireTile(new n(u));k.push(u);this._tiles.set(u,r);r.visible=!1}return this._tiles.get(u)};x._getTile=function(k){return this._tiles.get(k)};x._releaseTile=function(k){this._tiles.delete(k.key.id);this.releaseTile(k)};x._addPlaceholders=function(k,u){const r=this._addPlaceholderChildren(k,u);1E-6>Math.abs(1-r)||this._addPlaceholderParent(k,u)||(this._getTile(u.id).visible=!0)};x._addPlaceholderChildren=
function(k,u){let r=0;this._tiles.forEach(v=>{r+=this._addPlaceholderChild(k,v,u)});return r};x._addPlaceholderChild=function(k,u,r){if(u.key.level<=r.level||!u.hasData||!r.contains(u.key))return 0;u.visible=!0;k.add(u.key.id);return 1/(1<<2*(u.key.level-r.level))};x._addPlaceholderParent=function(k,u){u=u.getParentKey();var r=0;let v=null;for(;m.isSome(u);){if(k.has(u.id))return!0;const l=this._getTile(u.id);if(l?.isReady){for(const d of k)(r=this._getTile(d))&&u.contains(r.key)&&(r.visible=!1);
l.visible=!0;k.add(l.key.id);return!0}l?.hasData&&l.patchCount>r&&(r=l.patchCount,v=l);u=u.getParentKey()}return v?(v.visible=!0,k.add(v.key.id),!0):!1};return z}();g.TileManager=A;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/views/layers/FeatureLayerView":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Error ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass ../../layers/support/commonProperties ../../layers/support/FeatureEffect ../../layers/support/FeatureFilter ../../layers/support/fieldUtils ../../layers/support/floorFilterUtils ../../rest/support/Query ../../support/arcadeOnDemand ./support/popupUtils".split(" "),
function(g,m,h,n,A,z,x,k,u,r,v,l,d,c,f,t,D,B,H){const N=n.getLogger("esri.views.layers.FeatureLayerView");return E=>{E=function(F){function G(...p){p=F.call(this,...p)||this;p._updatingRequiredFieldsPromise=null;p.filter=null;p.timeExtent=null;p.layer=null;p.requiredFields=[];p.view=null;return p}g._inheritsLoose(G,F);var K=G.prototype;K.initialize=function(){this.handles.add([x.watch(()=>{const p=this.layer;return[p?.elevationInfo?.featureExpressionInfo,p&&"displayField"in p?p.displayField:null,
p&&"timeInfo"in p&&p.timeInfo,p&&"renderer"in p&&p.renderer,p&&"labelingInfo"in p&&p.labelingInfo,p&&"floorInfo"in p&&p.floorInfo,this.filter,this.featureEffect,this.timeExtent]},()=>this._handleRequiredFieldsChange(),x.syncAndInitial),x.on(()=>this.view?.floors,"change",()=>this._handleRequiredFieldsChange()),x.on(()=>{const p=this.layer;return p&&"sublayers"in p?p.sublayers:null},"change",()=>this._handleRequiredFieldsChange())])};K.highlight=function(p){throw Error("missing implementation");};
K.createQuery=function(){var p={outFields:["*"],returnGeometry:!0,outSpatialReference:this.view.spatialReference};p=A.isSome(this.filter)?this.filter.createQuery(p):new D(p);if("feature"===this.layer.type){const C=t.getFloorFilterClause(this);A.isSome(C)&&(p.where=p.where?`(${p.where}) AND (${C})`:C)}A.isSome(this.timeExtent)&&(p.timeExtent=A.isSome(p.timeExtent)?p.timeExtent.intersection(this.timeExtent):this.timeExtent.clone());return p};K.createAggregateQuery=function(){return new D({outFields:["*"],
returnGeometry:!0,outSpatialReference:this.view.spatialReference})};K.queryFeatures=function(p,C){throw Error("missing implementation");};K.queryObjectIds=function(p,C){throw Error("missing implementation");};K.queryFeatureCount=function(p,C){throw Error("missing implementation");};K.queryExtent=function(p,C){throw Error("missing implementation");};K.fetchPopupFeatures=function(){var p=g._asyncToGenerator(function*(C,y){if(C=this.validateFetchPopupFeatures(y))throw C;return this.fetchClientPopupFeatures(y)});
return function(C,y){return p.apply(this,arguments)}}();K._loadArcadeModules=function(p){return p.get("expressionInfos.length")||Array.isArray(p.content)&&p.content.some(C=>"expression"===C.type)?B.loadArcade():Promise.resolve()};K._handleRequiredFieldsChange=function(){const p=this._updateRequiredFields();this._set("_updatingRequiredFieldsPromise",p);p.then(()=>{this._updatingRequiredFieldsPromise===p&&this._set("_updatingRequiredFieldsPromise",null)})};K._updateRequiredFields=function(){var p=g._asyncToGenerator(function*(){if(this.layer&&
this.view){var C="3d"===this.view.type,{layer:y,layer:{fieldsIndex:M,objectIdField:Q}}=this,O="renderer"in y&&y.renderer,P="orderBy"in y&&y.orderBy,S="featureReduction"in y?y.featureReduction:null,I=new Set;O=yield z.eachAlways([O?O.collectRequiredFields(I,M):null,f.collectLabelingFields(I,y),C?f.collectElevationFields(I,y):null,A.isSome(this.filter)?f.collectFilterFields(I,y,this.filter):null,A.isSome(this.featureEffect)?f.collectFilterFields(I,y,this.featureEffect.filter):null,S?f.collectFeatureReductionFields(I,
y,S):null,P?f.collectOrderByInfos(I,y,P):null]);"timeInfo"in y&&y.timeInfo&&this.timeExtent&&f.collectFields(I,y.fieldsIndex,[y.timeInfo.startField,y.timeInfo.endField]);"feature"===y.type&&(y.floorInfo&&f.collectFields(I,y.fieldsIndex,[y.floorInfo.floorField]),C&&A.isSome(y.infoFor3D)&&(null==y.globalIdField&&N.error("globalIdField missing on 3DObjectFeatureLayer"),f.collectFields(I,y.fieldsIndex,[y.globalIdField])));"subtype-group"===y.type&&(f.collectField(I,M,y.subtypeField),P=y.sublayers.map(W=>
Promise.all([W.renderer?.collectRequiredFields(I,M),f.collectLabelingFields(I,W)])),yield z.eachAlways(P));for(const W of O)W.error&&N.error(W.error);f.collectField(I,M,Q);C&&"displayField"in y&&y.displayField&&f.collectField(I,M,y.displayField);C=Array.from(I).sort();this._set("requiredFields",C)}});return function(){return p.apply(this,arguments)}}();K.validateFetchPopupFeatures=function(p){if(A.isNone(p))return null;for(const C of p.clientGraphics??[]){const y=C.layer;if("popupEnabled"in y&&!y.popupEnabled)return new h("featurelayerview:fetchPopupFeatures",
"Popups are disabled",{layer:y});if(C.isAggregate){const M="featureReduction"in y?y.featureReduction:null;if(!(M&&"popupTemplate"in M&&M.popupEnabled&&M.popupTemplate))return new h("featurelayerview:fetchPopupFeatures","Popups are disabled",{layer:y})}else if("popupTemplate"in y&&!H.getFetchPopupTemplate(y,p))return new h("featurelayerview:fetchPopupFeatures","Layer does not define a popup template",{layer:y})}};K.fetchClientPopupFeatures=function(){var p=g._asyncToGenerator(function*(C){const y=
A.isSome(C)?C.clientGraphics:null;if(!y||0===y.length)return[];const M=Array(y.length),Q=new Map,O=yield this.createPopupQuery(C);for(let S=0;S<y.length;S++){const I=y[S];if(I.isAggregate){M[S]=I;continue}var P=I.layer;if(!("popupEnabled"in P))continue;const W=f.unpackFieldNames(this.layer.fieldsIndex,O.outFields);P=H.getFetchPopupTemplate(P,C);if(A.isNone(P))continue;const aa=yield this._loadArcadeModules(P);aa&&aa.arcadeUtils.hasGeometryOperations(P)||!f.featureHasFields(W,I)?Q.set(I.getObjectId(),
{graphic:I,index:S}):M[S]=I}if("stream"===this.layer.type||0===Q.size)return M.filter(Boolean);O.objectIds=Array.from(Q.keys());try{const S=yield this.layer.queryFeatures(O);for(const I of S.features){const {graphic:{geometry:W},index:aa}=Q.get(I.getObjectId());I.geometry||(I.geometry=W);M[aa]=I}}catch{}return M.filter(Boolean)});return function(C){return p.apply(this,arguments)}}();K.createPopupQuery=function(){var p=g._asyncToGenerator(function*(C){const y=this.layer.createQuery(),M=new Set;var Q=
!1,O=A.isSome(C)&&C.clientGraphics?C.clientGraphics.map(P=>P.layer):[this.layer];for(const P of O)if("popupEnabled"in P&&(O=H.getFetchPopupTemplate(P,C),!A.isNone(O))){Q=(Q=yield this._loadArcadeModules(O))&&Q.arcadeUtils.hasGeometryOperations(O);Q=!("point"!==this.layer.geometryType&&!Q);O=yield H.getRequiredFields(this.layer,O);for(const S of O)M.add(S)}y.returnGeometry=Q;y.returnZ=Q;y.returnM=Q;y.outFields=Array.from(M);y.outSpatialReference=this.view.spatialReference;"feature"===this.layer.type&&
(C=t.getFloorFilterClause(this),A.isSome(C)&&(y.where=y.where?`(${y.where}) AND (${C})`:C));return y});return function(C){return p.apply(this,arguments)}}();K.canResume=function(){return!F.prototype.canResume.call(this)||A.isSome(this.timeExtent)&&this.timeExtent.isEmpty?!1:!0};g._createClass(G,[{key:"availableFields",get:function(){const {layer:p,layer:{fieldsIndex:C},requiredFields:y}=this;return"outFields"in p&&p.outFields?f.fixFields(C,[...f.unpackFieldNames(C,p.outFields),...y]):f.fixFields(C,
y)}},{key:"featureEffect",get:function(){return this.layer&&"featureEffect"in this.layer?this.layer.featureEffect:null},set:function(p){this._override("featureEffect",p)}},{key:"maximumNumberOfFeatures",get:function(){return 0},set:function(p){N.error("#maximumNumberOfFeatures\x3d","Setting maximum number of features is not supported")}},{key:"maximumNumberOfFeaturesExceeded",get:function(){return!1}}]);return G}(E);m.__decorate([k.property()],E.prototype,"_updatingRequiredFieldsPromise",void 0);
m.__decorate([k.property({readOnly:!0})],E.prototype,"availableFields",null);m.__decorate([k.property({type:d})],E.prototype,"featureEffect",null);m.__decorate([k.property({type:c})],E.prototype,"filter",void 0);m.__decorate([k.property(l.combinedViewLayerTimeExtentProperty)],E.prototype,"timeExtent",void 0);m.__decorate([k.property()],E.prototype,"layer",void 0);m.__decorate([k.property({type:Number})],E.prototype,"maximumNumberOfFeatures",null);m.__decorate([k.property({readOnly:!0,type:Boolean})],
E.prototype,"maximumNumberOfFeaturesExceeded",null);m.__decorate([k.property({readOnly:!0})],E.prototype,"requiredFields",void 0);m.__decorate([k.property()],E.prototype,"suspended",void 0);m.__decorate([k.property()],E.prototype,"view",void 0);return E=m.__decorate([v.subclass("esri.views.layers.FeatureLayerView")],E)}})},"esri/layers/support/floorFilterUtils":function(){define(["exports"],function(g){function m(h,n){if(!h?.length)return null;h=h.filter(A=>""!==A).map(A=>`'${A}'`);h.push("''");return`${n} IN (${h.join(",")}) OR ${n} IS NULL`}
g.getFloorFilterClause=function(h){const n=h.layer;return"floorInfo"in n&&n.floorInfo?.floorField&&"floors"in h.view?m(h.view.floors,n.floorInfo.floorField):null};g.getLayerFloorFilterClause=function(h,n){return"floorInfo"in n&&n.floorInfo?.floorField?m(h,n.floorInfo.floorField):null};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/views/layers/support/popupUtils":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../core/maybe","../../../layers/support/fieldUtils"],
function(g,m,h,n){function A(){A=m._asyncToGenerator(function*(z,x=z.popupTemplate){if(h.isNone(x))return[];const k=yield x.getRequiredFields(z.fieldsIndex);({lastEditInfoEnabled:x}=x);const {objectIdField:u,typeIdField:r,globalIdField:v,relationships:l}=z;if(k.includes("*"))return["*"];x=x?yield n.getFeatureEditFields(z):[];const d=n.fixFields(z.fieldsIndex,[...k,...x]);r&&d.push(r);d&&u&&z.fieldsIndex?.has(u)&&!d.includes(u)&&d.push(u);d&&v&&z.fieldsIndex?.has(v)&&!d.includes(v)&&d.push(v);l&&l.forEach(c=>
{({keyField:c}=c);d&&c&&z.fieldsIndex?.has(c)&&!d.includes(c)&&d.push(c)});return d});return A.apply(this,arguments)}g.getFetchPopupTemplate=function(z,x){return z.popupTemplate?z.popupTemplate:h.isSome(x)&&x.defaultPopupTemplateEnabled&&h.isSome(z.defaultPopupTemplate)?z.defaultPopupTemplate:null};g.getRequiredFields=function(z){return A.apply(this,arguments)};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/views/layers/RefreshableLayerView":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Logger ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass".split(" "),
function(g,m,h,n,A,z,x,k,u){return r=>{r=function(v){function l(){return v.apply(this,arguments)||this}g._inheritsLoose(l,v);l.prototype.initialize=function(){this.handles.add(A.on(()=>this.layer,"refresh",d=>{this.doRefresh(d.dataChanged).catch(c=>{n.isAbortError(c)||h.getLogger(this.declaredClass).error(c)})}),"RefreshableLayerView")};return l}(r);m.__decorate([z.property()],r.prototype,"layer",void 0);return r=m.__decorate([u.subclass("esri.layers.mixins.RefreshableLayerView")],r)}})},"*noref":1}});
define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../AggregateGraphic ../../../geometry ../../../Graphic ../../../core/Collection ../../../core/Error ../../../core/has ../../../core/lang ../../../core/Logger ../../../core/maybe ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../layers/effects/FeatureEffectView ../../../layers/support/FeatureFilter ../../../layers/support/layerUtils ../../../rest/support/AggregateFeatureSet ../../../rest/support/FeatureSet ../../../rest/support/Query ../engine/webgl/definitions ./LayerView2D ./features/schemaUtils ./features/tileRenderers ./features/support/rendererUtils ./support/clusterUtils ./support/FeatureCommandQueue ./support/FeatureLayerProxy ./support/util ../tiling/TileManager ../../layers/FeatureLayerView ../../layers/LayerView ../../layers/RefreshableLayerView ../../webgl/capabilities ../../../geometry/Extent".split(" "),
function(g,m,h,n,A,z,x,k,u,r,v,l,d,c,f,t,D,B,H,N,E,F,G,K,p,C,y,M,Q,O,P,S,I,W,aa,ja,ka){function ia(ba){return ba&&"openPorts"in ba}n=function(ba){function ca(){var a=ba.apply(this,arguments)||this;a._pipelineIsUpdating=!0;a._commandsQueue=new Q({process:b=>{switch(b.type){case "processed-edit":return a._doEdit(b);case "refresh":return a._doRefresh(b.dataChanged);case "update":return a._doUpdate()}}});a._visibilityOverrides=new Set;a._highlightIds=new Map;a._updateHighlight=l.debounce(g._asyncToGenerator(function*(){return a._proxy.setHighlight(Array.from(a._highlightIds.keys()))}));
a._uploadsLocked=!1;a._needsClusterSizeUpdate=!1;a.featureEffectView=new D;a._lastDefinitionExpression=null;return a}g._inheritsLoose(ca,ba);var w=ca.prototype;w.destroy=function(){v.applySome(this._updateClusterSizeTask,a=>a.remove());this._proxy?.destroy();this._commandsQueue.destroy()};w.initialize=function(){this.addResolvingPromise(Promise.all([this._initProxy(),this._initServiceOptions()]));this.addHandles([this.on("valueRangesChanged",a=>{this._set("_aggregateValueRanges",a.valueRanges)}),
d.watch(()=>this.featureEffect,a=>{this.featureEffectView.featureEffect=a},d.syncAndInitial)],"constructor");this.featureEffectView.endTransitions()};w._initProxy=function(){var a=g._asyncToGenerator(function*(){var b=this.layer;if("isTable"in b&&b.isTable)throw new x("featurelayerview:table-not-supported","table feature layer can't be displayed",{layer:this.layer});if(("feature"===b.type||"subtype-group"===b.type)&&!H.getEffectiveLayerCapabilities(b)?.operations.supportsQuery)throw new x("featurelayerview:query-not-supported",
"layer view requires a layer with query capability",{layer:b});this._proxy&&this._proxy.destroy();b=this._createClientOptions();this._set("_proxy",new O({client:b}));return this._proxy.when()});return function(){return a.apply(this,arguments)}}();w._initServiceOptions=function(){var a=g._asyncToGenerator(function*(){this._set("_serviceOptions",yield this._createServiceOptions());return this._serviceOptions});return function(){return a.apply(this,arguments)}}();w.highlight=function(a){let b;a instanceof
A?b=[a.getObjectId()]:"number"===typeof a||"string"===typeof a?b=[a]:z.isCollection(a)&&0<a.length?b=a.map(q=>q?.getObjectId()).toArray():Array.isArray(a)&&0<a.length&&(b="number"===typeof a[0]||"string"===typeof a[0]?a:a.map(q=>q?.getObjectId()));const e=b?.filter(v.isSome);if(!e||!e.length)return{remove:()=>{}};this._addHighlight(e);return{remove:()=>this._removeHighlight(e)}};w.hasHighlight=function(){return!!this._highlightIds.size};w.hitTest=function(){var a=g._asyncToGenerator(function*(b,e){if(!this.tileRenderer)return null;
e=yield this.tileRenderer.hitTest(e);if(0===e.length)return null;const {features:q,aggregates:L}=yield this._proxy.getFeatures(e);return[...L.map(J=>this._createGraphicHit(b,h.fromJSON(J))),...q.map(J=>this._createGraphicHit(b,A.fromJSON(J)))]});return function(b,e){return a.apply(this,arguments)}}();w.queryStatistics=function(){return this._proxy.queryStatistics()};w.querySummaryStatistics=function(){var a=g._asyncToGenerator(function*(b,e,q){e={...e,scale:this.view.scale};return this._proxy.querySummaryStatistics(this._cleanUpQuery(b),
e,q)});return function(b,e,q){return a.apply(this,arguments)}}();w.queryAggregateSummaryStatistics=function(){var a=g._asyncToGenerator(function*(b,e,q){e={...e,scale:this.view.scale};return this._proxy.queryAggregateSummaryStatistics(this._cleanUpAggregateQuery(b),e,q)});return function(b,e,q){return a.apply(this,arguments)}}();w.queryUniqueValues=function(){var a=g._asyncToGenerator(function*(b,e,q){e={...e,scale:this.view.scale};return this._proxy.queryUniqueValues(this._cleanUpQuery(b),e,q)});
return function(b,e,q){return a.apply(this,arguments)}}();w.queryAggregateUniqueValues=function(){var a=g._asyncToGenerator(function*(b,e,q){e={...e,scale:this.view.scale};return this._proxy.queryAggregateUniqueValues(this._cleanUpAggregateQuery(b),e,q)});return function(b,e,q){return a.apply(this,arguments)}}();w.queryClassBreaks=function(){var a=g._asyncToGenerator(function*(b,e,q){e={...e,scale:this.view.scale};return this._proxy.queryClassBreaks(this._cleanUpQuery(b),e,q)});return function(b,
e,q){return a.apply(this,arguments)}}();w.queryAggregateClassBreaks=function(){var a=g._asyncToGenerator(function*(b,e,q){e={...e,scale:this.view.scale};return this._proxy.queryAggregateClassBreaks(this._cleanUpAggregateQuery(b),e,q)});return function(b,e,q){return a.apply(this,arguments)}}();w.queryHistogram=function(){var a=g._asyncToGenerator(function*(b,e,q){e={...e,scale:this.view.scale};return this._proxy.queryHistogram(this._cleanUpQuery(b),e,q)});return function(b,e,q){return a.apply(this,
arguments)}}();w.queryAggregateHistogram=function(){var a=g._asyncToGenerator(function*(b,e,q){e={...e,scale:this.view.scale};return this._proxy.queryAggregateHistogram(this._cleanUpAggregateQuery(b),e,q)});return function(b,e,q){return a.apply(this,arguments)}}();w.queryFeatures=function(a,b){return this.queryFeaturesJSON(a,b).then(e=>{e=E.fromJSON(e);e.features.forEach(q=>this._setLayersForFeature(q));return e})};w.queryVisibleFeatures=function(a,b){return this._proxy.queryVisibleFeatures(this._cleanUpQuery(a),
b).then(e=>{e=E.fromJSON(e);e.features.forEach(q=>this._setLayersForFeature(q));return e})};w.queryAggregates=function(){var a=g._asyncToGenerator(function*(b,e){b=yield this._proxy.queryAggregates(this._cleanUpAggregateQuery(b),e);b=N.fromJSON(b);b.features.forEach(q=>this._setLayersForFeature(q));return b});return function(b,e){return a.apply(this,arguments)}}();w.queryAggregateIds=function(a,b){return this._proxy.queryAggregateIds(this._cleanUpAggregateQuery(a),b)};w.queryAggregateCount=function(a,
b){return this._proxy.queryAggregateCount(this._cleanUpAggregateQuery(a),b)};w.queryAggregateJSON=function(a,b){return this._proxy.queryAggregates(this._cleanUpAggregateQuery(a),b)};w.queryFeaturesJSON=function(a,b){return this._proxy.queryFeatures(this._cleanUpQuery(a),b)};w.queryObjectIds=function(a,b){return this._proxy.queryObjectIds(this._cleanUpQuery(a),b)};w.queryFeatureCount=function(a,b){return this._proxy.queryFeatureCount(this._cleanUpQuery(a),b)};w.queryExtent=function(a,b){return this._proxy.queryExtent(this._cleanUpQuery(a),
b).then(e=>({count:e.count,extent:ka.fromJSON(e.extent)}))};w.setVisibility=function(a,b){b?this._visibilityOverrides.delete(a):this._visibilityOverrides.add(a);this._update()};w.update=function(a){if(this._tileStrategy&&this.tileRenderer){var {hasMissingTiles:b,added:e,removed:q}=this._tileStrategy.update(a);(e.length||q.length)&&this._proxy.updateTiles({added:e,removed:q});b&&this.requestUpdate();this.notifyChange("updating")}};w.attach=function(){this.view.timeline.record(`${this.layer.title} (FeatureLayer) Attach`);
this._tileStrategy=new S.TileManager({acquireTile:a=>this._acquireTile(a),releaseTile:a=>this._releaseTile(a),tileInfoView:this.view.featuresTilingScheme,buffer:0});this.addAttachHandles(d.watch(()=>this.renderingConfigHash,()=>this._update(),d.initial));"stream"!==this.layer.type&&this.addAttachHandles(this.layer.on("edits",a=>this._edit(a)))};w.detach=function(){this._commandsQueue.clear();this._proxy?.stop();this.container.removeAllChildren();this.tileRenderer?.uninstall(this.container);this.tileRenderer=
null;this._tileStrategy=v.destroyMaybe(this._tileStrategy);this._tileRendererHash=null};w.moveStart=function(){this.requestUpdate()};w.viewChange=function(){this.requestUpdate()};w.moveEnd=function(){this.requestUpdate()};w.isUpdating=function(){const a="renderer"in this.layer&&null!=this.layer.renderer,b=this._commandsQueue.updating,e=null!=this._updatingRequiredFieldsPromise,q=!this._proxy||!this._proxy.isReady,L=this._pipelineIsUpdating,J=null==this.tileRenderer||this.tileRenderer?.updating,T=
a&&(b||e||q||L||J);k("esri-2d-log-updating")&&console.log(`Updating FLV2D: ${T}\n  -> hasRenderer ${a}\n  -> hasPendingCommand ${b}\n  -> updatingRequiredFields ${e}\n  -> updatingProxy ${q}\n  -> updatingPipeline ${L}\n  -> updatingTileRenderer ${J}\n`);return T};w._createClientOptions=function(){return{setUpdating:a=>{this._set("_pipelineIsUpdating",a)},emitEvent:a=>{this.emit(a.name,a.event)}}};w._detectQueryMode=function(){var a=g._asyncToGenerator(function*(b){b="path"in b;const {layer:e}=this;
var q="refreshInterval"in e&&!!e.refreshInterval;q=!("editingInfo"in e&&e.editingInfo?.lastEditDate)&&q;const L=H.getEffectiveLayerCapabilities(e);if(b&&("feature"===e.type||"subtype-group"===e.type)&&"point"===e.geometryType&&L?.query.supportsPagination&&!L?.operations.supportsEditing&&!q&&k("featurelayer-snapshot-enabled"))try{const U=yield e.queryFeatureCount();var J=k("featurelayer-snapshot-point-min-threshold");if(U<=J)return{mode:"snapshot",featureCount:U};const Z=k("featurelayer-snapshot-point-max-threshold"),
R=k("featurelayer-snapshot-point-coverage"),X=this.view.extent;var T=v.unwrap(e.fullExtent);J=T?.clone().intersection(X);const V=v.isSome(J)?J.width*J.height:0;T=T?.width*T?.height;if(U<=Z&&(0===T?0:V/T)>=R)return{mode:"snapshot",featureCount:U}}catch(U){r.getLogger(this.declaredClass).warn("mapview-feature-layer","Encountered an error when querying for featureCount",{error:U})}return{mode:"on-demand"}});return function(b){return a.apply(this,arguments)}}();w._createServiceOptions=function(){var a=
g._asyncToGenerator(function*(){var b=this.layer;if("stream"===b.type)return null;const e=H.getEffectiveLayerCapabilities(b),{capabilities:q,objectIdField:L}=b,J=b.fields.map(Y=>Y.toJSON()),T=v.isSome(b.fullExtent)?b.fullExtent.toJSON():null,U=P.toJSONGeometryType(b.geometryType),Z="timeInfo"in b&&b.timeInfo&&b.timeInfo.toJSON()||null,R=b.spatialReference?b.spatialReference.toJSON():null,X="feature"===b.type?b.globalIdField:null;let V;"ogc-feature"===b.type?V=b.source.getSource():ia(b.source)?V=yield b.source.openPorts():
b.parsedUrl&&(V=u.clone(b.parsedUrl),"dynamicDataSource"in b&&b.dynamicDataSource&&(V.query={layer:JSON.stringify({source:b.dynamicDataSource})}));b="datesInUnknownTimezone"in this.layer&&this.layer.datesInUnknownTimezone;const ea=("subtypeField"in this.layer?this.layer.subtypeField:null)??null,{mode:fa,featureCount:ha}=yield this._detectQueryMode(V);let da=this.layer.objectIdField;if("feature"===this.layer.type&&v.isSome(this.layer.orderBy)&&this.layer.orderBy.length){const Y=!this.layer.orderBy[0].valueExpression&&
this.layer.orderBy[0].field;Y&&(da=Y)}return{type:fa,timeReferenceUnknownClient:b,subtypeField:ea,featureCount:ha,globalIdField:X,maxRecordCount:q.query.maxRecordCount,tileMaxRecordCount:q.query.tileMaxRecordCount,capabilities:q,effectiveCapabilities:e,fields:J,fullExtent:T,geometryType:U,objectIdField:L,source:V,timeInfo:Z,spatialReference:R,orderByFields:da,datesInUnknownTimezone:b,dateFieldsTimeReference:("dateFieldsTimeReference"in this.layer?this.layer.dateFieldsTimeReference?.toJSON():null)||
null,preferredTimeReference:("preferredTimeReference"in this.layer?this.layer.preferredTimeReference?.toJSON():null)||null,editFieldsInfo:"editFieldsInfo"in this.layer?this.layer.editFieldsInfo?.toJSON():null}});return function(){return a.apply(this,arguments)}}();w._createMemoryServiceOptions=function(){var a=g._asyncToGenerator(function*(b){b=yield b.openPorts();return{...this._createServiceOptions(),type:"memory",source:b}});return function(b){return a.apply(this,arguments)}}();w._cleanUpQuery=
function(a){a=F.from(a)||this.createQuery();a.outSpatialReference||(a.outSpatialReference=this.view.spatialReference);return a};w._cleanUpAggregateQuery=function(a){a=F.from(a)||this.createAggregateQuery();a.outSpatialReference||(a.outSpatialReference=this.view.spatialReference);return a};w._update=function(){var a=g._asyncToGenerator(function*(){return this._commandsQueue.push({type:"update"})});return function(){return a.apply(this,arguments)}}();w._edit=function(){var a=g._asyncToGenerator(function*(b){if(this.suspended)this._clearTiles();
else if(this._validateEdit(b))return this._commandsQueue.push({type:"edit",edits:b})});return function(b){return a.apply(this,arguments)}}();w.doRefresh=function(){var a=g._asyncToGenerator(function*(b){if(this.attached&&this._tileStrategy.tileKeys().length){if(!this.suspended||!b)return this._commandsQueue.push({type:"refresh",dataChanged:b});this._clearTiles()}});return function(b){return a.apply(this,arguments)}}();w._clearTiles=function(){this._tileStrategy.tileKeys().length&&(this._proxy.updateTiles({added:[],
removed:this._tileStrategy.tileKeys()}),this._tileStrategy.clear(),this.requestUpdate(),this._commandsQueue.clear(),this._update())};w._validateEdit=function(a){const b="globalIdField"in this.layer&&this.layer.globalIdField,e=a.deletedFeatures.some(L=>-1===L.objectId||!L.objectId),q=b&&this.availableFields.includes(b);return e&&!q?(r.getLogger(this.declaredClass).error(new x("mapview-apply-edits",`Editing the specified service requires the layer's globalIdField, ${b} to be included the layer's outFields for updates to be reflected on the map`)),
null):a};w._doUpdate=function(){var a=g._asyncToGenerator(function*(){try{if(!this.destroyed&&this._hasRequiredSupport(this.layer)&&this._tileStrategy){var {featureEffectView:b,filter:e}=this;yield this._updateRequiredFields();if(!this.destroyed){var {renderer:q}=this._getEffectiveRenderer();this._set("_effectiveRenderer",q);var L=this._createSchemaConfig(),J=this._createConfiguration(L,e,b.filter),T=this._lastDefinitionExpression!==J.schema.source.definitionExpression;this._lastDefinitionExpression=
J.schema.source.definitionExpression;var U=J.schema.tileRenderer,Z=this._createTileRendererHash(U);"snapshot"===this._serviceOptions.type&&(J.schema.source.initialFeatureCount=this._serviceOptions.featureCount);if(Z!==this._tileRendererHash){yield this._initTileRenderer(U,q);const R=this.layer,X="stream"===R.type?yield this._initServiceOptions():this._serviceOptions;this.tileRenderer.onConfigUpdate(q);"stream"!==R.type&&ia(R.source)&&(X.source=yield R.source.openPorts());const V={added:this._tileStrategy.tileKeys(),
removed:[]};yield this._proxy.startup(this.view.featuresTilingScheme,J,X,V);this.hasHighlight()&&(yield this._proxy.setHighlight(Array.from(this._highlightIds.keys())));yield this._onceTilesUpdated();this.tileRenderer.onConfigUpdate(q)}else{"snapshot"===this._serviceOptions.type&&T&&(J.schema.source.changedFeatureCount=yield this.layer.queryFeatureCount());const R=yield this._proxy.update(J);(R.mesh||R.targets?.aggregate)&&this._lockGPUUploads();try{yield this._proxy.applyUpdate(R)}catch(X){l.isAbortError(X)||
r.getLogger(this.declaredClass).error(X)}(R.mesh||R.targets?.aggregate)&&this._unlockGPUUploads();this.tileRenderer.onConfigUpdate(q);this._updateClusterSizeVariable();this._forceAttributeTextureUpload()}this._tileRendererHash=Z;this.tileRenderer.invalidateLabels();this.requestUpdate()}}}catch(R){}});return function(){return a.apply(this,arguments)}}();w._doEdit=function(){var a=g._asyncToGenerator(function*(b){try{yield this._proxy.onEdits(b)}catch(e){l.isAbortError(e)}});return function(b){return a.apply(this,
arguments)}}();w._doRefresh=function(){var a=g._asyncToGenerator(function*(b){this._lockGPUUploads();try{let e;b&&"snapshot"===this.queryMode&&"queryFeatureCount"in this.layer&&(e=yield this.layer.queryFeatureCount());yield this._proxy.refresh({dataChanged:b,featureCount:e})}catch(e){l.isAbortError(e)}this._unlockGPUUploads();this._effectiveFeatureReduction&&this._updateClusterSizeVariable()});return function(b){return a.apply(this,arguments)}}();w._updateClusterSizeVariable=function(){this._needsClusterSizeUpdate&&
(this.tileRenderer.onConfigUpdate(this._effectiveRenderer),this._needsClusterSizeUpdate=!1)};w._createUpdateClusterSizeTask=function(a,b){return d.watch(()=>this._aggregateValueRanges,e=>{this._updateClusterEffectiveRendererSizeVariable(a,b,e);this._needsClusterSizeUpdate=!0;this._uploadsLocked||this._updateClusterSizeVariable()})};w._updateClusterEffectiveRendererSizeVariable=function(){var a=g._asyncToGenerator(function*(b,e,q){if(b.dynamicClusterSize&&"visualVariables"in b&&b.visualVariables){var L=
M.findSizeVV(b.visualVariables);v.isSome(L)&&"cluster_count"===L.field&&(L=b.visualVariables.indexOf(L),b.visualVariables[L]=M.createClusterCountSizeVariable(e,q),b=b.clone(),b.dynamicClusterSize=!0,this._set("_effectiveRenderer",b))}});return function(b,e,q){return a.apply(this,arguments)}}();w._getEffectiveRenderer=function(){var a=this.layer,b="renderer"in a?a.renderer:null;a=this._effectiveFeatureReduction;this._updateClusterSizeTask=v.removeMaybe(this._updateClusterSizeTask);if(a&&"renderer"in
a&&a.renderer&&!a.renderer.authoringInfo?.isAutoGenerated){var e=a.fields;if("cluster"===a.type){const {renderer:q,didInject:L}=M.injectDynamicLevelDependentSizeVisualVariable(a.renderer,a,this._aggregateValueRanges);L&&(this._updateClusterSizeTask=this._createUpdateClusterSizeTask(q,a));return{renderer:q,aggregateFields:e,featureReduction:a}}return{renderer:a.renderer,aggregateFields:e,featureReduction:a}}return a&&"cluster"===a.type&&b&&M.isClusterCompatibleRenderer(b)?(e=[],b=M.createClusterRenderer(e,
b,a,this._aggregateValueRanges,!0),this._updateClusterSizeTask=this._createUpdateClusterSizeTask(b,a),{renderer:b,aggregateFields:e,featureReduction:a}):{renderer:b,aggregateFields:[],featureReduction:null}};w._acquireTile=function(a){a=this.tileRenderer.acquireTile(a);a.once("attach",()=>{this.requestUpdate()});return a};w._releaseTile=function(a){this.tileRenderer.releaseTile(a)};w._initTileRenderer=function(){var a=g._asyncToGenerator(function*(b,e){b=yield C.createOrReuseTileRenderer(b,{layerView:this,
tileInfoView:this.view.featuresTilingScheme,layer:this.layer});this.tileRenderer&&(this._tileStrategy.clear(),this.tileRenderer.uninstall(this.container),this.tileRenderer=v.destroyMaybe(this.tileRenderer));if(this.destroyed)return null;this._proxy.tileRenderer=b;this._set("tileRenderer",b);this.tileRenderer.install(this.container);this.tileRenderer.onConfigUpdate(e);this.requestUpdate();return this.tileRenderer});return function(b,e){return a.apply(this,arguments)}}();w._createTileRendererHash=function(a){return`${a.type}`};
w._injectOverrides=function(a){var b=v.isSome(a)?a.timeExtent:null;b=v.isSome(this.timeExtent)&&v.isSome(b)?this.timeExtent.intersection(b):this.timeExtent||b;var e=null;const q="floorInfo"in this.layer&&this.layer.floorInfo;q&&(e=v.isSome(a)?a.where:null,e=this._addFloorFilterClause(e));if(!this._visibilityOverrides.size&&!b&&!q)return v.isSome(a)?a.toJSON():null;a=v.isSome(a)&&a.clone()||new B;a.timeExtent=b;e&&(a.where=e);a=a.toJSON();a.hiddenIds=Array.from(this._visibilityOverrides);return a};
w._addFloorFilterClause=function(a){var b=this.layer;a=a||"";if("floorInfo"in b&&b.floorInfo){var e=this.view.floors;if(!e||!e.length)return a;b.floorInfo.viewAllLevelIds?.length&&(e=b.floorInfo.viewAllLevelIds);e=e.filter(q=>""!==q).map(q=>"'"+q+"'");e.push("''");b=b.floorInfo.floorField;e=("("+b+" IN ({ids}) OR "+b+" IS NULL)").replace("{ids}",e.join(", "));if(v.isSome(a)&&a.includes(b)){let q=new RegExp("AND \\("+b+".*NULL\\)","g");a=a.replace(q,"");q=new RegExp("\\("+b+".*NULL\\)","g");a=a.replace(q,
"");a=a.replace(/\s+/g," ").trim()}a=""!==a?"("+a+") AND "+e:e}return""!==a?a:null};w._createConfiguration=function(a,b,e){const q="feature"===this.layer.type&&this.layer.historicMoment?this.layer.historicMoment.getTime():void 0,L="feature"===this.layer.type?this.layer.gdbVersion??void 0:void 0,J=Array(G.MAX_FILTERS);b=this._injectOverrides(b);J[0]=b;J[1]=v.isSome(e)?e.toJSON():null;a=p.createSchema(a);if(v.isNone(a))return null;e=ja.getWebGLCapabilities("2d");return{availableFields:this.availableFields,
gdbVersion:L,historicMoment:q,devicePixelRatio:window.devicePixelRatio||1,filters:J,schema:a,supportsTextureFloat:e.supportsTextureFloat,maxTextureSize:e.maxTextureSize}};w._hasRequiredSupport=function(a){return"renderer"in a?y.isRendererSupported(a.renderer):!0};w._onceTilesUpdated=function(){this.requestUpdate();return d.whenOnce(()=>!this._pipelineIsUpdating)};w._lockGPUUploads=function(){this.tileRenderer&&(this._uploadsLocked=!0,this.tileRenderer.lockGPUUploads())};w._unlockGPUUploads=function(){this.tileRenderer&&
(this._uploadsLocked=!1,this.tileRenderer.unlockGPUUploads())};w._forceAttributeTextureUpload=function(){this.tileRenderer&&this.tileRenderer.forceAttributeTextureUpload()};w._createSchemaConfig=function(){const a=this.layer;return{renderer:"renderer"in a?a.renderer:null,spatialReference:a.spatialReference,timeExtent:"timeExtent"in a?a.timeExtent:null,definitionExpression:a.definitionExpression,featureReduction:this._effectiveFeatureReduction,fields:a.fields,geometryType:a.geometryType,historicMoment:"historicMoment"in
a?a.historicMoment:null,labelsVisible:"labelsVisible"in a&&a.labelsVisible,labelingInfo:"labelingInfo"in a?a.labelingInfo:null,availableFields:this.availableFields,featureEffect:this.featureEffect,filter:this.filter,gdbVersion:"gdbVersion"in a?a.gdbVersion:null,pixelBuffer:0,orderBy:"orderBy"in a&&a.orderBy?a.orderBy:null,customParameters:{...("customParameters"in a?a.customParameters:void 0),token:"apiKey"in a?a.apiKey??void 0:void 0},subtypeCode:"subtypeCode"in a?a.subtypeCode:void 0,subtypeField:"subtypeField"in
a?a.subtypeField:void 0}};w._addHighlight=function(a){for(const b of a)this._highlightIds.has(b)?(a=this._highlightIds.get(b),this._highlightIds.set(b,a+1)):this._highlightIds.set(b,1);this._updateHighlight().catch(b=>{l.isAbortError(b)||r.getLogger(this.declaredClass).error(b)})};w._removeHighlight=function(a){for(const b of a)this._highlightIds.has(b)&&(a=this._highlightIds.get(b)-1,0===a?this._highlightIds.delete(b):this._highlightIds.set(b,a));this._updateHighlight().catch(b=>{l.isAbortError(b)||
r.getLogger(this.declaredClass).error(b)})};w._setLayersForFeature=function(a){const b=this.layer;a.layer=b;a.sourceLayer=b};w._createGraphicHit=function(a,b){this._setLayersForFeature(b);v.isSome(b.geometry)&&(b.geometry.spatialReference=this.view.spatialReference);return{type:"graphic",graphic:b,layer:this.layer,mapPoint:a}};g._createClass(ca,[{key:"_effectiveFeatureReduction",get:function(){if(!("featureReduction"in this.layer))return null;const a=this.layer.featureReduction;return a?!("maxScale"in
a&&a.maxScale)||a.maxScale<this.view.scale?a:null:null}},{key:"orderByFields",get:function(){return"stream"!==this._serviceOptions?.type?this._serviceOptions?.orderByFields:void 0}},{key:"labelsVisible",get:function(){const a="subtype-group"===this.layer.type?this.layer.sublayers.items:[this.layer];return!this.suspended&&a.some(b=>b.labelingInfo&&b.labelsVisible)}},{key:"queryMode",get:function(){return this._serviceOptions?.type}},{key:"renderingConfigHash",get:function(){if(!this.layer)return null;
const a=this.availableFields;var b=this.layer;const e=this.view.floors,{definitionExpression:q}=b,L="subtype-group"!==this.layer.type&&this.layer.labelsVisible&&this.layer.labelingInfo,J="renderer"in b&&b.renderer,T="gdbVersion"in b?b.gdbVersion:void 0,U="historicMoment"in b?b.historicMoment?.getTime():void 0,{timeExtent:Z}=this,R="customParameters"in b?JSON.stringify(b.customParameters):void 0,X="apiKey"in b?b.apiKey:void 0;b="stream"===b.type?`${JSON.stringify(b.geometryDefinition)}${b.definitionExpression}`:
null;const V=JSON.stringify(this.clips),ea=this._effectiveFeatureReduction?.toJSON(),fa="orderBy"in this.layer&&JSON.stringify(this.layer.orderBy),ha="sublayers"in this.layer&&this.layer.sublayers.items.reduce((da,Y)=>da+`${Y.visible?1:0}.${JSON.stringify(Y.renderer)}.${Y.labelsVisible}\n.${JSON.stringify(Y.labelingInfo)}`,"");return JSON.stringify({orderBy:fa,sublayerHash:ha,subtypeCode:"subtypeCode"in this.layer&&this.layer.subtypeCode,filterHash:v.isSome(this.filter)&&this.filter.toJSON(),effectHash:v.isSome(this.featureEffect)&&
this.featureEffect.toJSON(),streamFilter:b,gdbVersion:T,definitionExpression:q,historicMoment:U,availableFields:a,renderer:J,labelingInfo:L,timeExtent:Z,floors:e,clipsHash:V,featureReduction:ea,customParameters:R,apiKey:X})}},{key:"hasFilter",get:function(){const a=!!("floorInfo"in this.layer&&this.layer.floorInfo&&this.view.floors&&this.view.floors.length);return!!this.filter||a||!!this._visibilityOverrides.size||!!this.timeExtent}}]);return ca}(I(aa(K.LayerView2DMixin(W))));m.__decorate([c.property()],
n.prototype,"_serviceOptions",void 0);m.__decorate([c.property()],n.prototype,"_proxy",void 0);m.__decorate([c.property()],n.prototype,"_pipelineIsUpdating",void 0);m.__decorate([c.property()],n.prototype,"_effectiveRenderer",void 0);m.__decorate([c.property()],n.prototype,"_effectiveFeatureReduction",null);m.__decorate([c.property()],n.prototype,"_aggregateValueRanges",void 0);m.__decorate([c.property()],n.prototype,"_commandsQueue",void 0);m.__decorate([c.property()],n.prototype,"featureEffectView",
void 0);m.__decorate([c.property()],n.prototype,"labelsVisible",null);m.__decorate([c.property({readOnly:!0})],n.prototype,"queryMode",null);m.__decorate([c.property()],n.prototype,"renderingConfigHash",null);m.__decorate([c.property()],n.prototype,"tileRenderer",void 0);m.__decorate([c.property()],n.prototype,"updating",void 0);return n=m.__decorate([t.subclass("esri.views.2d.layers.FeatureLayerView2D")],n)});