// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.26/esri/copyright.txt for details.
//>>built
define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Graphic ../../../core/Collection ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ./LayerView2D ./graphics/GraphicContainer ./graphics/GraphicsView2D ../../layers/LayerView".split(" "),function(g,k,n,p,l,q,f,y,r,t,u,v,w){const x={remove(){},pause(){},resume(){}};f=function(m){function h(){var a=
m.apply(this,arguments)||this;a._highlightIds=new Map;return a}g._inheritsLoose(h,m);var c=h.prototype;c.attach=function(){this.graphicsView=new v({requestUpdateCallback:()=>this.requestUpdate(),view:this.view,graphics:this.layer.graphics,container:new u(this.view.featuresTilingScheme)});this._updateHighlight();this.container.addChild(this.graphicsView.container);this.addAttachHandles(this.layer.on("graphic-update",this.graphicsView.graphicUpdateHandler))};c.detach=function(){this.container.removeAllChildren();
this.graphicsView=l.destroyMaybe(this.graphicsView)};c.hitTest=function(){var a=g._asyncToGenerator(function*(b){return this.graphicsView?this.graphicsView.hitTest(b).map(d=>({type:"graphic",graphic:d,mapPoint:b,layer:this.layer})):null});return function(b){return a.apply(this,arguments)}}();c.fetchPopupFeatures=function(){var a=g._asyncToGenerator(function*(b){return this.graphicsView?this.graphicsView.hitTest(b).filter(d=>!!d.popupTemplate):[]});return function(b){return a.apply(this,arguments)}}();
c.queryGraphics=function(){return Promise.resolve(this.graphicsView.graphics)};c.update=function(a){this.graphicsView.processUpdate(a)};c.moveStart=function(){};c.viewChange=function(){this.graphicsView.viewChange()};c.moveEnd=function(){};c.isUpdating=function(){return!this.graphicsView||this.graphicsView.updating};c.highlight=function(a){let b;"number"===typeof a?b=[a]:a instanceof n?b=[a.uid]:Array.isArray(a)&&0<a.length?b="number"===typeof a[0]?a:a.map(e=>e&&e.uid):p.isCollection(a)&&0<a.length&&
(b=a.map(e=>e&&e.uid).toArray());const d=b?.filter(l.isSome);if(!d?.length)return x;this._addHighlight(d);return{remove:()=>this._removeHighlight(d)}};c._addHighlight=function(a){for(const b of a)this._highlightIds.has(b)?(a=this._highlightIds.get(b),this._highlightIds.set(b,a+1)):this._highlightIds.set(b,1);this._updateHighlight()};c._removeHighlight=function(a){for(const b of a)this._highlightIds.has(b)&&(a=this._highlightIds.get(b)-1,0===a?this._highlightIds.delete(b):this._highlightIds.set(b,
a));this._updateHighlight()};c._updateHighlight=function(){this.graphicsView?.setHighlight(Array.from(this._highlightIds.keys()))};return h}(t.LayerView2DMixin(w));k.__decorate([q.property()],f.prototype,"graphicsView",void 0);return f=k.__decorate([r.subclass("esri.views.2d.layers.GraphicsLayerView2D")],f)});