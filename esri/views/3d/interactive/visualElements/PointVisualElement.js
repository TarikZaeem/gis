// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.26/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/mathUtils ../../../../core/maybe ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../chunks/vec4 ../../../../chunks/vec4f64 ../../../../geometry/projection ../../../../geometry/support/aaBoundingBox ../../../../geometry/support/vectorStacks ./VisualElementResources ../../layers/graphics/elevationAlignmentUtils ../../layers/graphics/ElevationContext ../../support/engineContent/sdfPrimitives ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/VertexAttribute ../../webgl-engine/materials/HUDMaterial".split(" "),
function(m,w,n,d,x,y,h,p,q,z,r,A,B,C,t,D,u,E){let H=function(){function l(a){this._geometry=this.view=null;this._size=3;this._color=p.fromValues(1,0,1,1);this._pixelSnappingEnabled=!0;this._primitive="square";this._outlineSize=1;this._outlineColor=p.fromValues(1,1,1,1);this._elevationInfo=null;this._resources=new A.VisualElementResources({view:a.view,createResources:c=>this._createResources(c),destroyResources:c=>this._destroyResources(c),recreateGeometry:(c,f)=>{c.geometry=this._recreateGeometry(f,
c.material)}});let b=!0;for(const c in a)c in this?"attached"===c?b=a[c]??!1:this[c]=a[c]:console.error("Cannot set unknown property",c);this.attached=b}var e=l.prototype;e.destroy=function(){this._resources.destroy()};e._updateMaterial=function(){const a=this._resources.resources;d.isNone(a)||a.material.setParameters(this._materialParameters(a.texture.id))};e._updateSizeAttribute=function(){var a=this._resources.resources;const b=this._resources.object;if(!d.isNone(a)&&!d.isNone(b)&&(a=a.geometry,
!d.isNone(a))){a=a.getMutableAttribute(u.VertexAttribute.SIZE).data;var c=this._geometrySize;a[0]=c;a[1]=c;b.geometryVertexAttrsUpdated(b.geometries[0])}};e._materialParameters=function(a){return{color:this._color,textureIsSignedDistanceField:!0,distanceFieldBoundingBox:F,occlusionTest:!1,outlineColor:this._outlineColor,outlineSize:this._outlineSize,textureId:a,polygonOffset:!1,shaderPolygonOffset:0,drawInSecondSlot:!0,depthEnabled:!1,pixelSnappingEnabled:this.pixelSnappingEnabled}};e._recreateGeometry=
function(a,b){b=this._createRenderGeometry(b);d.isSome(b)&&a.addGeometry(b);return b};e._createResources=function(a){const b=t.createTexture(this._primitive,this._preferredTextureSize),c=new E.HUDMaterial(this._materialParameters(b.id));a=this._recreateGeometry(a,c);return{material:c,texture:b,geometry:a,forEach(f){f(b);f(c);d.isSome(this.geometry)&&f(this.geometry)}}};e._destroyResources=function(a){a.geometry=null;a.material.dispose();a.texture.dispose()};e.calculateMapBounds=function(a){if(d.isNone(this._resources.resources)||
d.isNone(this._resources.resources.geometry))return!1;const b=this._resources.resources.geometry.vertexAttributes.get(u.VertexAttribute.POSITION);q.projectVectorToVector(b.data,this.view.renderCoordsHelper.spatialReference,v,this.view.spatialReference);z.expandWithBuffer(a,v);return!0};e._createRenderGeometry=function(a){var b=this.geometry;if(d.isNone(b))return null;const {renderCoordsHelper:c,elevationProvider:f}=this.view;var k=B.evaluateElevationAlignmentAtPoint(b,f,C.ElevationContext.fromElevationInfo(this.elevationInfo),
c);const G=x.set(r.sv3d.get(),b.x,b.y,k);k=r.sv3d.get();q.projectVectorToVector(G,b.spatialReference,k,c.spatialReference);b=this._geometrySize;return D.createPointGeometry(a,null,k,null,[b,b],[0,0,0,1])};w._createClass(l,[{key:"visible",get:function(){return this._resources.visible},set:function(a){this._resources.visible=a}},{key:"attached",get:function(){return this._resources.attached},set:function(a){this._resources.attached=a}},{key:"geometry",get:function(){return this._geometry},set:function(a){this._geometry=
a;this._resources.recreateGeometry()}},{key:"size",get:function(){return this._size},set:function(a){if(a!==this._size){const b=this._preferredTextureSize;this._size=a;b<this._preferredTextureSize?d.isSome(this._resources)&&this._resources.recreate():this._updateSizeAttribute()}}},{key:"color",get:function(){return this._color},set:function(a){h.exactEquals(a,this._color)||(h.copy(this._color,a),this._updateMaterial())}},{key:"pixelSnappingEnabled",get:function(){return this._pixelSnappingEnabled},
set:function(a){this._pixelSnappingEnabled!==a&&(this._pixelSnappingEnabled=a,this._updateMaterial())}},{key:"primitive",get:function(){return this._primitive},set:function(a){this._primitive!==a&&(this._primitive=a,d.isSome(this._resources)&&this._resources.recreate())}},{key:"outlineSize",get:function(){return this._outlineSize},set:function(a){a!==this._outlineSize&&(this._outlineSize=a,this._updateMaterial())}},{key:"outlineColor",get:function(){return this._outlineColor},set:function(a){h.exactEquals(a,
this._outlineColor)||(h.copy(this._outlineColor,a),this._updateMaterial())}},{key:"elevationInfo",get:function(){return this._elevationInfo},set:function(a){this._elevationInfo=a;this._resources&&this._resources.recreateGeometry()}},{key:"_geometrySize",get:function(){return this._size/g}},{key:"_preferredTextureSize",get:function(){return n.clamp(n.nextHighestPowerOfTwo(2*this._geometrySize),16,128)}}]);return l}();const g=t.DEFAULT_SYMBOL_SIZE_RATIO,F=[g/2,g/2,1-g/2,1-g/2],v=y.create();m.PointVisualElement=
H;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})});