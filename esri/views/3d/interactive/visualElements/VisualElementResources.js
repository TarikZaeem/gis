// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.26/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/reactiveUtils ../../webgl-engine/lib/ContentObjectType ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/Texture ../../webgl-engine/lib/UpdatePolicy ../../webgl-engine/lib/WebGLLayer".split(" "),function(m,r,f,n,e,t,u,v,w){let x=function(){function l(a){this._resourceFactory=a;this._resources=null;this._visible=!0;this._attached=!1}var c=l.prototype;c.destroy=function(){this._destroyResources()};
c.recreate=function(){this.attached&&this._createResources()};c.recreateGeometry=function(){if(this._resourceFactory.recreateGeometry){var a=this._resourceFactory.view._stage;if(!f.isNone(this._resources)&&a){var d=this._resources.object;this._resources.external.forEach(b=>{b.type!==e.ContentObjectType.Mesh&&b.type!==e.ContentObjectType.Line&&b.type!==e.ContentObjectType.Point||a.remove(b)});d.removeAllGeometries();this._resourceFactory.recreateGeometry(this._resources.external,d,this._resources.layer);
this._resources.external.forEach(b=>{b.type!==e.ContentObjectType.Mesh&&b.type!==e.ContentObjectType.Line&&b.type!==e.ContentObjectType.Point||a.add(b)})}}else this.recreate()};c._createOrDestroyResources=function(){this._attached?this._resources||this._createResources():this._destroyResources()};c._createResources=function(){this._destroyResources();var a=this._resourceFactory;const d=a.view,b=d._stage;if(b){var h=new w.WebGLLayer({pickable:!1,updatePolicy:v.UpdatePolicy.SYNC});b.add(h);var k=new t.Object3D({castShadow:!1}),
p=a.createResources(k,h);p.forEach(g=>{b.add(g);g instanceof u.Texture&&b.loadImmediate(g)});b.add(k);h.add(k);var q=a.cameraChanged;a=q?n.watch(()=>d.state.camera,g=>q(g),n.initial):null;this._resources={layer:h,object:k,external:p,cameraHandle:a};this._syncVisible()}};c._destroyResources=function(){if(!f.isNone(this._resources)){var a=this._resourceFactory.view._stage;a&&(a.remove(this._resources.object),a.remove(this._resources.layer),this._resources.external.forEach(d=>a.remove(d)));this._resources.object.dispose();
this._resources.cameraHandle?.remove();this._resourceFactory.destroyResources(this._resources.external);this._resources=null}};c._syncVisible=function(){f.isNone(this._resources)||(this._resources.object.visible=this._visible)};r._createClass(l,[{key:"object",get:function(){return f.isSome(this._resources)?this._resources.object:null}},{key:"resources",get:function(){return f.isSome(this._resources)?this._resources.external:null}},{key:"visible",get:function(){return this._visible},set:function(a){a!==
this._visible&&(this._visible=a,this._syncVisible())}},{key:"attached",get:function(){return this._attached},set:function(a){a!==this._attached&&(this._attached=a,this._createOrDestroyResources())}}]);return l}();m.VisualElementResources=x;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})});