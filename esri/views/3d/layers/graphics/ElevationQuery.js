// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.26/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../geometry ../../../../core/arrayUtils ../../../../core/maybe ../../../../core/promiseUtils ../../../support/Scheduler ../../../../geometry/Multipoint".split(" "),function(p,r,t,v,q,m,u,w){t=function(){function h(c,a){this.spatialReference=c;this._view=a}var k=h.prototype;k.getElevation=function(c,a,d){return this._view.elevationProvider.getElevation(c,a,0,this.spatialReference,d)};k.queryElevation=function(){var c=r._asyncToGenerator(function*(a,
d,f,l,g){return this._view.elevationProvider.queryElevation(a,d,0,this.spatialReference,g,f,l)});return function(a,d,f,l,g){return c.apply(this,arguments)}}();return h}();let y=function(){function h(c,a,d,f){this.spatialReference=a;this._getElevationQueryProvider=d;this._queries=[];this._queryOptions={...f,ignoreInvisibleLayers:!0};this._frameTask=c.registerTask(u.TaskPriority.ELEVATION_QUERY,this)}var k=h.prototype;k.destroy=function(){this._frameTask.remove()};k.queryElevation=function(c,a,d,f=
0){return new Promise((l,g)=>{const n={x:c,y:a,minDemResolution:f,result:{resolve:l,reject:g},signal:d};this._queries.push(n);m.onAbort(d,()=>{v.remove(this._queries,n);g(m.createAbortError())})})};k.runTask=function(c){const a=this._queries;this._queries=[];const d=this._getElevationQueryProvider();if(d){var f=a.map(b=>[b.x,b.y]),l=a.reduce((b,e)=>Math.min(b,e.minDemResolution),Infinity);f=new w({points:f,spatialReference:this.spatialReference});var g=1<a.length&&a.some(b=>!!b.signal)?new AbortController:
null,n=q.isSome(g)?g.signal:a[0].signal;if(q.isSome(g)){let b=0;a.forEach(e=>m.onAbort(e.signal,()=>{b++;e.result.reject(m.createAbortError());b===a.length&&g.abort()}))}d.queryElevation(f,{...this._queryOptions,minDemResolution:l,signal:n}).then(b=>{a.forEach((e,x)=>{q.isSome(e.signal)&&e.signal.aborted?e.result.reject(m.createAbortError()):e.result.resolve(b.geometry.points[x][2])})}).catch(b=>{a.forEach(e=>e.result.reject(b))})}else a.forEach(b=>b.result.reject());c.madeProgress()};r._createClass(h,
[{key:"running",get:function(){return 0<this._queries.length}},{key:"test",get:function(){const c=this;return{update:()=>0<c._queries.length&&c.runTask(u.noBudget)}}}]);return h}();p.ElevationQuery=y;p.ViewElevationProvider=t;Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})});