// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.26/esri/copyright.txt for details.
//>>built
define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/maybe ../../../core/promiseUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ../../support/Scheduler".split(" "),function(e,k,l,w,f,x,n,z,A,y,t){e.SnappingOperation=function(u){function p(b){var a=u.call(this,b)||this;a.constrainResult=c=>c;a._snapPoints=null;
a._frameTask=null;a._abortController=null;a._stagedPoint=null;a._snap=x.debounce(function(){var c=k._asyncToGenerator(function*(d,g,m,q){const r=a._frameTask;if(!f.isNone(r)){var v=yield r.schedule(()=>g.snap({...d,context:m,signal:q}),q);v.valid&&(yield r.schedule(()=>{a.stagedPoint=v.apply();d!==a._snapPoints&&f.isSome(a._snapPoints)&&(a.stagedPoint=g.update({...a._snapPoints,context:m}))},q))}});return function(d,g,m,q){return c.apply(this,arguments)}}());return a}k._inheritsLoose(p,u);var h=p.prototype;
h.initialize=function(){const b="3d"===this.view.type?this.view?.resourceController?.scheduler:null;this._frameTask=f.isSome(b)?b.registerTask(t.TaskPriority.SNAPPING):t.ImmediateTask};h.destroy=function(){this._abortController=f.abortMaybe(this._abortController);this._frameTask=f.removeMaybe(this._frameTask)};h.update=function(b,a,c){this._snapPoints=b;const {point:d,scenePoint:g}=b;return this.stagedPoint=b=a.update({point:d,scenePoint:g,context:c})};h.snap=function(){var b=k._asyncToGenerator(function*(a,
c,d){const {point:g,scenePoint:m}=a;this.stagedPoint=c.update({point:g,scenePoint:m,context:d});this._snapPoints=a;f.isNone(this._abortController)&&(this._abortController=new AbortController);return this._snap(a,c,d,this._abortController.signal)});return function(a,c,d){return b.apply(this,arguments)}}();h.resnap=function(){var b=k._asyncToGenerator(function*(a,c){f.isNone(this._snapPoints)||(yield this.snap(this._snapPoints,a,c))});return function(a,c){return b.apply(this,arguments)}}();h.abort=
function(){this._abortController=f.abortMaybe(this._abortController);this._snapPoints=null};k._createClass(p,[{key:"stagedPoint",get:function(){return this._stagedPoint},set:function(b){this._stagedPoint=this.constrainResult(b)}}]);return p}(w);l.__decorate([n.property({constructOnly:!0})],e.SnappingOperation.prototype,"view",void 0);l.__decorate([n.property()],e.SnappingOperation.prototype,"stagedPoint",null);l.__decorate([n.property()],e.SnappingOperation.prototype,"constrainResult",void 0);l.__decorate([n.property()],
e.SnappingOperation.prototype,"_stagedPoint",void 0);e.SnappingOperation=l.__decorate([y.subclass("esri.views.interactive.snapping.SnappingOperation")],e.SnappingOperation);Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});