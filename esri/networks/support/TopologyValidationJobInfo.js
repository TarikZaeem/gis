// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.26/esri/copyright.txt for details.
//>>built
define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../request ../../core/has ../../core/jsonMap ../../core/promiseUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ../../layers/mixins/EditBusLayer ../../rest/networks/support/ValidateNetworkTopologyResult".split(" "),function(l,e,q,m,r,t,h,z,A,u,v,w,b){m=r.strict()({Pending:"job-waiting",
InProgress:"job-executing",Completed:"job-succeeded"});b=function(c){function d(a){a=c.call(this,a)||this;a.featureServiceUrl=null;a.statusUrl=null;a.status=null;a.submissionTime=null;a.lastUpdatedTime=null;a._timer=void 0;return a}l._inheritsLoose(d,c);var k=d.prototype;k.destroy=function(){clearInterval(this._timer)};k.checkJobStatus=function(){var a=l._asyncToGenerator(function*(f){({data:f}=yield q(this.statusUrl,{...f,query:{f:"json"}}));this.read(f);(this.serviceEdits||this.exceededTransferLimit)&&
this.featureServiceUrl&&w.editEventBus.emit("edits",{serviceUrl:this.featureServiceUrl??"",layerId:null,event:{edits:null,addedFeatures:[],updatedFeatures:[],deletedFeatures:[],addedAttachments:[],updatedAttachments:[],deletedAttachments:[],exceededTransferLimit:!0}});return this});return function(f){return a.apply(this,arguments)}}();k.waitForJobCompletion=function(){var a=l._asyncToGenerator(function*(f={}){const {interval:x=1E3,statusCallback:n}=f;return new Promise((y,p)=>{this._clearTimer();
this._timer=setInterval(()=>{this._timer||p(t.createAbortError());this.checkJobStatus().then(g=>{({status:g}=g);this.status=g;switch(g){case "job-succeeded":this._clearTimer();y(this);break;case "job-waiting":case "job-executing":n&&n(this)}},g=>{this._clearTimer();p(g)})},x)})});return function(){return a.apply(this,arguments)}}();k._clearTimer=function(){clearInterval(this._timer);this._timer=void 0};return d}(b);e.__decorate([h.property()],b.prototype,"featureServiceUrl",void 0);e.__decorate([h.property({type:String,
json:{write:!0}})],b.prototype,"statusUrl",void 0);e.__decorate([u.enumeration(m)],b.prototype,"status",void 0);e.__decorate([h.property({type:Date,json:{type:Number,write:{writer:(c,d)=>{d.submissionTime=c?c.getTime():null}}}})],b.prototype,"submissionTime",void 0);e.__decorate([h.property({type:Date,json:{type:Number,write:{writer:(c,d)=>{d.lastUpdatedTime=c?c.getTime():null}}}})],b.prototype,"lastUpdatedTime",void 0);return b=e.__decorate([v.subclass("esri.networks.support.TopologyValidationJobInfo")],
b)});