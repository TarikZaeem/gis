// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.26/esri/copyright.txt for details.
//>>built
define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Error ../../../../core/maybe ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/accessorSupport/decorators/subclass ../../../../geometry/Extent ../../../../layers/support/rasterFunctions/stretchUtils ./RasterLayerAdapter".split(" "),function(m,r,u,v,w,h,B,x,y,z,A){h=function(t){function n(){return t.apply(this,
arguments)||this}m._inheritsLoose(n,t);var g=n.prototype;g.generateRasterInfo=function(){var b=m._asyncToGenerator(function*(a){const {layer:c}=this;return"imagery-tile"===c.type?(yield c.generateRasterInfo(c.rasterFunction,{signal:a?.signal}))??c.rasterInfo:this.rasterInfo});return function(a){return b.apply(this,arguments)}}();g.estimateStatisticsHistograms=function(){var b=m._asyncToGenerator(function*(a){if(null!==this._statsCache)return this._statsCache;const {raster:c}=this.layer,{extent:p,
width:d,height:e}=this._getSamplePixelBlockDescriptor(c.rasterInfo);({pixelBlock:a}=yield c.fetchPixels(p,d,e,a));if(v.isNone(a))throw new u("raster-layer-adapter","Unable to estimate histograms");return this._statsCache=z.estimateStatisticsHistograms(a)});return function(a){return b.apply(this,arguments)}}();g.supportsMultidirectionalHillshade=function(){return!0};g.load=function(b){this.addResolvingPromise(this.layer.load(b).then(()=>this.rasterInfo=this.layer.raster.rasterInfo));return Promise.resolve(this)};
g._getSamplePixelBlockDescriptor=function(b,a=1E3){const {pyramidScalingFactor:c,maximumPyramidLevel:p}=b.storageInfo;let {extent:d,width:e,height:f,pixelSize:k}=b,q=Math.ceil(Math.log(Math.max(e,f)/a)/Math.log(c))-1,l=b=0;q<=p?(a=c**q,e=Math.floor(e/a),f=Math.floor(f/a)):(q=0,e=Math.min(e,a),f=Math.min(f,a),b=Math.max(Math.floor(e/2-500),0),l=Math.max(Math.floor(f/2-500),0),d=new y({xmin:d.xmin+b*k.x,xmax:Math.min(d.xmax,d.xmin+b*k.x*a),ymin:d.ymin+l*k.y,ymax:Math.min(d.ymax,d.ymin+l*k.y*a)}));return{extent:d,
width:e,height:f,origin:{x:b,y:l}}};return n}(A);r.__decorate([w.property()],h.prototype,"layer",void 0);return h=r.__decorate([x.subclass("esri.smartMapping.support.adapters.ImageryTileLayerAdapter")],h)});